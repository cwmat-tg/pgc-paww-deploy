(self.webpackChunkpgc_paww_frontend=self.webpackChunkpgc_paww_frontend||[]).push([[422],{185:(He,fe,Et)=>{"use strict";var D=Et(3033);function y(Bt){var ft=[1/0,1/0,-1/0,-1/0];return D.coordEach(Bt,function(It){ft[0]>It[0]&&(ft[0]=It[0]),ft[1]>It[1]&&(ft[1]=It[1]),ft[2]<It[0]&&(ft[2]=It[0]),ft[3]<It[1]&&(ft[3]=It[1])}),ft}y.default=y,fe.Z=y},483:function(He){He.exports=function(){"use strict";function Et(y,Bt,ft,It,Ft){for(;It>ft;){if(It-ft>600){var he=It-ft+1,Jt=Bt-ft+1,Ze=Math.log(he),ve=.5*Math.exp(2*Ze/3),ce=.5*Math.sqrt(Ze*ve*(he-ve)/he)*(Jt-he/2<0?-1:1);Et(y,Bt,Math.max(ft,Math.floor(Bt-Jt*ve/he+ce)),Math.min(It,Math.floor(Bt+(he-Jt)*ve/he+ce)),Ft)}var kt=y[Bt],ie=ft,X=It;for(yt(y,ft,Bt),Ft(y[It],kt)>0&&yt(y,ft,It);ie<X;){for(yt(y,ie,X),ie++,X--;Ft(y[ie],kt)<0;)ie++;for(;Ft(y[X],kt)>0;)X--}0===Ft(y[ft],kt)?yt(y,ft,X):yt(y,++X,It),X<=Bt&&(ft=X+1),Bt<=X&&(It=X-1)}}function yt(y,Bt,ft){var It=y[Bt];y[Bt]=y[ft],y[ft]=It}function D(y,Bt){return y<Bt?-1:y>Bt?1:0}return function(y,Bt,ft,It,Ft){Et(y,Bt,ft||0,It||y.length-1,Ft||D)}}()},5454:(He,fe,Et)=>{"use strict";He.exports=D,He.exports.default=D;var yt=Et(483);function D(X,J){if(!(this instanceof D))return new D(X,J);this._maxEntries=Math.max(4,X||9),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),J&&this._initFormat(J),this.clear()}function y(X,J,$){if(!$)return J.indexOf(X);for(var St=0;St<J.length;St++)if($(X,J[St]))return St;return-1}function Bt(X,J){ft(X,0,X.children.length,J,X)}function ft(X,J,$,St,Q){Q||(Q=kt(null)),Q.minX=1/0,Q.minY=1/0,Q.maxX=-1/0,Q.maxY=-1/0;for(var st,et=J;et<$;et++)st=X.children[et],It(Q,X.leaf?St(st):st);return Q}function It(X,J){return X.minX=Math.min(X.minX,J.minX),X.minY=Math.min(X.minY,J.minY),X.maxX=Math.max(X.maxX,J.maxX),X.maxY=Math.max(X.maxY,J.maxY),X}function Ft(X,J){return X.minX-J.minX}function he(X,J){return X.minY-J.minY}function Jt(X){return(X.maxX-X.minX)*(X.maxY-X.minY)}function Ze(X){return X.maxX-X.minX+(X.maxY-X.minY)}function ve(X,J){return(Math.max(J.maxX,X.maxX)-Math.min(J.minX,X.minX))*(Math.max(J.maxY,X.maxY)-Math.min(J.minY,X.minY))}function ce(X,J){var $=Math.max(X.minX,J.minX),St=Math.max(X.minY,J.minY),Q=Math.min(X.maxX,J.maxX),et=Math.min(X.maxY,J.maxY);return Math.max(0,Q-$)*Math.max(0,et-St)}function _e(X,J){return X.minX<=J.minX&&X.minY<=J.minY&&J.maxX<=X.maxX&&J.maxY<=X.maxY}function We(X,J){return J.minX<=X.maxX&&J.minY<=X.maxY&&J.maxX>=X.minX&&J.maxY>=X.minY}function kt(X){return{children:X,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function ie(X,J,$,St,Q){for(var st,et=[J,$];et.length;)!(($=et.pop())-(J=et.pop())<=St)&&(st=J+Math.ceil(($-J)/St/2)*St,yt(X,st,J,$,Q),et.push(J,st,st,$))}D.prototype={all:function(){return this._all(this.data,[])},search:function(X){var J=this.data,$=[],St=this.toBBox;if(!We(X,J))return $;for(var et,st,j,$t,Q=[];J;){for(et=0,st=J.children.length;et<st;et++)j=J.children[et],We(X,$t=J.leaf?St(j):j)&&(J.leaf?$.push(j):_e(X,$t)?this._all(j,$):Q.push(j));J=Q.pop()}return $},collides:function(X){var J=this.data,$=this.toBBox;if(!We(X,J))return!1;for(var Q,et,st,j,St=[];J;){for(Q=0,et=J.children.length;Q<et;Q++)if(st=J.children[Q],We(X,j=J.leaf?$(st):st)){if(J.leaf||_e(X,j))return!0;St.push(st)}J=St.pop()}return!1},load:function(X){if(!X||!X.length)return this;if(X.length<this._minEntries){for(var J=0,$=X.length;J<$;J++)this.insert(X[J]);return this}var St=this._build(X.slice(),0,X.length-1,0);if(this.data.children.length)if(this.data.height===St.height)this._splitRoot(this.data,St);else{if(this.data.height<St.height){var Q=this.data;this.data=St,St=Q}this._insert(St,this.data.height-St.height-1,!0)}else this.data=St;return this},insert:function(X){return X&&this._insert(X,this.data.height-1),this},clear:function(){return this.data=kt([]),this},remove:function(X,J){if(!X)return this;for(var st,j,$t,bt,$=this.data,St=this.toBBox(X),Q=[],et=[];$||Q.length;){if($||($=Q.pop(),j=Q[Q.length-1],st=et.pop(),bt=!0),$.leaf&&-1!==($t=y(X,$.children,J)))return $.children.splice($t,1),Q.push($),this._condense(Q),this;bt||$.leaf||!_e($,St)?j?(st++,$=j.children[st],bt=!1):$=null:(Q.push($),et.push(st),st=0,j=$,$=$.children[0])}return this},toBBox:function(X){return X},compareMinX:Ft,compareMinY:he,toJSON:function(){return this.data},fromJSON:function(X){return this.data=X,this},_all:function(X,J){for(var $=[];X;)X.leaf?J.push.apply(J,X.children):$.push.apply($,X.children),X=$.pop();return J},_build:function(X,J,$,St){var st,Q=$-J+1,et=this._maxEntries;if(Q<=et)return Bt(st=kt(X.slice(J,$+1)),this.toBBox),st;St||(St=Math.ceil(Math.log(Q)/Math.log(et)),et=Math.ceil(Q/Math.pow(et,St-1))),(st=kt([])).leaf=!1,st.height=St;var bt,Mt,ct,ze,j=Math.ceil(Q/et),$t=j*Math.ceil(Math.sqrt(et));for(ie(X,J,$,$t,this.compareMinX),bt=J;bt<=$;bt+=$t)for(ie(X,bt,ct=Math.min(bt+$t-1,$),j,this.compareMinY),Mt=bt;Mt<=ct;Mt+=j)ze=Math.min(Mt+j-1,ct),st.children.push(this._build(X,Mt,ze,St-1));return Bt(st,this.toBBox),st},_chooseSubtree:function(X,J,$,St){for(var Q,et,st,j,$t,bt,Mt,ct;St.push(J),!J.leaf&&St.length-1!==$;){for(Mt=ct=1/0,Q=0,et=J.children.length;Q<et;Q++)$t=Jt(st=J.children[Q]),(bt=ve(X,st)-$t)<ct?(ct=bt,Mt=$t<Mt?$t:Mt,j=st):bt===ct&&$t<Mt&&(Mt=$t,j=st);J=j||J.children[0]}return J},_insert:function(X,J,$){var Q=$?X:(0,this.toBBox)(X),et=[],st=this._chooseSubtree(Q,this.data,J,et);for(st.children.push(X),It(st,Q);J>=0&&et[J].children.length>this._maxEntries;)this._split(et,J),J--;this._adjustParentBBoxes(Q,et,J)},_split:function(X,J){var $=X[J],St=$.children.length,Q=this._minEntries;this._chooseSplitAxis($,Q,St);var et=this._chooseSplitIndex($,Q,St),st=kt($.children.splice(et,$.children.length-et));st.height=$.height,st.leaf=$.leaf,Bt($,this.toBBox),Bt(st,this.toBBox),J?X[J-1].children.push(st):this._splitRoot($,st)},_splitRoot:function(X,J){this.data=kt([X,J]),this.data.height=X.height+1,this.data.leaf=!1,Bt(this.data,this.toBBox)},_chooseSplitIndex:function(X,J,$){var St,Q,et,st,j,$t,bt,Mt;for($t=bt=1/0,St=J;St<=$-J;St++)st=ce(Q=ft(X,0,St,this.toBBox),et=ft(X,St,$,this.toBBox)),j=Jt(Q)+Jt(et),st<$t?($t=st,Mt=St,bt=j<bt?j:bt):st===$t&&j<bt&&(bt=j,Mt=St);return Mt},_chooseSplitAxis:function(X,J,$){var St=X.leaf?this.compareMinX:Ft,Q=X.leaf?this.compareMinY:he;this._allDistMargin(X,J,$,St)<this._allDistMargin(X,J,$,Q)&&X.children.sort(St)},_allDistMargin:function(X,J,$,St){X.children.sort(St);var $t,bt,Q=this.toBBox,et=ft(X,0,J,Q),st=ft(X,$-J,$,Q),j=Ze(et)+Ze(st);for($t=J;$t<$-J;$t++)bt=X.children[$t],It(et,X.leaf?Q(bt):bt),j+=Ze(et);for($t=$-J-1;$t>=J;$t--)bt=X.children[$t],It(st,X.leaf?Q(bt):bt),j+=Ze(st);return j},_adjustParentBBoxes:function(X,J,$){for(var St=$;St>=0;St--)It(J[St],X)},_condense:function(X){for(var $,J=X.length-1;J>=0;J--)0===X[J].children.length?J>0?($=X[J-1].children).splice($.indexOf(X[J]),1):this.clear():Bt(X[J],this.toBBox)},_initFormat:function(X){var J=["return a"," - b",";"];this.compareMinX=new Function("a","b",J.join(X[0])),this.compareMinY=new Function("a","b",J.join(X[1])),this.toBBox=new Function("a","return {minX: a"+X[0]+", minY: a"+X[1]+", maxX: a"+X[2]+", maxY: a"+X[3]+"};")}}},8410:(He,fe)=>{"use strict";function Et(bt,Mt,ct){void 0===ct&&(ct={});var ze={type:"Feature"};return(0===ct.id||ct.id)&&(ze.id=ct.id),ct.bbox&&(ze.bbox=ct.bbox),ze.properties=Mt||{},ze.geometry=bt,ze}function D(bt,Mt,ct){if(void 0===ct&&(ct={}),!bt)throw new Error("coordinates is required");if(!Array.isArray(bt))throw new Error("coordinates must be an Array");if(bt.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!et(bt[0])||!et(bt[1]))throw new Error("coordinates must contain numbers");return Et({type:"Point",coordinates:bt},Mt,ct)}function Bt(bt,Mt,ct){void 0===ct&&(ct={});for(var ze=0,Te=bt;ze<Te.length;ze++){var wt=Te[ze];if(wt.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var re=0;re<wt[wt.length-1].length;re++)if(wt[wt.length-1][re]!==wt[0][re])throw new Error("First and last Position are not equivalent.")}return Et({type:"Polygon",coordinates:bt},Mt,ct)}function It(bt,Mt,ct){if(void 0===ct&&(ct={}),bt.length<2)throw new Error("coordinates must be an array of two or more positions");return Et({type:"LineString",coordinates:bt},Mt,ct)}function he(bt,Mt){void 0===Mt&&(Mt={});var ct={type:"FeatureCollection"};return Mt.id&&(ct.id=Mt.id),Mt.bbox&&(ct.bbox=Mt.bbox),ct.features=bt,ct}function Jt(bt,Mt,ct){return void 0===ct&&(ct={}),Et({type:"MultiLineString",coordinates:bt},Mt,ct)}function Ze(bt,Mt,ct){return void 0===ct&&(ct={}),Et({type:"MultiPoint",coordinates:bt},Mt,ct)}function ve(bt,Mt,ct){return void 0===ct&&(ct={}),Et({type:"MultiPolygon",coordinates:bt},Mt,ct)}function We(bt,Mt){void 0===Mt&&(Mt="kilometers");var ct=fe.factors[Mt];if(!ct)throw new Error(Mt+" units is invalid");return bt*ct}function kt(bt,Mt){void 0===Mt&&(Mt="kilometers");var ct=fe.factors[Mt];if(!ct)throw new Error(Mt+" units is invalid");return bt/ct}function J(bt){return bt%(2*Math.PI)*180/Math.PI}function et(bt){return!isNaN(bt)&&null!==bt&&!Array.isArray(bt)}Object.defineProperty(fe,"__esModule",{value:!0}),fe.earthRadius=6371008.8,fe.factors={centimeters:100*fe.earthRadius,centimetres:100*fe.earthRadius,degrees:fe.earthRadius/111325,feet:3.28084*fe.earthRadius,inches:39.37*fe.earthRadius,kilometers:fe.earthRadius/1e3,kilometres:fe.earthRadius/1e3,meters:fe.earthRadius,metres:fe.earthRadius,miles:fe.earthRadius/1609.344,millimeters:1e3*fe.earthRadius,millimetres:1e3*fe.earthRadius,nauticalmiles:fe.earthRadius/1852,radians:1,yards:1.0936*fe.earthRadius},fe.unitsFactors={centimeters:100,centimetres:100,degrees:1/111325,feet:3.28084,inches:39.37,kilometers:.001,kilometres:.001,meters:1,metres:1,miles:1/1609.344,millimeters:1e3,millimetres:1e3,nauticalmiles:1/1852,radians:1/fe.earthRadius,yards:1.0936133},fe.areaFactors={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,hectares:1e-4,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:386e-9,millimeters:1e6,millimetres:1e6,yards:1.195990046},fe.feature=Et,fe.geometry=function(bt,Mt,ct){switch(void 0===ct&&(ct={}),bt){case"Point":return D(Mt).geometry;case"LineString":return It(Mt).geometry;case"Polygon":return Bt(Mt).geometry;case"MultiPoint":return Ze(Mt).geometry;case"MultiLineString":return Jt(Mt).geometry;case"MultiPolygon":return ve(Mt).geometry;default:throw new Error(bt+" is invalid")}},fe.point=D,fe.points=function(bt,Mt,ct){return void 0===ct&&(ct={}),he(bt.map(function(ze){return D(ze,Mt)}),ct)},fe.polygon=Bt,fe.polygons=function(bt,Mt,ct){return void 0===ct&&(ct={}),he(bt.map(function(ze){return Bt(ze,Mt)}),ct)},fe.lineString=It,fe.lineStrings=function(bt,Mt,ct){return void 0===ct&&(ct={}),he(bt.map(function(ze){return It(ze,Mt)}),ct)},fe.featureCollection=he,fe.multiLineString=Jt,fe.multiPoint=Ze,fe.multiPolygon=ve,fe.geometryCollection=function(bt,Mt,ct){return void 0===ct&&(ct={}),Et({type:"GeometryCollection",geometries:bt},Mt,ct)},fe.round=function(bt,Mt){if(void 0===Mt&&(Mt=0),Mt&&!(Mt>=0))throw new Error("precision must be a positive number");var ct=Math.pow(10,Mt||0);return Math.round(bt*ct)/ct},fe.radiansToLength=We,fe.lengthToRadians=kt,fe.lengthToDegrees=function(bt,Mt){return J(kt(bt,Mt))},fe.bearingToAzimuth=function(bt){var Mt=bt%360;return Mt<0&&(Mt+=360),Mt},fe.radiansToDegrees=J,fe.degreesToRadians=function(bt){return bt%360*Math.PI/180},fe.convertLength=function(bt,Mt,ct){if(void 0===Mt&&(Mt="kilometers"),void 0===ct&&(ct="kilometers"),!(bt>=0))throw new Error("length must be a positive number");return We(kt(bt,Mt),ct)},fe.convertArea=function(bt,Mt,ct){if(void 0===Mt&&(Mt="meters"),void 0===ct&&(ct="kilometers"),!(bt>=0))throw new Error("area must be a positive number");var ze=fe.areaFactors[Mt];if(!ze)throw new Error("invalid original units");var Te=fe.areaFactors[ct];if(!Te)throw new Error("invalid final units");return bt/ze*Te},fe.isNumber=et,fe.isObject=function(bt){return!!bt&&bt.constructor===Object},fe.validateBBox=function(bt){if(!bt)throw new Error("bbox is required");if(!Array.isArray(bt))throw new Error("bbox must be an Array");if(4!==bt.length&&6!==bt.length)throw new Error("bbox must be an Array of 4 or 6 numbers");bt.forEach(function(Mt){if(!et(Mt))throw new Error("bbox must only contain numbers")})},fe.validateId=function(bt){if(!bt)throw new Error("id is required");if(-1===["string","number"].indexOf(typeof bt))throw new Error("id must be a number or a string")}},3033:(He,fe,Et)=>{"use strict";Object.defineProperty(fe,"__esModule",{value:!0});var yt=Et(8410);function D($,St,Q){if(null!==$)for(var et,st,j,$t,bt,Mt,ct,wt,ze=0,Te=0,re=$.type,Tt="FeatureCollection"===re,Ht="Feature"===re,Qt=Tt?$.features.length:1,vt=0;vt<Qt;vt++){bt=(wt=!!(ct=Tt?$.features[vt].geometry:Ht?$.geometry:$)&&"GeometryCollection"===ct.type)?ct.geometries.length:1;for(var we=0;we<bt;we++){var Fe=0,Er=0;if(null!==($t=wt?ct.geometries[we]:ct)){Mt=$t.coordinates;var Oe=$t.type;switch(ze=!Q||"Polygon"!==Oe&&"MultiPolygon"!==Oe?0:1,Oe){case null:break;case"Point":if(!1===St(Mt,Te,vt,Fe,Er))return!1;Te++,Fe++;break;case"LineString":case"MultiPoint":for(et=0;et<Mt.length;et++){if(!1===St(Mt[et],Te,vt,Fe,Er))return!1;Te++,"MultiPoint"===Oe&&Fe++}"LineString"===Oe&&Fe++;break;case"Polygon":case"MultiLineString":for(et=0;et<Mt.length;et++){for(st=0;st<Mt[et].length-ze;st++){if(!1===St(Mt[et][st],Te,vt,Fe,Er))return!1;Te++}"MultiLineString"===Oe&&Fe++,"Polygon"===Oe&&Er++}"Polygon"===Oe&&Fe++;break;case"MultiPolygon":for(et=0;et<Mt.length;et++){for(Er=0,st=0;st<Mt[et].length;st++){for(j=0;j<Mt[et][st].length-ze;j++){if(!1===St(Mt[et][st][j],Te,vt,Fe,Er))return!1;Te++}Er++}Fe++}break;case"GeometryCollection":for(et=0;et<$t.geometries.length;et++)if(!1===D($t.geometries[et],St,Q))return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function Bt($,St){var Q;switch($.type){case"FeatureCollection":for(Q=0;Q<$.features.length&&!1!==St($.features[Q].properties,Q);Q++);break;case"Feature":St($.properties,0)}}function It($,St){if("Feature"===$.type)St($,0);else if("FeatureCollection"===$.type)for(var Q=0;Q<$.features.length&&!1!==St($.features[Q],Q);Q++);}function Jt($,St){var Q,et,st,j,$t,bt,Mt,ct,ze,Te,wt=0,re="FeatureCollection"===$.type,Tt="Feature"===$.type,Ht=re?$.features.length:1;for(Q=0;Q<Ht;Q++){for(ct=re?$.features[Q].properties:Tt?$.properties:{},ze=re?$.features[Q].bbox:Tt?$.bbox:void 0,Te=re?$.features[Q].id:Tt?$.id:void 0,$t=(Mt=!!(bt=re?$.features[Q].geometry:Tt?$.geometry:$)&&"GeometryCollection"===bt.type)?bt.geometries.length:1,st=0;st<$t;st++)if(null!==(j=Mt?bt.geometries[st]:bt))switch(j.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":if(!1===St(j,wt,ct,ze,Te))return!1;break;case"GeometryCollection":for(et=0;et<j.geometries.length;et++)if(!1===St(j.geometries[et],wt,ct,ze,Te))return!1;break;default:throw new Error("Unknown Geometry Type")}else if(!1===St(null,wt,ct,ze,Te))return!1;wt++}}function ve($,St){Jt($,function(Q,et,st,j,$t){var Mt,bt=null===Q?null:Q.type;switch(bt){case null:case"Point":case"LineString":case"Polygon":return!1!==St(yt.feature(Q,st,{bbox:j,id:$t}),et,0)&&void 0}switch(bt){case"MultiPoint":Mt="Point";break;case"MultiLineString":Mt="LineString";break;case"MultiPolygon":Mt="Polygon"}for(var ct=0;ct<Q.coordinates.length;ct++)if(!1===St(yt.feature({type:Mt,coordinates:Q.coordinates[ct]},st),et,ct))return!1})}function _e($,St){ve($,function(Q,et,st){var j=0;if(Q.geometry){var $t=Q.geometry.type;if("Point"!==$t&&"MultiPoint"!==$t){var bt,Mt=0,ct=0,ze=0;if(!1===D(Q,function(Te,wt,re,Tt,Ht){if(void 0===bt||et>Mt||Tt>ct||Ht>ze)return bt=Te,Mt=et,ct=Tt,ze=Ht,void(j=0);var Qt=yt.lineString([bt,Te],Q.properties);if(!1===St(Qt,et,st,Ht,j))return!1;j++,bt=Te}))return!1}}})}function kt($,St){if(!$)throw new Error("geojson is required");ve($,function(Q,et,st){if(null!==Q.geometry){var $t=Q.geometry.coordinates;switch(Q.geometry.type){case"LineString":if(!1===St(Q,et,st,0,0))return!1;break;case"Polygon":for(var bt=0;bt<$t.length;bt++)if(!1===St(yt.lineString($t[bt],Q.properties),et,st,bt))return!1}}})}fe.coordAll=function($){var St=[];return D($,function(Q){St.push(Q)}),St},fe.coordEach=D,fe.coordReduce=function($,St,Q,et){var st=Q;return D($,function(j,$t,bt,Mt,ct){st=0===$t&&void 0===Q?j:St(st,j,$t,bt,Mt,ct)},et),st},fe.featureEach=It,fe.featureReduce=function($,St,Q){var et=Q;return It($,function(st,j){et=0===j&&void 0===Q?st:St(et,st,j)}),et},fe.findPoint=function($,St){if(!yt.isObject(St=St||{}))throw new Error("options is invalid");var bt,Q=St.featureIndex||0,et=St.multiFeatureIndex||0,st=St.geometryIndex||0,j=St.coordIndex||0,$t=St.properties;switch($.type){case"FeatureCollection":Q<0&&(Q=$.features.length+Q),$t=$t||$.features[Q].properties,bt=$.features[Q].geometry;break;case"Feature":$t=$t||$.properties,bt=$.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":bt=$;break;default:throw new Error("geojson is invalid")}if(null===bt)return null;var Mt=bt.coordinates;switch(bt.type){case"Point":return yt.point(Mt,$t,St);case"MultiPoint":return et<0&&(et=Mt.length+et),yt.point(Mt[et],$t,St);case"LineString":return j<0&&(j=Mt.length+j),yt.point(Mt[j],$t,St);case"Polygon":return st<0&&(st=Mt.length+st),j<0&&(j=Mt[st].length+j),yt.point(Mt[st][j],$t,St);case"MultiLineString":return et<0&&(et=Mt.length+et),j<0&&(j=Mt[et].length+j),yt.point(Mt[et][j],$t,St);case"MultiPolygon":return et<0&&(et=Mt.length+et),st<0&&(st=Mt[et].length+st),j<0&&(j=Mt[et][st].length-j),yt.point(Mt[et][st][j],$t,St)}throw new Error("geojson is invalid")},fe.findSegment=function($,St){if(!yt.isObject(St=St||{}))throw new Error("options is invalid");var bt,Q=St.featureIndex||0,et=St.multiFeatureIndex||0,st=St.geometryIndex||0,j=St.segmentIndex||0,$t=St.properties;switch($.type){case"FeatureCollection":Q<0&&(Q=$.features.length+Q),$t=$t||$.features[Q].properties,bt=$.features[Q].geometry;break;case"Feature":$t=$t||$.properties,bt=$.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":bt=$;break;default:throw new Error("geojson is invalid")}if(null===bt)return null;var Mt=bt.coordinates;switch(bt.type){case"Point":case"MultiPoint":return null;case"LineString":return j<0&&(j=Mt.length+j-1),yt.lineString([Mt[j],Mt[j+1]],$t,St);case"Polygon":return st<0&&(st=Mt.length+st),j<0&&(j=Mt[st].length+j-1),yt.lineString([Mt[st][j],Mt[st][j+1]],$t,St);case"MultiLineString":return et<0&&(et=Mt.length+et),j<0&&(j=Mt[et].length+j-1),yt.lineString([Mt[et][j],Mt[et][j+1]],$t,St);case"MultiPolygon":return et<0&&(et=Mt.length+et),st<0&&(st=Mt[et].length+st),j<0&&(j=Mt[et][st].length-j-1),yt.lineString([Mt[et][st][j],Mt[et][st][j+1]],$t,St)}throw new Error("geojson is invalid")},fe.flattenEach=ve,fe.flattenReduce=function($,St,Q){var et=Q;return ve($,function(st,j,$t){et=0===j&&0===$t&&void 0===Q?st:St(et,st,j,$t)}),et},fe.geomEach=Jt,fe.geomReduce=function($,St,Q){var et=Q;return Jt($,function(st,j,$t,bt,Mt){et=0===j&&void 0===Q?st:St(et,st,j,$t,bt,Mt)}),et},fe.lineEach=kt,fe.lineReduce=function($,St,Q){var et=Q;return kt($,function(st,j,$t,bt){et=0===j&&void 0===Q?st:St(et,st,j,$t,bt)}),et},fe.propEach=Bt,fe.propReduce=function($,St,Q){var et=Q;return Bt($,function(st,j){et=0===j&&void 0===Q?st:St(et,st,j)}),et},fe.segmentEach=_e,fe.segmentReduce=function($,St,Q){var et=Q,st=!1;return _e($,function(j,$t,bt,Mt,ct){et=!1===st&&void 0===Q?j:St(et,j,$t,bt,Mt,ct),st=!0}),et}},9336:function(He){He.exports=function(){"use strict";function Et(y,Bt,ft,It,Ft){for(;It>ft;){if(It-ft>600){var he=It-ft+1,Jt=Bt-ft+1,Ze=Math.log(he),ve=.5*Math.exp(2*Ze/3),ce=.5*Math.sqrt(Ze*ve*(he-ve)/he)*(Jt-he/2<0?-1:1);Et(y,Bt,Math.max(ft,Math.floor(Bt-Jt*ve/he+ce)),Math.min(It,Math.floor(Bt+(he-Jt)*ve/he+ce)),Ft)}var kt=y[Bt],ie=ft,X=It;for(yt(y,ft,Bt),Ft(y[It],kt)>0&&yt(y,ft,It);ie<X;){for(yt(y,ie,X),ie++,X--;Ft(y[ie],kt)<0;)ie++;for(;Ft(y[X],kt)>0;)X--}0===Ft(y[ft],kt)?yt(y,ft,X):yt(y,++X,It),X<=Bt&&(ft=X+1),Bt<=X&&(It=X-1)}}function yt(y,Bt,ft){var It=y[Bt];y[Bt]=y[ft],y[ft]=It}function D(y,Bt){return y<Bt?-1:y>Bt?1:0}return function(y,Bt,ft,It,Ft){Et(y,Bt,ft||0,It||y.length-1,Ft||D)}}()},8309:(He,fe,Et)=>{"use strict";He.exports=D,He.exports.default=D;var yt=Et(9336);function D(X,J){if(!(this instanceof D))return new D(X,J);this._maxEntries=Math.max(4,X||9),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),J&&this._initFormat(J),this.clear()}function y(X,J,$){if(!$)return J.indexOf(X);for(var St=0;St<J.length;St++)if($(X,J[St]))return St;return-1}function Bt(X,J){ft(X,0,X.children.length,J,X)}function ft(X,J,$,St,Q){Q||(Q=kt(null)),Q.minX=1/0,Q.minY=1/0,Q.maxX=-1/0,Q.maxY=-1/0;for(var st,et=J;et<$;et++)st=X.children[et],It(Q,X.leaf?St(st):st);return Q}function It(X,J){return X.minX=Math.min(X.minX,J.minX),X.minY=Math.min(X.minY,J.minY),X.maxX=Math.max(X.maxX,J.maxX),X.maxY=Math.max(X.maxY,J.maxY),X}function Ft(X,J){return X.minX-J.minX}function he(X,J){return X.minY-J.minY}function Jt(X){return(X.maxX-X.minX)*(X.maxY-X.minY)}function Ze(X){return X.maxX-X.minX+(X.maxY-X.minY)}function ve(X,J){return(Math.max(J.maxX,X.maxX)-Math.min(J.minX,X.minX))*(Math.max(J.maxY,X.maxY)-Math.min(J.minY,X.minY))}function ce(X,J){var $=Math.max(X.minX,J.minX),St=Math.max(X.minY,J.minY),Q=Math.min(X.maxX,J.maxX),et=Math.min(X.maxY,J.maxY);return Math.max(0,Q-$)*Math.max(0,et-St)}function _e(X,J){return X.minX<=J.minX&&X.minY<=J.minY&&J.maxX<=X.maxX&&J.maxY<=X.maxY}function We(X,J){return J.minX<=X.maxX&&J.minY<=X.maxY&&J.maxX>=X.minX&&J.maxY>=X.minY}function kt(X){return{children:X,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function ie(X,J,$,St,Q){for(var st,et=[J,$];et.length;)!(($=et.pop())-(J=et.pop())<=St)&&(st=J+Math.ceil(($-J)/St/2)*St,yt(X,st,J,$,Q),et.push(J,st,st,$))}D.prototype={all:function(){return this._all(this.data,[])},search:function(X){var J=this.data,$=[],St=this.toBBox;if(!We(X,J))return $;for(var et,st,j,$t,Q=[];J;){for(et=0,st=J.children.length;et<st;et++)j=J.children[et],We(X,$t=J.leaf?St(j):j)&&(J.leaf?$.push(j):_e(X,$t)?this._all(j,$):Q.push(j));J=Q.pop()}return $},collides:function(X){var J=this.data,$=this.toBBox;if(!We(X,J))return!1;for(var Q,et,st,j,St=[];J;){for(Q=0,et=J.children.length;Q<et;Q++)if(st=J.children[Q],We(X,j=J.leaf?$(st):st)){if(J.leaf||_e(X,j))return!0;St.push(st)}J=St.pop()}return!1},load:function(X){if(!X||!X.length)return this;if(X.length<this._minEntries){for(var J=0,$=X.length;J<$;J++)this.insert(X[J]);return this}var St=this._build(X.slice(),0,X.length-1,0);if(this.data.children.length)if(this.data.height===St.height)this._splitRoot(this.data,St);else{if(this.data.height<St.height){var Q=this.data;this.data=St,St=Q}this._insert(St,this.data.height-St.height-1,!0)}else this.data=St;return this},insert:function(X){return X&&this._insert(X,this.data.height-1),this},clear:function(){return this.data=kt([]),this},remove:function(X,J){if(!X)return this;for(var st,j,$t,bt,$=this.data,St=this.toBBox(X),Q=[],et=[];$||Q.length;){if($||($=Q.pop(),j=Q[Q.length-1],st=et.pop(),bt=!0),$.leaf&&-1!==($t=y(X,$.children,J)))return $.children.splice($t,1),Q.push($),this._condense(Q),this;bt||$.leaf||!_e($,St)?j?(st++,$=j.children[st],bt=!1):$=null:(Q.push($),et.push(st),st=0,j=$,$=$.children[0])}return this},toBBox:function(X){return X},compareMinX:Ft,compareMinY:he,toJSON:function(){return this.data},fromJSON:function(X){return this.data=X,this},_all:function(X,J){for(var $=[];X;)X.leaf?J.push.apply(J,X.children):$.push.apply($,X.children),X=$.pop();return J},_build:function(X,J,$,St){var st,Q=$-J+1,et=this._maxEntries;if(Q<=et)return Bt(st=kt(X.slice(J,$+1)),this.toBBox),st;St||(St=Math.ceil(Math.log(Q)/Math.log(et)),et=Math.ceil(Q/Math.pow(et,St-1))),(st=kt([])).leaf=!1,st.height=St;var bt,Mt,ct,ze,j=Math.ceil(Q/et),$t=j*Math.ceil(Math.sqrt(et));for(ie(X,J,$,$t,this.compareMinX),bt=J;bt<=$;bt+=$t)for(ie(X,bt,ct=Math.min(bt+$t-1,$),j,this.compareMinY),Mt=bt;Mt<=ct;Mt+=j)ze=Math.min(Mt+j-1,ct),st.children.push(this._build(X,Mt,ze,St-1));return Bt(st,this.toBBox),st},_chooseSubtree:function(X,J,$,St){for(var Q,et,st,j,$t,bt,Mt,ct;St.push(J),!J.leaf&&St.length-1!==$;){for(Mt=ct=1/0,Q=0,et=J.children.length;Q<et;Q++)$t=Jt(st=J.children[Q]),(bt=ve(X,st)-$t)<ct?(ct=bt,Mt=$t<Mt?$t:Mt,j=st):bt===ct&&$t<Mt&&(Mt=$t,j=st);J=j||J.children[0]}return J},_insert:function(X,J,$){var Q=$?X:(0,this.toBBox)(X),et=[],st=this._chooseSubtree(Q,this.data,J,et);for(st.children.push(X),It(st,Q);J>=0&&et[J].children.length>this._maxEntries;)this._split(et,J),J--;this._adjustParentBBoxes(Q,et,J)},_split:function(X,J){var $=X[J],St=$.children.length,Q=this._minEntries;this._chooseSplitAxis($,Q,St);var et=this._chooseSplitIndex($,Q,St),st=kt($.children.splice(et,$.children.length-et));st.height=$.height,st.leaf=$.leaf,Bt($,this.toBBox),Bt(st,this.toBBox),J?X[J-1].children.push(st):this._splitRoot($,st)},_splitRoot:function(X,J){this.data=kt([X,J]),this.data.height=X.height+1,this.data.leaf=!1,Bt(this.data,this.toBBox)},_chooseSplitIndex:function(X,J,$){var St,Q,et,st,j,$t,bt,Mt;for($t=bt=1/0,St=J;St<=$-J;St++)st=ce(Q=ft(X,0,St,this.toBBox),et=ft(X,St,$,this.toBBox)),j=Jt(Q)+Jt(et),st<$t?($t=st,Mt=St,bt=j<bt?j:bt):st===$t&&j<bt&&(bt=j,Mt=St);return Mt},_chooseSplitAxis:function(X,J,$){var St=X.leaf?this.compareMinX:Ft,Q=X.leaf?this.compareMinY:he;this._allDistMargin(X,J,$,St)<this._allDistMargin(X,J,$,Q)&&X.children.sort(St)},_allDistMargin:function(X,J,$,St){X.children.sort(St);var $t,bt,Q=this.toBBox,et=ft(X,0,J,Q),st=ft(X,$-J,$,Q),j=Ze(et)+Ze(st);for($t=J;$t<$-J;$t++)bt=X.children[$t],It(et,X.leaf?Q(bt):bt),j+=Ze(et);for($t=$-J-1;$t>=J;$t--)bt=X.children[$t],It(st,X.leaf?Q(bt):bt),j+=Ze(st);return j},_adjustParentBBoxes:function(X,J,$){for(var St=$;St>=0;St--)It(J[St],X)},_condense:function(X){for(var $,J=X.length-1;J>=0;J--)0===X[J].children.length?J>0?($=X[J-1].children).splice($.indexOf(X[J]),1):this.clear():Bt(X[J],this.toBBox)},_initFormat:function(X){var J=["return a"," - b",";"];this.compareMinX=new Function("a","b",J.join(X[0])),this.compareMinY=new Function("a","b",J.join(X[1])),this.toBBox=new Function("a","return {minX: a"+X[0]+", minY: a"+X[1]+", maxX: a"+X[2]+", maxY: a"+X[3]+"};")}}},9568:(He,fe,Et)=>{"use strict";var yt=Et(8540),D=Et(44),y=D(yt("String.prototype.indexOf"));He.exports=function(ft,It){var Ft=yt(ft,!!It);return"function"==typeof Ft&&y(ft,".prototype.")>-1?D(Ft):Ft}},44:(He,fe,Et)=>{"use strict";var yt=Et(5396),D=Et(8540),y=D("%Function.prototype.apply%"),Bt=D("%Function.prototype.call%"),ft=D("%Reflect.apply%",!0)||yt.call(Bt,y),It=D("%Object.getOwnPropertyDescriptor%",!0),Ft=D("%Object.defineProperty%",!0),he=D("%Math.max%");if(Ft)try{Ft({},"a",{value:1})}catch(Ze){Ft=null}He.exports=function(ve){var ce=ft(yt,Bt,arguments);if(It&&Ft){var _e=It(ce,"length");_e.configurable&&Ft(ce,"length",{value:1+he(0,ve.length-(arguments.length-1))})}return ce};var Jt=function(){return ft(yt,y,arguments)};Ft?Ft(He.exports,"apply",{value:Jt}):He.exports.apply=Jt},6896:(He,fe,Et)=>{"use strict";var yt=Et(3036),D=Et(54),y=Et(5503),Bt=Et(5322).orient2d;function ft(Q,et,st){et=Math.max(0,void 0===et?2:et),st=st||0;var j=function(Q){for(var et=Q[0],st=Q[0],j=Q[0],$t=Q[0],bt=0;bt<Q.length;bt++){var Mt=Q[bt];Mt[0]<et[0]&&(et=Mt),Mt[0]>j[0]&&(j=Mt),Mt[1]<st[1]&&(st=Mt),Mt[1]>$t[1]&&($t=Mt)}var ct=[et,st,j,$t],ze=ct.slice();for(bt=0;bt<Q.length;bt++)y(Q[bt],ct)||ze.push(Q[bt]);return function(Q){Q.sort($);for(var et=[],st=0;st<Q.length;st++){for(;et.length>=2&&ve(et[et.length-2],et[et.length-1],Q[st])<=0;)et.pop();et.push(Q[st])}for(var j=[],$t=Q.length-1;$t>=0;$t--){for(;j.length>=2&&ve(j[j.length-2],j[j.length-1],Q[$t])<=0;)j.pop();j.push(Q[$t])}return j.pop(),et.pop(),et.concat(j)}(ze)}(Q),$t=new yt(16);$t.toBBox=function(Er){return{minX:Er[0],minY:Er[1],maxX:Er[0],maxY:Er[1]}},$t.compareMinX=function(Er,Oe){return Er[0]-Oe[0]},$t.compareMinY=function(Er,Oe){return Er[1]-Oe[1]},$t.load(Q);for(var ct,bt=[],Mt=0;Mt<j.length;Mt++){var ze=j[Mt];$t.remove(ze),ct=kt(ze,ct),bt.push(ct)}var Te=new yt(16);for(Mt=0;Mt<bt.length;Mt++)Te.insert(_e(bt[Mt]));for(var wt=et*et,re=st*st;bt.length;){var Tt=bt.shift(),Ht=Tt.p,Qt=Tt.next.p,vt=ie(Ht,Qt);if(!(vt<re)){var we=vt/wt;(ze=It($t,Tt.prev.p,Ht,Qt,Tt.next.next.p,we,Te))&&Math.min(ie(ze,Ht),ie(ze,Qt))<=we&&(bt.push(Tt),bt.push(kt(ze,Tt)),$t.remove(ze),Te.remove(Tt),Te.insert(_e(Tt)),Te.insert(_e(Tt.next)))}}Tt=ct;var Fe=[];do{Fe.push(Tt.p),Tt=Tt.next}while(Tt!==ct);return Fe.push(Tt.p),Fe}function It(Q,et,st,j,$t,bt,Mt){for(var ct=new D([],Ft),ze=Q.data;ze;){for(var Te=0;Te<ze.children.length;Te++){var wt=ze.children[Te],re=ze.leaf?X(wt,st,j):he(st,j,wt);re>bt||ct.push({node:wt,dist:re})}for(;ct.length&&!ct.peek().node.children;){var Tt=ct.pop(),Ht=Tt.node,Qt=X(Ht,et,st),vt=X(Ht,j,$t);if(Tt.dist<Qt&&Tt.dist<vt&&Ze(st,Ht,Mt)&&Ze(j,Ht,Mt))return Ht}(ze=ct.pop())&&(ze=ze.node)}return null}function Ft(Q,et){return Q.dist-et.dist}function he(Q,et,st){if(Jt(Q,st)||Jt(et,st))return 0;var j=J(Q[0],Q[1],et[0],et[1],st.minX,st.minY,st.maxX,st.minY);if(0===j)return 0;var $t=J(Q[0],Q[1],et[0],et[1],st.minX,st.minY,st.minX,st.maxY);if(0===$t)return 0;var bt=J(Q[0],Q[1],et[0],et[1],st.maxX,st.minY,st.maxX,st.maxY);if(0===bt)return 0;var Mt=J(Q[0],Q[1],et[0],et[1],st.minX,st.maxY,st.maxX,st.maxY);return 0===Mt?0:Math.min(j,$t,bt,Mt)}function Jt(Q,et){return Q[0]>=et.minX&&Q[0]<=et.maxX&&Q[1]>=et.minY&&Q[1]<=et.maxY}function Ze(Q,et,st){for(var j=Math.min(Q[0],et[0]),$t=Math.min(Q[1],et[1]),bt=Math.max(Q[0],et[0]),Mt=Math.max(Q[1],et[1]),ct=st.search({minX:j,minY:$t,maxX:bt,maxY:Mt}),ze=0;ze<ct.length;ze++)if(ce(ct[ze].p,ct[ze].next.p,Q,et))return!1;return!0}function ve(Q,et,st){return Bt(Q[0],Q[1],et[0],et[1],st[0],st[1])}function ce(Q,et,st,j){return Q!==j&&et!==st&&ve(Q,et,st)>0!=ve(Q,et,j)>0&&ve(st,j,Q)>0!=ve(st,j,et)>0}function _e(Q){var et=Q.p,st=Q.next.p;return Q.minX=Math.min(et[0],st[0]),Q.minY=Math.min(et[1],st[1]),Q.maxX=Math.max(et[0],st[0]),Q.maxY=Math.max(et[1],st[1]),Q}function kt(Q,et){var st={p:Q,prev:null,next:null,minX:0,minY:0,maxX:0,maxY:0};return et?(st.next=et.next,st.prev=et,et.next.prev=st,et.next=st):(st.prev=st,st.next=st),st}function ie(Q,et){var st=Q[0]-et[0],j=Q[1]-et[1];return st*st+j*j}function X(Q,et,st){var j=et[0],$t=et[1],bt=st[0]-j,Mt=st[1]-$t;if(0!==bt||0!==Mt){var ct=((Q[0]-j)*bt+(Q[1]-$t)*Mt)/(bt*bt+Mt*Mt);ct>1?(j=st[0],$t=st[1]):ct>0&&(j+=bt*ct,$t+=Mt*ct)}return(bt=Q[0]-j)*bt+(Mt=Q[1]-$t)*Mt}function J(Q,et,st,j,$t,bt,Mt,ct){var Zr,Mr,Yr,Sr,ze=st-Q,Te=j-et,wt=Mt-$t,re=ct-bt,Tt=Q-$t,Ht=et-bt,Qt=ze*ze+Te*Te,vt=ze*wt+Te*re,we=wt*wt+re*re,Fe=ze*Tt+Te*Ht,Er=wt*Tt+re*Ht,Oe=Qt*we-vt*vt,Cr=Oe,ke=Oe;0===Oe?(Mr=0,Cr=1,Sr=Er,ke=we):(Sr=Qt*Er-vt*Fe,(Mr=vt*Er-we*Fe)<0?(Mr=0,Sr=Er,ke=we):Mr>Cr&&(Mr=Cr,Sr=Er+vt,ke=we)),Sr<0?(Sr=0,-Fe<0?Mr=0:-Fe>Qt?Mr=Cr:(Mr=-Fe,Cr=Qt)):Sr>ke&&(Sr=ke,-Fe+vt<0?Mr=0:-Fe+vt>Qt?Mr=Cr:(Mr=-Fe+vt,Cr=Qt));var Jn=(1-(Yr=0===Sr?0:Sr/ke))*$t+Yr*Mt-((1-(Zr=0===Mr?0:Mr/Cr))*Q+Zr*st),le=(1-Yr)*bt+Yr*ct-((1-Zr)*et+Zr*j);return Jn*Jn+le*le}function $(Q,et){return Q[0]===et[0]?Q[1]-et[1]:Q[0]-et[0]}D.default&&(D=D.default),He.exports=ft,He.exports.default=ft},2978:(He,fe,Et)=>{var yt=Et(8507),D=Et(7316),y=Et(4269),Bt=Et(5544),ft=Et(437),It=Et(3105),Ft=Date.prototype.getTime;function Jt(ce){return null==ce}function Ze(ce){return!(!ce||"object"!=typeof ce||"number"!=typeof ce.length||"function"!=typeof ce.copy||"function"!=typeof ce.slice||ce.length>0&&"number"!=typeof ce[0])}He.exports=function he(ce,_e,We){var kt=We||{};return!!(kt.strict?y(ce,_e):ce===_e)||(!ce||!_e||"object"!=typeof ce&&"object"!=typeof _e?kt.strict?y(ce,_e):ce==_e:function(ce,_e,We){var kt,ie;if(typeof ce!=typeof _e||Jt(ce)||Jt(_e)||ce.prototype!==_e.prototype||D(ce)!==D(_e))return!1;var X=Bt(ce),J=Bt(_e);if(X!==J)return!1;if(X||J)return ce.source===_e.source&&ft(ce)===ft(_e);if(It(ce)&&It(_e))return Ft.call(ce)===Ft.call(_e);var $=Ze(ce),St=Ze(_e);if($!==St)return!1;if($||St){if(ce.length!==_e.length)return!1;for(kt=0;kt<ce.length;kt++)if(ce[kt]!==_e[kt])return!1;return!0}if(typeof ce!=typeof _e)return!1;try{var Q=yt(ce),et=yt(_e)}catch(st){return!1}if(Q.length!==et.length)return!1;for(Q.sort(),et.sort(),kt=Q.length-1;kt>=0;kt--)if(Q[kt]!=et[kt])return!1;for(kt=Q.length-1;kt>=0;kt--)if(!he(ce[ie=Q[kt]],_e[ie],We))return!1;return!0}(ce,_e,kt))}},6886:(He,fe,Et)=>{"use strict";var yt=Et(8507),D="function"==typeof Symbol&&"symbol"==typeof Symbol("foo"),y=Object.prototype.toString,Bt=Array.prototype.concat,ft=Object.defineProperty,he=ft&&function(){var ve={};try{for(var ce in ft(ve,"x",{enumerable:!1,value:ve}),ve)return!1;return ve.x===ve}catch(_e){return!1}}(),Jt=function(ve,ce,_e,We){ce in ve&&(!function(ve){return"function"==typeof ve&&"[object Function]"===y.call(ve)}(We)||!We())||(he?ft(ve,ce,{configurable:!0,enumerable:!1,value:_e,writable:!0}):ve[ce]=_e)},Ze=function(ve,ce){var _e=arguments.length>2?arguments[2]:{},We=yt(ce);D&&(We=Bt.call(We,Object.getOwnPropertySymbols(ce)));for(var kt=0;kt<We.length;kt+=1)Jt(ve,We[kt],ce[We[kt]],_e[We[kt]])};Ze.supportsDescriptors=!!he,He.exports=Ze},5810:He=>{function fe(Et,yt,D,y){this.dataset=[],this.epsilon=1,this.minPts=2,this.distance=this._euclideanDistance,this.clusters=[],this.noise=[],this._visited=[],this._assigned=[],this._datasetLength=0,this._init(Et,yt,D,y)}fe.prototype.run=function(Et,yt,D,y){this._init(Et,yt,D,y);for(var Bt=0;Bt<this._datasetLength;Bt++)if(1!==this._visited[Bt]){this._visited[Bt]=1;var ft=this._regionQuery(Bt);if(ft.length<this.minPts)this.noise.push(Bt);else{var It=this.clusters.length;this.clusters.push([]),this._addToCluster(Bt,It),this._expandCluster(It,ft)}}return this.clusters},fe.prototype._init=function(Et,yt,D,y){if(Et){if(!(Et instanceof Array))throw Error("Dataset must be of type array, "+typeof Et+" given");this.dataset=Et,this.clusters=[],this.noise=[],this._datasetLength=Et.length,this._visited=new Array(this._datasetLength),this._assigned=new Array(this._datasetLength)}yt&&(this.epsilon=yt),D&&(this.minPts=D),y&&(this.distance=y)},fe.prototype._expandCluster=function(Et,yt){for(var D=0;D<yt.length;D++){var y=yt[D];if(1!==this._visited[y]){this._visited[y]=1;var Bt=this._regionQuery(y);Bt.length>=this.minPts&&(yt=this._mergeArrays(yt,Bt))}1!==this._assigned[y]&&this._addToCluster(y,Et)}},fe.prototype._addToCluster=function(Et,yt){this.clusters[yt].push(Et),this._assigned[Et]=1},fe.prototype._regionQuery=function(Et){for(var yt=[],D=0;D<this._datasetLength;D++)this.distance(this.dataset[Et],this.dataset[D])<this.epsilon&&yt.push(D);return yt},fe.prototype._mergeArrays=function(Et,yt){for(var D=yt.length,y=0;y<D;y++){var Bt=yt[y];Et.indexOf(Bt)<0&&Et.push(Bt)}return Et},fe.prototype._euclideanDistance=function(Et,yt){for(var D=0,y=Math.min(Et.length,yt.length);y--;)D+=(Et[y]-yt[y])*(Et[y]-yt[y]);return Math.sqrt(D)},He.exports&&(He.exports=fe)},1955:He=>{function fe(Et,yt,D){this.k=3,this.dataset=[],this.assignments=[],this.centroids=[],this.init(Et,yt,D)}fe.prototype.init=function(Et,yt,D){this.assignments=[],this.centroids=[],void 0!==Et&&(this.dataset=Et),void 0!==yt&&(this.k=yt),void 0!==D&&(this.distance=D)},fe.prototype.run=function(Et,yt){this.init(Et,yt);for(var D=this.dataset.length,y=0;y<this.k;y++)this.centroids[y]=this.randomCentroid();for(var Bt=!0;Bt;){Bt=this.assign();for(var ft=0;ft<this.k;ft++){for(var It=new Array(Ze),Ft=0,he=0;he<Ze;he++)It[he]=0;for(var Jt=0;Jt<D;Jt++){var Ze=this.dataset[Jt].length;if(ft===this.assignments[Jt]){for(he=0;he<Ze;he++)It[he]+=this.dataset[Jt][he];Ft++}}if(Ft>0){for(he=0;he<Ze;he++)It[he]/=Ft;this.centroids[ft]=It}else this.centroids[ft]=this.randomCentroid(),Bt=!0}}return this.getClusters()},fe.prototype.randomCentroid=function(){var yt,D,Et=this.dataset.length-1;do{D=Math.round(Math.random()*Et),yt=this.dataset[D]}while(this.centroids.indexOf(yt)>=0);return yt},fe.prototype.assign=function(){for(var D,Et=!1,yt=this.dataset.length,y=0;y<yt;y++)(D=this.argmin(this.dataset[y],this.centroids,this.distance))!=this.assignments[y]&&(this.assignments[y]=D,Et=!0);return Et},fe.prototype.getClusters=function(){for(var yt,Et=new Array(this.k),D=0;D<this.assignments.length;D++)void 0===Et[yt=this.assignments[D]]&&(Et[yt]=[]),Et[yt].push(D);return Et},fe.prototype.argmin=function(Et,yt,D){for(var It,y=Number.MAX_VALUE,Bt=0,ft=yt.length,Ft=0;Ft<ft;Ft++)(It=D(Et,yt[Ft]))<y&&(y=It,Bt=Ft);return Bt},fe.prototype.distance=function(Et,yt){for(var D=0,y=Math.min(Et.length,yt.length);y--;){var Bt=Et[y]-yt[y];D+=Bt*Bt}return Math.sqrt(D)},He.exports&&(He.exports=fe)},5e3:(He,fe,Et)=>{if(He.exports)var yt=Et(571);function D(y,Bt,ft,It){this.epsilon=1,this.minPts=1,this.distance=this._euclideanDistance,this._reachability=[],this._processed=[],this._coreDistance=0,this._orderedList=[],this._init(y,Bt,ft,It)}D.prototype.run=function(y,Bt,ft,It){this._init(y,Bt,ft,It);for(var Ft=0,he=this.dataset.length;Ft<he;Ft++)if(1!==this._processed[Ft]){this._processed[Ft]=1,this.clusters.push([Ft]);var Jt=this.clusters.length-1;this._orderedList.push(Ft);var Ze=new yt(null,null,"asc"),ve=this._regionQuery(Ft);void 0!==this._distanceToCore(Ft)&&(this._updateQueue(Ft,ve,Ze),this._expandCluster(Jt,Ze))}return this.clusters},D.prototype.getReachabilityPlot=function(){for(var y=[],Bt=0,ft=this._orderedList.length;Bt<ft;Bt++){var It=this._orderedList[Bt];y.push([It,this._reachability[It]])}return y},D.prototype._init=function(y,Bt,ft,It){if(y){if(!(y instanceof Array))throw Error("Dataset must be of type array, "+typeof y+" given");this.dataset=y,this.clusters=[],this._reachability=new Array(this.dataset.length),this._processed=new Array(this.dataset.length),this._coreDistance=0,this._orderedList=[]}Bt&&(this.epsilon=Bt),ft&&(this.minPts=ft),It&&(this.distance=It)},D.prototype._updateQueue=function(y,Bt,ft){var It=this;this._coreDistance=this._distanceToCore(y),Bt.forEach(function(Ft){if(void 0===It._processed[Ft]){var he=It.distance(It.dataset[y],It.dataset[Ft]),Jt=Math.max(It._coreDistance,he);void 0===It._reachability[Ft]?(It._reachability[Ft]=Jt,ft.insert(Ft,Jt)):Jt<It._reachability[Ft]&&(It._reachability[Ft]=Jt,ft.remove(Ft),ft.insert(Ft,Jt))}})},D.prototype._expandCluster=function(y,Bt){for(var ft=Bt.getElements(),It=0,Ft=ft.length;It<Ft;It++){var he=ft[It];if(void 0===this._processed[he]){var Jt=this._regionQuery(he);this._processed[he]=1,this.clusters[y].push(he),this._orderedList.push(he),void 0!==this._distanceToCore(he)&&(this._updateQueue(he,Jt,Bt),this._expandCluster(y,Bt))}}},D.prototype._distanceToCore=function(y){for(var Bt=this.epsilon,ft=0;ft<Bt;ft++)if(this._regionQuery(y,ft).length>=this.minPts)return ft},D.prototype._regionQuery=function(y,Bt){Bt=Bt||this.epsilon;for(var ft=[],It=0,Ft=this.dataset.length;It<Ft;It++)this.distance(this.dataset[y],this.dataset[It])<Bt&&ft.push(It);return ft},D.prototype._euclideanDistance=function(y,Bt){for(var ft=0,It=Math.min(y.length,Bt.length);It--;)ft+=(y[It]-Bt[It])*(y[It]-Bt[It]);return Math.sqrt(ft)},He.exports&&(He.exports=D)},571:He=>{function fe(Et,yt,D){this._queue=[],this._priorities=[],this._sorting="desc",this._init(Et,yt,D)}fe.prototype.insert=function(Et,yt){for(var D=this._queue.length,y=D;y--;){var Bt=this._priorities[y];"desc"===this._sorting?yt>Bt&&(D=y):yt<Bt&&(D=y)}this._insertAt(Et,yt,D)},fe.prototype.remove=function(Et){for(var yt=this._queue.length;yt--;)if(Et===this._queue[yt]){this._queue.splice(yt,1),this._priorities.splice(yt,1);break}},fe.prototype.forEach=function(Et){this._queue.forEach(Et)},fe.prototype.getElements=function(){return this._queue},fe.prototype.getElementPriority=function(Et){return this._priorities[Et]},fe.prototype.getPriorities=function(){return this._priorities},fe.prototype.getElementsWithPriorities=function(){for(var Et=[],yt=0,D=this._queue.length;yt<D;yt++)Et.push([this._queue[yt],this._priorities[yt]]);return Et},fe.prototype._init=function(Et,yt,D){if(Et&&yt){if(this._queue=[],this._priorities=[],Et.length!==yt.length)throw new Error("Arrays must have the same length");for(var y=0;y<Et.length;y++)this.insert(Et[y],yt[y])}D&&(this._sorting=D)},fe.prototype._insertAt=function(Et,yt,D){this._queue.length===D?(this._queue.push(Et),this._priorities.push(yt)):(this._queue.splice(D,0,Et),this._priorities.splice(D,0,yt))},He.exports&&(He.exports=fe)},6882:(He,fe,Et)=>{He.exports&&(He.exports={DBSCAN:Et(5810),KMEANS:Et(1955),OPTICS:Et(5e3),PriorityQueue:Et(571)})},1604:He=>{"use strict";function fe(wt,re,Tt){Tt=Tt||2;var Fe,Er,Oe,Zr,Mr,Yr,Sr,Ht=re&&re.length,Qt=Ht?re[0]*Tt:wt.length,vt=Et(wt,0,Qt,Tt,!0),we=[];if(!vt||vt.next===vt.prev)return we;if(Ht&&(vt=function(wt,re,Tt,Ht){var vt,we,Oe,Qt=[];for(vt=0,we=re.length;vt<we;vt++)(Oe=Et(wt,re[vt]*Ht,vt<we-1?re[vt+1]*Ht:wt.length,Ht,!1))===Oe.next&&(Oe.steiner=!0),Qt.push(kt(Oe));for(Qt.sort(he),vt=0;vt<Qt.length;vt++)Tt=yt(Tt=Jt(Qt[vt],Tt),Tt.next);return Tt}(wt,re,vt,Tt)),wt.length>80*Tt){Fe=Oe=wt[0],Er=Zr=wt[1];for(var Cr=Tt;Cr<Qt;Cr+=Tt)(Mr=wt[Cr])<Fe&&(Fe=Mr),(Yr=wt[Cr+1])<Er&&(Er=Yr),Mr>Oe&&(Oe=Mr),Yr>Zr&&(Zr=Yr);Sr=0!==(Sr=Math.max(Oe-Fe,Zr-Er))?1/Sr:0}return D(vt,we,Tt,Fe,Er,Sr),we}function Et(wt,re,Tt,Ht,Qt){var vt,we;if(Qt===Te(wt,re,Tt,Ht)>0)for(vt=re;vt<Tt;vt+=Ht)we=Mt(vt,wt[vt],wt[vt+1],we);else for(vt=Tt-Ht;vt>=re;vt-=Ht)we=Mt(vt,wt[vt],wt[vt+1],we);return we&&$(we,we.next)&&(ct(we),we=we.next),we}function yt(wt,re){if(!wt)return wt;re||(re=wt);var Ht,Tt=wt;do{if(Ht=!1,Tt.steiner||!$(Tt,Tt.next)&&0!==J(Tt.prev,Tt,Tt.next))Tt=Tt.next;else{if(ct(Tt),(Tt=re=Tt.prev)===Tt.next)break;Ht=!0}}while(Ht||Tt!==re);return re}function D(wt,re,Tt,Ht,Qt,vt,we){if(wt){!we&&vt&&function(wt,re,Tt,Ht){var Qt=wt;do{null===Qt.z&&(Qt.z=We(Qt.x,Qt.y,re,Tt,Ht)),Qt.prevZ=Qt.prev,Qt.nextZ=Qt.next,Qt=Qt.next}while(Qt!==wt);Qt.prevZ.nextZ=null,Qt.prevZ=null,function(wt){var re,Tt,Ht,Qt,vt,we,Fe,Er,Oe=1;do{for(Tt=wt,wt=null,vt=null,we=0;Tt;){for(we++,Ht=Tt,Fe=0,re=0;re<Oe&&(Fe++,Ht=Ht.nextZ);re++);for(Er=Oe;Fe>0||Er>0&&Ht;)0!==Fe&&(0===Er||!Ht||Tt.z<=Ht.z)?(Qt=Tt,Tt=Tt.nextZ,Fe--):(Qt=Ht,Ht=Ht.nextZ,Er--),vt?vt.nextZ=Qt:wt=Qt,Qt.prevZ=vt,vt=Qt;Tt=Ht}vt.nextZ=null,Oe*=2}while(we>1)}(Qt)}(wt,Ht,Qt,vt);for(var Er,Oe,Fe=wt;wt.prev!==wt.next;)if(Er=wt.prev,Oe=wt.next,vt?Bt(wt,Ht,Qt,vt):y(wt))re.push(Er.i/Tt),re.push(wt.i/Tt),re.push(Oe.i/Tt),ct(wt),wt=Oe.next,Fe=Oe.next;else if((wt=Oe)===Fe){we?1===we?D(wt=ft(yt(wt),re,Tt),re,Tt,Ht,Qt,vt,2):2===we&&It(wt,re,Tt,Ht,Qt,vt):D(yt(wt),re,Tt,Ht,Qt,vt,1);break}}}function y(wt){var re=wt.prev,Tt=wt,Ht=wt.next;if(J(re,Tt,Ht)>=0)return!1;for(var Qt=wt.next.next;Qt!==wt.prev;){if(ie(re.x,re.y,Tt.x,Tt.y,Ht.x,Ht.y,Qt.x,Qt.y)&&J(Qt.prev,Qt,Qt.next)>=0)return!1;Qt=Qt.next}return!0}function Bt(wt,re,Tt,Ht){var Qt=wt.prev,vt=wt,we=wt.next;if(J(Qt,vt,we)>=0)return!1;for(var Oe=Qt.x>vt.x?Qt.x>we.x?Qt.x:we.x:vt.x>we.x?vt.x:we.x,Zr=Qt.y>vt.y?Qt.y>we.y?Qt.y:we.y:vt.y>we.y?vt.y:we.y,Mr=We(Qt.x<vt.x?Qt.x<we.x?Qt.x:we.x:vt.x<we.x?vt.x:we.x,Qt.y<vt.y?Qt.y<we.y?Qt.y:we.y:vt.y<we.y?vt.y:we.y,re,Tt,Ht),Yr=We(Oe,Zr,re,Tt,Ht),Sr=wt.prevZ,Cr=wt.nextZ;Sr&&Sr.z>=Mr&&Cr&&Cr.z<=Yr;){if(Sr!==wt.prev&&Sr!==wt.next&&ie(Qt.x,Qt.y,vt.x,vt.y,we.x,we.y,Sr.x,Sr.y)&&J(Sr.prev,Sr,Sr.next)>=0||(Sr=Sr.prevZ,Cr!==wt.prev&&Cr!==wt.next&&ie(Qt.x,Qt.y,vt.x,vt.y,we.x,we.y,Cr.x,Cr.y)&&J(Cr.prev,Cr,Cr.next)>=0))return!1;Cr=Cr.nextZ}for(;Sr&&Sr.z>=Mr;){if(Sr!==wt.prev&&Sr!==wt.next&&ie(Qt.x,Qt.y,vt.x,vt.y,we.x,we.y,Sr.x,Sr.y)&&J(Sr.prev,Sr,Sr.next)>=0)return!1;Sr=Sr.prevZ}for(;Cr&&Cr.z<=Yr;){if(Cr!==wt.prev&&Cr!==wt.next&&ie(Qt.x,Qt.y,vt.x,vt.y,we.x,we.y,Cr.x,Cr.y)&&J(Cr.prev,Cr,Cr.next)>=0)return!1;Cr=Cr.nextZ}return!0}function ft(wt,re,Tt){var Ht=wt;do{var Qt=Ht.prev,vt=Ht.next.next;!$(Qt,vt)&&St(Qt,Ht,Ht.next,vt)&&j(Qt,vt)&&j(vt,Qt)&&(re.push(Qt.i/Tt),re.push(Ht.i/Tt),re.push(vt.i/Tt),ct(Ht),ct(Ht.next),Ht=wt=vt),Ht=Ht.next}while(Ht!==wt);return yt(Ht)}function It(wt,re,Tt,Ht,Qt,vt){var we=wt;do{for(var Fe=we.next.next;Fe!==we.prev;){if(we.i!==Fe.i&&X(we,Fe)){var Er=bt(we,Fe);return we=yt(we,we.next),Er=yt(Er,Er.next),D(we,re,Tt,Ht,Qt,vt),void D(Er,re,Tt,Ht,Qt,vt)}Fe=Fe.next}we=we.next}while(we!==wt)}function he(wt,re){return wt.x-re.x}function Jt(wt,re){var Tt=function(wt,re){var we,Tt=re,Ht=wt.x,Qt=wt.y,vt=-1/0;do{if(Qt<=Tt.y&&Qt>=Tt.next.y&&Tt.next.y!==Tt.y){var Fe=Tt.x+(Qt-Tt.y)*(Tt.next.x-Tt.x)/(Tt.next.y-Tt.y);if(Fe<=Ht&&Fe>vt){if(vt=Fe,Fe===Ht){if(Qt===Tt.y)return Tt;if(Qt===Tt.next.y)return Tt.next}we=Tt.x<Tt.next.x?Tt:Tt.next}}Tt=Tt.next}while(Tt!==re);if(!we)return null;if(Ht===vt)return we;var Yr,Er=we,Oe=we.x,Zr=we.y,Mr=1/0;Tt=we;do{Ht>=Tt.x&&Tt.x>=Oe&&Ht!==Tt.x&&ie(Qt<Zr?Ht:vt,Qt,Oe,Zr,Qt<Zr?vt:Ht,Qt,Tt.x,Tt.y)&&(Yr=Math.abs(Qt-Tt.y)/(Ht-Tt.x),j(Tt,wt)&&(Yr<Mr||Yr===Mr&&(Tt.x>we.x||Tt.x===we.x&&ve(we,Tt)))&&(we=Tt,Mr=Yr)),Tt=Tt.next}while(Tt!==Er);return we}(wt,re);if(!Tt)return re;var Ht=bt(Tt,wt),Qt=yt(Tt,Tt.next);return yt(Ht,Ht.next),re===Tt?Qt:re}function ve(wt,re){return J(wt.prev,wt,re.prev)<0&&J(re.next,wt,wt.next)<0}function We(wt,re,Tt,Ht,Qt){return(wt=1431655765&((wt=858993459&((wt=252645135&((wt=16711935&((wt=32767*(wt-Tt)*Qt)|wt<<8))|wt<<4))|wt<<2))|wt<<1))|(re=1431655765&((re=858993459&((re=252645135&((re=16711935&((re=32767*(re-Ht)*Qt)|re<<8))|re<<4))|re<<2))|re<<1))<<1}function kt(wt){var re=wt,Tt=wt;do{(re.x<Tt.x||re.x===Tt.x&&re.y<Tt.y)&&(Tt=re),re=re.next}while(re!==wt);return Tt}function ie(wt,re,Tt,Ht,Qt,vt,we,Fe){return(Qt-we)*(re-Fe)-(wt-we)*(vt-Fe)>=0&&(wt-we)*(Ht-Fe)-(Tt-we)*(re-Fe)>=0&&(Tt-we)*(vt-Fe)-(Qt-we)*(Ht-Fe)>=0}function X(wt,re){return wt.next.i!==re.i&&wt.prev.i!==re.i&&!function(wt,re){var Tt=wt;do{if(Tt.i!==wt.i&&Tt.next.i!==wt.i&&Tt.i!==re.i&&Tt.next.i!==re.i&&St(Tt,Tt.next,wt,re))return!0;Tt=Tt.next}while(Tt!==wt);return!1}(wt,re)&&(j(wt,re)&&j(re,wt)&&function(wt,re){var Tt=wt,Ht=!1,Qt=(wt.x+re.x)/2,vt=(wt.y+re.y)/2;do{Tt.y>vt!=Tt.next.y>vt&&Tt.next.y!==Tt.y&&Qt<(Tt.next.x-Tt.x)*(vt-Tt.y)/(Tt.next.y-Tt.y)+Tt.x&&(Ht=!Ht),Tt=Tt.next}while(Tt!==wt);return Ht}(wt,re)&&(J(wt.prev,wt,re.prev)||J(wt,re.prev,re))||$(wt,re)&&J(wt.prev,wt,wt.next)>0&&J(re.prev,re,re.next)>0)}function J(wt,re,Tt){return(re.y-wt.y)*(Tt.x-re.x)-(re.x-wt.x)*(Tt.y-re.y)}function $(wt,re){return wt.x===re.x&&wt.y===re.y}function St(wt,re,Tt,Ht){var Qt=et(J(wt,re,Tt)),vt=et(J(wt,re,Ht)),we=et(J(Tt,Ht,wt)),Fe=et(J(Tt,Ht,re));return!!(Qt!==vt&&we!==Fe||0===Qt&&Q(wt,Tt,re)||0===vt&&Q(wt,Ht,re)||0===we&&Q(Tt,wt,Ht)||0===Fe&&Q(Tt,re,Ht))}function Q(wt,re,Tt){return re.x<=Math.max(wt.x,Tt.x)&&re.x>=Math.min(wt.x,Tt.x)&&re.y<=Math.max(wt.y,Tt.y)&&re.y>=Math.min(wt.y,Tt.y)}function et(wt){return wt>0?1:wt<0?-1:0}function j(wt,re){return J(wt.prev,wt,wt.next)<0?J(wt,re,wt.next)>=0&&J(wt,wt.prev,re)>=0:J(wt,re,wt.prev)<0||J(wt,wt.next,re)<0}function bt(wt,re){var Tt=new ze(wt.i,wt.x,wt.y),Ht=new ze(re.i,re.x,re.y),Qt=wt.next,vt=re.prev;return wt.next=re,re.prev=wt,Tt.next=Qt,Qt.prev=Tt,Ht.next=Tt,Tt.prev=Ht,vt.next=Ht,Ht.prev=vt,Ht}function Mt(wt,re,Tt,Ht){var Qt=new ze(wt,re,Tt);return Ht?(Qt.next=Ht.next,Qt.prev=Ht,Ht.next.prev=Qt,Ht.next=Qt):(Qt.prev=Qt,Qt.next=Qt),Qt}function ct(wt){wt.next.prev=wt.prev,wt.prev.next=wt.next,wt.prevZ&&(wt.prevZ.nextZ=wt.nextZ),wt.nextZ&&(wt.nextZ.prevZ=wt.prevZ)}function ze(wt,re,Tt){this.i=wt,this.x=re,this.y=Tt,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Te(wt,re,Tt,Ht){for(var Qt=0,vt=re,we=Tt-Ht;vt<Tt;vt+=Ht)Qt+=(wt[we]-wt[vt])*(wt[vt+1]+wt[we+1]),we=vt;return Qt}He.exports=fe,He.exports.default=fe,fe.deviation=function(wt,re,Tt,Ht){var Qt=re&&re.length,we=Math.abs(Te(wt,0,Qt?re[0]*Tt:wt.length,Tt));if(Qt)for(var Fe=0,Er=re.length;Fe<Er;Fe++)we-=Math.abs(Te(wt,re[Fe]*Tt,Fe<Er-1?re[Fe+1]*Tt:wt.length,Tt));var Mr=0;for(Fe=0;Fe<Ht.length;Fe+=3){var Yr=Ht[Fe]*Tt,Sr=Ht[Fe+1]*Tt,Cr=Ht[Fe+2]*Tt;Mr+=Math.abs((wt[Yr]-wt[Cr])*(wt[Sr+1]-wt[Yr+1])-(wt[Yr]-wt[Sr])*(wt[Cr+1]-wt[Yr+1]))}return 0===we&&0===Mr?0:Math.abs((Mr-we)/we)},fe.flatten=function(wt){for(var re=wt[0][0].length,Tt={vertices:[],holes:[],dimensions:re},Ht=0,Qt=0;Qt<wt.length;Qt++){for(var vt=0;vt<wt[Qt].length;vt++)for(var we=0;we<re;we++)Tt.vertices.push(wt[Qt][vt][we]);Qt>0&&Tt.holes.push(Ht+=wt[Qt-1].length)}return Tt}},1609:He=>{"use strict";var fe="Function.prototype.bind called on incompatible ",Et=Array.prototype.slice,yt=Object.prototype.toString,D="[object Function]";He.exports=function(Bt){var ft=this;if("function"!=typeof ft||yt.call(ft)!==D)throw new TypeError(fe+ft);for(var Ft,It=Et.call(arguments,1),he=function(){if(this instanceof Ft){var _e=ft.apply(this,It.concat(Et.call(arguments)));return Object(_e)===_e?_e:this}return ft.apply(Bt,It.concat(Et.call(arguments)))},Jt=Math.max(0,ft.length-It.length),Ze=[],ve=0;ve<Jt;ve++)Ze.push("$"+ve);if(Ft=Function("binder","return function ("+Ze.join(",")+"){ return binder.apply(this,arguments); }")(he),ft.prototype){var ce=function(){};ce.prototype=ft.prototype,Ft.prototype=new ce,ce.prototype=null}return Ft}},5396:(He,fe,Et)=>{"use strict";var yt=Et(1609);He.exports=Function.prototype.bind||yt},9331:(He,fe,Et)=>{var yt=Et(2978),D=function(It){this.precision=It&&It.precision?It.precision:17,this.direction=!(!It||!It.direction)&&It.direction,this.pseudoNode=!(!It||!It.pseudoNode)&&It.pseudoNode,this.objectComparator=It&&It.objectComparator?It.objectComparator:ft};function y(It){return It.coordinates.map(function(Ft){return{type:It.type.replace("Multi",""),coordinates:Ft}})}function Bt(It,Ft){return It.hasOwnProperty("coordinates")?It.coordinates.length===Ft.coordinates.length:It.length===Ft.length}function ft(It,Ft){return yt(It,Ft,{strict:!0})}D.prototype.compare=function(It,Ft){if(It.type!==Ft.type||!Bt(It,Ft))return!1;switch(It.type){case"Point":return this.compareCoord(It.coordinates,Ft.coordinates);case"LineString":return this.compareLine(It.coordinates,Ft.coordinates,0,!1);case"Polygon":return this.comparePolygon(It,Ft);case"Feature":return this.compareFeature(It,Ft);default:if(0===It.type.indexOf("Multi")){var he=this,Jt=y(It),Ze=y(Ft);return Jt.every(function(ve){return this.some(function(ce){return he.compare(ve,ce)})},Ze)}}return!1},D.prototype.compareCoord=function(It,Ft){if(It.length!==Ft.length)return!1;for(var he=0;he<It.length;he++)if(It[he].toFixed(this.precision)!==Ft[he].toFixed(this.precision))return!1;return!0},D.prototype.compareLine=function(It,Ft,he,Jt){if(!Bt(It,Ft))return!1;var Ze=this.pseudoNode?It:this.removePseudo(It),ve=this.pseudoNode?Ft:this.removePseudo(Ft);if(!Jt||this.compareCoord(Ze[0],ve[0])||(ve=this.fixStartIndex(ve,Ze))){var ce=this.compareCoord(Ze[he],ve[he]);return this.direction||ce?this.comparePath(Ze,ve):!!this.compareCoord(Ze[he],ve[ve.length-(1+he)])&&this.comparePath(Ze.slice().reverse(),ve)}},D.prototype.fixStartIndex=function(It,Ft){for(var he,Jt=-1,Ze=0;Ze<It.length;Ze++)if(this.compareCoord(It[Ze],Ft[0])){Jt=Ze;break}return Jt>=0&&(he=[].concat(It.slice(Jt,It.length),It.slice(1,Jt+1))),he},D.prototype.comparePath=function(It,Ft){var he=this;return It.every(function(Jt,Ze){return he.compareCoord(Jt,this[Ze])},Ft)},D.prototype.comparePolygon=function(It,Ft){if(this.compareLine(It.coordinates[0],Ft.coordinates[0],1,!0)){var he=It.coordinates.slice(1,It.coordinates.length),Jt=Ft.coordinates.slice(1,Ft.coordinates.length),Ze=this;return he.every(function(ve){return this.some(function(ce){return Ze.compareLine(ve,ce,1,!0)})},Jt)}return!1},D.prototype.compareFeature=function(It,Ft){return!(It.id!==Ft.id||!this.objectComparator(It.properties,Ft.properties)||!this.compareBBox(It,Ft))&&this.compare(It.geometry,Ft.geometry)},D.prototype.compareBBox=function(It,Ft){return!!(!It.bbox&&!Ft.bbox||It.bbox&&Ft.bbox&&this.compareCoord(It.bbox,Ft.bbox))},D.prototype.removePseudo=function(It){return It},He.exports=D},2689:(He,fe,Et)=>{var yt=Et(3036),D=Et(8410),y=Et(3033),Bt=Et(185).Z,ft=y.featureEach,he=D.featureCollection;function Jt(Ze){var ve=new yt(Ze);return ve.insert=function(ce){if("Feature"!==ce.type)throw new Error("invalid feature");return ce.bbox=ce.bbox?ce.bbox:Bt(ce),yt.prototype.insert.call(this,ce)},ve.load=function(ce){var _e=[];return Array.isArray(ce)?ce.forEach(function(We){if("Feature"!==We.type)throw new Error("invalid features");We.bbox=We.bbox?We.bbox:Bt(We),_e.push(We)}):ft(ce,function(We){if("Feature"!==We.type)throw new Error("invalid features");We.bbox=We.bbox?We.bbox:Bt(We),_e.push(We)}),yt.prototype.load.call(this,_e)},ve.remove=function(ce,_e){if("Feature"!==ce.type)throw new Error("invalid feature");return ce.bbox=ce.bbox?ce.bbox:Bt(ce),yt.prototype.remove.call(this,ce,_e)},ve.clear=function(){return yt.prototype.clear.call(this)},ve.search=function(ce){var _e=yt.prototype.search.call(this,this.toBBox(ce));return he(_e)},ve.collides=function(ce){return yt.prototype.collides.call(this,this.toBBox(ce))},ve.all=function(){var ce=yt.prototype.all.call(this);return he(ce)},ve.toJSON=function(){return yt.prototype.toJSON.call(this)},ve.fromJSON=function(ce){return yt.prototype.fromJSON.call(this,ce)},ve.toBBox=function(ce){var _e;if(ce.bbox)_e=ce.bbox;else if(Array.isArray(ce)&&4===ce.length)_e=ce;else if(Array.isArray(ce)&&6===ce.length)_e=[ce[0],ce[1],ce[3],ce[4]];else if("Feature"===ce.type)_e=Bt(ce);else{if("FeatureCollection"!==ce.type)throw new Error("invalid geojson");_e=Bt(ce)}return{minX:_e[0],minY:_e[1],maxX:_e[2],maxY:_e[3]}},ve}He.exports=Jt,He.exports.default=Jt},8540:(He,fe,Et)=>{"use strict";var yt,D=SyntaxError,y=Function,Bt=TypeError,ft=function(bt){try{return y('"use strict"; return ('+bt+").constructor;")()}catch(Mt){}},It=Object.getOwnPropertyDescriptor;if(It)try{It({},"")}catch(bt){It=null}var Ft=function(){throw new Bt},he=It?function(){try{return Ft}catch(bt){try{return It(arguments,"callee").get}catch(Mt){return Ft}}}():Ft,Jt=Et(9326)(),Ze=Object.getPrototypeOf||function(bt){return bt.__proto__},ve={},ce="undefined"==typeof Uint8Array?yt:Ze(Uint8Array),_e={"%AggregateError%":"undefined"==typeof AggregateError?yt:AggregateError,"%Array%":Array,"%ArrayBuffer%":"undefined"==typeof ArrayBuffer?yt:ArrayBuffer,"%ArrayIteratorPrototype%":Jt?Ze([][Symbol.iterator]()):yt,"%AsyncFromSyncIteratorPrototype%":yt,"%AsyncFunction%":ve,"%AsyncGenerator%":ve,"%AsyncGeneratorFunction%":ve,"%AsyncIteratorPrototype%":ve,"%Atomics%":"undefined"==typeof Atomics?yt:Atomics,"%BigInt%":"undefined"==typeof BigInt?yt:BigInt,"%Boolean%":Boolean,"%DataView%":"undefined"==typeof DataView?yt:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":Error,"%eval%":eval,"%EvalError%":EvalError,"%Float32Array%":"undefined"==typeof Float32Array?yt:Float32Array,"%Float64Array%":"undefined"==typeof Float64Array?yt:Float64Array,"%FinalizationRegistry%":"undefined"==typeof FinalizationRegistry?yt:FinalizationRegistry,"%Function%":y,"%GeneratorFunction%":ve,"%Int8Array%":"undefined"==typeof Int8Array?yt:Int8Array,"%Int16Array%":"undefined"==typeof Int16Array?yt:Int16Array,"%Int32Array%":"undefined"==typeof Int32Array?yt:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":Jt?Ze(Ze([][Symbol.iterator]())):yt,"%JSON%":"object"==typeof JSON?JSON:yt,"%Map%":"undefined"==typeof Map?yt:Map,"%MapIteratorPrototype%":"undefined"!=typeof Map&&Jt?Ze((new Map)[Symbol.iterator]()):yt,"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":"undefined"==typeof Promise?yt:Promise,"%Proxy%":"undefined"==typeof Proxy?yt:Proxy,"%RangeError%":RangeError,"%ReferenceError%":ReferenceError,"%Reflect%":"undefined"==typeof Reflect?yt:Reflect,"%RegExp%":RegExp,"%Set%":"undefined"==typeof Set?yt:Set,"%SetIteratorPrototype%":"undefined"!=typeof Set&&Jt?Ze((new Set)[Symbol.iterator]()):yt,"%SharedArrayBuffer%":"undefined"==typeof SharedArrayBuffer?yt:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":Jt?Ze(""[Symbol.iterator]()):yt,"%Symbol%":Jt?Symbol:yt,"%SyntaxError%":D,"%ThrowTypeError%":he,"%TypedArray%":ce,"%TypeError%":Bt,"%Uint8Array%":"undefined"==typeof Uint8Array?yt:Uint8Array,"%Uint8ClampedArray%":"undefined"==typeof Uint8ClampedArray?yt:Uint8ClampedArray,"%Uint16Array%":"undefined"==typeof Uint16Array?yt:Uint16Array,"%Uint32Array%":"undefined"==typeof Uint32Array?yt:Uint32Array,"%URIError%":URIError,"%WeakMap%":"undefined"==typeof WeakMap?yt:WeakMap,"%WeakRef%":"undefined"==typeof WeakRef?yt:WeakRef,"%WeakSet%":"undefined"==typeof WeakSet?yt:WeakSet},We=function bt(Mt){var ct;if("%AsyncFunction%"===Mt)ct=ft("async function () {}");else if("%GeneratorFunction%"===Mt)ct=ft("function* () {}");else if("%AsyncGeneratorFunction%"===Mt)ct=ft("async function* () {}");else if("%AsyncGenerator%"===Mt){var ze=bt("%AsyncGeneratorFunction%");ze&&(ct=ze.prototype)}else if("%AsyncIteratorPrototype%"===Mt){var Te=bt("%AsyncGenerator%");Te&&(ct=Ze(Te.prototype))}return _e[Mt]=ct,ct},kt={"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},ie=Et(5396),X=Et(7709),J=ie.call(Function.call,Array.prototype.concat),$=ie.call(Function.apply,Array.prototype.splice),St=ie.call(Function.call,String.prototype.replace),Q=ie.call(Function.call,String.prototype.slice),et=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,st=/\\(\\)?/g,j=function(Mt){var ct=Q(Mt,0,1),ze=Q(Mt,-1);if("%"===ct&&"%"!==ze)throw new D("invalid intrinsic syntax, expected closing `%`");if("%"===ze&&"%"!==ct)throw new D("invalid intrinsic syntax, expected opening `%`");var Te=[];return St(Mt,et,function(wt,re,Tt,Ht){Te[Te.length]=Tt?St(Ht,st,"$1"):re||wt}),Te},$t=function(Mt,ct){var Te,ze=Mt;if(X(kt,ze)&&(ze="%"+(Te=kt[ze])[0]+"%"),X(_e,ze)){var wt=_e[ze];if(wt===ve&&(wt=We(ze)),void 0===wt&&!ct)throw new Bt("intrinsic "+Mt+" exists, but is not available. Please file an issue!");return{alias:Te,name:ze,value:wt}}throw new D("intrinsic "+Mt+" does not exist!")};He.exports=function(Mt,ct){if("string"!=typeof Mt||0===Mt.length)throw new Bt("intrinsic name must be a non-empty string");if(arguments.length>1&&"boolean"!=typeof ct)throw new Bt('"allowMissing" argument must be a boolean');var ze=j(Mt),Te=ze.length>0?ze[0]:"",wt=$t("%"+Te+"%",ct),re=wt.name,Tt=wt.value,Ht=!1,Qt=wt.alias;Qt&&(Te=Qt[0],$(ze,J([0,1],Qt)));for(var vt=1,we=!0;vt<ze.length;vt+=1){var Fe=ze[vt],Er=Q(Fe,0,1),Oe=Q(Fe,-1);if(('"'===Er||"'"===Er||"`"===Er||'"'===Oe||"'"===Oe||"`"===Oe)&&Er!==Oe)throw new D("property names with quotes must have matching quotes");if(("constructor"===Fe||!we)&&(Ht=!0),X(_e,re="%"+(Te+="."+Fe)+"%"))Tt=_e[re];else if(null!=Tt){if(!(Fe in Tt)){if(!ct)throw new Bt("base intrinsic for "+Mt+" exists, but the property is not available.");return}if(It&&vt+1>=ze.length){var Zr=It(Tt,Fe);Tt=(we=!!Zr)&&"get"in Zr&&!("originalValue"in Zr.get)?Zr.get:Tt[Fe]}else we=X(Tt,Fe),Tt=Tt[Fe];we&&!Ht&&(_e[re]=Tt)}}return Tt}},9326:(He,fe,Et)=>{"use strict";var yt="undefined"!=typeof Symbol&&Symbol,D=Et(9045);He.exports=function(){return"function"==typeof yt&&"function"==typeof Symbol&&"symbol"==typeof yt("foo")&&"symbol"==typeof Symbol("bar")&&D()}},9045:He=>{"use strict";He.exports=function(){if("function"!=typeof Symbol||"function"!=typeof Object.getOwnPropertySymbols)return!1;if("symbol"==typeof Symbol.iterator)return!0;var Et={},yt=Symbol("test"),D=Object(yt);if("string"==typeof yt||"[object Symbol]"!==Object.prototype.toString.call(yt)||"[object Symbol]"!==Object.prototype.toString.call(D))return!1;for(yt in Et[yt]=42,Et)return!1;if("function"==typeof Object.keys&&0!==Object.keys(Et).length||"function"==typeof Object.getOwnPropertyNames&&0!==Object.getOwnPropertyNames(Et).length)return!1;var Bt=Object.getOwnPropertySymbols(Et);if(1!==Bt.length||Bt[0]!==yt||!Object.prototype.propertyIsEnumerable.call(Et,yt))return!1;if("function"==typeof Object.getOwnPropertyDescriptor){var ft=Object.getOwnPropertyDescriptor(Et,yt);if(42!==ft.value||!0!==ft.enumerable)return!1}return!0}},1407:(He,fe,Et)=>{"use strict";var yt=Et(9045);He.exports=function(){return yt()&&!!Symbol.toStringTag}},7709:(He,fe,Et)=>{"use strict";var yt=Et(5396);He.exports=yt.call(Function.call,Object.prototype.hasOwnProperty)},7316:(He,fe,Et)=>{"use strict";var yt=Et(1407)(),y=Et(9568)("Object.prototype.toString"),Bt=function(he){return!(yt&&he&&"object"==typeof he&&Symbol.toStringTag in he)&&"[object Arguments]"===y(he)},ft=function(he){return!!Bt(he)||null!==he&&"object"==typeof he&&"number"==typeof he.length&&he.length>=0&&"[object Array]"!==y(he)&&"[object Function]"===y(he.callee)},It=function(){return Bt(arguments)}();Bt.isLegacyArguments=ft,He.exports=It?Bt:ft},3105:(He,fe,Et)=>{"use strict";var yt=Date.prototype.getDay,y=Object.prototype.toString,ft=Et(1407)();He.exports=function(Ft){return"object"==typeof Ft&&null!==Ft&&(ft?function(Ft){try{return yt.call(Ft),!0}catch(he){return!1}}(Ft):"[object Date]"===y.call(Ft))}},5544:(He,fe,Et)=>{"use strict";var y,Bt,ft,It,yt=Et(9568),D=Et(1407)();if(D){y=yt("Object.prototype.hasOwnProperty"),Bt=yt("RegExp.prototype.exec"),ft={};var Ft=function(){throw ft};It={toString:Ft,valueOf:Ft},"symbol"==typeof Symbol.toPrimitive&&(It[Symbol.toPrimitive]=Ft)}var he=yt("Object.prototype.toString"),Jt=Object.getOwnPropertyDescriptor;He.exports=D?function(ce){if(!ce||"object"!=typeof ce)return!1;var _e=Jt(ce,"lastIndex");if(!_e||!y(_e,"value"))return!1;try{Bt(ce,It)}catch(kt){return kt===ft}}:function(ce){return!(!ce||"object"!=typeof ce&&"function"!=typeof ce)&&"[object RegExp]"===he(ce)}},4347:function(He){He.exports=function(){"use strict";var fe,Et,yt;function D(y,Bt){if(fe)if(Et){var ft="var sharedChunk = {}; ("+fe+")(sharedChunk); ("+Et+")(sharedChunk);",It={};fe(It),yt=Bt(It),"undefined"!=typeof window&&(yt.workerUrl=window.URL.createObjectURL(new Blob([ft],{type:"text/javascript"})))}else Et=Bt;else fe=Bt}return D(0,function(y){function Bt(t,r){return t(r={exports:{}},r.exports),r.exports}var ft=It;function It(t,r,s,d){this.cx=3*t,this.bx=3*(s-t)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*r,this.by=3*(d-r)-this.cy,this.ay=1-this.cy-this.by,this.p1x=t,this.p1y=d,this.p2x=s,this.p2y=d}It.prototype.sampleCurveX=function(t){return((this.ax*t+this.bx)*t+this.cx)*t},It.prototype.sampleCurveY=function(t){return((this.ay*t+this.by)*t+this.cy)*t},It.prototype.sampleCurveDerivativeX=function(t){return(3*this.ax*t+2*this.bx)*t+this.cx},It.prototype.solveCurveX=function(t,r){var s,d,_,w,S;for(void 0===r&&(r=1e-6),_=t,S=0;S<8;S++){if(w=this.sampleCurveX(_)-t,Math.abs(w)<r)return _;var A=this.sampleCurveDerivativeX(_);if(Math.abs(A)<1e-6)break;_-=w/A}if((_=t)<(s=0))return s;if(_>(d=1))return d;for(;s<d;){if(w=this.sampleCurveX(_),Math.abs(w-t)<r)return _;t>w?s=_:d=_,_=.5*(d-s)+s}return _},It.prototype.solve=function(t,r){return this.sampleCurveY(this.solveCurveX(t,r))};var Ft=he;function he(t,r){this.x=t,this.y=r}he.prototype={clone:function(){return new he(this.x,this.y)},add:function(t){return this.clone()._add(t)},sub:function(t){return this.clone()._sub(t)},multByPoint:function(t){return this.clone()._multByPoint(t)},divByPoint:function(t){return this.clone()._divByPoint(t)},mult:function(t){return this.clone()._mult(t)},div:function(t){return this.clone()._div(t)},rotate:function(t){return this.clone()._rotate(t)},rotateAround:function(t,r){return this.clone()._rotateAround(t,r)},matMult:function(t){return this.clone()._matMult(t)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(t){return this.x===t.x&&this.y===t.y},dist:function(t){return Math.sqrt(this.distSqr(t))},distSqr:function(t){var r=t.x-this.x,s=t.y-this.y;return r*r+s*s},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(t){return Math.atan2(this.y-t.y,this.x-t.x)},angleWith:function(t){return this.angleWithSep(t.x,t.y)},angleWithSep:function(t,r){return Math.atan2(this.x*r-this.y*t,this.x*t+this.y*r)},_matMult:function(t){var r=t[2]*this.x+t[3]*this.y;return this.x=t[0]*this.x+t[1]*this.y,this.y=r,this},_add:function(t){return this.x+=t.x,this.y+=t.y,this},_sub:function(t){return this.x-=t.x,this.y-=t.y,this},_mult:function(t){return this.x*=t,this.y*=t,this},_div:function(t){return this.x/=t,this.y/=t,this},_multByPoint:function(t){return this.x*=t.x,this.y*=t.y,this},_divByPoint:function(t){return this.x/=t.x,this.y/=t.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var t=this.y;return this.y=this.x,this.x=-t,this},_rotate:function(t){var r=Math.cos(t),s=Math.sin(t),d=s*this.x+r*this.y;return this.x=r*this.x-s*this.y,this.y=d,this},_rotateAround:function(t,r){var s=Math.cos(t),d=Math.sin(t),_=r.y+d*(this.x-r.x)+s*(this.y-r.y);return this.x=r.x+s*(this.x-r.x)-d*(this.y-r.y),this.y=_,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},he.convert=function(t){return t instanceof he?t:Array.isArray(t)?new he(t[0],t[1]):t};var Jt="undefined"!=typeof self?self:{},Ze=Math.pow(2,53)-1;function ve(t,r,s,d){var _=new ft(t,r,s,d);return function(w){return _.solve(w)}}var ce=ve(.25,.1,.25,1);function _e(t,r,s){return Math.min(s,Math.max(r,t))}function We(t,r,s){var d=s-r,_=((t-r)%d+d)%d+r;return _===r?s:_}function kt(t){for(var r=[],s=arguments.length-1;s-- >0;)r[s]=arguments[s+1];for(var d=0,_=r;d<_.length;d+=1){var w=_[d];for(var S in w)t[S]=w[S]}return t}var ie=1;function X(){return ie++}function J(){return function t(r){return r?(r^16*Math.random()>>r/4).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,t)}()}function $(t){return!!t&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(t)}function St(t,r){t.forEach(function(s){r[s]&&(r[s]=r[s].bind(r))})}function Q(t,r){return-1!==t.indexOf(r,t.length-r.length)}function et(t,r,s){var d={};for(var _ in t)d[_]=r.call(s||this,t[_],_,t);return d}function st(t,r,s){var d={};for(var _ in t)r.call(s||this,t[_],_,t)&&(d[_]=t[_]);return d}function j(t){return Array.isArray(t)?t.map(j):"object"==typeof t&&t?et(t,j):t}var $t={};function bt(t){$t[t]||("undefined"!=typeof console&&console.warn(t),$t[t]=!0)}function Mt(t,r,s){return(s.y-t.y)*(r.x-t.x)>(r.y-t.y)*(s.x-t.x)}function ct(t){for(var r=0,s=0,d=t.length,_=d-1,w=void 0,S=void 0;s<d;_=s++)r+=((S=t[_]).x-(w=t[s]).x)*(w.y+S.y);return r}function ze(){return"undefined"!=typeof WorkerGlobalScope&&"undefined"!=typeof self&&self instanceof WorkerGlobalScope}function Te(t){var r={};if(t.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,function(d,_,w,S){var A=w||S;return r[_]=!A||A.toLowerCase(),""}),r["max-age"]){var s=parseInt(r["max-age"],10);isNaN(s)?delete r["max-age"]:r["max-age"]=s}return r}var wt=null;function re(t){if(null==wt){var r=t.navigator?t.navigator.userAgent:null;wt=!!t.safari||!(!r||!(/\b(iPad|iPhone|iPod)\b/.test(r)||r.match("Safari")&&!r.match("Chrome")))}return wt}function Tt(t){try{var r=Jt[t];return r.setItem("_mapbox_test_",1),r.removeItem("_mapbox_test_"),!0}catch(s){return!1}}var Ht,Qt,vt,we,Fe=Jt.performance&&Jt.performance.now?Jt.performance.now.bind(Jt.performance):Date.now.bind(Date),Er=Jt.requestAnimationFrame||Jt.mozRequestAnimationFrame||Jt.webkitRequestAnimationFrame||Jt.msRequestAnimationFrame,Oe=Jt.cancelAnimationFrame||Jt.mozCancelAnimationFrame||Jt.webkitCancelAnimationFrame||Jt.msCancelAnimationFrame,Zr={now:Fe,frame:function(t){var r=Er(t);return{cancel:function(){return Oe(r)}}},getImageData:function(t,r){void 0===r&&(r=0);var s=Jt.document.createElement("canvas"),d=s.getContext("2d");if(!d)throw new Error("failed to create canvas 2d context");return s.width=t.width,s.height=t.height,d.drawImage(t,0,0,t.width,t.height),d.getImageData(-r,-r,t.width+2*r,t.height+2*r)},resolveURL:function(t){return Ht||(Ht=Jt.document.createElement("a")),Ht.href=t,Ht.href},hardwareConcurrency:Jt.navigator&&Jt.navigator.hardwareConcurrency||4,get devicePixelRatio(){return Jt.devicePixelRatio},get prefersReducedMotion(){return!!Jt.matchMedia&&(null==Qt&&(Qt=Jt.matchMedia("(prefers-reduced-motion: reduce)")),Qt.matches)}},Mr={API_URL:"https://api.mapbox.com",get EVENTS_URL(){return this.API_URL?0===this.API_URL.indexOf("https://api.mapbox.cn")?"https://events.mapbox.cn/events/v2":0===this.API_URL.indexOf("https://api.mapbox.com")?"https://events.mapbox.com/events/v2":null:null},FEEDBACK_URL:"https://apps.mapbox.com/feedback",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16,REGISTERED_PROTOCOLS:{}},Yr={supported:!1,testSupport:function(t){!Sr&&we&&(Cr?ke(t):vt=t)}},Sr=!1,Cr=!1;function ke(t){var r=t.createTexture();t.bindTexture(t.TEXTURE_2D,r);try{if(t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,we),t.isContextLost())return;Yr.supported=!0}catch(s){}t.deleteTexture(r),Sr=!0}Jt.document&&((we=Jt.document.createElement("img")).onload=function(){vt&&ke(vt),vt=null,Cr=!0},we.onerror=function(){Sr=!0,vt=null},we.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");var fi="01",Mn=function(t,r){this._transformRequestFn=t,this._customAccessToken=r,this._createSkuToken()};function Xn(t){return 0===t.indexOf("mapbox:")}Mn.prototype._createSkuToken=function(){var t=function(){for(var r="",s=0;s<10;s++)r+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",fi,r].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=t.token,this._skuTokenExpiresAt=t.tokenExpiresAt},Mn.prototype._isSkuTokenExpired=function(){return Date.now()>this._skuTokenExpiresAt},Mn.prototype.transformRequest=function(t,r){return this._transformRequestFn&&this._transformRequestFn(t,r)||{url:t}},Mn.prototype.normalizeStyleURL=function(t,r){if(!Xn(t))return t;var s=ot(t);return s.path="/styles/v1"+s.path,this._makeAPIURL(s,this._customAccessToken||r)},Mn.prototype.normalizeGlyphsURL=function(t,r){if(!Xn(t))return t;var s=ot(t);return s.path="/fonts/v1"+s.path,this._makeAPIURL(s,this._customAccessToken||r)},Mn.prototype.normalizeSourceURL=function(t,r){if(!Xn(t))return t;var s=ot(t);return s.path="/v4/"+s.authority+".json",s.params.push("secure"),this._makeAPIURL(s,this._customAccessToken||r)},Mn.prototype.normalizeSpriteURL=function(t,r,s,d){var _=ot(t);return Xn(t)?(_.path="/styles/v1"+_.path+"/sprite"+r+s,this._makeAPIURL(_,this._customAccessToken||d)):(_.path+=""+r+s,rt(_))},Mn.prototype.normalizeTileURL=function(t,r){if(this._isSkuTokenExpired()&&this._createSkuToken(),t&&!Xn(t))return t;var s=ot(t);s.path=s.path.replace(/(\.(png|jpg)\d*)(?=$)/,(Zr.devicePixelRatio>=2||512===r?"@2x":"")+(Yr.supported?".webp":"$1")),s.path=s.path.replace(/^.+\/v4\//,"/"),s.path="/v4"+s.path;var d=this._customAccessToken||function(_){for(var w=0,S=_;w<S.length;w+=1){var A=S[w].match(/^access_token=(.*)$/);if(A)return A[1]}return null}(s.params)||Mr.ACCESS_TOKEN;return Mr.REQUIRE_ACCESS_TOKEN&&d&&this._skuToken&&s.params.push("sku="+this._skuToken),this._makeAPIURL(s,d)},Mn.prototype.canonicalizeTileURL=function(t,r){var s=ot(t);if(!s.path.match(/(^\/v4\/)/)||!s.path.match(/\.[\w]+$/))return t;var d="mapbox://tiles/";d+=s.path.replace("/v4/","");var _=s.params;return r&&(_=_.filter(function(w){return!w.match(/^access_token=/)})),_.length&&(d+="?"+_.join("&")),d},Mn.prototype.canonicalizeTileset=function(t,r){for(var s=!!r&&Xn(r),d=[],_=0,w=t.tiles||[];_<w.length;_+=1){var S=w[_];Jn(S)?d.push(this.canonicalizeTileURL(S,s)):d.push(S)}return d},Mn.prototype._makeAPIURL=function(t,r){var s="See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes",d=ot(Mr.API_URL);if(t.protocol=d.protocol,t.authority=d.authority,"http"===t.protocol){var _=t.params.indexOf("secure");_>=0&&t.params.splice(_,1)}if("/"!==d.path&&(t.path=""+d.path+t.path),!Mr.REQUIRE_ACCESS_TOKEN)return rt(t);if(!(r=r||Mr.ACCESS_TOKEN))throw new Error("An API access token is required to use Mapbox GL. "+s);if("s"===r[0])throw new Error("Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). "+s);return t.params=t.params.filter(function(w){return-1===w.indexOf("access_token")}),t.params.push("access_token="+r),rt(t)},Mn.prototype.setTransformRequest=function(t){this._transformRequestFn=t};var li=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;function Jn(t){return li.test(t)}var le=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function ot(t){var r=t.match(le);if(!r)throw new Error("Unable to parse URL object");return{protocol:r[1],authority:r[2],path:r[3]||"/",params:r[4]?r[4].split("&"):[]}}function rt(t){var r=t.params.length?"?"+t.params.join("&"):"";return t.protocol+"://"+t.authority+t.path+r}function tt(t){if(!t)return null;var r=t.split(".");if(!r||3!==r.length)return null;try{return JSON.parse(decodeURIComponent(Jt.atob(r[1]).split("").map(function(s){return"%"+("00"+s.charCodeAt(0).toString(16)).slice(-2)}).join("")))}catch(s){return null}}var Pt=function(t){this.type=t,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null};Pt.prototype.getStorageKey=function(t){var r,s=tt(Mr.ACCESS_TOKEN);return r=s&&s.u?Jt.btoa(encodeURIComponent(s.u).replace(/%([0-9A-F]{2})/g,function(d,_){return String.fromCharCode(Number("0x"+_))})):Mr.ACCESS_TOKEN||"",t?"mapbox.eventData."+t+":"+r:"mapbox.eventData:"+r},Pt.prototype.fetchEventData=function(){var t=Tt("localStorage"),r=this.getStorageKey(),s=this.getStorageKey("uuid");if(t)try{var d=Jt.localStorage.getItem(r);d&&(this.eventData=JSON.parse(d));var _=Jt.localStorage.getItem(s);_&&(this.anonId=_)}catch(w){bt("Unable to read from LocalStorage")}},Pt.prototype.saveEventData=function(){var t=Tt("localStorage"),r=this.getStorageKey(),s=this.getStorageKey("uuid");if(t)try{Jt.localStorage.setItem(s,this.anonId),Object.keys(this.eventData).length>=1&&Jt.localStorage.setItem(r,JSON.stringify(this.eventData))}catch(d){bt("Unable to write to LocalStorage")}},Pt.prototype.processRequests=function(t){},Pt.prototype.postEvent=function(t,r,s,d){var _=this;if(Mr.EVENTS_URL){var w=ot(Mr.EVENTS_URL);w.params.push("access_token="+(d||Mr.ACCESS_TOKEN||""));var S={event:this.type,created:new Date(t).toISOString(),sdkIdentifier:"mapbox-gl-js",sdkVersion:"1.15.2",skuId:fi,userId:this.anonId},A=r?kt(S,r):S,F={url:rt(w),headers:{"Content-Type":"text/plain"},body:JSON.stringify([A])};this.pendingRequest=Z(F,function(U){_.pendingRequest=null,s(U),_.saveEventData(),_.processRequests(d)})}},Pt.prototype.queueRequest=function(t,r){this.queue.push(t),this.processRequests(r)};var Kt,Ee,Ge=function(t){function r(){t.call(this,"map.load"),this.success={},this.skuToken=""}return t&&(r.__proto__=t),(r.prototype=Object.create(t&&t.prototype)).constructor=r,r.prototype.postMapLoadEvent=function(s,d,_,w){this.skuToken=_,(Mr.EVENTS_URL&&w||Mr.ACCESS_TOKEN&&Array.isArray(s)&&s.some(function(S){return Xn(S)||Jn(S)}))&&this.queueRequest({id:d,timestamp:Date.now()},w)},r.prototype.processRequests=function(s){var d=this;if(!this.pendingRequest&&0!==this.queue.length){var _=this.queue.shift(),w=_.id,S=_.timestamp;w&&this.success[w]||(this.anonId||this.fetchEventData(),$(this.anonId)||(this.anonId=J()),this.postEvent(S,{skuToken:this.skuToken},function(A){A||w&&(d.success[w]=!0)},s))}},r}(Pt),Xe=new(function(t){function r(s){t.call(this,"appUserTurnstile"),this._customAccessToken=s}return t&&(r.__proto__=t),(r.prototype=Object.create(t&&t.prototype)).constructor=r,r.prototype.postTurnstileEvent=function(s,d){Mr.EVENTS_URL&&Mr.ACCESS_TOKEN&&Array.isArray(s)&&s.some(function(_){return Xn(_)||Jn(_)})&&this.queueRequest(Date.now(),d)},r.prototype.processRequests=function(s){var d=this;if(!this.pendingRequest&&0!==this.queue.length){this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();var _=tt(Mr.ACCESS_TOKEN),w=_?_.u:Mr.ACCESS_TOKEN,S=w!==this.eventData.tokenU;$(this.anonId)||(this.anonId=J(),S=!0);var A=this.queue.shift();if(this.eventData.lastSuccess){var F=new Date(this.eventData.lastSuccess),U=new Date(A),G=(A-this.eventData.lastSuccess)/864e5;S=S||G>=1||G<-1||F.getDate()!==U.getDate()}else S=!0;if(!S)return this.processRequests();this.postEvent(A,{"enabled.telemetry":!1},function(V){V||(d.eventData.lastSuccess=A,d.eventData.tokenU=w)},s)}},r}(Pt)),Re=Xe.postTurnstileEvent.bind(Xe),rn=new Ge,cn=rn.postMapLoadEvent.bind(rn),ur=500,Jr=50;function di(){Jt.caches&&!Kt&&(Kt=Jt.caches.open("mapbox-tiles"))}function On(t){var r=t.indexOf("?");return r<0?t:t.slice(0,r)}var Nn,_i=1/0;function ji(){return null==Nn&&(Nn=Jt.OffscreenCanvas&&new Jt.OffscreenCanvas(1,1).getContext("2d")&&"function"==typeof Jt.createImageBitmap),Nn}var fo={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};"function"==typeof Object.freeze&&Object.freeze(fo);var Xi=function(t){function r(s,d,_){401===d&&Jn(_)&&(s+=": you may have provided an invalid Mapbox access token. See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes"),t.call(this,s),this.status=d,this.url=_,this.name=this.constructor.name,this.message=s}return t&&(r.__proto__=t),(r.prototype=Object.create(t&&t.prototype)).constructor=r,r.prototype.toString=function(){return this.name+": "+this.message+" ("+this.status+"): "+this.url},r}(Error),to=ze()?function(){return self.worker&&self.worker.referrer}:function(){return("blob:"===Jt.location.protocol?Jt.parent:Jt).location.href};function $n(t,r){var s,d=new Jt.AbortController,_=new Jt.Request(t.url,{method:t.method||"GET",body:t.body,credentials:t.credentials,headers:t.headers,referrer:to(),signal:d.signal}),w=!1,S=!1,A=(s=_.url).indexOf("sku=")>0&&Jn(s);"json"===t.type&&_.headers.set("Accept","application/json");var F=function(G,V,K){if(!S){if(G&&"SecurityError"!==G.message&&bt(G),V&&K)return U(V);var at=Date.now();Jt.fetch(_).then(function(Ct){if(Ct.ok){var _t=A?Ct.clone():null;return U(Ct,_t,at)}return r(new Xi(Ct.statusText,Ct.status,t.url))}).catch(function(Ct){20!==Ct.code&&r(new Error(Ct.message))})}},U=function(G,V,K){("arrayBuffer"===t.type?G.arrayBuffer():"json"===t.type?G.json():G.text()).then(function(at){S||(V&&K&&function(Ct,_t,Wt){if(di(),Kt){var Gt={status:_t.status,statusText:_t.statusText,headers:new Jt.Headers};_t.headers.forEach(function(de,Pe){return Gt.headers.set(Pe,de)});var pe=Te(_t.headers.get("Cache-Control")||"");pe["no-store"]||(pe["max-age"]&&Gt.headers.set("Expires",new Date(Wt+1e3*pe["max-age"]).toUTCString()),new Date(Gt.headers.get("Expires")).getTime()-Wt<42e4||function(de,Pe){if(void 0===Ee)try{new Response(new ReadableStream),Ee=!0}catch(ue){Ee=!1}Ee?Pe(de.body):de.blob().then(Pe)}(_t,function(de){var Pe=new Jt.Response(de,Gt);di(),Kt&&Kt.then(function(ue){return ue.put(On(Ct.url),Pe)}).catch(function(ue){return bt(ue.message)})}))}}(_,V,K),w=!0,r(null,at,G.headers.get("Cache-Control"),G.headers.get("Expires")))}).catch(function(at){S||r(new Error(at.message))})};return A?function(G,V){if(di(),!Kt)return V(null);var K=On(G.url);Kt.then(function(at){at.match(K).then(function(Ct){var _t=function(Wt){if(!Wt)return!1;var Gt=new Date(Wt.headers.get("Expires")||0),pe=Te(Wt.headers.get("Cache-Control")||"");return Gt>Date.now()&&!pe["no-cache"]}(Ct);at.delete(K),_t&&at.put(K,Ct.clone()),V(null,Ct,_t)}).catch(V)}).catch(V)}(_,F):F(null,null),{cancel:function(){S=!0,w||d.abort()}}}var go,Oi,Je=function(t,r){if(/:\/\//.test(t.url)&&!/^https?:|^file:/.test(t.url)){if(ze()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",t,r);if(!ze()){var s=t.url.substring(0,t.url.indexOf("://"));return(Mr.REGISTERED_PROTOCOLS[s]||$n)(t,r)}}if(!(/^file:/.test(d=t.url)||/^file:/.test(to())&&!/^\w+:/.test(d))){if(Jt.fetch&&Jt.Request&&Jt.AbortController&&Jt.Request.prototype.hasOwnProperty("signal"))return $n(t,r);if(ze()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",t,r,void 0,!0)}var d;return function(_,w){var S=new Jt.XMLHttpRequest;for(var A in S.open(_.method||"GET",_.url,!0),"arrayBuffer"===_.type&&(S.responseType="arraybuffer"),_.headers)S.setRequestHeader(A,_.headers[A]);return"json"===_.type&&(S.responseType="text",S.setRequestHeader("Accept","application/json")),S.withCredentials="include"===_.credentials,S.onerror=function(){w(new Error(S.statusText))},S.onload=function(){if((S.status>=200&&S.status<300||0===S.status)&&null!==S.response){var F=S.response;if("json"===_.type)try{F=JSON.parse(S.response)}catch(U){return w(U)}w(null,F,S.getResponseHeader("Cache-Control"),S.getResponseHeader("Expires"))}else w(new Xi(S.statusText,S.status,_.url))},S.send(_.body),{cancel:function(){return S.abort()}}}(t,r)},gi=function(t,r){return Je(kt(t,{type:"arrayBuffer"}),r)},Z=function(t,r){return Je(kt(t,{method:"POST"}),r)},Y="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";go=[],Oi=0;var it=function(t,r){if(Yr.supported&&(t.headers||(t.headers={}),t.headers.accept="image/webp,*/*"),Oi>=Mr.MAX_PARALLEL_IMAGE_REQUESTS){var s={requestParameters:t,callback:r,cancelled:!1,cancel:function(){this.cancelled=!0}};return go.push(s),s}Oi++;var d=!1,_=function(){if(!d)for(d=!0,Oi--;go.length&&Oi<Mr.MAX_PARALLEL_IMAGE_REQUESTS;){var S=go.shift();S.cancelled||(S.cancel=it(S.requestParameters,S.callback).cancel)}},w=gi(t,function(S,A,F,U){var V,K;_(),S?r(S):A&&(ji()?(V=r,K=new Jt.Blob([new Uint8Array(A)],{type:"image/png"}),Jt.createImageBitmap(K).then(function(at){V(null,at)}).catch(function(at){V(new Error("Could not load image because of "+at.message+". Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))})):function(G,V,K,at){var Ct=new Jt.Image,_t=Jt.URL;Ct.onload=function(){V(null,Ct),_t.revokeObjectURL(Ct.src),Ct.onload=null,Jt.requestAnimationFrame(function(){Ct.src=Y})},Ct.onerror=function(){return V(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))};var Wt=new Jt.Blob([new Uint8Array(G)],{type:"image/png"});Ct.cacheControl=K,Ct.expires=at,Ct.src=G.byteLength?_t.createObjectURL(Wt):Y}(A,r,F,U))});return{cancel:function(){w.cancel(),_()}}};function ht(t,r,s){s[t]&&-1!==s[t].indexOf(r)||(s[t]=s[t]||[],s[t].push(r))}function Ot(t,r,s){if(s&&s[t]){var d=s[t].indexOf(r);-1!==d&&s[t].splice(d,1)}}var Xt=function(t,r){void 0===r&&(r={}),kt(this,r),this.type=t},ne=function(t){function r(s,d){void 0===d&&(d={}),t.call(this,"error",kt({error:s},d))}return t&&(r.__proto__=t),(r.prototype=Object.create(t&&t.prototype)).constructor=r,r}(Xt),Yt=function(){};Yt.prototype.on=function(t,r){return this._listeners=this._listeners||{},ht(t,r,this._listeners),this},Yt.prototype.off=function(t,r){return Ot(t,r,this._listeners),Ot(t,r,this._oneTimeListeners),this},Yt.prototype.once=function(t,r){return this._oneTimeListeners=this._oneTimeListeners||{},ht(t,r,this._oneTimeListeners),this},Yt.prototype.fire=function(t,r){"string"==typeof t&&(t=new Xt(t,r||{}));var s=t.type;if(this.listens(s)){t.target=this;for(var d=0,_=this._listeners&&this._listeners[s]?this._listeners[s].slice():[];d<_.length;d+=1)_[d].call(this,t);for(var w=0,S=this._oneTimeListeners&&this._oneTimeListeners[s]?this._oneTimeListeners[s].slice():[];w<S.length;w+=1){var A=S[w];Ot(s,A,this._oneTimeListeners),A.call(this,t)}var F=this._eventedParent;F&&(kt(t,"function"==typeof this._eventedParentData?this._eventedParentData():this._eventedParentData),F.fire(t))}else t instanceof ne&&console.error(t.error);return this},Yt.prototype.listens=function(t){return this._listeners&&this._listeners[t]&&this._listeners[t].length>0||this._oneTimeListeners&&this._oneTimeListeners[t]&&this._oneTimeListeners[t].length>0||this._eventedParent&&this._eventedParent.listens(t)},Yt.prototype.setEventedParent=function(t,r){return this._eventedParent=t,this._eventedParentData=r,this};var xt={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},sources:{required:!0,type:"sources"},sprite:{type:"string"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{}},default:"mapbox"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}},Ut=function(t,r,s,d){this.message=(t?t+": ":"")+s,d&&(this.identifier=d),null!=r&&r.__line__&&(this.line=r.__line__)};function je(t){var r=t.value;return r?[new Ut(t.key,r,"constants have been deprecated as of v8")]:[]}function or(t){for(var r=[],s=arguments.length-1;s-- >0;)r[s]=arguments[s+1];for(var d=0,_=r;d<_.length;d+=1){var w=_[d];for(var S in w)t[S]=w[S]}return t}function ye(t){return t instanceof Number||t instanceof String||t instanceof Boolean?t.valueOf():t}function Le(t){if(Array.isArray(t))return t.map(Le);if(t instanceof Object&&!(t instanceof Number||t instanceof String||t instanceof Boolean)){var r={};for(var s in t)r[s]=Le(t[s]);return r}return ye(t)}var lr=function(t){function r(s,d){t.call(this,d),this.message=d,this.key=s}return t&&(r.__proto__=t),(r.prototype=Object.create(t&&t.prototype)).constructor=r,r}(Error),pr=function(t,r){void 0===r&&(r=[]),this.parent=t,this.bindings={};for(var s=0,d=r;s<d.length;s+=1){var _=d[s];this.bindings[_[0]]=_[1]}};pr.prototype.concat=function(t){return new pr(this,t)},pr.prototype.get=function(t){if(this.bindings[t])return this.bindings[t];if(this.parent)return this.parent.get(t);throw new Error(t+" not found in scope.")},pr.prototype.has=function(t){return!!this.bindings[t]||!!this.parent&&this.parent.has(t)};var Pr={kind:"null"},De={kind:"number"},sr={kind:"string"},Be={kind:"boolean"},sn={kind:"color"},qr={kind:"object"},Tr={kind:"value"},wr={kind:"collator"},zr={kind:"formatted"},ui={kind:"resolvedImage"};function Tn(t,r){return{kind:"array",itemType:t,N:r}}function xn(t){if("array"===t.kind){var r=xn(t.itemType);return"number"==typeof t.N?"array<"+r+", "+t.N+">":"value"===t.itemType.kind?"array":"array<"+r+">"}return t.kind}var ln=[Pr,De,sr,Be,sn,zr,qr,Tn(Tr),ui];function xi(t,r){if("error"===r.kind)return null;if("array"===t.kind){if("array"===r.kind&&(0===r.N&&"value"===r.itemType.kind||!xi(t.itemType,r.itemType))&&("number"!=typeof t.N||t.N===r.N))return null}else{if(t.kind===r.kind)return null;if("value"===t.kind)for(var s=0,d=ln;s<d.length;s+=1)if(!xi(d[s],r))return null}return"Expected "+xn(t)+" but found "+xn(r)+" instead."}function zn(t,r){return r.some(function(s){return s.kind===t.kind})}function un(t,r){return r.some(function(s){return"null"===s?null===t:"array"===s?Array.isArray(t):"object"===s?t&&!Array.isArray(t)&&"object"==typeof t:s===typeof t})}var ko=Bt(function(t,r){var s={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function d(A){return(A=Math.round(A))<0?0:A>255?255:A}function _(A){return d("%"===A[A.length-1]?parseFloat(A)/100*255:parseInt(A))}function w(A){return(F="%"===A[A.length-1]?parseFloat(A)/100:parseFloat(A))<0?0:F>1?1:F;var F}function S(A,F,U){return U<0?U+=1:U>1&&(U-=1),6*U<1?A+(F-A)*U*6:2*U<1?F:3*U<2?A+(F-A)*(2/3-U)*6:A}try{r.parseCSSColor=function(A){var F,U=A.replace(/ /g,"").toLowerCase();if(U in s)return s[U].slice();if("#"===U[0])return 4===U.length?(F=parseInt(U.substr(1),16))>=0&&F<=4095?[(3840&F)>>4|(3840&F)>>8,240&F|(240&F)>>4,15&F|(15&F)<<4,1]:null:7===U.length&&(F=parseInt(U.substr(1),16))>=0&&F<=16777215?[(16711680&F)>>16,(65280&F)>>8,255&F,1]:null;var G=U.indexOf("("),V=U.indexOf(")");if(-1!==G&&V+1===U.length){var K=U.substr(0,G),at=U.substr(G+1,V-(G+1)).split(","),Ct=1;switch(K){case"rgba":if(4!==at.length)return null;Ct=w(at.pop());case"rgb":return 3!==at.length?null:[_(at[0]),_(at[1]),_(at[2]),Ct];case"hsla":if(4!==at.length)return null;Ct=w(at.pop());case"hsl":if(3!==at.length)return null;var _t=(parseFloat(at[0])%360+360)%360/360,Wt=w(at[1]),Gt=w(at[2]),pe=Gt<=.5?Gt*(Wt+1):Gt+Wt-Gt*Wt,de=2*Gt-pe;return[d(255*S(de,pe,_t+1/3)),d(255*S(de,pe,_t)),d(255*S(de,pe,_t-1/3)),Ct];default:return null}}return null}}catch(A){}}).parseCSSColor,An=function(t,r,s,d){void 0===d&&(d=1),this.r=t,this.g=r,this.b=s,this.a=d};An.parse=function(t){if(t){if(t instanceof An)return t;if("string"==typeof t){var r=ko(t);if(r)return new An(r[0]/255*r[3],r[1]/255*r[3],r[2]/255*r[3],r[3])}}},An.prototype.toString=function(){var t=this.toArray(),r=t[1],s=t[2],d=t[3];return"rgba("+Math.round(t[0])+","+Math.round(r)+","+Math.round(s)+","+d+")"},An.prototype.toArray=function(){var t=this.a;return 0===t?[0,0,0,0]:[255*this.r/t,255*this.g/t,255*this.b/t,t]},An.black=new An(0,0,0,1),An.white=new An(1,1,1,1),An.transparent=new An(0,0,0,0),An.red=new An(1,0,0,1);var gs=function(t,r,s){this.sensitivity=t?r?"variant":"case":r?"accent":"base",this.locale=s,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})};gs.prototype.compare=function(t,r){return this.collator.compare(t,r)},gs.prototype.resolvedLocale=function(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale};var Vs=function(t,r,s,d,_){this.text=t,this.image=r,this.scale=s,this.fontStack=d,this.textColor=_},oo=function(t){this.sections=t};oo.fromString=function(t){return new oo([new Vs(t,null,null,null,null)])},oo.prototype.isEmpty=function(){return 0===this.sections.length||!this.sections.some(function(t){return 0!==t.text.length||t.image&&0!==t.image.name.length})},oo.factory=function(t){return t instanceof oo?t:oo.fromString(t)},oo.prototype.toString=function(){return 0===this.sections.length?"":this.sections.map(function(t){return t.text}).join("")},oo.prototype.serialize=function(){for(var t=["format"],r=0,s=this.sections;r<s.length;r+=1){var d=s[r];if(d.image)t.push(["image",d.image.name]);else{t.push(d.text);var _={};d.fontStack&&(_["text-font"]=["literal",d.fontStack.split(",")]),d.scale&&(_["font-scale"]=d.scale),d.textColor&&(_["text-color"]=["rgba"].concat(d.textColor.toArray())),t.push(_)}}return t};var Un=function(t){this.name=t.name,this.available=t.available};function ml(t,r,s,d){return"number"==typeof t&&t>=0&&t<=255&&"number"==typeof r&&r>=0&&r<=255&&"number"==typeof s&&s>=0&&s<=255?void 0===d||"number"==typeof d&&d>=0&&d<=1?null:"Invalid rgba value ["+[t,r,s,d].join(", ")+"]: 'a' must be between 0 and 1.":"Invalid rgba value ["+("number"==typeof d?[t,r,s,d]:[t,r,s]).join(", ")+"]: 'r', 'g', and 'b' must be between 0 and 255."}function pa(t){if(null===t||"string"==typeof t||"boolean"==typeof t||"number"==typeof t||t instanceof An||t instanceof gs||t instanceof oo||t instanceof Un)return!0;if(Array.isArray(t)){for(var r=0,s=t;r<s.length;r+=1)if(!pa(s[r]))return!1;return!0}if("object"==typeof t){for(var d in t)if(!pa(t[d]))return!1;return!0}return!1}function mo(t){if(null===t)return Pr;if("string"==typeof t)return sr;if("boolean"==typeof t)return Be;if("number"==typeof t)return De;if(t instanceof An)return sn;if(t instanceof gs)return wr;if(t instanceof oo)return zr;if(t instanceof Un)return ui;if(Array.isArray(t)){for(var r,s=t.length,d=0,_=t;d<_.length;d+=1){var w=mo(_[d]);if(r){if(r===w)continue;r=Tr;break}r=w}return Tn(r||Tr,s)}return qr}function Is(t){var r=typeof t;return null===t?"":"string"===r||"number"===r||"boolean"===r?String(t):t instanceof An||t instanceof oo||t instanceof Un?t.toString():JSON.stringify(t)}Un.prototype.toString=function(){return this.name},Un.fromString=function(t){return t?new Un({name:t,available:!1}):null},Un.prototype.serialize=function(){return["image",this.name]};var bn=function(t,r){this.type=t,this.value=r};bn.parse=function(t,r){if(2!==t.length)return r.error("'literal' expression requires exactly one argument, but found "+(t.length-1)+" instead.");if(!pa(t[1]))return r.error("invalid value");var s=t[1],d=mo(s),_=r.expectedType;return"array"!==d.kind||0!==d.N||!_||"array"!==_.kind||"number"==typeof _.N&&0!==_.N||(d=_),new bn(d,s)},bn.prototype.evaluate=function(){return this.value},bn.prototype.eachChild=function(){},bn.prototype.outputDefined=function(){return!0},bn.prototype.serialize=function(){return"array"===this.type.kind||"object"===this.type.kind?["literal",this.value]:this.value instanceof An?["rgba"].concat(this.value.toArray()):this.value instanceof oo?this.value.serialize():this.value};var Mi=function(t){this.name="ExpressionEvaluationError",this.message=t};Mi.prototype.toJSON=function(){return this.message};var Di={string:sr,number:De,boolean:Be,object:qr},zo=function(t,r){this.type=t,this.args=r};zo.parse=function(t,r){if(t.length<2)return r.error("Expected at least one argument.");var s,d=1,_=t[0];if("array"===_){var w,S;if(t.length>2){var A=t[1];if("string"!=typeof A||!(A in Di)||"object"===A)return r.error('The item type argument of "array" must be one of string, number, boolean',1);w=Di[A],d++}else w=Tr;if(t.length>3){if(null!==t[2]&&("number"!=typeof t[2]||t[2]<0||t[2]!==Math.floor(t[2])))return r.error('The length argument to "array" must be a positive integer literal',2);S=t[2],d++}s=Tn(w,S)}else s=Di[_];for(var F=[];d<t.length;d++){var U=r.parse(t[d],d,Tr);if(!U)return null;F.push(U)}return new zo(s,F)},zo.prototype.evaluate=function(t){for(var r=0;r<this.args.length;r++){var s=this.args[r].evaluate(t);if(!xi(this.type,mo(s)))return s;if(r===this.args.length-1)throw new Mi("Expected value to be of type "+xn(this.type)+", but found "+xn(mo(s))+" instead.")}return null},zo.prototype.eachChild=function(t){this.args.forEach(t)},zo.prototype.outputDefined=function(){return this.args.every(function(t){return t.outputDefined()})},zo.prototype.serialize=function(){var t=this.type,r=[t.kind];if("array"===t.kind){var s=t.itemType;if("string"===s.kind||"number"===s.kind||"boolean"===s.kind){r.push(s.kind);var d=t.N;("number"==typeof d||this.args.length>1)&&r.push(d)}}return r.concat(this.args.map(function(_){return _.serialize()}))};var nn=function(t){this.type=zr,this.sections=t};nn.parse=function(t,r){if(t.length<2)return r.error("Expected at least one argument.");var s=t[1];if(!Array.isArray(s)&&"object"==typeof s)return r.error("First argument must be an image or text section.");for(var d=[],_=!1,w=1;w<=t.length-1;++w){var S=t[w];if(_&&"object"==typeof S&&!Array.isArray(S)){_=!1;var A=null;if(S["font-scale"]&&!(A=r.parse(S["font-scale"],1,De)))return null;var F=null;if(S["text-font"]&&!(F=r.parse(S["text-font"],1,Tn(sr))))return null;var U=null;if(S["text-color"]&&!(U=r.parse(S["text-color"],1,sn)))return null;var G=d[d.length-1];G.scale=A,G.font=F,G.textColor=U}else{var V=r.parse(t[w],1,Tr);if(!V)return null;var K=V.type.kind;if("string"!==K&&"value"!==K&&"null"!==K&&"resolvedImage"!==K)return r.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");_=!0,d.push({content:V,scale:null,font:null,textColor:null})}}return new nn(d)},nn.prototype.evaluate=function(t){return new oo(this.sections.map(function(r){var s=r.content.evaluate(t);return mo(s)===ui?new Vs("",s,null,null,null):new Vs(Is(s),null,r.scale?r.scale.evaluate(t):null,r.font?r.font.evaluate(t).join(","):null,r.textColor?r.textColor.evaluate(t):null)}))},nn.prototype.eachChild=function(t){for(var r=0,s=this.sections;r<s.length;r+=1){var d=s[r];t(d.content),d.scale&&t(d.scale),d.font&&t(d.font),d.textColor&&t(d.textColor)}},nn.prototype.outputDefined=function(){return!1},nn.prototype.serialize=function(){for(var t=["format"],r=0,s=this.sections;r<s.length;r+=1){var d=s[r];t.push(d.content.serialize());var _={};d.scale&&(_["font-scale"]=d.scale.serialize()),d.font&&(_["text-font"]=d.font.serialize()),d.textColor&&(_["text-color"]=d.textColor.serialize()),t.push(_)}return t};var Ps=function(t){this.type=ui,this.input=t};Ps.parse=function(t,r){if(2!==t.length)return r.error("Expected two arguments.");var s=r.parse(t[1],1,sr);return s?new Ps(s):r.error("No image name provided.")},Ps.prototype.evaluate=function(t){var r=this.input.evaluate(t),s=Un.fromString(r);return s&&t.availableImages&&(s.available=t.availableImages.indexOf(r)>-1),s},Ps.prototype.eachChild=function(t){t(this.input)},Ps.prototype.outputDefined=function(){return!1},Ps.prototype.serialize=function(){return["image",this.input.serialize()]};var Kc={"to-boolean":Be,"to-color":sn,"to-number":De,"to-string":sr},jo=function(t,r){this.type=t,this.args=r};jo.parse=function(t,r){if(t.length<2)return r.error("Expected at least one argument.");var s=t[0];if(("to-boolean"===s||"to-string"===s)&&2!==t.length)return r.error("Expected one argument.");for(var d=Kc[s],_=[],w=1;w<t.length;w++){var S=r.parse(t[w],w,Tr);if(!S)return null;_.push(S)}return new jo(d,_)},jo.prototype.evaluate=function(t){if("boolean"===this.type.kind)return Boolean(this.args[0].evaluate(t));if("color"===this.type.kind){for(var r,s,d=0,_=this.args;d<_.length;d+=1){if(s=null,(r=_[d].evaluate(t))instanceof An)return r;if("string"==typeof r){var w=t.parseColor(r);if(w)return w}else if(Array.isArray(r)&&!(s=r.length<3||r.length>4?"Invalid rbga value "+JSON.stringify(r)+": expected an array containing either three or four numeric values.":ml(r[0],r[1],r[2],r[3])))return new An(r[0]/255,r[1]/255,r[2]/255,r[3])}throw new Mi(s||"Could not parse color from value '"+("string"==typeof r?r:String(JSON.stringify(r)))+"'")}if("number"===this.type.kind){for(var S=null,A=0,F=this.args;A<F.length;A+=1){if(null===(S=F[A].evaluate(t)))return 0;var U=Number(S);if(!isNaN(U))return U}throw new Mi("Could not convert "+JSON.stringify(S)+" to number.")}return"formatted"===this.type.kind?oo.fromString(Is(this.args[0].evaluate(t))):"resolvedImage"===this.type.kind?Un.fromString(Is(this.args[0].evaluate(t))):Is(this.args[0].evaluate(t))},jo.prototype.eachChild=function(t){this.args.forEach(t)},jo.prototype.outputDefined=function(){return this.args.every(function(t){return t.outputDefined()})},jo.prototype.serialize=function(){if("formatted"===this.type.kind)return new nn([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if("resolvedImage"===this.type.kind)return new Ps(this.args[0]).serialize();var t=["to-"+this.type.kind];return this.eachChild(function(r){t.push(r.serialize())}),t};var Za=["Unknown","Point","LineString","Polygon"],ra=function(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null};ra.prototype.id=function(){return this.feature&&"id"in this.feature?this.feature.id:null},ra.prototype.geometryType=function(){return this.feature?"number"==typeof this.feature.type?Za[this.feature.type]:this.feature.type:null},ra.prototype.geometry=function(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null},ra.prototype.canonicalID=function(){return this.canonical},ra.prototype.properties=function(){return this.feature&&this.feature.properties||{}},ra.prototype.parseColor=function(t){var r=this._parseColorCache[t];return r||(r=this._parseColorCache[t]=An.parse(t)),r};var Mo=function(t,r,s,d){this.name=t,this.type=r,this._evaluate=s,this.args=d};Mo.prototype.evaluate=function(t){return this._evaluate(t,this.args)},Mo.prototype.eachChild=function(t){this.args.forEach(t)},Mo.prototype.outputDefined=function(){return!1},Mo.prototype.serialize=function(){return[this.name].concat(this.args.map(function(t){return t.serialize()}))},Mo.parse=function(t,r){var s,d=t[0],_=Mo.definitions[d];if(!_)return r.error('Unknown expression "'+d+'". If you wanted a literal array, use ["literal", [...]].',0);for(var w=Array.isArray(_)?_[0]:_.type,S=Array.isArray(_)?[[_[1],_[2]]]:_.overloads,A=S.filter(function(jr){var Qe=jr[0];return!Array.isArray(Qe)||Qe.length===t.length-1}),F=null,U=0,G=A;U<G.length;U+=1){var V=G[U],K=V[0],at=V[1];F=new ao(r.registry,r.path,null,r.scope);for(var Ct=[],_t=!1,Wt=1;Wt<t.length;Wt++){var Gt=t[Wt],pe=Array.isArray(K)?K[Wt-1]:K.type,de=F.parse(Gt,1+Ct.length,pe);if(!de){_t=!0;break}Ct.push(de)}if(!_t)if(Array.isArray(K)&&K.length!==Ct.length)F.error("Expected "+K.length+" arguments, but found "+Ct.length+" instead.");else{for(var Pe=0;Pe<Ct.length;Pe++){var ue=Array.isArray(K)?K[Pe]:K.type,qe=Ct[Pe];F.concat(Pe+1).checkSubtype(ue,qe.type)}if(0===F.errors.length)return new Mo(d,w,at,Ct)}}if(1===A.length)(s=r.errors).push.apply(s,F.errors);else{for(var Ke=(A.length?A:S).map(function(jr){var Qe;return Qe=jr[0],Array.isArray(Qe)?"("+Qe.map(xn).join(", ")+")":"("+xn(Qe.type)+"...)"}).join(" | "),fr=[],Nr=1;Nr<t.length;Nr++){var hr=r.parse(t[Nr],1+fr.length);if(!hr)return null;fr.push(xn(hr.type))}r.error("Expected arguments of type "+Ke+", but found ("+fr.join(", ")+") instead.")}return null},Mo.register=function(t,r){for(var s in Mo.definitions=r,r)t[s]=Mo};var yo=function(t,r,s){this.type=wr,this.locale=s,this.caseSensitive=t,this.diacriticSensitive=r};function $e(t,r){t[0]=Math.min(t[0],r[0]),t[1]=Math.min(t[1],r[1]),t[2]=Math.max(t[2],r[0]),t[3]=Math.max(t[3],r[1])}function Zs(t,r){return!(t[0]<=r[0]||t[2]>=r[2]||t[1]<=r[1]||t[3]>=r[3])}function Sa(t,r){var s=(180+t[0])/360,d=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+t[1]*Math.PI/360)))/360,_=Math.pow(2,r.z);return[Math.round(s*_*8192),Math.round(d*_*8192)]}function Fs(t,r,s){return r[1]>t[1]!=s[1]>t[1]&&t[0]<(s[0]-r[0])*(t[1]-r[1])/(s[1]-r[1])+r[0]}function Ru(t,r){for(var s,d,_,w,S,A,F,U=!1,G=0,V=r.length;G<V;G++)for(var K=r[G],at=0,Ct=K.length;at<Ct-1;at++){if((w=(s=t)[0]-(d=K[at])[0])*(F=s[1]-(_=K[at+1])[1])-(A=s[0]-_[0])*(S=s[1]-d[1])==0&&w*A<=0&&S*F<=0)return!1;Fs(t,K[at],K[at+1])&&(U=!U)}return U}function na(t,r){for(var s=0;s<r.length;s++)if(Ru(t,r[s]))return!0;return!1}function ci(t,r,s,d){var _=d[0]-s[0],w=d[1]-s[1],S=(t[0]-s[0])*w-_*(t[1]-s[1]),A=(r[0]-s[0])*w-_*(r[1]-s[1]);return S>0&&A<0||S<0&&A>0}function Yn(t,r,s){for(var d=0,_=s;d<_.length;d+=1)for(var w=_[d],S=0;S<w.length-1;++S)if((V=[(G=w[S+1])[0]-(U=w[S])[0],G[1]-U[1]])[0]*(K=[(F=r)[0]-(A=t)[0],F[1]-A[1]])[1]-V[1]*K[0]!=0&&ci(A,F,U,G)&&ci(U,G,A,F))return!0;var A,F,U,G,V,K;return!1}function Yi(t,r){for(var s=0;s<t.length;++s)if(!Ru(t[s],r))return!1;for(var d=0;d<t.length-1;++d)if(Yn(t[d],t[d+1],r))return!1;return!0}function yl(t,r){for(var s=0;s<r.length;s++)if(Yi(t,r[s]))return!0;return!1}function vl(t,r,s){for(var d=[],_=0;_<t.length;_++){for(var w=[],S=0;S<t[_].length;S++){var A=Sa(t[_][S],s);$e(r,A),w.push(A)}d.push(w)}return d}function Xo(t,r,s){for(var d=[],_=0;_<t.length;_++){var w=vl(t[_],r,s);d.push(w)}return d}function Nu(t,r,s,d){if(t[0]<s[0]||t[0]>s[2]){var _=.5*d,w=t[0]-s[0]>_?-d:s[0]-t[0]>_?d:0;0===w&&(w=t[0]-s[2]>_?-d:s[2]-t[0]>_?d:0),t[0]+=w}$e(r,t)}function Ca(t,r,s,d){for(var _=8192*Math.pow(2,d.z),w=[8192*d.x,8192*d.y],S=[],A=0,F=t;A<F.length;A+=1)for(var U=0,G=F[A];U<G.length;U+=1){var V=G[U],K=[V.x+w[0],V.y+w[1]];Nu(K,r,s,_),S.push(K)}return S}function ni(t,r,s,d){for(var _,w=8192*Math.pow(2,d.z),S=[8192*d.x,8192*d.y],A=[],F=0,U=t;F<U.length;F+=1){for(var G=[],V=0,K=U[F];V<K.length;V+=1){var at=K[V],Ct=[at.x+S[0],at.y+S[1]];$e(r,Ct),G.push(Ct)}A.push(G)}if(r[2]-r[0]<=w/2){(_=r)[0]=_[1]=1/0,_[2]=_[3]=-1/0;for(var _t=0,Wt=A;_t<Wt.length;_t+=1)for(var Gt=0,pe=Wt[_t];Gt<pe.length;Gt+=1)Nu(pe[Gt],r,s,w)}return A}yo.parse=function(t,r){if(2!==t.length)return r.error("Expected one argument.");var s=t[1];if("object"!=typeof s||Array.isArray(s))return r.error("Collator options argument must be an object.");var d=r.parse(void 0!==s["case-sensitive"]&&s["case-sensitive"],1,Be);if(!d)return null;var _=r.parse(void 0!==s["diacritic-sensitive"]&&s["diacritic-sensitive"],1,Be);if(!_)return null;var w=null;return s.locale&&!(w=r.parse(s.locale,1,sr))?null:new yo(d,_,w)},yo.prototype.evaluate=function(t){return new gs(this.caseSensitive.evaluate(t),this.diacriticSensitive.evaluate(t),this.locale?this.locale.evaluate(t):null)},yo.prototype.eachChild=function(t){t(this.caseSensitive),t(this.diacriticSensitive),this.locale&&t(this.locale)},yo.prototype.outputDefined=function(){return!1},yo.prototype.serialize=function(){var t={};return t["case-sensitive"]=this.caseSensitive.serialize(),t["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(t.locale=this.locale.serialize()),["collator",t]};var Yo=function(t,r){this.type=Be,this.geojson=t,this.geometries=r};function Wi(t){if(t instanceof Mo&&("get"===t.name&&1===t.args.length||"feature-state"===t.name||"has"===t.name&&1===t.args.length||"properties"===t.name||"geometry-type"===t.name||"id"===t.name||/^filter-/.test(t.name))||t instanceof Yo)return!1;var r=!0;return t.eachChild(function(s){r&&!Wi(s)&&(r=!1)}),r}function Bs(t){if(t instanceof Mo&&"feature-state"===t.name)return!1;var r=!0;return t.eachChild(function(s){r&&!Bs(s)&&(r=!1)}),r}function js(t,r){if(t instanceof Mo&&r.indexOf(t.name)>=0)return!1;var s=!0;return t.eachChild(function(d){s&&!js(d,r)&&(s=!1)}),s}Yo.parse=function(t,r){if(2!==t.length)return r.error("'within' expression requires exactly one argument, but found "+(t.length-1)+" instead.");if(pa(t[1])){var s=t[1];if("FeatureCollection"===s.type)for(var d=0;d<s.features.length;++d){var _=s.features[d].geometry.type;if("Polygon"===_||"MultiPolygon"===_)return new Yo(s,s.features[d].geometry)}else if("Feature"===s.type){var w=s.geometry.type;if("Polygon"===w||"MultiPolygon"===w)return new Yo(s,s.geometry)}else if("Polygon"===s.type||"MultiPolygon"===s.type)return new Yo(s,s)}return r.error("'within' expression requires valid geojson object that contains polygon geometry type.")},Yo.prototype.evaluate=function(t){if(null!=t.geometry()&&null!=t.canonicalID()){if("Point"===t.geometryType())return function(r,s){var d=[1/0,1/0,-1/0,-1/0],_=[1/0,1/0,-1/0,-1/0],w=r.canonicalID();if("Polygon"===s.type){var S=vl(s.coordinates,_,w),A=Ca(r.geometry(),d,_,w);if(!Zs(d,_))return!1;for(var F=0,U=A;F<U.length;F+=1)if(!Ru(U[F],S))return!1}if("MultiPolygon"===s.type){var G=Xo(s.coordinates,_,w),V=Ca(r.geometry(),d,_,w);if(!Zs(d,_))return!1;for(var K=0,at=V;K<at.length;K+=1)if(!na(at[K],G))return!1}return!0}(t,this.geometries);if("LineString"===t.geometryType())return function(r,s){var d=[1/0,1/0,-1/0,-1/0],_=[1/0,1/0,-1/0,-1/0],w=r.canonicalID();if("Polygon"===s.type){var S=vl(s.coordinates,_,w),A=ni(r.geometry(),d,_,w);if(!Zs(d,_))return!1;for(var F=0,U=A;F<U.length;F+=1)if(!Yi(U[F],S))return!1}if("MultiPolygon"===s.type){var G=Xo(s.coordinates,_,w),V=ni(r.geometry(),d,_,w);if(!Zs(d,_))return!1;for(var K=0,at=V;K<at.length;K+=1)if(!yl(at[K],G))return!1}return!0}(t,this.geometries)}return!1},Yo.prototype.eachChild=function(){},Yo.prototype.outputDefined=function(){return!0},Yo.prototype.serialize=function(){return["within",this.geojson]};var ii=function(t,r){this.type=r.type,this.name=t,this.boundExpression=r};ii.parse=function(t,r){if(2!==t.length||"string"!=typeof t[1])return r.error("'var' expression requires exactly one string literal argument.");var s=t[1];return r.scope.has(s)?new ii(s,r.scope.get(s)):r.error('Unknown variable "'+s+'". Make sure "'+s+'" has been bound in an enclosing "let" expression before using it.',1)},ii.prototype.evaluate=function(t){return this.boundExpression.evaluate(t)},ii.prototype.eachChild=function(){},ii.prototype.outputDefined=function(){return!1},ii.prototype.serialize=function(){return["var",this.name]};var ao=function(t,r,s,d,_){void 0===r&&(r=[]),void 0===d&&(d=new pr),void 0===_&&(_=[]),this.registry=t,this.path=r,this.key=r.map(function(w){return"["+w+"]"}).join(""),this.scope=d,this.errors=_,this.expectedType=s};function ja(t,r){for(var s,d=t.length-1,_=0,w=d,S=0;_<=w;)if((s=t[S=Math.floor((_+w)/2)])<=r){if(S===d||r<t[S+1])return S;_=S+1}else{if(!(s>r))throw new Mi("Input is not a number.");w=S-1}return 0}ao.prototype.parse=function(t,r,s,d,_){return void 0===_&&(_={}),r?this.concat(r,s,d)._parse(t,_):this._parse(t,_)},ao.prototype._parse=function(t,r){function s(U,G,V){return"assert"===V?new zo(G,[U]):"coerce"===V?new jo(G,[U]):U}if(null!==t&&"string"!=typeof t&&"boolean"!=typeof t&&"number"!=typeof t||(t=["literal",t]),Array.isArray(t)){if(0===t.length)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');var d=t[0];if("string"!=typeof d)return this.error("Expression name must be a string, but found "+typeof d+' instead. If you wanted a literal array, use ["literal", [...]].',0),null;var _=this.registry[d];if(_){var w=_.parse(t,this);if(!w)return null;if(this.expectedType){var S=this.expectedType,A=w.type;if("string"!==S.kind&&"number"!==S.kind&&"boolean"!==S.kind&&"object"!==S.kind&&"array"!==S.kind||"value"!==A.kind)if("color"!==S.kind&&"formatted"!==S.kind&&"resolvedImage"!==S.kind||"value"!==A.kind&&"string"!==A.kind){if(this.checkSubtype(S,A))return null}else w=s(w,S,r.typeAnnotation||"coerce");else w=s(w,S,r.typeAnnotation||"assert")}if(!(w instanceof bn)&&"resolvedImage"!==w.type.kind&&function U(G){if(G instanceof ii)return U(G.boundExpression);if(G instanceof Mo&&"error"===G.name||G instanceof yo||G instanceof Yo)return!1;var V=G instanceof jo||G instanceof zo,K=!0;return G.eachChild(function(at){K=V?K&&U(at):K&&at instanceof bn}),!!K&&Wi(G)&&js(G,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}(w)){var F=new ra;try{w=new bn(w.type,w.evaluate(F))}catch(U){return this.error(U.message),null}}return w}return this.error('Unknown expression "'+d+'". If you wanted a literal array, use ["literal", [...]].',0)}return this.error(void 0===t?"'undefined' value invalid. Use null instead.":"object"==typeof t?'Bare objects invalid. Use ["literal", {...}] instead.':"Expected an array, but found "+typeof t+" instead.")},ao.prototype.concat=function(t,r,s){var d="number"==typeof t?this.path.concat(t):this.path,_=s?this.scope.concat(s):this.scope;return new ao(this.registry,d,r||null,_,this.errors)},ao.prototype.error=function(t){for(var r=[],s=arguments.length-1;s-- >0;)r[s]=arguments[s+1];var d=""+this.key+r.map(function(_){return"["+_+"]"}).join("");this.errors.push(new lr(d,t))},ao.prototype.checkSubtype=function(t,r){var s=xi(t,r);return s&&this.error(s),s};var so=function(t,r,s){this.type=t,this.input=r,this.labels=[],this.outputs=[];for(var d=0,_=s;d<_.length;d+=1){var w=_[d],S=w[1];this.labels.push(w[0]),this.outputs.push(S)}};function bi(t,r,s){return t*(1-s)+r*s}so.parse=function(t,r){if(t.length-1<4)return r.error("Expected at least 4 arguments, but found only "+(t.length-1)+".");if((t.length-1)%2!=0)return r.error("Expected an even number of arguments.");var s=r.parse(t[1],1,De);if(!s)return null;var d=[],_=null;r.expectedType&&"value"!==r.expectedType.kind&&(_=r.expectedType);for(var w=1;w<t.length;w+=2){var S=1===w?-1/0:t[w],A=t[w+1],F=w,U=w+1;if("number"!=typeof S)return r.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',F);if(d.length&&d[d.length-1][0]>=S)return r.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',F);var G=r.parse(A,U,_);if(!G)return null;_=_||G.type,d.push([S,G])}return new so(_,s,d)},so.prototype.evaluate=function(t){var r=this.labels,s=this.outputs;if(1===r.length)return s[0].evaluate(t);var d=this.input.evaluate(t);if(d<=r[0])return s[0].evaluate(t);var _=r.length;return d>=r[_-1]?s[_-1].evaluate(t):s[ja(r,d)].evaluate(t)},so.prototype.eachChild=function(t){t(this.input);for(var r=0,s=this.outputs;r<s.length;r+=1)t(s[r])},so.prototype.outputDefined=function(){return this.outputs.every(function(t){return t.outputDefined()})},so.prototype.serialize=function(){for(var t=["step",this.input.serialize()],r=0;r<this.labels.length;r++)r>0&&t.push(this.labels[r]),t.push(this.outputs[r].serialize());return t};var ms=Object.freeze({__proto__:null,number:bi,color:function(t,r,s){return new An(bi(t.r,r.r,s),bi(t.g,r.g,s),bi(t.b,r.b,s),bi(t.a,r.a,s))},array:function(t,r,s){return t.map(function(d,_){return bi(d,r[_],s)})}}),uu=6/29*3*(6/29),uo=Math.PI/180,Yu=180/Math.PI;function fa(t){return t>.008856451679035631?Math.pow(t,1/3):t/uu+4/29}function Ri(t){return t>6/29?t*t*t:uu*(t-4/29)}function lo(t){return 255*(t<=.0031308?12.92*t:1.055*Math.pow(t,1/2.4)-.055)}function wu(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function Zl(t){var r=wu(t.r),s=wu(t.g),d=wu(t.b),_=fa((.4124564*r+.3575761*s+.1804375*d)/.95047),w=fa((.2126729*r+.7151522*s+.072175*d)/1);return{l:116*w-16,a:500*(_-w),b:200*(w-fa((.0193339*r+.119192*s+.9503041*d)/1.08883)),alpha:t.a}}function lu(t){var r=(t.l+16)/116,s=isNaN(t.a)?r:r+t.a/500,d=isNaN(t.b)?r:r-t.b/200;return r=1*Ri(r),s=.95047*Ri(s),d=1.08883*Ri(d),new An(lo(3.2404542*s-1.5371385*r-.4985314*d),lo(-.969266*s+1.8760108*r+.041556*d),lo(.0556434*s-.2040259*r+1.0572252*d),t.alpha)}function Wu(t,r,s){var d=r-t;return t+s*(d>180||d<-180?d-360*Math.round(d/360):d)}var Eu={forward:Zl,reverse:lu,interpolate:function(t,r,s){return{l:bi(t.l,r.l,s),a:bi(t.a,r.a,s),b:bi(t.b,r.b,s),alpha:bi(t.alpha,r.alpha,s)}}},eo={forward:function(t){var r=Zl(t),s=r.l,d=r.a,_=r.b,w=Math.atan2(_,d)*Yu;return{h:w<0?w+360:w,c:Math.sqrt(d*d+_*_),l:s,alpha:t.a}},reverse:function(t){var r=t.h*uo,s=t.c;return lu({l:t.l,a:Math.cos(r)*s,b:Math.sin(r)*s,alpha:t.alpha})},interpolate:function(t,r,s){return{h:Wu(t.h,r.h,s),c:bi(t.c,r.c,s),l:bi(t.l,r.l,s),alpha:bi(t.alpha,r.alpha,s)}}},Us=Object.freeze({__proto__:null,lab:Eu,hcl:eo}),Qn=function(t,r,s,d,_){this.type=t,this.operator=r,this.interpolation=s,this.input=d,this.labels=[],this.outputs=[];for(var w=0,S=_;w<S.length;w+=1){var A=S[w],F=A[1];this.labels.push(A[0]),this.outputs.push(F)}};function Ms(t,r,s,d){var _=d-s,w=t-s;return 0===_?0:1===r?w/_:(Math.pow(r,w)-1)/(Math.pow(r,_)-1)}Qn.interpolationFactor=function(t,r,s,d){var _=0;if("exponential"===t.name)_=Ms(r,t.base,s,d);else if("linear"===t.name)_=Ms(r,1,s,d);else if("cubic-bezier"===t.name){var w=t.controlPoints;_=new ft(w[0],w[1],w[2],w[3]).solve(Ms(r,1,s,d))}return _},Qn.parse=function(t,r){var s=t[0],d=t[1],_=t[2],w=t.slice(3);if(!Array.isArray(d)||0===d.length)return r.error("Expected an interpolation type expression.",1);if("linear"===d[0])d={name:"linear"};else if("exponential"===d[0]){var S=d[1];if("number"!=typeof S)return r.error("Exponential interpolation requires a numeric base.",1,1);d={name:"exponential",base:S}}else{if("cubic-bezier"!==d[0])return r.error("Unknown interpolation type "+String(d[0]),1,0);var A=d.slice(1);if(4!==A.length||A.some(function(Wt){return"number"!=typeof Wt||Wt<0||Wt>1}))return r.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);d={name:"cubic-bezier",controlPoints:A}}if(t.length-1<4)return r.error("Expected at least 4 arguments, but found only "+(t.length-1)+".");if((t.length-1)%2!=0)return r.error("Expected an even number of arguments.");if(!(_=r.parse(_,2,De)))return null;var F=[],U=null;"interpolate-hcl"===s||"interpolate-lab"===s?U=sn:r.expectedType&&"value"!==r.expectedType.kind&&(U=r.expectedType);for(var G=0;G<w.length;G+=2){var V=w[G],K=w[G+1],at=G+3,Ct=G+4;if("number"!=typeof V)return r.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',at);if(F.length&&F[F.length-1][0]>=V)return r.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',at);var _t=r.parse(K,Ct,U);if(!_t)return null;U=U||_t.type,F.push([V,_t])}return"number"===U.kind||"color"===U.kind||"array"===U.kind&&"number"===U.itemType.kind&&"number"==typeof U.N?new Qn(U,s,d,_,F):r.error("Type "+xn(U)+" is not interpolatable.")},Qn.prototype.evaluate=function(t){var r=this.labels,s=this.outputs;if(1===r.length)return s[0].evaluate(t);var d=this.input.evaluate(t);if(d<=r[0])return s[0].evaluate(t);var _=r.length;if(d>=r[_-1])return s[_-1].evaluate(t);var w=ja(r,d),S=Qn.interpolationFactor(this.interpolation,d,r[w],r[w+1]),A=s[w].evaluate(t),F=s[w+1].evaluate(t);return"interpolate"===this.operator?ms[this.type.kind.toLowerCase()](A,F,S):"interpolate-hcl"===this.operator?eo.reverse(eo.interpolate(eo.forward(A),eo.forward(F),S)):Eu.reverse(Eu.interpolate(Eu.forward(A),Eu.forward(F),S))},Qn.prototype.eachChild=function(t){t(this.input);for(var r=0,s=this.outputs;r<s.length;r+=1)t(s[r])},Qn.prototype.outputDefined=function(){return this.outputs.every(function(t){return t.outputDefined()})},Qn.prototype.serialize=function(){var t;t="linear"===this.interpolation.name?["linear"]:"exponential"===this.interpolation.name?1===this.interpolation.base?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);for(var r=[this.operator,t,this.input.serialize()],s=0;s<this.labels.length;s++)r.push(this.labels[s],this.outputs[s].serialize());return r};var Fo=function(t,r){this.type=t,this.args=r};Fo.parse=function(t,r){if(t.length<2)return r.error("Expectected at least one argument.");var s=null,d=r.expectedType;d&&"value"!==d.kind&&(s=d);for(var _=[],w=0,S=t.slice(1);w<S.length;w+=1){var A=r.parse(S[w],1+_.length,s,void 0,{typeAnnotation:"omit"});if(!A)return null;s=s||A.type,_.push(A)}var F=d&&_.some(function(U){return xi(d,U.type)});return new Fo(F?Tr:s,_)},Fo.prototype.evaluate=function(t){for(var r,s=null,d=0,_=0,w=this.args;_<w.length&&(d++,(s=w[_].evaluate(t))&&s instanceof Un&&!s.available&&(r||(r=s.name),s=null,d===this.args.length&&(s=r)),null===s);_+=1);return s},Fo.prototype.eachChild=function(t){this.args.forEach(t)},Fo.prototype.outputDefined=function(){return this.args.every(function(t){return t.outputDefined()})},Fo.prototype.serialize=function(){var t=["coalesce"];return this.eachChild(function(r){t.push(r.serialize())}),t};var rs=function(t,r){this.type=r.type,this.bindings=[].concat(t),this.result=r};rs.prototype.evaluate=function(t){return this.result.evaluate(t)},rs.prototype.eachChild=function(t){for(var r=0,s=this.bindings;r<s.length;r+=1)t(s[r][1]);t(this.result)},rs.parse=function(t,r){if(t.length<4)return r.error("Expected at least 3 arguments, but found "+(t.length-1)+" instead.");for(var s=[],d=1;d<t.length-1;d+=2){var _=t[d];if("string"!=typeof _)return r.error("Expected string, but found "+typeof _+" instead.",d);if(/[^a-zA-Z0-9_]/.test(_))return r.error("Variable names must contain only alphanumeric characters or '_'.",d);var w=r.parse(t[d+1],d+1);if(!w)return null;s.push([_,w])}var S=r.parse(t[t.length-1],t.length-1,r.expectedType,s);return S?new rs(s,S):null},rs.prototype.outputDefined=function(){return this.result.outputDefined()},rs.prototype.serialize=function(){for(var t=["let"],r=0,s=this.bindings;r<s.length;r+=1){var d=s[r];t.push(d[0],d[1].serialize())}return t.push(this.result.serialize()),t};var wi=function(t,r,s){this.type=t,this.index=r,this.input=s};wi.parse=function(t,r){if(3!==t.length)return r.error("Expected 2 arguments, but found "+(t.length-1)+" instead.");var s=r.parse(t[1],1,De),d=r.parse(t[2],2,Tn(r.expectedType||Tr));return s&&d?new wi(d.type.itemType,s,d):null},wi.prototype.evaluate=function(t){var r=this.index.evaluate(t),s=this.input.evaluate(t);if(r<0)throw new Mi("Array index out of bounds: "+r+" < 0.");if(r>=s.length)throw new Mi("Array index out of bounds: "+r+" > "+(s.length-1)+".");if(r!==Math.floor(r))throw new Mi("Array index must be an integer, but found "+r+" instead.");return s[r]},wi.prototype.eachChild=function(t){t(this.index),t(this.input)},wi.prototype.outputDefined=function(){return!1},wi.prototype.serialize=function(){return["at",this.index.serialize(),this.input.serialize()]};var kr=function(t,r){this.type=Be,this.needle=t,this.haystack=r};kr.parse=function(t,r){if(3!==t.length)return r.error("Expected 2 arguments, but found "+(t.length-1)+" instead.");var s=r.parse(t[1],1,Tr),d=r.parse(t[2],2,Tr);return s&&d?zn(s.type,[Be,sr,De,Pr,Tr])?new kr(s,d):r.error("Expected first argument to be of type boolean, string, number or null, but found "+xn(s.type)+" instead"):null},kr.prototype.evaluate=function(t){var r=this.needle.evaluate(t),s=this.haystack.evaluate(t);if(!s)return!1;if(!un(r,["boolean","string","number","null"]))throw new Mi("Expected first argument to be of type boolean, string, number or null, but found "+xn(mo(r))+" instead.");if(!un(s,["string","array"]))throw new Mi("Expected second argument to be of type array or string, but found "+xn(mo(s))+" instead.");return s.indexOf(r)>=0},kr.prototype.eachChild=function(t){t(this.needle),t(this.haystack)},kr.prototype.outputDefined=function(){return!0},kr.prototype.serialize=function(){return["in",this.needle.serialize(),this.haystack.serialize()]};var Xs=function(t,r,s){this.type=De,this.needle=t,this.haystack=r,this.fromIndex=s};Xs.parse=function(t,r){if(t.length<=2||t.length>=5)return r.error("Expected 3 or 4 arguments, but found "+(t.length-1)+" instead.");var s=r.parse(t[1],1,Tr),d=r.parse(t[2],2,Tr);if(!s||!d)return null;if(!zn(s.type,[Be,sr,De,Pr,Tr]))return r.error("Expected first argument to be of type boolean, string, number or null, but found "+xn(s.type)+" instead");if(4===t.length){var _=r.parse(t[3],3,De);return _?new Xs(s,d,_):null}return new Xs(s,d)},Xs.prototype.evaluate=function(t){var r=this.needle.evaluate(t),s=this.haystack.evaluate(t);if(!un(r,["boolean","string","number","null"]))throw new Mi("Expected first argument to be of type boolean, string, number or null, but found "+xn(mo(r))+" instead.");if(!un(s,["string","array"]))throw new Mi("Expected second argument to be of type array or string, but found "+xn(mo(s))+" instead.");if(this.fromIndex){var d=this.fromIndex.evaluate(t);return s.indexOf(r,d)}return s.indexOf(r)},Xs.prototype.eachChild=function(t){t(this.needle),t(this.haystack),this.fromIndex&&t(this.fromIndex)},Xs.prototype.outputDefined=function(){return!1},Xs.prototype.serialize=function(){if(null!=this.fromIndex&&void 0!==this.fromIndex){var t=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),t]}return["index-of",this.needle.serialize(),this.haystack.serialize()]};var ys=function(t,r,s,d,_,w){this.inputType=t,this.type=r,this.input=s,this.cases=d,this.outputs=_,this.otherwise=w};ys.parse=function(t,r){if(t.length<5)return r.error("Expected at least 4 arguments, but found only "+(t.length-1)+".");if(t.length%2!=1)return r.error("Expected an even number of arguments.");var s,d;r.expectedType&&"value"!==r.expectedType.kind&&(d=r.expectedType);for(var _={},w=[],S=2;S<t.length-1;S+=2){var A=t[S],F=t[S+1];Array.isArray(A)||(A=[A]);var U=r.concat(S);if(0===A.length)return U.error("Expected at least one branch label.");for(var G=0,V=A;G<V.length;G+=1){var K=V[G];if("number"!=typeof K&&"string"!=typeof K)return U.error("Branch labels must be numbers or strings.");if("number"==typeof K&&Math.abs(K)>Number.MAX_SAFE_INTEGER)return U.error("Branch labels must be integers no larger than "+Number.MAX_SAFE_INTEGER+".");if("number"==typeof K&&Math.floor(K)!==K)return U.error("Numeric branch labels must be integer values.");if(s){if(U.checkSubtype(s,mo(K)))return null}else s=mo(K);if(void 0!==_[String(K)])return U.error("Branch labels must be unique.");_[String(K)]=w.length}var at=r.parse(F,S,d);if(!at)return null;d=d||at.type,w.push(at)}var Ct=r.parse(t[1],1,Tr);if(!Ct)return null;var _t=r.parse(t[t.length-1],t.length-1,d);return _t?"value"!==Ct.type.kind&&r.concat(1).checkSubtype(s,Ct.type)?null:new ys(s,d,Ct,_,w,_t):null},ys.prototype.evaluate=function(t){var r=this.input.evaluate(t);return(mo(r)===this.inputType&&this.outputs[this.cases[r]]||this.otherwise).evaluate(t)},ys.prototype.eachChild=function(t){t(this.input),this.outputs.forEach(t),t(this.otherwise)},ys.prototype.outputDefined=function(){return this.outputs.every(function(t){return t.outputDefined()})&&this.otherwise.outputDefined()},ys.prototype.serialize=function(){for(var t=this,r=["match",this.input.serialize()],s=[],d={},_=0,w=Object.keys(this.cases).sort();_<w.length;_+=1){var S=w[_];void 0===(V=d[this.cases[S]])?(d[this.cases[S]]=s.length,s.push([this.cases[S],[S]])):s[V][1].push(S)}for(var A=function(at){return"number"===t.inputType.kind?Number(at):at},F=0,U=s;F<U.length;F+=1){var G=U[F],V=G[0],K=G[1];r.push(1===K.length?A(K[0]):K.map(A)),r.push(this.outputs[outputIndex$1].serialize())}return r.push(this.otherwise.serialize()),r};var co=function(t,r,s){this.type=t,this.branches=r,this.otherwise=s};co.parse=function(t,r){if(t.length<4)return r.error("Expected at least 3 arguments, but found only "+(t.length-1)+".");if(t.length%2!=0)return r.error("Expected an odd number of arguments.");var s;r.expectedType&&"value"!==r.expectedType.kind&&(s=r.expectedType);for(var d=[],_=1;_<t.length-1;_+=2){var w=r.parse(t[_],_,Be);if(!w)return null;var S=r.parse(t[_+1],_+1,s);if(!S)return null;d.push([w,S]),s=s||S.type}var A=r.parse(t[t.length-1],t.length-1,s);return A?new co(s,d,A):null},co.prototype.evaluate=function(t){for(var r=0,s=this.branches;r<s.length;r+=1){var d=s[r],_=d[1];if(d[0].evaluate(t))return _.evaluate(t)}return this.otherwise.evaluate(t)},co.prototype.eachChild=function(t){for(var r=0,s=this.branches;r<s.length;r+=1){var d=s[r],_=d[1];t(d[0]),t(_)}t(this.otherwise)},co.prototype.outputDefined=function(){return this.branches.every(function(t){return t[1].outputDefined()})&&this.otherwise.outputDefined()},co.prototype.serialize=function(){var t=["case"];return this.eachChild(function(r){t.push(r.serialize())}),t};var Wo=function(t,r,s,d){this.type=t,this.input=r,this.beginIndex=s,this.endIndex=d};function Ys(t,r){return"=="===t||"!="===t?"boolean"===r.kind||"string"===r.kind||"number"===r.kind||"null"===r.kind||"value"===r.kind:"string"===r.kind||"number"===r.kind||"value"===r.kind}function Ei(t,r,s,d){return 0===d.compare(r,s)}function cu(t,r,s){var d="=="!==t&&"!="!==t;return function(){function _(w,S,A){this.type=Be,this.lhs=w,this.rhs=S,this.collator=A,this.hasUntypedArgument="value"===w.type.kind||"value"===S.type.kind}return _.parse=function(w,S){if(3!==w.length&&4!==w.length)return S.error("Expected two or three arguments.");var A=w[0],F=S.parse(w[1],1,Tr);if(!F)return null;if(!Ys(A,F.type))return S.concat(1).error('"'+A+"\" comparisons are not supported for type '"+xn(F.type)+"'.");var U=S.parse(w[2],2,Tr);if(!U)return null;if(!Ys(A,U.type))return S.concat(2).error('"'+A+"\" comparisons are not supported for type '"+xn(U.type)+"'.");if(F.type.kind!==U.type.kind&&"value"!==F.type.kind&&"value"!==U.type.kind)return S.error("Cannot compare types '"+xn(F.type)+"' and '"+xn(U.type)+"'.");d&&("value"===F.type.kind&&"value"!==U.type.kind?F=new zo(U.type,[F]):"value"!==F.type.kind&&"value"===U.type.kind&&(U=new zo(F.type,[U])));var G=null;if(4===w.length){if("string"!==F.type.kind&&"string"!==U.type.kind&&"value"!==F.type.kind&&"value"!==U.type.kind)return S.error("Cannot use collator to compare non-string types.");if(!(G=S.parse(w[3],3,wr)))return null}return new _(F,U,G)},_.prototype.evaluate=function(w){var S=this.lhs.evaluate(w),A=this.rhs.evaluate(w);if(d&&this.hasUntypedArgument){var F=mo(S),U=mo(A);if(F.kind!==U.kind||"string"!==F.kind&&"number"!==F.kind)throw new Mi('Expected arguments for "'+t+'" to be (string, string) or (number, number), but found ('+F.kind+", "+U.kind+") instead.")}if(this.collator&&!d&&this.hasUntypedArgument){var G=mo(S),V=mo(A);if("string"!==G.kind||"string"!==V.kind)return r(w,S,A)}return this.collator?s(w,S,A,this.collator.evaluate(w)):r(w,S,A)},_.prototype.eachChild=function(w){w(this.lhs),w(this.rhs),this.collator&&w(this.collator)},_.prototype.outputDefined=function(){return!0},_.prototype.serialize=function(){var w=[t];return this.eachChild(function(S){w.push(S.serialize())}),w},_}()}Wo.parse=function(t,r){if(t.length<=2||t.length>=5)return r.error("Expected 3 or 4 arguments, but found "+(t.length-1)+" instead.");var s=r.parse(t[1],1,Tr),d=r.parse(t[2],2,De);if(!s||!d)return null;if(!zn(s.type,[Tn(Tr),sr,Tr]))return r.error("Expected first argument to be of type array or string, but found "+xn(s.type)+" instead");if(4===t.length){var _=r.parse(t[3],3,De);return _?new Wo(s.type,s,d,_):null}return new Wo(s.type,s,d)},Wo.prototype.evaluate=function(t){var r=this.input.evaluate(t),s=this.beginIndex.evaluate(t);if(!un(r,["string","array"]))throw new Mi("Expected first argument to be of type array or string, but found "+xn(mo(r))+" instead.");if(this.endIndex){var d=this.endIndex.evaluate(t);return r.slice(s,d)}return r.slice(s)},Wo.prototype.eachChild=function(t){t(this.input),t(this.beginIndex),this.endIndex&&t(this.endIndex)},Wo.prototype.outputDefined=function(){return!1},Wo.prototype.serialize=function(){if(null!=this.endIndex&&void 0!==this.endIndex){var t=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),t]}return["slice",this.input.serialize(),this.beginIndex.serialize()]};var Hu=cu("==",function(t,r,s){return r===s},Ei),qn=cu("!=",function(t,r,s){return r!==s},function(t,r,s,d){return!Ei(0,r,s,d)}),Ts=cu("<",function(t,r,s){return r<s},function(t,r,s,d){return d.compare(r,s)<0}),Ni=cu(">",function(t,r,s){return r>s},function(t,r,s,d){return d.compare(r,s)>0}),Su=cu("<=",function(t,r,s){return r<=s},function(t,r,s,d){return d.compare(r,s)<=0}),Ia=cu(">=",function(t,r,s){return r>=s},function(t,r,s,d){return d.compare(r,s)>=0}),Ws=function(t,r,s,d,_){this.type=sr,this.number=t,this.locale=r,this.currency=s,this.minFractionDigits=d,this.maxFractionDigits=_};Ws.parse=function(t,r){if(3!==t.length)return r.error("Expected two arguments.");var s=r.parse(t[1],1,De);if(!s)return null;var d=t[2];if("object"!=typeof d||Array.isArray(d))return r.error("NumberFormat options argument must be an object.");var _=null;if(d.locale&&!(_=r.parse(d.locale,1,sr)))return null;var w=null;if(d.currency&&!(w=r.parse(d.currency,1,sr)))return null;var S=null;if(d["min-fraction-digits"]&&!(S=r.parse(d["min-fraction-digits"],1,De)))return null;var A=null;return d["max-fraction-digits"]&&!(A=r.parse(d["max-fraction-digits"],1,De))?null:new Ws(s,_,w,S,A)},Ws.prototype.evaluate=function(t){return new Intl.NumberFormat(this.locale?this.locale.evaluate(t):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(t):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(t):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(t):void 0}).format(this.number.evaluate(t))},Ws.prototype.eachChild=function(t){t(this.number),this.locale&&t(this.locale),this.currency&&t(this.currency),this.minFractionDigits&&t(this.minFractionDigits),this.maxFractionDigits&&t(this.maxFractionDigits)},Ws.prototype.outputDefined=function(){return!1},Ws.prototype.serialize=function(){var t={};return this.locale&&(t.locale=this.locale.serialize()),this.currency&&(t.currency=this.currency.serialize()),this.minFractionDigits&&(t["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(t["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),t]};var wn=function(t){this.type=De,this.input=t};wn.parse=function(t,r){if(2!==t.length)return r.error("Expected 1 argument, but found "+(t.length-1)+" instead.");var s=r.parse(t[1],1);return s?"array"!==s.type.kind&&"string"!==s.type.kind&&"value"!==s.type.kind?r.error("Expected argument of type string or array, but found "+xn(s.type)+" instead."):new wn(s):null},wn.prototype.evaluate=function(t){var r=this.input.evaluate(t);if("string"==typeof r||Array.isArray(r))return r.length;throw new Mi("Expected value to be of type string or array, but found "+xn(mo(r))+" instead.")},wn.prototype.eachChild=function(t){t(this.input)},wn.prototype.outputDefined=function(){return!1},wn.prototype.serialize=function(){var t=["length"];return this.eachChild(function(r){t.push(r.serialize())}),t};var vs={"==":Hu,"!=":qn,">":Ni,"<":Ts,">=":Ia,"<=":Su,array:zo,at:wi,boolean:zo,case:co,coalesce:Fo,collator:yo,format:nn,image:Ps,in:kr,"index-of":Xs,interpolate:Qn,"interpolate-hcl":Qn,"interpolate-lab":Qn,length:wn,let:rs,literal:bn,match:ys,number:zo,"number-format":Ws,object:zo,slice:Wo,step:so,string:zo,"to-boolean":jo,"to-color":jo,"to-number":jo,"to-string":jo,var:ii,within:Yo};function Ci(t,r){var s=r[0],d=r[1],_=r[2],w=r[3];s=s.evaluate(t),d=d.evaluate(t),_=_.evaluate(t);var S=w?w.evaluate(t):1,A=ml(s,d,_,S);if(A)throw new Mi(A);return new An(s/255*S,d/255*S,_/255*S,S)}function ku(t,r){return t in r}function Bo(t,r){var s=r[t];return void 0===s?null:s}function Xa(t){return{type:t}}function _l(t){return{result:"success",value:t}}function Ya(t){return{result:"error",value:t}}function kn(t){return"data-driven"===t["property-type"]||"cross-faded-data-driven"===t["property-type"]}function da(t){return!!t.expression&&t.expression.parameters.indexOf("zoom")>-1}function hu(t){return!!t.expression&&t.expression.interpolated}function Gn(t){return t instanceof Number?"number":t instanceof String?"string":t instanceof Boolean?"boolean":Array.isArray(t)?"array":null===t?"null":typeof t}function Ho(t){return"object"==typeof t&&null!==t&&!Array.isArray(t)}function Uo(t){return t}function zu(t,r,s){return void 0!==t?t:void 0!==r?r:void 0!==s?s:void 0}function pc(t,r,s,d,_){return zu(typeof s===_?d[s]:void 0,t.default,r.default)}function Hs(t,r,s){if("number"!==Gn(s))return zu(t.default,r.default);var d=t.stops.length;if(1===d||s<=t.stops[0][0])return t.stops[0][1];if(s>=t.stops[d-1][0])return t.stops[d-1][1];var _=ja(t.stops.map(function(w){return w[0]}),s);return t.stops[_][1]}function ga(t,r,s){var d=void 0!==t.base?t.base:1;if("number"!==Gn(s))return zu(t.default,r.default);var _=t.stops.length;if(1===_||s<=t.stops[0][0])return t.stops[0][1];if(s>=t.stops[_-1][0])return t.stops[_-1][1];var K,at,_t,Wt,w=ja(t.stops.map(function(V){return V[0]}),s),S=(K=d,Wt=s-(at=t.stops[w][0]),0==(_t=t.stops[w+1][0]-at)?0:1===K?Wt/_t:(Math.pow(K,Wt)-1)/(Math.pow(K,_t)-1)),A=t.stops[w][1],F=t.stops[w+1][1],U=ms[r.type]||Uo;if(t.colorSpace&&"rgb"!==t.colorSpace){var G=Us[t.colorSpace];U=function(V,K){return G.reverse(G.interpolate(G.forward(V),G.forward(K),S))}}return"function"==typeof A.evaluate?{evaluate:function(){for(var V=[],K=arguments.length;K--;)V[K]=arguments[K];var at=A.evaluate.apply(void 0,V),Ct=F.evaluate.apply(void 0,V);if(void 0!==at&&void 0!==Ct)return U(at,Ct,S)}}:U(A,F,S)}function Js(t,r,s){return"color"===r.type?s=An.parse(s):"formatted"===r.type?s=oo.fromString(s.toString()):"resolvedImage"===r.type?s=Un.fromString(s.toString()):Gn(s)===r.type||"enum"===r.type&&r.values[s]||(s=void 0),zu(s,t.default,r.default)}Mo.register(vs,{error:[{kind:"error"},[sr],function(t,r){throw new Mi(r[0].evaluate(t))}],typeof:[sr,[Tr],function(t,r){return xn(mo(r[0].evaluate(t)))}],"to-rgba":[Tn(De,4),[sn],function(t,r){return r[0].evaluate(t).toArray()}],rgb:[sn,[De,De,De],Ci],rgba:[sn,[De,De,De,De],Ci],has:{type:Be,overloads:[[[sr],function(t,r){return ku(r[0].evaluate(t),t.properties())}],[[sr,qr],function(t,r){var s=r[1];return ku(r[0].evaluate(t),s.evaluate(t))}]]},get:{type:Tr,overloads:[[[sr],function(t,r){return Bo(r[0].evaluate(t),t.properties())}],[[sr,qr],function(t,r){var s=r[1];return Bo(r[0].evaluate(t),s.evaluate(t))}]]},"feature-state":[Tr,[sr],function(t,r){return Bo(r[0].evaluate(t),t.featureState||{})}],properties:[qr,[],function(t){return t.properties()}],"geometry-type":[sr,[],function(t){return t.geometryType()}],id:[Tr,[],function(t){return t.id()}],zoom:[De,[],function(t){return t.globals.zoom}],"heatmap-density":[De,[],function(t){return t.globals.heatmapDensity||0}],"line-progress":[De,[],function(t){return t.globals.lineProgress||0}],accumulated:[Tr,[],function(t){return void 0===t.globals.accumulated?null:t.globals.accumulated}],"+":[De,Xa(De),function(t,r){for(var s=0,d=0,_=r;d<_.length;d+=1)s+=_[d].evaluate(t);return s}],"*":[De,Xa(De),function(t,r){for(var s=1,d=0,_=r;d<_.length;d+=1)s*=_[d].evaluate(t);return s}],"-":{type:De,overloads:[[[De,De],function(t,r){var s=r[1];return r[0].evaluate(t)-s.evaluate(t)}],[[De],function(t,r){return-r[0].evaluate(t)}]]},"/":[De,[De,De],function(t,r){var s=r[1];return r[0].evaluate(t)/s.evaluate(t)}],"%":[De,[De,De],function(t,r){var s=r[1];return r[0].evaluate(t)%s.evaluate(t)}],ln2:[De,[],function(){return Math.LN2}],pi:[De,[],function(){return Math.PI}],e:[De,[],function(){return Math.E}],"^":[De,[De,De],function(t,r){var s=r[1];return Math.pow(r[0].evaluate(t),s.evaluate(t))}],sqrt:[De,[De],function(t,r){return Math.sqrt(r[0].evaluate(t))}],log10:[De,[De],function(t,r){return Math.log(r[0].evaluate(t))/Math.LN10}],ln:[De,[De],function(t,r){return Math.log(r[0].evaluate(t))}],log2:[De,[De],function(t,r){return Math.log(r[0].evaluate(t))/Math.LN2}],sin:[De,[De],function(t,r){return Math.sin(r[0].evaluate(t))}],cos:[De,[De],function(t,r){return Math.cos(r[0].evaluate(t))}],tan:[De,[De],function(t,r){return Math.tan(r[0].evaluate(t))}],asin:[De,[De],function(t,r){return Math.asin(r[0].evaluate(t))}],acos:[De,[De],function(t,r){return Math.acos(r[0].evaluate(t))}],atan:[De,[De],function(t,r){return Math.atan(r[0].evaluate(t))}],min:[De,Xa(De),function(t,r){return Math.min.apply(Math,r.map(function(s){return s.evaluate(t)}))}],max:[De,Xa(De),function(t,r){return Math.max.apply(Math,r.map(function(s){return s.evaluate(t)}))}],abs:[De,[De],function(t,r){return Math.abs(r[0].evaluate(t))}],round:[De,[De],function(t,r){var s=r[0].evaluate(t);return s<0?-Math.round(-s):Math.round(s)}],floor:[De,[De],function(t,r){return Math.floor(r[0].evaluate(t))}],ceil:[De,[De],function(t,r){return Math.ceil(r[0].evaluate(t))}],"filter-==":[Be,[sr,Tr],function(t,r){var s=r[0],d=r[1];return t.properties()[s.value]===d.value}],"filter-id-==":[Be,[Tr],function(t,r){var s=r[0];return t.id()===s.value}],"filter-type-==":[Be,[sr],function(t,r){var s=r[0];return t.geometryType()===s.value}],"filter-<":[Be,[sr,Tr],function(t,r){var s=r[0],d=r[1],_=t.properties()[s.value],w=d.value;return typeof _==typeof w&&_<w}],"filter-id-<":[Be,[Tr],function(t,r){var s=r[0],d=t.id(),_=s.value;return typeof d==typeof _&&d<_}],"filter->":[Be,[sr,Tr],function(t,r){var s=r[0],d=r[1],_=t.properties()[s.value],w=d.value;return typeof _==typeof w&&_>w}],"filter-id->":[Be,[Tr],function(t,r){var s=r[0],d=t.id(),_=s.value;return typeof d==typeof _&&d>_}],"filter-<=":[Be,[sr,Tr],function(t,r){var s=r[0],d=r[1],_=t.properties()[s.value],w=d.value;return typeof _==typeof w&&_<=w}],"filter-id-<=":[Be,[Tr],function(t,r){var s=r[0],d=t.id(),_=s.value;return typeof d==typeof _&&d<=_}],"filter->=":[Be,[sr,Tr],function(t,r){var s=r[0],d=r[1],_=t.properties()[s.value],w=d.value;return typeof _==typeof w&&_>=w}],"filter-id->=":[Be,[Tr],function(t,r){var s=r[0],d=t.id(),_=s.value;return typeof d==typeof _&&d>=_}],"filter-has":[Be,[Tr],function(t,r){return r[0].value in t.properties()}],"filter-has-id":[Be,[],function(t){return null!==t.id()&&void 0!==t.id()}],"filter-type-in":[Be,[Tn(sr)],function(t,r){return r[0].value.indexOf(t.geometryType())>=0}],"filter-id-in":[Be,[Tn(Tr)],function(t,r){return r[0].value.indexOf(t.id())>=0}],"filter-in-small":[Be,[sr,Tn(Tr)],function(t,r){var s=r[0];return r[1].value.indexOf(t.properties()[s.value])>=0}],"filter-in-large":[Be,[sr,Tn(Tr)],function(t,r){var s=r[0],d=r[1];return function(_,w,S,A){for(;S<=A;){var F=S+A>>1;if(w[F]===_)return!0;w[F]>_?A=F-1:S=F+1}return!1}(t.properties()[s.value],d.value,0,d.value.length-1)}],all:{type:Be,overloads:[[[Be,Be],function(t,r){var s=r[1];return r[0].evaluate(t)&&s.evaluate(t)}],[Xa(Be),function(t,r){for(var s=0,d=r;s<d.length;s+=1)if(!d[s].evaluate(t))return!1;return!0}]]},any:{type:Be,overloads:[[[Be,Be],function(t,r){var s=r[1];return r[0].evaluate(t)||s.evaluate(t)}],[Xa(Be),function(t,r){for(var s=0,d=r;s<d.length;s+=1)if(d[s].evaluate(t))return!0;return!1}]]},"!":[Be,[Be],function(t,r){return!r[0].evaluate(t)}],"is-supported-script":[Be,[sr],function(t,r){var s=t.globals&&t.globals.isSupportedScript;return!s||s(r[0].evaluate(t))}],upcase:[sr,[sr],function(t,r){return r[0].evaluate(t).toUpperCase()}],downcase:[sr,[sr],function(t,r){return r[0].evaluate(t).toLowerCase()}],concat:[sr,Xa(Tr),function(t,r){return r.map(function(s){return Is(s.evaluate(t))}).join("")}],"resolved-locale":[sr,[wr],function(t,r){return r[0].evaluate(t).resolvedLocale()}]});var qo=function(t,r){var s;this.expression=t,this._warningHistory={},this._evaluator=new ra,this._defaultValue=r?"color"===(s=r).type&&Ho(s.default)?new An(0,0,0,0):"color"===s.type?An.parse(s.default)||null:void 0===s.default?null:s.default:null,this._enumValues=r&&"enum"===r.type?r.values:null};function ma(t){return Array.isArray(t)&&t.length>0&&"string"==typeof t[0]&&t[0]in vs}function za(t,r){var _,w,s=new ao(vs,[],r?(w={color:sn,string:sr,number:De,enum:sr,boolean:Be,formatted:zr,resolvedImage:ui},"array"===(_=r).type?Tn(w[_.value]||Tr,_.length):w[_.type]):void 0),d=s.parse(t,void 0,void 0,void 0,r&&"string"===r.type?{typeAnnotation:"coerce"}:void 0);return d?_l(new qo(d,r)):Ya(s.errors)}qo.prototype.evaluateWithoutErrorHandling=function(t,r,s,d,_,w){return this._evaluator.globals=t,this._evaluator.feature=r,this._evaluator.featureState=s,this._evaluator.canonical=d,this._evaluator.availableImages=_||null,this._evaluator.formattedSection=w,this.expression.evaluate(this._evaluator)},qo.prototype.evaluate=function(t,r,s,d,_,w){this._evaluator.globals=t,this._evaluator.feature=r||null,this._evaluator.featureState=s||null,this._evaluator.canonical=d,this._evaluator.availableImages=_||null,this._evaluator.formattedSection=w||null;try{var S=this.expression.evaluate(this._evaluator);if(null==S||"number"==typeof S&&S!=S)return this._defaultValue;if(this._enumValues&&!(S in this._enumValues))throw new Mi("Expected value to be one of "+Object.keys(this._enumValues).map(function(A){return JSON.stringify(A)}).join(", ")+", but found "+JSON.stringify(S)+" instead.");return S}catch(A){return this._warningHistory[A.message]||(this._warningHistory[A.message]=!0,"undefined"!=typeof console&&console.warn(A.message)),this._defaultValue}};var _s=function(t,r){this.kind=t,this._styleExpression=r,this.isStateDependent="constant"!==t&&!Bs(r.expression)};_s.prototype.evaluateWithoutErrorHandling=function(t,r,s,d,_,w){return this._styleExpression.evaluateWithoutErrorHandling(t,r,s,d,_,w)},_s.prototype.evaluate=function(t,r,s,d,_,w){return this._styleExpression.evaluate(t,r,s,d,_,w)};var Fa=function(t,r,s,d){this.kind=t,this.zoomStops=s,this._styleExpression=r,this.isStateDependent="camera"!==t&&!Bs(r.expression),this.interpolationType=d};function vo(t,r){if("error"===(t=za(t,r)).result)return t;var s=t.value.expression,d=Wi(s);if(!d&&!kn(r))return Ya([new lr("","data expressions not supported")]);var _=js(s,["zoom"]);if(!_&&!da(r))return Ya([new lr("","zoom expressions not supported")]);var w=function S(A){var F=null;if(A instanceof rs)F=S(A.result);else if(A instanceof Fo)for(var U=0,G=A.args;U<G.length&&!(F=S(G[U]));U+=1);else(A instanceof so||A instanceof Qn)&&A.input instanceof Mo&&"zoom"===A.input.name&&(F=A);return F instanceof lr||A.eachChild(function(V){var K=S(V);K instanceof lr?F=K:!F&&K?F=new lr("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):F&&K&&F!==K&&(F=new lr("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),F}(s);return w||_?w instanceof lr?Ya([w]):w instanceof Qn&&!hu(r)?Ya([new lr("",'"interpolate" expressions cannot be used with this property')]):_l(w?new Fa(d?"camera":"composite",t.value,w.labels,w instanceof Qn?w.interpolation:void 0):new _s(d?"constant":"source",t.value)):Ya([new lr("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}Fa.prototype.evaluateWithoutErrorHandling=function(t,r,s,d,_,w){return this._styleExpression.evaluateWithoutErrorHandling(t,r,s,d,_,w)},Fa.prototype.evaluate=function(t,r,s,d,_,w){return this._styleExpression.evaluate(t,r,s,d,_,w)},Fa.prototype.interpolationFactor=function(t,r,s){return this.interpolationType?Qn.interpolationFactor(this.interpolationType,t,r,s):0};var Fu=function(t,r){this._parameters=t,this._specification=r,or(this,function s(d,_){var w,S,A,F="color"===_.type,U=d.stops&&"object"==typeof d.stops[0][0],G=U||!(U||void 0!==d.property),V=d.type||(hu(_)?"exponential":"interval");if(F&&((d=or({},d)).stops&&(d.stops=d.stops.map(function(hr){return[hr[0],An.parse(hr[1])]})),d.default=An.parse(d.default?d.default:_.default)),d.colorSpace&&"rgb"!==d.colorSpace&&!Us[d.colorSpace])throw new Error("Unknown color space: "+d.colorSpace);if("exponential"===V)w=ga;else if("interval"===V)w=Hs;else if("categorical"===V){w=pc,S=Object.create(null);for(var K=0,at=d.stops;K<at.length;K+=1){var Ct=at[K];S[Ct[0]]=Ct[1]}A=typeof d.stops[0][0]}else{if("identity"!==V)throw new Error('Unknown function type "'+V+'"');w=Js}if(U){for(var _t={},Wt=[],Gt=0;Gt<d.stops.length;Gt++){var pe=d.stops[Gt],de=pe[0].zoom;void 0===_t[de]&&(_t[de]={zoom:de,type:d.type,property:d.property,default:d.default,stops:[]},Wt.push(de)),_t[de].stops.push([pe[0].value,pe[1]])}for(var Pe=[],ue=0,qe=Wt;ue<qe.length;ue+=1){var Ke=qe[ue];Pe.push([_t[Ke].zoom,s(_t[Ke],_)])}var fr={name:"linear"};return{kind:"composite",interpolationType:fr,interpolationFactor:Qn.interpolationFactor.bind(void 0,fr),zoomStops:Pe.map(function(hr){return hr[0]}),evaluate:function(hr,jr){var Qe=hr.zoom;return ga({stops:Pe,base:d.base},_,Qe).evaluate(Qe,jr)}}}if(G){var Nr="exponential"===V?{name:"exponential",base:void 0!==d.base?d.base:1}:null;return{kind:"camera",interpolationType:Nr,interpolationFactor:Qn.interpolationFactor.bind(void 0,Nr),zoomStops:d.stops.map(function(hr){return hr[0]}),evaluate:function(hr){return w(d,_,hr.zoom,S,A)}}}return{kind:"source",evaluate:function(hr,jr){var Qe=jr&&jr.properties?jr.properties[d.property]:void 0;return void 0===Qe?zu(d.default,_.default):w(d,_,Qe,S,A)}}}(this._parameters,this._specification))};function Wa(t){var r=t.key,s=t.value,d=t.valueSpec||{},_=t.objectElementValidators||{},w=t.style,S=t.styleSpec,A=[],F=Gn(s);if("object"!==F)return[new Ut(r,s,"object expected, "+F+" found")];for(var U in s){var G=U.split(".")[0],V=d[G]||d["*"],K=void 0;if(_[G])K=_[G];else if(d[G])K=Rn;else if(_["*"])K=_["*"];else{if(!d["*"]){A.push(new Ut(r,s[U],'unknown property "'+U+'"'));continue}K=Rn}A=A.concat(K({key:(r&&r+".")+U,value:s[U],valueSpec:V,style:w,styleSpec:S,object:s,objectKey:U},s))}for(var at in d)_[at]||d[at].required&&void 0===d[at].default&&void 0===s[at]&&A.push(new Ut(r,s,'missing required property "'+at+'"'));return A}function Jo(t){var r=t.value,s=t.valueSpec,d=t.style,_=t.styleSpec,w=t.key,S=t.arrayElementValidator||Rn;if("array"!==Gn(r))return[new Ut(w,r,"array expected, "+Gn(r)+" found")];if(s.length&&r.length!==s.length)return[new Ut(w,r,"array length "+s.length+" expected, length "+r.length+" found")];if(s["min-length"]&&r.length<s["min-length"])return[new Ut(w,r,"array length at least "+s["min-length"]+" expected, length "+r.length+" found")];var A={type:s.value,values:s.values};_.$version<7&&(A.function=s.function),"object"===Gn(s.value)&&(A=s.value);for(var F=[],U=0;U<r.length;U++)F=F.concat(S({array:r,arrayIndex:U,value:r[U],valueSpec:A,style:d,styleSpec:_,key:w+"["+U+"]"}));return F}function As(t){var r=t.key,s=t.value,d=t.valueSpec,_=Gn(s);return"number"===_&&s!=s&&(_="NaN"),"number"!==_?[new Ut(r,s,"number expected, "+_+" found")]:"minimum"in d&&s<d.minimum?[new Ut(r,s,s+" is less than the minimum value "+d.minimum)]:"maximum"in d&&s>d.maximum?[new Ut(r,s,s+" is greater than the maximum value "+d.maximum)]:[]}function Ha(t){var r,s,d,_=t.valueSpec,w=ye(t.value.type),S={},A="categorical"!==w&&void 0===t.value.property,F=!A,U="array"===Gn(t.value.stops)&&"array"===Gn(t.value.stops[0])&&"object"===Gn(t.value.stops[0][0]),G=Wa({key:t.key,value:t.value,valueSpec:t.styleSpec.function,style:t.style,styleSpec:t.styleSpec,objectElementValidators:{stops:function(at){if("identity"===w)return[new Ut(at.key,at.value,'identity function may not have a "stops" property')];var Ct=[],_t=at.value;return Ct=Ct.concat(Jo({key:at.key,value:_t,valueSpec:at.valueSpec,style:at.style,styleSpec:at.styleSpec,arrayElementValidator:V})),"array"===Gn(_t)&&0===_t.length&&Ct.push(new Ut(at.key,_t,"array must have at least one stop")),Ct},default:function(at){return Rn({key:at.key,value:at.value,valueSpec:_,style:at.style,styleSpec:at.styleSpec})}}});return"identity"===w&&A&&G.push(new Ut(t.key,t.value,'missing required property "property"')),"identity"===w||t.value.stops||G.push(new Ut(t.key,t.value,'missing required property "stops"')),"exponential"===w&&t.valueSpec.expression&&!hu(t.valueSpec)&&G.push(new Ut(t.key,t.value,"exponential functions not supported")),t.styleSpec.$version>=8&&(F&&!kn(t.valueSpec)?G.push(new Ut(t.key,t.value,"property functions not supported")):A&&!da(t.valueSpec)&&G.push(new Ut(t.key,t.value,"zoom functions not supported"))),"categorical"!==w&&!U||void 0!==t.value.property||G.push(new Ut(t.key,t.value,'"property" property is required')),G;function V(at){var Ct=[],_t=at.value,Wt=at.key;if("array"!==Gn(_t))return[new Ut(Wt,_t,"array expected, "+Gn(_t)+" found")];if(2!==_t.length)return[new Ut(Wt,_t,"array length 2 expected, length "+_t.length+" found")];if(U){if("object"!==Gn(_t[0]))return[new Ut(Wt,_t,"object expected, "+Gn(_t[0])+" found")];if(void 0===_t[0].zoom)return[new Ut(Wt,_t,"object stop key must have zoom")];if(void 0===_t[0].value)return[new Ut(Wt,_t,"object stop key must have value")];if(d&&d>ye(_t[0].zoom))return[new Ut(Wt,_t[0].zoom,"stop zoom values must appear in ascending order")];ye(_t[0].zoom)!==d&&(d=ye(_t[0].zoom),s=void 0,S={}),Ct=Ct.concat(Wa({key:Wt+"[0]",value:_t[0],valueSpec:{zoom:{}},style:at.style,styleSpec:at.styleSpec,objectElementValidators:{zoom:As,value:K}}))}else Ct=Ct.concat(K({key:Wt+"[0]",value:_t[0],valueSpec:{},style:at.style,styleSpec:at.styleSpec},_t));return ma(Le(_t[1]))?Ct.concat([new Ut(Wt+"[1]",_t[1],"expressions are not allowed in function stops.")]):Ct.concat(Rn({key:Wt+"[1]",value:_t[1],valueSpec:_,style:at.style,styleSpec:at.styleSpec}))}function K(at,Ct){var _t=Gn(at.value),Wt=ye(at.value),Gt=null!==at.value?at.value:Ct;if(r){if(_t!==r)return[new Ut(at.key,Gt,_t+" stop domain type must match previous stop domain type "+r)]}else r=_t;if("number"!==_t&&"string"!==_t&&"boolean"!==_t)return[new Ut(at.key,Gt,"stop domain value must be a number, string, or boolean")];if("number"!==_t&&"categorical"!==w){var pe="number expected, "+_t+" found";return kn(_)&&void 0===w&&(pe+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Ut(at.key,Gt,pe)]}return"categorical"!==w||"number"!==_t||isFinite(Wt)&&Math.floor(Wt)===Wt?"categorical"!==w&&"number"===_t&&void 0!==s&&Wt<s?[new Ut(at.key,Gt,"stop domain values must appear in ascending order")]:(s=Wt,"categorical"===w&&Wt in S?[new Ut(at.key,Gt,"stop domain values must be unique")]:(S[Wt]=!0,[])):[new Ut(at.key,Gt,"integer expected, found "+Wt)]}}function pu(t){var r=("property"===t.expressionContext?vo:za)(Le(t.value),t.valueSpec);if("error"===r.result)return r.value.map(function(d){return new Ut(""+t.key+d.key,t.value,d.message)});var s=r.value.expression||r.value._styleExpression.expression;if("property"===t.expressionContext&&"text-font"===t.propertyKey&&!s.outputDefined())return[new Ut(t.key,t.value,'Invalid data expression for "'+t.propertyKey+'". Output values must be contained as literals within the expression.')];if("property"===t.expressionContext&&"layout"===t.propertyType&&!Bs(s))return[new Ut(t.key,t.value,'"feature-state" data expressions are not supported with layout properties.')];if("filter"===t.expressionContext&&!Bs(s))return[new Ut(t.key,t.value,'"feature-state" data expressions are not supported with filters.')];if(t.expressionContext&&0===t.expressionContext.indexOf("cluster")){if(!js(s,["zoom","feature-state"]))return[new Ut(t.key,t.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if("cluster-initial"===t.expressionContext&&!Wi(s))return[new Ut(t.key,t.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function _o(t){var r=t.key,s=t.value,d=t.valueSpec,_=[];return Array.isArray(d.values)?-1===d.values.indexOf(ye(s))&&_.push(new Ut(r,s,"expected one of ["+d.values.join(", ")+"], "+JSON.stringify(s)+" found")):-1===Object.keys(d.values).indexOf(ye(s))&&_.push(new Ut(r,s,"expected one of ["+Object.keys(d.values).join(", ")+"], "+JSON.stringify(s)+" found")),_}function fu(t){if(!0===t||!1===t)return!0;if(!Array.isArray(t)||0===t.length)return!1;switch(t[0]){case"has":return t.length>=2&&"$id"!==t[1]&&"$type"!==t[1];case"in":return t.length>=3&&("string"!=typeof t[1]||Array.isArray(t[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return 3!==t.length||Array.isArray(t[1])||Array.isArray(t[2]);case"any":case"all":for(var r=0,s=t.slice(1);r<s.length;r+=1){var d=s[r];if(!fu(d)&&"boolean"!=typeof d)return!1}return!0;default:return!0}}Fu.deserialize=function(t){return new Fu(t._parameters,t._specification)},Fu.serialize=function(t){return{_parameters:t._parameters,_specification:t._specification}};var du={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function Ks(t){if(null==t)return{filter:function(){return!0},needGeometry:!1};fu(t)||(t=Bu(t));var r=za(t,du);if("error"===r.result)throw new Error(r.value.map(function(s){return s.key+": "+s.message}).join(", "));return{filter:function(s,d,_){return r.value.evaluate(s,d,{},_)},needGeometry:function s(d){if(!Array.isArray(d))return!1;if("within"===d[0])return!0;for(var _=1;_<d.length;_++)if(s(d[_]))return!0;return!1}(t)}}function fc(t,r){return t<r?-1:t>r?1:0}function Bu(t){if(!t)return!0;var r,s=t[0];return t.length<=1?"any"!==s:"=="===s?$s(t[1],t[2],"=="):"!="===s?Qs($s(t[1],t[2],"==")):"<"===s||">"===s||"<="===s||">="===s?$s(t[1],t[2],s):"any"===s?(r=t.slice(1),["any"].concat(r.map(Bu))):"all"===s?["all"].concat(t.slice(1).map(Bu)):"none"===s?["all"].concat(t.slice(1).map(Bu).map(Qs)):"in"===s?xs(t[1],t.slice(2)):"!in"===s?Qs(xs(t[1],t.slice(2))):"has"===s?To(t[1]):"!has"===s?Qs(To(t[1])):"within"!==s||t}function $s(t,r,s){switch(t){case"$type":return["filter-type-"+s,r];case"$id":return["filter-id-"+s,r];default:return["filter-"+s,t,r]}}function xs(t,r){if(0===r.length)return!1;switch(t){case"$type":return["filter-type-in",["literal",r]];case"$id":return["filter-id-in",["literal",r]];default:return r.length>200&&!r.some(function(s){return typeof s!=typeof r[0]})?["filter-in-large",t,["literal",r.sort(fc)]]:["filter-in-small",t,["literal",r]]}}function To(t){switch(t){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",t]}}function Qs(t){return["!",t]}function xo(t){return fu(Le(t.value))?pu(or({},t,{expressionContext:"filter",valueSpec:{value:"boolean"}})):function r(s){var d=s.value,_=s.key;if("array"!==Gn(d))return[new Ut(_,d,"array expected, "+Gn(d)+" found")];var w,S=s.styleSpec,A=[];if(d.length<1)return[new Ut(_,d,"filter array must have at least 1 element")];switch(A=A.concat(_o({key:_+"[0]",value:d[0],valueSpec:S.filter_operator,style:s.style,styleSpec:s.styleSpec})),ye(d[0])){case"<":case"<=":case">":case">=":d.length>=2&&"$type"===ye(d[1])&&A.push(new Ut(_,d,'"$type" cannot be use with operator "'+d[0]+'"'));case"==":case"!=":3!==d.length&&A.push(new Ut(_,d,'filter array for operator "'+d[0]+'" must have 3 elements'));case"in":case"!in":d.length>=2&&"string"!==(w=Gn(d[1]))&&A.push(new Ut(_+"[1]",d[1],"string expected, "+w+" found"));for(var F=2;F<d.length;F++)w=Gn(d[F]),"$type"===ye(d[1])?A=A.concat(_o({key:_+"["+F+"]",value:d[F],valueSpec:S.geometry_type,style:s.style,styleSpec:s.styleSpec})):"string"!==w&&"number"!==w&&"boolean"!==w&&A.push(new Ut(_+"["+F+"]",d[F],"string, number, or boolean expected, "+w+" found"));break;case"any":case"all":case"none":for(var U=1;U<d.length;U++)A=A.concat(r({key:_+"["+U+"]",value:d[U],style:s.style,styleSpec:s.styleSpec}));break;case"has":case"!has":w=Gn(d[1]),2!==d.length?A.push(new Ut(_,d,'filter array for "'+d[0]+'" operator must have 2 elements')):"string"!==w&&A.push(new Ut(_+"[1]",d[1],"string expected, "+w+" found"));break;case"within":w=Gn(d[1]),2!==d.length?A.push(new Ut(_,d,'filter array for "'+d[0]+'" operator must have 2 elements')):"object"!==w&&A.push(new Ut(_+"[1]",d[1],"object expected, "+w+" found"))}return A}(t)}function ns(t,r){var s=t.key,d=t.style,_=t.styleSpec,w=t.value,S=t.objectKey,A=_[r+"_"+t.layerType];if(!A)return[];var F=S.match(/^(.*)-transition$/);if("paint"===r&&F&&A[F[1]]&&A[F[1]].transition)return Rn({key:s,value:w,valueSpec:_.transition,style:d,styleSpec:_});var U,G=t.valueSpec||A[S];if(!G)return[new Ut(s,w,'unknown property "'+S+'"')];if("string"===Gn(w)&&kn(G)&&!G.tokens&&(U=/^{([^}]+)}$/.exec(w)))return[new Ut(s,w,'"'+S+'" does not support interpolation syntax\nUse an identity property function instead: `{ "type": "identity", "property": '+JSON.stringify(U[1])+" }`.")];var V=[];return"symbol"===t.layerType&&("text-field"===S&&d&&!d.glyphs&&V.push(new Ut(s,w,'use of "text-field" requires a style "glyphs" property')),"text-font"===S&&Ho(Le(w))&&"identity"===ye(w.type)&&V.push(new Ut(s,w,'"text-font" does not support identity functions'))),V.concat(Rn({key:t.key,value:w,valueSpec:G,style:d,styleSpec:_,expressionContext:"property",propertyType:r,propertyKey:S}))}function is(t){return ns(t,"paint")}function Uu(t){return ns(t,"layout")}function tu(t){var r=[],s=t.value,d=t.key,_=t.style,w=t.styleSpec;s.type||s.ref||r.push(new Ut(d,s,'either "type" or "ref" is required'));var S,A=ye(s.type),F=ye(s.ref);if(s.id)for(var U=ye(s.id),G=0;G<t.arrayIndex;G++){var V=_.layers[G];ye(V.id)===U&&r.push(new Ut(d,s.id,'duplicate layer id "'+s.id+'", previously used at line '+V.id.__line__))}if("ref"in s)["type","source","source-layer","filter","layout"].forEach(function(Ct){Ct in s&&r.push(new Ut(d,s[Ct],'"'+Ct+'" is prohibited for ref layers'))}),_.layers.forEach(function(Ct){ye(Ct.id)===F&&(S=Ct)}),S?S.ref?r.push(new Ut(d,s.ref,"ref cannot reference another ref layer")):A=ye(S.type):r.push(new Ut(d,s.ref,'ref layer "'+F+'" not found'));else if("background"!==A)if(s.source){var K=_.sources&&_.sources[s.source],at=K&&ye(K.type);K?"vector"===at&&"raster"===A?r.push(new Ut(d,s.source,'layer "'+s.id+'" requires a raster source')):"raster"===at&&"raster"!==A?r.push(new Ut(d,s.source,'layer "'+s.id+'" requires a vector source')):"vector"!==at||s["source-layer"]?"raster-dem"===at&&"hillshade"!==A?r.push(new Ut(d,s.source,"raster-dem source can only be used with layer type 'hillshade'.")):"line"!==A||!s.paint||!s.paint["line-gradient"]||"geojson"===at&&K.lineMetrics||r.push(new Ut(d,s,'layer "'+s.id+'" specifies a line-gradient, which requires a GeoJSON source with `lineMetrics` enabled.')):r.push(new Ut(d,s,'layer "'+s.id+'" must specify a "source-layer"')):r.push(new Ut(d,s.source,'source "'+s.source+'" not found'))}else r.push(new Ut(d,s,'missing required property "source"'));return r=r.concat(Wa({key:d,value:s,valueSpec:w.layer,style:t.style,styleSpec:t.styleSpec,objectElementValidators:{"*":function(){return[]},type:function(){return Rn({key:d+".type",value:s.type,valueSpec:w.layer.type,style:t.style,styleSpec:t.styleSpec,object:s,objectKey:"type"})},filter:xo,layout:function(Ct){return Wa({layer:s,key:Ct.key,value:Ct.value,style:Ct.style,styleSpec:Ct.styleSpec,objectElementValidators:{"*":function(_t){return Uu(or({layerType:A},_t))}}})},paint:function(Ct){return Wa({layer:s,key:Ct.key,value:Ct.value,style:Ct.style,styleSpec:Ct.styleSpec,objectElementValidators:{"*":function(_t){return is(or({layerType:A},_t))}}})}}}))}function Fn(t){var r=t.value,s=t.key,d=Gn(r);return"string"!==d?[new Ut(s,r,"string expected, "+d+" found")]:[]}var os={promoteId:function(t){var r=t.key,s=t.value;if("string"===Gn(s))return Fn({key:r,value:s});var d=[];for(var _ in s)d.push.apply(d,Fn({key:r+"."+_,value:s[_]}));return d}};function Ui(t){var r=t.value,s=t.key,d=t.styleSpec,_=t.style;if(!r.type)return[new Ut(s,r,'"type" is required')];var w,S=ye(r.type);switch(S){case"vector":case"raster":case"raster-dem":return Wa({key:s,value:r,valueSpec:d["source_"+S.replace("-","_")],style:t.style,styleSpec:d,objectElementValidators:os});case"geojson":if(w=Wa({key:s,value:r,valueSpec:d.source_geojson,style:_,styleSpec:d,objectElementValidators:os}),r.cluster)for(var A in r.clusterProperties){var F=r.clusterProperties[A],U=F[0],G="string"==typeof U?[U,["accumulated"],["get",A]]:U;w.push.apply(w,pu({key:s+"."+A+".map",value:F[1],expressionContext:"cluster-map"})),w.push.apply(w,pu({key:s+"."+A+".reduce",value:G,expressionContext:"cluster-reduce"}))}return w;case"video":return Wa({key:s,value:r,valueSpec:d.source_video,style:_,styleSpec:d});case"image":return Wa({key:s,value:r,valueSpec:d.source_image,style:_,styleSpec:d});case"canvas":return[new Ut(s,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return _o({key:s+".type",value:r.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:_,styleSpec:d})}}function bo(t){var r=t.value,s=t.styleSpec,d=s.light,_=t.style,w=[],S=Gn(r);if(void 0===r)return w;if("object"!==S)return w.concat([new Ut("light",r,"object expected, "+S+" found")]);for(var A in r){var F=A.match(/^(.*)-transition$/);w=w.concat(F&&d[F[1]]&&d[F[1]].transition?Rn({key:A,value:r[A],valueSpec:s.transition,style:_,styleSpec:s}):d[A]?Rn({key:A,value:r[A],valueSpec:d[A],style:_,styleSpec:s}):[new Ut(A,r[A],'unknown property "'+A+'"')])}return w}var gn={"*":function(){return[]},array:Jo,boolean:function(t){var r=t.value,s=t.key,d=Gn(r);return"boolean"!==d?[new Ut(s,r,"boolean expected, "+d+" found")]:[]},number:As,color:function(t){var r=t.key,s=t.value,d=Gn(s);return"string"!==d?[new Ut(r,s,"color expected, "+d+" found")]:null===ko(s)?[new Ut(r,s,'color expected, "'+s+'" found')]:[]},constants:je,enum:_o,filter:xo,function:Ha,layer:tu,object:Wa,source:Ui,light:bo,string:Fn,formatted:function(t){return 0===Fn(t).length?[]:pu(t)},resolvedImage:function(t){return 0===Fn(t).length?[]:pu(t)}};function Rn(t){var r=t.value,s=t.valueSpec,d=t.styleSpec;return s.expression&&Ho(ye(r))?Ha(t):s.expression&&ma(Le(r))?pu(t):s.type&&gn[s.type]?gn[s.type](t):Wa(or({},t,{valueSpec:s.type?d[s.type]:s}))}function Ba(t){var r=t.value,s=t.key,d=Fn(t);return d.length||(-1===r.indexOf("{fontstack}")&&d.push(new Ut(s,r,'"glyphs" url must include a "{fontstack}" token')),-1===r.indexOf("{range}")&&d.push(new Ut(s,r,'"glyphs" url must include a "{range}" token'))),d}function Pa(t,r){void 0===r&&(r=xt);var s=[];return s=s.concat(Rn({key:"",value:t,valueSpec:r.$root,styleSpec:r,style:t,objectElementValidators:{glyphs:Ba,"*":function(){return[]}}})),t.constants&&(s=s.concat(je({key:"constants",value:t.constants,style:t,styleSpec:r}))),Ao(s)}function Ao(t){return[].concat(t).sort(function(r,s){return r.line-s.line})}function ro(t){return function(){for(var r=[],s=arguments.length;s--;)r[s]=arguments[s];return Ao(t.apply(this,r))}}Pa.source=ro(Ui),Pa.light=ro(bo),Pa.layer=ro(tu),Pa.filter=ro(xo),Pa.paintProperty=ro(is),Pa.layoutProperty=ro(Uu);var Ma=Pa,Ja=Ma.light,Cu=Ma.paintProperty,Ls=Ma.layoutProperty;function as(t,r){var s=!1;if(r&&r.length)for(var d=0,_=r;d<_.length;d+=1)t.fire(new ne(new Error(_[d].message))),s=!0;return s}var mi=Ta;function Ta(t,r,s){var d=this.cells=[];if(t instanceof ArrayBuffer){this.arrayBuffer=t;var _=new Int32Array(this.arrayBuffer);t=_[0],this.d=(r=_[1])+2*(s=_[2]);for(var w=0;w<this.d*this.d;w++){var S=_[3+w],A=_[3+w+1];d.push(S===A?null:_.subarray(S,A))}var F=_[3+d.length+1];this.keys=_.subarray(_[3+d.length],F),this.bboxes=_.subarray(F),this.insert=this._insertReadonly}else{this.d=r+2*s;for(var U=0;U<this.d*this.d;U++)d.push([]);this.keys=[],this.bboxes=[]}this.n=r,this.extent=t,this.padding=s,this.scale=r/t,this.uid=0;var G=s/r*t;this.min=-G,this.max=t+G}Ta.prototype.insert=function(t,r,s,d,_){this._forEachCell(r,s,d,_,this._insertCell,this.uid++),this.keys.push(t),this.bboxes.push(r),this.bboxes.push(s),this.bboxes.push(d),this.bboxes.push(_)},Ta.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},Ta.prototype._insertCell=function(t,r,s,d,_,w){this.cells[_].push(w)},Ta.prototype.query=function(t,r,s,d,_){var w=this.min,S=this.max;if(t<=w&&r<=w&&S<=s&&S<=d&&!_)return Array.prototype.slice.call(this.keys);var A=[];return this._forEachCell(t,r,s,d,this._queryCell,A,{},_),A},Ta.prototype._queryCell=function(t,r,s,d,_,w,S,A){var F=this.cells[_];if(null!==F)for(var U=this.keys,G=this.bboxes,V=0;V<F.length;V++){var K=F[V];if(void 0===S[K]){var at=4*K;(A?A(G[at+0],G[at+1],G[at+2],G[at+3]):t<=G[at+2]&&r<=G[at+3]&&s>=G[at+0]&&d>=G[at+1])?(S[K]=!0,w.push(U[K])):S[K]=!1}}},Ta.prototype._forEachCell=function(t,r,s,d,_,w,S,A){for(var F=this._convertToCellCoord(t),U=this._convertToCellCoord(r),G=this._convertToCellCoord(s),V=this._convertToCellCoord(d),K=F;K<=G;K++)for(var at=U;at<=V;at++){var Ct=this.d*at+K;if((!A||A(this._convertFromCellCoord(K),this._convertFromCellCoord(at),this._convertFromCellCoord(K+1),this._convertFromCellCoord(at+1)))&&_.call(this,t,r,s,d,Ct,w,S,A))return}},Ta.prototype._convertFromCellCoord=function(t){return(t-this.padding)/this.scale},Ta.prototype._convertToCellCoord=function(t){return Math.max(0,Math.min(this.d-1,Math.floor(t*this.scale)+this.padding))},Ta.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var t=this.cells,r=3+this.cells.length+1+1,s=0,d=0;d<this.cells.length;d++)s+=this.cells[d].length;var _=new Int32Array(r+s+this.keys.length+this.bboxes.length);_[0]=this.extent,_[1]=this.n,_[2]=this.padding;for(var w=r,S=0;S<t.length;S++){var A=t[S];_[3+S]=w,_.set(A,w),w+=A.length}return _[3+t.length]=w,_.set(this.keys,w),_[3+t.length+1]=w+=this.keys.length,_.set(this.bboxes,w),w+=this.bboxes.length,_.buffer};var wo=Jt.ImageData,Eo=Jt.ImageBitmap,Hi={};function nr(t,r,s){void 0===s&&(s={}),Object.defineProperty(r,"_classRegistryKey",{value:t,writeable:!1}),Hi[t]={klass:r,omit:s.omit||[],shallow:s.shallow||[]}}for(var ia in nr("Object",Object),mi.serialize=function(t,r){var s=t.toArrayBuffer();return r&&r.push(s),{buffer:s}},mi.deserialize=function(t){return new mi(t.buffer)},nr("Grid",mi),nr("Color",An),nr("Error",Error),nr("ResolvedImage",Un),nr("StylePropertyFunction",Fu),nr("StyleExpression",qo,{omit:["_evaluator"]}),nr("ZoomDependentExpression",Fa),nr("ZoomConstantExpression",_s),nr("CompoundExpression",Mo,{omit:["_evaluate"]}),vs)vs[ia]._classRegistryKey||nr("Expression_"+ia,vs[ia]);function Ka(t){return t&&"undefined"!=typeof ArrayBuffer&&(t instanceof ArrayBuffer||t.constructor&&"ArrayBuffer"===t.constructor.name)}function Aa(t){return Eo&&t instanceof Eo}function qi(t,r){if(null==t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||t instanceof Boolean||t instanceof Number||t instanceof String||t instanceof Date||t instanceof RegExp)return t;if(Ka(t)||Aa(t))return r&&r.push(t),t;if(ArrayBuffer.isView(t)){var s=t;return r&&r.push(s.buffer),s}if(t instanceof wo)return r&&r.push(t.data.buffer),t;if(Array.isArray(t)){for(var d=[],_=0,w=t;_<w.length;_+=1)d.push(qi(w[_],r));return d}if("object"==typeof t){var S=t.constructor,A=S._classRegistryKey;if(!A)throw new Error("can't serialize object of unregistered class");var F=S.serialize?S.serialize(t,r):{};if(!S.serialize){for(var U in t)if(t.hasOwnProperty(U)&&!(Hi[A].omit.indexOf(U)>=0)){var G=t[U];F[U]=Hi[A].shallow.indexOf(U)>=0?G:qi(G,r)}t instanceof Error&&(F.message=t.message)}if(F.$name)throw new Error("$name property is reserved for worker serialization logic.");return"Object"!==A&&(F.$name=A),F}throw new Error("can't serialize object of type "+typeof t)}function bs(t){if(null==t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||t instanceof Boolean||t instanceof Number||t instanceof String||t instanceof Date||t instanceof RegExp||Ka(t)||Aa(t)||ArrayBuffer.isView(t)||t instanceof wo)return t;if(Array.isArray(t))return t.map(bs);if("object"==typeof t){var r=t.$name||"Object",s=Hi[r].klass;if(!s)throw new Error("can't deserialize unregistered class "+r);if(s.deserialize)return s.deserialize(t);for(var d=Object.create(s.prototype),_=0,w=Object.keys(t);_<w.length;_+=1){var S=w[_];if("$name"!==S){var A=t[S];d[S]=Hi[r].shallow.indexOf(S)>=0?A:bs(A)}}return d}throw new Error("can't deserialize object of type "+typeof t)}var Si=function(){this.first=!0};Si.prototype.update=function(t,r){var s=Math.floor(t);return this.first?(this.first=!1,this.lastIntegerZoom=s,this.lastIntegerZoomTime=0,this.lastZoom=t,this.lastFloorZoom=s,!0):(this.lastFloorZoom>s?(this.lastIntegerZoom=s+1,this.lastIntegerZoomTime=r):this.lastFloorZoom<s&&(this.lastIntegerZoom=s,this.lastIntegerZoomTime=r),t!==this.lastZoom&&(this.lastZoom=t,this.lastFloorZoom=s,!0))};var gr={"Latin-1 Supplement":function(t){return t>=128&&t<=255},Arabic:function(t){return t>=1536&&t<=1791},"Arabic Supplement":function(t){return t>=1872&&t<=1919},"Arabic Extended-A":function(t){return t>=2208&&t<=2303},"Hangul Jamo":function(t){return t>=4352&&t<=4607},"Unified Canadian Aboriginal Syllabics":function(t){return t>=5120&&t<=5759},Khmer:function(t){return t>=6016&&t<=6143},"Unified Canadian Aboriginal Syllabics Extended":function(t){return t>=6320&&t<=6399},"General Punctuation":function(t){return t>=8192&&t<=8303},"Letterlike Symbols":function(t){return t>=8448&&t<=8527},"Number Forms":function(t){return t>=8528&&t<=8591},"Miscellaneous Technical":function(t){return t>=8960&&t<=9215},"Control Pictures":function(t){return t>=9216&&t<=9279},"Optical Character Recognition":function(t){return t>=9280&&t<=9311},"Enclosed Alphanumerics":function(t){return t>=9312&&t<=9471},"Geometric Shapes":function(t){return t>=9632&&t<=9727},"Miscellaneous Symbols":function(t){return t>=9728&&t<=9983},"Miscellaneous Symbols and Arrows":function(t){return t>=11008&&t<=11263},"CJK Radicals Supplement":function(t){return t>=11904&&t<=12031},"Kangxi Radicals":function(t){return t>=12032&&t<=12255},"Ideographic Description Characters":function(t){return t>=12272&&t<=12287},"CJK Symbols and Punctuation":function(t){return t>=12288&&t<=12351},Hiragana:function(t){return t>=12352&&t<=12447},Katakana:function(t){return t>=12448&&t<=12543},Bopomofo:function(t){return t>=12544&&t<=12591},"Hangul Compatibility Jamo":function(t){return t>=12592&&t<=12687},Kanbun:function(t){return t>=12688&&t<=12703},"Bopomofo Extended":function(t){return t>=12704&&t<=12735},"CJK Strokes":function(t){return t>=12736&&t<=12783},"Katakana Phonetic Extensions":function(t){return t>=12784&&t<=12799},"Enclosed CJK Letters and Months":function(t){return t>=12800&&t<=13055},"CJK Compatibility":function(t){return t>=13056&&t<=13311},"CJK Unified Ideographs Extension A":function(t){return t>=13312&&t<=19903},"Yijing Hexagram Symbols":function(t){return t>=19904&&t<=19967},"CJK Unified Ideographs":function(t){return t>=19968&&t<=40959},"Yi Syllables":function(t){return t>=40960&&t<=42127},"Yi Radicals":function(t){return t>=42128&&t<=42191},"Hangul Jamo Extended-A":function(t){return t>=43360&&t<=43391},"Hangul Syllables":function(t){return t>=44032&&t<=55215},"Hangul Jamo Extended-B":function(t){return t>=55216&&t<=55295},"Private Use Area":function(t){return t>=57344&&t<=63743},"CJK Compatibility Ideographs":function(t){return t>=63744&&t<=64255},"Arabic Presentation Forms-A":function(t){return t>=64336&&t<=65023},"Vertical Forms":function(t){return t>=65040&&t<=65055},"CJK Compatibility Forms":function(t){return t>=65072&&t<=65103},"Small Form Variants":function(t){return t>=65104&&t<=65135},"Arabic Presentation Forms-B":function(t){return t>=65136&&t<=65279},"Halfwidth and Fullwidth Forms":function(t){return t>=65280&&t<=65519}};function ki(t){for(var r=0,s=t;r<s.length;r+=1)if(Ju(s[r].charCodeAt(0)))return!0;return!1}function Ju(t){return!(746!==t&&747!==t&&(t<4352||!(gr["Bopomofo Extended"](t)||gr.Bopomofo(t)||gr["CJK Compatibility Forms"](t)&&!(t>=65097&&t<=65103)||gr["CJK Compatibility Ideographs"](t)||gr["CJK Compatibility"](t)||gr["CJK Radicals Supplement"](t)||gr["CJK Strokes"](t)||!(!gr["CJK Symbols and Punctuation"](t)||t>=12296&&t<=12305||t>=12308&&t<=12319||12336===t)||gr["CJK Unified Ideographs Extension A"](t)||gr["CJK Unified Ideographs"](t)||gr["Enclosed CJK Letters and Months"](t)||gr["Hangul Compatibility Jamo"](t)||gr["Hangul Jamo Extended-A"](t)||gr["Hangul Jamo Extended-B"](t)||gr["Hangul Jamo"](t)||gr["Hangul Syllables"](t)||gr.Hiragana(t)||gr["Ideographic Description Characters"](t)||gr.Kanbun(t)||gr["Kangxi Radicals"](t)||gr["Katakana Phonetic Extensions"](t)||gr.Katakana(t)&&12540!==t||!(!gr["Halfwidth and Fullwidth Forms"](t)||65288===t||65289===t||65293===t||t>=65306&&t<=65310||65339===t||65341===t||65343===t||t>=65371&&t<=65503||65507===t||t>=65512&&t<=65519)||!(!gr["Small Form Variants"](t)||t>=65112&&t<=65118||t>=65123&&t<=65126)||gr["Unified Canadian Aboriginal Syllabics"](t)||gr["Unified Canadian Aboriginal Syllabics Extended"](t)||gr["Vertical Forms"](t)||gr["Yijing Hexagram Symbols"](t)||gr["Yi Syllables"](t)||gr["Yi Radicals"](t))))}function $a(t){return!(Ju(t)||(r=t,gr["Latin-1 Supplement"](r)&&(167===r||169===r||174===r||177===r||188===r||189===r||190===r||215===r||247===r)||gr["General Punctuation"](r)&&(8214===r||8224===r||8225===r||8240===r||8241===r||8251===r||8252===r||8258===r||8263===r||8264===r||8265===r||8273===r)||gr["Letterlike Symbols"](r)||gr["Number Forms"](r)||gr["Miscellaneous Technical"](r)&&(r>=8960&&r<=8967||r>=8972&&r<=8991||r>=8996&&r<=9e3||9003===r||r>=9085&&r<=9114||r>=9150&&r<=9165||9167===r||r>=9169&&r<=9179||r>=9186&&r<=9215)||gr["Control Pictures"](r)&&9251!==r||gr["Optical Character Recognition"](r)||gr["Enclosed Alphanumerics"](r)||gr["Geometric Shapes"](r)||gr["Miscellaneous Symbols"](r)&&!(r>=9754&&r<=9759)||gr["Miscellaneous Symbols and Arrows"](r)&&(r>=11026&&r<=11055||r>=11088&&r<=11097||r>=11192&&r<=11243)||gr["CJK Symbols and Punctuation"](r)||gr.Katakana(r)||gr["Private Use Area"](r)||gr["CJK Compatibility Forms"](r)||gr["Small Form Variants"](r)||gr["Halfwidth and Fullwidth Forms"](r)||8734===r||8756===r||8757===r||r>=9984&&r<=10087||r>=10102&&r<=10131||65532===r||65533===r));var r}function yi(t){return t>=1424&&t<=2303||gr["Arabic Presentation Forms-A"](t)||gr["Arabic Presentation Forms-B"](t)}function ws(t,r){return!(!r&&yi(t)||t>=2304&&t<=3583||t>=3840&&t<=4255||gr.Khmer(t))}function xl(t){for(var r=0,s=t;r<s.length;r+=1)if(yi(s[r].charCodeAt(0)))return!0;return!1}var eu=null,no="unavailable",zi=null,Lo=function(t){t&&"string"==typeof t&&t.indexOf("NetworkError")>-1&&(no="error"),eu&&eu(t)};function gu(){Ko.fire(new Xt("pluginStateChange",{pluginStatus:no,pluginURL:zi}))}var Ko=new Yt,oa=function(){return no},qu=function(){if("deferred"!==no||!zi)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");no="loading",gu(),zi&&gi({url:zi},function(t){t?Lo(t):(no="loaded",gu())})},Sn={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:function(){return"loaded"===no||null!=Sn.applyArabicShaping},isLoading:function(){return"loading"===no},setState:function(t){no=t.pluginStatus,zi=t.pluginURL},isParsed:function(){return null!=Sn.applyArabicShaping&&null!=Sn.processBidirectionalText&&null!=Sn.processStyledBidirectionalText},getPluginURL:function(){return zi}},ti=function(t,r){this.zoom=t,r?(this.now=r.now,this.fadeDuration=r.fadeDuration,this.zoomHistory=r.zoomHistory,this.transition=r.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new Si,this.transition={})};ti.prototype.isSupportedScript=function(t){return function(r,s){for(var d=0,_=r;d<_.length;d+=1)if(!ws(_[d].charCodeAt(0),s))return!1;return!0}(t,Sn.isLoaded())},ti.prototype.crossFadingFactor=function(){return 0===this.fadeDuration?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)},ti.prototype.getCrossfadeParameters=function(){var t=this.zoom,r=t-Math.floor(t),s=this.crossFadingFactor();return t>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:r+(1-r)*s}:{fromScale:.5,toScale:1,t:1-(1-s)*r}};var Ji=function(t,r){this.property=t,this.value=r,this.expression=function(s,d){if(Ho(s))return new Fu(s,d);if(ma(s)){var _=vo(s,d);if("error"===_.result)throw new Error(_.value.map(function(S){return S.key+": "+S.message}).join(", "));return _.value}var w=s;return"string"==typeof s&&"color"===d.type&&(w=An.parse(s)),{kind:"constant",evaluate:function(){return w}}}(void 0===r?t.specification.default:r,t.specification)};Ji.prototype.isDataDriven=function(){return"source"===this.expression.kind||"composite"===this.expression.kind},Ji.prototype.possiblyEvaluate=function(t,r,s){return this.property.possiblyEvaluate(this,t,r,s)};var La=function(t){this.property=t,this.value=new Ji(t,void 0)};La.prototype.transitioned=function(t,r){return new ss(this.property,this.value,r,kt({},t.transition,this.transition),t.now)},La.prototype.untransitioned=function(){return new ss(this.property,this.value,null,{},0)};var So=function(t){this._properties=t,this._values=Object.create(t.defaultTransitionablePropertyValues)};So.prototype.getValue=function(t){return j(this._values[t].value.value)},So.prototype.setValue=function(t,r){this._values.hasOwnProperty(t)||(this._values[t]=new La(this._values[t].property)),this._values[t].value=new Ji(this._values[t].property,null===r?void 0:j(r))},So.prototype.getTransition=function(t){return j(this._values[t].transition)},So.prototype.setTransition=function(t,r){this._values.hasOwnProperty(t)||(this._values[t]=new La(this._values[t].property)),this._values[t].transition=j(r)||void 0},So.prototype.serialize=function(){for(var t={},r=0,s=Object.keys(this._values);r<s.length;r+=1){var d=s[r],_=this.getValue(d);void 0!==_&&(t[d]=_);var w=this.getTransition(d);void 0!==w&&(t[d+"-transition"]=w)}return t},So.prototype.transitioned=function(t,r){for(var s=new Os(this._properties),d=0,_=Object.keys(this._values);d<_.length;d+=1){var w=_[d];s._values[w]=this._values[w].transitioned(t,r._values[w])}return s},So.prototype.untransitioned=function(){for(var t=new Os(this._properties),r=0,s=Object.keys(this._values);r<s.length;r+=1){var d=s[r];t._values[d]=this._values[d].untransitioned()}return t};var ss=function(t,r,s,d,_){this.property=t,this.value=r,this.begin=_+d.delay||0,this.end=this.begin+d.duration||0,t.specification.transition&&(d.delay||d.duration)&&(this.prior=s)};ss.prototype.possiblyEvaluate=function(t,r,s){var d=t.now||0,_=this.value.possiblyEvaluate(t,r,s),w=this.prior;if(w){if(d>this.end)return this.prior=null,_;if(this.value.isDataDriven())return this.prior=null,_;if(d<this.begin)return w.possiblyEvaluate(t,r,s);var S=(d-this.begin)/(this.end-this.begin);return this.property.interpolate(w.possiblyEvaluate(t,r,s),_,function(A){if(A<=0)return 0;if(A>=1)return 1;var F=A*A,U=F*A;return 4*(A<.5?U:3*(A-F)+U-.75)}(S))}return _};var Os=function(t){this._properties=t,this._values=Object.create(t.defaultTransitioningPropertyValues)};Os.prototype.possiblyEvaluate=function(t,r,s){for(var d=new Qa(this._properties),_=0,w=Object.keys(this._values);_<w.length;_+=1){var S=w[_];d._values[S]=this._values[S].possiblyEvaluate(t,r,s)}return d},Os.prototype.hasTransition=function(){for(var t=0,r=Object.keys(this._values);t<r.length;t+=1)if(this._values[r[t]].prior)return!0;return!1};var aa=function(t){this._properties=t,this._values=Object.create(t.defaultPropertyValues)};aa.prototype.getValue=function(t){return j(this._values[t].value)},aa.prototype.setValue=function(t,r){this._values[t]=new Ji(this._values[t].property,null===r?void 0:j(r))},aa.prototype.serialize=function(){for(var t={},r=0,s=Object.keys(this._values);r<s.length;r+=1){var d=s[r],_=this.getValue(d);void 0!==_&&(t[d]=_)}return t},aa.prototype.possiblyEvaluate=function(t,r,s){for(var d=new Qa(this._properties),_=0,w=Object.keys(this._values);_<w.length;_+=1){var S=w[_];d._values[S]=this._values[S].possiblyEvaluate(t,r,s)}return d};var sa=function(t,r,s){this.property=t,this.value=r,this.parameters=s};sa.prototype.isConstant=function(){return"constant"===this.value.kind},sa.prototype.constantOr=function(t){return"constant"===this.value.kind?this.value.value:t},sa.prototype.evaluate=function(t,r,s,d){return this.property.evaluate(this.value,this.parameters,t,r,s,d)};var Qa=function(t){this._properties=t,this._values=Object.create(t.defaultPossiblyEvaluatedValues)};Qa.prototype.get=function(t){return this._values[t]};var vr=function(t){this.specification=t};vr.prototype.possiblyEvaluate=function(t,r){return t.expression.evaluate(r)},vr.prototype.interpolate=function(t,r,s){var d=ms[this.specification.type];return d?d(t,r,s):t};var Gr=function(t,r){this.specification=t,this.overrides=r};Gr.prototype.possiblyEvaluate=function(t,r,s,d){return new sa(this,"constant"===t.expression.kind||"camera"===t.expression.kind?{kind:"constant",value:t.expression.evaluate(r,null,{},s,d)}:t.expression,r)},Gr.prototype.interpolate=function(t,r,s){if("constant"!==t.value.kind||"constant"!==r.value.kind)return t;if(void 0===t.value.value||void 0===r.value.value)return new sa(this,{kind:"constant",value:void 0},t.parameters);var d=ms[this.specification.type];return d?new sa(this,{kind:"constant",value:d(t.value.value,r.value.value,s)},t.parameters):t},Gr.prototype.evaluate=function(t,r,s,d,_,w){return"constant"===t.kind?t.value:t.evaluate(r,s,d,_,w)};var ho=function(t){function r(){t.apply(this,arguments)}return t&&(r.__proto__=t),(r.prototype=Object.create(t&&t.prototype)).constructor=r,r.prototype.possiblyEvaluate=function(s,d,_,w){if(void 0===s.value)return new sa(this,{kind:"constant",value:void 0},d);if("constant"===s.expression.kind){var S=s.expression.evaluate(d,null,{},_,w),A="resolvedImage"===s.property.specification.type&&"string"!=typeof S?S.name:S,F=this._calculate(A,A,A,d);return new sa(this,{kind:"constant",value:F},d)}if("camera"===s.expression.kind){var U=this._calculate(s.expression.evaluate({zoom:d.zoom-1}),s.expression.evaluate({zoom:d.zoom}),s.expression.evaluate({zoom:d.zoom+1}),d);return new sa(this,{kind:"constant",value:U},d)}return new sa(this,s.expression,d)},r.prototype.evaluate=function(s,d,_,w,S,A){if("source"===s.kind){var F=s.evaluate(d,_,w,S,A);return this._calculate(F,F,F,d)}return"composite"===s.kind?this._calculate(s.evaluate({zoom:Math.floor(d.zoom)-1},_,w),s.evaluate({zoom:Math.floor(d.zoom)},_,w),s.evaluate({zoom:Math.floor(d.zoom)+1},_,w),d):s.value},r.prototype._calculate=function(s,d,_,w){return w.zoom>w.zoomHistory.lastIntegerZoom?{from:s,to:d}:{from:_,to:d}},r.prototype.interpolate=function(s){return s},r}(Gr),$o=function(t){this.specification=t};$o.prototype.possiblyEvaluate=function(t,r,s,d){if(void 0!==t.value){if("constant"===t.expression.kind){var _=t.expression.evaluate(r,null,{},s,d);return this._calculate(_,_,_,r)}return this._calculate(t.expression.evaluate(new ti(Math.floor(r.zoom-1),r)),t.expression.evaluate(new ti(Math.floor(r.zoom),r)),t.expression.evaluate(new ti(Math.floor(r.zoom+1),r)),r)}},$o.prototype._calculate=function(t,r,s,d){return d.zoom>d.zoomHistory.lastIntegerZoom?{from:t,to:r}:{from:s,to:r}},$o.prototype.interpolate=function(t){return t};var ya=function(t){this.specification=t};ya.prototype.possiblyEvaluate=function(t,r,s,d){return!!t.expression.evaluate(r,null,{},s,d)},ya.prototype.interpolate=function(){return!1};var Oo=function(t){for(var r in this.properties=t,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[],t){var s=t[r];s.specification.overridable&&this.overridableProperties.push(r);var d=this.defaultPropertyValues[r]=new Ji(s,void 0),_=this.defaultTransitionablePropertyValues[r]=new La(s);this.defaultTransitioningPropertyValues[r]=_.untransitioned(),this.defaultPossiblyEvaluatedValues[r]=d.possiblyEvaluate({})}};nr("DataDrivenProperty",Gr),nr("DataConstantProperty",vr),nr("CrossFadedDataDrivenProperty",ho),nr("CrossFadedProperty",$o),nr("ColorRampProperty",ya);var Wr=function(t){function r(s,d){if(t.call(this),this.id=s.id,this.type=s.type,this._featureFilter={filter:function(){return!0},needGeometry:!1},"custom"!==s.type&&(this.metadata=(s=s).metadata,this.minzoom=s.minzoom,this.maxzoom=s.maxzoom,"background"!==s.type&&(this.source=s.source,this.sourceLayer=s["source-layer"],this.filter=s.filter),d.layout&&(this._unevaluatedLayout=new aa(d.layout)),d.paint)){for(var _ in this._transitionablePaint=new So(d.paint),s.paint)this.setPaintProperty(_,s.paint[_],{validate:!1});for(var w in s.layout)this.setLayoutProperty(w,s.layout[w],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Qa(d.paint)}}return t&&(r.__proto__=t),(r.prototype=Object.create(t&&t.prototype)).constructor=r,r.prototype.getCrossfadeParameters=function(){return this._crossfadeParameters},r.prototype.getLayoutProperty=function(s){return"visibility"===s?this.visibility:this._unevaluatedLayout.getValue(s)},r.prototype.setLayoutProperty=function(s,d,_){void 0===_&&(_={}),null!=d&&this._validate(Ls,"layers."+this.id+".layout."+s,s,d,_)||("visibility"!==s?this._unevaluatedLayout.setValue(s,d):this.visibility=d)},r.prototype.getPaintProperty=function(s){return Q(s,"-transition")?this._transitionablePaint.getTransition(s.slice(0,-"-transition".length)):this._transitionablePaint.getValue(s)},r.prototype.setPaintProperty=function(s,d,_){if(void 0===_&&(_={}),null!=d&&this._validate(Cu,"layers."+this.id+".paint."+s,s,d,_))return!1;if(Q(s,"-transition"))return this._transitionablePaint.setTransition(s.slice(0,-"-transition".length),d||void 0),!1;var w=this._transitionablePaint._values[s],S="cross-faded-data-driven"===w.property.specification["property-type"],A=w.value.isDataDriven(),F=w.value;this._transitionablePaint.setValue(s,d),this._handleSpecialPaintPropertyUpdate(s);var U=this._transitionablePaint._values[s].value;return U.isDataDriven()||A||S||this._handleOverridablePaintPropertyUpdate(s,F,U)},r.prototype._handleSpecialPaintPropertyUpdate=function(s){},r.prototype._handleOverridablePaintPropertyUpdate=function(s,d,_){return!1},r.prototype.isHidden=function(s){return!!(this.minzoom&&s<this.minzoom)||!!(this.maxzoom&&s>=this.maxzoom)||"none"===this.visibility},r.prototype.updateTransitions=function(s){this._transitioningPaint=this._transitionablePaint.transitioned(s,this._transitioningPaint)},r.prototype.hasTransition=function(){return this._transitioningPaint.hasTransition()},r.prototype.recalculate=function(s,d){s.getCrossfadeParameters&&(this._crossfadeParameters=s.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(s,void 0,d)),this.paint=this._transitioningPaint.possiblyEvaluate(s,void 0,d)},r.prototype.serialize=function(){var s={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(s.layout=s.layout||{},s.layout.visibility=this.visibility),st(s,function(d,_){return!(void 0===d||"layout"===_&&!Object.keys(d).length||"paint"===_&&!Object.keys(d).length)})},r.prototype._validate=function(s,d,_,w,S){return void 0===S&&(S={}),(!S||!1!==S.validate)&&as(this,s.call(Ma,{key:d,layerType:this.type,objectKey:_,value:w,styleSpec:xt,style:{glyphs:!0,sprite:!0}}))},r.prototype.is3D=function(){return!1},r.prototype.isTileClipped=function(){return!1},r.prototype.hasOffscreenPass=function(){return!1},r.prototype.resize=function(){},r.prototype.isStateDependent=function(){for(var s in this.paint._values){var d=this.paint.get(s);if(d instanceof sa&&kn(d.property.specification)&&("source"===d.value.kind||"composite"===d.value.kind)&&d.value.isStateDependent)return!0}return!1},r}(Yt),ru={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array},Oa=function(t,r){this._structArray=t,this._pos1=r*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8},Vn=function(){this.isTransferred=!1,this.capacity=-1,this.resize(0)};function oi(t,r){void 0===r&&(r=1);var s=0,d=0;return{members:t.map(function(_){var w=ru[_.type].BYTES_PER_ELEMENT,S=s=Iu(s,Math.max(r,w)),A=_.components||1;return d=Math.max(d,w),s+=w*A,{name:_.name,type:_.type,components:A,offset:S}}),size:Iu(s,Math.max(d,r)),alignment:r}}function Iu(t,r){return Math.ceil(t/r)*r}Vn.serialize=function(t,r){return t._trim(),r&&(t.isTransferred=!0,r.push(t.arrayBuffer)),{length:t.length,arrayBuffer:t.arrayBuffer}},Vn.deserialize=function(t){var r=Object.create(this.prototype);return r.arrayBuffer=t.arrayBuffer,r.length=t.length,r.capacity=t.arrayBuffer.byteLength/r.bytesPerElement,r._refreshViews(),r},Vn.prototype._trim=function(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())},Vn.prototype.clear=function(){this.length=0},Vn.prototype.resize=function(t){this.reserve(t),this.length=t},Vn.prototype.reserve=function(t){if(t>this.capacity){this.capacity=Math.max(t,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);var r=this.uint8;this._refreshViews(),r&&this.uint8.set(r)}},Vn.prototype._refreshViews=function(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")};var Qo=function(t){function r(){t.apply(this,arguments)}return t&&(r.__proto__=t),(r.prototype=Object.create(t&&t.prototype)).constructor=r,r.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},r.prototype.emplaceBack=function(s,d){var _=this.length;return this.resize(_+1),this.emplace(_,s,d)},r.prototype.emplace=function(s,d,_){var w=2*s;return this.int16[w+0]=d,this.int16[w+1]=_,s},r}(Vn);Qo.prototype.bytesPerElement=4,nr("StructArrayLayout2i4",Qo);var vi=function(t){function r(){t.apply(this,arguments)}return t&&(r.__proto__=t),(r.prototype=Object.create(t&&t.prototype)).constructor=r,r.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},r.prototype.emplaceBack=function(s,d,_,w){var S=this.length;return this.resize(S+1),this.emplace(S,s,d,_,w)},r.prototype.emplace=function(s,d,_,w,S){var A=4*s;return this.int16[A+0]=d,this.int16[A+1]=_,this.int16[A+2]=w,this.int16[A+3]=S,s},r}(Vn);vi.prototype.bytesPerElement=8,nr("StructArrayLayout4i8",vi);var va=function(t){function r(){t.apply(this,arguments)}return t&&(r.__proto__=t),(r.prototype=Object.create(t&&t.prototype)).constructor=r,r.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},r.prototype.emplaceBack=function(s,d,_,w,S,A){var F=this.length;return this.resize(F+1),this.emplace(F,s,d,_,w,S,A)},r.prototype.emplace=function(s,d,_,w,S,A,F){var U=6*s;return this.int16[U+0]=d,this.int16[U+1]=_,this.int16[U+2]=w,this.int16[U+3]=S,this.int16[U+4]=A,this.int16[U+5]=F,s},r}(Vn);va.prototype.bytesPerElement=12,nr("StructArrayLayout2i4i12",va);var mu=function(t){function r(){t.apply(this,arguments)}return t&&(r.__proto__=t),(r.prototype=Object.create(t&&t.prototype)).constructor=r,r.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},r.prototype.emplaceBack=function(s,d,_,w,S,A){var F=this.length;return this.resize(F+1),this.emplace(F,s,d,_,w,S,A)},r.prototype.emplace=function(s,d,_,w,S,A,F){var U=4*s,G=8*s;return this.int16[U+0]=d,this.int16[U+1]=_,this.uint8[G+4]=w,this.uint8[G+5]=S,this.uint8[G+6]=A,this.uint8[G+7]=F,s},r}(Vn);mu.prototype.bytesPerElement=8,nr("StructArrayLayout2i4ub8",mu);var e=function(t){function r(){t.apply(this,arguments)}return t&&(r.__proto__=t),(r.prototype=Object.create(t&&t.prototype)).constructor=r,r.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},r.prototype.emplaceBack=function(s,d){var _=this.length;return this.resize(_+1),this.emplace(_,s,d)},r.prototype.emplace=function(s,d,_){var w=2*s;return this.float32[w+0]=d,this.float32[w+1]=_,s},r}(Vn);e.prototype.bytesPerElement=8,nr("StructArrayLayout2f8",e);var n=function(t){function r(){t.apply(this,arguments)}return t&&(r.__proto__=t),(r.prototype=Object.create(t&&t.prototype)).constructor=r,r.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},r.prototype.emplaceBack=function(s,d,_,w,S,A,F,U,G,V){var K=this.length;return this.resize(K+1),this.emplace(K,s,d,_,w,S,A,F,U,G,V)},r.prototype.emplace=function(s,d,_,w,S,A,F,U,G,V,K){var at=10*s;return this.uint16[at+0]=d,this.uint16[at+1]=_,this.uint16[at+2]=w,this.uint16[at+3]=S,this.uint16[at+4]=A,this.uint16[at+5]=F,this.uint16[at+6]=U,this.uint16[at+7]=G,this.uint16[at+8]=V,this.uint16[at+9]=K,s},r}(Vn);n.prototype.bytesPerElement=20,nr("StructArrayLayout10ui20",n);var c=function(t){function r(){t.apply(this,arguments)}return t&&(r.__proto__=t),(r.prototype=Object.create(t&&t.prototype)).constructor=r,r.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},r.prototype.emplaceBack=function(s,d,_,w,S,A,F,U,G,V,K,at){var Ct=this.length;return this.resize(Ct+1),this.emplace(Ct,s,d,_,w,S,A,F,U,G,V,K,at)},r.prototype.emplace=function(s,d,_,w,S,A,F,U,G,V,K,at,Ct){var _t=12*s;return this.int16[_t+0]=d,this.int16[_t+1]=_,this.int16[_t+2]=w,this.int16[_t+3]=S,this.uint16[_t+4]=A,this.uint16[_t+5]=F,this.uint16[_t+6]=U,this.uint16[_t+7]=G,this.int16[_t+8]=V,this.int16[_t+9]=K,this.int16[_t+10]=at,this.int16[_t+11]=Ct,s},r}(Vn);c.prototype.bytesPerElement=24,nr("StructArrayLayout4i4ui4i24",c);var f=function(t){function r(){t.apply(this,arguments)}return t&&(r.__proto__=t),(r.prototype=Object.create(t&&t.prototype)).constructor=r,r.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},r.prototype.emplaceBack=function(s,d,_){var w=this.length;return this.resize(w+1),this.emplace(w,s,d,_)},r.prototype.emplace=function(s,d,_,w){var S=3*s;return this.float32[S+0]=d,this.float32[S+1]=_,this.float32[S+2]=w,s},r}(Vn);f.prototype.bytesPerElement=12,nr("StructArrayLayout3f12",f);var x=function(t){function r(){t.apply(this,arguments)}return t&&(r.__proto__=t),(r.prototype=Object.create(t&&t.prototype)).constructor=r,r.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)},r.prototype.emplaceBack=function(s){var d=this.length;return this.resize(d+1),this.emplace(d,s)},r.prototype.emplace=function(s,d){return this.uint32[1*s+0]=d,s},r}(Vn);x.prototype.bytesPerElement=4,nr("StructArrayLayout1ul4",x);var L=function(t){function r(){t.apply(this,arguments)}return t&&(r.__proto__=t),(r.prototype=Object.create(t&&t.prototype)).constructor=r,r.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},r.prototype.emplaceBack=function(s,d,_,w,S,A,F,U,G){var V=this.length;return this.resize(V+1),this.emplace(V,s,d,_,w,S,A,F,U,G)},r.prototype.emplace=function(s,d,_,w,S,A,F,U,G,V){var K=10*s,at=5*s;return this.int16[K+0]=d,this.int16[K+1]=_,this.int16[K+2]=w,this.int16[K+3]=S,this.int16[K+4]=A,this.int16[K+5]=F,this.uint32[at+3]=U,this.uint16[K+8]=G,this.uint16[K+9]=V,s},r}(Vn);L.prototype.bytesPerElement=20,nr("StructArrayLayout6i1ul2ui20",L);var z=function(t){function r(){t.apply(this,arguments)}return t&&(r.__proto__=t),(r.prototype=Object.create(t&&t.prototype)).constructor=r,r.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},r.prototype.emplaceBack=function(s,d,_,w,S,A){var F=this.length;return this.resize(F+1),this.emplace(F,s,d,_,w,S,A)},r.prototype.emplace=function(s,d,_,w,S,A,F){var U=6*s;return this.int16[U+0]=d,this.int16[U+1]=_,this.int16[U+2]=w,this.int16[U+3]=S,this.int16[U+4]=A,this.int16[U+5]=F,s},r}(Vn);z.prototype.bytesPerElement=12,nr("StructArrayLayout2i2i2i12",z);var W=function(t){function r(){t.apply(this,arguments)}return t&&(r.__proto__=t),(r.prototype=Object.create(t&&t.prototype)).constructor=r,r.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},r.prototype.emplaceBack=function(s,d,_,w,S){var A=this.length;return this.resize(A+1),this.emplace(A,s,d,_,w,S)},r.prototype.emplace=function(s,d,_,w,S,A){var F=4*s,U=8*s;return this.float32[F+0]=d,this.float32[F+1]=_,this.float32[F+2]=w,this.int16[U+6]=S,this.int16[U+7]=A,s},r}(Vn);W.prototype.bytesPerElement=16,nr("StructArrayLayout2f1f2i16",W);var gt=function(t){function r(){t.apply(this,arguments)}return t&&(r.__proto__=t),(r.prototype=Object.create(t&&t.prototype)).constructor=r,r.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},r.prototype.emplaceBack=function(s,d,_,w){var S=this.length;return this.resize(S+1),this.emplace(S,s,d,_,w)},r.prototype.emplace=function(s,d,_,w,S){var A=12*s,F=3*s;return this.uint8[A+0]=d,this.uint8[A+1]=_,this.float32[F+1]=w,this.float32[F+2]=S,s},r}(Vn);gt.prototype.bytesPerElement=12,nr("StructArrayLayout2ub2f12",gt);var Zt=function(t){function r(){t.apply(this,arguments)}return t&&(r.__proto__=t),(r.prototype=Object.create(t&&t.prototype)).constructor=r,r.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},r.prototype.emplaceBack=function(s,d,_){var w=this.length;return this.resize(w+1),this.emplace(w,s,d,_)},r.prototype.emplace=function(s,d,_,w){var S=3*s;return this.uint16[S+0]=d,this.uint16[S+1]=_,this.uint16[S+2]=w,s},r}(Vn);Zt.prototype.bytesPerElement=6,nr("StructArrayLayout3ui6",Zt);var Ie=function(t){function r(){t.apply(this,arguments)}return t&&(r.__proto__=t),(r.prototype=Object.create(t&&t.prototype)).constructor=r,r.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},r.prototype.emplaceBack=function(s,d,_,w,S,A,F,U,G,V,K,at,Ct,_t,Wt,Gt,pe){var de=this.length;return this.resize(de+1),this.emplace(de,s,d,_,w,S,A,F,U,G,V,K,at,Ct,_t,Wt,Gt,pe)},r.prototype.emplace=function(s,d,_,w,S,A,F,U,G,V,K,at,Ct,_t,Wt,Gt,pe,de){var Pe=24*s,ue=12*s,qe=48*s;return this.int16[Pe+0]=d,this.int16[Pe+1]=_,this.uint16[Pe+2]=w,this.uint16[Pe+3]=S,this.uint32[ue+2]=A,this.uint32[ue+3]=F,this.uint32[ue+4]=U,this.uint16[Pe+10]=G,this.uint16[Pe+11]=V,this.uint16[Pe+12]=K,this.float32[ue+7]=at,this.float32[ue+8]=Ct,this.uint8[qe+36]=_t,this.uint8[qe+37]=Wt,this.uint8[qe+38]=Gt,this.uint32[ue+10]=pe,this.int16[Pe+22]=de,s},r}(Vn);Ie.prototype.bytesPerElement=48,nr("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",Ie);var Me=function(t){function r(){t.apply(this,arguments)}return t&&(r.__proto__=t),(r.prototype=Object.create(t&&t.prototype)).constructor=r,r.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},r.prototype.emplaceBack=function(s,d,_,w,S,A,F,U,G,V,K,at,Ct,_t,Wt,Gt,pe,de,Pe,ue,qe,Ke,fr,Nr,hr,jr,Qe,_n){var en=this.length;return this.resize(en+1),this.emplace(en,s,d,_,w,S,A,F,U,G,V,K,at,Ct,_t,Wt,Gt,pe,de,Pe,ue,qe,Ke,fr,Nr,hr,jr,Qe,_n)},r.prototype.emplace=function(s,d,_,w,S,A,F,U,G,V,K,at,Ct,_t,Wt,Gt,pe,de,Pe,ue,qe,Ke,fr,Nr,hr,jr,Qe,_n,en){var Dr=34*s,Pn=17*s;return this.int16[Dr+0]=d,this.int16[Dr+1]=_,this.int16[Dr+2]=w,this.int16[Dr+3]=S,this.int16[Dr+4]=A,this.int16[Dr+5]=F,this.int16[Dr+6]=U,this.int16[Dr+7]=G,this.uint16[Dr+8]=V,this.uint16[Dr+9]=K,this.uint16[Dr+10]=at,this.uint16[Dr+11]=Ct,this.uint16[Dr+12]=_t,this.uint16[Dr+13]=Wt,this.uint16[Dr+14]=Gt,this.uint16[Dr+15]=pe,this.uint16[Dr+16]=de,this.uint16[Dr+17]=Pe,this.uint16[Dr+18]=ue,this.uint16[Dr+19]=qe,this.uint16[Dr+20]=Ke,this.uint16[Dr+21]=fr,this.uint16[Dr+22]=Nr,this.uint32[Pn+12]=hr,this.float32[Pn+13]=jr,this.float32[Pn+14]=Qe,this.float32[Pn+15]=_n,this.float32[Pn+16]=en,s},r}(Vn);Me.prototype.bytesPerElement=68,nr("StructArrayLayout8i15ui1ul4f68",Me);var tr=function(t){function r(){t.apply(this,arguments)}return t&&(r.__proto__=t),(r.prototype=Object.create(t&&t.prototype)).constructor=r,r.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},r.prototype.emplaceBack=function(s){var d=this.length;return this.resize(d+1),this.emplace(d,s)},r.prototype.emplace=function(s,d){return this.float32[1*s+0]=d,s},r}(Vn);tr.prototype.bytesPerElement=4,nr("StructArrayLayout1f4",tr);var mr=function(t){function r(){t.apply(this,arguments)}return t&&(r.__proto__=t),(r.prototype=Object.create(t&&t.prototype)).constructor=r,r.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},r.prototype.emplaceBack=function(s,d,_){var w=this.length;return this.resize(w+1),this.emplace(w,s,d,_)},r.prototype.emplace=function(s,d,_,w){var S=3*s;return this.int16[S+0]=d,this.int16[S+1]=_,this.int16[S+2]=w,s},r}(Vn);mr.prototype.bytesPerElement=6,nr("StructArrayLayout3i6",mr);var Ar=function(t){function r(){t.apply(this,arguments)}return t&&(r.__proto__=t),(r.prototype=Object.create(t&&t.prototype)).constructor=r,r.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},r.prototype.emplaceBack=function(s,d,_){var w=this.length;return this.resize(w+1),this.emplace(w,s,d,_)},r.prototype.emplace=function(s,d,_,w){var S=4*s;return this.uint32[2*s+0]=d,this.uint16[S+2]=_,this.uint16[S+3]=w,s},r}(Vn);Ar.prototype.bytesPerElement=8,nr("StructArrayLayout1ul2ui8",Ar);var Xr=function(t){function r(){t.apply(this,arguments)}return t&&(r.__proto__=t),(r.prototype=Object.create(t&&t.prototype)).constructor=r,r.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},r.prototype.emplaceBack=function(s,d){var _=this.length;return this.resize(_+1),this.emplace(_,s,d)},r.prototype.emplace=function(s,d,_){var w=2*s;return this.uint16[w+0]=d,this.uint16[w+1]=_,s},r}(Vn);Xr.prototype.bytesPerElement=4,nr("StructArrayLayout2ui4",Xr);var Wn=function(t){function r(){t.apply(this,arguments)}return t&&(r.__proto__=t),(r.prototype=Object.create(t&&t.prototype)).constructor=r,r.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},r.prototype.emplaceBack=function(s){var d=this.length;return this.resize(d+1),this.emplace(d,s)},r.prototype.emplace=function(s,d){return this.uint16[1*s+0]=d,s},r}(Vn);Wn.prototype.bytesPerElement=2,nr("StructArrayLayout1ui2",Wn);var u=function(t){function r(){t.apply(this,arguments)}return t&&(r.__proto__=t),(r.prototype=Object.create(t&&t.prototype)).constructor=r,r.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},r.prototype.emplaceBack=function(s,d,_,w){var S=this.length;return this.resize(S+1),this.emplace(S,s,d,_,w)},r.prototype.emplace=function(s,d,_,w,S){var A=4*s;return this.float32[A+0]=d,this.float32[A+1]=_,this.float32[A+2]=w,this.float32[A+3]=S,s},r}(Vn);u.prototype.bytesPerElement=16,nr("StructArrayLayout4f16",u);var p=function(t){function r(){t.apply(this,arguments)}t&&(r.__proto__=t),(r.prototype=Object.create(t&&t.prototype)).constructor=r;var s={anchorPointX:{configurable:!0},anchorPointY:{configurable:!0},x1:{configurable:!0},y1:{configurable:!0},x2:{configurable:!0},y2:{configurable:!0},featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0},anchorPoint:{configurable:!0}};return s.anchorPointX.get=function(){return this._structArray.int16[this._pos2+0]},s.anchorPointY.get=function(){return this._structArray.int16[this._pos2+1]},s.x1.get=function(){return this._structArray.int16[this._pos2+2]},s.y1.get=function(){return this._structArray.int16[this._pos2+3]},s.x2.get=function(){return this._structArray.int16[this._pos2+4]},s.y2.get=function(){return this._structArray.int16[this._pos2+5]},s.featureIndex.get=function(){return this._structArray.uint32[this._pos4+3]},s.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+8]},s.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+9]},s.anchorPoint.get=function(){return new Ft(this.anchorPointX,this.anchorPointY)},Object.defineProperties(r.prototype,s),r}(Oa);p.prototype.size=20;var l=function(t){function r(){t.apply(this,arguments)}return t&&(r.__proto__=t),(r.prototype=Object.create(t&&t.prototype)).constructor=r,r.prototype.get=function(s){return new p(this,s)},r}(L);nr("CollisionBoxArray",l);var g=function(t){function r(){t.apply(this,arguments)}t&&(r.__proto__=t),(r.prototype=Object.create(t&&t.prototype)).constructor=r;var s={anchorX:{configurable:!0},anchorY:{configurable:!0},glyphStartIndex:{configurable:!0},numGlyphs:{configurable:!0},vertexStartIndex:{configurable:!0},lineStartIndex:{configurable:!0},lineLength:{configurable:!0},segment:{configurable:!0},lowerSize:{configurable:!0},upperSize:{configurable:!0},lineOffsetX:{configurable:!0},lineOffsetY:{configurable:!0},writingMode:{configurable:!0},placedOrientation:{configurable:!0},hidden:{configurable:!0},crossTileID:{configurable:!0},associatedIconIndex:{configurable:!0}};return s.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},s.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},s.glyphStartIndex.get=function(){return this._structArray.uint16[this._pos2+2]},s.numGlyphs.get=function(){return this._structArray.uint16[this._pos2+3]},s.vertexStartIndex.get=function(){return this._structArray.uint32[this._pos4+2]},s.lineStartIndex.get=function(){return this._structArray.uint32[this._pos4+3]},s.lineLength.get=function(){return this._structArray.uint32[this._pos4+4]},s.segment.get=function(){return this._structArray.uint16[this._pos2+10]},s.lowerSize.get=function(){return this._structArray.uint16[this._pos2+11]},s.upperSize.get=function(){return this._structArray.uint16[this._pos2+12]},s.lineOffsetX.get=function(){return this._structArray.float32[this._pos4+7]},s.lineOffsetY.get=function(){return this._structArray.float32[this._pos4+8]},s.writingMode.get=function(){return this._structArray.uint8[this._pos1+36]},s.placedOrientation.get=function(){return this._structArray.uint8[this._pos1+37]},s.placedOrientation.set=function(d){this._structArray.uint8[this._pos1+37]=d},s.hidden.get=function(){return this._structArray.uint8[this._pos1+38]},s.hidden.set=function(d){this._structArray.uint8[this._pos1+38]=d},s.crossTileID.get=function(){return this._structArray.uint32[this._pos4+10]},s.crossTileID.set=function(d){this._structArray.uint32[this._pos4+10]=d},s.associatedIconIndex.get=function(){return this._structArray.int16[this._pos2+22]},Object.defineProperties(r.prototype,s),r}(Oa);g.prototype.size=48;var E=function(t){function r(){t.apply(this,arguments)}return t&&(r.__proto__=t),(r.prototype=Object.create(t&&t.prototype)).constructor=r,r.prototype.get=function(s){return new g(this,s)},r}(Ie);nr("PlacedSymbolArray",E);var P=function(t){function r(){t.apply(this,arguments)}t&&(r.__proto__=t),(r.prototype=Object.create(t&&t.prototype)).constructor=r;var s={anchorX:{configurable:!0},anchorY:{configurable:!0},rightJustifiedTextSymbolIndex:{configurable:!0},centerJustifiedTextSymbolIndex:{configurable:!0},leftJustifiedTextSymbolIndex:{configurable:!0},verticalPlacedTextSymbolIndex:{configurable:!0},placedIconSymbolIndex:{configurable:!0},verticalPlacedIconSymbolIndex:{configurable:!0},key:{configurable:!0},textBoxStartIndex:{configurable:!0},textBoxEndIndex:{configurable:!0},verticalTextBoxStartIndex:{configurable:!0},verticalTextBoxEndIndex:{configurable:!0},iconBoxStartIndex:{configurable:!0},iconBoxEndIndex:{configurable:!0},verticalIconBoxStartIndex:{configurable:!0},verticalIconBoxEndIndex:{configurable:!0},featureIndex:{configurable:!0},numHorizontalGlyphVertices:{configurable:!0},numVerticalGlyphVertices:{configurable:!0},numIconVertices:{configurable:!0},numVerticalIconVertices:{configurable:!0},useRuntimeCollisionCircles:{configurable:!0},crossTileID:{configurable:!0},textBoxScale:{configurable:!0},textOffset0:{configurable:!0},textOffset1:{configurable:!0},collisionCircleDiameter:{configurable:!0}};return s.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},s.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},s.rightJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+2]},s.centerJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+3]},s.leftJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+4]},s.verticalPlacedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+5]},s.placedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+6]},s.verticalPlacedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+7]},s.key.get=function(){return this._structArray.uint16[this._pos2+8]},s.textBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+9]},s.textBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+10]},s.verticalTextBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+11]},s.verticalTextBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+12]},s.iconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+13]},s.iconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+14]},s.verticalIconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+15]},s.verticalIconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+16]},s.featureIndex.get=function(){return this._structArray.uint16[this._pos2+17]},s.numHorizontalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+18]},s.numVerticalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+19]},s.numIconVertices.get=function(){return this._structArray.uint16[this._pos2+20]},s.numVerticalIconVertices.get=function(){return this._structArray.uint16[this._pos2+21]},s.useRuntimeCollisionCircles.get=function(){return this._structArray.uint16[this._pos2+22]},s.crossTileID.get=function(){return this._structArray.uint32[this._pos4+12]},s.crossTileID.set=function(d){this._structArray.uint32[this._pos4+12]=d},s.textBoxScale.get=function(){return this._structArray.float32[this._pos4+13]},s.textOffset0.get=function(){return this._structArray.float32[this._pos4+14]},s.textOffset1.get=function(){return this._structArray.float32[this._pos4+15]},s.collisionCircleDiameter.get=function(){return this._structArray.float32[this._pos4+16]},Object.defineProperties(r.prototype,s),r}(Oa);P.prototype.size=68;var T=function(t){function r(){t.apply(this,arguments)}return t&&(r.__proto__=t),(r.prototype=Object.create(t&&t.prototype)).constructor=r,r.prototype.get=function(s){return new P(this,s)},r}(Me);nr("SymbolInstanceArray",T);var k=function(t){function r(){t.apply(this,arguments)}return t&&(r.__proto__=t),(r.prototype=Object.create(t&&t.prototype)).constructor=r,r.prototype.getoffsetX=function(s){return this.float32[1*s+0]},r}(tr);nr("GlyphOffsetArray",k);var q=function(t){function r(){t.apply(this,arguments)}return t&&(r.__proto__=t),(r.prototype=Object.create(t&&t.prototype)).constructor=r,r.prototype.getx=function(s){return this.int16[3*s+0]},r.prototype.gety=function(s){return this.int16[3*s+1]},r.prototype.gettileUnitDistanceFromAnchor=function(s){return this.int16[3*s+2]},r}(mr);nr("SymbolLineVertexArray",q);var H=function(t){function r(){t.apply(this,arguments)}t&&(r.__proto__=t),(r.prototype=Object.create(t&&t.prototype)).constructor=r;var s={featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0}};return s.featureIndex.get=function(){return this._structArray.uint32[this._pos4+0]},s.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+2]},s.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+3]},Object.defineProperties(r.prototype,s),r}(Oa);H.prototype.size=8;var ut=function(t){function r(){t.apply(this,arguments)}return t&&(r.__proto__=t),(r.prototype=Object.create(t&&t.prototype)).constructor=r,r.prototype.get=function(s){return new H(this,s)},r}(Ar);nr("FeatureIndexArray",ut);var dt=oi([{name:"a_pos",components:2,type:"Int16"}],4).members,lt=function(t){void 0===t&&(t=[]),this.segments=t};function zt(t,r){return 256*(t=_e(Math.floor(t),0,255))+_e(Math.floor(r),0,255)}lt.prototype.prepareSegment=function(t,r,s,d){var _=this.segments[this.segments.length-1];return t>lt.MAX_VERTEX_ARRAY_LENGTH&&bt("Max vertices per segment is "+lt.MAX_VERTEX_ARRAY_LENGTH+": bucket requested "+t),(!_||_.vertexLength+t>lt.MAX_VERTEX_ARRAY_LENGTH||_.sortKey!==d)&&(_={vertexOffset:r.length,primitiveOffset:s.length,vertexLength:0,primitiveLength:0},void 0!==d&&(_.sortKey=d),this.segments.push(_)),_},lt.prototype.get=function(){return this.segments},lt.prototype.destroy=function(){for(var t=0,r=this.segments;t<r.length;t+=1){var s=r[t];for(var d in s.vaos)s.vaos[d].destroy()}},lt.simpleSegment=function(t,r,s,d){return new lt([{vertexOffset:t,primitiveOffset:r,vertexLength:s,primitiveLength:d,vaos:{},sortKey:0}])},lt.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,nr("SegmentVector",lt);var Rt=oi([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]),jt=Bt(function(t){t.exports=function(r,s){var d,_,w,S,A,F,U,G;for(_=r.length-(d=3&r.length),w=s,A=3432918353,F=461845907,G=0;G<_;)U=255&r.charCodeAt(G)|(255&r.charCodeAt(++G))<<8|(255&r.charCodeAt(++G))<<16|(255&r.charCodeAt(++G))<<24,++G,w=27492+(65535&(S=5*(65535&(w=(w^=U=(65535&(U=(U=(65535&U)*A+(((U>>>16)*A&65535)<<16)&4294967295)<<15|U>>>17))*F+(((U>>>16)*F&65535)<<16)&4294967295)<<13|w>>>19))+((5*(w>>>16)&65535)<<16)&4294967295))+((58964+(S>>>16)&65535)<<16);switch(U=0,d){case 3:U^=(255&r.charCodeAt(G+2))<<16;case 2:U^=(255&r.charCodeAt(G+1))<<8;case 1:w^=U=(65535&(U=(U=(65535&(U^=255&r.charCodeAt(G)))*A+(((U>>>16)*A&65535)<<16)&4294967295)<<15|U>>>17))*F+(((U>>>16)*F&65535)<<16)&4294967295}return w^=r.length,w=2246822507*(65535&(w^=w>>>16))+((2246822507*(w>>>16)&65535)<<16)&4294967295,w=3266489909*(65535&(w^=w>>>13))+((3266489909*(w>>>16)&65535)<<16)&4294967295,(w^=w>>>16)>>>0}}),Dt=Bt(function(t){t.exports=function(r,s){for(var d,_=r.length,w=s^_,S=0;_>=4;)d=1540483477*(65535&(d=255&r.charCodeAt(S)|(255&r.charCodeAt(++S))<<8|(255&r.charCodeAt(++S))<<16|(255&r.charCodeAt(++S))<<24))+((1540483477*(d>>>16)&65535)<<16),w=1540483477*(65535&w)+((1540483477*(w>>>16)&65535)<<16)^(d=1540483477*(65535&(d^=d>>>24))+((1540483477*(d>>>16)&65535)<<16)),_-=4,++S;switch(_){case 3:w^=(255&r.charCodeAt(S+2))<<16;case 2:w^=(255&r.charCodeAt(S+1))<<8;case 1:w=1540483477*(65535&(w^=255&r.charCodeAt(S)))+((1540483477*(w>>>16)&65535)<<16)}return w=1540483477*(65535&(w^=w>>>13))+((1540483477*(w>>>16)&65535)<<16),(w^=w>>>15)>>>0}}),qt=jt,ee=Dt;qt.murmur3=jt,qt.murmur2=ee;var oe=function(){this.ids=[],this.positions=[],this.indexed=!1};oe.prototype.add=function(t,r,s,d){this.ids.push(ge(t)),this.positions.push(r,s,d)},oe.prototype.getPositions=function(t){for(var r=ge(t),s=0,d=this.ids.length-1;s<d;){var _=s+d>>1;this.ids[_]>=r?d=_:s=_+1}for(var w=[];this.ids[s]===r;)w.push({index:this.positions[3*s],start:this.positions[3*s+1],end:this.positions[3*s+2]}),s++;return w},oe.serialize=function(t,r){var s=new Float64Array(t.ids),d=new Uint32Array(t.positions);return function _(w,S,A,F){for(;A<F;){for(var U=w[A+F>>1],G=A-1,V=F+1;;){do{G++}while(w[G]<U);do{V--}while(w[V]>U);if(G>=V)break;Ce(w,G,V),Ce(S,3*G,3*V),Ce(S,3*G+1,3*V+1),Ce(S,3*G+2,3*V+2)}V-A<F-V?(_(w,S,A,V),A=V+1):(_(w,S,V+1,F),F=V)}}(s,d,0,s.length-1),r&&r.push(s.buffer,d.buffer),{ids:s,positions:d}},oe.deserialize=function(t){var r=new oe;return r.ids=t.ids,r.positions=t.positions,r.indexed=!0,r};var Se=Math.pow(2,53)-1;function ge(t){var r=+t;return!isNaN(r)&&r<=Se?r:qt(String(t))}function Ce(t,r,s){var d=t[r];t[r]=t[s],t[s]=d}nr("FeaturePositionMap",oe);var be=function(t,r){this.gl=t.gl,this.location=r},Ue=function(t){function r(s,d){t.call(this,s,d),this.current=0}return t&&(r.__proto__=t),(r.prototype=Object.create(t&&t.prototype)).constructor=r,r.prototype.set=function(s){this.current!==s&&(this.current=s,this.gl.uniform1i(this.location,s))},r}(be),Ne=function(t){function r(s,d){t.call(this,s,d),this.current=0}return t&&(r.__proto__=t),(r.prototype=Object.create(t&&t.prototype)).constructor=r,r.prototype.set=function(s){this.current!==s&&(this.current=s,this.gl.uniform1f(this.location,s))},r}(be),Ve=function(t){function r(s,d){t.call(this,s,d),this.current=[0,0]}return t&&(r.__proto__=t),(r.prototype=Object.create(t&&t.prototype)).constructor=r,r.prototype.set=function(s){s[0]===this.current[0]&&s[1]===this.current[1]||(this.current=s,this.gl.uniform2f(this.location,s[0],s[1]))},r}(be),er=function(t){function r(s,d){t.call(this,s,d),this.current=[0,0,0]}return t&&(r.__proto__=t),(r.prototype=Object.create(t&&t.prototype)).constructor=r,r.prototype.set=function(s){s[0]===this.current[0]&&s[1]===this.current[1]&&s[2]===this.current[2]||(this.current=s,this.gl.uniform3f(this.location,s[0],s[1],s[2]))},r}(be),ir=function(t){function r(s,d){t.call(this,s,d),this.current=[0,0,0,0]}return t&&(r.__proto__=t),(r.prototype=Object.create(t&&t.prototype)).constructor=r,r.prototype.set=function(s){s[0]===this.current[0]&&s[1]===this.current[1]&&s[2]===this.current[2]&&s[3]===this.current[3]||(this.current=s,this.gl.uniform4f(this.location,s[0],s[1],s[2],s[3]))},r}(be),rr=function(t){function r(s,d){t.call(this,s,d),this.current=An.transparent}return t&&(r.__proto__=t),(r.prototype=Object.create(t&&t.prototype)).constructor=r,r.prototype.set=function(s){s.r===this.current.r&&s.g===this.current.g&&s.b===this.current.b&&s.a===this.current.a||(this.current=s,this.gl.uniform4f(this.location,s.r,s.g,s.b,s.a))},r}(be),Rr=new Float32Array(16),Ye=function(t){function r(s,d){t.call(this,s,d),this.current=Rr}return t&&(r.__proto__=t),(r.prototype=Object.create(t&&t.prototype)).constructor=r,r.prototype.set=function(s){if(s[12]!==this.current[12]||s[0]!==this.current[0])return this.current=s,void this.gl.uniformMatrix4fv(this.location,!1,s);for(var d=1;d<16;d++)if(s[d]!==this.current[d]){this.current=s,this.gl.uniformMatrix4fv(this.location,!1,s);break}},r}(be);function _r(t){return[zt(255*t.r,255*t.g),zt(255*t.b,255*t.a)]}var Ir=function(t,r,s){this.value=t,this.uniformNames=r.map(function(d){return"u_"+d}),this.type=s};Ir.prototype.setUniform=function(t,r,s){t.set(s.constantOr(this.value))},Ir.prototype.getBinding=function(t,r,s){return"color"===this.type?new rr(t,r):new Ne(t,r)};var xr=function(t,r){this.uniformNames=r.map(function(s){return"u_"+s}),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1};xr.prototype.setConstantPatternPositions=function(t,r){this.pixelRatioFrom=r.pixelRatio,this.pixelRatioTo=t.pixelRatio,this.patternFrom=r.tlbr,this.patternTo=t.tlbr},xr.prototype.setUniform=function(t,r,s,d){var _="u_pattern_to"===d?this.patternTo:"u_pattern_from"===d?this.patternFrom:"u_pixel_ratio_to"===d?this.pixelRatioTo:"u_pixel_ratio_from"===d?this.pixelRatioFrom:null;_&&t.set(_)},xr.prototype.getBinding=function(t,r,s){return"u_pattern"===s.substr(0,9)?new ir(t,r):new Ne(t,r)};var yr=function(t,r,s,d){this.expression=t,this.type=s,this.maxValue=0,this.paintVertexAttributes=r.map(function(_){return{name:"a_"+_,type:"Float32",components:"color"===s?2:1,offset:0}}),this.paintVertexArray=new d};yr.prototype.populatePaintArray=function(t,r,s,d,_){var w=this.paintVertexArray.length,S=this.expression.evaluate(new ti(0),r,{},d,[],_);this.paintVertexArray.resize(t),this._setPaintValue(w,t,S)},yr.prototype.updatePaintArray=function(t,r,s,d){var _=this.expression.evaluate({zoom:0},s,d);this._setPaintValue(t,r,_)},yr.prototype._setPaintValue=function(t,r,s){if("color"===this.type)for(var d=_r(s),_=t;_<r;_++)this.paintVertexArray.emplace(_,d[0],d[1]);else{for(var w=t;w<r;w++)this.paintVertexArray.emplace(w,s);this.maxValue=Math.max(this.maxValue,Math.abs(s))}},yr.prototype.upload=function(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},yr.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()};var dr=function(t,r,s,d,_,w){this.expression=t,this.uniformNames=r.map(function(S){return"u_"+S+"_t"}),this.type=s,this.useIntegerZoom=d,this.zoom=_,this.maxValue=0,this.paintVertexAttributes=r.map(function(S){return{name:"a_"+S,type:"Float32",components:"color"===s?4:2,offset:0}}),this.paintVertexArray=new w};dr.prototype.populatePaintArray=function(t,r,s,d,_){var w=this.expression.evaluate(new ti(this.zoom),r,{},d,[],_),S=this.expression.evaluate(new ti(this.zoom+1),r,{},d,[],_),A=this.paintVertexArray.length;this.paintVertexArray.resize(t),this._setPaintValue(A,t,w,S)},dr.prototype.updatePaintArray=function(t,r,s,d){var _=this.expression.evaluate({zoom:this.zoom},s,d),w=this.expression.evaluate({zoom:this.zoom+1},s,d);this._setPaintValue(t,r,_,w)},dr.prototype._setPaintValue=function(t,r,s,d){if("color"===this.type)for(var _=_r(s),w=_r(d),S=t;S<r;S++)this.paintVertexArray.emplace(S,_[0],_[1],w[0],w[1]);else{for(var A=t;A<r;A++)this.paintVertexArray.emplace(A,s,d);this.maxValue=Math.max(this.maxValue,Math.abs(s),Math.abs(d))}},dr.prototype.upload=function(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},dr.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()},dr.prototype.setUniform=function(t,r){var s=this.useIntegerZoom?Math.floor(r.zoom):r.zoom,d=_e(this.expression.interpolationFactor(s,this.zoom,this.zoom+1),0,1);t.set(d)},dr.prototype.getBinding=function(t,r,s){return new Ne(t,r)};var cr=function(t,r,s,d,_,w){this.expression=t,this.type=r,this.useIntegerZoom=s,this.zoom=d,this.layerId=w,this.zoomInPaintVertexArray=new _,this.zoomOutPaintVertexArray=new _};cr.prototype.populatePaintArray=function(t,r,s){var d=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(t),this.zoomOutPaintVertexArray.resize(t),this._setPaintValues(d,t,r.patterns&&r.patterns[this.layerId],s)},cr.prototype.updatePaintArray=function(t,r,s,d,_){this._setPaintValues(t,r,s.patterns&&s.patterns[this.layerId],_)},cr.prototype._setPaintValues=function(t,r,s,d){if(d&&s){var _=d[s.min],w=d[s.mid],S=d[s.max];if(_&&w&&S)for(var A=t;A<r;A++)this.zoomInPaintVertexArray.emplace(A,w.tl[0],w.tl[1],w.br[0],w.br[1],_.tl[0],_.tl[1],_.br[0],_.br[1],w.pixelRatio,_.pixelRatio),this.zoomOutPaintVertexArray.emplace(A,w.tl[0],w.tl[1],w.br[0],w.br[1],S.tl[0],S.tl[1],S.br[0],S.br[1],w.pixelRatio,S.pixelRatio)}},cr.prototype.upload=function(t){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=t.createVertexBuffer(this.zoomInPaintVertexArray,Rt.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=t.createVertexBuffer(this.zoomOutPaintVertexArray,Rt.members,this.expression.isStateDependent))},cr.prototype.destroy=function(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()};var ar=function(t,r,s){this.binders={},this._buffers=[];var d=[];for(var _ in t.paint._values)if(s(_)){var w=t.paint.get(_);if(w instanceof sa&&kn(w.property.specification)){var S=Kr(_,t.type),A=w.value,F=w.property.specification.type,U=w.property.useIntegerZoom,G=w.property.specification["property-type"],V="cross-faded"===G||"cross-faded-data-driven"===G;if("constant"===A.kind)this.binders[_]=V?new xr(A.value,S):new Ir(A.value,S,F),d.push("/u_"+_);else if("source"===A.kind||V){var K=pn(_,F,"source");this.binders[_]=V?new cr(A,F,U,r,K,t.id):new yr(A,S,F,K),d.push("/a_"+_)}else{var at=pn(_,F,"composite");this.binders[_]=new dr(A,S,F,U,r,at),d.push("/z_"+_)}}}this.cacheKey=d.sort().join("")};ar.prototype.getMaxValue=function(t){var r=this.binders[t];return r instanceof yr||r instanceof dr?r.maxValue:0},ar.prototype.populatePaintArrays=function(t,r,s,d,_){for(var w in this.binders){var S=this.binders[w];(S instanceof yr||S instanceof dr||S instanceof cr)&&S.populatePaintArray(t,r,s,d,_)}},ar.prototype.setConstantPatternPositions=function(t,r){for(var s in this.binders){var d=this.binders[s];d instanceof xr&&d.setConstantPatternPositions(t,r)}},ar.prototype.updatePaintArrays=function(t,r,s,d,_){var w=!1;for(var S in t)for(var A=0,F=r.getPositions(S);A<F.length;A+=1){var U=F[A],G=s.feature(U.index);for(var V in this.binders){var K=this.binders[V];if((K instanceof yr||K instanceof dr||K instanceof cr)&&!0===K.expression.isStateDependent){var at=d.paint.get(V);K.expression=at.value,K.updatePaintArray(U.start,U.end,G,t[S],_),w=!0}}}return w},ar.prototype.defines=function(){var t=[];for(var r in this.binders){var s=this.binders[r];(s instanceof Ir||s instanceof xr)&&t.push.apply(t,s.uniformNames.map(function(d){return"#define HAS_UNIFORM_"+d}))}return t},ar.prototype.getBinderAttributes=function(){var t=[];for(var r in this.binders){var s=this.binders[r];if(s instanceof yr||s instanceof dr)for(var d=0;d<s.paintVertexAttributes.length;d++)t.push(s.paintVertexAttributes[d].name);else if(s instanceof cr)for(var _=0;_<Rt.members.length;_++)t.push(Rt.members[_].name)}return t},ar.prototype.getBinderUniforms=function(){var t=[];for(var r in this.binders){var s=this.binders[r];if(s instanceof Ir||s instanceof xr||s instanceof dr)for(var d=0,_=s.uniformNames;d<_.length;d+=1)t.push(_[d])}return t},ar.prototype.getPaintVertexBuffers=function(){return this._buffers},ar.prototype.getUniforms=function(t,r){var s=[];for(var d in this.binders){var _=this.binders[d];if(_ instanceof Ir||_ instanceof xr||_ instanceof dr)for(var w=0,S=_.uniformNames;w<S.length;w+=1){var A=S[w];if(r[A]){var F=_.getBinding(t,r[A],A);s.push({name:A,property:d,binding:F})}}}return s},ar.prototype.setUniforms=function(t,r,s,d){for(var _=0,w=r;_<w.length;_+=1){var S=w[_],A=S.name,F=S.property;this.binders[F].setUniform(S.binding,d,s.get(F),A)}},ar.prototype.updatePaintBuffers=function(t){for(var r in this._buffers=[],this.binders){var s=this.binders[r];if(t&&s instanceof cr){var d=2===t.fromScale?s.zoomInPaintVertexBuffer:s.zoomOutPaintVertexBuffer;d&&this._buffers.push(d)}else(s instanceof yr||s instanceof dr)&&s.paintVertexBuffer&&this._buffers.push(s.paintVertexBuffer)}},ar.prototype.upload=function(t){for(var r in this.binders){var s=this.binders[r];(s instanceof yr||s instanceof dr||s instanceof cr)&&s.upload(t)}this.updatePaintBuffers()},ar.prototype.destroy=function(){for(var t in this.binders){var r=this.binders[t];(r instanceof yr||r instanceof dr||r instanceof cr)&&r.destroy()}};var Vr=function(t,r,s){void 0===s&&(s=function(){return!0}),this.programConfigurations={};for(var d=0,_=t;d<_.length;d+=1){var w=_[d];this.programConfigurations[w.id]=new ar(w,r,s)}this.needsUpload=!1,this._featureMap=new oe,this._bufferOffset=0};function Kr(t,r){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[t]||[t.replace(r+"-","").replace(/-/g,"_")]}function pn(t,r,s){var _={"line-pattern":{source:n,composite:n},"fill-pattern":{source:n,composite:n},"fill-extrusion-pattern":{source:n,composite:n}}[t];return _&&_[s]||{color:{source:e,composite:u},number:{source:tr,composite:e}}[r][s]}Vr.prototype.populatePaintArrays=function(t,r,s,d,_,w){for(var S in this.programConfigurations)this.programConfigurations[S].populatePaintArrays(t,r,d,_,w);void 0!==r.id&&this._featureMap.add(r.id,s,this._bufferOffset,t),this._bufferOffset=t,this.needsUpload=!0},Vr.prototype.updatePaintArrays=function(t,r,s,d){for(var _=0,w=s;_<w.length;_+=1){var S=w[_];this.needsUpload=this.programConfigurations[S.id].updatePaintArrays(t,this._featureMap,r,S,d)||this.needsUpload}},Vr.prototype.get=function(t){return this.programConfigurations[t]},Vr.prototype.upload=function(t){if(this.needsUpload){for(var r in this.programConfigurations)this.programConfigurations[r].upload(t);this.needsUpload=!1}},Vr.prototype.destroy=function(){for(var t in this.programConfigurations)this.programConfigurations[t].destroy()},nr("ConstantBinder",Ir),nr("CrossFadedConstantBinder",xr),nr("SourceExpressionBinder",yr),nr("CrossFadedCompositeBinder",cr),nr("CompositeExpressionBinder",dr),nr("ProgramConfiguration",ar,{omit:["_buffers"]}),nr("ProgramConfigurationSet",Vr);var on=Math.pow(2,14)-1,an=-on-1;function $r(t){for(var r=8192/t.extent,s=t.loadGeometry(),d=0;d<s.length;d++)for(var _=s[d],w=0;w<_.length;w++){var S=_[w],A=Math.round(S.x*r),F=Math.round(S.y*r);S.x=_e(A,an,on),S.y=_e(F,an,on),(A<S.x||A>S.x+1||F<S.y||F>S.y+1)&&bt("Geometry exceeds allowed extent, reduce your vector tile buffer size")}return s}function hn(t,r){return{type:t.type,id:t.id,properties:t.properties,geometry:r?$r(t):[]}}function Cn(t,r,s,d,_){t.emplaceBack(2*r+(d+1)/2,2*s+(_+1)/2)}var _a=function(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(function(r){return r.id}),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new Qo,this.indexArray=new Zt,this.segments=new lt,this.programConfigurations=new Vr(t.layers,t.zoom),this.stateDependentLayerIds=this.layers.filter(function(r){return r.isStateDependent()}).map(function(r){return r.id})};function xa(t,r){for(var s=0;s<t.length;s++)if(iu(r,t[s]))return!0;for(var d=0;d<r.length;d++)if(iu(t,r[d]))return!0;return!!nu(t,r)}function Ds(t,r,s){return!!iu(t,r)||!!yu(r,t,s)}function ts(t,r){if(1===t.length)return Ku(r,t[0]);for(var s=0;s<r.length;s++)for(var d=r[s],_=0;_<d.length;_++)if(iu(t,d[_]))return!0;for(var w=0;w<t.length;w++)if(Ku(r,t[w]))return!0;for(var S=0;S<r.length;S++)if(nu(t,r[S]))return!0;return!1}function bl(t,r,s){if(t.length>1){if(nu(t,r))return!0;for(var d=0;d<r.length;d++)if(yu(r[d],t,s))return!0}for(var _=0;_<t.length;_++)if(yu(t[_],r,s))return!0;return!1}function nu(t,r){if(0===t.length||0===r.length)return!1;for(var s=0;s<t.length-1;s++)for(var d=t[s],_=t[s+1],w=0;w<r.length-1;w++)if(Pu(d,_,r[w],r[w+1]))return!0;return!1}function Pu(t,r,s,d){return Mt(t,s,d)!==Mt(r,s,d)&&Mt(t,r,s)!==Mt(t,r,d)}function yu(t,r,s){var d=s*s;if(1===r.length)return t.distSqr(r[0])<d;for(var _=1;_<r.length;_++)if(wl(t,r[_-1],r[_])<d)return!0;return!1}function wl(t,r,s){var d=r.distSqr(s);if(0===d)return t.distSqr(r);var _=((t.x-r.x)*(s.x-r.x)+(t.y-r.y)*(s.y-r.y))/d;return t.distSqr(_<0?r:_>1?s:s.sub(r)._mult(_)._add(r))}function Ku(t,r){for(var s,d,_,w=!1,S=0;S<t.length;S++)for(var A=0,F=(s=t[S]).length-1;A<s.length;F=A++)(d=s[A]).y>r.y!=(_=s[F]).y>r.y&&r.x<(_.x-d.x)*(r.y-d.y)/(_.y-d.y)+d.x&&(w=!w);return w}function iu(t,r){for(var s=!1,d=0,_=t.length-1;d<t.length;_=d++){var w=t[d],S=t[_];w.y>r.y!=S.y>r.y&&r.x<(S.x-w.x)*(r.y-w.y)/(S.y-w.y)+w.x&&(s=!s)}return s}function $u(t,r,s){var d=s[0],_=s[2];if(t.x<d.x&&r.x<d.x||t.x>_.x&&r.x>_.x||t.y<d.y&&r.y<d.y||t.y>_.y&&r.y>_.y)return!1;var w=Mt(t,r,s[0]);return w!==Mt(t,r,s[1])||w!==Mt(t,r,s[2])||w!==Mt(t,r,s[3])}function Go(t,r,s){var d=r.paint.get(t).value;return"constant"===d.kind?d.value:s.programConfigurations.get(r.id).getMaxValue(t)}function vu(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1])}function qs(t,r,s,d,_){if(!r[0]&&!r[1])return t;var w=Ft.convert(r)._mult(_);"viewport"===s&&w._rotate(-d);for(var S=[],A=0;A<t.length;A++)S.push(t[A].sub(w));return S}_a.prototype.populate=function(t,r,s){var d=this.layers[0],_=[],w=null,S=!1;"circle"===d.type&&(S=!(w=d.layout.get("circle-sort-key")).isConstant());for(var A=0,F=t;A<F.length;A+=1){var U=F[A],G=U.feature,V=U.id,K=U.index,at=U.sourceLayerIndex,Ct=this.layers[0]._featureFilter.needGeometry,_t=hn(G,Ct);if(this.layers[0]._featureFilter.filter(new ti(this.zoom),_t,s)){var Wt=S?w.evaluate(_t,{},s):void 0,Gt={id:V,properties:G.properties,type:G.type,sourceLayerIndex:at,index:K,geometry:Ct?_t.geometry:$r(G),patterns:{},sortKey:Wt};_.push(Gt)}}S&&_.sort(function(Nr,hr){return Nr.sortKey-hr.sortKey});for(var pe=0,de=_;pe<de.length;pe+=1){var Pe=de[pe],ue=Pe.geometry,qe=Pe.index,Ke=Pe.sourceLayerIndex,fr=t[qe].feature;this.addFeature(Pe,ue,qe,s),r.featureIndex.insert(fr,ue,qe,Ke,this.index)}},_a.prototype.update=function(t,r,s){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,r,this.stateDependentLayers,s)},_a.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},_a.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},_a.prototype.upload=function(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,dt),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0},_a.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},_a.prototype.addFeature=function(t,r,s,d){for(var _=0,w=r;_<w.length;_+=1)for(var S=0,A=w[_];S<A.length;S+=1){var F=A[S],U=F.x,G=F.y;if(!(U<0||U>=8192||G<0||G>=8192)){var V=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,t.sortKey),K=V.vertexLength;Cn(this.layoutVertexArray,U,G,-1,-1),Cn(this.layoutVertexArray,U,G,1,-1),Cn(this.layoutVertexArray,U,G,1,1),Cn(this.layoutVertexArray,U,G,-1,1),this.indexArray.emplaceBack(K,K+1,K+2),this.indexArray.emplaceBack(K,K+3,K+2),V.vertexLength+=4,V.primitiveLength+=2}}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,s,{},d)},nr("CircleBucket",_a,{omit:["layers"]});var Gu=new Oo({"circle-sort-key":new Gr(xt.layout_circle["circle-sort-key"])}),Co={paint:new Oo({"circle-radius":new Gr(xt.paint_circle["circle-radius"]),"circle-color":new Gr(xt.paint_circle["circle-color"]),"circle-blur":new Gr(xt.paint_circle["circle-blur"]),"circle-opacity":new Gr(xt.paint_circle["circle-opacity"]),"circle-translate":new vr(xt.paint_circle["circle-translate"]),"circle-translate-anchor":new vr(xt.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new vr(xt.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new vr(xt.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Gr(xt.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Gr(xt.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Gr(xt.paint_circle["circle-stroke-opacity"])}),layout:Gu},po="undefined"!=typeof Float32Array?Float32Array:Array;function Ua(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function El(t,r,s){var d=r[0],_=r[1],w=r[2],S=r[3],A=r[4],F=r[5],U=r[6],G=r[7],V=r[8],K=r[9],at=r[10],Ct=r[11],_t=r[12],Wt=r[13],Gt=r[14],pe=r[15],de=s[0],Pe=s[1],ue=s[2],qe=s[3];return t[0]=de*d+Pe*A+ue*V+qe*_t,t[1]=de*_+Pe*F+ue*K+qe*Wt,t[2]=de*w+Pe*U+ue*at+qe*Gt,t[3]=de*S+Pe*G+ue*Ct+qe*pe,t[4]=(de=s[4])*d+(Pe=s[5])*A+(ue=s[6])*V+(qe=s[7])*_t,t[5]=de*_+Pe*F+ue*K+qe*Wt,t[6]=de*w+Pe*U+ue*at+qe*Gt,t[7]=de*S+Pe*G+ue*Ct+qe*pe,t[8]=(de=s[8])*d+(Pe=s[9])*A+(ue=s[10])*V+(qe=s[11])*_t,t[9]=de*_+Pe*F+ue*K+qe*Wt,t[10]=de*w+Pe*U+ue*at+qe*Gt,t[11]=de*S+Pe*G+ue*Ct+qe*pe,t[12]=(de=s[12])*d+(Pe=s[13])*A+(ue=s[14])*V+(qe=s[15])*_t,t[13]=de*_+Pe*F+ue*K+qe*Wt,t[14]=de*w+Pe*U+ue*at+qe*Gt,t[15]=de*S+Pe*G+ue*Ct+qe*pe,t}Math.hypot||(Math.hypot=function(){for(var t=arguments,r=0,s=arguments.length;s--;)r+=t[s]*t[s];return Math.sqrt(r)});var jl,t,Ph=El;function Xl(t,r,s){var d=r[0],_=r[1],w=r[2],S=r[3];return t[0]=s[0]*d+s[4]*_+s[8]*w+s[12]*S,t[1]=s[1]*d+s[5]*_+s[9]*w+s[13]*S,t[2]=s[2]*d+s[6]*_+s[10]*w+s[14]*S,t[3]=s[3]*d+s[7]*_+s[11]*w+s[15]*S,t}jl=new po(3),po!=Float32Array&&(jl[0]=0,jl[1]=0,jl[2]=0),t=new po(4),po!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0);var Yl=(function(){var t=new po(2);po!=Float32Array&&(t[0]=0,t[1]=0)}(),function(t){function r(s){t.call(this,s,Co)}return t&&(r.__proto__=t),(r.prototype=Object.create(t&&t.prototype)).constructor=r,r.prototype.createBucket=function(s){return new _a(s)},r.prototype.queryRadius=function(s){var d=s;return Go("circle-radius",this,d)+Go("circle-stroke-width",this,d)+vu(this.paint.get("circle-translate"))},r.prototype.queryIntersectsFeature=function(s,d,_,w,S,A,F,U){for(var G=qs(s,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),A.angle,F),V=this.paint.get("circle-radius").evaluate(d,_)+this.paint.get("circle-stroke-width").evaluate(d,_),K="map"===this.paint.get("circle-pitch-alignment"),at=K?G:function(Ke,fr){return Ke.map(function(Nr){return $c(Nr,fr)})}(G,U),Ct=K?V*F:V,_t=0,Wt=w;_t<Wt.length;_t+=1)for(var Gt=0,pe=Wt[_t];Gt<pe.length;Gt+=1){var de=pe[Gt],Pe=K?de:$c(de,U),ue=Ct,qe=Xl([],[de.x,de.y,0,1],U);if("viewport"===this.paint.get("circle-pitch-scale")&&"map"===this.paint.get("circle-pitch-alignment")?ue*=qe[3]/A.cameraToCenterDistance:"map"===this.paint.get("circle-pitch-scale")&&"viewport"===this.paint.get("circle-pitch-alignment")&&(ue*=A.cameraToCenterDistance/qe[3]),Ds(at,Pe,ue))return!0}return!1},r}(Wr));function $c(t,r){var s=Xl([],[t.x,t.y,0,1],r);return new Ft(s[0]/s[3],s[1]/s[3])}var Sl=function(t){function r(){t.apply(this,arguments)}return t&&(r.__proto__=t),(r.prototype=Object.create(t&&t.prototype)).constructor=r,r}(_a);function Cl(t,r,s,d){var _=r.width,w=r.height;if(d){if(d instanceof Uint8ClampedArray)d=new Uint8Array(d.buffer);else if(d.length!==_*w*s)throw new RangeError("mismatched image size")}else d=new Uint8Array(_*w*s);return t.width=_,t.height=w,t.data=d,t}function xp(t,r,s){var d=r.width,_=r.height;if(d!==t.width||_!==t.height){var w=Cl({},{width:d,height:_},s);Mh(t,w,{x:0,y:0},{x:0,y:0},{width:Math.min(t.width,d),height:Math.min(t.height,_)},s),t.width=d,t.height=_,t.data=w.data}}function Mh(t,r,s,d,_,w){if(0===_.width||0===_.height)return r;if(_.width>t.width||_.height>t.height||s.x>t.width-_.width||s.y>t.height-_.height)throw new RangeError("out of range source coordinates for image copy");if(_.width>r.width||_.height>r.height||d.x>r.width-_.width||d.y>r.height-_.height)throw new RangeError("out of range destination coordinates for image copy");for(var S=t.data,A=r.data,F=0;F<_.height;F++)for(var U=((s.y+F)*t.width+s.x)*w,G=((d.y+F)*r.width+d.x)*w,V=0;V<_.width*w;V++)A[G+V]=S[U+V];return r}nr("HeatmapBucket",Sl,{omit:["layers"]});var Il=function(t,r){Cl(this,t,1,r)};Il.prototype.resize=function(t){xp(this,t,1)},Il.prototype.clone=function(){return new Il({width:this.width,height:this.height},new Uint8Array(this.data))},Il.copy=function(t,r,s,d,_){Mh(t,r,s,d,_,1)};var us=function(t,r){Cl(this,t,4,r)};us.prototype.resize=function(t){xp(this,t,4)},us.prototype.replace=function(t,r){r?this.data.set(t):this.data=t instanceof Uint8ClampedArray?new Uint8Array(t.buffer):t},us.prototype.clone=function(){return new us({width:this.width,height:this.height},new Uint8Array(this.data))},us.copy=function(t,r,s,d,_){Mh(t,r,s,d,_,4)},nr("AlphaImage",Il),nr("RGBAImage",us);var Sf={paint:new Oo({"heatmap-radius":new Gr(xt.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Gr(xt.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new vr(xt.paint_heatmap["heatmap-intensity"]),"heatmap-color":new ya(xt.paint_heatmap["heatmap-color"]),"heatmap-opacity":new vr(xt.paint_heatmap["heatmap-opacity"])})};function bp(t){var r={},s=t.resolution||256,d=t.clips?t.clips.length:1,_=t.image||new us({width:s,height:d}),w=function(Ct,_t,Wt){r[t.evaluationKey]=Wt;var Gt=t.expression.evaluate(r);_.data[Ct+_t+0]=Math.floor(255*Gt.r/Gt.a),_.data[Ct+_t+1]=Math.floor(255*Gt.g/Gt.a),_.data[Ct+_t+2]=Math.floor(255*Gt.b/Gt.a),_.data[Ct+_t+3]=Math.floor(255*Gt.a)};if(t.clips)for(var S=0,A=0;S<d;++S,A+=4*s)for(var F=0,U=0;F<s;F++,U+=4){var G=F/(s-1),V=t.clips[S];w(A,U,V.start*(1-G)+V.end*G)}else for(var K=0,at=0;K<s;K++,at+=4)w(0,at,K/(s-1));return _}var Cf=function(t){function r(s){t.call(this,s,Sf),this._updateColorRamp()}return t&&(r.__proto__=t),(r.prototype=Object.create(t&&t.prototype)).constructor=r,r.prototype.createBucket=function(s){return new Sl(s)},r.prototype._handleSpecialPaintPropertyUpdate=function(s){"heatmap-color"===s&&this._updateColorRamp()},r.prototype._updateColorRamp=function(){this.colorRamp=bp({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null},r.prototype.resize=function(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)},r.prototype.queryRadius=function(){return 0},r.prototype.queryIntersectsFeature=function(){return!1},r.prototype.hasOffscreenPass=function(){return 0!==this.paint.get("heatmap-opacity")&&"none"!==this.visibility},r}(Wr),If={paint:new Oo({"hillshade-illumination-direction":new vr(xt.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new vr(xt.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new vr(xt.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new vr(xt.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new vr(xt.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new vr(xt.paint_hillshade["hillshade-accent-color"])})},Pf=function(t){function r(s){t.call(this,s,If)}return t&&(r.__proto__=t),(r.prototype=Object.create(t&&t.prototype)).constructor=r,r.prototype.hasOffscreenPass=function(){return 0!==this.paint.get("hillshade-exaggeration")&&"none"!==this.visibility},r}(Wr),Mf=oi([{name:"a_pos",components:2,type:"Int16"}],4).members,Th=Qc,Tf=Qc;function Qc(t,r,s){s=s||2;var d,_,w,S,A,F,U,G=r&&r.length,V=G?r[0]*s:t.length,K=Fr(t,0,V,s,!0),at=[];if(!K||K.next===K.prev)return at;if(G&&(K=function(_t,Wt,Gt,pe){var de,Pe,ue,qe=[];for(de=0,Pe=Wt.length;de<Pe;de++)(ue=Fr(_t,Wt[de]*pe,de<Pe-1?Wt[de+1]*pe:_t.length,pe,!1))===ue.next&&(ue.steiner=!0),qe.push(Af(ue));for(qe.sort(ai),de=0;de<qe.length;de++)Or(qe[de],Gt),Gt=Lr(Gt,Gt.next);return Gt}(t,r,K,s)),t.length>80*s){d=w=t[0],_=S=t[1];for(var Ct=s;Ct<V;Ct+=s)(A=t[Ct])<d&&(d=A),(F=t[Ct+1])<_&&(_=F),A>w&&(w=A),F>S&&(S=F);U=0!==(U=Math.max(w-d,S-_))?1/U:0}return Qr(K,at,s,d,_,U),at}function Fr(t,r,s,d,_){var w,S;if(_===Oh(t,r,s,d)>0)for(w=r;w<s;w+=d)S=Sp(w,t[w],t[w+1],S);else for(w=s-d;w>=r;w-=d)S=Sp(w,t[w],t[w+1],S);return S&&th(S,S.next)&&(mc(S),S=S.next),S}function Lr(t,r){if(!t)return t;r||(r=t);var s,d=t;do{if(s=!1,d.steiner||!th(d,d.next)&&0!==Vo(d.prev,d,d.next))d=d.next;else{if(mc(d),(d=r=d.prev)===d.next)break;s=!0}}while(s||d!==r);return r}function Qr(t,r,s,d,_,w,S){if(t){!S&&w&&function(G,V,K,at){var Ct=G;do{null===Ct.z&&(Ct.z=dc(Ct.x,Ct.y,V,K,at)),Ct.prevZ=Ct.prev,Ct.nextZ=Ct.next,Ct=Ct.next}while(Ct!==G);Ct.prevZ.nextZ=null,Ct.prevZ=null,function(_t){var Wt,Gt,pe,de,Pe,ue,qe,Ke,fr=1;do{for(Gt=_t,_t=null,Pe=null,ue=0;Gt;){for(ue++,pe=Gt,qe=0,Wt=0;Wt<fr&&(qe++,pe=pe.nextZ);Wt++);for(Ke=fr;qe>0||Ke>0&&pe;)0!==qe&&(0===Ke||!pe||Gt.z<=pe.z)?(de=Gt,Gt=Gt.nextZ,qe--):(de=pe,pe=pe.nextZ,Ke--),Pe?Pe.nextZ=de:_t=de,de.prevZ=Pe,Pe=de;Gt=pe}Pe.nextZ=null,fr*=2}while(ue>1)}(Ct)}(t,d,_,w);for(var A,F,U=t;t.prev!==t.next;)if(A=t.prev,F=t.next,w?vn(t,d,_,w):tn(t))r.push(A.i/s),r.push(t.i/s),r.push(F.i/s),mc(t),t=F.next,U=F.next;else if((t=F)===U){S?1===S?Qr(t=mn(Lr(t),r,s),r,s,d,_,w,2):2===S&&ei(t,r,s,d,_,w):Qr(Lr(t),r,s,d,_,w,1);break}}}function tn(t){var r=t.prev,s=t,d=t.next;if(Vo(r,s,d)>=0)return!1;for(var _=t.next.next;_!==t.prev;){if(Wl(r.x,r.y,s.x,s.y,d.x,d.y,_.x,_.y)&&Vo(_.prev,_,_.next)>=0)return!1;_=_.next}return!0}function vn(t,r,s,d){var _=t.prev,w=t,S=t.next;if(Vo(_,w,S)>=0)return!1;for(var A=_.x>w.x?_.x>S.x?_.x:S.x:w.x>S.x?w.x:S.x,F=_.y>w.y?_.y>S.y?_.y:S.y:w.y>S.y?w.y:S.y,U=dc(_.x<w.x?_.x<S.x?_.x:S.x:w.x<S.x?w.x:S.x,_.y<w.y?_.y<S.y?_.y:S.y:w.y<S.y?w.y:S.y,r,s,d),G=dc(A,F,r,s,d),V=t.prevZ,K=t.nextZ;V&&V.z>=U&&K&&K.z<=G;){if(V!==t.prev&&V!==t.next&&Wl(_.x,_.y,w.x,w.y,S.x,S.y,V.x,V.y)&&Vo(V.prev,V,V.next)>=0||(V=V.prevZ,K!==t.prev&&K!==t.next&&Wl(_.x,_.y,w.x,w.y,S.x,S.y,K.x,K.y)&&Vo(K.prev,K,K.next)>=0))return!1;K=K.nextZ}for(;V&&V.z>=U;){if(V!==t.prev&&V!==t.next&&Wl(_.x,_.y,w.x,w.y,S.x,S.y,V.x,V.y)&&Vo(V.prev,V,V.next)>=0)return!1;V=V.prevZ}for(;K&&K.z<=G;){if(K!==t.prev&&K!==t.next&&Wl(_.x,_.y,w.x,w.y,S.x,S.y,K.x,K.y)&&Vo(K.prev,K,K.next)>=0)return!1;K=K.nextZ}return!0}function mn(t,r,s){var d=t;do{var _=d.prev,w=d.next.next;!th(_,w)&&wp(_,d,d.next,w)&&gc(_,w)&&gc(w,_)&&(r.push(_.i/s),r.push(d.i/s),r.push(w.i/s),mc(d),mc(d.next),d=t=w),d=d.next}while(d!==t);return Lr(d)}function ei(t,r,s,d,_,w){var S=t;do{for(var A=S.next.next;A!==S.prev;){if(S.i!==A.i&&Lf(S,A)){var F=Ep(S,A);return S=Lr(S,S.next),F=Lr(F,F.next),Qr(S,r,s,d,_,w),void Qr(F,r,s,d,_,w)}A=A.next}S=S.next}while(S!==t)}function ai(t,r){return t.x-r.x}function Or(t,r){if(r=function(d,_){var w,S=_,A=d.x,F=d.y,U=-1/0;do{if(F<=S.y&&F>=S.next.y&&S.next.y!==S.y){var G=S.x+(F-S.y)*(S.next.x-S.x)/(S.next.y-S.y);if(G<=A&&G>U){if(U=G,G===A){if(F===S.y)return S;if(F===S.next.y)return S.next}w=S.x<S.next.x?S:S.next}}S=S.next}while(S!==_);if(!w)return null;if(A===U)return w;var V,K=w,at=w.x,Ct=w.y,_t=1/0;S=w;do{A>=S.x&&S.x>=at&&A!==S.x&&Wl(F<Ct?A:U,F,at,Ct,F<Ct?U:A,F,S.x,S.y)&&(V=Math.abs(F-S.y)/(A-S.x),gc(S,d)&&(V<_t||V===_t&&(S.x>w.x||S.x===w.x&&nt(w,S)))&&(w=S,_t=V)),S=S.next}while(S!==K);return w}(t,r)){var s=Ep(r,t);Lr(r,r.next),Lr(s,s.next)}}function nt(t,r){return Vo(t.prev,t,r.prev)<0&&Vo(r.next,t,t.next)<0}function dc(t,r,s,d,_){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-s)*_)|t<<8))|t<<4))|t<<2))|t<<1))|(r=1431655765&((r=858993459&((r=252645135&((r=16711935&((r=32767*(r-d)*_)|r<<8))|r<<4))|r<<2))|r<<1))<<1}function Af(t){var r=t,s=t;do{(r.x<s.x||r.x===s.x&&r.y<s.y)&&(s=r),r=r.next}while(r!==t);return s}function Wl(t,r,s,d,_,w,S,A){return(_-S)*(r-A)-(t-S)*(w-A)>=0&&(t-S)*(d-A)-(s-S)*(r-A)>=0&&(s-S)*(w-A)-(_-S)*(d-A)>=0}function Lf(t,r){return t.next.i!==r.i&&t.prev.i!==r.i&&!function(s,d){var _=s;do{if(_.i!==s.i&&_.next.i!==s.i&&_.i!==d.i&&_.next.i!==d.i&&wp(_,_.next,s,d))return!0;_=_.next}while(_!==s);return!1}(t,r)&&(gc(t,r)&&gc(r,t)&&function(s,d){var _=s,w=!1,S=(s.x+d.x)/2,A=(s.y+d.y)/2;do{_.y>A!=_.next.y>A&&_.next.y!==_.y&&S<(_.next.x-_.x)*(A-_.y)/(_.next.y-_.y)+_.x&&(w=!w),_=_.next}while(_!==s);return w}(t,r)&&(Vo(t.prev,t,r.prev)||Vo(t,r.prev,r))||th(t,r)&&Vo(t.prev,t,t.next)>0&&Vo(r.prev,r,r.next)>0)}function Vo(t,r,s){return(r.y-t.y)*(s.x-r.x)-(r.x-t.x)*(s.y-r.y)}function th(t,r){return t.x===r.x&&t.y===r.y}function wp(t,r,s,d){var _=Ah(Vo(t,r,s)),w=Ah(Vo(t,r,d)),S=Ah(Vo(s,d,t)),A=Ah(Vo(s,d,r));return _!==w&&S!==A||!(0!==_||!eh(t,s,r))||!(0!==w||!eh(t,d,r))||!(0!==S||!eh(s,t,d))||!(0!==A||!eh(s,r,d))}function eh(t,r,s){return r.x<=Math.max(t.x,s.x)&&r.x>=Math.min(t.x,s.x)&&r.y<=Math.max(t.y,s.y)&&r.y>=Math.min(t.y,s.y)}function Ah(t){return t>0?1:t<0?-1:0}function gc(t,r){return Vo(t.prev,t,t.next)<0?Vo(t,r,t.next)>=0&&Vo(t,t.prev,r)>=0:Vo(t,r,t.prev)<0||Vo(t,t.next,r)<0}function Ep(t,r){var s=new Lh(t.i,t.x,t.y),d=new Lh(r.i,r.x,r.y),_=t.next,w=r.prev;return t.next=r,r.prev=t,s.next=_,_.prev=s,d.next=s,s.prev=d,w.next=d,d.prev=w,d}function Sp(t,r,s,d){var _=new Lh(t,r,s);return d?(_.next=d.next,_.prev=d,d.next.prev=_,d.next=_):(_.prev=_,_.next=_),_}function mc(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function Lh(t,r,s){this.i=t,this.x=r,this.y=s,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Oh(t,r,s,d){for(var _=0,w=r,S=s-d;w<s;w+=d)_+=(t[S]-t[w])*(t[w+1]+t[S+1]),S=w;return _}function zd(t,r,s,d,_){!function w(S,A,F,U,G){for(;U>F;){if(U-F>600){var V=U-F+1,K=A-F+1,at=Math.log(V),Ct=.5*Math.exp(2*at/3),_t=.5*Math.sqrt(at*Ct*(V-Ct)/V)*(K-V/2<0?-1:1);w(S,A,Math.max(F,Math.floor(A-K*Ct/V+_t)),Math.min(U,Math.floor(A+(V-K)*Ct/V+_t)),G)}var Wt=S[A],Gt=F,pe=U;for(rh(S,F,A),G(S[U],Wt)>0&&rh(S,F,U);Gt<pe;){for(rh(S,Gt,pe),Gt++,pe--;G(S[Gt],Wt)<0;)Gt++;for(;G(S[pe],Wt)>0;)pe--}0===G(S[F],Wt)?rh(S,F,pe):rh(S,++pe,U),pe<=A&&(F=pe+1),A<=pe&&(U=pe-1)}}(t,r,s||0,d||t.length-1,_||Fd)}function rh(t,r,s){var d=t[r];t[r]=t[s],t[s]=d}function Fd(t,r){return t<r?-1:t>r?1:0}function Cp(t,r){var s=t.length;if(s<=1)return[t];for(var d,_,w=[],S=0;S<s;S++){var A=ct(t[S]);0!==A&&(t[S].area=Math.abs(A),void 0===_&&(_=A<0),_===A<0?(d&&w.push(d),d=[t[S]]):d.push(t[S]))}if(d&&w.push(d),r>1)for(var F=0;F<w.length;F++)w[F].length<=r||(zd(w[F],r,1,w[F].length-1,Ip),w[F]=w[F].slice(0,r));return w}function Ip(t,r){return r.area-t.area}function Dh(t,r,s){for(var d=s.patternDependencies,_=!1,w=0,S=r;w<S.length;w+=1){var A=S[w].paint.get(t+"-pattern");A.isConstant()||(_=!0);var F=A.constantOr(null);F&&(_=!0,d[F.to]=!0,d[F.from]=!0)}return _}function Pp(t,r,s,d,_){for(var w=_.patternDependencies,S=0,A=r;S<A.length;S+=1){var F=A[S],U=F.paint.get(t+"-pattern").value;if("constant"!==U.kind){var G=U.evaluate({zoom:d-1},s,{},_.availableImages),V=U.evaluate({zoom:d},s,{},_.availableImages),K=U.evaluate({zoom:d+1},s,{},_.availableImages);V=V&&V.name?V.name:V,K=K&&K.name?K.name:K,w[G=G&&G.name?G.name:G]=!0,w[V]=!0,w[K]=!0,s.patterns[F.id]={min:G,mid:V,max:K}}}return s}Qc.deviation=function(t,r,s,d){var _=r&&r.length,w=Math.abs(Oh(t,0,_?r[0]*s:t.length,s));if(_)for(var S=0,A=r.length;S<A;S++)w-=Math.abs(Oh(t,r[S]*s,S<A-1?r[S+1]*s:t.length,s));var F=0;for(S=0;S<d.length;S+=3){var U=d[S]*s,G=d[S+1]*s,V=d[S+2]*s;F+=Math.abs((t[U]-t[V])*(t[G+1]-t[U+1])-(t[U]-t[G])*(t[V+1]-t[U+1]))}return 0===w&&0===F?0:Math.abs((F-w)/w)},Qc.flatten=function(t){for(var r=t[0][0].length,s={vertices:[],holes:[],dimensions:r},d=0,_=0;_<t.length;_++){for(var w=0;w<t[_].length;w++)for(var S=0;S<r;S++)s.vertices.push(t[_][w][S]);_>0&&s.holes.push(d+=t[_-1].length)}return s},Th.default=Tf;var Mu=function(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(function(r){return r.id}),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Qo,this.indexArray=new Zt,this.indexArray2=new Xr,this.programConfigurations=new Vr(t.layers,t.zoom),this.segments=new lt,this.segments2=new lt,this.stateDependentLayerIds=this.layers.filter(function(r){return r.isStateDependent()}).map(function(r){return r.id})};Mu.prototype.populate=function(t,r,s){this.hasPattern=Dh("fill",this.layers,r);for(var d=this.layers[0].layout.get("fill-sort-key"),_=!d.isConstant(),w=[],S=0,A=t;S<A.length;S+=1){var F=A[S],U=F.feature,G=F.id,V=F.index,K=F.sourceLayerIndex,at=this.layers[0]._featureFilter.needGeometry,Ct=hn(U,at);if(this.layers[0]._featureFilter.filter(new ti(this.zoom),Ct,s)){var _t=_?d.evaluate(Ct,{},s,r.availableImages):void 0,Wt={id:G,properties:U.properties,type:U.type,sourceLayerIndex:K,index:V,geometry:at?Ct.geometry:$r(U),patterns:{},sortKey:_t};w.push(Wt)}}_&&w.sort(function(fr,Nr){return fr.sortKey-Nr.sortKey});for(var Gt=0,pe=w;Gt<pe.length;Gt+=1){var de=pe[Gt],Pe=de.geometry,ue=de.index,qe=de.sourceLayerIndex;if(this.hasPattern){var Ke=Pp("fill",this.layers,de,this.zoom,r);this.patternFeatures.push(Ke)}else this.addFeature(de,Pe,ue,s,{});r.featureIndex.insert(t[ue].feature,Pe,ue,qe,this.index)}},Mu.prototype.update=function(t,r,s){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,r,this.stateDependentLayers,s)},Mu.prototype.addFeatures=function(t,r,s){for(var d=0,_=this.patternFeatures;d<_.length;d+=1){var w=_[d];this.addFeature(w,w.geometry,w.index,r,s)}},Mu.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},Mu.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Mu.prototype.upload=function(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Mf),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.indexBuffer2=t.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(t),this.uploaded=!0},Mu.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())},Mu.prototype.addFeature=function(t,r,s,d,_){for(var w=0,S=Cp(r,500);w<S.length;w+=1){for(var A=S[w],F=0,U=0,G=A;U<G.length;U+=1)F+=G[U].length;for(var V=this.segments.prepareSegment(F,this.layoutVertexArray,this.indexArray),K=V.vertexLength,at=[],Ct=[],_t=0,Wt=A;_t<Wt.length;_t+=1){var Gt=Wt[_t];if(0!==Gt.length){Gt!==A[0]&&Ct.push(at.length/2);var pe=this.segments2.prepareSegment(Gt.length,this.layoutVertexArray,this.indexArray2),de=pe.vertexLength;this.layoutVertexArray.emplaceBack(Gt[0].x,Gt[0].y),this.indexArray2.emplaceBack(de+Gt.length-1,de),at.push(Gt[0].x),at.push(Gt[0].y);for(var Pe=1;Pe<Gt.length;Pe++)this.layoutVertexArray.emplaceBack(Gt[Pe].x,Gt[Pe].y),this.indexArray2.emplaceBack(de+Pe-1,de+Pe),at.push(Gt[Pe].x),at.push(Gt[Pe].y);pe.vertexLength+=Gt.length,pe.primitiveLength+=Gt.length}}for(var ue=Th(at,Ct),qe=0;qe<ue.length;qe+=3)this.indexArray.emplaceBack(K+ue[qe],K+ue[qe+1],K+ue[qe+2]);V.vertexLength+=F,V.primitiveLength+=ue.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,s,_,d)},nr("FillBucket",Mu,{omit:["layers","patternFeatures"]});var Bd=new Oo({"fill-sort-key":new Gr(xt.layout_fill["fill-sort-key"])}),nh={paint:new Oo({"fill-antialias":new vr(xt.paint_fill["fill-antialias"]),"fill-opacity":new Gr(xt.paint_fill["fill-opacity"]),"fill-color":new Gr(xt.paint_fill["fill-color"]),"fill-outline-color":new Gr(xt.paint_fill["fill-outline-color"]),"fill-translate":new vr(xt.paint_fill["fill-translate"]),"fill-translate-anchor":new vr(xt.paint_fill["fill-translate-anchor"]),"fill-pattern":new ho(xt.paint_fill["fill-pattern"])}),layout:Bd},Rh=function(t){function r(s){t.call(this,s,nh)}return t&&(r.__proto__=t),(r.prototype=Object.create(t&&t.prototype)).constructor=r,r.prototype.recalculate=function(s,d){t.prototype.recalculate.call(this,s,d);var _=this.paint._values["fill-outline-color"];"constant"===_.value.kind&&void 0===_.value.value&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])},r.prototype.createBucket=function(s){return new Mu(s)},r.prototype.queryRadius=function(){return vu(this.paint.get("fill-translate"))},r.prototype.queryIntersectsFeature=function(s,d,_,w,S,A,F){return ts(qs(s,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),A.angle,F),w)},r.prototype.isTileClipped=function(){return!0},r}(Wr),Of=oi([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4).members,Mp=Hl;function Hl(t,r,s,d,_){this.properties={},this.extent=s,this.type=0,this._pbf=t,this._geometry=-1,this._keys=d,this._values=_,t.readFields(Df,this,r)}function Df(t,r,s){1==t?r.id=s.readVarint():2==t?function(d,_){for(var w=d.readVarint()+d.pos;d.pos<w;){var S=_._keys[d.readVarint()],A=_._values[d.readVarint()];_.properties[S]=A}}(s,r):3==t?r.type=s.readVarint():4==t&&(r._geometry=s.pos)}function Rf(t){for(var r,s,d=0,_=0,w=t.length,S=w-1;_<w;S=_++)d+=((s=t[S]).x-(r=t[_]).x)*(r.y+s.y);return d}Hl.types=["Unknown","Point","LineString","Polygon"],Hl.prototype.loadGeometry=function(){var t=this._pbf;t.pos=this._geometry;for(var r,s=t.readVarint()+t.pos,d=1,_=0,w=0,S=0,A=[];t.pos<s;){if(_<=0){var F=t.readVarint();d=7&F,_=F>>3}if(_--,1===d||2===d)w+=t.readSVarint(),S+=t.readSVarint(),1===d&&(r&&A.push(r),r=[]),r.push(new Ft(w,S));else{if(7!==d)throw new Error("unknown command "+d);r&&r.push(r[0].clone())}}return r&&A.push(r),A},Hl.prototype.bbox=function(){var t=this._pbf;t.pos=this._geometry;for(var r=t.readVarint()+t.pos,s=1,d=0,_=0,w=0,S=1/0,A=-1/0,F=1/0,U=-1/0;t.pos<r;){if(d<=0){var G=t.readVarint();s=7&G,d=G>>3}if(d--,1===s||2===s)(_+=t.readSVarint())<S&&(S=_),_>A&&(A=_),(w+=t.readSVarint())<F&&(F=w),w>U&&(U=w);else if(7!==s)throw new Error("unknown command "+s)}return[S,F,A,U]},Hl.prototype.toGeoJSON=function(t,r,s){var d,_,w=this.extent*Math.pow(2,s),S=this.extent*t,A=this.extent*r,F=this.loadGeometry(),U=Hl.types[this.type];function G(at){for(var Ct=0;Ct<at.length;Ct++){var _t=at[Ct];at[Ct]=[360*(_t.x+S)/w-180,360/Math.PI*Math.atan(Math.exp((180-360*(_t.y+A)/w)*Math.PI/180))-90]}}switch(this.type){case 1:var V=[];for(d=0;d<F.length;d++)V[d]=F[d][0];G(F=V);break;case 2:for(d=0;d<F.length;d++)G(F[d]);break;case 3:for(F=function(at){var Ct=at.length;if(Ct<=1)return[at];for(var _t,Wt,Gt=[],pe=0;pe<Ct;pe++){var de=Rf(at[pe]);0!==de&&(void 0===Wt&&(Wt=de<0),Wt===de<0?(_t&&Gt.push(_t),_t=[at[pe]]):_t.push(at[pe]))}return _t&&Gt.push(_t),Gt}(F),d=0;d<F.length;d++)for(_=0;_<F[d].length;_++)G(F[d][_])}1===F.length?F=F[0]:U="Multi"+U;var K={type:"Feature",geometry:{type:U,coordinates:F},properties:this.properties};return"id"in this&&(K.id=this.id),K};var Tp=Nf;function Nf(t,r){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=t,this._keys=[],this._values=[],this._features=[],t.readFields(Ap,this,r),this.length=this._features.length}function Ap(t,r,s){15===t?r.version=s.readVarint():1===t?r.name=s.readString():5===t?r.extent=s.readVarint():2===t?r._features.push(s.pos):3===t?r._keys.push(s.readString()):4===t&&r._values.push(function(d){for(var _=null,w=d.readVarint()+d.pos;d.pos<w;){var S=d.readVarint()>>3;_=1===S?d.readString():2===S?d.readFloat():3===S?d.readDouble():4===S?d.readVarint64():5===S?d.readVarint():6===S?d.readSVarint():7===S?d.readBoolean():null}return _}(s))}function kf(t,r,s){if(3===t){var d=new Tp(s,s.readVarint()+s.pos);d.length&&(r[d.name]=d)}}Nf.prototype.feature=function(t){if(t<0||t>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[t];var r=this._pbf.readVarint()+this._pbf.pos;return new Mp(this._pbf,r,this.extent,this._keys,this._values)};var yc={VectorTile:function(t,r){this.layers=t.readFields(kf,{},r)},VectorTileFeature:Mp,VectorTileLayer:Tp},zf=yc.VectorTileFeature.types,vc=Math.pow(2,13);function _c(t,r,s,d,_,w,S,A){t.emplaceBack(r,s,2*Math.floor(d*vc)+S,_*vc*2,w*vc*2,Math.round(A))}var ou=function(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(function(r){return r.id}),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new va,this.indexArray=new Zt,this.programConfigurations=new Vr(t.layers,t.zoom),this.segments=new lt,this.stateDependentLayerIds=this.layers.filter(function(r){return r.isStateDependent()}).map(function(r){return r.id})};function Ff(t,r){return t.x===r.x&&(t.x<0||t.x>8192)||t.y===r.y&&(t.y<0||t.y>8192)}ou.prototype.populate=function(t,r,s){this.features=[],this.hasPattern=Dh("fill-extrusion",this.layers,r);for(var d=0,_=t;d<_.length;d+=1){var w=_[d],S=w.feature,A=w.id,F=w.index,U=w.sourceLayerIndex,G=this.layers[0]._featureFilter.needGeometry,V=hn(S,G);if(this.layers[0]._featureFilter.filter(new ti(this.zoom),V,s)){var K={id:A,sourceLayerIndex:U,index:F,geometry:G?V.geometry:$r(S),properties:S.properties,type:S.type,patterns:{}};this.hasPattern?this.features.push(Pp("fill-extrusion",this.layers,K,this.zoom,r)):this.addFeature(K,K.geometry,F,s,{}),r.featureIndex.insert(S,K.geometry,F,U,this.index,!0)}}},ou.prototype.addFeatures=function(t,r,s){for(var d=0,_=this.features;d<_.length;d+=1){var w=_[d];this.addFeature(w,w.geometry,w.index,r,s)}},ou.prototype.update=function(t,r,s){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,r,this.stateDependentLayers,s)},ou.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},ou.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},ou.prototype.upload=function(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Of),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0},ou.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},ou.prototype.addFeature=function(t,r,s,d,_){for(var w=0,S=Cp(r,500);w<S.length;w+=1){for(var A=S[w],F=0,U=0,G=A;U<G.length;U+=1)F+=G[U].length;for(var V=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray),K=0,at=A;K<at.length;K+=1){var Ct=at[K];if(0!==Ct.length&&!((Pn=Ct).every(function(yn){return yn.x<0})||Pn.every(function(yn){return yn.x>8192})||Pn.every(function(yn){return yn.y<0})||Pn.every(function(yn){return yn.y>8192})))for(var _t=0,Wt=0;Wt<Ct.length;Wt++){var Gt=Ct[Wt];if(Wt>=1){var pe=Ct[Wt-1];if(!Ff(Gt,pe)){V.vertexLength+4>lt.MAX_VERTEX_ARRAY_LENGTH&&(V=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));var de=Gt.sub(pe)._perp()._unit(),Pe=pe.dist(Gt);_t+Pe>32768&&(_t=0),_c(this.layoutVertexArray,Gt.x,Gt.y,de.x,de.y,0,0,_t),_c(this.layoutVertexArray,Gt.x,Gt.y,de.x,de.y,0,1,_t),_c(this.layoutVertexArray,pe.x,pe.y,de.x,de.y,0,0,_t+=Pe),_c(this.layoutVertexArray,pe.x,pe.y,de.x,de.y,0,1,_t);var ue=V.vertexLength;this.indexArray.emplaceBack(ue,ue+2,ue+1),this.indexArray.emplaceBack(ue+1,ue+2,ue+3),V.vertexLength+=4,V.primitiveLength+=2}}}}if(V.vertexLength+F>lt.MAX_VERTEX_ARRAY_LENGTH&&(V=this.segments.prepareSegment(F,this.layoutVertexArray,this.indexArray)),"Polygon"===zf[t.type]){for(var qe=[],Ke=[],fr=V.vertexLength,Nr=0,hr=A;Nr<hr.length;Nr+=1){var jr=hr[Nr];if(0!==jr.length){jr!==A[0]&&Ke.push(qe.length/2);for(var Qe=0;Qe<jr.length;Qe++){var _n=jr[Qe];_c(this.layoutVertexArray,_n.x,_n.y,0,0,1,1,0),qe.push(_n.x),qe.push(_n.y)}}}for(var en=Th(qe,Ke),Dr=0;Dr<en.length;Dr+=3)this.indexArray.emplaceBack(fr+en[Dr],fr+en[Dr+2],fr+en[Dr+1]);V.primitiveLength+=en.length/3,V.vertexLength+=F}}var Pn;this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,s,_,d)},nr("FillExtrusionBucket",ou,{omit:["layers","features"]});var Bf={paint:new Oo({"fill-extrusion-opacity":new vr(xt["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Gr(xt["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new vr(xt["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new vr(xt["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new ho(xt["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Gr(xt["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Gr(xt["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new vr(xt["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})},Lp=function(t){function r(s){t.call(this,s,Bf)}return t&&(r.__proto__=t),(r.prototype=Object.create(t&&t.prototype)).constructor=r,r.prototype.createBucket=function(s){return new ou(s)},r.prototype.queryRadius=function(){return vu(this.paint.get("fill-extrusion-translate"))},r.prototype.is3D=function(){return!0},r.prototype.queryIntersectsFeature=function(s,d,_,w,S,A,F,U){var G=qs(s,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),A.angle,F),V=this.paint.get("fill-extrusion-height").evaluate(d,_),K=this.paint.get("fill-extrusion-base").evaluate(d,_),at=function(_t,Wt,Gt,pe){for(var de=[],Pe=0,ue=_t;Pe<ue.length;Pe+=1){var qe=ue[Pe],Ke=[qe.x,qe.y,0,1];Xl(Ke,Ke,Wt),de.push(new Ft(Ke[0]/Ke[3],Ke[1]/Ke[3]))}return de}(G,U),Ct=function(_t,Wt,Gt,pe){for(var de=[],Pe=[],ue=pe[8]*Wt,qe=pe[9]*Wt,Ke=pe[10]*Wt,fr=pe[11]*Wt,Nr=pe[8]*Gt,hr=pe[9]*Gt,jr=pe[10]*Gt,Qe=pe[11]*Gt,_n=0,en=_t;_n<en.length;_n+=1){for(var Dr=[],Pn=[],yn=0,Zn=en[_n];yn<Zn.length;yn+=1){var Ur=Zn[yn],jn=Ur.x,Vi=Ur.y,io=pe[0]*jn+pe[4]*Vi+pe[12],Ki=pe[1]*jn+pe[5]*Vi+pe[13],Fi=pe[2]*jn+pe[6]*Vi+pe[14],Qi=pe[3]*jn+pe[7]*Vi+pe[15],Bi=Fi+Ke,ta=Qi+fr,Ga=io+Nr,ua=Ki+hr,Ra=Fi+jr,No=Qi+Qe,la=new Ft((io+ue)/ta,(Ki+qe)/ta);la.z=Bi/ta,Dr.push(la);var Dn=new Ft(Ga/No,ua/No);Dn.z=Ra/No,Pn.push(Dn)}de.push(Dr),Pe.push(Pn)}return[de,Pe]}(w,K,V,U);return function(_t,Wt,Gt){var pe=1/0;ts(Gt,Wt)&&(pe=Op(Gt,Wt[0]));for(var de=0;de<Wt.length;de++)for(var Pe=Wt[de],ue=_t[de],qe=0;qe<Pe.length-1;qe++){var Ke=Pe[qe],fr=[Ke,Pe[qe+1],ue[qe+1],ue[qe],Ke];xa(Gt,fr)&&(pe=Math.min(pe,Op(Gt,fr)))}return pe!==1/0&&pe}(Ct[0],Ct[1],at)},r}(Wr);function xc(t,r){return t.x*r.x+t.y*r.y}function Op(t,r){if(1===t.length){for(var s,d=0,_=r[d++];!s||_.equals(s);)if(!(s=r[d++]))return 1/0;for(;d<r.length;d++){var w=r[d],S=t[0],A=s.sub(_),F=w.sub(_),U=S.sub(_),G=xc(A,A),V=xc(A,F),K=xc(F,F),at=xc(U,A),Ct=xc(U,F),_t=G*K-V*V,Wt=(K*at-V*Ct)/_t,Gt=(G*Ct-V*at)/_t,pe=_.z*(1-Wt-Gt)+s.z*Wt+w.z*Gt;if(isFinite(pe))return pe}return 1/0}for(var de=1/0,Pe=0,ue=r;Pe<ue.length;Pe+=1)de=Math.min(de,ue[Pe].z);return de}var Uf=oi([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4).members,qf=oi([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]).members,Gf=yc.VectorTileFeature.types,Ud=Math.cos(Math.PI/180*37.5),Vf=Math.pow(2,14)/.5,ls=function(t){var r=this;this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(function(s){return s.id}),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(function(s){r.gradients[s.id]={}}),this.layoutVertexArray=new mu,this.layoutVertexArray2=new e,this.indexArray=new Zt,this.programConfigurations=new Vr(t.layers,t.zoom),this.segments=new lt,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(function(s){return s.isStateDependent()}).map(function(s){return s.id})};ls.prototype.populate=function(t,r,s){this.hasPattern=Dh("line",this.layers,r);for(var d=this.layers[0].layout.get("line-sort-key"),_=!d.isConstant(),w=[],S=0,A=t;S<A.length;S+=1){var F=A[S],U=F.feature,G=F.id,V=F.index,K=F.sourceLayerIndex,at=this.layers[0]._featureFilter.needGeometry,Ct=hn(U,at);if(this.layers[0]._featureFilter.filter(new ti(this.zoom),Ct,s)){var _t=_?d.evaluate(Ct,{},s):void 0,Wt={id:G,properties:U.properties,type:U.type,sourceLayerIndex:K,index:V,geometry:at?Ct.geometry:$r(U),patterns:{},sortKey:_t};w.push(Wt)}}_&&w.sort(function(fr,Nr){return fr.sortKey-Nr.sortKey});for(var Gt=0,pe=w;Gt<pe.length;Gt+=1){var de=pe[Gt],Pe=de.geometry,ue=de.index,qe=de.sourceLayerIndex;if(this.hasPattern){var Ke=Pp("line",this.layers,de,this.zoom,r);this.patternFeatures.push(Ke)}else this.addFeature(de,Pe,ue,s,{});r.featureIndex.insert(t[ue].feature,Pe,ue,qe,this.index)}},ls.prototype.update=function(t,r,s){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,r,this.stateDependentLayers,s)},ls.prototype.addFeatures=function(t,r,s){for(var d=0,_=this.patternFeatures;d<_.length;d+=1){var w=_[d];this.addFeature(w,w.geometry,w.index,r,s)}},ls.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},ls.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},ls.prototype.upload=function(t){this.uploaded||(0!==this.layoutVertexArray2.length&&(this.layoutVertexBuffer2=t.createVertexBuffer(this.layoutVertexArray2,qf)),this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Uf),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0},ls.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},ls.prototype.lineFeatureClips=function(t){if(t.properties&&t.properties.hasOwnProperty("mapbox_clip_start")&&t.properties.hasOwnProperty("mapbox_clip_end"))return{start:+t.properties.mapbox_clip_start,end:+t.properties.mapbox_clip_end}},ls.prototype.addFeature=function(t,r,s,d,_){var w=this.layers[0].layout,S=w.get("line-join").evaluate(t,{}),A=w.get("line-cap"),F=w.get("line-miter-limit"),U=w.get("line-round-limit");this.lineClips=this.lineFeatureClips(t);for(var G=0,V=r;G<V.length;G+=1)this.addLine(V[G],t,S,A,F,U);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,s,_,d)},ls.prototype.addLine=function(t,r,s,d,_,w){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(var S=0;S<t.length-1;S++)this.totalDistance+=t[S].dist(t[S+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}for(var A="Polygon"===Gf[r.type],F=t.length;F>=2&&t[F-1].equals(t[F-2]);)F--;for(var U=0;U<F-1&&t[U].equals(t[U+1]);)U++;if(!(F<(A?3:2))){"bevel"===s&&(_=1.05);var G,V=this.overscaling<=16?122880/(512*this.overscaling):0,K=this.segments.prepareSegment(10*F,this.layoutVertexArray,this.indexArray),at=void 0,Ct=void 0,_t=void 0,Wt=void 0;this.e1=this.e2=-1,A&&(Wt=t[U].sub(G=t[F-2])._unit()._perp());for(var Gt=U;Gt<F;Gt++)if(!(Ct=Gt===F-1?A?t[U+1]:void 0:t[Gt+1])||!t[Gt].equals(Ct)){Wt&&(_t=Wt),G&&(at=G),G=t[Gt],Wt=Ct?Ct.sub(G)._unit()._perp():_t;var pe=(_t=_t||Wt).add(Wt);0===pe.x&&0===pe.y||pe._unit();var de=_t.x*Wt.x+_t.y*Wt.y,Pe=pe.x*Wt.x+pe.y*Wt.y,ue=0!==Pe?1/Pe:1/0,qe=2*Math.sqrt(2-2*Pe),Ke=Pe<Ud&&at&&Ct,fr=_t.x*Wt.y-_t.y*Wt.x>0;if(Ke&&Gt>U){var Nr=G.dist(at);if(Nr>2*V){var hr=G.sub(G.sub(at)._mult(V/Nr)._round());this.updateDistance(at,hr),this.addCurrentVertex(hr,_t,0,0,K),at=hr}}var jr=at&&Ct,Qe=jr?s:A?"butt":d;if(jr&&"round"===Qe&&(ue<w?Qe="miter":ue<=2&&(Qe="fakeround")),"miter"===Qe&&ue>_&&(Qe="bevel"),"bevel"===Qe&&(ue>2&&(Qe="flipbevel"),ue<_&&(Qe="miter")),at&&this.updateDistance(at,G),"miter"===Qe)pe._mult(ue),this.addCurrentVertex(G,pe,0,0,K);else if("flipbevel"===Qe){if(ue>100)pe=Wt.mult(-1);else{var _n=ue*_t.add(Wt).mag()/_t.sub(Wt).mag();pe._perp()._mult(_n*(fr?-1:1))}this.addCurrentVertex(G,pe,0,0,K),this.addCurrentVertex(G,pe.mult(-1),0,0,K)}else if("bevel"===Qe||"fakeround"===Qe){var en=-Math.sqrt(ue*ue-1),Dr=fr?en:0,Pn=fr?0:en;if(at&&this.addCurrentVertex(G,_t,Dr,Pn,K),"fakeround"===Qe)for(var yn=Math.round(180*qe/Math.PI/20),Zn=1;Zn<yn;Zn++){var Ur=Zn/yn;if(.5!==Ur){var jn=Ur-.5;Ur+=Ur*jn*(Ur-1)*((1.0904+de*(de*(3.55645-1.43519*de)-3.2452))*jn*jn+(.848013+de*(.215638*de-1.06021)))}var Vi=Wt.sub(_t)._mult(Ur)._add(_t)._unit()._mult(fr?-1:1);this.addHalfVertex(G,Vi.x,Vi.y,!1,fr,0,K)}Ct&&this.addCurrentVertex(G,Wt,-Dr,-Pn,K)}else if("butt"===Qe)this.addCurrentVertex(G,pe,0,0,K);else if("square"===Qe){var io=at?1:-1;this.addCurrentVertex(G,pe,io,io,K)}else"round"===Qe&&(at&&(this.addCurrentVertex(G,_t,0,0,K),this.addCurrentVertex(G,_t,1,1,K,!0)),Ct&&(this.addCurrentVertex(G,Wt,-1,-1,K,!0),this.addCurrentVertex(G,Wt,0,0,K)));if(Ke&&Gt<F-1){var Ki=G.dist(Ct);if(Ki>2*V){var Fi=G.add(Ct.sub(G)._mult(V/Ki)._round());this.updateDistance(G,Fi),this.addCurrentVertex(Fi,Wt,0,0,K),G=Fi}}}}},ls.prototype.addCurrentVertex=function(t,r,s,d,_,w){void 0===w&&(w=!1);var S=r.y*d-r.x,A=-r.y-r.x*d;this.addHalfVertex(t,r.x+r.y*s,r.y-r.x*s,w,!1,s,_),this.addHalfVertex(t,S,A,w,!0,-d,_),this.distance>Vf/2&&0===this.totalDistance&&(this.distance=0,this.addCurrentVertex(t,r,s,d,_,w))},ls.prototype.addHalfVertex=function(t,r,s,d,_,w,S){var A=.5*(this.lineClips?this.scaledDistance*(Vf-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((t.x<<1)+(d?1:0),(t.y<<1)+(_?1:0),Math.round(63*r)+128,Math.round(63*s)+128,1+(0===w?0:w<0?-1:1)|(63&A)<<2,A>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);var F=S.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,F),S.primitiveLength++),_?this.e2=F:this.e1=F},ls.prototype.updateScaledDistance=function(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance},ls.prototype.updateDistance=function(t,r){this.distance+=t.dist(r),this.updateScaledDistance()},nr("LineBucket",ls,{omit:["layers","patternFeatures"]});var qd=new Oo({"line-cap":new vr(xt.layout_line["line-cap"]),"line-join":new Gr(xt.layout_line["line-join"]),"line-miter-limit":new vr(xt.layout_line["line-miter-limit"]),"line-round-limit":new vr(xt.layout_line["line-round-limit"]),"line-sort-key":new Gr(xt.layout_line["line-sort-key"])}),Dp={paint:new Oo({"line-opacity":new Gr(xt.paint_line["line-opacity"]),"line-color":new Gr(xt.paint_line["line-color"]),"line-translate":new vr(xt.paint_line["line-translate"]),"line-translate-anchor":new vr(xt.paint_line["line-translate-anchor"]),"line-width":new Gr(xt.paint_line["line-width"]),"line-gap-width":new Gr(xt.paint_line["line-gap-width"]),"line-offset":new Gr(xt.paint_line["line-offset"]),"line-blur":new Gr(xt.paint_line["line-blur"]),"line-dasharray":new $o(xt.paint_line["line-dasharray"]),"line-pattern":new ho(xt.paint_line["line-pattern"]),"line-gradient":new ya(xt.paint_line["line-gradient"])}),layout:qd},Rp=new(function(t){function r(){t.apply(this,arguments)}return t&&(r.__proto__=t),(r.prototype=Object.create(t&&t.prototype)).constructor=r,r.prototype.possiblyEvaluate=function(s,d){return d=new ti(Math.floor(d.zoom),{now:d.now,fadeDuration:d.fadeDuration,zoomHistory:d.zoomHistory,transition:d.transition}),t.prototype.possiblyEvaluate.call(this,s,d)},r.prototype.evaluate=function(s,d,_,w){return d=kt({},d,{zoom:Math.floor(d.zoom)}),t.prototype.evaluate.call(this,s,d,_,w)},r}(Gr))(Dp.paint.properties["line-width"].specification);Rp.useIntegerZoom=!0;var Zf=function(t){function r(s){t.call(this,s,Dp),this.gradientVersion=0}return t&&(r.__proto__=t),(r.prototype=Object.create(t&&t.prototype)).constructor=r,r.prototype._handleSpecialPaintPropertyUpdate=function(s){"line-gradient"===s&&(this.stepInterpolant=this._transitionablePaint._values["line-gradient"].value.expression._styleExpression.expression instanceof so,this.gradientVersion=(this.gradientVersion+1)%Ze)},r.prototype.gradientExpression=function(){return this._transitionablePaint._values["line-gradient"].value.expression},r.prototype.recalculate=function(s,d){t.prototype.recalculate.call(this,s,d),this.paint._values["line-floorwidth"]=Rp.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,s)},r.prototype.createBucket=function(s){return new ls(s)},r.prototype.queryRadius=function(s){var d=s,_=Np(Go("line-width",this,d),Go("line-gap-width",this,d)),w=Go("line-offset",this,d);return _/2+Math.abs(w)+vu(this.paint.get("line-translate"))},r.prototype.queryIntersectsFeature=function(s,d,_,w,S,A,F){var U=qs(s,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),A.angle,F),G=F/2*Np(this.paint.get("line-width").evaluate(d,_),this.paint.get("line-gap-width").evaluate(d,_)),V=this.paint.get("line-offset").evaluate(d,_);return V&&(w=function(K,at){for(var Ct=[],_t=new Ft(0,0),Wt=0;Wt<K.length;Wt++){for(var Gt=K[Wt],pe=[],de=0;de<Gt.length;de++){var Pe=Gt[de],ue=Gt[de+1],qe=0===de?_t:Pe.sub(Gt[de-1])._unit()._perp(),Ke=de===Gt.length-1?_t:ue.sub(Pe)._unit()._perp(),fr=qe._add(Ke)._unit();fr._mult(1/(fr.x*Ke.x+fr.y*Ke.y)),pe.push(fr._mult(at)._add(Pe))}Ct.push(pe)}return Ct}(w,V*F)),function(K,at,Ct){for(var _t=0;_t<at.length;_t++){var Wt=at[_t];if(K.length>=3)for(var Gt=0;Gt<Wt.length;Gt++)if(iu(K,Wt[Gt]))return!0;if(bl(K,Wt,Ct))return!0}return!1}(U,w,G)},r.prototype.isTileClipped=function(){return!0},r}(Wr);function Np(t,r){return r>0?r+2*t:t}var jf=oi([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),Xf=oi([{name:"a_projected_pos",components:3,type:"Float32"}],4),Yf=(oi([{name:"a_fade_opacity",components:1,type:"Uint32"}],4),oi([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}])),Nh=(oi([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]),oi([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4)),kh=oi([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function Wf(t,r,s){return t.sections.forEach(function(d){var _,S,A;d.text=(_=d.text,S=s,"uppercase"===(A=r.layout.get("text-transform").evaluate(S,{}))?_=_.toLocaleUpperCase():"lowercase"===A&&(_=_.toLocaleLowerCase()),Sn.applyArabicShaping&&(_=Sn.applyArabicShaping(_)),_)}),t}oi([{name:"triangle",components:3,type:"Uint16"}]),oi([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),oi([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),oi([{type:"Float32",name:"offsetX"}]),oi([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);var ih={"!":"\ufe15","#":"\uff03",$:"\uff04","%":"\uff05","&":"\uff06","(":"\ufe35",")":"\ufe36","*":"\uff0a","+":"\uff0b",",":"\ufe10","-":"\ufe32",".":"\u30fb","/":"\uff0f",":":"\ufe13",";":"\ufe14","<":"\ufe3f","=":"\uff1d",">":"\ufe40","?":"\ufe16","@":"\uff20","[":"\ufe47","\\":"\uff3c","]":"\ufe48","^":"\uff3e",_:"\ufe33","`":"\uff40","{":"\ufe37","|":"\u2015","}":"\ufe38","~":"\uff5e","\xa2":"\uffe0","\xa3":"\uffe1","\xa5":"\uffe5","\xa6":"\uffe4","\xac":"\uffe2","\xaf":"\uffe3","\u2013":"\ufe32","\u2014":"\ufe31","\u2018":"\ufe43","\u2019":"\ufe44","\u201c":"\ufe41","\u201d":"\ufe42","\u2026":"\ufe19","\u2027":"\u30fb","\u20a9":"\uffe6","\u3001":"\ufe11","\u3002":"\ufe12","\u3008":"\ufe3f","\u3009":"\ufe40","\u300a":"\ufe3d","\u300b":"\ufe3e","\u300c":"\ufe41","\u300d":"\ufe42","\u300e":"\ufe43","\u300f":"\ufe44","\u3010":"\ufe3b","\u3011":"\ufe3c","\u3014":"\ufe39","\u3015":"\ufe3a","\u3016":"\ufe17","\u3017":"\ufe18","\uff01":"\ufe15","\uff08":"\ufe35","\uff09":"\ufe36","\uff0c":"\ufe10","\uff0d":"\ufe32","\uff0e":"\u30fb","\uff1a":"\ufe13","\uff1b":"\ufe14","\uff1c":"\ufe3f","\uff1e":"\ufe40","\uff1f":"\ufe16","\uff3b":"\ufe47","\uff3d":"\ufe48","\uff3f":"\ufe33","\uff5b":"\ufe37","\uff5c":"\u2015","\uff5d":"\ufe38","\uff5f":"\ufe35","\uff60":"\ufe36","\uff61":"\ufe12","\uff62":"\ufe41","\uff63":"\ufe42"},zh=function(t,r,s,d,_){var w,S,A=8*_-d-1,F=(1<<A)-1,U=F>>1,G=-7,V=s?_-1:0,K=s?-1:1,at=t[r+V];for(V+=K,w=at&(1<<-G)-1,at>>=-G,G+=A;G>0;w=256*w+t[r+V],V+=K,G-=8);for(S=w&(1<<-G)-1,w>>=-G,G+=d;G>0;S=256*S+t[r+V],V+=K,G-=8);if(0===w)w=1-U;else{if(w===F)return S?NaN:1/0*(at?-1:1);S+=Math.pow(2,d),w-=U}return(at?-1:1)*S*Math.pow(2,w-d)},kp=function(t,r,s,d,_,w){var S,A,F,U=8*w-_-1,G=(1<<U)-1,V=G>>1,K=23===_?Math.pow(2,-24)-Math.pow(2,-77):0,at=d?0:w-1,Ct=d?1:-1,_t=r<0||0===r&&1/r<0?1:0;for(r=Math.abs(r),isNaN(r)||r===1/0?(A=isNaN(r)?1:0,S=G):(S=Math.floor(Math.log(r)/Math.LN2),r*(F=Math.pow(2,-S))<1&&(S--,F*=2),(r+=S+V>=1?K/F:K*Math.pow(2,1-V))*F>=2&&(S++,F/=2),S+V>=G?(A=0,S=G):S+V>=1?(A=(r*F-1)*Math.pow(2,_),S+=V):(A=r*Math.pow(2,V-1)*Math.pow(2,_),S=0));_>=8;t[s+at]=255&A,at+=Ct,A/=256,_-=8);for(S=S<<_|A,U+=_;U>0;t[s+at]=255&S,at+=Ct,S/=256,U-=8);t[s+at-Ct]|=128*_t},bc=Ti;function Ti(t){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(t)?t:new Uint8Array(t||0),this.pos=0,this.type=0,this.length=this.buf.length}Ti.Varint=0,Ti.Fixed64=1,Ti.Bytes=2,Ti.Fixed32=5;var Fh="undefined"==typeof TextDecoder?null:new TextDecoder("utf8");function Qu(t){return t.type===Ti.Bytes?t.readVarint()+t.pos:t.pos+1}function Hf(t,r,s){var d=r<=16383?1:r<=2097151?2:r<=268435455?3:Math.floor(Math.log(r)/(7*Math.LN2));s.realloc(d);for(var _=s.pos-1;_>=t;_--)s.buf[_+d]=s.buf[_]}function Gd(t,r){for(var s=0;s<t.length;s++)r.writeVarint(t[s])}function Vd(t,r){for(var s=0;s<t.length;s++)r.writeSVarint(t[s])}function Zd(t,r){for(var s=0;s<t.length;s++)r.writeFloat(t[s])}function jd(t,r){for(var s=0;s<t.length;s++)r.writeDouble(t[s])}function Xd(t,r){for(var s=0;s<t.length;s++)r.writeBoolean(t[s])}function Yd(t,r){for(var s=0;s<t.length;s++)r.writeFixed32(t[s])}function Wd(t,r){for(var s=0;s<t.length;s++)r.writeSFixed32(t[s])}function Hd(t,r){for(var s=0;s<t.length;s++)r.writeFixed64(t[s])}function Jd(t,r){for(var s=0;s<t.length;s++)r.writeSFixed64(t[s])}function oh(t,r){return(t[r]|t[r+1]<<8|t[r+2]<<16)+16777216*t[r+3]}function Pl(t,r,s){t[s]=r,t[s+1]=r>>>8,t[s+2]=r>>>16,t[s+3]=r>>>24}function Jf(t,r){return(t[r]|t[r+1]<<8|t[r+2]<<16)+(t[r+3]<<24)}function zp(t,r,s){1===t&&s.readMessage(Kf,r)}function Kf(t,r,s){if(3===t){var d=s.readMessage(ah,{}),_=d.width,w=d.height,S=d.left,A=d.top,F=d.advance;r.push({id:d.id,bitmap:new Il({width:_+6,height:w+6},d.bitmap),metrics:{width:_,height:w,left:S,top:A,advance:F}})}}function ah(t,r,s){1===t?r.id=s.readVarint():2===t?r.bitmap=s.readBytes():3===t?r.width=s.readVarint():4===t?r.height=s.readVarint():5===t?r.left=s.readSVarint():6===t?r.top=s.readSVarint():7===t&&(r.advance=s.readVarint())}function Ml(t){for(var r=0,s=0,d=0,_=t;d<_.length;d+=1){var w=_[d];r+=w.w*w.h,s=Math.max(s,w.w)}t.sort(function(_t,Wt){return Wt.h-_t.h});for(var S=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(r/.95)),s),h:1/0}],A=0,F=0,U=0,G=t;U<G.length;U+=1)for(var V=G[U],K=S.length-1;K>=0;K--){var at=S[K];if(!(V.w>at.w||V.h>at.h)){if(V.x=at.x,V.y=at.y,F=Math.max(F,V.y+V.h),A=Math.max(A,V.x+V.w),V.w===at.w&&V.h===at.h){var Ct=S.pop();K<S.length&&(S[K]=Ct)}else V.h===at.h?(at.x+=V.w,at.w-=V.w):V.w===at.w?(at.y+=V.h,at.h-=V.h):(S.push({x:at.x+V.w,y:at.y,w:at.w-V.w,h:V.h}),at.y+=V.h,at.h-=V.h);break}}return{w:A,h:F,fill:r/(A*F)||0}}Ti.prototype={destroy:function(){this.buf=null},readFields:function(t,r,s){for(s=s||this.length;this.pos<s;){var d=this.readVarint(),_=d>>3,w=this.pos;this.type=7&d,t(_,r,this),this.pos===w&&this.skip(d)}return r},readMessage:function(t,r){return this.readFields(t,r,this.readVarint()+this.pos)},readFixed32:function(){var t=oh(this.buf,this.pos);return this.pos+=4,t},readSFixed32:function(){var t=Jf(this.buf,this.pos);return this.pos+=4,t},readFixed64:function(){var t=oh(this.buf,this.pos)+4294967296*oh(this.buf,this.pos+4);return this.pos+=8,t},readSFixed64:function(){var t=oh(this.buf,this.pos)+4294967296*Jf(this.buf,this.pos+4);return this.pos+=8,t},readFloat:function(){var t=zh(this.buf,this.pos,!0,23,4);return this.pos+=4,t},readDouble:function(){var t=zh(this.buf,this.pos,!0,52,8);return this.pos+=8,t},readVarint:function(t){var r,s,d=this.buf;return r=127&(s=d[this.pos++]),s<128?r:(r|=(127&(s=d[this.pos++]))<<7,s<128?r:(r|=(127&(s=d[this.pos++]))<<14,s<128?r:(r|=(127&(s=d[this.pos++]))<<21,s<128?r:function(_,w,S){var A,F,U=S.buf;if(A=(112&(F=U[S.pos++]))>>4,F<128||(A|=(127&(F=U[S.pos++]))<<3,F<128)||(A|=(127&(F=U[S.pos++]))<<10,F<128)||(A|=(127&(F=U[S.pos++]))<<17,F<128)||(A|=(127&(F=U[S.pos++]))<<24,F<128)||(A|=(1&(F=U[S.pos++]))<<31,F<128))return function(t,r,s){return s?4294967296*r+(t>>>0):4294967296*(r>>>0)+(t>>>0)}(_,A,w);throw new Error("Expected varint not more than 10 bytes")}(r|=(15&(s=d[this.pos]))<<28,t,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var t=this.readVarint();return t%2==1?(t+1)/-2:t/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var t=this.readVarint()+this.pos,r=this.pos;return this.pos=t,t-r>=12&&Fh?Fh.decode(this.buf.subarray(r,t)):function(s,d,_){for(var w="",S=d;S<_;){var A,F,U,G=s[S],V=null,K=G>239?4:G>223?3:G>191?2:1;if(S+K>_)break;1===K?G<128&&(V=G):2===K?128==(192&(A=s[S+1]))&&(V=(31&G)<<6|63&A)<=127&&(V=null):3===K?(F=s[S+2],128==(192&(A=s[S+1]))&&128==(192&F)&&((V=(15&G)<<12|(63&A)<<6|63&F)<=2047||V>=55296&&V<=57343)&&(V=null)):4===K&&(F=s[S+2],U=s[S+3],128==(192&(A=s[S+1]))&&128==(192&F)&&128==(192&U)&&((V=(15&G)<<18|(63&A)<<12|(63&F)<<6|63&U)<=65535||V>=1114112)&&(V=null)),null===V?(V=65533,K=1):V>65535&&(V-=65536,w+=String.fromCharCode(V>>>10&1023|55296),V=56320|1023&V),w+=String.fromCharCode(V),S+=K}return w}(this.buf,r,t)},readBytes:function(){var t=this.readVarint()+this.pos,r=this.buf.subarray(this.pos,t);return this.pos=t,r},readPackedVarint:function(t,r){if(this.type!==Ti.Bytes)return t.push(this.readVarint(r));var s=Qu(this);for(t=t||[];this.pos<s;)t.push(this.readVarint(r));return t},readPackedSVarint:function(t){if(this.type!==Ti.Bytes)return t.push(this.readSVarint());var r=Qu(this);for(t=t||[];this.pos<r;)t.push(this.readSVarint());return t},readPackedBoolean:function(t){if(this.type!==Ti.Bytes)return t.push(this.readBoolean());var r=Qu(this);for(t=t||[];this.pos<r;)t.push(this.readBoolean());return t},readPackedFloat:function(t){if(this.type!==Ti.Bytes)return t.push(this.readFloat());var r=Qu(this);for(t=t||[];this.pos<r;)t.push(this.readFloat());return t},readPackedDouble:function(t){if(this.type!==Ti.Bytes)return t.push(this.readDouble());var r=Qu(this);for(t=t||[];this.pos<r;)t.push(this.readDouble());return t},readPackedFixed32:function(t){if(this.type!==Ti.Bytes)return t.push(this.readFixed32());var r=Qu(this);for(t=t||[];this.pos<r;)t.push(this.readFixed32());return t},readPackedSFixed32:function(t){if(this.type!==Ti.Bytes)return t.push(this.readSFixed32());var r=Qu(this);for(t=t||[];this.pos<r;)t.push(this.readSFixed32());return t},readPackedFixed64:function(t){if(this.type!==Ti.Bytes)return t.push(this.readFixed64());var r=Qu(this);for(t=t||[];this.pos<r;)t.push(this.readFixed64());return t},readPackedSFixed64:function(t){if(this.type!==Ti.Bytes)return t.push(this.readSFixed64());var r=Qu(this);for(t=t||[];this.pos<r;)t.push(this.readSFixed64());return t},skip:function(t){var r=7&t;if(r===Ti.Varint)for(;this.buf[this.pos++]>127;);else if(r===Ti.Bytes)this.pos=this.readVarint()+this.pos;else if(r===Ti.Fixed32)this.pos+=4;else{if(r!==Ti.Fixed64)throw new Error("Unimplemented type: "+r);this.pos+=8}},writeTag:function(t,r){this.writeVarint(t<<3|r)},realloc:function(t){for(var r=this.length||16;r<this.pos+t;)r*=2;if(r!==this.length){var s=new Uint8Array(r);s.set(this.buf),this.buf=s,this.length=r}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(t){this.realloc(4),Pl(this.buf,t,this.pos),this.pos+=4},writeSFixed32:function(t){this.realloc(4),Pl(this.buf,t,this.pos),this.pos+=4},writeFixed64:function(t){this.realloc(8),Pl(this.buf,-1&t,this.pos),Pl(this.buf,Math.floor(t*(1/4294967296)),this.pos+4),this.pos+=8},writeSFixed64:function(t){this.realloc(8),Pl(this.buf,-1&t,this.pos),Pl(this.buf,Math.floor(t*(1/4294967296)),this.pos+4),this.pos+=8},writeVarint:function(t){(t=+t||0)>268435455||t<0?function(r,s){var d,_,w,A;if(r>=0?(d=r%4294967296|0,_=r/4294967296|0):(_=~(-r/4294967296),4294967295^(d=~(-r%4294967296))?d=d+1|0:(d=0,_=_+1|0)),r>=0x10000000000000000||r<-0x10000000000000000)throw new Error("Given varint doesn't fit into 10 bytes");s.realloc(10),w=d,(A=s).buf[A.pos++]=127&w|128,w>>>=7,A.buf[A.pos++]=127&w|128,w>>>=7,A.buf[A.pos++]=127&w|128,w>>>=7,A.buf[A.pos++]=127&w|128,A.buf[A.pos]=127&(w>>>=7),function(w,S){var A=(7&w)<<4;S.buf[S.pos++]|=A|((w>>>=3)?128:0),w&&(S.buf[S.pos++]=127&w|((w>>>=7)?128:0),w&&(S.buf[S.pos++]=127&w|((w>>>=7)?128:0),w&&(S.buf[S.pos++]=127&w|((w>>>=7)?128:0),w&&(S.buf[S.pos++]=127&w|((w>>>=7)?128:0),w&&(S.buf[S.pos++]=127&w)))))}(_,s)}(t,this):(this.realloc(4),this.buf[this.pos++]=127&t|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=t>>>7&127))))},writeSVarint:function(t){this.writeVarint(t<0?2*-t-1:2*t)},writeBoolean:function(t){this.writeVarint(Boolean(t))},writeString:function(t){t=String(t),this.realloc(4*t.length),this.pos++;var r=this.pos;this.pos=function(d,_,w){for(var S,A,F=0;F<_.length;F++){if((S=_.charCodeAt(F))>55295&&S<57344){if(!A){S>56319||F+1===_.length?(d[w++]=239,d[w++]=191,d[w++]=189):A=S;continue}if(S<56320){d[w++]=239,d[w++]=191,d[w++]=189,A=S;continue}S=A-55296<<10|S-56320|65536,A=null}else A&&(d[w++]=239,d[w++]=191,d[w++]=189,A=null);S<128?d[w++]=S:(S<2048?d[w++]=S>>6|192:(S<65536?d[w++]=S>>12|224:(d[w++]=S>>18|240,d[w++]=S>>12&63|128),d[w++]=S>>6&63|128),d[w++]=63&S|128)}return w}(this.buf,t,this.pos);var s=this.pos-r;s>=128&&Hf(r,s,this),this.pos=r-1,this.writeVarint(s),this.pos+=s},writeFloat:function(t){this.realloc(4),kp(this.buf,t,this.pos,!0,23,4),this.pos+=4},writeDouble:function(t){this.realloc(8),kp(this.buf,t,this.pos,!0,52,8),this.pos+=8},writeBytes:function(t){var r=t.length;this.writeVarint(r),this.realloc(r);for(var s=0;s<r;s++)this.buf[this.pos++]=t[s]},writeRawMessage:function(t,r){this.pos++;var s=this.pos;t(r,this);var d=this.pos-s;d>=128&&Hf(s,d,this),this.pos=s-1,this.writeVarint(d),this.pos+=d},writeMessage:function(t,r,s){this.writeTag(t,Ti.Bytes),this.writeRawMessage(r,s)},writePackedVarint:function(t,r){r.length&&this.writeMessage(t,Gd,r)},writePackedSVarint:function(t,r){r.length&&this.writeMessage(t,Vd,r)},writePackedBoolean:function(t,r){r.length&&this.writeMessage(t,Xd,r)},writePackedFloat:function(t,r){r.length&&this.writeMessage(t,Zd,r)},writePackedDouble:function(t,r){r.length&&this.writeMessage(t,jd,r)},writePackedFixed32:function(t,r){r.length&&this.writeMessage(t,Yd,r)},writePackedSFixed32:function(t,r){r.length&&this.writeMessage(t,Wd,r)},writePackedFixed64:function(t,r){r.length&&this.writeMessage(t,Hd,r)},writePackedSFixed64:function(t,r){r.length&&this.writeMessage(t,Jd,r)},writeBytesField:function(t,r){this.writeTag(t,Ti.Bytes),this.writeBytes(r)},writeFixed32Field:function(t,r){this.writeTag(t,Ti.Fixed32),this.writeFixed32(r)},writeSFixed32Field:function(t,r){this.writeTag(t,Ti.Fixed32),this.writeSFixed32(r)},writeFixed64Field:function(t,r){this.writeTag(t,Ti.Fixed64),this.writeFixed64(r)},writeSFixed64Field:function(t,r){this.writeTag(t,Ti.Fixed64),this.writeSFixed64(r)},writeVarintField:function(t,r){this.writeTag(t,Ti.Varint),this.writeVarint(r)},writeSVarintField:function(t,r){this.writeTag(t,Ti.Varint),this.writeSVarint(r)},writeStringField:function(t,r){this.writeTag(t,Ti.Bytes),this.writeString(r)},writeFloatField:function(t,r){this.writeTag(t,Ti.Fixed32),this.writeFloat(r)},writeDoubleField:function(t,r){this.writeTag(t,Ti.Fixed64),this.writeDouble(r)},writeBooleanField:function(t,r){this.writeVarintField(t,Boolean(r))}};var Tl=function(t,r){var s=r.pixelRatio,d=r.version,_=r.stretchX,w=r.stretchY,S=r.content;this.paddedRect=t,this.pixelRatio=s,this.stretchX=_,this.stretchY=w,this.content=S,this.version=d},Jl={tl:{configurable:!0},br:{configurable:!0},tlbr:{configurable:!0},displaySize:{configurable:!0}};Jl.tl.get=function(){return[this.paddedRect.x+1,this.paddedRect.y+1]},Jl.br.get=function(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]},Jl.tlbr.get=function(){return this.tl.concat(this.br)},Jl.displaySize.get=function(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]},Object.defineProperties(Tl.prototype,Jl);var sh=function(t,r){var s={},d={};this.haveRenderCallbacks=[];var _=[];this.addImages(t,s,_),this.addImages(r,d,_);var w=Ml(_),S=new us({width:w.w||1,height:w.h||1});for(var A in t){var F=t[A],U=s[A].paddedRect;us.copy(F.data,S,{x:0,y:0},{x:U.x+1,y:U.y+1},F.data)}for(var G in r){var V=r[G],K=d[G].paddedRect,at=K.x+1,Ct=K.y+1,_t=V.data.width,Wt=V.data.height;us.copy(V.data,S,{x:0,y:0},{x:at,y:Ct},V.data),us.copy(V.data,S,{x:0,y:Wt-1},{x:at,y:Ct-1},{width:_t,height:1}),us.copy(V.data,S,{x:0,y:0},{x:at,y:Ct+Wt},{width:_t,height:1}),us.copy(V.data,S,{x:_t-1,y:0},{x:at-1,y:Ct},{width:1,height:Wt}),us.copy(V.data,S,{x:0,y:0},{x:at+_t,y:Ct},{width:1,height:Wt})}this.image=S,this.iconPositions=s,this.patternPositions=d};sh.prototype.addImages=function(t,r,s){for(var d in t){var _=t[d],w={x:0,y:0,w:_.data.width+2,h:_.data.height+2};s.push(w),r[d]=new Tl(w,_),_.hasRenderCallback&&this.haveRenderCallbacks.push(d)}},sh.prototype.patchUpdatedImages=function(t,r){for(var s in t.dispatchRenderCallbacks(this.haveRenderCallbacks),t.updatedImages)this.patchUpdatedImage(this.iconPositions[s],t.getImage(s),r),this.patchUpdatedImage(this.patternPositions[s],t.getImage(s),r)},sh.prototype.patchUpdatedImage=function(t,r,s){if(t&&r&&t.version!==r.version){t.version=r.version;var d=t.tl;s.update(r.data,void 0,{x:d[0],y:d[1]})}},nr("ImagePosition",Tl),nr("ImageAtlas",sh);var Rs={horizontal:1,vertical:2,horizontalOnly:3},Ec=function(){this.scale=1,this.fontStack="",this.imageName=null};Ec.forText=function(t,r){var s=new Ec;return s.scale=t||1,s.fontStack=r,s},Ec.forImage=function(t){var r=new Ec;return r.imageName=t,r};var ba=function(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null};function Al(t,r,s,d,_,w,S,A,F,U,G,V,K,at,Ct,_t){var Wt,Gt=ba.fromFeature(t,_);V===Rs.vertical&&Gt.verticalizePunctuation();var pe=Sn.processBidirectionalText,de=Sn.processStyledBidirectionalText;if(pe&&1===Gt.sections.length){Wt=[];for(var Pe=0,ue=pe(Gt.toString(),$l(Gt,U,w,r,d,at,Ct));Pe<ue.length;Pe+=1){var qe=ue[Pe],Ke=new ba;Ke.text=qe,Ke.sections=Gt.sections;for(var fr=0;fr<qe.length;fr++)Ke.sectionIndex.push(0);Wt.push(Ke)}}else if(de){Wt=[];for(var Nr=0,hr=de(Gt.text,Gt.sectionIndex,$l(Gt,U,w,r,d,at,Ct));Nr<hr.length;Nr+=1){var jr=hr[Nr],Qe=new ba;Qe.text=jr[0],Qe.sectionIndex=jr[1],Qe.sections=Gt.sections,Wt.push(Qe)}}else Wt=function(Dr,Pn){for(var yn=[],Zn=Dr.text,Ur=0,jn=0,Vi=Pn;jn<Vi.length;jn+=1){var io=Vi[jn];yn.push(Dr.substring(Ur,io)),Ur=io}return Ur<Zn.length&&yn.push(Dr.substring(Ur,Zn.length)),yn}(Gt,$l(Gt,U,w,r,d,at,Ct));var _n=[],en={positionedLines:_n,text:Gt.toString(),top:G[1],bottom:G[1],left:G[0],right:G[0],writingMode:V,iconsInText:!1,verticalizable:!1};return function(Dr,Pn,yn,Zn,Ur,jn,Vi,io,Ki,Fi,Qi,Bi){for(var ta=0,Ga=-17,ua=0,Ra=0,No="right"===io?1:"left"===io?0:.5,la=0,Dn=0,Ai=Ur;Dn<Ai.length;Dn+=1){var si=Ai[Dn];si.trim();var Kn=si.getMaxScale(),cs=24*(Kn-1),ca={positionedGlyphs:[],lineOffset:0};Dr.positionedLines[la]=ca;var En=ca.positionedGlyphs,hi=0;if(si.length()){for(var ri=0;ri<si.length();ri++){var In=si.getSection(ri),hs=si.getSectionIndex(ri),Es=si.getCharCode(ri),_u=0,Zi=null,Ns=null,Na=null,ks=24,Ss=!(Ki===Rs.horizontal||!Qi&&!Ju(Es)||Qi&&(tl[Es]||(Vu=Es,gr.Arabic(Vu)||gr["Arabic Supplement"](Vu)||gr["Arabic Extended-A"](Vu)||gr["Arabic Presentation Forms-A"](Vu)||gr["Arabic Presentation Forms-B"](Vu))));if(In.imageName){var rl=Zn[In.imageName];if(!rl)continue;Na=In.imageName,Dr.iconsInText=Dr.iconsInText||!0,Ns=rl.paddedRect;var Lu=rl.displaySize;In.scale=24*In.scale/Bi,_u=cs+(24-Lu[1]*In.scale),ks=(Zi={width:Lu[0],height:Lu[1],left:1,top:-3,advance:Ss?Lu[1]:Lu[0]}).advance;var Rl=Ss?Lu[0]*In.scale-24*Kn:Lu[1]*In.scale-24*Kn;Rl>0&&Rl>hi&&(hi=Rl)}else{var Lc=yn[In.fontStack],Nl=Lc&&Lc[Es];if(Nl&&Nl.rect)Ns=Nl.rect,Zi=Nl.metrics;else{var Oc=Pn[In.fontStack],mh=Oc&&Oc[Es];if(!mh)continue;Zi=mh.metrics}_u=24*(Kn-In.scale)}Ss?(Dr.verticalizable=!0,En.push({glyph:Es,imageName:Na,x:ta,y:Ga+_u,vertical:Ss,scale:In.scale,fontStack:In.fontStack,sectionIndex:hs,metrics:Zi,rect:Ns}),ta+=ks*In.scale+Fi):(En.push({glyph:Es,imageName:Na,x:ta,y:Ga+_u,vertical:Ss,scale:In.scale,fontStack:In.fontStack,sectionIndex:hs,metrics:Zi,rect:Ns}),ta+=Zi.advance*In.scale+Fi)}0!==En.length&&(ua=Math.max(ta-Fi,ua),$f(En,0,En.length-1,No,hi)),ta=0;var ps=jn*Kn+hi;ca.lineOffset=Math.max(hi,cs),Ga+=ps,Ra=Math.max(ps,Ra),++la}else Ga+=jn,++la}var Vu,ac=Ga- -17,Dc=qh(Vi),au=Dc.horizontalAlign,Zu=Dc.verticalAlign;(function(kl,zl,nl,il,Fl,ol,Bl,Ul,sc){var ql,Rc=(zl-nl)*Fl;ql=ol!==Bl?-Ul*il- -17:(-il*sc+.5)*Bl;for(var Ea=0,ka=kl;Ea<ka.length;Ea+=1)for(var ha=0,Cs=ka[Ea].positionedGlyphs;ha<Cs.length;ha+=1){var al=Cs[ha];al.x+=Rc,al.y+=ql}})(Dr.positionedLines,No,au,Zu,ua,Ra,jn,ac,Ur.length),Dr.top+=-Zu*ac,Dr.bottom=Dr.top+ac,Dr.left+=-au*ua,Dr.right=Dr.left+ua}(en,r,s,d,Wt,S,A,F,V,U,K,_t),!function(Dr){for(var Pn=0,yn=Dr;Pn<yn.length;Pn+=1)if(0!==yn[Pn].positionedGlyphs.length)return!1;return!0}(_n)&&en}ba.fromFeature=function(t,r){for(var s=new ba,d=0;d<t.sections.length;d++){var _=t.sections[d];_.image?s.addImageSection(_):s.addTextSection(_,r)}return s},ba.prototype.length=function(){return this.text.length},ba.prototype.getSection=function(t){return this.sections[this.sectionIndex[t]]},ba.prototype.getSectionIndex=function(t){return this.sectionIndex[t]},ba.prototype.getCharCode=function(t){return this.text.charCodeAt(t)},ba.prototype.verticalizePunctuation=function(){this.text=function(t){for(var r="",s=0;s<t.length;s++){var d=t.charCodeAt(s+1)||null,_=t.charCodeAt(s-1)||null;r+=d&&$a(d)&&!ih[t[s+1]]||_&&$a(_)&&!ih[t[s-1]]||!ih[t[s]]?t[s]:ih[t[s]]}return r}(this.text)},ba.prototype.trim=function(){for(var t=0,r=0;r<this.text.length&&tl[this.text.charCodeAt(r)];r++)t++;for(var s=this.text.length,d=this.text.length-1;d>=0&&d>=t&&tl[this.text.charCodeAt(d)];d--)s--;this.text=this.text.substring(t,s),this.sectionIndex=this.sectionIndex.slice(t,s)},ba.prototype.substring=function(t,r){var s=new ba;return s.text=this.text.substring(t,r),s.sectionIndex=this.sectionIndex.slice(t,r),s.sections=this.sections,s},ba.prototype.toString=function(){return this.text},ba.prototype.getMaxScale=function(){var t=this;return this.sectionIndex.reduce(function(r,s){return Math.max(r,t.sections[s].scale)},0)},ba.prototype.addTextSection=function(t,r){this.text+=t.text,this.sections.push(Ec.forText(t.scale,t.fontStack||r));for(var s=this.sections.length-1,d=0;d<t.text.length;++d)this.sectionIndex.push(s)},ba.prototype.addImageSection=function(t){var r=t.image?t.image.name:"";if(0!==r.length){var s=this.getNextImageSectionCharCode();s?(this.text+=String.fromCharCode(s),this.sections.push(Ec.forImage(r)),this.sectionIndex.push(this.sections.length-1)):bt("Reached maximum number of images 6401")}else bt("Can't add FormattedSection with an empty image.")},ba.prototype.getNextImageSectionCharCode=function(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)};var tl={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},Da={};function Bh(t,r,s,d,_,w){if(r.imageName){var S=d[r.imageName];return S?S.displaySize[0]*r.scale*24/w+_:0}var A=s[r.fontStack],F=A&&A[t];return F?F.metrics.advance*r.scale+_:0}function Uh(t,r,s,d){var _=Math.pow(t-r,2);return d?t<r?_/2:2*_:_+Math.abs(s)*s}function Sc(t,r,s){var d=0;return 10===t&&(d-=1e4),s&&(d+=150),40!==t&&65288!==t||(d+=50),41!==r&&65289!==r||(d+=50),d}function Kl(t,r,s,d,_,w){for(var S=null,A=Uh(r,s,_,w),F=0,U=d;F<U.length;F+=1){var G=U[F],V=Uh(r-G.x,s,_,w)+G.badness;V<=A&&(S=G,A=V)}return{index:t,x:r,priorBreak:S,badness:A}}function $l(t,r,s,d,_,w,S){if("point"!==w)return[];if(!t)return[];for(var A,F=[],U=function(Wt,Gt,pe,de,Pe,ue){for(var qe=0,Ke=0;Ke<Wt.length();Ke++){var fr=Wt.getSection(Ke);qe+=Bh(Wt.getCharCode(Ke),fr,de,Pe,Gt,ue)}return qe/Math.max(1,Math.ceil(qe/pe))}(t,r,s,d,_,S),G=t.text.indexOf("\u200b")>=0,V=0,K=0;K<t.length();K++){var at=t.getSection(K),Ct=t.getCharCode(K);if(tl[Ct]||(V+=Bh(Ct,at,d,_,r,S)),K<t.length()-1){var _t=!((A=Ct)<11904||!(gr["Bopomofo Extended"](A)||gr.Bopomofo(A)||gr["CJK Compatibility Forms"](A)||gr["CJK Compatibility Ideographs"](A)||gr["CJK Compatibility"](A)||gr["CJK Radicals Supplement"](A)||gr["CJK Strokes"](A)||gr["CJK Symbols and Punctuation"](A)||gr["CJK Unified Ideographs Extension A"](A)||gr["CJK Unified Ideographs"](A)||gr["Enclosed CJK Letters and Months"](A)||gr["Halfwidth and Fullwidth Forms"](A)||gr.Hiragana(A)||gr["Ideographic Description Characters"](A)||gr["Kangxi Radicals"](A)||gr["Katakana Phonetic Extensions"](A)||gr.Katakana(A)||gr["Vertical Forms"](A)||gr["Yi Radicals"](A)||gr["Yi Syllables"](A)));(Da[Ct]||_t||at.imageName)&&F.push(Kl(K+1,V,U,F,Sc(Ct,t.getCharCode(K+1),_t&&G),!1))}}return function Wt(Gt){return Gt?Wt(Gt.priorBreak).concat(Gt.index):[]}(Kl(t.length(),V,U,F,0,!0))}function qh(t){var r=.5,s=.5;switch(t){case"right":case"top-right":case"bottom-right":r=1;break;case"left":case"top-left":case"bottom-left":r=0}switch(t){case"bottom":case"bottom-right":case"bottom-left":s=1;break;case"top":case"top-right":case"top-left":s=0}return{horizontalAlign:r,verticalAlign:s}}function $f(t,r,s,d,_){if(d||_)for(var w=t[s],S=(t[s].x+w.metrics.advance*w.scale)*d,A=r;A<=s;A++)t[A].x-=S,t[A].y+=_}function Fp(t,r,s,d,_,w){var S,A=t.image;if(A.content){var F=A.content,U=A.pixelRatio||1;S=[F[0]/U,F[1]/U,A.displaySize[0]-F[2]/U,A.displaySize[1]-F[3]/U]}var G,V,K,at,Ct=r.left*w,_t=r.right*w;"width"===s||"both"===s?(at=_[0]+Ct-d[3],V=_[0]+_t+d[1]):V=(at=_[0]+(Ct+_t-A.displaySize[0])/2)+A.displaySize[0];var Wt=r.top*w,Gt=r.bottom*w;return"height"===s||"both"===s?(G=_[1]+Wt-d[0],K=_[1]+Gt+d[2]):K=(G=_[1]+(Wt+Gt-A.displaySize[1])/2)+A.displaySize[1],{image:A,top:G,right:V,bottom:K,left:at,collisionPadding:S}}Da[10]=!0,Da[32]=!0,Da[38]=!0,Da[40]=!0,Da[41]=!0,Da[43]=!0,Da[45]=!0,Da[47]=!0,Da[173]=!0,Da[183]=!0,Da[8203]=!0,Da[8208]=!0,Da[8211]=!0,Da[8231]=!0;var Ql=function(t){function r(s,d,_,w){t.call(this,s,d),this.angle=_,void 0!==w&&(this.segment=w)}return t&&(r.__proto__=t),(r.prototype=Object.create(t&&t.prototype)).constructor=r,r.prototype.clone=function(){return new r(this.x,this.y,this.angle,this.segment)},r}(Ft);function Gh(t,r){var s=r.expression;if("constant"===s.kind)return{kind:"constant",layoutSize:s.evaluate(new ti(t+1))};if("source"===s.kind)return{kind:"source"};for(var d=s.zoomStops,_=s.interpolationType,w=0;w<d.length&&d[w]<=t;)w++;for(var S=w=Math.max(0,w-1);S<d.length&&d[S]<t+1;)S++;S=Math.min(d.length-1,S);var A=d[w],F=d[S];return"composite"===s.kind?{kind:"composite",minZoom:A,maxZoom:F,interpolationType:_}:{kind:"camera",minZoom:A,maxZoom:F,minSize:s.evaluate(new ti(A)),maxSize:s.evaluate(new ti(F)),interpolationType:_}}function Vh(t,r,s){var d=r.uSize,_=s.lowerSize;return"source"===t.kind?_/128:"composite"===t.kind?bi(_/128,s.upperSize/128,r.uSizeT):d}function Bp(t,r){var s=0,d=0;if("constant"===t.kind)d=t.layoutSize;else if("source"!==t.kind){var _=t.interpolationType,w=_?_e(Qn.interpolationFactor(_,r,t.minZoom,t.maxZoom),0,1):0;"camera"===t.kind?d=bi(t.minSize,t.maxSize,w):s=w}return{uSizeT:s,uSize:d}}nr("Anchor",Ql);var Qf=Object.freeze({__proto__:null,getSizeData:Gh,evaluateSizeForFeature:Vh,evaluateSizeForZoom:Bp,SIZE_PACK_FACTOR:128});function Up(t,r,s,d,_){if(void 0===r.segment)return!0;for(var w=r,S=r.segment+1,A=0;A>-s/2;){if(--S<0)return!1;A-=t[S].dist(w),w=t[S]}A+=t[S].dist(t[S+1]),S++;for(var F=[],U=0;A<s/2;){var G=t[S],V=t[S+1];if(!V)return!1;var K=t[S-1].angleTo(G)-G.angleTo(V);for(K=Math.abs((K+3*Math.PI)%(2*Math.PI)-Math.PI),F.push({distance:A,angleDelta:K}),U+=K;A-F[0].distance>d;)U-=F.shift().angleDelta;if(U>_)return!1;S++,A+=G.dist(V)}return!0}function Zh(t){for(var r=0,s=0;s<t.length-1;s++)r+=t[s].dist(t[s+1]);return r}function uh(t,r,s){return t?.6*r*s:0}function qp(t,r){return Math.max(t?t.right-t.left:0,r?r.right-r.left:0)}function tc(t,r,s,d,_,w){for(var S=uh(s,_,w),A=qp(s,d)*w,F=0,U=Zh(t)/2,G=0;G<t.length-1;G++){var V=t[G],K=t[G+1],at=V.dist(K);if(F+at>U){var Ct=(U-F)/at,_t=bi(V.x,K.x,Ct),Wt=bi(V.y,K.y,Ct),Gt=new Ql(_t,Wt,K.angleTo(V),G);return Gt._round(),!S||Up(t,Gt,A,S,r)?Gt:void 0}F+=at}}function ec(t,r,s,d,_,w,S,A,F){var U=uh(d,w,S),G=qp(d,_),V=G*S,K=0===t[0].x||t[0].x===F||0===t[0].y||t[0].y===F;return r-V<r/4&&(r=V+r/4),function at(Ct,_t,Wt,Gt,pe,de,Pe,ue,qe){for(var Ke=de/2,fr=Zh(Ct),Nr=0,hr=_t-Wt,jr=[],Qe=0;Qe<Ct.length-1;Qe++){for(var _n=Ct[Qe],en=Ct[Qe+1],Dr=_n.dist(en),Pn=en.angleTo(_n);hr+Wt<Nr+Dr;){var yn=((hr+=Wt)-Nr)/Dr,Zn=bi(_n.x,en.x,yn),Ur=bi(_n.y,en.y,yn);if(Zn>=0&&Zn<qe&&Ur>=0&&Ur<qe&&hr-Ke>=0&&hr+Ke<=fr){var jn=new Ql(Zn,Ur,Pn,Qe);jn._round(),Gt&&!Up(Ct,jn,de,Gt,pe)||jr.push(jn)}}Nr+=Dr}return ue||jr.length||Pe||(jr=at(Ct,Nr/2,Wt,Gt,pe,de,Pe,!0,qe)),jr}(t,K?r/2*A%r:(G/2+2*w)*S*A%r,r,U,s,V,K,!1,F)}function jh(t,r,s,d,_){for(var w=[],S=0;S<t.length;S++)for(var A=t[S],F=void 0,U=0;U<A.length-1;U++){var G=A[U],V=A[U+1];G.x<r&&V.x<r||(G.x<r?G=new Ft(r,G.y+(r-G.x)/(V.x-G.x)*(V.y-G.y))._round():V.x<r&&(V=new Ft(r,G.y+(r-G.x)/(V.x-G.x)*(V.y-G.y))._round()),G.y<s&&V.y<s||(G.y<s?G=new Ft(G.x+(s-G.y)/(V.y-G.y)*(V.x-G.x),s)._round():V.y<s&&(V=new Ft(G.x+(s-G.y)/(V.y-G.y)*(V.x-G.x),s)._round()),G.x>=d&&V.x>=d||(G.x>=d?G=new Ft(d,G.y+(d-G.x)/(V.x-G.x)*(V.y-G.y))._round():V.x>=d&&(V=new Ft(d,G.y+(d-G.x)/(V.x-G.x)*(V.y-G.y))._round()),G.y>=_&&V.y>=_||(G.y>=_?G=new Ft(G.x+(_-G.y)/(V.y-G.y)*(V.x-G.x),_)._round():V.y>=_&&(V=new Ft(G.x+(_-G.y)/(V.y-G.y)*(V.x-G.x),_)._round()),F&&G.equals(F[F.length-1])||w.push(F=[G]),F.push(V)))))}return w}function Gp(t,r,s,d){var _=[],w=t.image,S=w.pixelRatio,A=w.paddedRect.w-2,F=w.paddedRect.h-2,U=t.right-t.left,G=t.bottom-t.top,V=w.stretchX||[[0,A]],K=w.stretchY||[[0,F]],at=function(Zn,Ur){return Zn+Ur[1]-Ur[0]},Ct=V.reduce(at,0),_t=K.reduce(at,0),Wt=A-Ct,Gt=F-_t,pe=0,de=Ct,Pe=0,ue=_t,qe=0,Ke=Wt,fr=0,Nr=Gt;if(w.content&&d){var hr=w.content;pe=Cc(V,0,hr[0]),Pe=Cc(K,0,hr[1]),de=Cc(V,hr[0],hr[2]),ue=Cc(K,hr[1],hr[3]),qe=hr[0]-pe,fr=hr[1]-Pe,Ke=hr[2]-hr[0]-de,Nr=hr[3]-hr[1]-ue}var jr=function(Zn,Ur,jn,Vi){var io=ch(Zn.stretch-pe,de,U,t.left),Ki=hh(Zn.fixed-qe,Ke,Zn.stretch,Ct),Fi=ch(Ur.stretch-Pe,ue,G,t.top),Qi=hh(Ur.fixed-fr,Nr,Ur.stretch,_t),Bi=ch(jn.stretch-pe,de,U,t.left),ta=hh(jn.fixed-qe,Ke,jn.stretch,Ct),Ga=ch(Vi.stretch-Pe,ue,G,t.top),ua=hh(Vi.fixed-fr,Nr,Vi.stretch,_t),Ra=new Ft(io,Fi),No=new Ft(Bi,Fi),la=new Ft(Bi,Ga),Dn=new Ft(io,Ga),Ai=new Ft(Ki/S,Qi/S),si=new Ft(ta/S,ua/S),Kn=r*Math.PI/180;if(Kn){var cs=Math.sin(Kn),ca=Math.cos(Kn),En=[ca,-cs,cs,ca];Ra._matMult(En),No._matMult(En),Dn._matMult(En),la._matMult(En)}var hi=Zn.stretch+Zn.fixed,ri=Ur.stretch+Ur.fixed;return{tl:Ra,tr:No,bl:Dn,br:la,tex:{x:w.paddedRect.x+1+hi,y:w.paddedRect.y+1+ri,w:jn.stretch+jn.fixed-hi,h:Vi.stretch+Vi.fixed-ri},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Ai,pixelOffsetBR:si,minFontScaleX:Ke/S/U,minFontScaleY:Nr/S/G,isSDF:s}};if(d&&(w.stretchX||w.stretchY))for(var Qe=lh(V,Wt,Ct),_n=lh(K,Gt,_t),en=0;en<Qe.length-1;en++)for(var Dr=Qe[en],Pn=Qe[en+1],yn=0;yn<_n.length-1;yn++)_.push(jr(Dr,_n[yn],Pn,_n[yn+1]));else _.push(jr({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:A+1},{fixed:0,stretch:F+1}));return _}function Cc(t,r,s){for(var d=0,_=0,w=t;_<w.length;_+=1){var S=w[_];d+=Math.max(r,Math.min(s,S[1]))-Math.max(r,Math.min(s,S[0]))}return d}function lh(t,r,s){for(var d=[{fixed:-1,stretch:0}],_=0,w=t;_<w.length;_+=1){var S=w[_],A=S[0],F=S[1],U=d[d.length-1];d.push({fixed:A-U.stretch,stretch:U.stretch}),d.push({fixed:A-U.stretch,stretch:U.stretch+(F-A)})}return d.push({fixed:r+1,stretch:s}),d}function ch(t,r,s,d){return t/r*s+d}function hh(t,r,s,d){return t-r*s/d}var Ic=function(t,r,s,d,_,w,S,A,F,U){if(this.boxStartIndex=t.length,F){var G=w.top,V=w.bottom,K=w.collisionPadding;K&&(G-=K[1],V+=K[3]);var at=V-G;at>0&&(at=Math.max(10,at),this.circleDiameter=at)}else{var Ct=w.top*S-A,_t=w.bottom*S+A,Wt=w.left*S-A,Gt=w.right*S+A,pe=w.collisionPadding;if(pe&&(Wt-=pe[0]*S,Ct-=pe[1]*S,Gt+=pe[2]*S,_t+=pe[3]*S),U){var de=new Ft(Wt,Ct),Pe=new Ft(Gt,Ct),ue=new Ft(Wt,_t),qe=new Ft(Gt,_t),Ke=U*Math.PI/180;de._rotate(Ke),Pe._rotate(Ke),ue._rotate(Ke),qe._rotate(Ke),Wt=Math.min(de.x,Pe.x,ue.x,qe.x),Gt=Math.max(de.x,Pe.x,ue.x,qe.x),Ct=Math.min(de.y,Pe.y,ue.y,qe.y),_t=Math.max(de.y,Pe.y,ue.y,qe.y)}t.emplaceBack(r.x,r.y,Wt,Ct,Gt,_t,s,d,_)}this.boxEndIndex=t.length},rc=function(t,r){if(void 0===t&&(t=[]),void 0===r&&(r=Do),this.data=t,this.length=this.data.length,this.compare=r,this.length>0)for(var s=(this.length>>1)-1;s>=0;s--)this._down(s)};function Do(t,r){return t<r?-1:t>r?1:0}function td(t,r,s){void 0===r&&(r=1),void 0===s&&(s=!1);for(var d=1/0,_=1/0,w=-1/0,S=-1/0,A=t[0],F=0;F<A.length;F++){var U=A[F];(!F||U.x<d)&&(d=U.x),(!F||U.y<_)&&(_=U.y),(!F||U.x>w)&&(w=U.x),(!F||U.y>S)&&(S=U.y)}var G=Math.min(w-d,S-_),V=G/2,K=new rc([],nc);if(0===G)return new Ft(d,_);for(var at=d;at<w;at+=G)for(var Ct=_;Ct<S;Ct+=G)K.push(new qa(at+V,Ct+V,V,t));for(var _t=function(pe){for(var de=0,Pe=0,ue=0,qe=pe[0],Ke=0,fr=qe.length,Nr=fr-1;Ke<fr;Nr=Ke++){var hr=qe[Ke],jr=qe[Nr],Qe=hr.x*jr.y-jr.x*hr.y;Pe+=(hr.x+jr.x)*Qe,ue+=(hr.y+jr.y)*Qe,de+=3*Qe}return new qa(Pe/de,ue/de,0,pe)}(t),Wt=K.length;K.length;){var Gt=K.pop();(Gt.d>_t.d||!_t.d)&&(_t=Gt,s&&console.log("found best %d after %d probes",Math.round(1e4*Gt.d)/1e4,Wt)),Gt.max-_t.d<=r||(K.push(new qa(Gt.p.x-(V=Gt.h/2),Gt.p.y-V,V,t)),K.push(new qa(Gt.p.x+V,Gt.p.y-V,V,t)),K.push(new qa(Gt.p.x-V,Gt.p.y+V,V,t)),K.push(new qa(Gt.p.x+V,Gt.p.y+V,V,t)),Wt+=4)}return s&&(console.log("num probes: "+Wt),console.log("best distance: "+_t.d)),_t.p}function nc(t,r){return r.max-t.max}function qa(t,r,s,d){this.p=new Ft(t,r),this.h=s,this.d=function(_,w){for(var S=!1,A=1/0,F=0;F<w.length;F++)for(var U=w[F],G=0,V=U.length,K=V-1;G<V;K=G++){var at=U[G],Ct=U[K];at.y>_.y!=Ct.y>_.y&&_.x<(Ct.x-at.x)*(_.y-at.y)/(Ct.y-at.y)+at.x&&(S=!S),A=Math.min(A,wl(_,at,Ct))}return(S?1:-1)*Math.sqrt(A)}(this.p,d),this.max=this.d+this.h*Math.SQRT2}rc.prototype.push=function(t){this.data.push(t),this.length++,this._up(this.length-1)},rc.prototype.pop=function(){if(0!==this.length){var t=this.data[0],r=this.data.pop();return this.length--,this.length>0&&(this.data[0]=r,this._down(0)),t}},rc.prototype.peek=function(){return this.data[0]},rc.prototype._up=function(t){for(var r=this.data,s=this.compare,d=r[t];t>0;){var _=t-1>>1,w=r[_];if(s(d,w)>=0)break;r[t]=w,t=_}r[t]=d},rc.prototype._down=function(t){for(var r=this.data,s=this.compare,d=this.length>>1,_=r[t];t<d;){var w=1+(t<<1),S=r[w],A=w+1;if(A<this.length&&s(r[A],S)<0&&(w=A,S=r[A]),s(S,_)>=0)break;r[t]=S,t=w}r[t]=_};var Ll=Number.POSITIVE_INFINITY;function es(t,r){return r[1]!==Ll?function(s,d,_){var w=0,S=0;switch(d=Math.abs(d),_=Math.abs(_),s){case"top-right":case"top-left":case"top":S=_-7;break;case"bottom-right":case"bottom-left":case"bottom":S=7-_}switch(s){case"top-right":case"bottom-right":case"right":w=-d;break;case"top-left":case"bottom-left":case"left":w=d}return[w,S]}(t,r[0],r[1]):function(s,d){var _=0,w=0;d<0&&(d=0);var S=d/Math.sqrt(2);switch(s){case"top-right":case"top-left":w=S-7;break;case"bottom-right":case"bottom-left":w=7-S;break;case"bottom":w=7-d;break;case"top":w=d-7}switch(s){case"top-right":case"bottom-right":_=-S;break;case"top-left":case"bottom-left":_=S;break;case"left":_=d;break;case"right":_=-d}return[_,w]}(t,r[0])}function Xh(t){switch(t){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function Vp(t,r,s,d,_,w,S,A,F,U,G,V,K,at,Ct){var _t=function(Pe,ue,qe,Ke,fr,Nr,hr,jr){for(var Qe=Ke.layout.get("text-rotate").evaluate(Nr,{})*Math.PI/180,_n=[],en=0,Dr=ue.positionedLines;en<Dr.length;en+=1)for(var Pn=Dr[en],yn=0,Zn=Pn.positionedGlyphs;yn<Zn.length;yn+=1){var Ur=Zn[yn];if(Ur.rect){var jn=Ur.rect||{},Vi=4,io=!0,Ki=1,Fi=0,Qi=(fr||jr)&&Ur.vertical,Bi=Ur.metrics.advance*Ur.scale/2;if(jr&&ue.verticalizable&&(Fi=Pn.lineOffset/2-(Ur.imageName?-(24-Ur.metrics.width*Ur.scale)/2:24*(Ur.scale-1))),Ur.imageName){var ta=hr[Ur.imageName];io=ta.sdf,Vi=1/(Ki=ta.pixelRatio)}var Ga=fr?[Ur.x+Bi,Ur.y]:[0,0],ua=fr?[0,0]:[Ur.x+Bi+qe[0],Ur.y+qe[1]-Fi],Ra=[0,0];Qi&&(Ra=ua,ua=[0,0]);var No=(Ur.metrics.left-Vi)*Ur.scale-Bi+ua[0],la=(-Ur.metrics.top-Vi)*Ur.scale+ua[1],Dn=No+jn.w*Ur.scale/Ki,Ai=la+jn.h*Ur.scale/Ki,si=new Ft(No,la),Kn=new Ft(Dn,la),cs=new Ft(No,Ai),ca=new Ft(Dn,Ai);if(Qi){var En=new Ft(-Bi,Bi- -17),hi=-Math.PI/2,ri=12-Bi,In=new Ft(22-ri,-(Ur.imageName?ri:0)),hs=new(Function.prototype.bind.apply(Ft,[null].concat(Ra)));si._rotateAround(hi,En)._add(In)._add(hs),Kn._rotateAround(hi,En)._add(In)._add(hs),cs._rotateAround(hi,En)._add(In)._add(hs),ca._rotateAround(hi,En)._add(In)._add(hs)}if(Qe){var Es=Math.sin(Qe),_u=Math.cos(Qe),Zi=[_u,-Es,Es,_u];si._matMult(Zi),Kn._matMult(Zi),cs._matMult(Zi),ca._matMult(Zi)}var Ns=new Ft(0,0),Na=new Ft(0,0);_n.push({tl:si,tr:Kn,bl:cs,br:ca,tex:jn,writingMode:ue.writingMode,glyphOffset:Ga,sectionIndex:Ur.sectionIndex,isSDF:io,pixelOffsetTL:Ns,pixelOffsetBR:Na,minFontScaleX:0,minFontScaleY:0})}}return _n}(0,s,A,_,w,S,d,t.allowVerticalPlacement),Wt=t.textSizeData,Gt=null;"source"===Wt.kind?(Gt=[128*_.layout.get("text-size").evaluate(S,{})])[0]>32640&&bt(t.layerIds[0]+': Value for "text-size" is >= 255. Reduce your "text-size".'):"composite"===Wt.kind&&((Gt=[128*at.compositeTextSizes[0].evaluate(S,{},Ct),128*at.compositeTextSizes[1].evaluate(S,{},Ct)])[0]>32640||Gt[1]>32640)&&bt(t.layerIds[0]+': Value for "text-size" is >= 255. Reduce your "text-size".'),t.addSymbols(t.text,_t,Gt,A,w,S,U,r,F.lineStartIndex,F.lineLength,K,Ct);for(var pe=0,de=G;pe<de.length;pe+=1)V[de[pe]]=t.text.placedSymbolArray.length-1;return 4*_t.length}function Yh(t){for(var r in t)return t[r];return null}function Kd(t,r,s,d){var _=t.compareText;if(r in _){for(var w=_[r],S=w.length-1;S>=0;S--)if(d.dist(w[S])<s)return!0}else _[r]=[];return _[r].push(d),!1}var ed=yc.VectorTileFeature.types,$d=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Wh(t,r,s,d,_,w,S,A,F,U,G,V,K){var at=A?Math.min(32640,Math.round(A[0])):0,Ct=A?Math.min(32640,Math.round(A[1])):0;t.emplaceBack(r,s,Math.round(32*d),Math.round(32*_),w,S,(at<<1)+(F?1:0),Ct,16*U,16*G,256*V,256*K)}function Zp(t,r,s){t.emplaceBack(r.x,r.y,s),t.emplaceBack(r.x,r.y,s),t.emplaceBack(r.x,r.y,s),t.emplaceBack(r.x,r.y,s)}function jp(t){for(var r=0,s=t.sections;r<s.length;r+=1)if(xl(s[r].text))return!0;return!1}var Pc=function(t){this.layoutVertexArray=new c,this.indexArray=new Zt,this.programConfigurations=t,this.segments=new lt,this.dynamicLayoutVertexArray=new f,this.opacityVertexArray=new x,this.placedSymbolArray=new E};Pc.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length&&0===this.indexArray.length&&0===this.dynamicLayoutVertexArray.length&&0===this.opacityVertexArray.length},Pc.prototype.upload=function(t,r,s,d){this.isEmpty()||(s&&(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,jf.members),this.indexBuffer=t.createIndexBuffer(this.indexArray,r),this.dynamicLayoutVertexBuffer=t.createVertexBuffer(this.dynamicLayoutVertexArray,Xf.members,!0),this.opacityVertexBuffer=t.createVertexBuffer(this.opacityVertexArray,$d,!0),this.opacityVertexBuffer.itemSize=1),(s||d)&&this.programConfigurations.upload(t))},Pc.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())},nr("SymbolBuffers",Pc);var ph=function(t,r,s){this.layoutVertexArray=new t,this.layoutAttributes=r,this.indexArray=new s,this.segments=new lt,this.collisionVertexArray=new gt};ph.prototype.upload=function(t){this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=t.createVertexBuffer(this.collisionVertexArray,Yf.members,!0)},ph.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())},nr("CollisionBuffers",ph);var Ii=function(t){this.collisionBoxArray=t.collisionBoxArray,this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(function(w){return w.id}),this.index=t.index,this.pixelRatio=t.pixelRatio,this.sourceLayerIndex=t.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=Ua([]),this.placementViewportMatrix=Ua([]);var r=this.layers[0]._unevaluatedLayout._values;this.textSizeData=Gh(this.zoom,r["text-size"]),this.iconSizeData=Gh(this.zoom,r["icon-size"]);var s=this.layers[0].layout,d=s.get("symbol-sort-key"),_=s.get("symbol-z-order");this.canOverlap=s.get("text-allow-overlap")||s.get("icon-allow-overlap")||s.get("text-ignore-placement")||s.get("icon-ignore-placement"),this.sortFeaturesByKey="viewport-y"!==_&&!d.isConstant(),this.sortFeaturesByY=("viewport-y"===_||"auto"===_&&!this.sortFeaturesByKey)&&this.canOverlap,"point"===s.get("symbol-placement")&&(this.writingModes=s.get("text-writing-mode").map(function(w){return Rs[w]})),this.stateDependentLayerIds=this.layers.filter(function(w){return w.isStateDependent()}).map(function(w){return w.id}),this.sourceID=t.sourceID};Ii.prototype.createArrays=function(){this.text=new Pc(new Vr(this.layers,this.zoom,function(t){return/^text/.test(t)})),this.icon=new Pc(new Vr(this.layers,this.zoom,function(t){return/^icon/.test(t)})),this.glyphOffsetArray=new k,this.lineVertexArray=new q,this.symbolInstances=new T},Ii.prototype.calculateGlyphDependencies=function(t,r,s,d,_){for(var w=0;w<t.length;w++)if(r[t.charCodeAt(w)]=!0,(s||d)&&_){var S=ih[t.charAt(w)];S&&(r[S.charCodeAt(0)]=!0)}},Ii.prototype.populate=function(t,r,s){var d=this.layers[0],_=d.layout,w=_.get("text-font"),S=_.get("text-field"),A=_.get("icon-image"),F=("constant"!==S.value.kind||S.value.value instanceof oo&&!S.value.value.isEmpty()||S.value.value.toString().length>0)&&("constant"!==w.value.kind||w.value.value.length>0),U="constant"!==A.value.kind||!!A.value.value||Object.keys(A.parameters).length>0,G=_.get("symbol-sort-key");if(this.features=[],F||U){for(var V=r.iconDependencies,K=r.glyphDependencies,at=r.availableImages,Ct=new ti(this.zoom),_t=0,Wt=t;_t<Wt.length;_t+=1){var Gt=Wt[_t],pe=Gt.feature,de=Gt.id,Pe=Gt.index,ue=Gt.sourceLayerIndex,qe=d._featureFilter.needGeometry,Ke=hn(pe,qe);if(d._featureFilter.filter(Ct,Ke,s)){qe||(Ke.geometry=$r(pe));var fr=void 0;if(F){var Nr=d.getValueAndResolveTokens("text-field",Ke,s,at),hr=oo.factory(Nr);jp(hr)&&(this.hasRTLText=!0),(!this.hasRTLText||"unavailable"===oa()||this.hasRTLText&&Sn.isParsed())&&(fr=Wf(hr,d,Ke))}var jr=void 0;if(U){var Qe=d.getValueAndResolveTokens("icon-image",Ke,s,at);jr=Qe instanceof Un?Qe:Un.fromString(Qe)}if(fr||jr){var _n=this.sortFeaturesByKey?G.evaluate(Ke,{},s):void 0;if(this.features.push({id:de,text:fr,icon:jr,index:Pe,sourceLayerIndex:ue,geometry:Ke.geometry,properties:pe.properties,type:ed[pe.type],sortKey:_n}),jr&&(V[jr.name]=!0),fr){var en=w.evaluate(Ke,{},s).join(","),Dr="map"===_.get("text-rotation-alignment")&&"point"!==_.get("symbol-placement");this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(Rs.vertical)>=0;for(var Pn=0,yn=fr.sections;Pn<yn.length;Pn+=1){var Zn=yn[Pn];if(Zn.image)V[Zn.image.name]=!0;else{var Ur=ki(fr.toString()),jn=Zn.fontStack||en,Vi=K[jn]=K[jn]||{};this.calculateGlyphDependencies(Zn.text,Vi,Dr,this.allowVerticalPlacement,Ur)}}}}}}"line"===_.get("symbol-placement")&&(this.features=function(io){var Ki={},Fi={},Qi=[],Bi=0;function ta(En){Qi.push(io[En]),Bi++}function Ga(En,hi,ri){var In=Fi[En];return delete Fi[En],Fi[hi]=In,Qi[In].geometry[0].pop(),Qi[In].geometry[0]=Qi[In].geometry[0].concat(ri[0]),In}function ua(En,hi,ri){var In=Ki[hi];return delete Ki[hi],Ki[En]=In,Qi[In].geometry[0].shift(),Qi[In].geometry[0]=ri[0].concat(Qi[In].geometry[0]),In}function Ra(En,hi,ri){var In=ri?hi[0][hi[0].length-1]:hi[0][0];return En+":"+In.x+":"+In.y}for(var No=0;No<io.length;No++){var la=io[No],Dn=la.geometry,Ai=la.text?la.text.toString():null;if(Ai){var si=Ra(Ai,Dn),Kn=Ra(Ai,Dn,!0);if(si in Fi&&Kn in Ki&&Fi[si]!==Ki[Kn]){var cs=ua(si,Kn,Dn),ca=Ga(si,Kn,Qi[cs].geometry);delete Ki[si],delete Fi[Kn],Fi[Ra(Ai,Qi[ca].geometry,!0)]=ca,Qi[cs].geometry=null}else si in Fi?Ga(si,Kn,Dn):Kn in Ki?ua(si,Kn,Dn):(ta(No),Ki[si]=Bi-1,Fi[Kn]=Bi-1)}else ta(No)}return Qi.filter(function(En){return En.geometry})}(this.features)),this.sortFeaturesByKey&&this.features.sort(function(io,Ki){return io.sortKey-Ki.sortKey})}},Ii.prototype.update=function(t,r,s){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(t,r,this.layers,s),this.icon.programConfigurations.updatePaintArrays(t,r,this.layers,s))},Ii.prototype.isEmpty=function(){return 0===this.symbolInstances.length&&!this.hasRTLText},Ii.prototype.uploadPending=function(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload},Ii.prototype.upload=function(t){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(t),this.iconCollisionBox.upload(t)),this.text.upload(t,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(t,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0},Ii.prototype.destroyDebugData=function(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()},Ii.prototype.destroy=function(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()},Ii.prototype.addToLineVertexArray=function(t,r){var s=this.lineVertexArray.length;if(void 0!==t.segment){for(var d=t.dist(r[t.segment+1]),_=t.dist(r[t.segment]),w={},S=t.segment+1;S<r.length;S++)w[S]={x:r[S].x,y:r[S].y,tileUnitDistanceFromAnchor:d},S<r.length-1&&(d+=r[S+1].dist(r[S]));for(var A=t.segment||0;A>=0;A--)w[A]={x:r[A].x,y:r[A].y,tileUnitDistanceFromAnchor:_},A>0&&(_+=r[A-1].dist(r[A]));for(var F=0;F<r.length;F++){var U=w[F];this.lineVertexArray.emplaceBack(U.x,U.y,U.tileUnitDistanceFromAnchor)}}return{lineStartIndex:s,lineLength:this.lineVertexArray.length-s}},Ii.prototype.addSymbols=function(t,r,s,d,_,w,S,A,F,U,G,V){for(var K=t.indexArray,at=t.layoutVertexArray,Ct=t.segments.prepareSegment(4*r.length,at,K,this.canOverlap?w.sortKey:void 0),_t=this.glyphOffsetArray.length,Wt=Ct.vertexLength,Gt=this.allowVerticalPlacement&&S===Rs.vertical?Math.PI/2:0,pe=w.text&&w.text.sections,de=0;de<r.length;de++){var Pe=r[de],ue=Pe.tl,qe=Pe.tr,Ke=Pe.bl,fr=Pe.br,Nr=Pe.tex,hr=Pe.pixelOffsetTL,jr=Pe.pixelOffsetBR,Qe=Pe.minFontScaleX,_n=Pe.minFontScaleY,en=Pe.glyphOffset,Dr=Pe.isSDF,Pn=Pe.sectionIndex,yn=Ct.vertexLength,Zn=en[1];Wh(at,A.x,A.y,ue.x,Zn+ue.y,Nr.x,Nr.y,s,Dr,hr.x,hr.y,Qe,_n),Wh(at,A.x,A.y,qe.x,Zn+qe.y,Nr.x+Nr.w,Nr.y,s,Dr,jr.x,hr.y,Qe,_n),Wh(at,A.x,A.y,Ke.x,Zn+Ke.y,Nr.x,Nr.y+Nr.h,s,Dr,hr.x,jr.y,Qe,_n),Wh(at,A.x,A.y,fr.x,Zn+fr.y,Nr.x+Nr.w,Nr.y+Nr.h,s,Dr,jr.x,jr.y,Qe,_n),Zp(t.dynamicLayoutVertexArray,A,Gt),K.emplaceBack(yn,yn+1,yn+2),K.emplaceBack(yn+1,yn+2,yn+3),Ct.vertexLength+=4,Ct.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(en[0]),de!==r.length-1&&Pn===r[de+1].sectionIndex||t.programConfigurations.populatePaintArrays(at.length,w,w.index,{},V,pe&&pe[Pn])}t.placedSymbolArray.emplaceBack(A.x,A.y,_t,this.glyphOffsetArray.length-_t,Wt,F,U,A.segment,s?s[0]:0,s?s[1]:0,d[0],d[1],S,0,!1,0,G)},Ii.prototype._addCollisionDebugVertex=function(t,r,s,d,_,w){return r.emplaceBack(0,0),t.emplaceBack(s.x,s.y,d,_,Math.round(w.x),Math.round(w.y))},Ii.prototype.addCollisionDebugVertices=function(t,r,s,d,_,w,S){var A=_.segments.prepareSegment(4,_.layoutVertexArray,_.indexArray),F=A.vertexLength,U=_.layoutVertexArray,G=_.collisionVertexArray,V=S.anchorX,K=S.anchorY;this._addCollisionDebugVertex(U,G,w,V,K,new Ft(t,r)),this._addCollisionDebugVertex(U,G,w,V,K,new Ft(s,r)),this._addCollisionDebugVertex(U,G,w,V,K,new Ft(s,d)),this._addCollisionDebugVertex(U,G,w,V,K,new Ft(t,d)),A.vertexLength+=4;var at=_.indexArray;at.emplaceBack(F,F+1),at.emplaceBack(F+1,F+2),at.emplaceBack(F+2,F+3),at.emplaceBack(F+3,F),A.primitiveLength+=4},Ii.prototype.addDebugCollisionBoxes=function(t,r,s,d){for(var _=t;_<r;_++){var w=this.collisionBoxArray.get(_);this.addCollisionDebugVertices(w.x1,w.y1,w.x2,w.y2,d?this.textCollisionBox:this.iconCollisionBox,w.anchorPoint,s)}},Ii.prototype.generateCollisionDebugBuffers=function(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new ph(z,Nh.members,Xr),this.iconCollisionBox=new ph(z,Nh.members,Xr);for(var t=0;t<this.symbolInstances.length;t++){var r=this.symbolInstances.get(t);this.addDebugCollisionBoxes(r.textBoxStartIndex,r.textBoxEndIndex,r,!0),this.addDebugCollisionBoxes(r.verticalTextBoxStartIndex,r.verticalTextBoxEndIndex,r,!0),this.addDebugCollisionBoxes(r.iconBoxStartIndex,r.iconBoxEndIndex,r,!1),this.addDebugCollisionBoxes(r.verticalIconBoxStartIndex,r.verticalIconBoxEndIndex,r,!1)}},Ii.prototype._deserializeCollisionBoxesForSymbol=function(t,r,s,d,_,w,S,A,F){for(var U={},G=r;G<s;G++){var V=t.get(G);U.textBox={x1:V.x1,y1:V.y1,x2:V.x2,y2:V.y2,anchorPointX:V.anchorPointX,anchorPointY:V.anchorPointY},U.textFeatureIndex=V.featureIndex;break}for(var K=d;K<_;K++){var at=t.get(K);U.verticalTextBox={x1:at.x1,y1:at.y1,x2:at.x2,y2:at.y2,anchorPointX:at.anchorPointX,anchorPointY:at.anchorPointY},U.verticalTextFeatureIndex=at.featureIndex;break}for(var Ct=w;Ct<S;Ct++){var _t=t.get(Ct);U.iconBox={x1:_t.x1,y1:_t.y1,x2:_t.x2,y2:_t.y2,anchorPointX:_t.anchorPointX,anchorPointY:_t.anchorPointY},U.iconFeatureIndex=_t.featureIndex;break}for(var Wt=A;Wt<F;Wt++){var Gt=t.get(Wt);U.verticalIconBox={x1:Gt.x1,y1:Gt.y1,x2:Gt.x2,y2:Gt.y2,anchorPointX:Gt.anchorPointX,anchorPointY:Gt.anchorPointY},U.verticalIconFeatureIndex=Gt.featureIndex;break}return U},Ii.prototype.deserializeCollisionBoxes=function(t){this.collisionArrays=[];for(var r=0;r<this.symbolInstances.length;r++){var s=this.symbolInstances.get(r);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(t,s.textBoxStartIndex,s.textBoxEndIndex,s.verticalTextBoxStartIndex,s.verticalTextBoxEndIndex,s.iconBoxStartIndex,s.iconBoxEndIndex,s.verticalIconBoxStartIndex,s.verticalIconBoxEndIndex))}},Ii.prototype.hasTextData=function(){return this.text.segments.get().length>0},Ii.prototype.hasIconData=function(){return this.icon.segments.get().length>0},Ii.prototype.hasDebugData=function(){return this.textCollisionBox&&this.iconCollisionBox},Ii.prototype.hasTextCollisionBoxData=function(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0},Ii.prototype.hasIconCollisionBoxData=function(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0},Ii.prototype.addIndicesForPlacedSymbol=function(t,r){for(var s=t.placedSymbolArray.get(r),d=s.vertexStartIndex+4*s.numGlyphs,_=s.vertexStartIndex;_<d;_+=4)t.indexArray.emplaceBack(_,_+1,_+2),t.indexArray.emplaceBack(_+1,_+2,_+3)},Ii.prototype.getSortedSymbolIndexes=function(t){if(this.sortedAngle===t&&void 0!==this.symbolInstanceIndexes)return this.symbolInstanceIndexes;for(var r=Math.sin(t),s=Math.cos(t),d=[],_=[],w=[],S=0;S<this.symbolInstances.length;++S){w.push(S);var A=this.symbolInstances.get(S);d.push(0|Math.round(r*A.anchorX+s*A.anchorY)),_.push(A.featureIndex)}return w.sort(function(F,U){return d[F]-d[U]||_[U]-_[F]}),w},Ii.prototype.addToSortKeyRanges=function(t,r){var s=this.sortKeyRanges[this.sortKeyRanges.length-1];s&&s.sortKey===r?s.symbolInstanceEnd=t+1:this.sortKeyRanges.push({sortKey:r,symbolInstanceStart:t,symbolInstanceEnd:t+1})},Ii.prototype.sortFeatures=function(t){var r=this;if(this.sortFeaturesByY&&this.sortedAngle!==t&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(t),this.sortedAngle=t,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(var s=0,d=this.symbolInstanceIndexes;s<d.length;s+=1){var _=this.symbolInstances.get(d[s]);this.featureSortOrder.push(_.featureIndex),[_.rightJustifiedTextSymbolIndex,_.centerJustifiedTextSymbolIndex,_.leftJustifiedTextSymbolIndex].forEach(function(w,S,A){w>=0&&A.indexOf(w)===S&&r.addIndicesForPlacedSymbol(r.text,w)}),_.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,_.verticalPlacedTextSymbolIndex),_.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,_.placedIconSymbolIndex),_.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,_.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}},nr("SymbolBucket",Ii,{omit:["layers","collisionBoxArray","features","compareText"]}),Ii.MAX_GLYPHS=65535,Ii.addDynamicAttributes=Zp;var Qd=new Oo({"symbol-placement":new vr(xt.layout_symbol["symbol-placement"]),"symbol-spacing":new vr(xt.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new vr(xt.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Gr(xt.layout_symbol["symbol-sort-key"]),"symbol-z-order":new vr(xt.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new vr(xt.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new vr(xt.layout_symbol["icon-ignore-placement"]),"icon-optional":new vr(xt.layout_symbol["icon-optional"]),"icon-rotation-alignment":new vr(xt.layout_symbol["icon-rotation-alignment"]),"icon-size":new Gr(xt.layout_symbol["icon-size"]),"icon-text-fit":new vr(xt.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new vr(xt.layout_symbol["icon-text-fit-padding"]),"icon-image":new Gr(xt.layout_symbol["icon-image"]),"icon-rotate":new Gr(xt.layout_symbol["icon-rotate"]),"icon-padding":new vr(xt.layout_symbol["icon-padding"]),"icon-keep-upright":new vr(xt.layout_symbol["icon-keep-upright"]),"icon-offset":new Gr(xt.layout_symbol["icon-offset"]),"icon-anchor":new Gr(xt.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new vr(xt.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new vr(xt.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new vr(xt.layout_symbol["text-rotation-alignment"]),"text-field":new Gr(xt.layout_symbol["text-field"]),"text-font":new Gr(xt.layout_symbol["text-font"]),"text-size":new Gr(xt.layout_symbol["text-size"]),"text-max-width":new Gr(xt.layout_symbol["text-max-width"]),"text-line-height":new vr(xt.layout_symbol["text-line-height"]),"text-letter-spacing":new Gr(xt.layout_symbol["text-letter-spacing"]),"text-justify":new Gr(xt.layout_symbol["text-justify"]),"text-radial-offset":new Gr(xt.layout_symbol["text-radial-offset"]),"text-variable-anchor":new vr(xt.layout_symbol["text-variable-anchor"]),"text-anchor":new Gr(xt.layout_symbol["text-anchor"]),"text-max-angle":new vr(xt.layout_symbol["text-max-angle"]),"text-writing-mode":new vr(xt.layout_symbol["text-writing-mode"]),"text-rotate":new Gr(xt.layout_symbol["text-rotate"]),"text-padding":new vr(xt.layout_symbol["text-padding"]),"text-keep-upright":new vr(xt.layout_symbol["text-keep-upright"]),"text-transform":new Gr(xt.layout_symbol["text-transform"]),"text-offset":new Gr(xt.layout_symbol["text-offset"]),"text-allow-overlap":new vr(xt.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new vr(xt.layout_symbol["text-ignore-placement"]),"text-optional":new vr(xt.layout_symbol["text-optional"])}),fh={paint:new Oo({"icon-opacity":new Gr(xt.paint_symbol["icon-opacity"]),"icon-color":new Gr(xt.paint_symbol["icon-color"]),"icon-halo-color":new Gr(xt.paint_symbol["icon-halo-color"]),"icon-halo-width":new Gr(xt.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Gr(xt.paint_symbol["icon-halo-blur"]),"icon-translate":new vr(xt.paint_symbol["icon-translate"]),"icon-translate-anchor":new vr(xt.paint_symbol["icon-translate-anchor"]),"text-opacity":new Gr(xt.paint_symbol["text-opacity"]),"text-color":new Gr(xt.paint_symbol["text-color"],{runtimeType:sn,getOverride:function(t){return t.textColor},hasOverride:function(t){return!!t.textColor}}),"text-halo-color":new Gr(xt.paint_symbol["text-halo-color"]),"text-halo-width":new Gr(xt.paint_symbol["text-halo-width"]),"text-halo-blur":new Gr(xt.paint_symbol["text-halo-blur"]),"text-translate":new vr(xt.paint_symbol["text-translate"]),"text-translate-anchor":new vr(xt.paint_symbol["text-translate-anchor"])}),layout:Qd},Mc=function(t){this.type=t.property.overrides?t.property.overrides.runtimeType:Pr,this.defaultValue=t};Mc.prototype.evaluate=function(t){if(t.formattedSection){var r=this.defaultValue.property.overrides;if(r&&r.hasOverride(t.formattedSection))return r.getOverride(t.formattedSection)}return t.feature&&t.featureState?this.defaultValue.evaluate(t.feature,t.featureState):this.defaultValue.property.specification.default},Mc.prototype.eachChild=function(t){this.defaultValue.isConstant()||t(this.defaultValue.value._styleExpression.expression)},Mc.prototype.outputDefined=function(){return!1},Mc.prototype.serialize=function(){return null},nr("FormatSectionOverride",Mc,{omit:["defaultValue"]});var tg=function(t){function r(s){t.call(this,s,fh)}return t&&(r.__proto__=t),(r.prototype=Object.create(t&&t.prototype)).constructor=r,r.prototype.recalculate=function(s,d){if(t.prototype.recalculate.call(this,s,d),"auto"===this.layout.get("icon-rotation-alignment")&&(this.layout._values["icon-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-rotation-alignment")&&(this.layout._values["text-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-pitch-alignment")&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),"auto"===this.layout.get("icon-pitch-alignment")&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),"point"===this.layout.get("symbol-placement")){var _=this.layout.get("text-writing-mode");if(_){for(var w=[],S=0,A=_;S<A.length;S+=1){var F=A[S];w.indexOf(F)<0&&w.push(F)}this.layout._values["text-writing-mode"]=w}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()},r.prototype.getValueAndResolveTokens=function(s,d,_,w){var F,S=this.layout.get(s).evaluate(d,{},_,w),A=this._unevaluatedLayout._values[s];return A.isDataDriven()||ma(A.value)||!S?S:(F=d.properties,S.replace(/{([^{}]+)}/g,function(G,V){return V in F?String(F[V]):""}))},r.prototype.createBucket=function(s){return new Ii(s)},r.prototype.queryRadius=function(){return 0},r.prototype.queryIntersectsFeature=function(){return!1},r.prototype._setPaintOverrides=function(){for(var s=0,d=fh.paint.overridableProperties;s<d.length;s+=1){var _=d[s];if(r.hasPaintOverride(this.layout,_)){var w,S=this.paint.get(_),A=new Mc(S),F=new qo(A,S.property.specification);w="constant"===S.value.kind||"source"===S.value.kind?new _s("source",F):new Fa("composite",F,S.value.zoomStops,S.value._interpolationType),this.paint._values[_]=new sa(S.property,w,S.parameters)}}},r.prototype._handleOverridablePaintPropertyUpdate=function(s,d,_){return!(!this.layout||d.isDataDriven()||_.isDataDriven())&&r.hasPaintOverride(this.layout,s)},r.hasPaintOverride=function(s,d){var _=s.get("text-field"),w=fh.paint.properties[d],S=!1,A=function(G){for(var V=0,K=G;V<K.length;V+=1)if(w.overrides&&w.overrides.hasOverride(K[V]))return void(S=!0)};if("constant"===_.value.kind&&_.value.value instanceof oo)A(_.value.value.sections);else if("source"===_.value.kind){var F=function(G){S||(G instanceof bn&&mo(G.value)===zr?A(G.value.sections):G instanceof nn?A(G.sections):G.eachChild(F))},U=_.value;U._styleExpression&&F(U._styleExpression.expression)}return S},r}(Wr),Xp={paint:new Oo({"background-color":new vr(xt.paint_background["background-color"]),"background-pattern":new $o(xt.paint_background["background-pattern"]),"background-opacity":new vr(xt.paint_background["background-opacity"])})},eg=function(t){function r(s){t.call(this,s,Xp)}return t&&(r.__proto__=t),(r.prototype=Object.create(t&&t.prototype)).constructor=r,r}(Wr),rg={paint:new Oo({"raster-opacity":new vr(xt.paint_raster["raster-opacity"]),"raster-hue-rotate":new vr(xt.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new vr(xt.paint_raster["raster-brightness-min"]),"raster-brightness-max":new vr(xt.paint_raster["raster-brightness-max"]),"raster-saturation":new vr(xt.paint_raster["raster-saturation"]),"raster-contrast":new vr(xt.paint_raster["raster-contrast"]),"raster-resampling":new vr(xt.paint_raster["raster-resampling"]),"raster-fade-duration":new vr(xt.paint_raster["raster-fade-duration"])})},ng=function(t){function r(s){t.call(this,s,rg)}return t&&(r.__proto__=t),(r.prototype=Object.create(t&&t.prototype)).constructor=r,r}(Wr),ig=function(t){function r(s){t.call(this,s,{}),this.implementation=s}return t&&(r.__proto__=t),(r.prototype=Object.create(t&&t.prototype)).constructor=r,r.prototype.is3D=function(){return"3d"===this.implementation.renderingMode},r.prototype.hasOffscreenPass=function(){return void 0!==this.implementation.prerender},r.prototype.recalculate=function(){},r.prototype.updateTransitions=function(){},r.prototype.hasTransition=function(){},r.prototype.serialize=function(){},r.prototype.onAdd=function(s){this.implementation.onAdd&&this.implementation.onAdd(s,s.painter.context.gl)},r.prototype.onRemove=function(s){this.implementation.onRemove&&this.implementation.onRemove(s,s.painter.context.gl)},r}(Wr),rd={circle:Yl,heatmap:Cf,hillshade:Pf,fill:Rh,"fill-extrusion":Lp,line:Zf,symbol:tg,background:eg,raster:ng},Yp=Jt.HTMLImageElement,nd=Jt.HTMLCanvasElement,Wp=Jt.HTMLVideoElement,id=Jt.ImageData,Hh=Jt.ImageBitmap,el=function(t,r,s,d){this.context=t,this.format=s,this.texture=t.gl.createTexture(),this.update(r,d)};el.prototype.update=function(t,r,s){var d=t.width,_=t.height,w=!(this.size&&this.size[0]===d&&this.size[1]===_||s),S=this.context,A=S.gl;if(this.useMipmap=Boolean(r&&r.useMipmap),A.bindTexture(A.TEXTURE_2D,this.texture),S.pixelStoreUnpackFlipY.set(!1),S.pixelStoreUnpack.set(1),S.pixelStoreUnpackPremultiplyAlpha.set(this.format===A.RGBA&&(!r||!1!==r.premultiply)),w)this.size=[d,_],t instanceof Yp||t instanceof nd||t instanceof Wp||t instanceof id||Hh&&t instanceof Hh?A.texImage2D(A.TEXTURE_2D,0,this.format,this.format,A.UNSIGNED_BYTE,t):A.texImage2D(A.TEXTURE_2D,0,this.format,d,_,0,this.format,A.UNSIGNED_BYTE,t.data);else{var F=s||{x:0,y:0},U=F.x,G=F.y;t instanceof Yp||t instanceof nd||t instanceof Wp||t instanceof id||Hh&&t instanceof Hh?A.texSubImage2D(A.TEXTURE_2D,0,U,G,A.RGBA,A.UNSIGNED_BYTE,t):A.texSubImage2D(A.TEXTURE_2D,0,U,G,d,_,A.RGBA,A.UNSIGNED_BYTE,t.data)}this.useMipmap&&this.isSizePowerOfTwo()&&A.generateMipmap(A.TEXTURE_2D)},el.prototype.bind=function(t,r,s){var d=this.context.gl;d.bindTexture(d.TEXTURE_2D,this.texture),s!==d.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(s=d.LINEAR),t!==this.filter&&(d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MAG_FILTER,t),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MIN_FILTER,s||t),this.filter=t),r!==this.wrap&&(d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_S,r),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_T,r),this.wrap=r)},el.prototype.isSizePowerOfTwo=function(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0},el.prototype.destroy=function(){this.context.gl.deleteTexture(this.texture),this.texture=null};var Jh=function(t){var r=this;this._callback=t,this._triggered=!1,"undefined"!=typeof MessageChannel&&(this._channel=new MessageChannel,this._channel.port2.onmessage=function(){r._triggered=!1,r._callback()})};Jh.prototype.trigger=function(){var t=this;this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(function(){t._triggered=!1,t._callback()},0))},Jh.prototype.remove=function(){delete this._channel,this._callback=function(){}};var Tc=function(t,r,s){this.target=t,this.parent=r,this.mapId=s,this.callbacks={},this.tasks={},this.taskQueue=[],this.cancelCallbacks={},St(["receive","process"],this),this.invoker=new Jh(this.process),this.target.addEventListener("message",this.receive,!1),this.globalScope=ze()?t:Jt};function od(t,r,s){var d=2*Math.PI*6378137/256/Math.pow(2,s);return[t*d-2*Math.PI*6378137/2,r*d-2*Math.PI*6378137/2]}Tc.prototype.send=function(t,r,s,d,_){var w=this;void 0===_&&(_=!1);var S=Math.round(1e18*Math.random()).toString(36).substring(0,10);s&&(this.callbacks[S]=s);var A=re(this.globalScope)?void 0:[];return this.target.postMessage({id:S,type:t,hasCallback:!!s,targetMapId:d,mustQueue:_,sourceMapId:this.mapId,data:qi(r,A)},A),{cancel:function(){s&&delete w.callbacks[S],w.target.postMessage({id:S,type:"<cancel>",targetMapId:d,sourceMapId:w.mapId})}}},Tc.prototype.receive=function(t){var r=t.data,s=r.id;if(s&&(!r.targetMapId||this.mapId===r.targetMapId))if("<cancel>"===r.type){delete this.tasks[s];var d=this.cancelCallbacks[s];delete this.cancelCallbacks[s],d&&d()}else ze()||r.mustQueue?(this.tasks[s]=r,this.taskQueue.push(s),this.invoker.trigger()):this.processTask(s,r)},Tc.prototype.process=function(){if(this.taskQueue.length){var t=this.taskQueue.shift(),r=this.tasks[t];delete this.tasks[t],this.taskQueue.length&&this.invoker.trigger(),r&&this.processTask(t,r)}},Tc.prototype.processTask=function(t,r){var s=this;if("<response>"===r.type){var d=this.callbacks[t];delete this.callbacks[t],d&&(r.error?d(bs(r.error)):d(null,bs(r.data)))}else{var _=!1,w=re(this.globalScope)?void 0:[],S=r.hasCallback?function(G,V){_=!0,delete s.cancelCallbacks[t],s.target.postMessage({id:t,type:"<response>",sourceMapId:s.mapId,error:G?qi(G):null,data:qi(V,w)},w)}:function(G){_=!0},A=null,F=bs(r.data);if(this.parent[r.type])A=this.parent[r.type](r.sourceMapId,F,S);else if(this.parent.getWorkerSource){var U=r.type.split(".");A=this.parent.getWorkerSource(r.sourceMapId,U[0],F.source)[U[1]](F,S)}else S(new Error("Could not find function "+r.type));!_&&A&&A.cancel&&(this.cancelCallbacks[t]=A.cancel)}},Tc.prototype.remove=function(){this.invoker.remove(),this.target.removeEventListener("message",this.receive,!1)};var Ro=function(t,r){t&&(r?this.setSouthWest(t).setNorthEast(r):4===t.length?this.setSouthWest([t[0],t[1]]).setNorthEast([t[2],t[3]]):this.setSouthWest(t[0]).setNorthEast(t[1]))};Ro.prototype.setNorthEast=function(t){return this._ne=t instanceof Gi?new Gi(t.lng,t.lat):Gi.convert(t),this},Ro.prototype.setSouthWest=function(t){return this._sw=t instanceof Gi?new Gi(t.lng,t.lat):Gi.convert(t),this},Ro.prototype.extend=function(t){var r,s,d=this._sw,_=this._ne;if(t instanceof Gi)r=t,s=t;else{if(!(t instanceof Ro))return Array.isArray(t)?4===t.length||t.every(Array.isArray)?this.extend(Ro.convert(t)):this.extend(Gi.convert(t)):this;if(s=t._ne,!(r=t._sw)||!s)return this}return d||_?(d.lng=Math.min(r.lng,d.lng),d.lat=Math.min(r.lat,d.lat),_.lng=Math.max(s.lng,_.lng),_.lat=Math.max(s.lat,_.lat)):(this._sw=new Gi(r.lng,r.lat),this._ne=new Gi(s.lng,s.lat)),this},Ro.prototype.getCenter=function(){return new Gi((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)},Ro.prototype.getSouthWest=function(){return this._sw},Ro.prototype.getNorthEast=function(){return this._ne},Ro.prototype.getNorthWest=function(){return new Gi(this.getWest(),this.getNorth())},Ro.prototype.getSouthEast=function(){return new Gi(this.getEast(),this.getSouth())},Ro.prototype.getWest=function(){return this._sw.lng},Ro.prototype.getSouth=function(){return this._sw.lat},Ro.prototype.getEast=function(){return this._ne.lng},Ro.prototype.getNorth=function(){return this._ne.lat},Ro.prototype.toArray=function(){return[this._sw.toArray(),this._ne.toArray()]},Ro.prototype.toString=function(){return"LngLatBounds("+this._sw.toString()+", "+this._ne.toString()+")"},Ro.prototype.isEmpty=function(){return!(this._sw&&this._ne)},Ro.prototype.contains=function(t){var r=Gi.convert(t),s=r.lng,d=r.lat,_=this._sw.lng<=s&&s<=this._ne.lng;return this._sw.lng>this._ne.lng&&(_=this._sw.lng>=s&&s>=this._ne.lng),this._sw.lat<=d&&d<=this._ne.lat&&_},Ro.convert=function(t){return!t||t instanceof Ro?t:new Ro(t)};var Gi=function(t,r){if(isNaN(t)||isNaN(r))throw new Error("Invalid LngLat object: ("+t+", "+r+")");if(this.lng=+t,this.lat=+r,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")};Gi.prototype.wrap=function(){return new Gi(We(this.lng,-180,180),this.lat)},Gi.prototype.toArray=function(){return[this.lng,this.lat]},Gi.prototype.toString=function(){return"LngLat("+this.lng+", "+this.lat+")"},Gi.prototype.distanceTo=function(t){var r=Math.PI/180,s=this.lat*r,d=t.lat*r,_=Math.sin(s)*Math.sin(d)+Math.cos(s)*Math.cos(d)*Math.cos((t.lng-this.lng)*r);return 6371008.8*Math.acos(Math.min(_,1))},Gi.prototype.toBounds=function(t){void 0===t&&(t=0);var r=360*t/40075017,s=r/Math.cos(Math.PI/180*this.lat);return new Ro(new Gi(this.lng-s,this.lat-r),new Gi(this.lng+s,this.lat+r))},Gi.convert=function(t){if(t instanceof Gi)return t;if(Array.isArray(t)&&(2===t.length||3===t.length))return new Gi(Number(t[0]),Number(t[1]));if(!Array.isArray(t)&&"object"==typeof t&&null!==t)return new Gi(Number("lng"in t?t.lng:t.lon),Number(t.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")};var Kh=2*Math.PI*6371008.8;function Hp(t){return Kh*Math.cos(t*Math.PI/180)}function Jp(t){return(180+t)/360}function dh(t){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+t*Math.PI/360)))/360}function ad(t,r){return t/Hp(r)}function Kp(t){return 360/Math.PI*Math.atan(Math.exp((180-360*t)*Math.PI/180))-90}var ic=function(t,r,s){void 0===s&&(s=0),this.x=+t,this.y=+r,this.z=+s};ic.fromLngLat=function(t,r){void 0===r&&(r=0);var s=Gi.convert(t);return new ic(Jp(s.lng),dh(s.lat),ad(r,s.lat))},ic.prototype.toLngLat=function(){return new Gi(360*this.x-180,Kp(this.y))},ic.prototype.toAltitude=function(){return this.z*Hp(Kp(this.y))},ic.prototype.meterInMercatorCoordinateUnits=function(){return 1/Kh*(t=Kp(this.y),1/Math.cos(t*Math.PI/180));var t};var Ol=function(t,r,s){this.z=t,this.x=r,this.y=s,this.key=Ac(0,t,t,r,s)};Ol.prototype.equals=function(t){return this.z===t.z&&this.x===t.x&&this.y===t.y},Ol.prototype.url=function(t,r){var s,d,_,w,S,A=(d=this.y,_=this.z,w=od(256*(s=this.x),256*(d=Math.pow(2,_)-d-1),_),S=od(256*(s+1),256*(d+1),_),w[0]+","+w[1]+","+S[0]+","+S[1]),F=function(U,G,V){for(var K,at="",Ct=U;Ct>0;Ct--)at+=(G&(K=1<<Ct-1)?1:0)+(V&K?2:0);return at}(this.z,this.x,this.y);return t[(this.x+this.y)%t.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace("{z}",String(this.z)).replace("{x}",String(this.x)).replace("{y}",String("tms"===r?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",F).replace("{bbox-epsg-3857}",A)},Ol.prototype.getTilePoint=function(t){var r=Math.pow(2,this.z);return new Ft(8192*(t.x*r-this.x),8192*(t.y*r-this.y))},Ol.prototype.toString=function(){return this.z+"/"+this.x+"/"+this.y};var $h=function(t,r){this.wrap=t,this.canonical=r,this.key=Ac(t,r.z,r.z,r.x,r.y)},Zo=function(t,r,s,d,_){this.overscaledZ=t,this.wrap=r,this.canonical=new Ol(s,+d,+_),this.key=Ac(r,t,s,d,_)};function Ac(t,r,s,d,_){(t*=2)<0&&(t=-1*t-1);var w=1<<s;return(w*w*t+w*_+d).toString(36)+s.toString(36)+r.toString(36)}Zo.prototype.equals=function(t){return this.overscaledZ===t.overscaledZ&&this.wrap===t.wrap&&this.canonical.equals(t.canonical)},Zo.prototype.scaledTo=function(t){var r=this.canonical.z-t;return t>this.canonical.z?new Zo(t,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Zo(t,this.wrap,t,this.canonical.x>>r,this.canonical.y>>r)},Zo.prototype.calculateScaledKey=function(t,r){var s=this.canonical.z-t;return t>this.canonical.z?Ac(this.wrap*+r,t,this.canonical.z,this.canonical.x,this.canonical.y):Ac(this.wrap*+r,t,t,this.canonical.x>>s,this.canonical.y>>s)},Zo.prototype.isChildOf=function(t){if(t.wrap!==this.wrap)return!1;var r=this.canonical.z-t.canonical.z;return 0===t.overscaledZ||t.overscaledZ<this.overscaledZ&&t.canonical.x===this.canonical.x>>r&&t.canonical.y===this.canonical.y>>r},Zo.prototype.children=function(t){if(this.overscaledZ>=t)return[new Zo(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];var r=this.canonical.z+1,s=2*this.canonical.x,d=2*this.canonical.y;return[new Zo(r,this.wrap,r,s,d),new Zo(r,this.wrap,r,s+1,d),new Zo(r,this.wrap,r,s,d+1),new Zo(r,this.wrap,r,s+1,d+1)]},Zo.prototype.isLessThan=function(t){return this.wrap<t.wrap||!(this.wrap>t.wrap)&&(this.overscaledZ<t.overscaledZ||!(this.overscaledZ>t.overscaledZ)&&(this.canonical.x<t.canonical.x||!(this.canonical.x>t.canonical.x)&&this.canonical.y<t.canonical.y))},Zo.prototype.wrapped=function(){return new Zo(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)},Zo.prototype.unwrapTo=function(t){return new Zo(this.overscaledZ,t,this.canonical.z,this.canonical.x,this.canonical.y)},Zo.prototype.overscaleFactor=function(){return Math.pow(2,this.overscaledZ-this.canonical.z)},Zo.prototype.toUnwrapped=function(){return new $h(this.wrap,this.canonical)},Zo.prototype.toString=function(){return this.overscaledZ+"/"+this.canonical.x+"/"+this.canonical.y},Zo.prototype.getTilePoint=function(t){return this.canonical.getTilePoint(new ic(t.x-this.wrap,t.y))},nr("CanonicalTileID",Ol),nr("OverscaledTileID",Zo,{omit:["posMatrix"]});var Tu=function(t,r,s){if(this.uid=t,r.height!==r.width)throw new RangeError("DEM tiles must be square");if(s&&"mapbox"!==s&&"terrarium"!==s)return bt('"'+s+'" is not a valid encoding type. Valid types include "mapbox" and "terrarium".');this.stride=r.height;var d=this.dim=r.height-2;this.data=new Uint32Array(r.data.buffer),this.encoding=s||"mapbox";for(var _=0;_<d;_++)this.data[this._idx(-1,_)]=this.data[this._idx(0,_)],this.data[this._idx(d,_)]=this.data[this._idx(d-1,_)],this.data[this._idx(_,-1)]=this.data[this._idx(_,0)],this.data[this._idx(_,d)]=this.data[this._idx(_,d-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(d,-1)]=this.data[this._idx(d-1,0)],this.data[this._idx(-1,d)]=this.data[this._idx(0,d-1)],this.data[this._idx(d,d)]=this.data[this._idx(d-1,d-1)]};Tu.prototype.get=function(t,r){var s=new Uint8Array(this.data.buffer),d=4*this._idx(t,r);return("terrarium"===this.encoding?this._unpackTerrarium:this._unpackMapbox)(s[d],s[d+1],s[d+2])},Tu.prototype.getUnpackVector=function(){return"terrarium"===this.encoding?[256,1,1/256,32768]:[6553.6,25.6,.1,1e4]},Tu.prototype._idx=function(t,r){if(t<-1||t>=this.dim+1||r<-1||r>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(r+1)*this.stride+(t+1)},Tu.prototype._unpackMapbox=function(t,r,s){return(256*t*256+256*r+s)/10-1e4},Tu.prototype._unpackTerrarium=function(t,r,s){return 256*t+r+s/256-32768},Tu.prototype.getPixels=function(){return new us({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))},Tu.prototype.backfillBorder=function(t,r,s){if(this.dim!==t.dim)throw new Error("dem dimension mismatch");var d=r*this.dim,_=r*this.dim+this.dim,w=s*this.dim,S=s*this.dim+this.dim;switch(r){case-1:d=_-1;break;case 1:_=d+1}switch(s){case-1:w=S-1;break;case 1:S=w+1}for(var A=-r*this.dim,F=-s*this.dim,U=w;U<S;U++)for(var G=d;G<_;G++)this.data[this._idx(G,U)]=t.data[this._idx(G+A,U+F)]},nr("DEMData",Tu);var Qh=function(t){this._stringToNumber={},this._numberToString=[];for(var r=0;r<t.length;r++){var s=t[r];this._stringToNumber[s]=r,this._numberToString[r]=s}};Qh.prototype.encode=function(t){return this._stringToNumber[t]},Qh.prototype.decode=function(t){return this._numberToString[t]};var gh=function(t,r,s,d,_){this.type="Feature",this._vectorTileFeature=t,t._z=r,t._x=s,t._y=d,this.properties=t.properties,this.id=_},$p={geometry:{configurable:!0}};$p.geometry.get=function(){return void 0===this._geometry&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry},$p.geometry.set=function(t){this._geometry=t},gh.prototype.toJSON=function(){var t={geometry:this.geometry};for(var r in this)"_geometry"!==r&&"_vectorTileFeature"!==r&&(t[r]=this[r]);return t},Object.defineProperties(gh.prototype,$p);var oc=function(){this.state={},this.stateChanges={},this.deletedStates={}};oc.prototype.updateState=function(t,r,s){var d=String(r);if(this.stateChanges[t]=this.stateChanges[t]||{},this.stateChanges[t][d]=this.stateChanges[t][d]||{},kt(this.stateChanges[t][d],s),null===this.deletedStates[t])for(var _ in this.deletedStates[t]={},this.state[t])_!==d&&(this.deletedStates[t][_]=null);else if(this.deletedStates[t]&&null===this.deletedStates[t][d])for(var w in this.deletedStates[t][d]={},this.state[t][d])s[w]||(this.deletedStates[t][d][w]=null);else for(var S in s)this.deletedStates[t]&&this.deletedStates[t][d]&&null===this.deletedStates[t][d][S]&&delete this.deletedStates[t][d][S]},oc.prototype.removeFeatureState=function(t,r,s){if(null!==this.deletedStates[t]){var d=String(r);if(this.deletedStates[t]=this.deletedStates[t]||{},s&&void 0!==r)null!==this.deletedStates[t][d]&&(this.deletedStates[t][d]=this.deletedStates[t][d]||{},this.deletedStates[t][d][s]=null);else if(void 0!==r)if(this.stateChanges[t]&&this.stateChanges[t][d])for(s in this.deletedStates[t][d]={},this.stateChanges[t][d])this.deletedStates[t][d][s]=null;else this.deletedStates[t][d]=null;else this.deletedStates[t]=null}},oc.prototype.getState=function(t,r){var s=String(r),d=kt({},(this.state[t]||{})[s],(this.stateChanges[t]||{})[s]);if(null===this.deletedStates[t])return{};if(this.deletedStates[t]){var _=this.deletedStates[t][r];if(null===_)return{};for(var w in _)delete d[w]}return d},oc.prototype.initializeTileState=function(t,r){t.setFeatureState(this.state,r)},oc.prototype.coalesceChanges=function(t,r){var s={};for(var d in this.stateChanges){this.state[d]=this.state[d]||{};var _={};for(var w in this.stateChanges[d])this.state[d][w]||(this.state[d][w]={}),kt(this.state[d][w],this.stateChanges[d][w]),_[w]=this.state[d][w];s[d]=_}for(var S in this.deletedStates){this.state[S]=this.state[S]||{};var A={};if(null===this.deletedStates[S])for(var F in this.state[S])A[F]={},this.state[S][F]={};else for(var U in this.deletedStates[S]){if(null===this.deletedStates[S][U])this.state[S][U]={};else for(var G=0,V=Object.keys(this.deletedStates[S][U]);G<V.length;G+=1)delete this.state[S][U][V[G]];A[U]=this.state[S][U]}s[S]=s[S]||{},kt(s[S],A)}if(this.stateChanges={},this.deletedStates={},0!==Object.keys(s).length)for(var K in t)t[K].setFeatureState(s,r)};var Au=function(t,r){this.tileID=t,this.x=t.canonical.x,this.y=t.canonical.y,this.z=t.canonical.z,this.grid=new mi(8192,16,0),this.grid3D=new mi(8192,16,0),this.featureIndexArray=new ut,this.promoteId=r};function Qp(t,r,s,d,_){return et(t,function(w,S){var A=r instanceof Qa?r.get(S):null;return A&&A.evaluate?A.evaluate(s,d,_):A})}function sd(t){for(var r=1/0,s=1/0,d=-1/0,_=-1/0,w=0,S=t;w<S.length;w+=1){var A=S[w];r=Math.min(r,A.x),s=Math.min(s,A.y),d=Math.max(d,A.x),_=Math.max(_,A.y)}return{minX:r,minY:s,maxX:d,maxY:_}}function og(t,r){return r-t}Au.prototype.insert=function(t,r,s,d,_,w){var S=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(s,d,_);for(var A=w?this.grid3D:this.grid,F=0;F<r.length;F++){for(var U=r[F],G=[1/0,1/0,-1/0,-1/0],V=0;V<U.length;V++){var K=U[V];G[0]=Math.min(G[0],K.x),G[1]=Math.min(G[1],K.y),G[2]=Math.max(G[2],K.x),G[3]=Math.max(G[3],K.y)}G[0]<8192&&G[1]<8192&&G[2]>=0&&G[3]>=0&&A.insert(S,G[0],G[1],G[2],G[3])}},Au.prototype.loadVTLayers=function(){return this.vtLayers||(this.vtLayers=new yc.VectorTile(new bc(this.rawTileData)).layers,this.sourceLayerCoder=new Qh(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers},Au.prototype.query=function(t,r,s,d){var _=this;this.loadVTLayers();for(var w=t.params||{},S=8192/t.tileSize/t.scale,A=Ks(w.filter),F=t.queryGeometry,U=t.queryPadding*S,G=sd(F),V=this.grid.query(G.minX-U,G.minY-U,G.maxX+U,G.maxY+U),K=sd(t.cameraQueryGeometry),Ct=0,_t=this.grid3D.query(K.minX-U,K.minY-U,K.maxX+U,K.maxY+U,function(Pe,ue,qe,Ke){return function(fr,Nr,hr,jr,Qe){for(var _n=0,en=fr;_n<en.length;_n+=1){var Dr=en[_n];if(Nr<=Dr.x&&hr<=Dr.y&&jr>=Dr.x&&Qe>=Dr.y)return!0}var Pn=[new Ft(Nr,hr),new Ft(Nr,Qe),new Ft(jr,Qe),new Ft(jr,hr)];if(fr.length>2)for(var yn=0,Zn=Pn;yn<Zn.length;yn+=1)if(iu(fr,Zn[yn]))return!0;for(var Ur=0;Ur<fr.length-1;Ur++)if($u(fr[Ur],fr[Ur+1],Pn))return!0;return!1}(t.cameraQueryGeometry,Pe-U,ue-U,qe+U,Ke+U)});Ct<_t.length;Ct+=1)V.push(_t[Ct]);V.sort(og);for(var Wt,Gt={},pe=function(Pe){var ue=V[Pe];if(ue!==Wt){Wt=ue;var qe=_.featureIndexArray.get(ue),Ke=null;_.loadMatchingFeature(Gt,qe.bucketIndex,qe.sourceLayerIndex,qe.featureIndex,A,w.layers,w.availableImages,r,s,d,function(fr,Nr,hr){return Ke||(Ke=$r(fr)),Nr.queryIntersectsFeature(F,fr,hr,Ke,_.z,t.transform,S,t.pixelPosMatrix)})}},de=0;de<V.length;de++)pe(de);return Gt},Au.prototype.loadMatchingFeature=function(t,r,s,d,_,w,S,A,F,U,G){var V=this.bucketLayerIDs[r];if(!w||function(fr,Nr){for(var hr=0;hr<fr.length;hr++)if(Nr.indexOf(fr[hr])>=0)return!0;return!1}(w,V)){var K=this.sourceLayerCoder.decode(s),at=this.vtLayers[K].feature(d);if(_.needGeometry){var Ct=hn(at,!0);if(!_.filter(new ti(this.tileID.overscaledZ),Ct,this.tileID.canonical))return}else if(!_.filter(new ti(this.tileID.overscaledZ),at))return;for(var _t=this.getId(at,K),Wt=0;Wt<V.length;Wt++){var Gt=V[Wt];if(!(w&&w.indexOf(Gt)<0)){var pe=A[Gt];if(pe){var de={};void 0!==_t&&U&&(de=U.getState(pe.sourceLayer||"_geojsonTileLayer",_t));var Pe=kt({},F[Gt]);Pe.paint=Qp(Pe.paint,pe.paint,at,de,S),Pe.layout=Qp(Pe.layout,pe.layout,at,de,S);var ue=!G||G(at,pe,de);if(ue){var qe=new gh(at,this.z,this.x,this.y,_t);qe.layer=Pe;var Ke=t[Gt];void 0===Ke&&(Ke=t[Gt]=[]),Ke.push({featureIndex:d,feature:qe,intersectionZ:ue})}}}}}},Au.prototype.lookupSymbolFeatures=function(t,r,s,d,_,w,S,A){var F={};this.loadVTLayers();for(var U=Ks(_),G=0,V=t;G<V.length;G+=1)this.loadMatchingFeature(F,s,d,V[G],U,w,S,A,r);return F},Au.prototype.hasLayer=function(t){for(var r=0,s=this.bucketLayerIDs;r<s.length;r+=1)for(var d=0,_=s[r];d<_.length;d+=1)if(t===_[d])return!0;return!1},Au.prototype.getId=function(t,r){var s=t.id;return this.promoteId&&"boolean"==typeof(s=t.properties["string"==typeof this.promoteId?this.promoteId:this.promoteId[r]])&&(s=Number(s)),s},nr("FeatureIndex",Au,{omit:["rawTileData","sourceLayerCoder"]});var wa=function(t,r){this.tileID=t,this.uid=X(),this.uses=0,this.tileSize=r,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.expiredRequestCount=0,this.state="loading"};wa.prototype.registerFadeDuration=function(t){var r=t+this.timeAdded;r<Zr.now()||this.fadeEndTime&&r<this.fadeEndTime||(this.fadeEndTime=r)},wa.prototype.wasRequested=function(){return"errored"===this.state||"loaded"===this.state||"reloading"===this.state},wa.prototype.loadVectorData=function(t,r,s){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",t){for(var d in t.featureIndex&&(this.latestFeatureIndex=t.featureIndex,t.rawTileData?(this.latestRawTileData=t.rawTileData,this.latestFeatureIndex.rawTileData=t.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=t.collisionBoxArray,this.buckets=function(U,G){var V={};if(!G)return V;for(var K=function(){var _t=Ct[at],Wt=_t.layerIds.map(function(de){return G.getLayer(de)}).filter(Boolean);if(0!==Wt.length){_t.layers=Wt,_t.stateDependentLayerIds&&(_t.stateDependentLayers=_t.stateDependentLayerIds.map(function(de){return Wt.filter(function(Pe){return Pe.id===de})[0]}));for(var Gt=0,pe=Wt;Gt<pe.length;Gt+=1)V[pe[Gt].id]=_t}},at=0,Ct=U;at<Ct.length;at+=1)K();return V}(t.buckets,r.style),this.hasSymbolBuckets=!1,this.buckets){var _=this.buckets[d];if(_ instanceof Ii){if(this.hasSymbolBuckets=!0,!s)break;_.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(var w in this.buckets){var S=this.buckets[w];if(S instanceof Ii&&S.hasRTLText){this.hasRTLText=!0,Sn.isLoading()||Sn.isLoaded()||"deferred"!==oa()||qu();break}}for(var A in this.queryPadding=0,this.buckets){var F=this.buckets[A];this.queryPadding=Math.max(this.queryPadding,r.style.getLayer(A).queryRadius(F))}t.imageAtlas&&(this.imageAtlas=t.imageAtlas),t.glyphAtlasImage&&(this.glyphAtlasImage=t.glyphAtlasImage)}else this.collisionBoxArray=new l},wa.prototype.unloadVectorData=function(){for(var t in this.buckets)this.buckets[t].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"},wa.prototype.getBucket=function(t){return this.buckets[t.id]},wa.prototype.upload=function(t){for(var r in this.buckets){var s=this.buckets[r];s.uploadPending()&&s.upload(t)}var d=t.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new el(t,this.imageAtlas.image,d.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new el(t,this.glyphAtlasImage,d.ALPHA),this.glyphAtlasImage=null)},wa.prototype.prepare=function(t){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(t,this.imageAtlasTexture)},wa.prototype.queryRenderedFeatures=function(t,r,s,d,_,w,S,A,F,U){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:d,cameraQueryGeometry:_,scale:w,tileSize:this.tileSize,pixelPosMatrix:U,transform:A,params:S,queryPadding:this.queryPadding*F},t,r,s):{}},wa.prototype.querySourceFeatures=function(t,r){var s=this.latestFeatureIndex;if(s&&s.rawTileData){var d=s.loadVTLayers(),_=r?r.sourceLayer:"",w=d._geojsonTileLayer||d[_];if(w)for(var S=Ks(r&&r.filter),A=this.tileID.canonical,F=A.z,U=A.x,G=A.y,V={z:F,x:U,y:G},K=0;K<w.length;K++){var at=w.feature(K);if(S.needGeometry){var Ct=hn(at,!0);if(!S.filter(new ti(this.tileID.overscaledZ),Ct,this.tileID.canonical))continue}else if(!S.filter(new ti(this.tileID.overscaledZ),at))continue;var _t=s.getId(at,_),Wt=new gh(at,F,U,G,_t);Wt.tile=V,t.push(Wt)}}},wa.prototype.hasData=function(){return"loaded"===this.state||"reloading"===this.state||"expired"===this.state},wa.prototype.patternsLoaded=function(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length},wa.prototype.setExpiryData=function(t){var r=this.expirationTime;if(t.cacheControl){var s=Te(t.cacheControl);s["max-age"]&&(this.expirationTime=Date.now()+1e3*s["max-age"])}else t.expires&&(this.expirationTime=new Date(t.expires).getTime());if(this.expirationTime){var d=Date.now(),_=!1;if(this.expirationTime>d)_=!1;else if(r)if(this.expirationTime<r)_=!0;else{var w=this.expirationTime-r;w?this.expirationTime=d+Math.max(w,3e4):_=!0}else _=!0;_?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}},wa.prototype.getExpiryTimeout=function(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-(new Date).getTime(),Math.pow(2,31)-1)},wa.prototype.setFeatureState=function(t,r){if(this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData&&0!==Object.keys(t).length){var s=this.latestFeatureIndex.loadVTLayers();for(var d in this.buckets)if(r.style.hasLayer(d)){var _=this.buckets[d],w=_.layers[0].sourceLayer||"_geojsonTileLayer",S=s[w],A=t[w];if(S&&A&&0!==Object.keys(A).length){_.update(A,S,this.imageAtlas&&this.imageAtlas.patternPositions||{});var F=r&&r.style&&r.style.getLayer(d);F&&(this.queryPadding=Math.max(this.queryPadding,F.queryRadius(_)))}}}},wa.prototype.holdingForFade=function(){return void 0!==this.symbolFadeHoldUntil},wa.prototype.symbolFadeFinished=function(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<Zr.now()},wa.prototype.clearFadeHold=function(){this.symbolFadeHoldUntil=void 0},wa.prototype.setHoldDuration=function(t){this.symbolFadeHoldUntil=Zr.now()+t},wa.prototype.setDependencies=function(t,r){for(var s={},d=0,_=r;d<_.length;d+=1)s[_[d]]=!0;this.dependencies[t]=s},wa.prototype.hasDependency=function(t,r){for(var s=0,d=t;s<d.length;s+=1){var _=this.dependencies[d[s]];if(_)for(var w=0,S=r;w<S.length;w+=1)if(_[S[w]])return!0}return!1};var Dl=Jt.performance,ud=function(t){this._marks={start:[t.url,"start"].join("#"),end:[t.url,"end"].join("#"),measure:t.url.toString()},Dl.mark(this._marks.start)};ud.prototype.finish=function(){Dl.mark(this._marks.end);var t=Dl.getEntriesByName(this._marks.measure);return 0===t.length&&(Dl.measure(this._marks.measure,this._marks.start,this._marks.end),t=Dl.getEntriesByName(this._marks.measure),Dl.clearMarks(this._marks.start),Dl.clearMarks(this._marks.end),Dl.clearMeasures(this._marks.measure)),t},y.Actor=Tc,y.AlphaImage=Il,y.CanonicalTileID=Ol,y.CollisionBoxArray=l,y.Color=An,y.DEMData=Tu,y.DataConstantProperty=vr,y.DictionaryCoder=Qh,y.EXTENT=8192,y.ErrorEvent=ne,y.EvaluationParameters=ti,y.Event=Xt,y.Evented=Yt,y.FeatureIndex=Au,y.FillBucket=Mu,y.FillExtrusionBucket=ou,y.ImageAtlas=sh,y.ImagePosition=Tl,y.LineBucket=ls,y.LngLat=Gi,y.LngLatBounds=Ro,y.MercatorCoordinate=ic,y.ONE_EM=24,y.OverscaledTileID=Zo,y.Point=Ft,y.Point$1=Ft,y.Properties=Oo,y.Protobuf=bc,y.RGBAImage=us,y.RequestManager=Mn,y.RequestPerformance=ud,y.ResourceType=fo,y.SegmentVector=lt,y.SourceFeatureState=oc,y.StructArrayLayout1ui2=Wn,y.StructArrayLayout2f1f2i16=W,y.StructArrayLayout2i4=Qo,y.StructArrayLayout3ui6=Zt,y.StructArrayLayout4i8=vi,y.SymbolBucket=Ii,y.Texture=el,y.Tile=wa,y.Transitionable=So,y.Uniform1f=Ne,y.Uniform1i=Ue,y.Uniform2f=Ve,y.Uniform3f=er,y.Uniform4f=ir,y.UniformColor=rr,y.UniformMatrix4f=Ye,y.UnwrappedTileID=$h,y.ValidationError=Ut,y.WritingMode=Rs,y.ZoomHistory=Si,y.add=function(t,r,s){return t[0]=r[0]+s[0],t[1]=r[1]+s[1],t[2]=r[2]+s[2],t},y.addDynamicAttributes=Zp,y.asyncAll=function(t,r,s){if(!t.length)return s(null,[]);var d=t.length,_=new Array(t.length),w=null;t.forEach(function(S,A){r(S,function(F,U){F&&(w=F),_[A]=U,0==--d&&s(w,_)})})},y.bezier=ve,y.bindAll=St,y.browser=Zr,y.cacheEntryPossiblyAdded=function(t){++_i>Jr&&(t.getActor().send("enforceCacheSizeLimit",ur),_i=0)},y.clamp=_e,y.clearTileCache=function(t){var r=Jt.caches.delete("mapbox-tiles");t&&r.catch(t).then(function(){return t()})},y.clipLine=jh,y.clone=function(t){var r=new po(16);return r[0]=t[0],r[1]=t[1],r[2]=t[2],r[3]=t[3],r[4]=t[4],r[5]=t[5],r[6]=t[6],r[7]=t[7],r[8]=t[8],r[9]=t[9],r[10]=t[10],r[11]=t[11],r[12]=t[12],r[13]=t[13],r[14]=t[14],r[15]=t[15],r},y.clone$1=j,y.clone$2=function(t){var r=new po(3);return r[0]=t[0],r[1]=t[1],r[2]=t[2],r},y.collisionCircleLayout=kh,y.config=Mr,y.create=function(){var t=new po(16);return po!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0),t[0]=1,t[5]=1,t[10]=1,t[15]=1,t},y.create$1=function(){var t=new po(9);return po!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[5]=0,t[6]=0,t[7]=0),t[0]=1,t[4]=1,t[8]=1,t},y.create$2=function(){var t=new po(4);return po!=Float32Array&&(t[1]=0,t[2]=0),t[0]=1,t[3]=1,t},y.createCommonjsModule=Bt,y.createExpression=za,y.createLayout=oi,y.createStyleLayer=function(t){return"custom"===t.type?new ig(t):new rd[t.type](t)},y.cross=function(t,r,s){var d=r[0],_=r[1],w=r[2],S=s[0],A=s[1],F=s[2];return t[0]=_*F-w*A,t[1]=w*S-d*F,t[2]=d*A-_*S,t},y.deepEqual=function t(r,s){if(Array.isArray(r)){if(!Array.isArray(s)||r.length!==s.length)return!1;for(var d=0;d<r.length;d++)if(!t(r[d],s[d]))return!1;return!0}if("object"==typeof r&&null!==r&&null!==s){if("object"!=typeof s||Object.keys(r).length!==Object.keys(s).length)return!1;for(var _ in r)if(!t(r[_],s[_]))return!1;return!0}return r===s},y.dot=function(t,r){return t[0]*r[0]+t[1]*r[1]+t[2]*r[2]},y.dot$1=function(t,r){return t[0]*r[0]+t[1]*r[1]+t[2]*r[2]+t[3]*r[3]},y.ease=ce,y.emitValidationErrors=as,y.endsWith=Q,y.enforceCacheSizeLimit=function(t){di(),Kt&&Kt.then(function(r){r.keys().then(function(s){for(var d=0;d<s.length-t;d++)r.delete(s[d])})})},y.evaluateSizeForFeature=Vh,y.evaluateSizeForZoom=Bp,y.evaluateVariableOffset=es,y.evented=Ko,y.extend=kt,y.featureFilter=Ks,y.filterObject=st,y.fromRotation=function(t,r){var s=Math.sin(r),d=Math.cos(r);return t[0]=d,t[1]=s,t[2]=0,t[3]=-s,t[4]=d,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},y.getAnchorAlignment=qh,y.getAnchorJustification=Xh,y.getArrayBuffer=gi,y.getImage=it,y.getJSON=function(t,r){return Je(kt(t,{type:"json"}),r)},y.getRTLTextPluginStatus=oa,y.getReferrer=to,y.getVideo=function(t,r){var s,d,_=Jt.document.createElement("video");_.muted=!0,_.onloadstart=function(){r(null,_)};for(var w=0;w<t.length;w++){var S=Jt.document.createElement("source");s=t[w],d=void 0,(d=Jt.document.createElement("a")).href=s,(d.protocol!==Jt.document.location.protocol||d.host!==Jt.document.location.host)&&(_.crossOrigin="Anonymous"),S.src=t[w],_.appendChild(S)}return{cancel:function(){}}},y.identity=Ua,y.invert=function(t,r){var s=r[0],d=r[1],_=r[2],w=r[3],S=r[4],A=r[5],F=r[6],U=r[7],G=r[8],V=r[9],K=r[10],at=r[11],Ct=r[12],_t=r[13],Wt=r[14],Gt=r[15],pe=s*A-d*S,de=s*F-_*S,Pe=s*U-w*S,ue=d*F-_*A,qe=d*U-w*A,Ke=_*U-w*F,fr=G*_t-V*Ct,Nr=G*Wt-K*Ct,hr=G*Gt-at*Ct,jr=V*Wt-K*_t,Qe=V*Gt-at*_t,_n=K*Gt-at*Wt,en=pe*_n-de*Qe+Pe*jr+ue*hr-qe*Nr+Ke*fr;return en?(t[0]=(A*_n-F*Qe+U*jr)*(en=1/en),t[1]=(_*Qe-d*_n-w*jr)*en,t[2]=(_t*Ke-Wt*qe+Gt*ue)*en,t[3]=(K*qe-V*Ke-at*ue)*en,t[4]=(F*hr-S*_n-U*Nr)*en,t[5]=(s*_n-_*hr+w*Nr)*en,t[6]=(Wt*Pe-Ct*Ke-Gt*de)*en,t[7]=(G*Ke-K*Pe+at*de)*en,t[8]=(S*Qe-A*hr+U*fr)*en,t[9]=(d*hr-s*Qe-w*fr)*en,t[10]=(Ct*qe-_t*Pe+Gt*pe)*en,t[11]=(V*Pe-G*qe-at*pe)*en,t[12]=(A*Nr-S*jr-F*fr)*en,t[13]=(s*jr-d*Nr+_*fr)*en,t[14]=(_t*de-Ct*ue-Wt*pe)*en,t[15]=(G*ue-V*de+K*pe)*en,t):null},y.isChar=gr,y.isMapboxURL=Xn,y.keysDifference=function(t,r){var s=[];for(var d in t)d in r||s.push(d);return s},y.makeRequest=Je,y.mapObject=et,y.mercatorXfromLng=Jp,y.mercatorYfromLat=dh,y.mercatorZfromAltitude=ad,y.mul=Ph,y.multiply=El,y.mvt=yc,y.nextPowerOfTwo=function(t){return t<=1?1:Math.pow(2,Math.ceil(Math.log(t)/Math.LN2))},y.normalize=function(t,r){var s=r[0],d=r[1],_=r[2],w=s*s+d*d+_*_;return w>0&&(w=1/Math.sqrt(w)),t[0]=r[0]*w,t[1]=r[1]*w,t[2]=r[2]*w,t},y.number=bi,y.offscreenCanvasSupported=ji,y.ortho=function(t,r,s,d,_,w,S){var A=1/(r-s),F=1/(d-_),U=1/(w-S);return t[0]=-2*A,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*F,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*U,t[11]=0,t[12]=(r+s)*A,t[13]=(_+d)*F,t[14]=(S+w)*U,t[15]=1,t},y.parseGlyphPBF=function(t){return new bc(t).readFields(zp,[])},y.pbf=bc,y.performSymbolLayout=function(t,r,s,d,_,w,S){t.createArrays(),t.tilePixelRatio=8192/(512*t.overscaling),t.compareText={},t.iconsNeedLinear=!1;var A=t.layers[0].layout,F=t.layers[0]._unevaluatedLayout._values,U={};if("composite"===t.textSizeData.kind){var G=t.textSizeData,V=G.maxZoom;U.compositeTextSizes=[F["text-size"].possiblyEvaluate(new ti(G.minZoom),S),F["text-size"].possiblyEvaluate(new ti(V),S)]}if("composite"===t.iconSizeData.kind){var K=t.iconSizeData,at=K.maxZoom;U.compositeIconSizes=[F["icon-size"].possiblyEvaluate(new ti(K.minZoom),S),F["icon-size"].possiblyEvaluate(new ti(at),S)]}U.layoutTextSize=F["text-size"].possiblyEvaluate(new ti(t.zoom+1),S),U.layoutIconSize=F["icon-size"].possiblyEvaluate(new ti(t.zoom+1),S),U.textMaxSize=F["text-size"].possiblyEvaluate(new ti(18));for(var Ct=24*A.get("text-line-height"),_t="map"===A.get("text-rotation-alignment")&&"point"!==A.get("symbol-placement"),Wt=A.get("text-keep-upright"),Gt=A.get("text-size"),pe=function(){var ue=Pe[de],qe=A.get("text-font").evaluate(ue,{},S).join(","),Ke=Gt.evaluate(ue,{},S),fr=U.layoutTextSize.evaluate(ue,{},S),Nr=U.layoutIconSize.evaluate(ue,{},S),hr={horizontal:{},vertical:void 0},jr=ue.text,Qe=[0,0];if(jr){var _n=jr.toString(),en=24*A.get("text-letter-spacing").evaluate(ue,{},S),Dr=function(Dn){for(var Ai=0,si=Dn;Ai<si.length;Ai+=1)if(Kn=si[Ai].charCodeAt(0),gr.Arabic(Kn)||gr["Arabic Supplement"](Kn)||gr["Arabic Extended-A"](Kn)||gr["Arabic Presentation Forms-A"](Kn)||gr["Arabic Presentation Forms-B"](Kn))return!1;var Kn;return!0}(_n)?en:0,Pn=A.get("text-anchor").evaluate(ue,{},S),yn=A.get("text-variable-anchor");if(!yn){var Zn=A.get("text-radial-offset").evaluate(ue,{},S);Qe=Zn?es(Pn,[24*Zn,Ll]):A.get("text-offset").evaluate(ue,{},S).map(function(Dn){return 24*Dn})}var Ur=_t?"center":A.get("text-justify").evaluate(ue,{},S),jn=A.get("symbol-placement"),Vi="point"===jn?24*A.get("text-max-width").evaluate(ue,{},S):0,io=function(){t.allowVerticalPlacement&&ki(_n)&&(hr.vertical=Al(jr,r,s,_,qe,Vi,Ct,Pn,"left",Dr,Qe,Rs.vertical,!0,jn,fr,Ke))};if(!_t&&yn){for(var Ki="auto"===Ur?yn.map(function(Dn){return Xh(Dn)}):[Ur],Fi=!1,Qi=0;Qi<Ki.length;Qi++){var Bi=Ki[Qi];if(!hr.horizontal[Bi])if(Fi)hr.horizontal[Bi]=hr.horizontal[0];else{var ta=Al(jr,r,s,_,qe,Vi,Ct,"center",Bi,Dr,Qe,Rs.horizontal,!1,jn,fr,Ke);ta&&(hr.horizontal[Bi]=ta,Fi=1===ta.positionedLines.length)}}io()}else{"auto"===Ur&&(Ur=Xh(Pn));var Ga=Al(jr,r,s,_,qe,Vi,Ct,Pn,Ur,Dr,Qe,Rs.horizontal,!1,jn,fr,Ke);Ga&&(hr.horizontal[Ur]=Ga),io(),ki(_n)&&_t&&Wt&&(hr.vertical=Al(jr,r,s,_,qe,Vi,Ct,Pn,Ur,Dr,Qe,Rs.vertical,!1,jn,fr,Ke))}}var Dn,Ai,Kn,cs,ca,ua=void 0,Ra=!1;if(ue.icon&&ue.icon.name){var No=d[ue.icon.name];No&&(Dn=_[ue.icon.name],Ai=A.get("icon-offset").evaluate(ue,{},S),Kn=qh(A.get("icon-anchor").evaluate(ue,{},S)),ua={image:Dn,top:ca=Ai[1]-Dn.displaySize[1]*Kn.verticalAlign,bottom:ca+Dn.displaySize[1],left:cs=Ai[0]-Dn.displaySize[0]*Kn.horizontalAlign,right:cs+Dn.displaySize[0]},Ra=No.sdf,void 0===t.sdfIcons?t.sdfIcons=No.sdf:t.sdfIcons!==No.sdf&&bt("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(No.pixelRatio!==t.pixelRatio||0!==A.get("icon-rotate").constantOr(1))&&(t.iconsNeedLinear=!0))}var la=Yh(hr.horizontal)||hr.vertical;t.iconsInText=!!la&&la.iconsInText,(la||ua)&&function(Dn,Ai,si,Kn,cs,ca,En,hi,ri,In,hs){var Es=ca.textMaxSize.evaluate(Ai,{});void 0===Es&&(Es=En);var _u,Zi=Dn.layers[0].layout,Ns=Zi.get("icon-offset").evaluate(Ai,{},hs),Na=Yh(si.horizontal),ks=En/24,Ss=Dn.tilePixelRatio*ks,rl=Dn.tilePixelRatio*Es/24,Lu=Dn.tilePixelRatio*hi,Rl=Dn.tilePixelRatio*Zi.get("symbol-spacing"),Lc=Zi.get("text-padding")*Dn.tilePixelRatio,Nl=Zi.get("icon-padding")*Dn.tilePixelRatio,Oc=Zi.get("text-max-angle")/180*Math.PI,mh="map"===Zi.get("text-rotation-alignment")&&"point"!==Zi.get("symbol-placement"),ps="map"===Zi.get("icon-rotation-alignment")&&"point"!==Zi.get("symbol-placement"),Vu=Zi.get("symbol-placement"),ac=Rl/2,Dc=Zi.get("icon-text-fit");Kn&&"none"!==Dc&&(Dn.allowVerticalPlacement&&si.vertical&&(_u=Fp(Kn,si.vertical,Dc,Zi.get("icon-text-fit-padding"),Ns,ks)),Na&&(Kn=Fp(Kn,Na,Dc,Zi.get("icon-text-fit-padding"),Ns,ks)));var au=function(ld,Nc){Nc.x<0||Nc.x>=8192||Nc.y<0||Nc.y>=8192||function(Io,su,ag,Ou,rp,np,kc,xu,ip,zc,Fc,op,ap,Bc,Uc,sp,up,ef,rf,lp,Gs,cp,cd,bu,sg){var hd,ju,sl,ul,qc,uc=Io.addToLineVertexArray(su,ag),pd=0,fd=0,dd=0,nf=0,Vl=-1,lc=-1,Xu={},gd=qt(""),Gc=0,vh=0;if(void 0===xu._unevaluatedLayout.getValue("text-radial-offset")?(Gc=(hd=xu.layout.get("text-offset").evaluate(Gs,{},bu).map(function(cc){return 24*cc}))[0],vh=hd[1]):(Gc=24*xu.layout.get("text-radial-offset").evaluate(Gs,{},bu),vh=Ll),Io.allowVerticalPlacement&&Ou.vertical){var _h=xu.layout.get("text-rotate").evaluate(Gs,{},bu)+90;ul=new Ic(ip,su,zc,Fc,op,Ou.vertical,ap,Bc,Uc,_h),kc&&(qc=new Ic(ip,su,zc,Fc,op,kc,up,ef,Uc,_h))}if(rp){var Vc=xu.layout.get("icon-rotate").evaluate(Gs,{}),Zc="none"!==xu.layout.get("icon-text-fit"),jc=Gp(rp,Vc,cd,Zc),ll=kc?Gp(kc,Vc,cd,Zc):void 0;sl=new Ic(ip,su,zc,Fc,op,rp,up,ef,!1,Vc),pd=4*jc.length;var of=Io.iconSizeData,Xc=null;"source"===of.kind?(Xc=[128*xu.layout.get("icon-size").evaluate(Gs,{})])[0]>32640&&bt(Io.layerIds[0]+': Value for "icon-size" is >= 255. Reduce your "icon-size".'):"composite"===of.kind&&((Xc=[128*cp.compositeIconSizes[0].evaluate(Gs,{},bu),128*cp.compositeIconSizes[1].evaluate(Gs,{},bu)])[0]>32640||Xc[1]>32640)&&bt(Io.layerIds[0]+': Value for "icon-size" is >= 255. Reduce your "icon-size".'),Io.addSymbols(Io.icon,jc,Xc,lp,rf,Gs,!1,su,uc.lineStartIndex,uc.lineLength,-1,bu),Vl=Io.icon.placedSymbolArray.length-1,ll&&(fd=4*ll.length,Io.addSymbols(Io.icon,ll,Xc,lp,rf,Gs,Rs.vertical,su,uc.lineStartIndex,uc.lineLength,-1,bu),lc=Io.icon.placedSymbolArray.length-1)}for(var af in Ou.horizontal){var xh=Ou.horizontal[af];if(!ju){gd=qt(xh.text);var md=xu.layout.get("text-rotate").evaluate(Gs,{},bu);ju=new Ic(ip,su,zc,Fc,op,xh,ap,Bc,Uc,md)}var bh=1===xh.positionedLines.length;if(dd+=Vp(Io,su,xh,np,xu,Uc,Gs,sp,uc,Ou.vertical?Rs.horizontal:Rs.horizontalOnly,bh?Object.keys(Ou.horizontal):[af],Xu,Vl,cp,bu),bh)break}Ou.vertical&&(nf+=Vp(Io,su,Ou.vertical,np,xu,Uc,Gs,sp,uc,Rs.vertical,["vertical"],Xu,lc,cp,bu));var yd=ju?ju.boxStartIndex:Io.collisionBoxArray.length,wh=ju?ju.boxEndIndex:Io.collisionBoxArray.length,sf=ul?ul.boxStartIndex:Io.collisionBoxArray.length,uf=ul?ul.boxEndIndex:Io.collisionBoxArray.length,Eh=sl?sl.boxStartIndex:Io.collisionBoxArray.length,lf=sl?sl.boxEndIndex:Io.collisionBoxArray.length,cf=qc?qc.boxStartIndex:Io.collisionBoxArray.length,hf=qc?qc.boxEndIndex:Io.collisionBoxArray.length,Du=-1,Yc=function(cc,hp){return cc&&cc.circleDiameter?Math.max(cc.circleDiameter,hp):hp};Du=Yc(ju,Du),Du=Yc(ul,Du),Du=Yc(sl,Du);var vd=(Du=Yc(qc,Du))>-1?1:0;vd&&(Du*=sg/24),Io.glyphOffsetArray.length>=Ii.MAX_GLYPHS&&bt("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),void 0!==Gs.sortKey&&Io.addToSortKeyRanges(Io.symbolInstances.length,Gs.sortKey),Io.symbolInstances.emplaceBack(su.x,su.y,Xu.right>=0?Xu.right:-1,Xu.center>=0?Xu.center:-1,Xu.left>=0?Xu.left:-1,Xu.vertical||-1,Vl,lc,gd,yd,wh,sf,uf,Eh,lf,cf,hf,zc,dd,nf,pd,fd,vd,0,ap,Gc,vh,Du)}(Dn,Nc,ld,si,Kn,cs,_u,Dn.layers[0],Dn.collisionBoxArray,Ai.index,Ai.sourceLayerIndex,Dn.index,Ss,Lc,mh,ri,Lu,Nl,ps,Ns,Ai,ca,In,hs,En)};if("line"===Vu)for(var Zu=0,kl=jh(Ai.geometry,0,0,8192,8192);Zu<kl.length;Zu+=1)for(var zl=kl[Zu],nl=0,il=ec(zl,Rl,Oc,si.vertical||Na,Kn,24,rl,Dn.overscaling,8192);nl<il.length;nl+=1){var Fl=il[nl];Na&&Kd(Dn,Na.text,ac,Fl)||au(zl,Fl)}else if("line-center"===Vu)for(var ol=0,Bl=Ai.geometry;ol<Bl.length;ol+=1){var Ul=Bl[ol];if(Ul.length>1){var sc=tc(Ul,Oc,si.vertical||Na,Kn,24,rl);sc&&au(Ul,sc)}}else if("Polygon"===Ai.type)for(var ql=0,Rc=Cp(Ai.geometry,0);ql<Rc.length;ql+=1){var Ea=Rc[ql],ka=td(Ea,16);au(Ea[0],new Ql(ka.x,ka.y,0))}else if("LineString"===Ai.type)for(var ha=0,Cs=Ai.geometry;ha<Cs.length;ha+=1){var al=Cs[ha];au(al,new Ql(al[0].x,al[0].y,0))}else if("Point"===Ai.type)for(var Gl=0,tp=Ai.geometry;Gl<tp.length;Gl+=1)for(var ep=0,tf=tp[Gl];ep<tf.length;ep+=1){var yh=tf[ep];au([yh],new Ql(yh.x,yh.y,0))}}(t,ue,hr,ua,d,U,fr,Nr,Qe,Ra,S)},de=0,Pe=t.features;de<Pe.length;de+=1)pe();w&&t.generateCollisionDebugBuffers()},y.perspective=function(t,r,s,d,_){var w,S=1/Math.tan(r/2);return t[0]=S/s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=S,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,null!=_&&_!==1/0?(t[10]=(_+d)*(w=1/(d-_)),t[14]=2*_*d*w):(t[10]=-1,t[14]=-2*d),t},y.pick=function(t,r){for(var s={},d=0;d<r.length;d++){var _=r[d];_ in t&&(s[_]=t[_])}return s},y.plugin=Sn,y.polygonIntersectsPolygon=xa,y.postMapLoadEvent=cn,y.postTurnstileEvent=Re,y.potpack=Ml,y.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],y.register=nr,y.registerForPluginStateChange=function(t){return t({pluginStatus:no,pluginURL:zi}),Ko.on("pluginStateChange",t),t},y.renderColorRamp=bp,y.rotate=function(t,r,s){var d=r[0],_=r[1],w=r[2],S=r[3],A=Math.sin(s),F=Math.cos(s);return t[0]=d*F+w*A,t[1]=_*F+S*A,t[2]=d*-A+w*F,t[3]=_*-A+S*F,t},y.rotateX=function(t,r,s){var d=Math.sin(s),_=Math.cos(s),w=r[4],S=r[5],A=r[6],F=r[7],U=r[8],G=r[9],V=r[10],K=r[11];return r!==t&&(t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[12]=r[12],t[13]=r[13],t[14]=r[14],t[15]=r[15]),t[4]=w*_+U*d,t[5]=S*_+G*d,t[6]=A*_+V*d,t[7]=F*_+K*d,t[8]=U*_-w*d,t[9]=G*_-S*d,t[10]=V*_-A*d,t[11]=K*_-F*d,t},y.rotateZ=function(t,r,s){var d=Math.sin(s),_=Math.cos(s),w=r[0],S=r[1],A=r[2],F=r[3],U=r[4],G=r[5],V=r[6],K=r[7];return r!==t&&(t[8]=r[8],t[9]=r[9],t[10]=r[10],t[11]=r[11],t[12]=r[12],t[13]=r[13],t[14]=r[14],t[15]=r[15]),t[0]=w*_+U*d,t[1]=S*_+G*d,t[2]=A*_+V*d,t[3]=F*_+K*d,t[4]=U*_-w*d,t[5]=G*_-S*d,t[6]=V*_-A*d,t[7]=K*_-F*d,t},y.scale=function(t,r,s){var d=s[0],_=s[1],w=s[2];return t[0]=r[0]*d,t[1]=r[1]*d,t[2]=r[2]*d,t[3]=r[3]*d,t[4]=r[4]*_,t[5]=r[5]*_,t[6]=r[6]*_,t[7]=r[7]*_,t[8]=r[8]*w,t[9]=r[9]*w,t[10]=r[10]*w,t[11]=r[11]*w,t[12]=r[12],t[13]=r[13],t[14]=r[14],t[15]=r[15],t},y.scale$1=function(t,r,s){return t[0]=r[0]*s,t[1]=r[1]*s,t[2]=r[2]*s,t[3]=r[3]*s,t},y.scale$2=function(t,r,s){return t[0]=r[0]*s,t[1]=r[1]*s,t[2]=r[2]*s,t},y.setCacheLimits=function(t,r){ur=t,Jr=r},y.setRTLTextPlugin=function(t,r,s){if(void 0===s&&(s=!1),"deferred"===no||"loading"===no||"loaded"===no)throw new Error("setRTLTextPlugin cannot be called multiple times.");zi=Zr.resolveURL(t),no="deferred",eu=r,gu(),s||qu()},y.sphericalToCartesian=function(t){var r=t[0],s=t[1],d=t[2];return s+=90,s*=Math.PI/180,d*=Math.PI/180,{x:r*Math.cos(s)*Math.sin(d),y:r*Math.sin(s)*Math.sin(d),z:r*Math.cos(d)}},y.sqrLen=function(t){var r=t[0],s=t[1];return r*r+s*s},y.styleSpec=xt,y.sub=function(t,r,s){return t[0]=r[0]-s[0],t[1]=r[1]-s[1],t[2]=r[2]-s[2],t},y.symbolSize=Qf,y.transformMat3=function(t,r,s){var d=r[0],_=r[1],w=r[2];return t[0]=d*s[0]+_*s[3]+w*s[6],t[1]=d*s[1]+_*s[4]+w*s[7],t[2]=d*s[2]+_*s[5]+w*s[8],t},y.transformMat4=Xl,y.translate=function(t,r,s){var d,_,w,S,A,F,U,G,V,K,at,Ct,_t=s[0],Wt=s[1],Gt=s[2];return r===t?(t[12]=r[0]*_t+r[4]*Wt+r[8]*Gt+r[12],t[13]=r[1]*_t+r[5]*Wt+r[9]*Gt+r[13],t[14]=r[2]*_t+r[6]*Wt+r[10]*Gt+r[14],t[15]=r[3]*_t+r[7]*Wt+r[11]*Gt+r[15]):(_=r[1],w=r[2],S=r[3],A=r[4],F=r[5],U=r[6],G=r[7],V=r[8],K=r[9],at=r[10],Ct=r[11],t[0]=d=r[0],t[1]=_,t[2]=w,t[3]=S,t[4]=A,t[5]=F,t[6]=U,t[7]=G,t[8]=V,t[9]=K,t[10]=at,t[11]=Ct,t[12]=d*_t+A*Wt+V*Gt+r[12],t[13]=_*_t+F*Wt+K*Gt+r[13],t[14]=w*_t+U*Wt+at*Gt+r[14],t[15]=S*_t+G*Wt+Ct*Gt+r[15]),t},y.triggerPluginCompletionEvent=Lo,y.uniqueId=X,y.validateCustomStyleLayer=function(t){var r=[],s=t.id;return void 0===s&&r.push({message:"layers."+s+': missing required property "id"'}),void 0===t.render&&r.push({message:"layers."+s+': missing required method "render"'}),t.renderingMode&&"2d"!==t.renderingMode&&"3d"!==t.renderingMode&&r.push({message:"layers."+s+': property "renderingMode" must be either "2d" or "3d"'}),r},y.validateLight=Ja,y.validateStyle=Ma,y.values=function(t){var r=[];for(var s in t)r.push(t[s]);return r},y.vectorTile=yc,y.version="1.15.2",y.warnOnce=bt,y.webpSupported=Yr,y.window=Jt,y.wrap=We}),D(0,function(y){function Bt(Z){var Y=typeof Z;if("number"===Y||"boolean"===Y||"string"===Y||null==Z)return JSON.stringify(Z);if(Array.isArray(Z)){for(var it="[",ht=0,Ot=Z;ht<Ot.length;ht+=1)it+=Bt(Ot[ht])+",";return it+"]"}for(var Xt=Object.keys(Z).sort(),ne="{",Yt=0;Yt<Xt.length;Yt++)ne+=JSON.stringify(Xt[Yt])+":"+Bt(Z[Xt[Yt]])+",";return ne+"}"}function ft(Z){for(var Y="",it=0,ht=y.refProperties;it<ht.length;it+=1)Y+="/"+Bt(Z[ht[it]]);return Y}var It=function(Z){this.keyCache={},Z&&this.replace(Z)};It.prototype.replace=function(Z){this._layerConfigs={},this._layers={},this.update(Z,[])},It.prototype.update=function(Z,Y){for(var it=this,ht=0,Ot=Z;ht<Ot.length;ht+=1){var Xt=Ot[ht];this._layerConfigs[Xt.id]=Xt;var ne=this._layers[Xt.id]=y.createStyleLayer(Xt);ne._featureFilter=y.featureFilter(ne.filter),this.keyCache[Xt.id]&&delete this.keyCache[Xt.id]}for(var Yt=0,xt=Y;Yt<xt.length;Yt+=1){var Ut=xt[Yt];delete this.keyCache[Ut],delete this._layerConfigs[Ut],delete this._layers[Ut]}this.familiesBySource={};for(var je=0,or=function(sr,Be){for(var sn={},qr=0;qr<sr.length;qr++){var Tr=Be&&Be[sr[qr].id]||ft(sr[qr]);Be&&(Be[sr[qr].id]=Tr);var wr=sn[Tr];wr||(wr=sn[Tr]=[]),wr.push(sr[qr])}var zr=[];for(var ui in sn)zr.push(sn[ui]);return zr}(y.values(this._layerConfigs),this.keyCache);je<or.length;je+=1){var ye=or[je].map(function(sr){return it._layers[sr.id]}),Le=ye[0];if("none"!==Le.visibility){var lr=Le.source||"",pr=this.familiesBySource[lr];pr||(pr=this.familiesBySource[lr]={});var Pr=Le.sourceLayer||"_geojsonTileLayer",De=pr[Pr];De||(De=pr[Pr]=[]),De.push(ye)}}};var Ft=function(Z){var Y={},it=[];for(var ht in Z){var Ot=Z[ht],Xt=Y[ht]={};for(var ne in Ot){var Yt=Ot[+ne];if(Yt&&0!==Yt.bitmap.width&&0!==Yt.bitmap.height){var xt={x:0,y:0,w:Yt.bitmap.width+2,h:Yt.bitmap.height+2};it.push(xt),Xt[ne]={rect:xt,metrics:Yt.metrics}}}}var Ut=y.potpack(it),je=new y.AlphaImage({width:Ut.w||1,height:Ut.h||1});for(var or in Z){var ye=Z[or];for(var Le in ye){var lr=ye[+Le];if(lr&&0!==lr.bitmap.width&&0!==lr.bitmap.height){var pr=Y[or][Le].rect;y.AlphaImage.copy(lr.bitmap,je,{x:0,y:0},{x:pr.x+1,y:pr.y+1},lr.bitmap)}}}this.image=je,this.positions=Y};y.register("GlyphAtlas",Ft);var he=function(Z){this.tileID=new y.OverscaledTileID(Z.tileID.overscaledZ,Z.tileID.wrap,Z.tileID.canonical.z,Z.tileID.canonical.x,Z.tileID.canonical.y),this.uid=Z.uid,this.zoom=Z.zoom,this.pixelRatio=Z.pixelRatio,this.tileSize=Z.tileSize,this.source=Z.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=Z.showCollisionBoxes,this.collectResourceTiming=!!Z.collectResourceTiming,this.returnDependencies=!!Z.returnDependencies,this.promoteId=Z.promoteId};function Jt(Z,Y,it){for(var ht=new y.EvaluationParameters(Y),Ot=0,Xt=Z;Ot<Xt.length;Ot+=1)Xt[Ot].recalculate(ht,it)}function Ze(Z,Y){var it=y.getArrayBuffer(Z.request,function(ht,Ot,Xt,ne){ht?Y(ht):Ot&&Y(null,{vectorTile:new y.vectorTile.VectorTile(new y.pbf(Ot)),rawData:Ot,cacheControl:Xt,expires:ne})});return function(){it.cancel(),Y()}}he.prototype.parse=function(Z,Y,it,ht,Ot){var Xt=this;this.status="parsing",this.data=Z,this.collisionBoxArray=new y.CollisionBoxArray;var ne=new y.DictionaryCoder(Object.keys(Z.layers).sort()),Yt=new y.FeatureIndex(this.tileID,this.promoteId);Yt.bucketLayerIDs=[];var xt,Ut,je,or,ye={},Le={featureIndex:Yt,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:it},lr=Y.familiesBySource[this.source];for(var pr in lr){var Pr=Z.layers[pr];if(Pr){1===Pr.version&&y.warnOnce('Vector tile source "'+this.source+'" layer "'+pr+'" does not use vector tile spec v2 and therefore may have some rendering errors.');for(var De=ne.encode(pr),sr=[],Be=0;Be<Pr.length;Be++){var sn=Pr.feature(Be),qr=Yt.getId(sn,pr);sr.push({feature:sn,id:qr,index:Be,sourceLayerIndex:De})}for(var Tr=0,wr=lr[pr];Tr<wr.length;Tr+=1){var zr=wr[Tr],ui=zr[0];ui.minzoom&&this.zoom<Math.floor(ui.minzoom)||ui.maxzoom&&this.zoom>=ui.maxzoom||"none"!==ui.visibility&&(Jt(zr,this.zoom,it),(ye[ui.id]=ui.createBucket({index:Yt.bucketLayerIDs.length,layers:zr,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:De,sourceID:this.source})).populate(sr,Le,this.tileID.canonical),Yt.bucketLayerIDs.push(zr.map(function(zn){return zn.id})))}}}var Tn=y.mapObject(Le.glyphDependencies,function(zn){return Object.keys(zn).map(Number)});Object.keys(Tn).length?ht.send("getGlyphs",{uid:this.uid,stacks:Tn},function(zn,un){xt||(xt=zn,Ut=un,xi.call(Xt))}):Ut={};var xn=Object.keys(Le.iconDependencies);xn.length?ht.send("getImages",{icons:xn,source:this.source,tileID:this.tileID,type:"icons"},function(zn,un){xt||(xt=zn,je=un,xi.call(Xt))}):je={};var ln=Object.keys(Le.patternDependencies);function xi(){if(xt)return Ot(xt);if(Ut&&je&&or){var zn=new Ft(Ut),un=new y.ImageAtlas(je,or);for(var ko in ye){var An=ye[ko];An instanceof y.SymbolBucket?(Jt(An.layers,this.zoom,it),y.performSymbolLayout(An,Ut,zn.positions,je,un.iconPositions,this.showCollisionBoxes,this.tileID.canonical)):An.hasPattern&&(An instanceof y.LineBucket||An instanceof y.FillBucket||An instanceof y.FillExtrusionBucket)&&(Jt(An.layers,this.zoom,it),An.addFeatures(Le,this.tileID.canonical,un.patternPositions))}this.status="done",Ot(null,{buckets:y.values(ye).filter(function(gs){return!gs.isEmpty()}),featureIndex:Yt,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:zn.image,imageAtlas:un,glyphMap:this.returnDependencies?Ut:null,iconMap:this.returnDependencies?je:null,glyphPositions:this.returnDependencies?zn.positions:null})}}ln.length?ht.send("getImages",{icons:ln,source:this.source,tileID:this.tileID,type:"patterns"},function(zn,un){xt||(xt=zn,or=un,xi.call(Xt))}):or={},xi.call(this)};var ve=function(Z,Y,it,ht){this.actor=Z,this.layerIndex=Y,this.availableImages=it,this.loadVectorData=ht||Ze,this.loading={},this.loaded={}};ve.prototype.loadTile=function(Z,Y){var it=this,ht=Z.uid;this.loading||(this.loading={});var Ot=!!(Z&&Z.request&&Z.request.collectResourceTiming)&&new y.RequestPerformance(Z.request),Xt=this.loading[ht]=new he(Z);Xt.abort=this.loadVectorData(Z,function(ne,Yt){if(delete it.loading[ht],ne||!Yt)return Xt.status="done",it.loaded[ht]=Xt,Y(ne);var xt=Yt.rawData,Ut={};Yt.expires&&(Ut.expires=Yt.expires),Yt.cacheControl&&(Ut.cacheControl=Yt.cacheControl);var je={};if(Ot){var or=Ot.finish();or&&(je.resourceTiming=JSON.parse(JSON.stringify(or)))}Xt.vectorTile=Yt.vectorTile,Xt.parse(Yt.vectorTile,it.layerIndex,it.availableImages,it.actor,function(ye,Le){if(ye||!Le)return Y(ye);Y(null,y.extend({rawTileData:xt.slice(0)},Le,Ut,je))}),it.loaded=it.loaded||{},it.loaded[ht]=Xt})},ve.prototype.reloadTile=function(Z,Y){var it=this,ht=this.loaded,Ot=Z.uid,Xt=this;if(ht&&ht[Ot]){var ne=ht[Ot];ne.showCollisionBoxes=Z.showCollisionBoxes;var Yt=function(xt,Ut){var je=ne.reloadCallback;je&&(delete ne.reloadCallback,ne.parse(ne.vectorTile,Xt.layerIndex,it.availableImages,Xt.actor,je)),Y(xt,Ut)};"parsing"===ne.status?ne.reloadCallback=Yt:"done"===ne.status&&(ne.vectorTile?ne.parse(ne.vectorTile,this.layerIndex,this.availableImages,this.actor,Yt):Yt())}},ve.prototype.abortTile=function(Z,Y){var it=this.loading,ht=Z.uid;it&&it[ht]&&it[ht].abort&&(it[ht].abort(),delete it[ht]),Y()},ve.prototype.removeTile=function(Z,Y){var it=this.loaded,ht=Z.uid;it&&it[ht]&&delete it[ht],Y()};var ce=y.window.ImageBitmap,_e=function(){this.loaded={}};function We(Z,Y){if(0!==Z.length){kt(Z[0],Y);for(var it=1;it<Z.length;it++)kt(Z[it],!Y)}}function kt(Z,Y){for(var it=0,ht=0,Ot=Z.length,Xt=Ot-1;ht<Ot;Xt=ht++)it+=(Z[ht][0]-Z[Xt][0])*(Z[Xt][1]+Z[ht][1]);it>=0!=!!Y&&Z.reverse()}_e.prototype.loadTile=function(Z,Y){var it=Z.uid,ht=Z.encoding,Ot=Z.rawImageData,Xt=ce&&Ot instanceof ce?this.getImageData(Ot):Ot,ne=new y.DEMData(it,Xt,ht);this.loaded=this.loaded||{},this.loaded[it]=ne,Y(null,ne)},_e.prototype.getImageData=function(Z){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(Z.width,Z.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d")),this.offscreenCanvas.width=Z.width,this.offscreenCanvas.height=Z.height,this.offscreenCanvasContext.drawImage(Z,0,0,Z.width,Z.height);var Y=this.offscreenCanvasContext.getImageData(-1,-1,Z.width+2,Z.height+2);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),new y.RGBAImage({width:Y.width,height:Y.height},Y.data)},_e.prototype.removeTile=function(Z){var Y=this.loaded,it=Z.uid;Y&&Y[it]&&delete Y[it]};var ie=y.vectorTile.VectorTileFeature.prototype.toGeoJSON,X=function(Z){this._feature=Z,this.extent=y.EXTENT,this.type=Z.type,this.properties=Z.tags,"id"in Z&&!isNaN(Z.id)&&(this.id=parseInt(Z.id,10))};X.prototype.loadGeometry=function(){if(1===this._feature.type){for(var Z=[],Y=0,it=this._feature.geometry;Y<it.length;Y+=1){var ht=it[Y];Z.push([new y.Point$1(ht[0],ht[1])])}return Z}for(var Ot=[],Xt=0,ne=this._feature.geometry;Xt<ne.length;Xt+=1){for(var Yt=[],xt=0,Ut=ne[Xt];xt<Ut.length;xt+=1){var je=Ut[xt];Yt.push(new y.Point$1(je[0],je[1]))}Ot.push(Yt)}return Ot},X.prototype.toGeoJSON=function(Z,Y,it){return ie.call(this,Z,Y,it)};var J=function(Z){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=y.EXTENT,this.length=Z.length,this._features=Z};J.prototype.feature=function(Z){return new X(this._features[Z])};var $=y.vectorTile.VectorTileFeature,St=Q;function Q(Z,Y){this.options=Y||{},this.features=Z,this.length=Z.length}function et(Z,Y){this.id="number"==typeof Z.id?Z.id:void 0,this.type=Z.type,this.rawGeometry=1===Z.type?[Z.geometry]:Z.geometry,this.properties=Z.tags,this.extent=Y||4096}Q.prototype.feature=function(Z){return new et(this.features[Z],this.options.extent)},et.prototype.loadGeometry=function(){var Z=this.rawGeometry;this.geometry=[];for(var Y=0;Y<Z.length;Y++){for(var it=Z[Y],ht=[],Ot=0;Ot<it.length;Ot++)ht.push(new y.Point$1(it[Ot][0],it[Ot][1]));this.geometry.push(ht)}return this.geometry},et.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var Z=this.geometry,Y=1/0,it=-1/0,ht=1/0,Ot=-1/0,Xt=0;Xt<Z.length;Xt++)for(var ne=Z[Xt],Yt=0;Yt<ne.length;Yt++){var xt=ne[Yt];Y=Math.min(Y,xt.x),it=Math.max(it,xt.x),ht=Math.min(ht,xt.y),Ot=Math.max(Ot,xt.y)}return[Y,ht,it,Ot]},et.prototype.toGeoJSON=$.prototype.toGeoJSON;var st=$t,j=St;function $t(Z){var Y=new y.pbf;return function(it,ht){for(var Ot in it.layers)ht.writeMessage(3,bt,it.layers[Ot])}(Z,Y),Y.finish()}function bt(Z,Y){var it;Y.writeVarintField(15,Z.version||1),Y.writeStringField(1,Z.name||""),Y.writeVarintField(5,Z.extent||4096);var ht={keys:[],values:[],keycache:{},valuecache:{}};for(it=0;it<Z.length;it++)ht.feature=Z.feature(it),Y.writeMessage(2,Mt,ht);var Ot=ht.keys;for(it=0;it<Ot.length;it++)Y.writeStringField(3,Ot[it]);var Xt=ht.values;for(it=0;it<Xt.length;it++)Y.writeMessage(4,re,Xt[it])}function Mt(Z,Y){var it=Z.feature;void 0!==it.id&&Y.writeVarintField(1,it.id),Y.writeMessage(2,ct,Z),Y.writeVarintField(3,it.type),Y.writeMessage(4,wt,it)}function ct(Z,Y){var it=Z.feature,ht=Z.keys,Ot=Z.values,Xt=Z.keycache,ne=Z.valuecache;for(var Yt in it.properties){var xt=Xt[Yt];void 0===xt&&(ht.push(Yt),Xt[Yt]=xt=ht.length-1),Y.writeVarint(xt);var Ut=it.properties[Yt],je=typeof Ut;"string"!==je&&"boolean"!==je&&"number"!==je&&(Ut=JSON.stringify(Ut));var or=je+":"+Ut,ye=ne[or];void 0===ye&&(Ot.push(Ut),ne[or]=ye=Ot.length-1),Y.writeVarint(ye)}}function ze(Z,Y){return(Y<<3)+(7&Z)}function Te(Z){return Z<<1^Z>>31}function wt(Z,Y){for(var it=Z.loadGeometry(),ht=Z.type,Ot=0,Xt=0,ne=it.length,Yt=0;Yt<ne;Yt++){var xt=it[Yt],Ut=1;1===ht&&(Ut=xt.length),Y.writeVarint(ze(1,Ut));for(var je=3===ht?xt.length-1:xt.length,or=0;or<je;or++){1===or&&1!==ht&&Y.writeVarint(ze(2,je-1));var ye=xt[or].x-Ot,Le=xt[or].y-Xt;Y.writeVarint(Te(ye)),Y.writeVarint(Te(Le)),Ot+=ye,Xt+=Le}3===ht&&Y.writeVarint(ze(7,1))}}function re(Z,Y){var it=typeof Z;"string"===it?Y.writeStringField(1,Z):"boolean"===it?Y.writeBooleanField(7,Z):"number"===it&&(Z%1!=0?Y.writeDoubleField(3,Z):Z<0?Y.writeSVarintField(6,Z):Y.writeVarintField(5,Z))}function Tt(Z,Y,it,ht){Ht(Z,it,ht),Ht(Y,2*it,2*ht),Ht(Y,2*it+1,2*ht+1)}function Ht(Z,Y,it){var ht=Z[Y];Z[Y]=Z[it],Z[it]=ht}function Qt(Z,Y,it,ht){var Ot=Z-it,Xt=Y-ht;return Ot*Ot+Xt*Xt}st.fromVectorTileJs=$t,st.fromGeojsonVt=function(Z,Y){Y=Y||{};var it={};for(var ht in Z)it[ht]=new St(Z[ht].features,Y),it[ht].name=ht,it[ht].version=Y.version,it[ht].extent=Y.extent;return $t({layers:it})},st.GeoJSONWrapper=j;var vt=function(Z){return Z[0]},we=function(Z){return Z[1]},Fe=function(Z,Y,it,ht,Ot){void 0===Y&&(Y=vt),void 0===it&&(it=we),void 0===ht&&(ht=64),void 0===Ot&&(Ot=Float64Array),this.nodeSize=ht,this.points=Z;for(var Xt=Z.length<65536?Uint16Array:Uint32Array,ne=this.ids=new Xt(Z.length),Yt=this.coords=new Ot(2*Z.length),xt=0;xt<Z.length;xt++)ne[xt]=xt,Yt[2*xt]=Y(Z[xt]),Yt[2*xt+1]=it(Z[xt]);!function Ut(je,or,ye,Le,lr,pr){if(!(lr-Le<=ye)){var Pr=Le+lr>>1;(function De(sr,Be,sn,qr,Tr,wr){for(;Tr>qr;){if(Tr-qr>600){var zr=Tr-qr+1,ui=sn-qr+1,Tn=Math.log(zr),xn=.5*Math.exp(2*Tn/3),ln=.5*Math.sqrt(Tn*xn*(zr-xn)/zr)*(ui-zr/2<0?-1:1);De(sr,Be,sn,Math.max(qr,Math.floor(sn-ui*xn/zr+ln)),Math.min(Tr,Math.floor(sn+(zr-ui)*xn/zr+ln)),wr)}var xi=Be[2*sn+wr],zn=qr,un=Tr;for(Tt(sr,Be,qr,sn),Be[2*Tr+wr]>xi&&Tt(sr,Be,qr,Tr);zn<un;){for(Tt(sr,Be,zn,un),zn++,un--;Be[2*zn+wr]<xi;)zn++;for(;Be[2*un+wr]>xi;)un--}Be[2*qr+wr]===xi?Tt(sr,Be,qr,un):Tt(sr,Be,++un,Tr),un<=sn&&(qr=un+1),sn<=un&&(Tr=un-1)}})(je,or,Pr,Le,lr,pr%2),Ut(je,or,ye,Le,Pr-1,pr+1),Ut(je,or,ye,Pr+1,lr,pr+1)}}(ne,Yt,ht,0,ne.length-1,0)};Fe.prototype.range=function(Z,Y,it,ht){return function(Ot,Xt,ne,Yt,xt,Ut,je){for(var or,ye,Le=[0,Ot.length-1,0],lr=[];Le.length;){var pr=Le.pop(),Pr=Le.pop(),De=Le.pop();if(Pr-De<=je)for(var sr=De;sr<=Pr;sr++)ye=Xt[2*sr+1],(or=Xt[2*sr])>=ne&&or<=xt&&ye>=Yt&&ye<=Ut&&lr.push(Ot[sr]);else{var Be=Math.floor((De+Pr)/2);ye=Xt[2*Be+1],(or=Xt[2*Be])>=ne&&or<=xt&&ye>=Yt&&ye<=Ut&&lr.push(Ot[Be]);var sn=(pr+1)%2;(0===pr?ne<=or:Yt<=ye)&&(Le.push(De),Le.push(Be-1),Le.push(sn)),(0===pr?xt>=or:Ut>=ye)&&(Le.push(Be+1),Le.push(Pr),Le.push(sn))}}return lr}(this.ids,this.coords,Z,Y,it,ht,this.nodeSize)},Fe.prototype.within=function(Z,Y,it){return function(ht,Ot,Xt,ne,Yt,xt){for(var Ut=[0,ht.length-1,0],je=[],or=Yt*Yt;Ut.length;){var ye=Ut.pop(),Le=Ut.pop(),lr=Ut.pop();if(Le-lr<=xt)for(var pr=lr;pr<=Le;pr++)Qt(Ot[2*pr],Ot[2*pr+1],Xt,ne)<=or&&je.push(ht[pr]);else{var Pr=Math.floor((lr+Le)/2),De=Ot[2*Pr],sr=Ot[2*Pr+1];Qt(De,sr,Xt,ne)<=or&&je.push(ht[Pr]);var Be=(ye+1)%2;(0===ye?Xt-Yt<=De:ne-Yt<=sr)&&(Ut.push(lr),Ut.push(Pr-1),Ut.push(Be)),(0===ye?Xt+Yt>=De:ne+Yt>=sr)&&(Ut.push(Pr+1),Ut.push(Le),Ut.push(Be))}}return je}(this.ids,this.coords,Z,Y,it,this.nodeSize)};var Er={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:function(Z){return Z}},Oe=function(Z){this.options=fi(Object.create(Er),Z),this.trees=new Array(this.options.maxZoom+1)};function Zr(Z,Y,it,ht,Ot){return{x:Z,y:Y,zoom:1/0,id:it,parentId:-1,numPoints:ht,properties:Ot}}function Mr(Z,Y){var it=Z.geometry.coordinates,ht=it[1];return{x:Cr(it[0]),y:ke(ht),zoom:1/0,index:Y,parentId:-1}}function Yr(Z){return{type:"Feature",id:Z.id,properties:Sr(Z),geometry:{type:"Point",coordinates:[(ht=Z.x,360*(ht-.5)),(Y=Z.y,it=(180-360*Y)*Math.PI/180,360*Math.atan(Math.exp(it))/Math.PI-90)]}};var Y,it,ht}function Sr(Z){var Y=Z.numPoints,it=Y>=1e4?Math.round(Y/1e3)+"k":Y>=1e3?Math.round(Y/100)/10+"k":Y;return fi(fi({},Z.properties),{cluster:!0,cluster_id:Z.id,point_count:Y,point_count_abbreviated:it})}function Cr(Z){return Z/360+.5}function ke(Z){var Y=Math.sin(Z*Math.PI/180),it=.5-.25*Math.log((1+Y)/(1-Y))/Math.PI;return it<0?0:it>1?1:it}function fi(Z,Y){for(var it in Y)Z[it]=Y[it];return Z}function Mn(Z){return Z.x}function Xn(Z){return Z.y}function li(Z,Y,it,ht,Ot,Xt){var ne=Ot-it,Yt=Xt-ht;if(0!==ne||0!==Yt){var xt=((Z-it)*ne+(Y-ht)*Yt)/(ne*ne+Yt*Yt);xt>1?(it=Ot,ht=Xt):xt>0&&(it+=ne*xt,ht+=Yt*xt)}return(ne=Z-it)*ne+(Yt=Y-ht)*Yt}function Jn(Z,Y,it,ht){var Ot={id:void 0===Z?null:Z,type:Y,geometry:it,tags:ht,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(Xt){var ne=Xt.geometry,Yt=Xt.type;if("Point"===Yt||"MultiPoint"===Yt||"LineString"===Yt)le(Xt,ne);else if("Polygon"===Yt||"MultiLineString"===Yt)for(var xt=0;xt<ne.length;xt++)le(Xt,ne[xt]);else if("MultiPolygon"===Yt)for(xt=0;xt<ne.length;xt++)for(var Ut=0;Ut<ne[xt].length;Ut++)le(Xt,ne[xt][Ut])}(Ot),Ot}function le(Z,Y){for(var it=0;it<Y.length;it+=3)Z.minX=Math.min(Z.minX,Y[it]),Z.minY=Math.min(Z.minY,Y[it+1]),Z.maxX=Math.max(Z.maxX,Y[it]),Z.maxY=Math.max(Z.maxY,Y[it+1])}function ot(Z,Y,it,ht){if(Y.geometry){var Ot=Y.geometry.coordinates,Xt=Y.geometry.type,ne=Math.pow(it.tolerance/((1<<it.maxZoom)*it.extent),2),Yt=[],xt=Y.id;if(it.promoteId?xt=Y.properties[it.promoteId]:it.generateId&&(xt=ht||0),"Point"===Xt)rt(Ot,Yt);else if("MultiPoint"===Xt)for(var Ut=0;Ut<Ot.length;Ut++)rt(Ot[Ut],Yt);else if("LineString"===Xt)tt(Ot,Yt,ne,!1);else if("MultiLineString"===Xt){if(it.lineMetrics){for(Ut=0;Ut<Ot.length;Ut++)tt(Ot[Ut],Yt=[],ne,!1),Z.push(Jn(xt,"LineString",Yt,Y.properties));return}Pt(Ot,Yt,ne,!1)}else if("Polygon"===Xt)Pt(Ot,Yt,ne,!0);else{if("MultiPolygon"!==Xt){if("GeometryCollection"===Xt){for(Ut=0;Ut<Y.geometry.geometries.length;Ut++)ot(Z,{id:xt,geometry:Y.geometry.geometries[Ut],properties:Y.properties},it,ht);return}throw new Error("Input data is not a valid GeoJSON object.")}for(Ut=0;Ut<Ot.length;Ut++){var je=[];Pt(Ot[Ut],je,ne,!0),Yt.push(je)}}Z.push(Jn(xt,Xt,Yt,Y.properties))}}function rt(Z,Y){Y.push(Kt(Z[0])),Y.push(Ee(Z[1])),Y.push(0)}function tt(Z,Y,it,ht){for(var Ot,Xt,ne=0,Yt=0;Yt<Z.length;Yt++){var xt=Kt(Z[Yt][0]),Ut=Ee(Z[Yt][1]);Y.push(xt),Y.push(Ut),Y.push(0),Yt>0&&(ne+=ht?(Ot*Ut-xt*Xt)/2:Math.sqrt(Math.pow(xt-Ot,2)+Math.pow(Ut-Xt,2))),Ot=xt,Xt=Ut}var je=Y.length-3;Y[2]=1,function or(ye,Le,lr,pr){for(var Pr,De=pr,sr=lr-Le>>1,Be=lr-Le,sn=ye[Le],qr=ye[Le+1],Tr=ye[lr],wr=ye[lr+1],zr=Le+3;zr<lr;zr+=3){var ui=li(ye[zr],ye[zr+1],sn,qr,Tr,wr);if(ui>De)Pr=zr,De=ui;else if(ui===De){var Tn=Math.abs(zr-sr);Tn<Be&&(Pr=zr,Be=Tn)}}De>pr&&(Pr-Le>3&&or(ye,Le,Pr,pr),ye[Pr+2]=De,lr-Pr>3&&or(ye,Pr,lr,pr))}(Y,0,je,it),Y[je+2]=1,Y.size=Math.abs(ne),Y.start=0,Y.end=Y.size}function Pt(Z,Y,it,ht){for(var Ot=0;Ot<Z.length;Ot++){var Xt=[];tt(Z[Ot],Xt,it,ht),Y.push(Xt)}}function Kt(Z){return Z/360+.5}function Ee(Z){var Y=Math.sin(Z*Math.PI/180),it=.5-.25*Math.log((1+Y)/(1-Y))/Math.PI;return it<0?0:it>1?1:it}function Ge(Z,Y,it,ht,Ot,Xt,ne,Yt){if(ht/=Y,Xt>=(it/=Y)&&ne<ht)return Z;if(ne<it||Xt>=ht)return null;for(var xt=[],Ut=0;Ut<Z.length;Ut++){var je=Z[Ut],or=je.geometry,ye=je.type,Le=0===Ot?je.minX:je.minY,lr=0===Ot?je.maxX:je.maxY;if(Le>=it&&lr<ht)xt.push(je);else if(!(lr<it||Le>=ht)){var pr=[];if("Point"===ye||"MultiPoint"===ye)Xe(or,pr,it,ht,Ot);else if("LineString"===ye)Re(or,pr,it,ht,Ot,!1,Yt.lineMetrics);else if("MultiLineString"===ye)cn(or,pr,it,ht,Ot,!1);else if("Polygon"===ye)cn(or,pr,it,ht,Ot,!0);else if("MultiPolygon"===ye)for(var Pr=0;Pr<or.length;Pr++){var De=[];cn(or[Pr],De,it,ht,Ot,!0),De.length&&pr.push(De)}if(pr.length){if(Yt.lineMetrics&&"LineString"===ye){for(Pr=0;Pr<pr.length;Pr++)xt.push(Jn(je.id,ye,pr[Pr],je.tags));continue}"LineString"!==ye&&"MultiLineString"!==ye||(1===pr.length?(ye="LineString",pr=pr[0]):ye="MultiLineString"),"Point"!==ye&&"MultiPoint"!==ye||(ye=3===pr.length?"Point":"MultiPoint"),xt.push(Jn(je.id,ye,pr,je.tags))}}}return xt.length?xt:null}function Xe(Z,Y,it,ht,Ot){for(var Xt=0;Xt<Z.length;Xt+=3){var ne=Z[Xt+Ot];ne>=it&&ne<=ht&&(Y.push(Z[Xt]),Y.push(Z[Xt+1]),Y.push(Z[Xt+2]))}}function Re(Z,Y,it,ht,Ot,Xt,ne){for(var Yt,xt,Ut=rn(Z),je=0===Ot?Jr:di,or=Z.start,ye=0;ye<Z.length-3;ye+=3){var Le=Z[ye],lr=Z[ye+1],pr=Z[ye+2],Pr=Z[ye+3],De=Z[ye+4],sr=0===Ot?Le:lr,Be=0===Ot?Pr:De,sn=!1;ne&&(Yt=Math.sqrt(Math.pow(Le-Pr,2)+Math.pow(lr-De,2))),sr<it?Be>it&&(xt=je(Ut,Le,lr,Pr,De,it),ne&&(Ut.start=or+Yt*xt)):sr>ht?Be<ht&&(xt=je(Ut,Le,lr,Pr,De,ht),ne&&(Ut.start=or+Yt*xt)):ur(Ut,Le,lr,pr),Be<it&&sr>=it&&(xt=je(Ut,Le,lr,Pr,De,it),sn=!0),Be>ht&&sr<=ht&&(xt=je(Ut,Le,lr,Pr,De,ht),sn=!0),!Xt&&sn&&(ne&&(Ut.end=or+Yt*xt),Y.push(Ut),Ut=rn(Z)),ne&&(or+=Yt)}var qr=Z.length-3;Le=Z[qr],lr=Z[qr+1],pr=Z[qr+2],(sr=0===Ot?Le:lr)>=it&&sr<=ht&&ur(Ut,Le,lr,pr),qr=Ut.length-3,Xt&&qr>=3&&(Ut[qr]!==Ut[0]||Ut[qr+1]!==Ut[1])&&ur(Ut,Ut[0],Ut[1],Ut[2]),Ut.length&&Y.push(Ut)}function rn(Z){var Y=[];return Y.size=Z.size,Y.start=Z.start,Y.end=Z.end,Y}function cn(Z,Y,it,ht,Ot,Xt){for(var ne=0;ne<Z.length;ne++)Re(Z[ne],Y,it,ht,Ot,Xt,!1)}function ur(Z,Y,it,ht){Z.push(Y),Z.push(it),Z.push(ht)}function Jr(Z,Y,it,ht,Ot,Xt){var ne=(Xt-Y)/(ht-Y);return Z.push(Xt),Z.push(it+(Ot-it)*ne),Z.push(1),ne}function di(Z,Y,it,ht,Ot,Xt){var ne=(Xt-it)/(Ot-it);return Z.push(Y+(ht-Y)*ne),Z.push(Xt),Z.push(1),ne}function On(Z,Y){for(var it=[],ht=0;ht<Z.length;ht++){var Ot,Xt=Z[ht],ne=Xt.type;if("Point"===ne||"MultiPoint"===ne||"LineString"===ne)Ot=Nn(Xt.geometry,Y);else if("MultiLineString"===ne||"Polygon"===ne){Ot=[];for(var Yt=0;Yt<Xt.geometry.length;Yt++)Ot.push(Nn(Xt.geometry[Yt],Y))}else if("MultiPolygon"===ne)for(Ot=[],Yt=0;Yt<Xt.geometry.length;Yt++){for(var xt=[],Ut=0;Ut<Xt.geometry[Yt].length;Ut++)xt.push(Nn(Xt.geometry[Yt][Ut],Y));Ot.push(xt)}it.push(Jn(Xt.id,ne,Ot,Xt.tags))}return it}function Nn(Z,Y){var it=[];it.size=Z.size,void 0!==Z.start&&(it.start=Z.start,it.end=Z.end);for(var ht=0;ht<Z.length;ht+=3)it.push(Z[ht]+Y,Z[ht+1],Z[ht+2]);return it}function _i(Z,Y){if(Z.transformed)return Z;var it,ht,Ot,Xt=1<<Z.z,ne=Z.x,Yt=Z.y;for(it=0;it<Z.features.length;it++){var xt=Z.features[it],Ut=xt.geometry,je=xt.type;if(xt.geometry=[],1===je)for(ht=0;ht<Ut.length;ht+=2)xt.geometry.push(ji(Ut[ht],Ut[ht+1],Y,Xt,ne,Yt));else for(ht=0;ht<Ut.length;ht++){var or=[];for(Ot=0;Ot<Ut[ht].length;Ot+=2)or.push(ji(Ut[ht][Ot],Ut[ht][Ot+1],Y,Xt,ne,Yt));xt.geometry.push(or)}}return Z.transformed=!0,Z}function ji(Z,Y,it,ht,Ot,Xt){return[Math.round(it*(Z*ht-Ot)),Math.round(it*(Y*ht-Xt))]}function fo(Z,Y,it,ht,Ot){for(var Xt=Y===Ot.maxZoom?0:Ot.tolerance/((1<<Y)*Ot.extent),ne={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:it,y:ht,z:Y,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},Yt=0;Yt<Z.length;Yt++){ne.numFeatures++,Xi(ne,Z[Yt],Xt,Ot);var xt=Z[Yt].minX,Ut=Z[Yt].minY,je=Z[Yt].maxX,or=Z[Yt].maxY;xt<ne.minX&&(ne.minX=xt),Ut<ne.minY&&(ne.minY=Ut),je>ne.maxX&&(ne.maxX=je),or>ne.maxY&&(ne.maxY=or)}return ne}function Xi(Z,Y,it,ht){var Ot=Y.geometry,Xt=Y.type,ne=[];if("Point"===Xt||"MultiPoint"===Xt)for(var Yt=0;Yt<Ot.length;Yt+=3)ne.push(Ot[Yt]),ne.push(Ot[Yt+1]),Z.numPoints++,Z.numSimplified++;else if("LineString"===Xt)to(ne,Ot,Z,it,!1,!1);else if("MultiLineString"===Xt||"Polygon"===Xt)for(Yt=0;Yt<Ot.length;Yt++)to(ne,Ot[Yt],Z,it,"Polygon"===Xt,0===Yt);else if("MultiPolygon"===Xt)for(var xt=0;xt<Ot.length;xt++){var Ut=Ot[xt];for(Yt=0;Yt<Ut.length;Yt++)to(ne,Ut[Yt],Z,it,!0,0===Yt)}if(ne.length){var je=Y.tags||null;if("LineString"===Xt&&ht.lineMetrics){for(var or in je={},Y.tags)je[or]=Y.tags[or];je.mapbox_clip_start=Ot.start/Ot.size,je.mapbox_clip_end=Ot.end/Ot.size}var ye={geometry:ne,type:"Polygon"===Xt||"MultiPolygon"===Xt?3:"LineString"===Xt||"MultiLineString"===Xt?2:1,tags:je};null!==Y.id&&(ye.id=Y.id),Z.features.push(ye)}}function to(Z,Y,it,ht,Ot,Xt){var ne=ht*ht;if(ht>0&&Y.size<(Ot?ne:ht))it.numPoints+=Y.length/3;else{for(var Yt=[],xt=0;xt<Y.length;xt+=3)(0===ht||Y[xt+2]>ne)&&(it.numSimplified++,Yt.push(Y[xt]),Yt.push(Y[xt+1])),it.numPoints++;Ot&&function(Ut,je){for(var or=0,ye=0,Le=Ut.length,lr=Le-2;ye<Le;lr=ye,ye+=2)or+=(Ut[ye]-Ut[lr])*(Ut[ye+1]+Ut[lr+1]);if(or>0===je)for(ye=0,Le=Ut.length;ye<Le/2;ye+=2){var pr=Ut[ye],Pr=Ut[ye+1];Ut[ye]=Ut[Le-2-ye],Ut[ye+1]=Ut[Le-1-ye],Ut[Le-2-ye]=pr,Ut[Le-1-ye]=Pr}}(Yt,Xt),Z.push(Yt)}}function $n(Z,Y){var it=(Y=this.options=function(Ot,Xt){for(var ne in Xt)Ot[ne]=Xt[ne];return Ot}(Object.create(this.options),Y)).debug;if(it&&console.time("preprocess data"),Y.maxZoom<0||Y.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(Y.promoteId&&Y.generateId)throw new Error("promoteId and generateId cannot be used together.");var Ot,Xt,ne,Yt,xt,Ut,ht=function(Ot,Xt){var ne=[];if("FeatureCollection"===Ot.type)for(var Yt=0;Yt<Ot.features.length;Yt++)ot(ne,Ot.features[Yt],Xt,Yt);else ot(ne,"Feature"===Ot.type?Ot:{geometry:Ot},Xt);return ne}(Z,Y);this.tiles={},this.tileCoords=[],it&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",Y.indexMaxZoom,Y.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),(Ot=ht,Xt=Y,ne=Xt.buffer/Xt.extent,Yt=Ot,xt=Ge(Ot,1,-1-ne,ne,0,-1,2,Xt),Ut=Ge(Ot,1,1-ne,2+ne,0,-1,2,Xt),(xt||Ut)&&(Yt=Ge(Ot,1,-ne,1+ne,0,-1,2,Xt)||[],xt&&(Yt=On(xt,1).concat(Yt)),Ut&&(Yt=Yt.concat(On(Ut,-1)))),ht=Yt).length&&this.splitTile(ht,0,0,0),it&&(ht.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function go(Z,Y,it){return 32*((1<<Z)*it+Y)+Z}function Oi(Z,Y){var it=Z.tileID.canonical;if(!this._geoJSONIndex)return Y(null,null);var ht=this._geoJSONIndex.getTile(it.z,it.x,it.y);if(!ht)return Y(null,null);var Ot=new J(ht.features),Xt=st(Ot);0===Xt.byteOffset&&Xt.byteLength===Xt.buffer.byteLength||(Xt=new Uint8Array(Xt)),Y(null,{vectorTile:Ot,rawData:Xt.buffer})}Oe.prototype.load=function(Z){var Y=this.options,it=Y.log,ht=Y.minZoom,Ot=Y.maxZoom,Xt=Y.nodeSize;it&&console.time("total time");var ne="prepare "+Z.length+" points";it&&console.time(ne),this.points=Z;for(var Yt=[],xt=0;xt<Z.length;xt++)Z[xt].geometry&&Yt.push(Mr(Z[xt],xt));this.trees[Ot+1]=new Fe(Yt,Mn,Xn,Xt,Float32Array),it&&console.timeEnd(ne);for(var Ut=Ot;Ut>=ht;Ut--){var je=+Date.now();Yt=this._cluster(Yt,Ut),this.trees[Ut]=new Fe(Yt,Mn,Xn,Xt,Float32Array),it&&console.log("z%d: %d clusters in %dms",Ut,Yt.length,+Date.now()-je)}return it&&console.timeEnd("total time"),this},Oe.prototype.getClusters=function(Z,Y){var it=((Z[0]+180)%360+360)%360-180,ht=Math.max(-90,Math.min(90,Z[1])),Ot=180===Z[2]?180:((Z[2]+180)%360+360)%360-180,Xt=Math.max(-90,Math.min(90,Z[3]));if(Z[2]-Z[0]>=360)it=-180,Ot=180;else if(it>Ot){var ne=this.getClusters([it,ht,180,Xt],Y),Yt=this.getClusters([-180,ht,Ot,Xt],Y);return ne.concat(Yt)}for(var xt=this.trees[this._limitZoom(Y)],Ut=[],je=0,or=xt.range(Cr(it),ke(Xt),Cr(Ot),ke(ht));je<or.length;je+=1){var ye=xt.points[or[je]];Ut.push(ye.numPoints?Yr(ye):this.points[ye.index])}return Ut},Oe.prototype.getChildren=function(Z){var Y=this._getOriginId(Z),it=this._getOriginZoom(Z),ht="No cluster with the specified id.",Ot=this.trees[it];if(!Ot)throw new Error(ht);var Xt=Ot.points[Y];if(!Xt)throw new Error(ht);for(var ne=this.options.radius/(this.options.extent*Math.pow(2,it-1)),Yt=[],xt=0,Ut=Ot.within(Xt.x,Xt.y,ne);xt<Ut.length;xt+=1){var je=Ot.points[Ut[xt]];je.parentId===Z&&Yt.push(je.numPoints?Yr(je):this.points[je.index])}if(0===Yt.length)throw new Error(ht);return Yt},Oe.prototype.getLeaves=function(Z,Y,it){var ht=[];return this._appendLeaves(ht,Z,Y=Y||10,it=it||0,0),ht},Oe.prototype.getTile=function(Z,Y,it){var ht=this.trees[this._limitZoom(Z)],Ot=Math.pow(2,Z),Xt=this.options,ne=Xt.radius/Xt.extent,Yt=(it-ne)/Ot,xt=(it+1+ne)/Ot,Ut={features:[]};return this._addTileFeatures(ht.range((Y-ne)/Ot,Yt,(Y+1+ne)/Ot,xt),ht.points,Y,it,Ot,Ut),0===Y&&this._addTileFeatures(ht.range(1-ne/Ot,Yt,1,xt),ht.points,Ot,it,Ot,Ut),Y===Ot-1&&this._addTileFeatures(ht.range(0,Yt,ne/Ot,xt),ht.points,-1,it,Ot,Ut),Ut.features.length?Ut:null},Oe.prototype.getClusterExpansionZoom=function(Z){for(var Y=this._getOriginZoom(Z)-1;Y<=this.options.maxZoom;){var it=this.getChildren(Z);if(Y++,1!==it.length)break;Z=it[0].properties.cluster_id}return Y},Oe.prototype._appendLeaves=function(Z,Y,it,ht,Ot){for(var Xt=0,ne=this.getChildren(Y);Xt<ne.length;Xt+=1){var Yt=ne[Xt],xt=Yt.properties;if(xt&&xt.cluster?Ot+xt.point_count<=ht?Ot+=xt.point_count:Ot=this._appendLeaves(Z,xt.cluster_id,it,ht,Ot):Ot<ht?Ot++:Z.push(Yt),Z.length===it)break}return Ot},Oe.prototype._addTileFeatures=function(Z,Y,it,ht,Ot,Xt){for(var ne=0,Yt=Z;ne<Yt.length;ne+=1){var xt=Y[Yt[ne]],Ut=xt.numPoints,je={type:1,geometry:[[Math.round(this.options.extent*(xt.x*Ot-it)),Math.round(this.options.extent*(xt.y*Ot-ht))]],tags:Ut?Sr(xt):this.points[xt.index].properties},or=void 0;Ut?or=xt.id:this.options.generateId?or=xt.index:this.points[xt.index].id&&(or=this.points[xt.index].id),void 0!==or&&(je.id=or),Xt.features.push(je)}},Oe.prototype._limitZoom=function(Z){return Math.max(this.options.minZoom,Math.min(+Z,this.options.maxZoom+1))},Oe.prototype._cluster=function(Z,Y){for(var it=[],ht=this.options,Ot=ht.reduce,Xt=ht.minPoints,ne=ht.radius/(ht.extent*Math.pow(2,Y)),Yt=0;Yt<Z.length;Yt++){var xt=Z[Yt];if(!(xt.zoom<=Y)){xt.zoom=Y;for(var Ut=this.trees[Y+1],je=Ut.within(xt.x,xt.y,ne),or=xt.numPoints||1,ye=or,Le=0,lr=je;Le<lr.length;Le+=1){var pr=Ut.points[lr[Le]];pr.zoom>Y&&(ye+=pr.numPoints||1)}if(ye>=Xt){for(var Pr=xt.x*or,De=xt.y*or,sr=Ot&&or>1?this._map(xt,!0):null,Be=(Yt<<5)+(Y+1)+this.points.length,sn=0,qr=je;sn<qr.length;sn+=1){var Tr=Ut.points[qr[sn]];if(!(Tr.zoom<=Y)){Tr.zoom=Y;var wr=Tr.numPoints||1;Pr+=Tr.x*wr,De+=Tr.y*wr,Tr.parentId=Be,Ot&&(sr||(sr=this._map(xt,!0)),Ot(sr,this._map(Tr)))}}xt.parentId=Be,it.push(Zr(Pr/ye,De/ye,Be,ye,sr))}else if(it.push(xt),ye>1)for(var zr=0,ui=je;zr<ui.length;zr+=1){var Tn=Ut.points[ui[zr]];Tn.zoom<=Y||(Tn.zoom=Y,it.push(Tn))}}}return it},Oe.prototype._getOriginId=function(Z){return Z-this.points.length>>5},Oe.prototype._getOriginZoom=function(Z){return(Z-this.points.length)%32},Oe.prototype._map=function(Z,Y){if(Z.numPoints)return Y?fi({},Z.properties):Z.properties;var it=this.points[Z.index].properties,ht=this.options.map(it);return Y&&ht===it?fi({},ht):ht},$n.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},$n.prototype.splitTile=function(Z,Y,it,ht,Ot,Xt,ne){for(var Yt=[Z,Y,it,ht],xt=this.options,Ut=xt.debug;Yt.length;){ht=Yt.pop(),it=Yt.pop(),Y=Yt.pop(),Z=Yt.pop();var je=1<<Y,or=go(Y,it,ht),ye=this.tiles[or];if(!ye&&(Ut>1&&console.time("creation"),ye=this.tiles[or]=fo(Z,Y,it,ht,xt),this.tileCoords.push({z:Y,x:it,y:ht}),Ut)){Ut>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",Y,it,ht,ye.numFeatures,ye.numPoints,ye.numSimplified),console.timeEnd("creation"));var Le="z"+Y;this.stats[Le]=(this.stats[Le]||0)+1,this.total++}if(ye.source=Z,Ot){if(Y===xt.maxZoom||Y===Ot)continue;var lr=1<<Ot-Y;if(it!==Math.floor(Xt/lr)||ht!==Math.floor(ne/lr))continue}else if(Y===xt.indexMaxZoom||ye.numPoints<=xt.indexMaxPoints)continue;if(ye.source=null,0!==Z.length){Ut>1&&console.time("clipping");var pr,Pr,De,sr,Be,sn,qr=.5*xt.buffer/xt.extent,Tr=.5-qr,wr=.5+qr,zr=1+qr;pr=Pr=De=sr=null,Be=Ge(Z,je,it-qr,it+wr,0,ye.minX,ye.maxX,xt),sn=Ge(Z,je,it+Tr,it+zr,0,ye.minX,ye.maxX,xt),Z=null,Be&&(pr=Ge(Be,je,ht-qr,ht+wr,1,ye.minY,ye.maxY,xt),Pr=Ge(Be,je,ht+Tr,ht+zr,1,ye.minY,ye.maxY,xt),Be=null),sn&&(De=Ge(sn,je,ht-qr,ht+wr,1,ye.minY,ye.maxY,xt),sr=Ge(sn,je,ht+Tr,ht+zr,1,ye.minY,ye.maxY,xt),sn=null),Ut>1&&console.timeEnd("clipping"),Yt.push(pr||[],Y+1,2*it,2*ht),Yt.push(Pr||[],Y+1,2*it,2*ht+1),Yt.push(De||[],Y+1,2*it+1,2*ht),Yt.push(sr||[],Y+1,2*it+1,2*ht+1)}}},$n.prototype.getTile=function(Z,Y,it){var ht=this.options,Ot=ht.extent,Xt=ht.debug;if(Z<0||Z>24)return null;var ne=1<<Z,Yt=go(Z,Y=(Y%ne+ne)%ne,it);if(this.tiles[Yt])return _i(this.tiles[Yt],Ot);Xt>1&&console.log("drilling down to z%d-%d-%d",Z,Y,it);for(var xt,Ut=Z,je=Y,or=it;!xt&&Ut>0;)Ut--,je=Math.floor(je/2),or=Math.floor(or/2),xt=this.tiles[go(Ut,je,or)];return xt&&xt.source?(Xt>1&&console.log("found parent tile z%d-%d-%d",Ut,je,or),Xt>1&&console.time("drilling down"),this.splitTile(xt.source,Ut,je,or,Z,Y,it),Xt>1&&console.timeEnd("drilling down"),this.tiles[Yt]?_i(this.tiles[Yt],Ot):null):null};var Je=function(Z){function Y(it,ht,Ot,Xt){Z.call(this,it,ht,Ot,Oi),Xt&&(this.loadGeoJSON=Xt)}return Z&&(Y.__proto__=Z),(Y.prototype=Object.create(Z&&Z.prototype)).constructor=Y,Y.prototype.loadData=function(it,ht){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),this._pendingCallback=ht,this._pendingLoadDataParams=it,this._state&&"Idle"!==this._state?this._state="NeedsLoadData":(this._state="Coalescing",this._loadData())},Y.prototype._loadData=function(){var it=this;if(this._pendingCallback&&this._pendingLoadDataParams){var ht=this._pendingCallback,Ot=this._pendingLoadDataParams;delete this._pendingCallback,delete this._pendingLoadDataParams;var Xt=!!(Ot&&Ot.request&&Ot.request.collectResourceTiming)&&new y.RequestPerformance(Ot.request);this.loadGeoJSON(Ot,function(ne,Yt){if(ne||!Yt)return ht(ne);if("object"!=typeof Yt)return ht(new Error("Input data given to '"+Ot.source+"' is not a valid GeoJSON object."));!function ye(Le,lr){var pr,Pr=Le&&Le.type;if("FeatureCollection"===Pr)for(pr=0;pr<Le.features.length;pr++)ye(Le.features[pr],lr);else if("GeometryCollection"===Pr)for(pr=0;pr<Le.geometries.length;pr++)ye(Le.geometries[pr],lr);else if("Feature"===Pr)ye(Le.geometry,lr);else if("Polygon"===Pr)We(Le.coordinates,lr);else if("MultiPolygon"===Pr)for(pr=0;pr<Le.coordinates.length;pr++)We(Le.coordinates[pr],lr);return Le}(Yt,!0);try{if(Ot.filter){var xt=y.createExpression(Ot.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if("error"===xt.result)throw new Error(xt.value.map(function(ye){return ye.key+": "+ye.message}).join(", "));var Ut=Yt.features.filter(function(ye){return xt.value.evaluate({zoom:0},ye)});Yt={type:"FeatureCollection",features:Ut}}it._geoJSONIndex=Ot.cluster?new Oe(function(ye){var Le=ye.superclusterOptions,lr=ye.clusterProperties;if(!lr||!Le)return Le;for(var pr={},Pr={},De={accumulated:null,zoom:0},sr={properties:null},Be=Object.keys(lr),sn=0,qr=Be;sn<qr.length;sn+=1){var Tr=qr[sn],wr=lr[Tr],zr=wr[0],ui=y.createExpression(wr[1]),Tn=y.createExpression("string"==typeof zr?[zr,["accumulated"],["get",Tr]]:zr);pr[Tr]=ui.value,Pr[Tr]=Tn.value}return Le.map=function(xn){sr.properties=xn;for(var ln={},xi=0,zn=Be;xi<zn.length;xi+=1){var un=zn[xi];ln[un]=pr[un].evaluate(De,sr)}return ln},Le.reduce=function(xn,ln){sr.properties=ln;for(var xi=0,zn=Be;xi<zn.length;xi+=1){var un=zn[xi];De.accumulated=xn[un],xn[un]=Pr[un].evaluate(De,sr)}},Le}(Ot)).load(Yt.features):new $n(ye=Yt,Ot.geojsonVtOptions)}catch(ye){return ht(ye)}var ye;it.loaded={};var je={};if(Xt){var or=Xt.finish();or&&(je.resourceTiming={},je.resourceTiming[Ot.source]=JSON.parse(JSON.stringify(or)))}ht(null,je)})}},Y.prototype.coalesce=function(){"Coalescing"===this._state?this._state="Idle":"NeedsLoadData"===this._state&&(this._state="Coalescing",this._loadData())},Y.prototype.reloadTile=function(it,ht){var Ot=this.loaded;return Ot&&Ot[it.uid]?Z.prototype.reloadTile.call(this,it,ht):this.loadTile(it,ht)},Y.prototype.loadGeoJSON=function(it,ht){if(it.request)y.getJSON(it.request,ht);else{if("string"!=typeof it.data)return ht(new Error("Input data given to '"+it.source+"' is not a valid GeoJSON object."));try{return ht(null,JSON.parse(it.data))}catch(Ot){return ht(new Error("Input data given to '"+it.source+"' is not a valid GeoJSON object."))}}},Y.prototype.removeSource=function(it,ht){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),ht()},Y.prototype.getClusterExpansionZoom=function(it,ht){try{ht(null,this._geoJSONIndex.getClusterExpansionZoom(it.clusterId))}catch(Ot){ht(Ot)}},Y.prototype.getClusterChildren=function(it,ht){try{ht(null,this._geoJSONIndex.getChildren(it.clusterId))}catch(Ot){ht(Ot)}},Y.prototype.getClusterLeaves=function(it,ht){try{ht(null,this._geoJSONIndex.getLeaves(it.clusterId,it.limit,it.offset))}catch(Ot){ht(Ot)}},Y}(ve),gi=function(Z){var Y=this;this.self=Z,this.actor=new y.Actor(Z,this),this.layerIndexes={},this.availableImages={},this.workerSourceTypes={vector:ve,geojson:Je},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=function(it,ht){if(Y.workerSourceTypes[it])throw new Error('Worker source with name "'+it+'" already registered.');Y.workerSourceTypes[it]=ht},this.self.registerRTLTextPlugin=function(it){if(y.plugin.isParsed())throw new Error("RTL text plugin already registered.");y.plugin.applyArabicShaping=it.applyArabicShaping,y.plugin.processBidirectionalText=it.processBidirectionalText,y.plugin.processStyledBidirectionalText=it.processStyledBidirectionalText}};return gi.prototype.setReferrer=function(Z,Y){this.referrer=Y},gi.prototype.setImages=function(Z,Y,it){for(var ht in this.availableImages[Z]=Y,this.workerSources[Z]){var Ot=this.workerSources[Z][ht];for(var Xt in Ot)Ot[Xt].availableImages=Y}it()},gi.prototype.setLayers=function(Z,Y,it){this.getLayerIndex(Z).replace(Y),it()},gi.prototype.updateLayers=function(Z,Y,it){this.getLayerIndex(Z).update(Y.layers,Y.removedIds),it()},gi.prototype.loadTile=function(Z,Y,it){this.getWorkerSource(Z,Y.type,Y.source).loadTile(Y,it)},gi.prototype.loadDEMTile=function(Z,Y,it){this.getDEMWorkerSource(Z,Y.source).loadTile(Y,it)},gi.prototype.reloadTile=function(Z,Y,it){this.getWorkerSource(Z,Y.type,Y.source).reloadTile(Y,it)},gi.prototype.abortTile=function(Z,Y,it){this.getWorkerSource(Z,Y.type,Y.source).abortTile(Y,it)},gi.prototype.removeTile=function(Z,Y,it){this.getWorkerSource(Z,Y.type,Y.source).removeTile(Y,it)},gi.prototype.removeDEMTile=function(Z,Y){this.getDEMWorkerSource(Z,Y.source).removeTile(Y)},gi.prototype.removeSource=function(Z,Y,it){if(this.workerSources[Z]&&this.workerSources[Z][Y.type]&&this.workerSources[Z][Y.type][Y.source]){var ht=this.workerSources[Z][Y.type][Y.source];delete this.workerSources[Z][Y.type][Y.source],void 0!==ht.removeSource?ht.removeSource(Y,it):it()}},gi.prototype.loadWorkerSource=function(Z,Y,it){try{this.self.importScripts(Y.url),it()}catch(ht){it(ht.toString())}},gi.prototype.syncRTLPluginState=function(Z,Y,it){try{y.plugin.setState(Y);var ht=y.plugin.getPluginURL();if(y.plugin.isLoaded()&&!y.plugin.isParsed()&&null!=ht){this.self.importScripts(ht);var Ot=y.plugin.isParsed();it(Ot?void 0:new Error("RTL Text Plugin failed to import scripts from "+ht),Ot)}}catch(Xt){it(Xt.toString())}},gi.prototype.getAvailableImages=function(Z){var Y=this.availableImages[Z];return Y||(Y=[]),Y},gi.prototype.getLayerIndex=function(Z){var Y=this.layerIndexes[Z];return Y||(Y=this.layerIndexes[Z]=new It),Y},gi.prototype.getWorkerSource=function(Z,Y,it){var ht=this;return this.workerSources[Z]||(this.workerSources[Z]={}),this.workerSources[Z][Y]||(this.workerSources[Z][Y]={}),this.workerSources[Z][Y][it]||(this.workerSources[Z][Y][it]=new this.workerSourceTypes[Y]({send:function(Ot,Xt,ne){ht.actor.send(Ot,Xt,ne,Z)}},this.getLayerIndex(Z),this.getAvailableImages(Z))),this.workerSources[Z][Y][it]},gi.prototype.getDEMWorkerSource=function(Z,Y){return this.demWorkerSources[Z]||(this.demWorkerSources[Z]={}),this.demWorkerSources[Z][Y]||(this.demWorkerSources[Z][Y]=new _e),this.demWorkerSources[Z][Y]},gi.prototype.enforceCacheSizeLimit=function(Z,Y){y.enforceCacheSizeLimit(Y)},"undefined"!=typeof WorkerGlobalScope&&"undefined"!=typeof self&&self instanceof WorkerGlobalScope&&(self.worker=new gi(self)),gi}),D(0,function(y){var Bt=y.createCommonjsModule(function(u){function p(E){return!l(E)}function l(E){return"undefined"==typeof window||"undefined"==typeof document?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var T,k,q=new Blob([""],{type:"text/javascript"}),H=URL.createObjectURL(q);try{k=new Worker(H),T=!0}catch(ut){T=!1}return k&&k.terminate(),URL.revokeObjectURL(H),T}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var T=document.createElement("canvas");T.width=T.height=1;var k=T.getContext("2d");if(!k)return!1;var q=k.getImageData(0,0,1,1);return q&&q.width===T.width}()?(void 0===g[P=E&&E.failIfMajorPerformanceCaveat]&&(g[P]=function(T){var H,ut,dt,k=(H=T,ut=document.createElement("canvas"),(dt=Object.create(p.webGLContextAttributes)).failIfMajorPerformanceCaveat=H,ut.probablySupportsContext?ut.probablySupportsContext("webgl",dt)||ut.probablySupportsContext("experimental-webgl",dt):ut.supportsContext?ut.supportsContext("webgl",dt)||ut.supportsContext("experimental-webgl",dt):ut.getContext("webgl",dt)||ut.getContext("experimental-webgl",dt));if(!k)return!1;var q=k.createShader(k.VERTEX_SHADER);return!(!q||k.isContextLost())&&(k.shaderSource(q,"void main() {}"),k.compileShader(q),!0===k.getShaderParameter(q,k.COMPILE_STATUS))}(P)),g[P]?void 0:"insufficient WebGL support"):"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support";var P}u.exports?u.exports=p:window&&(window.mapboxgl=window.mapboxgl||{},window.mapboxgl.supported=p,window.mapboxgl.notSupportedReason=l);var g={};p.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0}}),ft={create:function(u,p,l){var g=y.window.document.createElement(u);return void 0!==p&&(g.className=p),l&&l.appendChild(g),g},createNS:function(u,p){return y.window.document.createElementNS(u,p)}},It=y.window.document&&y.window.document.documentElement.style;function Ft(u){if(!It)return u[0];for(var p=0;p<u.length;p++)if(u[p]in It)return u[p];return u[0]}var he,Jt=Ft(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]);ft.disableDrag=function(){It&&Jt&&(he=It[Jt],It[Jt]="none")},ft.enableDrag=function(){It&&Jt&&(It[Jt]=he)};var Ze=Ft(["transform","WebkitTransform"]);ft.setTransform=function(u,p){u.style[Ze]=p};var ve=!1;try{var ce=Object.defineProperty({},"passive",{get:function(){ve=!0}});y.window.addEventListener("test",ce,ce),y.window.removeEventListener("test",ce,ce)}catch(u){ve=!1}ft.addEventListener=function(u,p,l,g){void 0===g&&(g={}),u.addEventListener(p,l,"passive"in g&&ve?g:g.capture)},ft.removeEventListener=function(u,p,l,g){void 0===g&&(g={}),u.removeEventListener(p,l,"passive"in g&&ve?g:g.capture)};var _e=function(u){u.preventDefault(),u.stopPropagation(),y.window.removeEventListener("click",_e,!0)};function We(u){var p=u.userImage;return!!(p&&p.render&&p.render())&&(u.data.replace(new Uint8Array(p.data.buffer)),!0)}ft.suppressClick=function(){y.window.addEventListener("click",_e,!0),y.window.setTimeout(function(){y.window.removeEventListener("click",_e,!0)},0)},ft.mousePos=function(u,p){var l=u.getBoundingClientRect();return new y.Point(p.clientX-l.left-u.clientLeft,p.clientY-l.top-u.clientTop)},ft.touchPos=function(u,p){for(var l=u.getBoundingClientRect(),g=[],E=0;E<p.length;E++)g.push(new y.Point(p[E].clientX-l.left-u.clientLeft,p[E].clientY-l.top-u.clientTop));return g},ft.mouseButton=function(u){return void 0!==y.window.InstallTrigger&&2===u.button&&u.ctrlKey&&y.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:u.button},ft.remove=function(u){u.parentNode&&u.parentNode.removeChild(u)};var kt=function(u){function p(){u.call(this),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new y.RGBAImage({width:1,height:1}),this.dirty=!0}return u&&(p.__proto__=u),(p.prototype=Object.create(u&&u.prototype)).constructor=p,p.prototype.isLoaded=function(){return this.loaded},p.prototype.setLoaded=function(l){if(this.loaded!==l&&(this.loaded=l,l)){for(var g=0,E=this.requestors;g<E.length;g+=1){var P=E[g];this._notify(P.ids,P.callback)}this.requestors=[]}},p.prototype.getImage=function(l){return this.images[l]},p.prototype.addImage=function(l,g){this._validate(l,g)&&(this.images[l]=g)},p.prototype._validate=function(l,g){var E=!0;return this._validateStretch(g.stretchX,g.data&&g.data.width)||(this.fire(new y.ErrorEvent(new Error('Image "'+l+'" has invalid "stretchX" value'))),E=!1),this._validateStretch(g.stretchY,g.data&&g.data.height)||(this.fire(new y.ErrorEvent(new Error('Image "'+l+'" has invalid "stretchY" value'))),E=!1),this._validateContent(g.content,g)||(this.fire(new y.ErrorEvent(new Error('Image "'+l+'" has invalid "content" value'))),E=!1),E},p.prototype._validateStretch=function(l,g){if(!l)return!0;for(var E=0,P=0,T=l;P<T.length;P+=1){var k=T[P];if(k[0]<E||k[1]<k[0]||g<k[1])return!1;E=k[1]}return!0},p.prototype._validateContent=function(l,g){return!(l&&(4!==l.length||l[0]<0||g.data.width<l[0]||l[1]<0||g.data.height<l[1]||l[2]<0||g.data.width<l[2]||l[3]<0||g.data.height<l[3]||l[2]<l[0]||l[3]<l[1]))},p.prototype.updateImage=function(l,g){g.version=this.images[l].version+1,this.images[l]=g,this.updatedImages[l]=!0},p.prototype.removeImage=function(l){var g=this.images[l];delete this.images[l],delete this.patterns[l],g.userImage&&g.userImage.onRemove&&g.userImage.onRemove()},p.prototype.listImages=function(){return Object.keys(this.images)},p.prototype.getImages=function(l,g){var E=!0;if(!this.isLoaded())for(var P=0,T=l;P<T.length;P+=1)this.images[T[P]]||(E=!1);this.isLoaded()||E?this._notify(l,g):this.requestors.push({ids:l,callback:g})},p.prototype._notify=function(l,g){for(var E={},P=0,T=l;P<T.length;P+=1){var k=T[P];this.images[k]||this.fire(new y.Event("styleimagemissing",{id:k}));var q=this.images[k];q?E[k]={data:q.data.clone(),pixelRatio:q.pixelRatio,sdf:q.sdf,version:q.version,stretchX:q.stretchX,stretchY:q.stretchY,content:q.content,hasRenderCallback:Boolean(q.userImage&&q.userImage.render)}:y.warnOnce('Image "'+k+'" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.')}g(null,E)},p.prototype.getPixelSize=function(){var l=this.atlasImage;return{width:l.width,height:l.height}},p.prototype.getPattern=function(l){var g=this.patterns[l],E=this.getImage(l);if(!E)return null;if(g&&g.position.version===E.version)return g.position;if(g)g.position.version=E.version;else{var P={w:E.data.width+2,h:E.data.height+2,x:0,y:0},T=new y.ImagePosition(P,E);this.patterns[l]={bin:P,position:T}}return this._updatePatternAtlas(),this.patterns[l].position},p.prototype.bind=function(l){var g=l.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new y.Texture(l,this.atlasImage,g.RGBA),this.atlasTexture.bind(g.LINEAR,g.CLAMP_TO_EDGE)},p.prototype._updatePatternAtlas=function(){var l=[];for(var g in this.patterns)l.push(this.patterns[g].bin);var E=y.potpack(l),P=E.w,T=E.h,k=this.atlasImage;for(var q in k.resize({width:P||1,height:T||1}),this.patterns){var H=this.patterns[q].bin,ut=H.x+1,dt=H.y+1,lt=this.images[q].data,zt=lt.width,Rt=lt.height;y.RGBAImage.copy(lt,k,{x:0,y:0},{x:ut,y:dt},{width:zt,height:Rt}),y.RGBAImage.copy(lt,k,{x:0,y:Rt-1},{x:ut,y:dt-1},{width:zt,height:1}),y.RGBAImage.copy(lt,k,{x:0,y:0},{x:ut,y:dt+Rt},{width:zt,height:1}),y.RGBAImage.copy(lt,k,{x:zt-1,y:0},{x:ut-1,y:dt},{width:1,height:Rt}),y.RGBAImage.copy(lt,k,{x:0,y:0},{x:ut+zt,y:dt},{width:1,height:Rt})}this.dirty=!0},p.prototype.beginFrame=function(){this.callbackDispatchedThisFrame={}},p.prototype.dispatchRenderCallbacks=function(l){for(var g=0,E=l;g<E.length;g+=1){var P=E[g];if(!this.callbackDispatchedThisFrame[P]){this.callbackDispatchedThisFrame[P]=!0;var T=this.images[P];We(T)&&this.updateImage(P,T)}}},p}(y.Evented),ie=$,X=$,J=1e20;function $(u,p,l,g,E,P){this.fontSize=u||24,this.buffer=void 0===p?3:p,this.cutoff=g||.25,this.fontFamily=E||"sans-serif",this.fontWeight=P||"normal",this.radius=l||8;var T=this.size=this.fontSize+2*this.buffer;this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=T,this.ctx=this.canvas.getContext("2d"),this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.ctx.textBaseline="middle",this.ctx.fillStyle="black",this.gridOuter=new Float64Array(T*T),this.gridInner=new Float64Array(T*T),this.f=new Float64Array(T),this.d=new Float64Array(T),this.z=new Float64Array(T+1),this.v=new Int16Array(T),this.middle=Math.round(T/2*(navigator.userAgent.indexOf("Gecko/")>=0?1.2:1))}function St(u,p,l,g,E,P,T){for(var k=0;k<p;k++){for(var q=0;q<l;q++)g[q]=u[q*p+k];for(Q(g,E,P,T,l),q=0;q<l;q++)u[q*p+k]=E[q]}for(q=0;q<l;q++){for(k=0;k<p;k++)g[k]=u[q*p+k];for(Q(g,E,P,T,p),k=0;k<p;k++)u[q*p+k]=Math.sqrt(E[k])}}function Q(u,p,l,g,E){l[0]=0,g[0]=-J,g[1]=+J;for(var P=1,T=0;P<E;P++){for(var k=(u[P]+P*P-(u[l[T]]+l[T]*l[T]))/(2*P-2*l[T]);k<=g[T];)T--,k=(u[P]+P*P-(u[l[T]]+l[T]*l[T]))/(2*P-2*l[T]);l[++T]=P,g[T]=k,g[T+1]=+J}for(P=0,T=0;P<E;P++){for(;g[T+1]<P;)T++;p[P]=(P-l[T])*(P-l[T])+u[l[T]]}}$.prototype.draw=function(u){this.ctx.clearRect(0,0,this.size,this.size),this.ctx.fillText(u,this.buffer,this.middle);for(var p=this.ctx.getImageData(0,0,this.size,this.size),l=new Uint8ClampedArray(this.size*this.size),g=0;g<this.size*this.size;g++){var E=p.data[4*g+3]/255;this.gridOuter[g]=1===E?0:0===E?J:Math.pow(Math.max(0,.5-E),2),this.gridInner[g]=1===E?J:0===E?0:Math.pow(Math.max(0,E-.5),2)}for(St(this.gridOuter,this.size,this.size,this.f,this.d,this.v,this.z),St(this.gridInner,this.size,this.size,this.f,this.d,this.v,this.z),g=0;g<this.size*this.size;g++)l[g]=Math.max(0,Math.min(255,Math.round(255-255*((this.gridOuter[g]-this.gridInner[g])/this.radius+this.cutoff))));return l},ie.default=X;var et=function(u,p){this.requestManager=u,this.localIdeographFontFamily=p,this.entries={}};et.prototype.setURL=function(u){this.url=u},et.prototype.getGlyphs=function(u,p){var l=this,g=[];for(var E in u)for(var P=0,T=u[E];P<T.length;P+=1)g.push({stack:E,id:T[P]});y.asyncAll(g,function(k,q){var H=k.stack,ut=k.id,dt=l.entries[H];dt||(dt=l.entries[H]={glyphs:{},requests:{},ranges:{}});var lt=dt.glyphs[ut];if(void 0===lt){if(lt=l._tinySDF(dt,H,ut))return dt.glyphs[ut]=lt,void q(null,{stack:H,id:ut,glyph:lt});var zt=Math.floor(ut/256);if(256*zt>65535)q(new Error("glyphs > 65535 not supported"));else if(dt.ranges[zt])q(null,{stack:H,id:ut,glyph:lt});else{var Rt=dt.requests[zt];Rt||(Rt=dt.requests[zt]=[],et.loadGlyphRange(H,zt,l.url,l.requestManager,function(jt,Dt){if(Dt){for(var qt in Dt)l._doesCharSupportLocalGlyph(+qt)||(dt.glyphs[+qt]=Dt[+qt]);dt.ranges[zt]=!0}for(var ee=0,oe=Rt;ee<oe.length;ee+=1)(0,oe[ee])(jt,Dt);delete dt.requests[zt]})),Rt.push(function(jt,Dt){jt?q(jt):Dt&&q(null,{stack:H,id:ut,glyph:Dt[ut]||null})})}}else q(null,{stack:H,id:ut,glyph:lt})},function(k,q){if(k)p(k);else if(q){for(var H={},ut=0,dt=q;ut<dt.length;ut+=1){var lt=dt[ut],zt=lt.stack,Rt=lt.id,jt=lt.glyph;(H[zt]||(H[zt]={}))[Rt]=jt&&{id:jt.id,bitmap:jt.bitmap.clone(),metrics:jt.metrics}}p(null,H)}})},et.prototype._doesCharSupportLocalGlyph=function(u){return!!this.localIdeographFontFamily&&(y.isChar["CJK Unified Ideographs"](u)||y.isChar["Hangul Syllables"](u)||y.isChar.Hiragana(u)||y.isChar.Katakana(u))},et.prototype._tinySDF=function(u,p,l){var g=this.localIdeographFontFamily;if(g&&this._doesCharSupportLocalGlyph(l)){var E=u.tinySDF;if(!E){var P="400";/bold/i.test(p)?P="900":/medium/i.test(p)?P="500":/light/i.test(p)&&(P="200"),E=u.tinySDF=new et.TinySDF(24,3,8,.25,g,P)}return{id:l,bitmap:new y.AlphaImage({width:30,height:30},E.draw(String.fromCharCode(l))),metrics:{width:24,height:24,left:0,top:-8,advance:24}}}},et.loadGlyphRange=function(u,p,l,g,E){var P=256*p,T=P+255,k=g.transformRequest(g.normalizeGlyphsURL(l).replace("{fontstack}",u).replace("{range}",P+"-"+T),y.ResourceType.Glyphs);y.getArrayBuffer(k,function(q,H){if(q)E(q);else if(H){for(var ut={},dt=0,lt=y.parseGlyphPBF(H);dt<lt.length;dt+=1){var zt=lt[dt];ut[zt.id]=zt}E(null,ut)}})},et.TinySDF=ie;var st=function(){this.specification=y.styleSpec.light.position};st.prototype.possiblyEvaluate=function(u,p){return y.sphericalToCartesian(u.expression.evaluate(p))},st.prototype.interpolate=function(u,p,l){return{x:y.number(u.x,p.x,l),y:y.number(u.y,p.y,l),z:y.number(u.z,p.z,l)}};var j=new y.Properties({anchor:new y.DataConstantProperty(y.styleSpec.light.anchor),position:new st,color:new y.DataConstantProperty(y.styleSpec.light.color),intensity:new y.DataConstantProperty(y.styleSpec.light.intensity)}),$t=function(u){function p(l){u.call(this),this._transitionable=new y.Transitionable(j),this.setLight(l),this._transitioning=this._transitionable.untransitioned()}return u&&(p.__proto__=u),(p.prototype=Object.create(u&&u.prototype)).constructor=p,p.prototype.getLight=function(){return this._transitionable.serialize()},p.prototype.setLight=function(l,g){if(void 0===g&&(g={}),!this._validate(y.validateLight,l,g))for(var E in l){var P=l[E];y.endsWith(E,"-transition")?this._transitionable.setTransition(E.slice(0,-"-transition".length),P):this._transitionable.setValue(E,P)}},p.prototype.updateTransitions=function(l){this._transitioning=this._transitionable.transitioned(l,this._transitioning)},p.prototype.hasTransition=function(){return this._transitioning.hasTransition()},p.prototype.recalculate=function(l){this.properties=this._transitioning.possiblyEvaluate(l)},p.prototype._validate=function(l,g,E){return(!E||!1!==E.validate)&&y.emitValidationErrors(this,l.call(y.validateStyle,y.extend({value:g,style:{glyphs:!0,sprite:!0},styleSpec:y.styleSpec})))},p}(y.Evented),bt=function(u,p){this.width=u,this.height=p,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}};bt.prototype.getDash=function(u,p){var l=u.join(",")+String(p);return this.dashEntry[l]||(this.dashEntry[l]=this.addDash(u,p)),this.dashEntry[l]},bt.prototype.getDashRanges=function(u,p,l){var g=[],E=u.length%2==1?-u[u.length-1]*l:0,P=u[0]*l,T=!0;g.push({left:E,right:P,isDash:T,zeroLength:0===u[0]});for(var k=u[0],q=1;q<u.length;q++){var H=u[q];g.push({left:E=k*l,right:P=(k+=H)*l,isDash:T=!T,zeroLength:0===H})}return g},bt.prototype.addRoundDash=function(u,p,l){for(var g=p/2,E=-l;E<=l;E++)for(var P=this.width*(this.nextRow+l+E),T=0,k=u[T],q=0;q<this.width;q++){q/k.right>1&&(k=u[++T]);var H=Math.abs(q-k.left),ut=Math.abs(q-k.right),dt=Math.min(H,ut),lt=void 0,zt=E/l*(g+1);if(k.isDash){var Rt=g-Math.abs(zt);lt=Math.sqrt(dt*dt+Rt*Rt)}else lt=g-Math.sqrt(dt*dt+zt*zt);this.data[P+q]=Math.max(0,Math.min(255,lt+128))}},bt.prototype.addRegularDash=function(u){for(var p=u.length-1;p>=0;--p){var l=u[p],g=u[p+1];l.zeroLength?u.splice(p,1):g&&g.isDash===l.isDash&&(g.left=l.left,u.splice(p,1))}var E=u[0],P=u[u.length-1];E.isDash===P.isDash&&(E.left=P.left-this.width,P.right=E.right+this.width);for(var T=this.width*this.nextRow,k=0,q=u[k],H=0;H<this.width;H++){H/q.right>1&&(q=u[++k]);var ut=Math.abs(H-q.left),dt=Math.abs(H-q.right),lt=Math.min(ut,dt);this.data[T+H]=Math.max(0,Math.min(255,(q.isDash?lt:-lt)+128))}},bt.prototype.addDash=function(u,p){var l=p?7:0,g=2*l+1;if(this.nextRow+g>this.height)return y.warnOnce("LineAtlas out of space"),null;for(var E=0,P=0;P<u.length;P++)E+=u[P];if(0!==E){var T=this.width/E,k=this.getDashRanges(u,this.width,T);p?this.addRoundDash(k,T,l):this.addRegularDash(k)}var q={y:(this.nextRow+l+.5)/this.height,height:2*l/this.height,width:E};return this.nextRow+=g,this.dirty=!0,q},bt.prototype.bind=function(u){var p=u.gl;this.texture?(p.bindTexture(p.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,p.texSubImage2D(p.TEXTURE_2D,0,0,0,this.width,this.height,p.ALPHA,p.UNSIGNED_BYTE,this.data))):(this.texture=p.createTexture(),p.bindTexture(p.TEXTURE_2D,this.texture),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_WRAP_S,p.REPEAT),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_WRAP_T,p.REPEAT),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MIN_FILTER,p.LINEAR),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MAG_FILTER,p.LINEAR),p.texImage2D(p.TEXTURE_2D,0,p.ALPHA,this.width,this.height,0,p.ALPHA,p.UNSIGNED_BYTE,this.data))};var Mt=function u(p,l){this.workerPool=p,this.actors=[],this.currentActor=0,this.id=y.uniqueId();for(var g=this.workerPool.acquire(this.id),E=0;E<g.length;E++){var P=new u.Actor(g[E],l,this.id);P.name="Worker "+E,this.actors.push(P)}};function ct(u,p,l){var g=function(E,P){if(E)return l(E);if(P){var T=y.pick(y.extend(P,u),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);P.vector_layers&&(T.vectorLayers=P.vector_layers,T.vectorLayerIds=T.vectorLayers.map(function(k){return k.id})),T.tiles=p.canonicalizeTileset(T,u.url),l(null,T)}};return u.url?y.getJSON(p.transformRequest(p.normalizeSourceURL(u.url),y.ResourceType.Source),g):y.browser.frame(function(){return g(null,u)})}Mt.prototype.broadcast=function(u,p,l){y.asyncAll(this.actors,function(g,E){g.send(u,p,E)},l=l||function(){})},Mt.prototype.getActor=function(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]},Mt.prototype.remove=function(){this.actors.forEach(function(u){u.remove()}),this.actors=[],this.workerPool.release(this.id)},Mt.Actor=y.Actor;var ze=function(u,p,l){this.bounds=y.LngLatBounds.convert(this.validateBounds(u)),this.minzoom=p||0,this.maxzoom=l||24};ze.prototype.validateBounds=function(u){return Array.isArray(u)&&4===u.length?[Math.max(-180,u[0]),Math.max(-90,u[1]),Math.min(180,u[2]),Math.min(90,u[3])]:[-180,-90,180,90]},ze.prototype.contains=function(u){var p=Math.pow(2,u.z),l=Math.floor(y.mercatorXfromLng(this.bounds.getWest())*p),g=Math.floor(y.mercatorYfromLat(this.bounds.getNorth())*p),E=Math.ceil(y.mercatorXfromLng(this.bounds.getEast())*p),P=Math.ceil(y.mercatorYfromLat(this.bounds.getSouth())*p);return u.x>=l&&u.x<E&&u.y>=g&&u.y<P};var Te=function(u){function p(l,g,E,P){if(u.call(this),this.id=l,this.dispatcher=E,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,y.extend(this,y.pick(g,["url","scheme","tileSize","promoteId"])),this._options=y.extend({type:"vector"},g),this._collectResourceTiming=g.collectResourceTiming,512!==this.tileSize)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(P)}return u&&(p.__proto__=u),(p.prototype=Object.create(u&&u.prototype)).constructor=p,p.prototype.load=function(){var l=this;this._loaded=!1,this.fire(new y.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=ct(this._options,this.map._requestManager,function(g,E){l._tileJSONRequest=null,l._loaded=!0,g?l.fire(new y.ErrorEvent(g)):E&&(y.extend(l,E),E.bounds&&(l.tileBounds=new ze(E.bounds,l.minzoom,l.maxzoom)),y.postTurnstileEvent(E.tiles,l.map._requestManager._customAccessToken),y.postMapLoadEvent(E.tiles,l.map._getMapId(),l.map._requestManager._skuToken,l.map._requestManager._customAccessToken),l.fire(new y.Event("data",{dataType:"source",sourceDataType:"metadata"})),l.fire(new y.Event("data",{dataType:"source",sourceDataType:"content"})))})},p.prototype.loaded=function(){return this._loaded},p.prototype.hasTile=function(l){return!this.tileBounds||this.tileBounds.contains(l.canonical)},p.prototype.onAdd=function(l){this.map=l,this.load()},p.prototype.setSourceProperty=function(l){this._tileJSONRequest&&this._tileJSONRequest.cancel(),l(),this.map.style.sourceCaches[this.id].clearTiles(),this.load()},p.prototype.setTiles=function(l){var g=this;return this.setSourceProperty(function(){g._options.tiles=l}),this},p.prototype.setUrl=function(l){var g=this;return this.setSourceProperty(function(){g.url=l,g._options.url=l}),this},p.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},p.prototype.serialize=function(){return y.extend({},this._options)},p.prototype.loadTile=function(l,g){var E=this.map._requestManager.normalizeTileURL(l.tileID.canonical.url(this.tiles,this.scheme)),P={request:this.map._requestManager.transformRequest(E,y.ResourceType.Tile),uid:l.uid,tileID:l.tileID,zoom:l.tileID.overscaledZ,tileSize:this.tileSize*l.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:y.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};function T(k,q){return delete l.request,l.aborted?g(null):k&&404!==k.status?g(k):(q&&q.resourceTiming&&(l.resourceTiming=q.resourceTiming),this.map._refreshExpiredTiles&&q&&l.setExpiryData(q),l.loadVectorData(q,this.map.painter),y.cacheEntryPossiblyAdded(this.dispatcher),g(null),void(l.reloadCallback&&(this.loadTile(l,l.reloadCallback),l.reloadCallback=null)))}P.request.collectResourceTiming=this._collectResourceTiming,l.actor&&"expired"!==l.state?"loading"===l.state?l.reloadCallback=g:l.request=l.actor.send("reloadTile",P,T.bind(this)):(l.actor=this.dispatcher.getActor(),l.request=l.actor.send("loadTile",P,T.bind(this)))},p.prototype.abortTile=function(l){l.request&&(l.request.cancel(),delete l.request),l.actor&&l.actor.send("abortTile",{uid:l.uid,type:this.type,source:this.id},void 0)},p.prototype.unloadTile=function(l){l.unloadVectorData(),l.actor&&l.actor.send("removeTile",{uid:l.uid,type:this.type,source:this.id},void 0)},p.prototype.hasTransition=function(){return!1},p}(y.Evented),wt=function(u){function p(l,g,E,P){u.call(this),this.id=l,this.dispatcher=E,this.setEventedParent(P),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=y.extend({type:"raster"},g),y.extend(this,y.pick(g,["url","scheme","tileSize"]))}return u&&(p.__proto__=u),(p.prototype=Object.create(u&&u.prototype)).constructor=p,p.prototype.load=function(){var l=this;this._loaded=!1,this.fire(new y.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=ct(this._options,this.map._requestManager,function(g,E){l._tileJSONRequest=null,l._loaded=!0,g?l.fire(new y.ErrorEvent(g)):E&&(y.extend(l,E),E.bounds&&(l.tileBounds=new ze(E.bounds,l.minzoom,l.maxzoom)),y.postTurnstileEvent(E.tiles),y.postMapLoadEvent(E.tiles,l.map._getMapId(),l.map._requestManager._skuToken),l.fire(new y.Event("data",{dataType:"source",sourceDataType:"metadata"})),l.fire(new y.Event("data",{dataType:"source",sourceDataType:"content"})))})},p.prototype.loaded=function(){return this._loaded},p.prototype.onAdd=function(l){this.map=l,this.load()},p.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},p.prototype.serialize=function(){return y.extend({},this._options)},p.prototype.hasTile=function(l){return!this.tileBounds||this.tileBounds.contains(l.canonical)},p.prototype.loadTile=function(l,g){var E=this,P=this.map._requestManager.normalizeTileURL(l.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);l.request=y.getImage(this.map._requestManager.transformRequest(P,y.ResourceType.Tile),function(T,k){if(delete l.request,l.aborted)l.state="unloaded",g(null);else if(T)l.state="errored",g(T);else if(k){E.map._refreshExpiredTiles&&l.setExpiryData(k),delete k.cacheControl,delete k.expires;var q=E.map.painter.context,H=q.gl;l.texture=E.map.painter.getTileTexture(k.width),l.texture?l.texture.update(k,{useMipmap:!0}):(l.texture=new y.Texture(q,k,H.RGBA,{useMipmap:!0}),l.texture.bind(H.LINEAR,H.CLAMP_TO_EDGE,H.LINEAR_MIPMAP_NEAREST),q.extTextureFilterAnisotropic&&H.texParameterf(H.TEXTURE_2D,q.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,q.extTextureFilterAnisotropicMax)),l.state="loaded",y.cacheEntryPossiblyAdded(E.dispatcher),g(null)}})},p.prototype.abortTile=function(l,g){l.request&&(l.request.cancel(),delete l.request),g()},p.prototype.unloadTile=function(l,g){l.texture&&this.map.painter.saveTileTexture(l.texture),g()},p.prototype.hasTransition=function(){return!1},p}(y.Evented),re=function(u){function p(l,g,E,P){u.call(this,l,g,E,P),this.type="raster-dem",this.maxzoom=22,this._options=y.extend({type:"raster-dem"},g),this.encoding=g.encoding||"mapbox"}return u&&(p.__proto__=u),(p.prototype=Object.create(u&&u.prototype)).constructor=p,p.prototype.serialize=function(){return{type:"raster-dem",url:this.url,tileSize:this.tileSize,tiles:this.tiles,bounds:this.bounds,encoding:this.encoding}},p.prototype.loadTile=function(l,g){var E=this.map._requestManager.normalizeTileURL(l.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);function P(T,k){T&&(l.state="errored",g(T)),k&&(l.dem=k,l.needsHillshadePrepare=!0,l.state="loaded",g(null))}l.request=y.getImage(this.map._requestManager.transformRequest(E,y.ResourceType.Tile),function(T,k){if(delete l.request,l.aborted)l.state="unloaded",g(null);else if(T)l.state="errored",g(T);else if(k){this.map._refreshExpiredTiles&&l.setExpiryData(k),delete k.cacheControl,delete k.expires;var q=y.window.ImageBitmap&&k instanceof y.window.ImageBitmap&&y.offscreenCanvasSupported()?k:y.browser.getImageData(k,1),H={uid:l.uid,coord:l.tileID,source:this.id,rawImageData:q,encoding:this.encoding};l.actor&&"expired"!==l.state||(l.actor=this.dispatcher.getActor(),l.actor.send("loadDEMTile",H,P.bind(this)))}}.bind(this)),l.neighboringTiles=this._getNeighboringTiles(l.tileID)},p.prototype._getNeighboringTiles=function(l){var g=l.canonical,E=Math.pow(2,g.z),P=(g.x-1+E)%E,T=0===g.x?l.wrap-1:l.wrap,k=(g.x+1+E)%E,q=g.x+1===E?l.wrap+1:l.wrap,H={};return H[new y.OverscaledTileID(l.overscaledZ,T,g.z,P,g.y).key]={backfilled:!1},H[new y.OverscaledTileID(l.overscaledZ,q,g.z,k,g.y).key]={backfilled:!1},g.y>0&&(H[new y.OverscaledTileID(l.overscaledZ,T,g.z,P,g.y-1).key]={backfilled:!1},H[new y.OverscaledTileID(l.overscaledZ,l.wrap,g.z,g.x,g.y-1).key]={backfilled:!1},H[new y.OverscaledTileID(l.overscaledZ,q,g.z,k,g.y-1).key]={backfilled:!1}),g.y+1<E&&(H[new y.OverscaledTileID(l.overscaledZ,T,g.z,P,g.y+1).key]={backfilled:!1},H[new y.OverscaledTileID(l.overscaledZ,l.wrap,g.z,g.x,g.y+1).key]={backfilled:!1},H[new y.OverscaledTileID(l.overscaledZ,q,g.z,k,g.y+1).key]={backfilled:!1}),H},p.prototype.unloadTile=function(l){l.demTexture&&this.map.painter.saveTileTexture(l.demTexture),l.fbo&&(l.fbo.destroy(),delete l.fbo),l.dem&&delete l.dem,delete l.neighboringTiles,l.state="unloaded",l.actor&&l.actor.send("removeDEMTile",{uid:l.uid,source:this.id})},p}(wt),Tt=function(u){function p(l,g,E,P){u.call(this),this.id=l,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._loaded=!1,this.actor=E.getActor(),this.setEventedParent(P),this._data=g.data,this._options=y.extend({},g),this._collectResourceTiming=g.collectResourceTiming,this._resourceTiming=[],void 0!==g.maxzoom&&(this.maxzoom=g.maxzoom),g.type&&(this.type=g.type),g.attribution&&(this.attribution=g.attribution),this.promoteId=g.promoteId;var T=y.EXTENT/this.tileSize;this.workerOptions=y.extend({source:this.id,cluster:g.cluster||!1,geojsonVtOptions:{buffer:(void 0!==g.buffer?g.buffer:128)*T,tolerance:(void 0!==g.tolerance?g.tolerance:.375)*T,extent:y.EXTENT,maxZoom:this.maxzoom,lineMetrics:g.lineMetrics||!1,generateId:g.generateId||!1},superclusterOptions:{maxZoom:void 0!==g.clusterMaxZoom?Math.min(g.clusterMaxZoom,this.maxzoom-1):this.maxzoom-1,minPoints:Math.max(2,g.clusterMinPoints||2),extent:y.EXTENT,radius:(g.clusterRadius||50)*T,log:!1,generateId:g.generateId||!1},clusterProperties:g.clusterProperties,filter:g.filter},g.workerOptions)}return u&&(p.__proto__=u),(p.prototype=Object.create(u&&u.prototype)).constructor=p,p.prototype.load=function(){var l=this;this.fire(new y.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(g){if(g)l.fire(new y.ErrorEvent(g));else{var E={dataType:"source",sourceDataType:"metadata"};l._collectResourceTiming&&l._resourceTiming&&l._resourceTiming.length>0&&(E.resourceTiming=l._resourceTiming,l._resourceTiming=[]),l.fire(new y.Event("data",E))}})},p.prototype.onAdd=function(l){this.map=l,this.load()},p.prototype.setData=function(l){var g=this;return this._data=l,this.fire(new y.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(E){if(E)g.fire(new y.ErrorEvent(E));else{var P={dataType:"source",sourceDataType:"content"};g._collectResourceTiming&&g._resourceTiming&&g._resourceTiming.length>0&&(P.resourceTiming=g._resourceTiming,g._resourceTiming=[]),g.fire(new y.Event("data",P))}}),this},p.prototype.getClusterExpansionZoom=function(l,g){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:l,source:this.id},g),this},p.prototype.getClusterChildren=function(l,g){return this.actor.send("geojson.getClusterChildren",{clusterId:l,source:this.id},g),this},p.prototype.getClusterLeaves=function(l,g,E,P){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:l,limit:g,offset:E},P),this},p.prototype._updateWorkerData=function(l){var g=this;this._loaded=!1;var E=y.extend({},this.workerOptions),P=this._data;"string"==typeof P?(E.request=this.map._requestManager.transformRequest(y.browser.resolveURL(P),y.ResourceType.Source),E.request.collectResourceTiming=this._collectResourceTiming):E.data=JSON.stringify(P),this.actor.send(this.type+".loadData",E,function(T,k){g._removed||k&&k.abandoned||(g._loaded=!0,k&&k.resourceTiming&&k.resourceTiming[g.id]&&(g._resourceTiming=k.resourceTiming[g.id].slice(0)),g.actor.send(g.type+".coalesce",{source:E.source},null),l(T))})},p.prototype.loaded=function(){return this._loaded},p.prototype.loadTile=function(l,g){var E=this,P=l.actor?"reloadTile":"loadTile";l.actor=this.actor,l.request=this.actor.send(P,{type:this.type,uid:l.uid,tileID:l.tileID,zoom:l.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:y.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId},function(T,k){return delete l.request,l.unloadVectorData(),l.aborted?g(null):T?g(T):(l.loadVectorData(k,E.map.painter,"reloadTile"===P),g(null))})},p.prototype.abortTile=function(l){l.request&&(l.request.cancel(),delete l.request),l.aborted=!0},p.prototype.unloadTile=function(l){l.unloadVectorData(),this.actor.send("removeTile",{uid:l.uid,type:this.type,source:this.id})},p.prototype.onRemove=function(){this._removed=!0,this.actor.send("removeSource",{type:this.type,source:this.id})},p.prototype.serialize=function(){return y.extend({},this._options,{type:this.type,data:this._data})},p.prototype.hasTransition=function(){return!1},p}(y.Evented),Ht=y.createLayout([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]),Qt=function(u){function p(l,g,E,P){u.call(this),this.id=l,this.dispatcher=E,this.coordinates=g.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(P),this.options=g}return u&&(p.__proto__=u),(p.prototype=Object.create(u&&u.prototype)).constructor=p,p.prototype.load=function(l,g){var E=this;this._loaded=!1,this.fire(new y.Event("dataloading",{dataType:"source"})),this.url=this.options.url,y.getImage(this.map._requestManager.transformRequest(this.url,y.ResourceType.Image),function(P,T){E._loaded=!0,P?E.fire(new y.ErrorEvent(P)):T&&(E.image=T,l&&(E.coordinates=l),g&&g(),E._finishLoading())})},p.prototype.loaded=function(){return this._loaded},p.prototype.updateImage=function(l){var g=this;return this.image&&l.url?(this.options.url=l.url,this.load(l.coordinates,function(){g.texture=null}),this):this},p.prototype._finishLoading=function(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new y.Event("data",{dataType:"source",sourceDataType:"metadata"})))},p.prototype.onAdd=function(l){this.map=l,this.load()},p.prototype.setCoordinates=function(l){var g=this;this.coordinates=l;var E=l.map(y.MercatorCoordinate.fromLngLat);this.tileID=function(T){for(var k=1/0,q=1/0,H=-1/0,ut=-1/0,dt=0,lt=T;dt<lt.length;dt+=1){var zt=lt[dt];k=Math.min(k,zt.x),q=Math.min(q,zt.y),H=Math.max(H,zt.x),ut=Math.max(ut,zt.y)}var Rt=Math.max(H-k,ut-q),jt=Math.max(0,Math.floor(-Math.log(Rt)/Math.LN2)),Dt=Math.pow(2,jt);return new y.CanonicalTileID(jt,Math.floor((k+H)/2*Dt),Math.floor((q+ut)/2*Dt))}(E),this.minzoom=this.maxzoom=this.tileID.z;var P=E.map(function(T){return g.tileID.getTilePoint(T)._round()});return this._boundsArray=new y.StructArrayLayout4i8,this._boundsArray.emplaceBack(P[0].x,P[0].y,0,0),this._boundsArray.emplaceBack(P[1].x,P[1].y,y.EXTENT,0),this._boundsArray.emplaceBack(P[3].x,P[3].y,0,y.EXTENT),this._boundsArray.emplaceBack(P[2].x,P[2].y,y.EXTENT,y.EXTENT),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new y.Event("data",{dataType:"source",sourceDataType:"content"})),this},p.prototype.prepare=function(){if(0!==Object.keys(this.tiles).length&&this.image){var l=this.map.painter.context,g=l.gl;for(var E in this.boundsBuffer||(this.boundsBuffer=l.createVertexBuffer(this._boundsArray,Ht.members)),this.boundsSegments||(this.boundsSegments=y.SegmentVector.simpleSegment(0,0,4,2)),this.texture||(this.texture=new y.Texture(l,this.image,g.RGBA),this.texture.bind(g.LINEAR,g.CLAMP_TO_EDGE)),this.tiles){var P=this.tiles[E];"loaded"!==P.state&&(P.state="loaded",P.texture=this.texture)}}},p.prototype.loadTile=function(l,g){this.tileID&&this.tileID.equals(l.tileID.canonical)?(this.tiles[String(l.tileID.wrap)]=l,l.buckets={},g(null)):(l.state="errored",g(null))},p.prototype.serialize=function(){return{type:"image",url:this.options.url,coordinates:this.coordinates}},p.prototype.hasTransition=function(){return!1},p}(y.Evented),vt=function(u){function p(l,g,E,P){u.call(this,l,g,E,P),this.roundZoom=!0,this.type="video",this.options=g}return u&&(p.__proto__=u),(p.prototype=Object.create(u&&u.prototype)).constructor=p,p.prototype.load=function(){var l=this;this._loaded=!1;var g=this.options;this.urls=[];for(var E=0,P=g.urls;E<P.length;E+=1)this.urls.push(this.map._requestManager.transformRequest(P[E],y.ResourceType.Source).url);y.getVideo(this.urls,function(T,k){l._loaded=!0,T?l.fire(new y.ErrorEvent(T)):k&&(l.video=k,l.video.loop=!0,l.video.addEventListener("playing",function(){l.map.triggerRepaint()}),l.map&&l.video.play(),l._finishLoading())})},p.prototype.pause=function(){this.video&&this.video.pause()},p.prototype.play=function(){this.video&&this.video.play()},p.prototype.seek=function(l){if(this.video){var g=this.video.seekable;l<g.start(0)||l>g.end(0)?this.fire(new y.ErrorEvent(new y.ValidationError("sources."+this.id,null,"Playback for this video can be set only between the "+g.start(0)+" and "+g.end(0)+"-second mark."))):this.video.currentTime=l}},p.prototype.getVideo=function(){return this.video},p.prototype.onAdd=function(l){this.map||(this.map=l,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))},p.prototype.prepare=function(){if(!(0===Object.keys(this.tiles).length||this.video.readyState<2)){var l=this.map.painter.context,g=l.gl;for(var E in this.boundsBuffer||(this.boundsBuffer=l.createVertexBuffer(this._boundsArray,Ht.members)),this.boundsSegments||(this.boundsSegments=y.SegmentVector.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(g.LINEAR,g.CLAMP_TO_EDGE),g.texSubImage2D(g.TEXTURE_2D,0,0,0,g.RGBA,g.UNSIGNED_BYTE,this.video)):(this.texture=new y.Texture(l,this.video,g.RGBA),this.texture.bind(g.LINEAR,g.CLAMP_TO_EDGE)),this.tiles){var P=this.tiles[E];"loaded"!==P.state&&(P.state="loaded",P.texture=this.texture)}}},p.prototype.serialize=function(){return{type:"video",urls:this.urls,coordinates:this.coordinates}},p.prototype.hasTransition=function(){return this.video&&!this.video.paused},p}(Qt),we=function(u){function p(l,g,E,P){u.call(this,l,g,E,P),g.coordinates?Array.isArray(g.coordinates)&&4===g.coordinates.length&&!g.coordinates.some(function(T){return!Array.isArray(T)||2!==T.length||T.some(function(k){return"number"!=typeof k})})||this.fire(new y.ErrorEvent(new y.ValidationError("sources."+l,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new y.ErrorEvent(new y.ValidationError("sources."+l,null,'missing required property "coordinates"'))),g.animate&&"boolean"!=typeof g.animate&&this.fire(new y.ErrorEvent(new y.ValidationError("sources."+l,null,'optional "animate" property must be a boolean value'))),g.canvas?"string"==typeof g.canvas||g.canvas instanceof y.window.HTMLCanvasElement||this.fire(new y.ErrorEvent(new y.ValidationError("sources."+l,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new y.ErrorEvent(new y.ValidationError("sources."+l,null,'missing required property "canvas"'))),this.options=g,this.animate=void 0===g.animate||g.animate}return u&&(p.__proto__=u),(p.prototype=Object.create(u&&u.prototype)).constructor=p,p.prototype.load=function(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof y.window.HTMLCanvasElement?this.options.canvas:y.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new y.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())},p.prototype.getCanvas=function(){return this.canvas},p.prototype.onAdd=function(l){this.map=l,this.load(),this.canvas&&this.animate&&this.play()},p.prototype.onRemove=function(){this.pause()},p.prototype.prepare=function(){var l=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,l=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,l=!0),!this._hasInvalidDimensions()&&0!==Object.keys(this.tiles).length){var g=this.map.painter.context,E=g.gl;for(var P in this.boundsBuffer||(this.boundsBuffer=g.createVertexBuffer(this._boundsArray,Ht.members)),this.boundsSegments||(this.boundsSegments=y.SegmentVector.simpleSegment(0,0,4,2)),this.texture?(l||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new y.Texture(g,this.canvas,E.RGBA,{premultiply:!0}),this.tiles){var T=this.tiles[P];"loaded"!==T.state&&(T.state="loaded",T.texture=this.texture)}}},p.prototype.serialize=function(){return{type:"canvas",coordinates:this.coordinates}},p.prototype.hasTransition=function(){return this._playing},p.prototype._hasInvalidDimensions=function(){for(var l=0,g=[this.canvas.width,this.canvas.height];l<g.length;l+=1){var E=g[l];if(isNaN(E)||E<=0)return!0}return!1},p}(Qt),Fe={vector:Te,raster:wt,"raster-dem":re,geojson:Tt,video:vt,image:Qt,canvas:we};function Er(u,p){var l=y.identity([]);return y.translate(l,l,[1,1,0]),y.scale(l,l,[.5*u.width,.5*u.height,1]),y.multiply(l,l,u.calculatePosMatrix(p.toUnwrapped()))}function Oe(u,p,l,g,E,P){var T=function(jt,Dt,qt){if(jt)for(var ee=0,oe=jt;ee<oe.length;ee+=1){var Se=Dt[oe[ee]];if(Se&&Se.source===qt&&"fill-extrusion"===Se.type)return!0}else for(var ge in Dt){var Ce=Dt[ge];if(Ce.source===qt&&"fill-extrusion"===Ce.type)return!0}return!1}(E&&E.layers,p,u.id),k=P.maxPitchScaleFactor(),q=u.tilesIn(g,k,T);q.sort(Zr);for(var H=[],ut=0,dt=q;ut<dt.length;ut+=1){var lt=dt[ut];H.push({wrappedTileID:lt.tileID.wrapped().key,queryResults:lt.tile.queryRenderedFeatures(p,l,u._state,lt.queryGeometry,lt.cameraQueryGeometry,lt.scale,E,P,k,Er(u.transform,lt.tileID))})}var zt=function(jt){for(var Dt={},qt={},ee=0,oe=jt;ee<oe.length;ee+=1){var Se=oe[ee],ge=Se.queryResults,Ce=Se.wrappedTileID,be=qt[Ce]=qt[Ce]||{};for(var Ue in ge)for(var Ne=ge[Ue],Ve=be[Ue]=be[Ue]||{},er=Dt[Ue]=Dt[Ue]||[],ir=0,rr=Ne;ir<rr.length;ir+=1){var Rr=rr[ir];Ve[Rr.featureIndex]||(Ve[Rr.featureIndex]=!0,er.push(Rr))}}return Dt}(H);for(var Rt in zt)zt[Rt].forEach(function(jt){var Dt=jt.feature,qt=u.getFeatureState(Dt.layer["source-layer"],Dt.id);Dt.source=Dt.layer.source,Dt.layer["source-layer"]&&(Dt.sourceLayer=Dt.layer["source-layer"]),Dt.state=qt});return zt}function Zr(u,p){var l=u.tileID,g=p.tileID;return l.overscaledZ-g.overscaledZ||l.canonical.y-g.canonical.y||l.wrap-g.wrap||l.canonical.x-g.canonical.x}var Mr=function(u,p){this.max=u,this.onRemove=p,this.reset()};Mr.prototype.reset=function(){for(var u in this.data)for(var p=0,l=this.data[u];p<l.length;p+=1){var g=l[p];g.timeout&&clearTimeout(g.timeout),this.onRemove(g.value)}return this.data={},this.order=[],this},Mr.prototype.add=function(u,p,l){var g=this,E=u.wrapped().key;void 0===this.data[E]&&(this.data[E]=[]);var P={value:p,timeout:void 0};if(void 0!==l&&(P.timeout=setTimeout(function(){g.remove(u,P)},l)),this.data[E].push(P),this.order.push(E),this.order.length>this.max){var T=this._getAndRemoveByKey(this.order[0]);T&&this.onRemove(T)}return this},Mr.prototype.has=function(u){return u.wrapped().key in this.data},Mr.prototype.getAndRemove=function(u){return this.has(u)?this._getAndRemoveByKey(u.wrapped().key):null},Mr.prototype._getAndRemoveByKey=function(u){var p=this.data[u].shift();return p.timeout&&clearTimeout(p.timeout),0===this.data[u].length&&delete this.data[u],this.order.splice(this.order.indexOf(u),1),p.value},Mr.prototype.getByKey=function(u){var p=this.data[u];return p?p[0].value:null},Mr.prototype.get=function(u){return this.has(u)?this.data[u.wrapped().key][0].value:null},Mr.prototype.remove=function(u,p){if(!this.has(u))return this;var l=u.wrapped().key,g=void 0===p?0:this.data[l].indexOf(p),E=this.data[l][g];return this.data[l].splice(g,1),E.timeout&&clearTimeout(E.timeout),0===this.data[l].length&&delete this.data[l],this.onRemove(E.value),this.order.splice(this.order.indexOf(l),1),this},Mr.prototype.setMaxSize=function(u){for(this.max=u;this.order.length>this.max;){var p=this._getAndRemoveByKey(this.order[0]);p&&this.onRemove(p)}return this},Mr.prototype.filter=function(u){var p=[];for(var l in this.data)for(var g=0,E=this.data[l];g<E.length;g+=1){var P=E[g];u(P.value)||p.push(P)}for(var T=0,k=p;T<k.length;T+=1){var q=k[T];this.remove(q.value.tileID,q)}};var Yr=function(u,p,l){this.context=u;var g=u.gl;this.buffer=g.createBuffer(),this.dynamicDraw=Boolean(l),this.context.unbindVAO(),u.bindElementBuffer.set(this.buffer),g.bufferData(g.ELEMENT_ARRAY_BUFFER,p.arrayBuffer,this.dynamicDraw?g.DYNAMIC_DRAW:g.STATIC_DRAW),this.dynamicDraw||delete p.arrayBuffer};Yr.prototype.bind=function(){this.context.bindElementBuffer.set(this.buffer)},Yr.prototype.updateData=function(u){var p=this.context.gl;this.context.unbindVAO(),this.bind(),p.bufferSubData(p.ELEMENT_ARRAY_BUFFER,0,u.arrayBuffer)},Yr.prototype.destroy=function(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)};var Sr={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"},Cr=function(u,p,l,g){this.length=p.length,this.attributes=l,this.itemSize=p.bytesPerElement,this.dynamicDraw=g,this.context=u;var E=u.gl;this.buffer=E.createBuffer(),u.bindVertexBuffer.set(this.buffer),E.bufferData(E.ARRAY_BUFFER,p.arrayBuffer,this.dynamicDraw?E.DYNAMIC_DRAW:E.STATIC_DRAW),this.dynamicDraw||delete p.arrayBuffer};Cr.prototype.bind=function(){this.context.bindVertexBuffer.set(this.buffer)},Cr.prototype.updateData=function(u){var p=this.context.gl;this.bind(),p.bufferSubData(p.ARRAY_BUFFER,0,u.arrayBuffer)},Cr.prototype.enableAttributes=function(u,p){for(var l=0;l<this.attributes.length;l++){var g=p.attributes[this.attributes[l].name];void 0!==g&&u.enableVertexAttribArray(g)}},Cr.prototype.setVertexAttribPointers=function(u,p,l){for(var g=0;g<this.attributes.length;g++){var E=this.attributes[g],P=p.attributes[E.name];void 0!==P&&u.vertexAttribPointer(P,E.components,u[Sr[E.type]],!1,this.itemSize,E.offset+this.itemSize*(l||0))}},Cr.prototype.destroy=function(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)};var ke=function(u){this.gl=u.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1};ke.prototype.get=function(){return this.current},ke.prototype.set=function(u){},ke.prototype.getDefault=function(){return this.default},ke.prototype.setDefault=function(){this.set(this.default)};var fi=function(u){function p(){u.apply(this,arguments)}return u&&(p.__proto__=u),(p.prototype=Object.create(u&&u.prototype)).constructor=p,p.prototype.getDefault=function(){return y.Color.transparent},p.prototype.set=function(l){var g=this.current;(l.r!==g.r||l.g!==g.g||l.b!==g.b||l.a!==g.a||this.dirty)&&(this.gl.clearColor(l.r,l.g,l.b,l.a),this.current=l,this.dirty=!1)},p}(ke),Mn=function(u){function p(){u.apply(this,arguments)}return u&&(p.__proto__=u),(p.prototype=Object.create(u&&u.prototype)).constructor=p,p.prototype.getDefault=function(){return 1},p.prototype.set=function(l){(l!==this.current||this.dirty)&&(this.gl.clearDepth(l),this.current=l,this.dirty=!1)},p}(ke),Xn=function(u){function p(){u.apply(this,arguments)}return u&&(p.__proto__=u),(p.prototype=Object.create(u&&u.prototype)).constructor=p,p.prototype.getDefault=function(){return 0},p.prototype.set=function(l){(l!==this.current||this.dirty)&&(this.gl.clearStencil(l),this.current=l,this.dirty=!1)},p}(ke),li=function(u){function p(){u.apply(this,arguments)}return u&&(p.__proto__=u),(p.prototype=Object.create(u&&u.prototype)).constructor=p,p.prototype.getDefault=function(){return[!0,!0,!0,!0]},p.prototype.set=function(l){var g=this.current;(l[0]!==g[0]||l[1]!==g[1]||l[2]!==g[2]||l[3]!==g[3]||this.dirty)&&(this.gl.colorMask(l[0],l[1],l[2],l[3]),this.current=l,this.dirty=!1)},p}(ke),Jn=function(u){function p(){u.apply(this,arguments)}return u&&(p.__proto__=u),(p.prototype=Object.create(u&&u.prototype)).constructor=p,p.prototype.getDefault=function(){return!0},p.prototype.set=function(l){(l!==this.current||this.dirty)&&(this.gl.depthMask(l),this.current=l,this.dirty=!1)},p}(ke),le=function(u){function p(){u.apply(this,arguments)}return u&&(p.__proto__=u),(p.prototype=Object.create(u&&u.prototype)).constructor=p,p.prototype.getDefault=function(){return 255},p.prototype.set=function(l){(l!==this.current||this.dirty)&&(this.gl.stencilMask(l),this.current=l,this.dirty=!1)},p}(ke),ot=function(u){function p(){u.apply(this,arguments)}return u&&(p.__proto__=u),(p.prototype=Object.create(u&&u.prototype)).constructor=p,p.prototype.getDefault=function(){return{func:this.gl.ALWAYS,ref:0,mask:255}},p.prototype.set=function(l){var g=this.current;(l.func!==g.func||l.ref!==g.ref||l.mask!==g.mask||this.dirty)&&(this.gl.stencilFunc(l.func,l.ref,l.mask),this.current=l,this.dirty=!1)},p}(ke),rt=function(u){function p(){u.apply(this,arguments)}return u&&(p.__proto__=u),(p.prototype=Object.create(u&&u.prototype)).constructor=p,p.prototype.getDefault=function(){var l=this.gl;return[l.KEEP,l.KEEP,l.KEEP]},p.prototype.set=function(l){var g=this.current;(l[0]!==g[0]||l[1]!==g[1]||l[2]!==g[2]||this.dirty)&&(this.gl.stencilOp(l[0],l[1],l[2]),this.current=l,this.dirty=!1)},p}(ke),tt=function(u){function p(){u.apply(this,arguments)}return u&&(p.__proto__=u),(p.prototype=Object.create(u&&u.prototype)).constructor=p,p.prototype.getDefault=function(){return!1},p.prototype.set=function(l){if(l!==this.current||this.dirty){var g=this.gl;l?g.enable(g.STENCIL_TEST):g.disable(g.STENCIL_TEST),this.current=l,this.dirty=!1}},p}(ke),Pt=function(u){function p(){u.apply(this,arguments)}return u&&(p.__proto__=u),(p.prototype=Object.create(u&&u.prototype)).constructor=p,p.prototype.getDefault=function(){return[0,1]},p.prototype.set=function(l){var g=this.current;(l[0]!==g[0]||l[1]!==g[1]||this.dirty)&&(this.gl.depthRange(l[0],l[1]),this.current=l,this.dirty=!1)},p}(ke),Kt=function(u){function p(){u.apply(this,arguments)}return u&&(p.__proto__=u),(p.prototype=Object.create(u&&u.prototype)).constructor=p,p.prototype.getDefault=function(){return!1},p.prototype.set=function(l){if(l!==this.current||this.dirty){var g=this.gl;l?g.enable(g.DEPTH_TEST):g.disable(g.DEPTH_TEST),this.current=l,this.dirty=!1}},p}(ke),Ee=function(u){function p(){u.apply(this,arguments)}return u&&(p.__proto__=u),(p.prototype=Object.create(u&&u.prototype)).constructor=p,p.prototype.getDefault=function(){return this.gl.LESS},p.prototype.set=function(l){(l!==this.current||this.dirty)&&(this.gl.depthFunc(l),this.current=l,this.dirty=!1)},p}(ke),Ge=function(u){function p(){u.apply(this,arguments)}return u&&(p.__proto__=u),(p.prototype=Object.create(u&&u.prototype)).constructor=p,p.prototype.getDefault=function(){return!1},p.prototype.set=function(l){if(l!==this.current||this.dirty){var g=this.gl;l?g.enable(g.BLEND):g.disable(g.BLEND),this.current=l,this.dirty=!1}},p}(ke),Xe=function(u){function p(){u.apply(this,arguments)}return u&&(p.__proto__=u),(p.prototype=Object.create(u&&u.prototype)).constructor=p,p.prototype.getDefault=function(){var l=this.gl;return[l.ONE,l.ZERO]},p.prototype.set=function(l){var g=this.current;(l[0]!==g[0]||l[1]!==g[1]||this.dirty)&&(this.gl.blendFunc(l[0],l[1]),this.current=l,this.dirty=!1)},p}(ke),Re=function(u){function p(){u.apply(this,arguments)}return u&&(p.__proto__=u),(p.prototype=Object.create(u&&u.prototype)).constructor=p,p.prototype.getDefault=function(){return y.Color.transparent},p.prototype.set=function(l){var g=this.current;(l.r!==g.r||l.g!==g.g||l.b!==g.b||l.a!==g.a||this.dirty)&&(this.gl.blendColor(l.r,l.g,l.b,l.a),this.current=l,this.dirty=!1)},p}(ke),rn=function(u){function p(){u.apply(this,arguments)}return u&&(p.__proto__=u),(p.prototype=Object.create(u&&u.prototype)).constructor=p,p.prototype.getDefault=function(){return this.gl.FUNC_ADD},p.prototype.set=function(l){(l!==this.current||this.dirty)&&(this.gl.blendEquation(l),this.current=l,this.dirty=!1)},p}(ke),cn=function(u){function p(){u.apply(this,arguments)}return u&&(p.__proto__=u),(p.prototype=Object.create(u&&u.prototype)).constructor=p,p.prototype.getDefault=function(){return!1},p.prototype.set=function(l){if(l!==this.current||this.dirty){var g=this.gl;l?g.enable(g.CULL_FACE):g.disable(g.CULL_FACE),this.current=l,this.dirty=!1}},p}(ke),ur=function(u){function p(){u.apply(this,arguments)}return u&&(p.__proto__=u),(p.prototype=Object.create(u&&u.prototype)).constructor=p,p.prototype.getDefault=function(){return this.gl.BACK},p.prototype.set=function(l){(l!==this.current||this.dirty)&&(this.gl.cullFace(l),this.current=l,this.dirty=!1)},p}(ke),Jr=function(u){function p(){u.apply(this,arguments)}return u&&(p.__proto__=u),(p.prototype=Object.create(u&&u.prototype)).constructor=p,p.prototype.getDefault=function(){return this.gl.CCW},p.prototype.set=function(l){(l!==this.current||this.dirty)&&(this.gl.frontFace(l),this.current=l,this.dirty=!1)},p}(ke),di=function(u){function p(){u.apply(this,arguments)}return u&&(p.__proto__=u),(p.prototype=Object.create(u&&u.prototype)).constructor=p,p.prototype.getDefault=function(){return null},p.prototype.set=function(l){(l!==this.current||this.dirty)&&(this.gl.useProgram(l),this.current=l,this.dirty=!1)},p}(ke),On=function(u){function p(){u.apply(this,arguments)}return u&&(p.__proto__=u),(p.prototype=Object.create(u&&u.prototype)).constructor=p,p.prototype.getDefault=function(){return this.gl.TEXTURE0},p.prototype.set=function(l){(l!==this.current||this.dirty)&&(this.gl.activeTexture(l),this.current=l,this.dirty=!1)},p}(ke),Nn=function(u){function p(){u.apply(this,arguments)}return u&&(p.__proto__=u),(p.prototype=Object.create(u&&u.prototype)).constructor=p,p.prototype.getDefault=function(){var l=this.gl;return[0,0,l.drawingBufferWidth,l.drawingBufferHeight]},p.prototype.set=function(l){var g=this.current;(l[0]!==g[0]||l[1]!==g[1]||l[2]!==g[2]||l[3]!==g[3]||this.dirty)&&(this.gl.viewport(l[0],l[1],l[2],l[3]),this.current=l,this.dirty=!1)},p}(ke),_i=function(u){function p(){u.apply(this,arguments)}return u&&(p.__proto__=u),(p.prototype=Object.create(u&&u.prototype)).constructor=p,p.prototype.getDefault=function(){return null},p.prototype.set=function(l){if(l!==this.current||this.dirty){var g=this.gl;g.bindFramebuffer(g.FRAMEBUFFER,l),this.current=l,this.dirty=!1}},p}(ke),ji=function(u){function p(){u.apply(this,arguments)}return u&&(p.__proto__=u),(p.prototype=Object.create(u&&u.prototype)).constructor=p,p.prototype.getDefault=function(){return null},p.prototype.set=function(l){if(l!==this.current||this.dirty){var g=this.gl;g.bindRenderbuffer(g.RENDERBUFFER,l),this.current=l,this.dirty=!1}},p}(ke),fo=function(u){function p(){u.apply(this,arguments)}return u&&(p.__proto__=u),(p.prototype=Object.create(u&&u.prototype)).constructor=p,p.prototype.getDefault=function(){return null},p.prototype.set=function(l){if(l!==this.current||this.dirty){var g=this.gl;g.bindTexture(g.TEXTURE_2D,l),this.current=l,this.dirty=!1}},p}(ke),Xi=function(u){function p(){u.apply(this,arguments)}return u&&(p.__proto__=u),(p.prototype=Object.create(u&&u.prototype)).constructor=p,p.prototype.getDefault=function(){return null},p.prototype.set=function(l){if(l!==this.current||this.dirty){var g=this.gl;g.bindBuffer(g.ARRAY_BUFFER,l),this.current=l,this.dirty=!1}},p}(ke),to=function(u){function p(){u.apply(this,arguments)}return u&&(p.__proto__=u),(p.prototype=Object.create(u&&u.prototype)).constructor=p,p.prototype.getDefault=function(){return null},p.prototype.set=function(l){var g=this.gl;g.bindBuffer(g.ELEMENT_ARRAY_BUFFER,l),this.current=l,this.dirty=!1},p}(ke),$n=function(u){function p(l){u.call(this,l),this.vao=l.extVertexArrayObject}return u&&(p.__proto__=u),(p.prototype=Object.create(u&&u.prototype)).constructor=p,p.prototype.getDefault=function(){return null},p.prototype.set=function(l){this.vao&&(l!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(l),this.current=l,this.dirty=!1)},p}(ke),go=function(u){function p(){u.apply(this,arguments)}return u&&(p.__proto__=u),(p.prototype=Object.create(u&&u.prototype)).constructor=p,p.prototype.getDefault=function(){return 4},p.prototype.set=function(l){if(l!==this.current||this.dirty){var g=this.gl;g.pixelStorei(g.UNPACK_ALIGNMENT,l),this.current=l,this.dirty=!1}},p}(ke),Oi=function(u){function p(){u.apply(this,arguments)}return u&&(p.__proto__=u),(p.prototype=Object.create(u&&u.prototype)).constructor=p,p.prototype.getDefault=function(){return!1},p.prototype.set=function(l){if(l!==this.current||this.dirty){var g=this.gl;g.pixelStorei(g.UNPACK_PREMULTIPLY_ALPHA_WEBGL,l),this.current=l,this.dirty=!1}},p}(ke),Je=function(u){function p(){u.apply(this,arguments)}return u&&(p.__proto__=u),(p.prototype=Object.create(u&&u.prototype)).constructor=p,p.prototype.getDefault=function(){return!1},p.prototype.set=function(l){if(l!==this.current||this.dirty){var g=this.gl;g.pixelStorei(g.UNPACK_FLIP_Y_WEBGL,l),this.current=l,this.dirty=!1}},p}(ke),gi=function(u){function p(l,g){u.call(this,l),this.context=l,this.parent=g}return u&&(p.__proto__=u),(p.prototype=Object.create(u&&u.prototype)).constructor=p,p.prototype.getDefault=function(){return null},p}(ke),Z=function(u){function p(){u.apply(this,arguments)}return u&&(p.__proto__=u),(p.prototype=Object.create(u&&u.prototype)).constructor=p,p.prototype.setDirty=function(){this.dirty=!0},p.prototype.set=function(l){if(l!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var g=this.gl;g.framebufferTexture2D(g.FRAMEBUFFER,g.COLOR_ATTACHMENT0,g.TEXTURE_2D,l,0),this.current=l,this.dirty=!1}},p}(gi),Y=function(u){function p(){u.apply(this,arguments)}return u&&(p.__proto__=u),(p.prototype=Object.create(u&&u.prototype)).constructor=p,p.prototype.set=function(l){if(l!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var g=this.gl;g.framebufferRenderbuffer(g.FRAMEBUFFER,g.DEPTH_ATTACHMENT,g.RENDERBUFFER,l),this.current=l,this.dirty=!1}},p}(gi),it=function(u,p,l,g){this.context=u,this.width=p,this.height=l;var E=this.framebuffer=u.gl.createFramebuffer();this.colorAttachment=new Z(u,E),g&&(this.depthAttachment=new Y(u,E))};it.prototype.destroy=function(){var u=this.context.gl,p=this.colorAttachment.get();if(p&&u.deleteTexture(p),this.depthAttachment){var l=this.depthAttachment.get();l&&u.deleteRenderbuffer(l)}u.deleteFramebuffer(this.framebuffer)};var ht=function(u,p,l){this.func=u,this.mask=p,this.range=l};ht.ReadOnly=!1,ht.ReadWrite=!0,ht.disabled=new ht(519,ht.ReadOnly,[0,1]);var Ot=function(u,p,l,g,E,P){this.test=u,this.ref=p,this.mask=l,this.fail=g,this.depthFail=E,this.pass=P};Ot.disabled=new Ot({func:519,mask:0},0,0,7680,7680,7680);var Xt=function(u,p,l){this.blendFunction=u,this.blendColor=p,this.mask=l};Xt.disabled=new Xt(Xt.Replace=[1,0],y.Color.transparent,[!1,!1,!1,!1]),Xt.unblended=new Xt(Xt.Replace,y.Color.transparent,[!0,!0,!0,!0]),Xt.alphaBlended=new Xt([1,771],y.Color.transparent,[!0,!0,!0,!0]);var ne=function(u,p,l){this.enable=u,this.mode=p,this.frontFace=l};ne.disabled=new ne(!1,1029,2305),ne.backCCW=new ne(!0,1029,2305);var Yt=function(u){this.gl=u,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),this.clearColor=new fi(this),this.clearDepth=new Mn(this),this.clearStencil=new Xn(this),this.colorMask=new li(this),this.depthMask=new Jn(this),this.stencilMask=new le(this),this.stencilFunc=new ot(this),this.stencilOp=new rt(this),this.stencilTest=new tt(this),this.depthRange=new Pt(this),this.depthTest=new Kt(this),this.depthFunc=new Ee(this),this.blend=new Ge(this),this.blendFunc=new Xe(this),this.blendColor=new Re(this),this.blendEquation=new rn(this),this.cullFace=new cn(this),this.cullFaceSide=new ur(this),this.frontFace=new Jr(this),this.program=new di(this),this.activeTexture=new On(this),this.viewport=new Nn(this),this.bindFramebuffer=new _i(this),this.bindRenderbuffer=new ji(this),this.bindTexture=new fo(this),this.bindVertexBuffer=new Xi(this),this.bindElementBuffer=new to(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new $n(this),this.pixelStoreUnpack=new go(this),this.pixelStoreUnpackPremultiplyAlpha=new Oi(this),this.pixelStoreUnpackFlipY=new Je(this),this.extTextureFilterAnisotropic=u.getExtension("EXT_texture_filter_anisotropic")||u.getExtension("MOZ_EXT_texture_filter_anisotropic")||u.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=u.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureHalfFloat=u.getExtension("OES_texture_half_float"),this.extTextureHalfFloat&&(u.getExtension("OES_texture_half_float_linear"),this.extRenderToTextureHalfFloat=u.getExtension("EXT_color_buffer_half_float")),this.extTimerQuery=u.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=u.getParameter(u.MAX_TEXTURE_SIZE)};Yt.prototype.setDefault=function(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()},Yt.prototype.setDirty=function(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0},Yt.prototype.createIndexBuffer=function(u,p){return new Yr(this,u,p)},Yt.prototype.createVertexBuffer=function(u,p,l){return new Cr(this,u,p,l)},Yt.prototype.createRenderbuffer=function(u,p,l){var g=this.gl,E=g.createRenderbuffer();return this.bindRenderbuffer.set(E),g.renderbufferStorage(g.RENDERBUFFER,u,p,l),this.bindRenderbuffer.set(null),E},Yt.prototype.createFramebuffer=function(u,p,l){return new it(this,u,p,l)},Yt.prototype.clear=function(u){var p=u.color,l=u.depth,g=this.gl,E=0;p&&(E|=g.COLOR_BUFFER_BIT,this.clearColor.set(p),this.colorMask.set([!0,!0,!0,!0])),void 0!==l&&(E|=g.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(l),this.depthMask.set(!0)),g.clear(E)},Yt.prototype.setCullFace=function(u){!1===u.enable?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(u.mode),this.frontFace.set(u.frontFace))},Yt.prototype.setDepthMode=function(u){u.func!==this.gl.ALWAYS||u.mask?(this.depthTest.set(!0),this.depthFunc.set(u.func),this.depthMask.set(u.mask),this.depthRange.set(u.range)):this.depthTest.set(!1)},Yt.prototype.setStencilMode=function(u){u.test.func!==this.gl.ALWAYS||u.mask?(this.stencilTest.set(!0),this.stencilMask.set(u.mask),this.stencilOp.set([u.fail,u.depthFail,u.pass]),this.stencilFunc.set({func:u.test.func,ref:u.ref,mask:u.test.mask})):this.stencilTest.set(!1)},Yt.prototype.setColorMode=function(u){y.deepEqual(u.blendFunction,Xt.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(u.blendFunction),this.blendColor.set(u.blendColor)),this.colorMask.set(u.mask)},Yt.prototype.unbindVAO=function(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)};var xt=function(u){function p(l,g,E){var P=this;u.call(this),this.id=l,this.dispatcher=E,this.on("data",function(T){"source"===T.dataType&&"metadata"===T.sourceDataType&&(P._sourceLoaded=!0),P._sourceLoaded&&!P._paused&&"source"===T.dataType&&"content"===T.sourceDataType&&(P.reload(),P.transform&&P.update(P.transform))}),this.on("error",function(){P._sourceErrored=!0}),this._source=function(T,k,q,H){var ut=new Fe[k.type](T,k,q,H);if(ut.id!==T)throw new Error("Expected Source id to be "+T+" instead of "+ut.id);return y.bindAll(["load","abort","unload","serialize","prepare"],ut),ut}(l,g,E,this),this._tiles={},this._cache=new Mr(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new y.SourceFeatureState}return u&&(p.__proto__=u),(p.prototype=Object.create(u&&u.prototype)).constructor=p,p.prototype.onAdd=function(l){this.map=l,this._maxTileCacheSize=l?l._maxTileCacheSize:null,this._source&&this._source.onAdd&&this._source.onAdd(l)},p.prototype.onRemove=function(l){this._source&&this._source.onRemove&&this._source.onRemove(l)},p.prototype.loaded=function(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(var l in this._tiles){var g=this._tiles[l];if("loaded"!==g.state&&"errored"!==g.state)return!1}return!0},p.prototype.getSource=function(){return this._source},p.prototype.pause=function(){this._paused=!0},p.prototype.resume=function(){if(this._paused){var l=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,l&&this.reload(),this.transform&&this.update(this.transform)}},p.prototype._loadTile=function(l,g){return this._source.loadTile(l,g)},p.prototype._unloadTile=function(l){if(this._source.unloadTile)return this._source.unloadTile(l,function(){})},p.prototype._abortTile=function(l){if(this._source.abortTile)return this._source.abortTile(l,function(){})},p.prototype.serialize=function(){return this._source.serialize()},p.prototype.prepare=function(l){for(var g in this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null),this._tiles){var E=this._tiles[g];E.upload(l),E.prepare(this.map.style.imageManager)}},p.prototype.getIds=function(){return y.values(this._tiles).map(function(l){return l.tileID}).sort(Ut).map(function(l){return l.key})},p.prototype.getRenderableIds=function(l){var g=this,E=[];for(var P in this._tiles)this._isIdRenderable(P,l)&&E.push(this._tiles[P]);return l?E.sort(function(T,k){var q=T.tileID,H=k.tileID,ut=new y.Point(q.canonical.x,q.canonical.y)._rotate(g.transform.angle),dt=new y.Point(H.canonical.x,H.canonical.y)._rotate(g.transform.angle);return q.overscaledZ-H.overscaledZ||dt.y-ut.y||dt.x-ut.x}).map(function(T){return T.tileID.key}):E.map(function(T){return T.tileID}).sort(Ut).map(function(T){return T.key})},p.prototype.hasRenderableParent=function(l){var g=this.findLoadedParent(l,0);return!!g&&this._isIdRenderable(g.tileID.key)},p.prototype._isIdRenderable=function(l,g){return this._tiles[l]&&this._tiles[l].hasData()&&!this._coveredTiles[l]&&(g||!this._tiles[l].holdingForFade())},p.prototype.reload=function(){if(this._paused)this._shouldReloadOnResume=!0;else for(var l in this._cache.reset(),this._tiles)"errored"!==this._tiles[l].state&&this._reloadTile(l,"reloading")},p.prototype._reloadTile=function(l,g){var E=this._tiles[l];E&&("loading"!==E.state&&(E.state=g),this._loadTile(E,this._tileLoaded.bind(this,E,l,g)))},p.prototype._tileLoaded=function(l,g,E,P){if(P)return l.state="errored",void(404!==P.status?this._source.fire(new y.ErrorEvent(P,{tile:l})):this.update(this.transform));l.timeAdded=y.browser.now(),"expired"===E&&(l.refreshedUponExpiration=!0),this._setTileReloadTimer(g,l),"raster-dem"===this.getSource().type&&l.dem&&this._backfillDEM(l),this._state.initializeTileState(l,this.map?this.map.painter:null),this._source.fire(new y.Event("data",{dataType:"source",tile:l,coord:l.tileID}))},p.prototype._backfillDEM=function(l){for(var g=this.getRenderableIds(),E=0;E<g.length;E++){var P=g[E];if(l.neighboringTiles&&l.neighboringTiles[P]){var T=this.getTileByID(P);k(l,T),k(T,l)}}function k(q,H){q.needsHillshadePrepare=!0;var ut=H.tileID.canonical.x-q.tileID.canonical.x,dt=H.tileID.canonical.y-q.tileID.canonical.y,lt=Math.pow(2,q.tileID.canonical.z),zt=H.tileID.key;0===ut&&0===dt||Math.abs(dt)>1||(Math.abs(ut)>1&&(1===Math.abs(ut+lt)?ut+=lt:1===Math.abs(ut-lt)&&(ut-=lt)),H.dem&&q.dem&&(q.dem.backfillBorder(H.dem,ut,dt),q.neighboringTiles&&q.neighboringTiles[zt]&&(q.neighboringTiles[zt].backfilled=!0)))}},p.prototype.getTile=function(l){return this.getTileByID(l.key)},p.prototype.getTileByID=function(l){return this._tiles[l]},p.prototype._retainLoadedChildren=function(l,g,E,P){for(var T in this._tiles){var k=this._tiles[T];if(!(P[T]||!k.hasData()||k.tileID.overscaledZ<=g||k.tileID.overscaledZ>E)){for(var q=k.tileID;k&&k.tileID.overscaledZ>g+1;){var H=k.tileID.scaledTo(k.tileID.overscaledZ-1);(k=this._tiles[H.key])&&k.hasData()&&(q=H)}for(var ut=q;ut.overscaledZ>g;)if(l[(ut=ut.scaledTo(ut.overscaledZ-1)).key]){P[q.key]=q;break}}}},p.prototype.findLoadedParent=function(l,g){if(l.key in this._loadedParentTiles){var E=this._loadedParentTiles[l.key];return E&&E.tileID.overscaledZ>=g?E:null}for(var P=l.overscaledZ-1;P>=g;P--){var T=l.scaledTo(P),k=this._getLoadedTile(T);if(k)return k}},p.prototype._getLoadedTile=function(l){var g=this._tiles[l.key];return g&&g.hasData()?g:this._cache.getByKey(l.wrapped().key)},p.prototype.updateCacheSize=function(l){var g=Math.ceil(l.width/this._source.tileSize)+1,E=Math.ceil(l.height/this._source.tileSize)+1,P=Math.floor(g*E*5),T="number"==typeof this._maxTileCacheSize?Math.min(this._maxTileCacheSize,P):P;this._cache.setMaxSize(T)},p.prototype.handleWrapJump=function(l){var g=Math.round((l-(void 0===this._prevLng?l:this._prevLng))/360);if(this._prevLng=l,g){var E={};for(var P in this._tiles){var T=this._tiles[P];T.tileID=T.tileID.unwrapTo(T.tileID.wrap+g),E[T.tileID.key]=T}for(var k in this._tiles=E,this._timers)clearTimeout(this._timers[k]),delete this._timers[k];for(var q in this._tiles)this._setTileReloadTimer(q,this._tiles[q])}},p.prototype.update=function(l){var g=this;if(this.transform=l,this._sourceLoaded&&!this._paused){var E;this.updateCacheSize(l),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used?this._source.tileID?E=l.getVisibleUnwrappedCoordinates(this._source.tileID).map(function(be){return new y.OverscaledTileID(be.canonical.z,be.wrap,be.canonical.z,be.canonical.x,be.canonical.y)}):(E=l.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}),this._source.hasTile&&(E=E.filter(function(be){return g._source.hasTile(be)}))):E=[];var P=l.coveringZoomLevel(this._source),T=Math.max(P-p.maxOverzooming,this._source.minzoom),k=Math.max(P+p.maxUnderzooming,this._source.minzoom),q=this._updateRetainedTiles(E,P);if(je(this._source.type)){for(var H={},ut={},dt=0,lt=Object.keys(q);dt<lt.length;dt+=1){var zt=lt[dt],Rt=q[zt],jt=this._tiles[zt];if(jt&&!(jt.fadeEndTime&&jt.fadeEndTime<=y.browser.now())){var Dt=this.findLoadedParent(Rt,T);Dt&&(this._addTile(Dt.tileID),H[Dt.tileID.key]=Dt.tileID),ut[zt]=Rt}}for(var qt in this._retainLoadedChildren(ut,P,k,q),H)q[qt]||(this._coveredTiles[qt]=!0,q[qt]=H[qt])}for(var ee in q)this._tiles[ee].clearFadeHold();for(var oe=0,Se=y.keysDifference(this._tiles,q);oe<Se.length;oe+=1){var ge=Se[oe],Ce=this._tiles[ge];Ce.hasSymbolBuckets&&!Ce.holdingForFade()?Ce.setHoldDuration(this.map._fadeDuration):Ce.hasSymbolBuckets&&!Ce.symbolFadeFinished()||this._removeTile(ge)}this._updateLoadedParentTileCache()}},p.prototype.releaseSymbolFadeTiles=function(){for(var l in this._tiles)this._tiles[l].holdingForFade()&&this._removeTile(l)},p.prototype._updateRetainedTiles=function(l,g){for(var E={},P={},T=Math.max(g-p.maxOverzooming,this._source.minzoom),k=Math.max(g+p.maxUnderzooming,this._source.minzoom),q={},H=0,ut=l;H<ut.length;H+=1){var dt=ut[H],lt=this._addTile(dt);E[dt.key]=dt,lt.hasData()||g<this._source.maxzoom&&(q[dt.key]=dt)}this._retainLoadedChildren(q,g,k,E);for(var zt=0,Rt=l;zt<Rt.length;zt+=1){var jt=Rt[zt],Dt=this._tiles[jt.key];if(!Dt.hasData()){if(g+1>this._source.maxzoom){var qt=jt.children(this._source.maxzoom)[0],ee=this.getTile(qt);if(ee&&ee.hasData()){E[qt.key]=qt;continue}}else{var oe=jt.children(this._source.maxzoom);if(E[oe[0].key]&&E[oe[1].key]&&E[oe[2].key]&&E[oe[3].key])continue}for(var Se=Dt.wasRequested(),ge=jt.overscaledZ-1;ge>=T;--ge){var Ce=jt.scaledTo(ge);if(P[Ce.key]||(P[Ce.key]=!0,!(Dt=this.getTile(Ce))&&Se&&(Dt=this._addTile(Ce)),Dt&&(E[Ce.key]=Ce,Se=Dt.wasRequested(),Dt.hasData())))break}}}return E},p.prototype._updateLoadedParentTileCache=function(){for(var l in this._loadedParentTiles={},this._tiles){for(var g=[],E=void 0,P=this._tiles[l].tileID;P.overscaledZ>0;){if(P.key in this._loadedParentTiles){E=this._loadedParentTiles[P.key];break}g.push(P.key);var T=P.scaledTo(P.overscaledZ-1);if(E=this._getLoadedTile(T))break;P=T}for(var k=0,q=g;k<q.length;k+=1)this._loadedParentTiles[q[k]]=E}},p.prototype._addTile=function(l){var g=this._tiles[l.key];if(g)return g;(g=this._cache.getAndRemove(l))&&(this._setTileReloadTimer(l.key,g),g.tileID=l,this._state.initializeTileState(g,this.map?this.map.painter:null),this._cacheTimers[l.key]&&(clearTimeout(this._cacheTimers[l.key]),delete this._cacheTimers[l.key],this._setTileReloadTimer(l.key,g)));var E=Boolean(g);return E||(g=new y.Tile(l,this._source.tileSize*l.overscaleFactor()),this._loadTile(g,this._tileLoaded.bind(this,g,l.key,g.state))),g?(g.uses++,this._tiles[l.key]=g,E||this._source.fire(new y.Event("dataloading",{tile:g,coord:g.tileID,dataType:"source"})),g):null},p.prototype._setTileReloadTimer=function(l,g){var E=this;l in this._timers&&(clearTimeout(this._timers[l]),delete this._timers[l]);var P=g.getExpiryTimeout();P&&(this._timers[l]=setTimeout(function(){E._reloadTile(l,"expired"),delete E._timers[l]},P))},p.prototype._removeTile=function(l){var g=this._tiles[l];g&&(g.uses--,delete this._tiles[l],this._timers[l]&&(clearTimeout(this._timers[l]),delete this._timers[l]),g.uses>0||(g.hasData()&&"reloading"!==g.state?this._cache.add(g.tileID,g,g.getExpiryTimeout()):(g.aborted=!0,this._abortTile(g),this._unloadTile(g))))},p.prototype.clearTiles=function(){for(var l in this._shouldReloadOnResume=!1,this._paused=!1,this._tiles)this._removeTile(l);this._cache.reset()},p.prototype.tilesIn=function(l,g,E){var P=this,T=[],k=this.transform;if(!k)return T;for(var q=E?k.getCameraQueryGeometry(l):l,H=l.map(function(ge){return k.pointCoordinate(ge)}),ut=q.map(function(ge){return k.pointCoordinate(ge)}),dt=this.getIds(),lt=1/0,zt=1/0,Rt=-1/0,jt=-1/0,Dt=0,qt=ut;Dt<qt.length;Dt+=1){var ee=qt[Dt];lt=Math.min(lt,ee.x),zt=Math.min(zt,ee.y),Rt=Math.max(Rt,ee.x),jt=Math.max(jt,ee.y)}for(var oe=function(ge){var Ce=P._tiles[dt[ge]];if(!Ce.holdingForFade()){var be=Ce.tileID,Ue=Math.pow(2,k.zoom-Ce.tileID.overscaledZ),Ne=g*Ce.queryPadding*y.EXTENT/Ce.tileSize/Ue,Ve=[be.getTilePoint(new y.MercatorCoordinate(lt,zt)),be.getTilePoint(new y.MercatorCoordinate(Rt,jt))];if(Ve[0].x-Ne<y.EXTENT&&Ve[0].y-Ne<y.EXTENT&&Ve[1].x+Ne>=0&&Ve[1].y+Ne>=0){var er=H.map(function(rr){return be.getTilePoint(rr)}),ir=ut.map(function(rr){return be.getTilePoint(rr)});T.push({tile:Ce,tileID:be,queryGeometry:er,cameraQueryGeometry:ir,scale:Ue})}}},Se=0;Se<dt.length;Se++)oe(Se);return T},p.prototype.getVisibleCoordinates=function(l){for(var g=this,E=this.getRenderableIds(l).map(function(q){return g._tiles[q].tileID}),P=0,T=E;P<T.length;P+=1){var k=T[P];k.posMatrix=this.transform.calculatePosMatrix(k.toUnwrapped())}return E},p.prototype.hasTransition=function(){if(this._source.hasTransition())return!0;if(je(this._source.type))for(var l in this._tiles){var g=this._tiles[l];if(void 0!==g.fadeEndTime&&g.fadeEndTime>=y.browser.now())return!0}return!1},p.prototype.setFeatureState=function(l,g,E){this._state.updateState(l=l||"_geojsonTileLayer",g,E)},p.prototype.removeFeatureState=function(l,g,E){this._state.removeFeatureState(l=l||"_geojsonTileLayer",g,E)},p.prototype.getFeatureState=function(l,g){return this._state.getState(l=l||"_geojsonTileLayer",g)},p.prototype.setDependencies=function(l,g,E){var P=this._tiles[l];P&&P.setDependencies(g,E)},p.prototype.reloadTilesForDependencies=function(l,g){for(var E in this._tiles)this._tiles[E].hasDependency(l,g)&&this._reloadTile(E,"reloading");this._cache.filter(function(P){return!P.hasDependency(l,g)})},p}(y.Evented);function Ut(u,p){var l=Math.abs(2*u.wrap)-+(u.wrap<0),g=Math.abs(2*p.wrap)-+(p.wrap<0);return u.overscaledZ-p.overscaledZ||g-l||p.canonical.y-u.canonical.y||p.canonical.x-u.canonical.x}function je(u){return"raster"===u||"image"===u||"video"===u}function or(){return new y.window.Worker(Wn.workerUrl)}xt.maxOverzooming=10,xt.maxUnderzooming=3;var ye="mapboxgl_preloaded_worker_pool",Le=function(){this.active={}};Le.prototype.acquire=function(u){if(!this.workers)for(this.workers=[];this.workers.length<Le.workerCount;)this.workers.push(new or);return this.active[u]=!0,this.workers.slice()},Le.prototype.release=function(u){delete this.active[u],0===this.numActive()&&(this.workers.forEach(function(p){p.terminate()}),this.workers=null)},Le.prototype.isPreloaded=function(){return!!this.active[ye]},Le.prototype.numActive=function(){return Object.keys(this.active).length};var lr,pr=Math.floor(y.browser.hardwareConcurrency/2);function Pr(){return lr||(lr=new Le),lr}function De(u,p){var l={};for(var g in u)"ref"!==g&&(l[g]=u[g]);return y.refProperties.forEach(function(E){E in p&&(l[E]=p[E])}),l}function sr(u){u=u.slice();for(var p=Object.create(null),l=0;l<u.length;l++)p[u[l].id]=u[l];for(var g=0;g<u.length;g++)"ref"in u[g]&&(u[g]=De(u[g],p[u[g].ref]));return u}Le.workerCount=Math.max(Math.min(pr,6),1);var Be={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight"};function sn(u,p,l){l.push({command:Be.addSource,args:[u,p[u]]})}function qr(u,p,l){p.push({command:Be.removeSource,args:[u]}),l[u]=!0}function Tr(u,p,l,g){qr(u,l,g),sn(u,p,l)}function wr(u,p,l){var g;for(g in u[l])if(u[l].hasOwnProperty(g)&&"data"!==g&&!y.deepEqual(u[l][g],p[l][g]))return!1;for(g in p[l])if(p[l].hasOwnProperty(g)&&"data"!==g&&!y.deepEqual(u[l][g],p[l][g]))return!1;return!0}function zr(u,p,l,g,E,P){var T;for(T in p=p||{},u=u||{})u.hasOwnProperty(T)&&(y.deepEqual(u[T],p[T])||l.push({command:P,args:[g,T,p[T],E]}));for(T in p)p.hasOwnProperty(T)&&!u.hasOwnProperty(T)&&(y.deepEqual(u[T],p[T])||l.push({command:P,args:[g,T,p[T],E]}))}function ui(u){return u.id}function Tn(u,p){return u[p.id]=p,u}var xn=function(u,p){this.reset(u,p)};xn.prototype.reset=function(u,p){this.points=u||[],this._distances=[0];for(var l=1;l<this.points.length;l++)this._distances[l]=this._distances[l-1]+this.points[l].dist(this.points[l-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(p||0,.5*this.length),this.paddedLength=this.length-2*this.padding},xn.prototype.lerp=function(u){if(1===this.points.length)return this.points[0];u=y.clamp(u,0,1);for(var p=1,l=this._distances[p],g=u*this.paddedLength+this.padding;l<g&&p<this._distances.length;)l=this._distances[++p];var E=p-1,P=this._distances[E],T=l-P,k=T>0?(g-P)/T:0;return this.points[E].mult(1-k).add(this.points[p].mult(k))};var ln=function(u,p,l){var g=this.boxCells=[],E=this.circleCells=[];this.xCellCount=Math.ceil(u/l),this.yCellCount=Math.ceil(p/l);for(var P=0;P<this.xCellCount*this.yCellCount;P++)g.push([]),E.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=u,this.height=p,this.xScale=this.xCellCount/u,this.yScale=this.yCellCount/p,this.boxUid=0,this.circleUid=0};function xi(u,p,l,g,E){var P=y.create();return p?(y.scale(P,P,[1/E,1/E,1]),l||y.rotateZ(P,P,g.angle)):y.multiply(P,g.labelPlaneMatrix,u),P}function zn(u,p,l,g,E){if(p){var P=y.clone(u);return y.scale(P,P,[E,E,1]),l||y.rotateZ(P,P,-g.angle),P}return g.glCoordMatrix}function un(u,p){var l=[u.x,u.y,0,1];bn(l,l,p);var g=l[3];return{point:new y.Point(l[0]/g,l[1]/g),signedDistanceFromCamera:g}}function ko(u,p){return.5+u/p*.5}function An(u,p){var l=u[0]/u[3],g=u[1]/u[3];return l>=-p[0]&&l<=p[0]&&g>=-p[1]&&g<=p[1]}function gs(u,p,l,g,E,P,T,k){var q=g?u.textSizeData:u.iconSizeData,H=y.evaluateSizeForZoom(q,l.transform.zoom),ut=[256/l.width*2+1,256/l.height*2+1],dt=g?u.text.dynamicLayoutVertexArray:u.icon.dynamicLayoutVertexArray;dt.clear();for(var lt=u.lineVertexArray,zt=g?u.text.placedSymbolArray:u.icon.placedSymbolArray,Rt=l.transform.width/l.transform.height,jt=!1,Dt=0;Dt<zt.length;Dt++){var qt=zt.get(Dt);if(qt.hidden||qt.writingMode===y.WritingMode.vertical&&!jt)Is(qt.numGlyphs,dt);else{jt=!1;var ee=[qt.anchorX,qt.anchorY,0,1];if(y.transformMat4(ee,ee,p),An(ee,ut)){var oe=ko(l.transform.cameraToCenterDistance,ee[3]),Se=y.evaluateSizeForFeature(q,H,qt),ge=T?Se/oe:Se*oe,Ce=new y.Point(qt.anchorX,qt.anchorY),be=un(Ce,E).point,Ue={},Ne=Un(qt,ge,!1,k,p,E,P,u.glyphOffsetArray,lt,dt,be,Ce,Ue,Rt);jt=Ne.useVertical,(Ne.notEnoughRoom||jt||Ne.needsFlipping&&Un(qt,ge,!0,k,p,E,P,u.glyphOffsetArray,lt,dt,be,Ce,Ue,Rt).notEnoughRoom)&&Is(qt.numGlyphs,dt)}else Is(qt.numGlyphs,dt)}}g?u.text.dynamicLayoutVertexBuffer.updateData(dt):u.icon.dynamicLayoutVertexBuffer.updateData(dt)}function Vs(u,p,l,g,E,P,T,k,q,H,ut){var dt=k.glyphStartIndex+k.numGlyphs,lt=k.lineStartIndex,zt=k.lineStartIndex+k.lineLength,Rt=p.getoffsetX(k.glyphStartIndex),jt=p.getoffsetX(dt-1),Dt=pa(u*Rt,l,g,E,P,T,k.segment,lt,zt,q,H,ut);if(!Dt)return null;var qt=pa(u*jt,l,g,E,P,T,k.segment,lt,zt,q,H,ut);return qt?{first:Dt,last:qt}:null}function oo(u,p,l,g){return u===y.WritingMode.horizontal&&Math.abs(l.y-p.y)>Math.abs(l.x-p.x)*g?{useVertical:!0}:(u===y.WritingMode.vertical?p.y<l.y:p.x>l.x)?{needsFlipping:!0}:null}function Un(u,p,l,g,E,P,T,k,q,H,ut,dt,lt,zt){var Rt,jt=p/24,Dt=u.lineOffsetX*jt,qt=u.lineOffsetY*jt;if(u.numGlyphs>1){var ee=u.glyphStartIndex+u.numGlyphs,oe=u.lineStartIndex,Se=u.lineStartIndex+u.lineLength,ge=Vs(jt,k,Dt,qt,l,ut,dt,u,q,P,lt);if(!ge)return{notEnoughRoom:!0};var Ce=un(ge.first.point,T).point,be=un(ge.last.point,T).point;if(g&&!l){var Ue=oo(u.writingMode,Ce,be,zt);if(Ue)return Ue}Rt=[ge.first];for(var Ne=u.glyphStartIndex+1;Ne<ee-1;Ne++)Rt.push(pa(jt*k.getoffsetX(Ne),Dt,qt,l,ut,dt,u.segment,oe,Se,q,P,lt));Rt.push(ge.last)}else{if(g&&!l){var Ve=un(dt,E).point,er=u.lineStartIndex+u.segment+1,ir=new y.Point(q.getx(er),q.gety(er)),rr=un(ir,E),Rr=rr.signedDistanceFromCamera>0?rr.point:ml(dt,ir,Ve,1,E),Ye=oo(u.writingMode,Ve,Rr,zt);if(Ye)return Ye}var _r=pa(jt*k.getoffsetX(u.glyphStartIndex),Dt,qt,l,ut,dt,u.segment,u.lineStartIndex,u.lineStartIndex+u.lineLength,q,P,lt);if(!_r)return{notEnoughRoom:!0};Rt=[_r]}for(var Ir=0,xr=Rt;Ir<xr.length;Ir+=1){var yr=xr[Ir];y.addDynamicAttributes(H,yr.point,yr.angle)}return{}}function ml(u,p,l,g,E){var P=un(u.add(u.sub(p)._unit()),E).point,T=l.sub(P);return l.add(T._mult(g/T.mag()))}function pa(u,p,l,g,E,P,T,k,q,H,ut,dt){var lt=g?u-p:u+p,zt=lt>0?1:-1,Rt=0;g&&(zt*=-1,Rt=Math.PI),zt<0&&(Rt+=Math.PI);for(var jt=zt>0?k+T:k+T+1,Dt=E,qt=E,ee=0,oe=0,Se=Math.abs(lt),ge=[];ee+oe<=Se;){if((jt+=zt)<k||jt>=q)return null;if(qt=Dt,ge.push(Dt),void 0===(Dt=dt[jt])){var Ce=new y.Point(H.getx(jt),H.gety(jt)),be=un(Ce,ut);if(be.signedDistanceFromCamera>0)Dt=dt[jt]=be.point;else{var Ue=jt-zt;Dt=ml(0===ee?P:new y.Point(H.getx(Ue),H.gety(Ue)),Ce,qt,Se-ee+1,ut)}}ee+=oe,oe=qt.dist(Dt)}var Ne=(Se-ee)/oe,Ve=Dt.sub(qt),er=Ve.mult(Ne)._add(qt);er._add(Ve._unit()._perp()._mult(l*zt));var ir=Rt+Math.atan2(Dt.y-qt.y,Dt.x-qt.x);return ge.push(er),{point:er,angle:ir,path:ge}}ln.prototype.keysLength=function(){return this.boxKeys.length+this.circleKeys.length},ln.prototype.insert=function(u,p,l,g,E){this._forEachCell(p,l,g,E,this._insertBoxCell,this.boxUid++),this.boxKeys.push(u),this.bboxes.push(p),this.bboxes.push(l),this.bboxes.push(g),this.bboxes.push(E)},ln.prototype.insertCircle=function(u,p,l,g){this._forEachCell(p-g,l-g,p+g,l+g,this._insertCircleCell,this.circleUid++),this.circleKeys.push(u),this.circles.push(p),this.circles.push(l),this.circles.push(g)},ln.prototype._insertBoxCell=function(u,p,l,g,E,P){this.boxCells[E].push(P)},ln.prototype._insertCircleCell=function(u,p,l,g,E,P){this.circleCells[E].push(P)},ln.prototype._query=function(u,p,l,g,E,P){if(l<0||u>this.width||g<0||p>this.height)return!E&&[];var T=[];if(u<=0&&p<=0&&this.width<=l&&this.height<=g){if(E)return!0;for(var k=0;k<this.boxKeys.length;k++)T.push({key:this.boxKeys[k],x1:this.bboxes[4*k],y1:this.bboxes[4*k+1],x2:this.bboxes[4*k+2],y2:this.bboxes[4*k+3]});for(var q=0;q<this.circleKeys.length;q++){var H=this.circles[3*q],ut=this.circles[3*q+1],dt=this.circles[3*q+2];T.push({key:this.circleKeys[q],x1:H-dt,y1:ut-dt,x2:H+dt,y2:ut+dt})}return P?T.filter(P):T}return this._forEachCell(u,p,l,g,this._queryCell,T,{hitTest:E,seenUids:{box:{},circle:{}}},P),E?T.length>0:T},ln.prototype._queryCircle=function(u,p,l,g,E){var P=u-l,T=u+l,k=p-l,q=p+l;if(T<0||P>this.width||q<0||k>this.height)return!g&&[];var H=[];return this._forEachCell(P,k,T,q,this._queryCellCircle,H,{hitTest:g,circle:{x:u,y:p,radius:l},seenUids:{box:{},circle:{}}},E),g?H.length>0:H},ln.prototype.query=function(u,p,l,g,E){return this._query(u,p,l,g,!1,E)},ln.prototype.hitTest=function(u,p,l,g,E){return this._query(u,p,l,g,!0,E)},ln.prototype.hitTestCircle=function(u,p,l,g){return this._queryCircle(u,p,l,!0,g)},ln.prototype._queryCell=function(u,p,l,g,E,P,T,k){var q=T.seenUids,H=this.boxCells[E];if(null!==H)for(var ut=this.bboxes,dt=0,lt=H;dt<lt.length;dt+=1){var zt=lt[dt];if(!q.box[zt]){q.box[zt]=!0;var Rt=4*zt;if(u<=ut[Rt+2]&&p<=ut[Rt+3]&&l>=ut[Rt+0]&&g>=ut[Rt+1]&&(!k||k(this.boxKeys[zt]))){if(T.hitTest)return P.push(!0),!0;P.push({key:this.boxKeys[zt],x1:ut[Rt],y1:ut[Rt+1],x2:ut[Rt+2],y2:ut[Rt+3]})}}}var jt=this.circleCells[E];if(null!==jt)for(var Dt=this.circles,qt=0,ee=jt;qt<ee.length;qt+=1){var oe=ee[qt];if(!q.circle[oe]){q.circle[oe]=!0;var Se=3*oe;if(this._circleAndRectCollide(Dt[Se],Dt[Se+1],Dt[Se+2],u,p,l,g)&&(!k||k(this.circleKeys[oe]))){if(T.hitTest)return P.push(!0),!0;var ge=Dt[Se],Ce=Dt[Se+1],be=Dt[Se+2];P.push({key:this.circleKeys[oe],x1:ge-be,y1:Ce-be,x2:ge+be,y2:Ce+be})}}}},ln.prototype._queryCellCircle=function(u,p,l,g,E,P,T,k){var q=T.circle,H=T.seenUids,ut=this.boxCells[E];if(null!==ut)for(var dt=this.bboxes,lt=0,zt=ut;lt<zt.length;lt+=1){var Rt=zt[lt];if(!H.box[Rt]){H.box[Rt]=!0;var jt=4*Rt;if(this._circleAndRectCollide(q.x,q.y,q.radius,dt[jt+0],dt[jt+1],dt[jt+2],dt[jt+3])&&(!k||k(this.boxKeys[Rt])))return P.push(!0),!0}}var Dt=this.circleCells[E];if(null!==Dt)for(var qt=this.circles,ee=0,oe=Dt;ee<oe.length;ee+=1){var Se=oe[ee];if(!H.circle[Se]){H.circle[Se]=!0;var ge=3*Se;if(this._circlesCollide(qt[ge],qt[ge+1],qt[ge+2],q.x,q.y,q.radius)&&(!k||k(this.circleKeys[Se])))return P.push(!0),!0}}},ln.prototype._forEachCell=function(u,p,l,g,E,P,T,k){for(var q=this._convertToXCellCoord(u),H=this._convertToYCellCoord(p),ut=this._convertToXCellCoord(l),dt=this._convertToYCellCoord(g),lt=q;lt<=ut;lt++)for(var zt=H;zt<=dt;zt++)if(E.call(this,u,p,l,g,this.xCellCount*zt+lt,P,T,k))return},ln.prototype._convertToXCellCoord=function(u){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(u*this.xScale)))},ln.prototype._convertToYCellCoord=function(u){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(u*this.yScale)))},ln.prototype._circlesCollide=function(u,p,l,g,E,P){var T=g-u,k=E-p,q=l+P;return q*q>T*T+k*k},ln.prototype._circleAndRectCollide=function(u,p,l,g,E,P,T){var k=(P-g)/2,q=Math.abs(u-(g+k));if(q>k+l)return!1;var H=(T-E)/2,ut=Math.abs(p-(E+H));if(ut>H+l)return!1;if(q<=k||ut<=H)return!0;var dt=q-k,lt=ut-H;return dt*dt+lt*lt<=l*l};var mo=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function Is(u,p){for(var l=0;l<u;l++){var g=p.length;p.resize(g+4),p.float32.set(mo,3*g)}}function bn(u,p,l){var g=p[0],E=p[1];return u[0]=l[0]*g+l[4]*E+l[12],u[1]=l[1]*g+l[5]*E+l[13],u[3]=l[3]*g+l[7]*E+l[15],u}var Mi=function(u,p,l){void 0===p&&(p=new ln(u.width+200,u.height+200,25)),void 0===l&&(l=new ln(u.width+200,u.height+200,25)),this.transform=u,this.grid=p,this.ignoredGrid=l,this.pitchfactor=Math.cos(u._pitch)*u.cameraToCenterDistance,this.screenRightBoundary=u.width+100,this.screenBottomBoundary=u.height+100,this.gridRightBoundary=u.width+200,this.gridBottomBoundary=u.height+200};function Di(u,p,l){return p*(y.EXTENT/(u.tileSize*Math.pow(2,l-u.tileID.overscaledZ)))}Mi.prototype.placeCollisionBox=function(u,p,l,g,E){var P=this.projectAndGetPerspectiveRatio(g,u.anchorPointX,u.anchorPointY),T=l*P.perspectiveRatio,k=u.x1*T+P.point.x,q=u.y1*T+P.point.y,H=u.x2*T+P.point.x,ut=u.y2*T+P.point.y;return!this.isInsideGrid(k,q,H,ut)||!p&&this.grid.hitTest(k,q,H,ut,E)?{box:[],offscreen:!1}:{box:[k,q,H,ut],offscreen:this.isOffscreen(k,q,H,ut)}},Mi.prototype.placeCollisionCircles=function(u,p,l,g,E,P,T,k,q,H,ut,dt,lt){var zt=[],Rt=new y.Point(p.anchorX,p.anchorY),jt=un(Rt,P),Dt=ko(this.transform.cameraToCenterDistance,jt.signedDistanceFromCamera),qt=(H?E/Dt:E*Dt)/y.ONE_EM,ee=un(Rt,T).point,oe=Vs(qt,g,p.lineOffsetX*qt,p.lineOffsetY*qt,!1,ee,Rt,p,l,T,{}),Se=!1,ge=!1,Ce=!0;if(oe){for(var be=.5*dt*Dt+lt,Ue=new y.Point(-100,-100),Ne=new y.Point(this.screenRightBoundary,this.screenBottomBoundary),Ve=new xn,er=oe.first,ir=oe.last,rr=[],Rr=er.path.length-1;Rr>=1;Rr--)rr.push(er.path[Rr]);for(var Ye=1;Ye<ir.path.length;Ye++)rr.push(ir.path[Ye]);var _r=2.5*be;if(k){var Ir=rr.map(function(ts){return un(ts,k)});rr=Ir.some(function(ts){return ts.signedDistanceFromCamera<=0})?[]:Ir.map(function(ts){return ts.point})}var xr=[];if(rr.length>0){for(var yr=rr[0].clone(),dr=rr[0].clone(),cr=1;cr<rr.length;cr++)yr.x=Math.min(yr.x,rr[cr].x),yr.y=Math.min(yr.y,rr[cr].y),dr.x=Math.max(dr.x,rr[cr].x),dr.y=Math.max(dr.y,rr[cr].y);xr=yr.x>=Ue.x&&dr.x<=Ne.x&&yr.y>=Ue.y&&dr.y<=Ne.y?[rr]:dr.x<Ue.x||yr.x>Ne.x||dr.y<Ue.y||yr.y>Ne.y?[]:y.clipLine([rr],Ue.x,Ue.y,Ne.x,Ne.y)}for(var ar=0,Vr=xr;ar<Vr.length;ar+=1){var Kr;Ve.reset(Vr[ar],.25*be),Kr=Ve.length<=.5*be?1:Math.ceil(Ve.paddedLength/_r)+1;for(var pn=0;pn<Kr;pn++){var on=pn/Math.max(Kr-1,1),an=Ve.lerp(on),$r=an.x+100,hn=an.y+100;zt.push($r,hn,be,0);var Cn=$r-be,_a=hn-be,xa=$r+be,Ds=hn+be;if(Ce=Ce&&this.isOffscreen(Cn,_a,xa,Ds),ge=ge||this.isInsideGrid(Cn,_a,xa,Ds),!u&&this.grid.hitTestCircle($r,hn,be,ut)&&(Se=!0,!q))return{circles:[],offscreen:!1,collisionDetected:Se}}}}return{circles:!q&&Se||!ge?[]:zt,offscreen:Ce,collisionDetected:Se}},Mi.prototype.queryRenderedSymbols=function(u){if(0===u.length||0===this.grid.keysLength()&&0===this.ignoredGrid.keysLength())return{};for(var p=[],l=1/0,g=1/0,E=-1/0,P=-1/0,T=0,k=u;T<k.length;T+=1){var q=k[T],H=new y.Point(q.x+100,q.y+100);l=Math.min(l,H.x),g=Math.min(g,H.y),E=Math.max(E,H.x),P=Math.max(P,H.y),p.push(H)}for(var ut={},dt={},lt=0,zt=this.grid.query(l,g,E,P).concat(this.ignoredGrid.query(l,g,E,P));lt<zt.length;lt+=1){var Rt=zt[lt],jt=Rt.key;if(void 0===ut[jt.bucketInstanceId]&&(ut[jt.bucketInstanceId]={}),!ut[jt.bucketInstanceId][jt.featureIndex]){var Dt=[new y.Point(Rt.x1,Rt.y1),new y.Point(Rt.x2,Rt.y1),new y.Point(Rt.x2,Rt.y2),new y.Point(Rt.x1,Rt.y2)];y.polygonIntersectsPolygon(p,Dt)&&(ut[jt.bucketInstanceId][jt.featureIndex]=!0,void 0===dt[jt.bucketInstanceId]&&(dt[jt.bucketInstanceId]=[]),dt[jt.bucketInstanceId].push(jt.featureIndex))}}return dt},Mi.prototype.insertCollisionBox=function(u,p,l,g,E){(p?this.ignoredGrid:this.grid).insert({bucketInstanceId:l,featureIndex:g,collisionGroupID:E},u[0],u[1],u[2],u[3])},Mi.prototype.insertCollisionCircles=function(u,p,l,g,E){for(var P=p?this.ignoredGrid:this.grid,T={bucketInstanceId:l,featureIndex:g,collisionGroupID:E},k=0;k<u.length;k+=4)P.insertCircle(T,u[k],u[k+1],u[k+2])},Mi.prototype.projectAndGetPerspectiveRatio=function(u,p,l){var g=[p,l,0,1];return bn(g,g,u),{point:new y.Point((g[0]/g[3]+1)/2*this.transform.width+100,(-g[1]/g[3]+1)/2*this.transform.height+100),perspectiveRatio:.5+this.transform.cameraToCenterDistance/g[3]*.5}},Mi.prototype.isOffscreen=function(u,p,l,g){return l<100||u>=this.screenRightBoundary||g<100||p>this.screenBottomBoundary},Mi.prototype.isInsideGrid=function(u,p,l,g){return l>=0&&u<this.gridRightBoundary&&g>=0&&p<this.gridBottomBoundary},Mi.prototype.getViewportMatrix=function(){var u=y.identity([]);return y.translate(u,u,[-100,-100,0]),u};var zo=function(u,p,l,g){this.opacity=u?Math.max(0,Math.min(1,u.opacity+(u.placed?p:-p))):g&&l?1:0,this.placed=l};zo.prototype.isHidden=function(){return 0===this.opacity&&!this.placed};var nn=function(u,p,l,g,E){this.text=new zo(u?u.text:null,p,l,E),this.icon=new zo(u?u.icon:null,p,g,E)};nn.prototype.isHidden=function(){return this.text.isHidden()&&this.icon.isHidden()};var Ps=function(u,p,l){this.text=u,this.icon=p,this.skipFade=l},Kc=function(){this.invProjMatrix=y.create(),this.viewportMatrix=y.create(),this.circles=[]},jo=function(u,p,l,g,E){this.bucketInstanceId=u,this.featureIndex=p,this.sourceLayerIndex=l,this.bucketIndex=g,this.tileID=E},Za=function(u){this.crossSourceCollisions=u,this.maxGroupID=0,this.collisionGroups={}};function ra(u,p,l,g,E){var P=y.getAnchorAlignment(u),T=-(P.horizontalAlign-.5)*p,k=-(P.verticalAlign-.5)*l,q=y.evaluateVariableOffset(u,g);return new y.Point(T+q[0]*E,k+q[1]*E)}function Mo(u,p,l,g,E,P){var T=u.x1,k=u.x2,q=u.y1,H=u.y2,ut=u.anchorPointX,dt=u.anchorPointY,lt=new y.Point(p,l);return g&&lt._rotate(E?P:-P),{x1:T+lt.x,y1:q+lt.y,x2:k+lt.x,y2:H+lt.y,anchorPointX:ut,anchorPointY:dt}}Za.prototype.get=function(u){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[u]){var p=++this.maxGroupID;this.collisionGroups[u]={ID:p,predicate:function(l){return l.collisionGroupID===p}}}return this.collisionGroups[u]};var yo=function(u,p,l,g){this.transform=u.clone(),this.collisionIndex=new Mi(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=p,this.retainedQueryData={},this.collisionGroups=new Za(l),this.collisionCircleArrays={},this.prevPlacement=g,g&&(g.prevPlacement=void 0),this.placedOrientations={}};function $e(u,p,l,g,E){u.emplaceBack(p?1:0,l?1:0,g||0,E||0),u.emplaceBack(p?1:0,l?1:0,g||0,E||0),u.emplaceBack(p?1:0,l?1:0,g||0,E||0),u.emplaceBack(p?1:0,l?1:0,g||0,E||0)}yo.prototype.getBucketParts=function(u,p,l,g){var E=l.getBucket(p),P=l.latestFeatureIndex;if(E&&P&&p.id===E.layerIds[0]){var T=l.collisionBoxArray,k=E.layers[0].layout,q=Math.pow(2,this.transform.zoom-l.tileID.overscaledZ),H=l.tileSize/y.EXTENT,ut=this.transform.calculatePosMatrix(l.tileID.toUnwrapped()),dt="map"===k.get("text-pitch-alignment"),lt="map"===k.get("text-rotation-alignment"),zt=Di(l,1,this.transform.zoom),Rt=xi(ut,dt,lt,this.transform,zt),jt=null;if(dt){var Dt=zn(ut,dt,lt,this.transform,zt);jt=y.multiply([],this.transform.labelPlaneMatrix,Dt)}this.retainedQueryData[E.bucketInstanceId]=new jo(E.bucketInstanceId,P,E.sourceLayerIndex,E.index,l.tileID);var qt={bucket:E,layout:k,posMatrix:ut,textLabelPlaneMatrix:Rt,labelToScreenMatrix:jt,scale:q,textPixelRatio:H,holdingForFade:l.holdingForFade(),collisionBoxArray:T,partiallyEvaluatedTextSize:y.evaluateSizeForZoom(E.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(E.sourceID)};if(g)for(var ee=0,oe=E.sortKeyRanges;ee<oe.length;ee+=1){var Se=oe[ee];u.push({sortKey:Se.sortKey,symbolInstanceStart:Se.symbolInstanceStart,symbolInstanceEnd:Se.symbolInstanceEnd,parameters:qt})}else u.push({symbolInstanceStart:0,symbolInstanceEnd:E.symbolInstances.length,parameters:qt})}},yo.prototype.attemptAnchorPlacement=function(u,p,l,g,E,P,T,k,q,H,ut,dt,lt,zt,Rt){var jt,Dt=[dt.textOffset0,dt.textOffset1],qt=ra(u,l,g,Dt,E),ee=this.collisionIndex.placeCollisionBox(Mo(p,qt.x,qt.y,P,T,this.transform.angle),ut,k,q,H.predicate);if(!Rt||0!==this.collisionIndex.placeCollisionBox(Mo(Rt,qt.x,qt.y,P,T,this.transform.angle),ut,k,q,H.predicate).box.length)return ee.box.length>0?(this.prevPlacement&&this.prevPlacement.variableOffsets[dt.crossTileID]&&this.prevPlacement.placements[dt.crossTileID]&&this.prevPlacement.placements[dt.crossTileID].text&&(jt=this.prevPlacement.variableOffsets[dt.crossTileID].anchor),this.variableOffsets[dt.crossTileID]={textOffset:Dt,width:l,height:g,anchor:u,textBoxScale:E,prevAnchor:jt},this.markUsedJustification(lt,u,dt,zt),lt.allowVerticalPlacement&&(this.markUsedOrientation(lt,zt,dt),this.placedOrientations[dt.crossTileID]=zt),{shift:qt,placedGlyphBoxes:ee}):void 0},yo.prototype.placeLayerBucketPart=function(u,p,l){var g=this,E=u.parameters,P=E.bucket,T=E.layout,k=E.posMatrix,q=E.textLabelPlaneMatrix,H=E.labelToScreenMatrix,ut=E.textPixelRatio,dt=E.holdingForFade,lt=E.collisionBoxArray,zt=E.partiallyEvaluatedTextSize,Rt=E.collisionGroup,jt=T.get("text-optional"),Dt=T.get("icon-optional"),qt=T.get("text-allow-overlap"),ee=T.get("icon-allow-overlap"),oe="map"===T.get("text-rotation-alignment"),Se="map"===T.get("text-pitch-alignment"),ge="none"!==T.get("icon-text-fit"),Ce="viewport-y"===T.get("symbol-z-order"),be=qt&&(ee||!P.hasIconData()||Dt),Ue=ee&&(qt||!P.hasTextData()||jt);!P.collisionArrays&&lt&&P.deserializeCollisionBoxes(lt);var Ne=function(Ye,_r){if(!p[Ye.crossTileID])if(dt)g.placements[Ye.crossTileID]=new Ps(!1,!1,!1);else{var Ir,xr=!1,yr=!1,dr=!0,cr=null,ar={box:null,offscreen:null},Vr={box:null,offscreen:null},Kr=null,pn=null,on=0,an=0,$r=0;_r.textFeatureIndex?on=_r.textFeatureIndex:Ye.useRuntimeCollisionCircles&&(on=Ye.featureIndex),_r.verticalTextFeatureIndex&&(an=_r.verticalTextFeatureIndex);var hn=_r.textBox;if(hn){var Cn=function(Co){var po=y.WritingMode.horizontal;if(P.allowVerticalPlacement&&!Co&&g.prevPlacement){var Ua=g.prevPlacement.placedOrientations[Ye.crossTileID];Ua&&(g.placedOrientations[Ye.crossTileID]=Ua,g.markUsedOrientation(P,po=Ua,Ye))}return po},_a=function(Co,po){if(P.allowVerticalPlacement&&Ye.numVerticalGlyphVertices>0&&_r.verticalTextBox)for(var Ua=0,El=P.writingModes;Ua<El.length&&(El[Ua]===y.WritingMode.vertical?(ar=po(),Vr=ar):ar=Co(),!(ar&&ar.box&&ar.box.length));Ua+=1);else ar=Co()};if(T.get("text-variable-anchor")){var xa=T.get("text-variable-anchor");if(g.prevPlacement&&g.prevPlacement.variableOffsets[Ye.crossTileID]){var Ds=g.prevPlacement.variableOffsets[Ye.crossTileID];xa.indexOf(Ds.anchor)>0&&(xa=xa.filter(function(Co){return Co!==Ds.anchor})).unshift(Ds.anchor)}var ts=function(Co,po,Ua){for(var El=Co.x2-Co.x1,jl=Co.y2-Co.y1,Ph=Ye.textBoxScale,Xl=ge&&!ee?po:null,Yl={box:[],offscreen:!1},$c=qt?2*xa.length:xa.length,Sl=0;Sl<$c;++Sl){var Cl=g.attemptAnchorPlacement(xa[Sl%xa.length],Co,El,jl,Ph,oe,Se,ut,k,Rt,Sl>=xa.length,Ye,P,Ua,Xl);if(Cl&&(Yl=Cl.placedGlyphBoxes)&&Yl.box&&Yl.box.length){xr=!0,cr=Cl.shift;break}}return Yl};_a(function(){return ts(hn,_r.iconBox,y.WritingMode.horizontal)},function(){var Co=_r.verticalTextBox;return P.allowVerticalPlacement&&!(ar&&ar.box&&ar.box.length)&&Ye.numVerticalGlyphVertices>0&&Co?ts(Co,_r.verticalIconBox,y.WritingMode.vertical):{box:null,offscreen:null}}),ar&&(xr=ar.box,dr=ar.offscreen);var bl=Cn(ar&&ar.box);if(!xr&&g.prevPlacement){var nu=g.prevPlacement.variableOffsets[Ye.crossTileID];nu&&(g.variableOffsets[Ye.crossTileID]=nu,g.markUsedJustification(P,nu.anchor,Ye,bl))}}else{var Pu=function(Co,po){var Ua=g.collisionIndex.placeCollisionBox(Co,qt,ut,k,Rt.predicate);return Ua&&Ua.box&&Ua.box.length&&(g.markUsedOrientation(P,po,Ye),g.placedOrientations[Ye.crossTileID]=po),Ua};_a(function(){return Pu(hn,y.WritingMode.horizontal)},function(){var Co=_r.verticalTextBox;return P.allowVerticalPlacement&&Ye.numVerticalGlyphVertices>0&&Co?Pu(Co,y.WritingMode.vertical):{box:null,offscreen:null}}),Cn(ar&&ar.box&&ar.box.length)}}if(xr=(Ir=ar)&&Ir.box&&Ir.box.length>0,dr=Ir&&Ir.offscreen,Ye.useRuntimeCollisionCircles){var yu=P.text.placedSymbolArray.get(Ye.centerJustifiedTextSymbolIndex),wl=y.evaluateSizeForFeature(P.textSizeData,zt,yu),Ku=T.get("text-padding");Kr=g.collisionIndex.placeCollisionCircles(qt,yu,P.lineVertexArray,P.glyphOffsetArray,wl,k,q,H,l,Se,Rt.predicate,Ye.collisionCircleDiameter,Ku),xr=qt||Kr.circles.length>0&&!Kr.collisionDetected,dr=dr&&Kr.offscreen}if(_r.iconFeatureIndex&&($r=_r.iconFeatureIndex),_r.iconBox){var iu=function(Co){var po=ge&&cr?Mo(Co,cr.x,cr.y,oe,Se,g.transform.angle):Co;return g.collisionIndex.placeCollisionBox(po,ee,ut,k,Rt.predicate)};yr=Vr&&Vr.box&&Vr.box.length&&_r.verticalIconBox?(pn=iu(_r.verticalIconBox)).box.length>0:(pn=iu(_r.iconBox)).box.length>0,dr=dr&&pn.offscreen}var $u=jt||0===Ye.numHorizontalGlyphVertices&&0===Ye.numVerticalGlyphVertices,Go=Dt||0===Ye.numIconVertices;if($u||Go?Go?$u||(yr=yr&&xr):xr=yr&&xr:yr=xr=yr&&xr,xr&&Ir&&Ir.box&&g.collisionIndex.insertCollisionBox(Ir.box,T.get("text-ignore-placement"),P.bucketInstanceId,Vr&&Vr.box&&an?an:on,Rt.ID),yr&&pn&&g.collisionIndex.insertCollisionBox(pn.box,T.get("icon-ignore-placement"),P.bucketInstanceId,$r,Rt.ID),Kr&&(xr&&g.collisionIndex.insertCollisionCircles(Kr.circles,T.get("text-ignore-placement"),P.bucketInstanceId,on,Rt.ID),l)){var vu=P.bucketInstanceId,qs=g.collisionCircleArrays[vu];void 0===qs&&(qs=g.collisionCircleArrays[vu]=new Kc);for(var Gu=0;Gu<Kr.circles.length;Gu+=4)qs.circles.push(Kr.circles[Gu+0]),qs.circles.push(Kr.circles[Gu+1]),qs.circles.push(Kr.circles[Gu+2]),qs.circles.push(Kr.collisionDetected?1:0)}g.placements[Ye.crossTileID]=new Ps(xr||be,yr||Ue,dr||P.justReloaded),p[Ye.crossTileID]=!0}};if(Ce)for(var Ve=P.getSortedSymbolIndexes(this.transform.angle),er=Ve.length-1;er>=0;--er){var ir=Ve[er];Ne(P.symbolInstances.get(ir),P.collisionArrays[ir])}else for(var rr=u.symbolInstanceStart;rr<u.symbolInstanceEnd;rr++)Ne(P.symbolInstances.get(rr),P.collisionArrays[rr]);if(l&&P.bucketInstanceId in this.collisionCircleArrays){var Rr=this.collisionCircleArrays[P.bucketInstanceId];y.invert(Rr.invProjMatrix,k),Rr.viewportMatrix=this.collisionIndex.getViewportMatrix()}P.justReloaded=!1},yo.prototype.markUsedJustification=function(u,p,l,g){var E;E=g===y.WritingMode.vertical?l.verticalPlacedTextSymbolIndex:{left:l.leftJustifiedTextSymbolIndex,center:l.centerJustifiedTextSymbolIndex,right:l.rightJustifiedTextSymbolIndex}[y.getAnchorJustification(p)];for(var P=0,T=[l.leftJustifiedTextSymbolIndex,l.centerJustifiedTextSymbolIndex,l.rightJustifiedTextSymbolIndex,l.verticalPlacedTextSymbolIndex];P<T.length;P+=1){var k=T[P];k>=0&&(u.text.placedSymbolArray.get(k).crossTileID=E>=0&&k!==E?0:l.crossTileID)}},yo.prototype.markUsedOrientation=function(u,p,l){for(var g=p===y.WritingMode.horizontal||p===y.WritingMode.horizontalOnly?p:0,E=p===y.WritingMode.vertical?p:0,P=0,T=[l.leftJustifiedTextSymbolIndex,l.centerJustifiedTextSymbolIndex,l.rightJustifiedTextSymbolIndex];P<T.length;P+=1)u.text.placedSymbolArray.get(T[P]).placedOrientation=g;l.verticalPlacedTextSymbolIndex&&(u.text.placedSymbolArray.get(l.verticalPlacedTextSymbolIndex).placedOrientation=E)},yo.prototype.commit=function(u){this.commitTime=u,this.zoomAtLastRecencyCheck=this.transform.zoom;var p=this.prevPlacement,l=!1;this.prevZoomAdjustment=p?p.zoomAdjustment(this.transform.zoom):0;var g=p?p.symbolFadeChange(u):1,E=p?p.opacities:{},P=p?p.variableOffsets:{},T=p?p.placedOrientations:{};for(var k in this.placements){var q=this.placements[k],H=E[k];H?(this.opacities[k]=new nn(H,g,q.text,q.icon),l=l||q.text!==H.text.placed||q.icon!==H.icon.placed):(this.opacities[k]=new nn(null,g,q.text,q.icon,q.skipFade),l=l||q.text||q.icon)}for(var ut in E){var dt=E[ut];if(!this.opacities[ut]){var lt=new nn(dt,g,!1,!1);lt.isHidden()||(this.opacities[ut]=lt,l=l||dt.text.placed||dt.icon.placed)}}for(var zt in P)this.variableOffsets[zt]||!this.opacities[zt]||this.opacities[zt].isHidden()||(this.variableOffsets[zt]=P[zt]);for(var Rt in T)this.placedOrientations[Rt]||!this.opacities[Rt]||this.opacities[Rt].isHidden()||(this.placedOrientations[Rt]=T[Rt]);l?this.lastPlacementChangeTime=u:"number"!=typeof this.lastPlacementChangeTime&&(this.lastPlacementChangeTime=p?p.lastPlacementChangeTime:u)},yo.prototype.updateLayerOpacities=function(u,p){for(var l={},g=0,E=p;g<E.length;g+=1){var P=E[g],T=P.getBucket(u);T&&P.latestFeatureIndex&&u.id===T.layerIds[0]&&this.updateBucketOpacities(T,l,P.collisionBoxArray)}},yo.prototype.updateBucketOpacities=function(u,p,l){var g=this;u.hasTextData()&&u.text.opacityVertexArray.clear(),u.hasIconData()&&u.icon.opacityVertexArray.clear(),u.hasIconCollisionBoxData()&&u.iconCollisionBox.collisionVertexArray.clear(),u.hasTextCollisionBoxData()&&u.textCollisionBox.collisionVertexArray.clear();var E=u.layers[0].layout,P=new nn(null,0,!1,!1,!0),T=E.get("text-allow-overlap"),k=E.get("icon-allow-overlap"),q=E.get("text-variable-anchor"),H="map"===E.get("text-rotation-alignment"),ut="map"===E.get("text-pitch-alignment"),dt="none"!==E.get("icon-text-fit"),lt=new nn(null,0,T&&(k||!u.hasIconData()||E.get("icon-optional")),k&&(T||!u.hasTextData()||E.get("text-optional")),!0);!u.collisionArrays&&l&&(u.hasIconCollisionBoxData()||u.hasTextCollisionBoxData())&&u.deserializeCollisionBoxes(l);for(var zt=function(qt,ee,oe){for(var Se=0;Se<ee/4;Se++)qt.opacityVertexArray.emplaceBack(oe)},Rt=function(qt){var ee=u.symbolInstances.get(qt),oe=ee.numHorizontalGlyphVertices,Se=ee.numVerticalGlyphVertices,ge=ee.crossTileID,Ce=g.opacities[ge];p[ge]?Ce=P:Ce||(g.opacities[ge]=Ce=lt),p[ge]=!0;var be=ee.numIconVertices>0,Ue=g.placedOrientations[ee.crossTileID],Ne=Ue===y.WritingMode.vertical,Ve=Ue===y.WritingMode.horizontal||Ue===y.WritingMode.horizontalOnly;if(oe>0||Se>0){var er=Yi(Ce.text);zt(u.text,oe,Ne?yl:er),zt(u.text,Se,Ve?yl:er);var ir=Ce.text.isHidden();[ee.rightJustifiedTextSymbolIndex,ee.centerJustifiedTextSymbolIndex,ee.leftJustifiedTextSymbolIndex].forEach(function(ar){ar>=0&&(u.text.placedSymbolArray.get(ar).hidden=ir||Ne?1:0)}),ee.verticalPlacedTextSymbolIndex>=0&&(u.text.placedSymbolArray.get(ee.verticalPlacedTextSymbolIndex).hidden=ir||Ve?1:0);var rr=g.variableOffsets[ee.crossTileID];rr&&g.markUsedJustification(u,rr.anchor,ee,Ue);var Rr=g.placedOrientations[ee.crossTileID];Rr&&(g.markUsedJustification(u,"left",ee,Rr),g.markUsedOrientation(u,Rr,ee))}if(be){var Ye=Yi(Ce.icon),_r=!(dt&&ee.verticalPlacedIconSymbolIndex&&Ne);ee.placedIconSymbolIndex>=0&&(zt(u.icon,ee.numIconVertices,_r?Ye:yl),u.icon.placedSymbolArray.get(ee.placedIconSymbolIndex).hidden=Ce.icon.isHidden()),ee.verticalPlacedIconSymbolIndex>=0&&(zt(u.icon,ee.numVerticalIconVertices,_r?yl:Ye),u.icon.placedSymbolArray.get(ee.verticalPlacedIconSymbolIndex).hidden=Ce.icon.isHidden())}if(u.hasIconCollisionBoxData()||u.hasTextCollisionBoxData()){var Ir=u.collisionArrays[qt];if(Ir){var xr=new y.Point(0,0);if(Ir.textBox||Ir.verticalTextBox){var yr=!0;if(q){var dr=g.variableOffsets[ge];dr?(xr=ra(dr.anchor,dr.width,dr.height,dr.textOffset,dr.textBoxScale),H&&xr._rotate(ut?g.transform.angle:-g.transform.angle)):yr=!1}Ir.textBox&&$e(u.textCollisionBox.collisionVertexArray,Ce.text.placed,!yr||Ne,xr.x,xr.y),Ir.verticalTextBox&&$e(u.textCollisionBox.collisionVertexArray,Ce.text.placed,!yr||Ve,xr.x,xr.y)}var cr=Boolean(!Ve&&Ir.verticalIconBox);Ir.iconBox&&$e(u.iconCollisionBox.collisionVertexArray,Ce.icon.placed,cr,dt?xr.x:0,dt?xr.y:0),Ir.verticalIconBox&&$e(u.iconCollisionBox.collisionVertexArray,Ce.icon.placed,!cr,dt?xr.x:0,dt?xr.y:0)}}},jt=0;jt<u.symbolInstances.length;jt++)Rt(jt);if(u.sortFeatures(this.transform.angle),this.retainedQueryData[u.bucketInstanceId]&&(this.retainedQueryData[u.bucketInstanceId].featureSortOrder=u.featureSortOrder),u.hasTextData()&&u.text.opacityVertexBuffer&&u.text.opacityVertexBuffer.updateData(u.text.opacityVertexArray),u.hasIconData()&&u.icon.opacityVertexBuffer&&u.icon.opacityVertexBuffer.updateData(u.icon.opacityVertexArray),u.hasIconCollisionBoxData()&&u.iconCollisionBox.collisionVertexBuffer&&u.iconCollisionBox.collisionVertexBuffer.updateData(u.iconCollisionBox.collisionVertexArray),u.hasTextCollisionBoxData()&&u.textCollisionBox.collisionVertexBuffer&&u.textCollisionBox.collisionVertexBuffer.updateData(u.textCollisionBox.collisionVertexArray),u.bucketInstanceId in this.collisionCircleArrays){var Dt=this.collisionCircleArrays[u.bucketInstanceId];u.placementInvProjMatrix=Dt.invProjMatrix,u.placementViewportMatrix=Dt.viewportMatrix,u.collisionCircleArray=Dt.circles,delete this.collisionCircleArrays[u.bucketInstanceId]}},yo.prototype.symbolFadeChange=function(u){return 0===this.fadeDuration?1:(u-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment},yo.prototype.zoomAdjustment=function(u){return Math.max(0,(this.transform.zoom-u)/1.5)},yo.prototype.hasTransitions=function(u){return this.stale||u-this.lastPlacementChangeTime<this.fadeDuration},yo.prototype.stillRecent=function(u,p){var l=this.zoomAtLastRecencyCheck===p?1-this.zoomAdjustment(p):1;return this.zoomAtLastRecencyCheck=p,this.commitTime+this.fadeDuration*l>u},yo.prototype.setStale=function(){this.stale=!0};var Zs=Math.pow(2,25),Sa=Math.pow(2,24),Fs=Math.pow(2,17),Ru=Math.pow(2,16),na=Math.pow(2,9),ci=Math.pow(2,8),Yn=Math.pow(2,1);function Yi(u){if(0===u.opacity&&!u.placed)return 0;if(1===u.opacity&&u.placed)return 4294967295;var p=u.placed?1:0,l=Math.floor(127*u.opacity);return l*Zs+p*Sa+l*Fs+p*Ru+l*na+p*ci+l*Yn+p}var yl=0,vl=function(u){this._sortAcrossTiles="viewport-y"!==u.layout.get("symbol-z-order")&&!u.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]};vl.prototype.continuePlacement=function(u,p,l,g,E){for(var P=this._bucketParts;this._currentTileIndex<u.length;)if(p.getBucketParts(P,g,u[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,E())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,P.sort(function(T,k){return T.sortKey-k.sortKey}));this._currentPartIndex<P.length;)if(p.placeLayerBucketPart(P[this._currentPartIndex],this._seenCrossTileIDs,l),this._currentPartIndex++,E())return!0;return!1};var Xo=function(u,p,l,g,E,P,T){this.placement=new yo(u,E,P,T),this._currentPlacementIndex=p.length-1,this._forceFullPlacement=l,this._showCollisionBoxes=g,this._done=!1};Xo.prototype.isDone=function(){return this._done},Xo.prototype.continuePlacement=function(u,p,l){for(var g=this,E=y.browser.now(),P=function(){var q=y.browser.now()-E;return!g._forceFullPlacement&&q>2};this._currentPlacementIndex>=0;){var T=p[u[this._currentPlacementIndex]],k=this.placement.collisionIndex.transform.zoom;if("symbol"===T.type&&(!T.minzoom||T.minzoom<=k)&&(!T.maxzoom||T.maxzoom>k)){if(this._inProgressLayer||(this._inProgressLayer=new vl(T)),this._inProgressLayer.continuePlacement(l[T.source],this.placement,this._showCollisionBoxes,T,P))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0},Xo.prototype.commit=function(u){return this.placement.commit(u),this.placement};var Nu=512/y.EXTENT/2,Ca=function(u,p,l){this.tileID=u,this.indexedSymbolInstances={},this.bucketInstanceId=l;for(var g=0;g<p.length;g++){var E=p.get(g),P=E.key;this.indexedSymbolInstances[P]||(this.indexedSymbolInstances[P]=[]),this.indexedSymbolInstances[P].push({crossTileID:E.crossTileID,coord:this.getScaledCoordinates(E,u)})}};Ca.prototype.getScaledCoordinates=function(u,p){var l=Nu/Math.pow(2,p.canonical.z-this.tileID.canonical.z);return{x:Math.floor((p.canonical.x*y.EXTENT+u.anchorX)*l),y:Math.floor((p.canonical.y*y.EXTENT+u.anchorY)*l)}},Ca.prototype.findMatches=function(u,p,l){for(var g=this.tileID.canonical.z<p.canonical.z?1:Math.pow(2,this.tileID.canonical.z-p.canonical.z),E=0;E<u.length;E++){var P=u.get(E);if(!P.crossTileID){var T=this.indexedSymbolInstances[P.key];if(T)for(var k=this.getScaledCoordinates(P,p),q=0,H=T;q<H.length;q+=1){var ut=H[q];if(Math.abs(ut.coord.x-k.x)<=g&&Math.abs(ut.coord.y-k.y)<=g&&!l[ut.crossTileID]){l[ut.crossTileID]=!0,P.crossTileID=ut.crossTileID;break}}}}};var ni=function(){this.maxCrossTileID=0};ni.prototype.generate=function(){return++this.maxCrossTileID};var Yo=function(){this.indexes={},this.usedCrossTileIDs={},this.lng=0};Yo.prototype.handleWrapJump=function(u){var p=Math.round((u-this.lng)/360);if(0!==p)for(var l in this.indexes){var g=this.indexes[l],E={};for(var P in g){var T=g[P];T.tileID=T.tileID.unwrapTo(T.tileID.wrap+p),E[T.tileID.key]=T}this.indexes[l]=E}this.lng=u},Yo.prototype.addBucket=function(u,p,l){if(this.indexes[u.overscaledZ]&&this.indexes[u.overscaledZ][u.key]){if(this.indexes[u.overscaledZ][u.key].bucketInstanceId===p.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(u.overscaledZ,this.indexes[u.overscaledZ][u.key])}for(var g=0;g<p.symbolInstances.length;g++)p.symbolInstances.get(g).crossTileID=0;this.usedCrossTileIDs[u.overscaledZ]||(this.usedCrossTileIDs[u.overscaledZ]={});var E=this.usedCrossTileIDs[u.overscaledZ];for(var P in this.indexes){var T=this.indexes[P];if(Number(P)>u.overscaledZ)for(var k in T){var q=T[k];q.tileID.isChildOf(u)&&q.findMatches(p.symbolInstances,u,E)}else{var H=T[u.scaledTo(Number(P)).key];H&&H.findMatches(p.symbolInstances,u,E)}}for(var ut=0;ut<p.symbolInstances.length;ut++){var dt=p.symbolInstances.get(ut);dt.crossTileID||(dt.crossTileID=l.generate(),E[dt.crossTileID]=!0)}return void 0===this.indexes[u.overscaledZ]&&(this.indexes[u.overscaledZ]={}),this.indexes[u.overscaledZ][u.key]=new Ca(u,p.symbolInstances,p.bucketInstanceId),!0},Yo.prototype.removeBucketCrossTileIDs=function(u,p){for(var l in p.indexedSymbolInstances)for(var g=0,E=p.indexedSymbolInstances[l];g<E.length;g+=1)delete this.usedCrossTileIDs[u][E[g].crossTileID]},Yo.prototype.removeStaleBuckets=function(u){var p=!1;for(var l in this.indexes){var g=this.indexes[l];for(var E in g)u[g[E].bucketInstanceId]||(this.removeBucketCrossTileIDs(l,g[E]),delete g[E],p=!0)}return p};var Wi=function(){this.layerIndexes={},this.crossTileIDs=new ni,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}};Wi.prototype.addLayer=function(u,p,l){var g=this.layerIndexes[u.id];void 0===g&&(g=this.layerIndexes[u.id]=new Yo);var E=!1,P={};g.handleWrapJump(l);for(var T=0,k=p;T<k.length;T+=1){var q=k[T],H=q.getBucket(u);H&&u.id===H.layerIds[0]&&(H.bucketInstanceId||(H.bucketInstanceId=++this.maxBucketInstanceId),g.addBucket(q.tileID,H,this.crossTileIDs)&&(E=!0),P[H.bucketInstanceId]=!0)}return g.removeStaleBuckets(P)&&(E=!0),E},Wi.prototype.pruneUnusedLayers=function(u){var p={};for(var l in u.forEach(function(g){p[g]=!0}),this.layerIndexes)p[l]||delete this.layerIndexes[l]};var Bs=function(u,p){return y.emitValidationErrors(u,p&&p.filter(function(l){return"source.canvas"!==l.identifier}))},js=y.pick(Be,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData"]),ii=y.pick(Be,["setCenter","setZoom","setBearing","setPitch"]),ao=function(){var u={},p=y.styleSpec.$version;for(var l in y.styleSpec.$root){var g,E=y.styleSpec.$root[l];E.required&&null!=(g="version"===l?p:"array"===E.type?[]:{})&&(u[l]=g)}return u}(),ja=function(u){function p(l,g){var E=this;void 0===g&&(g={}),u.call(this),this.map=l,this.dispatcher=new Mt(Pr(),this),this.imageManager=new kt,this.imageManager.setEventedParent(this),this.glyphManager=new et(l._requestManager,g.localIdeographFontFamily),this.lineAtlas=new bt(256,512),this.crossTileSymbolIndex=new Wi,this._layers={},this._serializedLayers={},this._order=[],this.sourceCaches={},this.zoomHistory=new y.ZoomHistory,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("setReferrer",y.getReferrer());var P=this;this._rtlTextPluginCallback=p.registerForPluginStateChange(function(T){P.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:T.pluginStatus,pluginURL:T.pluginURL},function(k,q){if(y.triggerPluginCompletionEvent(k),q&&q.every(function(ut){return ut}))for(var H in P.sourceCaches)P.sourceCaches[H].reload()})}),this.on("data",function(T){if("source"===T.dataType&&"metadata"===T.sourceDataType){var k=E.sourceCaches[T.sourceId];if(k){var q=k.getSource();if(q&&q.vectorLayerIds)for(var H in E._layers){var ut=E._layers[H];ut.source===q.id&&E._validateLayer(ut)}}}})}return u&&(p.__proto__=u),(p.prototype=Object.create(u&&u.prototype)).constructor=p,p.prototype.loadURL=function(l,g){var E=this;void 0===g&&(g={}),this.fire(new y.Event("dataloading",{dataType:"style"}));var P="boolean"==typeof g.validate?g.validate:!y.isMapboxURL(l);l=this.map._requestManager.normalizeStyleURL(l,g.accessToken);var T=this.map._requestManager.transformRequest(l,y.ResourceType.Style);this._request=y.getJSON(T,function(k,q){E._request=null,k?E.fire(new y.ErrorEvent(k)):q&&E._load(q,P)})},p.prototype.loadJSON=function(l,g){var E=this;void 0===g&&(g={}),this.fire(new y.Event("dataloading",{dataType:"style"})),this._request=y.browser.frame(function(){E._request=null,E._load(l,!1!==g.validate)})},p.prototype.loadEmpty=function(){this.fire(new y.Event("dataloading",{dataType:"style"})),this._load(ao,!1)},p.prototype._load=function(l,g){if(!g||!Bs(this,y.validateStyle(l))){for(var E in this._loaded=!0,this.stylesheet=l,l.sources)this.addSource(E,l.sources[E],{validate:!1});l.sprite?this._loadSprite(l.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(l.glyphs);var P=sr(this.stylesheet.layers);this._order=P.map(function(H){return H.id}),this._layers={},this._serializedLayers={};for(var T=0,k=P;T<k.length;T+=1){var q=k[T];(q=y.createStyleLayer(q)).setEventedParent(this,{layer:{id:q.id}}),this._layers[q.id]=q,this._serializedLayers[q.id]=q.serialize()}this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new $t(this.stylesheet.light),this.fire(new y.Event("data",{dataType:"style"})),this.fire(new y.Event("style.load"))}},p.prototype._loadSprite=function(l){var g=this;this._spriteRequest=function(E,P,T){var k,q,H,ut=y.browser.devicePixelRatio>1?"@2x":"",dt=y.getJSON(P.transformRequest(P.normalizeSpriteURL(E,ut,".json"),y.ResourceType.SpriteJSON),function(Rt,jt){dt=null,H||(H=Rt,k=jt,zt())}),lt=y.getImage(P.transformRequest(P.normalizeSpriteURL(E,ut,".png"),y.ResourceType.SpriteImage),function(Rt,jt){lt=null,H||(H=Rt,q=jt,zt())});function zt(){if(H)T(H);else if(k&&q){var Rt=y.browser.getImageData(q),jt={};for(var Dt in k){var qt=k[Dt],ee=qt.width,oe=qt.height,Se=qt.x,ge=qt.y,Ce=qt.sdf,be=qt.pixelRatio,Ue=qt.stretchX,Ne=qt.stretchY,Ve=qt.content,er=new y.RGBAImage({width:ee,height:oe});y.RGBAImage.copy(Rt,er,{x:Se,y:ge},{x:0,y:0},{width:ee,height:oe}),jt[Dt]={data:er,pixelRatio:be,sdf:Ce,stretchX:Ue,stretchY:Ne,content:Ve}}T(null,jt)}}return{cancel:function(){dt&&(dt.cancel(),dt=null),lt&&(lt.cancel(),lt=null)}}}(l,this.map._requestManager,function(E,P){if(g._spriteRequest=null,E)g.fire(new y.ErrorEvent(E));else if(P)for(var T in P)g.imageManager.addImage(T,P[T]);g.imageManager.setLoaded(!0),g._availableImages=g.imageManager.listImages(),g.dispatcher.broadcast("setImages",g._availableImages),g.fire(new y.Event("data",{dataType:"style"}))})},p.prototype._validateLayer=function(l){var g=this.sourceCaches[l.source];if(g){var E=l.sourceLayer;if(E){var P=g.getSource();("geojson"===P.type||P.vectorLayerIds&&-1===P.vectorLayerIds.indexOf(E))&&this.fire(new y.ErrorEvent(new Error('Source layer "'+E+'" does not exist on source "'+P.id+'" as specified by style layer "'+l.id+'"')))}}},p.prototype.loaded=function(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(var l in this.sourceCaches)if(!this.sourceCaches[l].loaded())return!1;return!!this.imageManager.isLoaded()},p.prototype._serializeLayers=function(l){for(var g=[],E=0,P=l;E<P.length;E+=1){var T=this._layers[P[E]];"custom"!==T.type&&g.push(T.serialize())}return g},p.prototype.hasTransitions=function(){if(this.light&&this.light.hasTransition())return!0;for(var l in this.sourceCaches)if(this.sourceCaches[l].hasTransition())return!0;for(var g in this._layers)if(this._layers[g].hasTransition())return!0;return!1},p.prototype._checkLoaded=function(){if(!this._loaded)throw new Error("Style is not done loading")},p.prototype.update=function(l){if(this._loaded){var g=this._changed;if(this._changed){var E=Object.keys(this._updatedLayers),P=Object.keys(this._removedLayers);for(var T in(E.length||P.length)&&this._updateWorkerLayers(E,P),this._updatedSources){var k=this._updatedSources[T];"reload"===k?this._reloadSource(T):"clear"===k&&this._clearSource(T)}for(var q in this._updateTilesForChangedImages(),this._updatedPaintProps)this._layers[q].updateTransitions(l);this.light.updateTransitions(l),this._resetUpdates()}var H={};for(var ut in this.sourceCaches){var dt=this.sourceCaches[ut];H[ut]=dt.used,dt.used=!1}for(var lt=0,zt=this._order;lt<zt.length;lt+=1){var Rt=this._layers[zt[lt]];Rt.recalculate(l,this._availableImages),!Rt.isHidden(l.zoom)&&Rt.source&&(this.sourceCaches[Rt.source].used=!0)}for(var jt in H){var Dt=this.sourceCaches[jt];H[jt]!==Dt.used&&Dt.fire(new y.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:jt}))}this.light.recalculate(l),this.z=l.zoom,g&&this.fire(new y.Event("data",{dataType:"style"}))}},p.prototype._updateTilesForChangedImages=function(){var l=Object.keys(this._changedImages);if(l.length){for(var g in this.sourceCaches)this.sourceCaches[g].reloadTilesForDependencies(["icons","patterns"],l);this._changedImages={}}},p.prototype._updateWorkerLayers=function(l,g){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(l),removedIds:g})},p.prototype._resetUpdates=function(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}},p.prototype.setState=function(l){var g=this;if(this._checkLoaded(),Bs(this,y.validateStyle(l)))return!1;(l=y.clone$1(l)).layers=sr(l.layers);var E=function(T,k){if(!T)return[{command:Be.setStyle,args:[k]}];var q=[];try{if(!y.deepEqual(T.version,k.version))return[{command:Be.setStyle,args:[k]}];y.deepEqual(T.center,k.center)||q.push({command:Be.setCenter,args:[k.center]}),y.deepEqual(T.zoom,k.zoom)||q.push({command:Be.setZoom,args:[k.zoom]}),y.deepEqual(T.bearing,k.bearing)||q.push({command:Be.setBearing,args:[k.bearing]}),y.deepEqual(T.pitch,k.pitch)||q.push({command:Be.setPitch,args:[k.pitch]}),y.deepEqual(T.sprite,k.sprite)||q.push({command:Be.setSprite,args:[k.sprite]}),y.deepEqual(T.glyphs,k.glyphs)||q.push({command:Be.setGlyphs,args:[k.glyphs]}),y.deepEqual(T.transition,k.transition)||q.push({command:Be.setTransition,args:[k.transition]}),y.deepEqual(T.light,k.light)||q.push({command:Be.setLight,args:[k.light]});var H={},ut=[];!function(lt,zt,Rt,jt){var Dt;for(Dt in zt=zt||{},lt=lt||{})lt.hasOwnProperty(Dt)&&(zt.hasOwnProperty(Dt)||qr(Dt,Rt,jt));for(Dt in zt)zt.hasOwnProperty(Dt)&&(lt.hasOwnProperty(Dt)?y.deepEqual(lt[Dt],zt[Dt])||("geojson"===lt[Dt].type&&"geojson"===zt[Dt].type&&wr(lt,zt,Dt)?Rt.push({command:Be.setGeoJSONSourceData,args:[Dt,zt[Dt].data]}):Tr(Dt,zt,Rt,jt)):sn(Dt,zt,Rt))}(T.sources,k.sources,ut,H);var dt=[];T.layers&&T.layers.forEach(function(lt){H[lt.source]?q.push({command:Be.removeLayer,args:[lt.id]}):dt.push(lt)}),q=q.concat(ut),function(lt,zt,Rt){zt=zt||[];var jt,Dt,qt,ee,oe,Se,ge,Ce=(lt=lt||[]).map(ui),be=zt.map(ui),Ue=lt.reduce(Tn,{}),Ne=zt.reduce(Tn,{}),Ve=Ce.slice(),er=Object.create(null);for(jt=0,Dt=0;jt<Ce.length;jt++)Ne.hasOwnProperty(qt=Ce[jt])?Dt++:(Rt.push({command:Be.removeLayer,args:[qt]}),Ve.splice(Ve.indexOf(qt,Dt),1));for(jt=0,Dt=0;jt<be.length;jt++)Ve[Ve.length-1-jt]!==(qt=be[be.length-1-jt])&&(Ue.hasOwnProperty(qt)?(Rt.push({command:Be.removeLayer,args:[qt]}),Ve.splice(Ve.lastIndexOf(qt,Ve.length-Dt),1)):Dt++,Rt.push({command:Be.addLayer,args:[Ne[qt],Se=Ve[Ve.length-jt]]}),Ve.splice(Ve.length-jt,0,qt),er[qt]=!0);for(jt=0;jt<be.length;jt++)if(ee=Ue[qt=be[jt]],oe=Ne[qt],!er[qt]&&!y.deepEqual(ee,oe))if(y.deepEqual(ee.source,oe.source)&&y.deepEqual(ee["source-layer"],oe["source-layer"])&&y.deepEqual(ee.type,oe.type)){for(ge in zr(ee.layout,oe.layout,Rt,qt,null,Be.setLayoutProperty),zr(ee.paint,oe.paint,Rt,qt,null,Be.setPaintProperty),y.deepEqual(ee.filter,oe.filter)||Rt.push({command:Be.setFilter,args:[qt,oe.filter]}),y.deepEqual(ee.minzoom,oe.minzoom)&&y.deepEqual(ee.maxzoom,oe.maxzoom)||Rt.push({command:Be.setLayerZoomRange,args:[qt,oe.minzoom,oe.maxzoom]}),ee)ee.hasOwnProperty(ge)&&"layout"!==ge&&"paint"!==ge&&"filter"!==ge&&"metadata"!==ge&&"minzoom"!==ge&&"maxzoom"!==ge&&(0===ge.indexOf("paint.")?zr(ee[ge],oe[ge],Rt,qt,ge.slice(6),Be.setPaintProperty):y.deepEqual(ee[ge],oe[ge])||Rt.push({command:Be.setLayerProperty,args:[qt,ge,oe[ge]]}));for(ge in oe)oe.hasOwnProperty(ge)&&!ee.hasOwnProperty(ge)&&"layout"!==ge&&"paint"!==ge&&"filter"!==ge&&"metadata"!==ge&&"minzoom"!==ge&&"maxzoom"!==ge&&(0===ge.indexOf("paint.")?zr(ee[ge],oe[ge],Rt,qt,ge.slice(6),Be.setPaintProperty):y.deepEqual(ee[ge],oe[ge])||Rt.push({command:Be.setLayerProperty,args:[qt,ge,oe[ge]]}))}else Rt.push({command:Be.removeLayer,args:[qt]}),Se=Ve[Ve.lastIndexOf(qt)+1],Rt.push({command:Be.addLayer,args:[oe,Se]})}(dt,k.layers,q)}catch(lt){console.warn("Unable to compute style diff:",lt),q=[{command:Be.setStyle,args:[k]}]}return q}(this.serialize(),l).filter(function(T){return!(T.command in ii)});if(0===E.length)return!1;var P=E.filter(function(T){return!(T.command in js)});if(P.length>0)throw new Error("Unimplemented: "+P.map(function(T){return T.command}).join(", ")+".");return E.forEach(function(T){"setTransition"!==T.command&&g[T.command].apply(g,T.args)}),this.stylesheet=l,!0},p.prototype.addImage=function(l,g){if(this.getImage(l))return this.fire(new y.ErrorEvent(new Error("An image with this name already exists.")));this.imageManager.addImage(l,g),this._afterImageUpdated(l)},p.prototype.updateImage=function(l,g){this.imageManager.updateImage(l,g)},p.prototype.getImage=function(l){return this.imageManager.getImage(l)},p.prototype.removeImage=function(l){if(!this.getImage(l))return this.fire(new y.ErrorEvent(new Error("No image with this name exists.")));this.imageManager.removeImage(l),this._afterImageUpdated(l)},p.prototype._afterImageUpdated=function(l){this._availableImages=this.imageManager.listImages(),this._changedImages[l]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new y.Event("data",{dataType:"style"}))},p.prototype.listImages=function(){return this._checkLoaded(),this.imageManager.listImages()},p.prototype.addSource=function(l,g,E){var P=this;if(void 0===E&&(E={}),this._checkLoaded(),void 0!==this.sourceCaches[l])throw new Error("There is already a source with this ID");if(!g.type)throw new Error("The type property must be defined, but only the following properties were given: "+Object.keys(g).join(", ")+".");if(!(["vector","raster","geojson","video","image"].indexOf(g.type)>=0&&this._validate(y.validateStyle.source,"sources."+l,g,null,E))){this.map&&this.map._collectResourceTiming&&(g.collectResourceTiming=!0);var T=this.sourceCaches[l]=new xt(l,g,this.dispatcher);T.style=this,T.setEventedParent(this,function(){return{isSourceLoaded:P.loaded(),source:T.serialize(),sourceId:l}}),T.onAdd(this.map),this._changed=!0}},p.prototype.removeSource=function(l){if(this._checkLoaded(),void 0===this.sourceCaches[l])throw new Error("There is no source with this ID");for(var g in this._layers)if(this._layers[g].source===l)return this.fire(new y.ErrorEvent(new Error('Source "'+l+'" cannot be removed while layer "'+g+'" is using it.')));var E=this.sourceCaches[l];delete this.sourceCaches[l],delete this._updatedSources[l],E.fire(new y.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:l})),E.setEventedParent(null),E.clearTiles(),E.onRemove&&E.onRemove(this.map),this._changed=!0},p.prototype.setGeoJSONSourceData=function(l,g){this._checkLoaded(),this.sourceCaches[l].getSource().setData(g),this._changed=!0},p.prototype.getSource=function(l){return this.sourceCaches[l]&&this.sourceCaches[l].getSource()},p.prototype.addLayer=function(l,g,E){void 0===E&&(E={}),this._checkLoaded();var P=l.id;if(this.getLayer(P))this.fire(new y.ErrorEvent(new Error('Layer with id "'+P+'" already exists on this map')));else{var T;if("custom"===l.type){if(Bs(this,y.validateCustomStyleLayer(l)))return;T=y.createStyleLayer(l)}else{if("object"==typeof l.source&&(this.addSource(P,l.source),l=y.clone$1(l),l=y.extend(l,{source:P})),this._validate(y.validateStyle.layer,"layers."+P,l,{arrayIndex:-1},E))return;T=y.createStyleLayer(l),this._validateLayer(T),T.setEventedParent(this,{layer:{id:P}}),this._serializedLayers[T.id]=T.serialize()}var k=g?this._order.indexOf(g):this._order.length;if(g&&-1===k)this.fire(new y.ErrorEvent(new Error('Layer with id "'+g+'" does not exist on this map.')));else{if(this._order.splice(k,0,P),this._layerOrderChanged=!0,this._layers[P]=T,this._removedLayers[P]&&T.source&&"custom"!==T.type){var q=this._removedLayers[P];delete this._removedLayers[P],q.type!==T.type?this._updatedSources[T.source]="clear":(this._updatedSources[T.source]="reload",this.sourceCaches[T.source].pause())}this._updateLayer(T),T.onAdd&&T.onAdd(this.map)}}},p.prototype.moveLayer=function(l,g){if(this._checkLoaded(),this._changed=!0,this._layers[l]){if(l!==g){var E=this._order.indexOf(l);this._order.splice(E,1);var P=g?this._order.indexOf(g):this._order.length;g&&-1===P?this.fire(new y.ErrorEvent(new Error('Layer with id "'+g+'" does not exist on this map.'))):(this._order.splice(P,0,l),this._layerOrderChanged=!0)}}else this.fire(new y.ErrorEvent(new Error("The layer '"+l+"' does not exist in the map's style and cannot be moved.")))},p.prototype.removeLayer=function(l){this._checkLoaded();var g=this._layers[l];if(g){g.setEventedParent(null);var E=this._order.indexOf(l);this._order.splice(E,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[l]=g,delete this._layers[l],delete this._serializedLayers[l],delete this._updatedLayers[l],delete this._updatedPaintProps[l],g.onRemove&&g.onRemove(this.map)}else this.fire(new y.ErrorEvent(new Error("The layer '"+l+"' does not exist in the map's style and cannot be removed.")))},p.prototype.getLayer=function(l){return this._layers[l]},p.prototype.hasLayer=function(l){return l in this._layers},p.prototype.setLayerZoomRange=function(l,g,E){this._checkLoaded();var P=this.getLayer(l);P?P.minzoom===g&&P.maxzoom===E||(null!=g&&(P.minzoom=g),null!=E&&(P.maxzoom=E),this._updateLayer(P)):this.fire(new y.ErrorEvent(new Error("The layer '"+l+"' does not exist in the map's style and cannot have zoom extent.")))},p.prototype.setFilter=function(l,g,E){void 0===E&&(E={}),this._checkLoaded();var P=this.getLayer(l);if(P){if(!y.deepEqual(P.filter,g))return null==g?(P.filter=void 0,void this._updateLayer(P)):void(this._validate(y.validateStyle.filter,"layers."+P.id+".filter",g,null,E)||(P.filter=y.clone$1(g),this._updateLayer(P)))}else this.fire(new y.ErrorEvent(new Error("The layer '"+l+"' does not exist in the map's style and cannot be filtered.")))},p.prototype.getFilter=function(l){return y.clone$1(this.getLayer(l).filter)},p.prototype.setLayoutProperty=function(l,g,E,P){void 0===P&&(P={}),this._checkLoaded();var T=this.getLayer(l);T?y.deepEqual(T.getLayoutProperty(g),E)||(T.setLayoutProperty(g,E,P),this._updateLayer(T)):this.fire(new y.ErrorEvent(new Error("The layer '"+l+"' does not exist in the map's style and cannot be styled.")))},p.prototype.getLayoutProperty=function(l,g){var E=this.getLayer(l);if(E)return E.getLayoutProperty(g);this.fire(new y.ErrorEvent(new Error("The layer '"+l+"' does not exist in the map's style.")))},p.prototype.setPaintProperty=function(l,g,E,P){void 0===P&&(P={}),this._checkLoaded();var T=this.getLayer(l);T?y.deepEqual(T.getPaintProperty(g),E)||(T.setPaintProperty(g,E,P)&&this._updateLayer(T),this._changed=!0,this._updatedPaintProps[l]=!0):this.fire(new y.ErrorEvent(new Error("The layer '"+l+"' does not exist in the map's style and cannot be styled.")))},p.prototype.getPaintProperty=function(l,g){return this.getLayer(l).getPaintProperty(g)},p.prototype.setFeatureState=function(l,g){this._checkLoaded();var E=l.source,P=l.sourceLayer,T=this.sourceCaches[E];if(void 0!==T){var k=T.getSource().type;"geojson"===k&&P?this.fire(new y.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):"vector"!==k||P?(void 0===l.id&&this.fire(new y.ErrorEvent(new Error("The feature id parameter must be provided."))),T.setFeatureState(P,l.id,g)):this.fire(new y.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new y.ErrorEvent(new Error("The source '"+E+"' does not exist in the map's style.")))},p.prototype.removeFeatureState=function(l,g){this._checkLoaded();var E=l.source,P=this.sourceCaches[E];if(void 0!==P){var T=P.getSource().type,k="vector"===T?l.sourceLayer:void 0;"vector"!==T||k?g&&"string"!=typeof l.id&&"number"!=typeof l.id?this.fire(new y.ErrorEvent(new Error("A feature id is required to remove its specific state property."))):P.removeFeatureState(k,l.id,g):this.fire(new y.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new y.ErrorEvent(new Error("The source '"+E+"' does not exist in the map's style.")))},p.prototype.getFeatureState=function(l){this._checkLoaded();var g=l.source,E=l.sourceLayer,P=this.sourceCaches[g];if(void 0!==P){if("vector"!==P.getSource().type||E)return void 0===l.id&&this.fire(new y.ErrorEvent(new Error("The feature id parameter must be provided."))),P.getFeatureState(E,l.id);this.fire(new y.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new y.ErrorEvent(new Error("The source '"+g+"' does not exist in the map's style.")))},p.prototype.getTransition=function(){return y.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)},p.prototype.serialize=function(){return y.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,sources:y.mapObject(this.sourceCaches,function(l){return l.serialize()}),layers:this._serializeLayers(this._order)},function(l){return void 0!==l})},p.prototype._updateLayer=function(l){this._updatedLayers[l.id]=!0,l.source&&!this._updatedSources[l.source]&&"raster"!==this.sourceCaches[l.source].getSource().type&&(this._updatedSources[l.source]="reload",this.sourceCaches[l.source].pause()),this._changed=!0},p.prototype._flattenAndSortRenderedFeatures=function(l){for(var g=this,E=function(Ue){return"fill-extrusion"===g._layers[Ue].type},P={},T=[],k=this._order.length-1;k>=0;k--){var q=this._order[k];if(E(q)){P[q]=k;for(var H=0,ut=l;H<ut.length;H+=1){var dt=ut[H][q];if(dt)for(var lt=0,zt=dt;lt<zt.length;lt+=1)T.push(zt[lt])}}}T.sort(function(Ue,Ne){return Ne.intersectionZ-Ue.intersectionZ});for(var Rt=[],jt=this._order.length-1;jt>=0;jt--){var Dt=this._order[jt];if(E(Dt))for(var qt=T.length-1;qt>=0;qt--){var ee=T[qt].feature;if(P[ee.layer.id]<jt)break;Rt.push(ee),T.pop()}else for(var oe=0,Se=l;oe<Se.length;oe+=1){var ge=Se[oe][Dt];if(ge)for(var Ce=0,be=ge;Ce<be.length;Ce+=1)Rt.push(be[Ce].feature)}}return Rt},p.prototype.queryRenderedFeatures=function(l,g,E){g&&g.filter&&this._validate(y.validateStyle.filter,"queryRenderedFeatures.filter",g.filter,null,g);var P={};if(g&&g.layers){if(!Array.isArray(g.layers))return this.fire(new y.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(var T=0,k=g.layers;T<k.length;T+=1){var q=k[T],H=this._layers[q];if(!H)return this.fire(new y.ErrorEvent(new Error("The layer '"+q+"' does not exist in the map's style and cannot be queried for features."))),[];P[H.source]=!0}}var ut=[];for(var dt in g.availableImages=this._availableImages,this.sourceCaches)g.layers&&!P[dt]||ut.push(Oe(this.sourceCaches[dt],this._layers,this._serializedLayers,l,g,E));return this.placement&&ut.push(function(lt,zt,Rt,jt,Dt,qt,ee){for(var oe={},Se=qt.queryRenderedSymbols(jt),ge=[],Ce=0,be=Object.keys(Se).map(Number);Ce<be.length;Ce+=1)ge.push(ee[be[Ce]]);ge.sort(Zr);for(var Ue=function(){var rr=Ve[Ne],Rr=rr.featureIndex.lookupSymbolFeatures(Se[rr.bucketInstanceId],zt,rr.bucketIndex,rr.sourceLayerIndex,Dt.filter,Dt.layers,Dt.availableImages,lt);for(var Ye in Rr){var _r=oe[Ye]=oe[Ye]||[],Ir=Rr[Ye];Ir.sort(function(dr,cr){var ar=rr.featureSortOrder;if(ar){var Vr=ar.indexOf(dr.featureIndex);return ar.indexOf(cr.featureIndex)-Vr}return cr.featureIndex-dr.featureIndex});for(var xr=0,yr=Ir;xr<yr.length;xr+=1)_r.push(yr[xr])}},Ne=0,Ve=ge;Ne<Ve.length;Ne+=1)Ue();var er=function(rr){oe[rr].forEach(function(Rr){var Ye=Rr.feature,_r=Rt[lt[rr].source].getFeatureState(Ye.layer["source-layer"],Ye.id);Ye.source=Ye.layer.source,Ye.layer["source-layer"]&&(Ye.sourceLayer=Ye.layer["source-layer"]),Ye.state=_r})};for(var ir in oe)er(ir);return oe}(this._layers,this._serializedLayers,this.sourceCaches,l,g,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(ut)},p.prototype.querySourceFeatures=function(l,g){g&&g.filter&&this._validate(y.validateStyle.filter,"querySourceFeatures.filter",g.filter,null,g);var E=this.sourceCaches[l];return E?function(P,T){for(var k=P.getRenderableIds().map(function(zt){return P.getTileByID(zt)}),q=[],H={},ut=0;ut<k.length;ut++){var dt=k[ut],lt=dt.tileID.canonical.key;H[lt]||(H[lt]=!0,dt.querySourceFeatures(q,T))}return q}(E,g):[]},p.prototype.addSourceType=function(l,g,E){return p.getSourceType(l)?E(new Error('A source type called "'+l+'" already exists.')):(p.setSourceType(l,g),g.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:l,url:g.workerSourceURL},E):E(null,null))},p.prototype.getLight=function(){return this.light.getLight()},p.prototype.setLight=function(l,g){void 0===g&&(g={}),this._checkLoaded();var E=this.light.getLight(),P=!1;for(var T in l)if(!y.deepEqual(l[T],E[T])){P=!0;break}if(P){var k={now:y.browser.now(),transition:y.extend({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(l,g),this.light.updateTransitions(k)}},p.prototype._validate=function(l,g,E,P,T){return void 0===T&&(T={}),(!T||!1!==T.validate)&&Bs(this,l.call(y.validateStyle,y.extend({key:g,style:this.serialize(),value:E,styleSpec:y.styleSpec},P)))},p.prototype._remove=function(){for(var l in this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),y.evented.off("pluginStateChange",this._rtlTextPluginCallback),this._layers)this._layers[l].setEventedParent(null);for(var g in this.sourceCaches)this.sourceCaches[g].clearTiles(),this.sourceCaches[g].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()},p.prototype._clearSource=function(l){this.sourceCaches[l].clearTiles()},p.prototype._reloadSource=function(l){this.sourceCaches[l].resume(),this.sourceCaches[l].reload()},p.prototype._updateSources=function(l){for(var g in this.sourceCaches)this.sourceCaches[g].update(l)},p.prototype._generateCollisionBoxes=function(){for(var l in this.sourceCaches)this._reloadSource(l)},p.prototype._updatePlacement=function(l,g,E,P,T){void 0===T&&(T=!1);for(var k=!1,q=!1,H={},ut=0,dt=this._order;ut<dt.length;ut+=1){var lt=this._layers[dt[ut]];if("symbol"===lt.type){if(!H[lt.source]){var zt=this.sourceCaches[lt.source];H[lt.source]=zt.getRenderableIds(!0).map(function(ee){return zt.getTileByID(ee)}).sort(function(ee,oe){return oe.tileID.overscaledZ-ee.tileID.overscaledZ||(ee.tileID.isLessThan(oe.tileID)?-1:1)})}var Rt=this.crossTileSymbolIndex.addLayer(lt,H[lt.source],l.center.lng);k=k||Rt}}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((T=T||this._layerOrderChanged||0===E)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(y.browser.now(),l.zoom))&&(this.pauseablePlacement=new Xo(l,this._order,T,g,E,P,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,H),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(y.browser.now()),q=!0),k&&this.pauseablePlacement.placement.setStale()),q||k)for(var jt=0,Dt=this._order;jt<Dt.length;jt+=1){var qt=this._layers[Dt[jt]];"symbol"===qt.type&&this.placement.updateLayerOpacities(qt,H[qt.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(y.browser.now())},p.prototype._releaseSymbolFadeTiles=function(){for(var l in this.sourceCaches)this.sourceCaches[l].releaseSymbolFadeTiles()},p.prototype.getImages=function(l,g,E){this.imageManager.getImages(g.icons,E),this._updateTilesForChangedImages();var P=this.sourceCaches[g.source];P&&P.setDependencies(g.tileID.key,g.type,g.icons)},p.prototype.getGlyphs=function(l,g,E){this.glyphManager.getGlyphs(g.stacks,E)},p.prototype.getResource=function(l,g,E){return y.makeRequest(g,E)},p}(y.Evented);ja.getSourceType=function(u){return Fe[u]},ja.setSourceType=function(u,p){Fe[u]=p},ja.registerForPluginStateChange=y.registerForPluginStateChange;var so=y.createLayout([{name:"a_pos",type:"Int16",components:2}]),bi=Ei("#ifdef GL_ES\nprecision mediump float;\n#else\n#if !defined(lowp)\n#define lowp\n#endif\n#if !defined(mediump)\n#define mediump\n#endif\n#if !defined(highp)\n#define highp\n#endif\n#endif","#ifdef GL_ES\nprecision highp float;\n#else\n#if !defined(lowp)\n#define lowp\n#endif\n#if !defined(mediump)\n#define mediump\n#endif\n#if !defined(highp)\n#define highp\n#endif\n#endif\nvec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0\n);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}"),ms=Ei("uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),uu=Ei("uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),uo=Ei("varying vec3 v_data;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvoid main(void) {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,0,1);} else {gl_Position=u_matrix*vec4(circle_center,0,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}"),Yu=Ei("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),fa=Ei("uniform highp float u_intensity;varying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#define GAUSS_COEF 0.3989422804014327\nvoid main() {\n#pragma mapbox: initialize highp float weight\nfloat d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#pragma mapbox: define mediump float radius\nconst highp float ZERO=1.0/255.0/16.0;\n#define GAUSS_COEF 0.3989422804014327\nvoid main(void) {\n#pragma mapbox: initialize highp float weight\n#pragma mapbox: initialize mediump float radius\nvec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}"),Ri=Ei("uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(0.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),lo=Ei("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,0.0,1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),wu=Ei("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),Zl=Ei("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,0,1);}"),lu=Ei("#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_FragColor=color*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);}"),Wu=Ei("varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}"),Eu=Ei("uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}"),eo=Ei("uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}"),Us=Ei("varying vec4 v_color;void main() {gl_FragColor=v_color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec4 v_color;\n#pragma mapbox: define highp float base\n#pragma mapbox: define highp float height\n#pragma mapbox: define highp vec4 color\nvoid main() {\n#pragma mapbox: initialize highp float base\n#pragma mapbox: initialize highp float height\n#pragma mapbox: initialize highp vec4 color\nvec3 normal=a_normal_ed.xyz;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}"),Qn=Ei("uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0\n? a_pos\n: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}"),Ms=Ei("#ifdef GL_ES\nprecision highp float;\n#endif\nuniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),Fo=Ei("uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;\n#define PI 3.141592653589793\nvoid main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),rs=Ei("uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}"),wi=Ei("uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}"),kr=Ei("uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\n#define LINE_DISTANCE_SCALE 2.0\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}"),Xs=Ei("uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\n#define LINE_DISTANCE_SCALE 2.0\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}"),ys=Ei("uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),co=Ei("uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nlowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),0.0,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));}"),Wo=Ei("#define SDF_PX 8.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}"),Ys=Ei("#define SDF_PX 8.0\n#define SDF 1.0\n#define ICON 0.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\nreturn;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}");function Ei(u,p){var l=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,g=p.match(/attribute ([\w]+) ([\w]+)/g),E=u.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),P=p.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),T=P?P.concat(E):E,k={};return{fragmentSource:u=u.replace(l,function(q,H,ut,dt,lt){return k[lt]=!0,"define"===H?"\n#ifndef HAS_UNIFORM_u_"+lt+"\nvarying "+ut+" "+dt+" "+lt+";\n#else\nuniform "+ut+" "+dt+" u_"+lt+";\n#endif\n":"\n#ifdef HAS_UNIFORM_u_"+lt+"\n    "+ut+" "+dt+" "+lt+" = u_"+lt+";\n#endif\n"}),vertexSource:p=p.replace(l,function(q,H,ut,dt,lt){var zt="float"===dt?"vec2":"vec4",Rt=lt.match(/color/)?"color":zt;return k[lt]?"define"===H?"\n#ifndef HAS_UNIFORM_u_"+lt+"\nuniform lowp float u_"+lt+"_t;\nattribute "+ut+" "+zt+" a_"+lt+";\nvarying "+ut+" "+dt+" "+lt+";\n#else\nuniform "+ut+" "+dt+" u_"+lt+";\n#endif\n":"vec4"===Rt?"\n#ifndef HAS_UNIFORM_u_"+lt+"\n    "+lt+" = a_"+lt+";\n#else\n    "+ut+" "+dt+" "+lt+" = u_"+lt+";\n#endif\n":"\n#ifndef HAS_UNIFORM_u_"+lt+"\n    "+lt+" = unpack_mix_"+Rt+"(a_"+lt+", u_"+lt+"_t);\n#else\n    "+ut+" "+dt+" "+lt+" = u_"+lt+";\n#endif\n":"define"===H?"\n#ifndef HAS_UNIFORM_u_"+lt+"\nuniform lowp float u_"+lt+"_t;\nattribute "+ut+" "+zt+" a_"+lt+";\n#else\nuniform "+ut+" "+dt+" u_"+lt+";\n#endif\n":"vec4"===Rt?"\n#ifndef HAS_UNIFORM_u_"+lt+"\n    "+ut+" "+dt+" "+lt+" = a_"+lt+";\n#else\n    "+ut+" "+dt+" "+lt+" = u_"+lt+";\n#endif\n":"\n#ifndef HAS_UNIFORM_u_"+lt+"\n    "+ut+" "+dt+" "+lt+" = unpack_mix_"+Rt+"(a_"+lt+", u_"+lt+"_t);\n#else\n    "+ut+" "+dt+" "+lt+" = u_"+lt+";\n#endif\n"}),staticAttributes:g,staticUniforms:T}}var cu=Object.freeze({__proto__:null,prelude:bi,background:ms,backgroundPattern:uu,circle:uo,clippingMask:Yu,heatmap:fa,heatmapTexture:Ri,collisionBox:lo,collisionCircle:wu,debug:Zl,fill:lu,fillOutline:Wu,fillOutlinePattern:Eu,fillPattern:eo,fillExtrusion:Us,fillExtrusionPattern:Qn,hillshadePrepare:Ms,hillshade:Fo,line:rs,lineGradient:wi,linePattern:kr,lineSDF:Xs,raster:ys,symbolIcon:co,symbolSDF:Wo,symbolTextAndIcon:Ys}),Hu=function(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null};function qn(u){for(var p=[],l=0;l<u.length;l++)if(null!==u[l]){var g=u[l].split(" ");p.push(g.pop())}return p}Hu.prototype.bind=function(u,p,l,g,E,P,T,k){this.context=u;for(var q=this.boundPaintVertexBuffers.length!==g.length,H=0;!q&&H<g.length;H++)this.boundPaintVertexBuffers[H]!==g[H]&&(q=!0);u.extVertexArrayObject&&this.vao&&this.boundProgram===p&&this.boundLayoutVertexBuffer===l&&!q&&this.boundIndexBuffer===E&&this.boundVertexOffset===P&&this.boundDynamicVertexBuffer===T&&this.boundDynamicVertexBuffer2===k?(u.bindVertexArrayOES.set(this.vao),T&&T.bind(),E&&E.dynamicDraw&&E.bind(),k&&k.bind()):this.freshBind(p,l,g,E,P,T,k)},Hu.prototype.freshBind=function(u,p,l,g,E,P,T){var k,q=u.numAttributes,H=this.context,ut=H.gl;if(H.extVertexArrayObject)this.vao&&this.destroy(),this.vao=H.extVertexArrayObject.createVertexArrayOES(),H.bindVertexArrayOES.set(this.vao),k=0,this.boundProgram=u,this.boundLayoutVertexBuffer=p,this.boundPaintVertexBuffers=l,this.boundIndexBuffer=g,this.boundVertexOffset=E,this.boundDynamicVertexBuffer=P,this.boundDynamicVertexBuffer2=T;else{k=H.currentNumAttributes||0;for(var dt=q;dt<k;dt++)ut.disableVertexAttribArray(dt)}p.enableAttributes(ut,u);for(var lt=0,zt=l;lt<zt.length;lt+=1)zt[lt].enableAttributes(ut,u);P&&P.enableAttributes(ut,u),T&&T.enableAttributes(ut,u),p.bind(),p.setVertexAttribPointers(ut,u,E);for(var Rt=0,jt=l;Rt<jt.length;Rt+=1){var Dt=jt[Rt];Dt.bind(),Dt.setVertexAttribPointers(ut,u,E)}P&&(P.bind(),P.setVertexAttribPointers(ut,u,E)),g&&g.bind(),T&&(T.bind(),T.setVertexAttribPointers(ut,u,E)),H.currentNumAttributes=q},Hu.prototype.destroy=function(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)};var Ts=function(u,p,l,g,E,P){var T=u.gl;this.program=T.createProgram();for(var k=qn(l.staticAttributes),q=g?g.getBinderAttributes():[],H=k.concat(q),ut=l.staticUniforms?qn(l.staticUniforms):[],dt=g?g.getBinderUniforms():[],lt=[],zt=0,Rt=ut.concat(dt);zt<Rt.length;zt+=1){var jt=Rt[zt];lt.indexOf(jt)<0&&lt.push(jt)}var Dt=g?g.defines():[];P&&Dt.push("#define OVERDRAW_INSPECTOR;");var qt=Dt.concat(bi.fragmentSource,l.fragmentSource).join("\n"),ee=Dt.concat(bi.vertexSource,l.vertexSource).join("\n"),oe=T.createShader(T.FRAGMENT_SHADER);if(T.isContextLost())this.failedToCreate=!0;else{T.shaderSource(oe,qt),T.compileShader(oe),T.attachShader(this.program,oe);var Se=T.createShader(T.VERTEX_SHADER);if(T.isContextLost())this.failedToCreate=!0;else{T.shaderSource(Se,ee),T.compileShader(Se),T.attachShader(this.program,Se),this.attributes={};var ge={};this.numAttributes=H.length;for(var Ce=0;Ce<this.numAttributes;Ce++)H[Ce]&&(T.bindAttribLocation(this.program,Ce,H[Ce]),this.attributes[H[Ce]]=Ce);T.linkProgram(this.program),T.deleteShader(Se),T.deleteShader(oe);for(var be=0;be<lt.length;be++){var Ue=lt[be];if(Ue&&!ge[Ue]){var Ne=T.getUniformLocation(this.program,Ue);Ne&&(ge[Ue]=Ne)}}this.fixedUniforms=E(u,ge),this.binderUniforms=g?g.getUniforms(u,ge):[]}}};function Ni(u,p,l){var g=1/Di(l,1,p.transform.tileZoom),E=Math.pow(2,l.tileID.overscaledZ),P=l.tileSize*Math.pow(2,p.transform.tileZoom)/E,T=P*(l.tileID.canonical.x+l.tileID.wrap*E),k=P*l.tileID.canonical.y;return{u_image:0,u_texsize:l.imageAtlasTexture.size,u_scale:[g,u.fromScale,u.toScale],u_fade:u.t,u_pixel_coord_upper:[T>>16,k>>16],u_pixel_coord_lower:[65535&T,65535&k]}}Ts.prototype.draw=function(u,p,l,g,E,P,T,k,q,H,ut,dt,lt,zt,Rt,jt){var Dt,qt=u.gl;if(!this.failedToCreate){for(var ee in u.program.set(this.program),u.setDepthMode(l),u.setStencilMode(g),u.setColorMode(E),u.setCullFace(P),this.fixedUniforms)this.fixedUniforms[ee].set(T[ee]);zt&&zt.setUniforms(u,this.binderUniforms,dt,{zoom:lt});for(var oe=(Dt={},Dt[qt.LINES]=2,Dt[qt.TRIANGLES]=3,Dt[qt.LINE_STRIP]=1,Dt)[p],Se=0,ge=ut.get();Se<ge.length;Se+=1){var Ce=ge[Se],be=Ce.vaos||(Ce.vaos={});(be[k]||(be[k]=new Hu)).bind(u,this,q,zt?zt.getPaintVertexBuffers():[],H,Ce.vertexOffset,Rt,jt),qt.drawElements(p,Ce.primitiveLength*oe,qt.UNSIGNED_SHORT,Ce.primitiveOffset*oe*2)}}};var Su=function(u,p,l,g){var E=p.style.light,P=E.properties.get("position"),T=[P.x,P.y,P.z],k=y.create$1();"viewport"===E.properties.get("anchor")&&y.fromRotation(k,-p.transform.angle),y.transformMat3(T,T,k);var q=E.properties.get("color");return{u_matrix:u,u_lightpos:T,u_lightintensity:E.properties.get("intensity"),u_lightcolor:[q.r,q.g,q.b],u_vertical_gradient:+l,u_opacity:g}},Ia=function(u,p,l,g,E,P,T){return y.extend(Su(u,p,l,g),Ni(P,p,T),{u_height_factor:-Math.pow(2,E.overscaledZ)/T.tileSize/8})},Ws=function(u){return{u_matrix:u}},wn=function(u,p,l,g){return y.extend(Ws(u),Ni(l,p,g))},vs=function(u,p){return{u_matrix:u,u_world:p}},Ci=function(u,p,l,g,E){return y.extend(wn(u,p,l,g),{u_world:E})},ku=function(u,p,l,g){var E,P,T=u.transform;if("map"===g.paint.get("circle-pitch-alignment")){var k=Di(l,1,T.zoom);E=!0,P=[k,k]}else E=!1,P=T.pixelsToGLUnits;return{u_camera_to_center_distance:T.cameraToCenterDistance,u_scale_with_map:+("map"===g.paint.get("circle-pitch-scale")),u_matrix:u.translatePosMatrix(p.posMatrix,l,g.paint.get("circle-translate"),g.paint.get("circle-translate-anchor")),u_pitch_with_map:+E,u_device_pixel_ratio:y.browser.devicePixelRatio,u_extrude_scale:P}},Bo=function(u,p,l){var g=Di(l,1,p.zoom),E=Math.pow(2,p.zoom-l.tileID.overscaledZ),P=l.tileID.overscaleFactor();return{u_matrix:u,u_camera_to_center_distance:p.cameraToCenterDistance,u_pixels_to_tile_units:g,u_extrude_scale:[p.pixelsToGLUnits[0]/(g*E),p.pixelsToGLUnits[1]/(g*E)],u_overscale_factor:P}},Xa=function(u,p,l){return{u_matrix:u,u_inv_matrix:p,u_camera_to_center_distance:l.cameraToCenterDistance,u_viewport_size:[l.width,l.height]}},_l=function(u,p,l){return void 0===l&&(l=1),{u_matrix:u,u_color:p,u_overlay:0,u_overlay_scale:l}},Ya=function(u){return{u_matrix:u}},kn=function(u,p,l,g){return{u_matrix:u,u_extrude_scale:Di(p,1,l),u_intensity:g}},da=function(u,p,l){var g=u.transform;return{u_matrix:zu(u,p,l),u_ratio:1/Di(p,1,g.zoom),u_device_pixel_ratio:y.browser.devicePixelRatio,u_units_to_pixels:[1/g.pixelsToGLUnits[0],1/g.pixelsToGLUnits[1]]}},hu=function(u,p,l,g){return y.extend(da(u,p,l),{u_image:0,u_image_height:g})},Gn=function(u,p,l,g){var E=u.transform,P=Uo(p,E);return{u_matrix:zu(u,p,l),u_texsize:p.imageAtlasTexture.size,u_ratio:1/Di(p,1,E.zoom),u_device_pixel_ratio:y.browser.devicePixelRatio,u_image:0,u_scale:[P,g.fromScale,g.toScale],u_fade:g.t,u_units_to_pixels:[1/E.pixelsToGLUnits[0],1/E.pixelsToGLUnits[1]]}},Ho=function(u,p,l,g,E){var P=u.lineAtlas,T=Uo(p,u.transform),k="round"===l.layout.get("line-cap"),q=P.getDash(g.from,k),H=P.getDash(g.to,k),ut=q.width*E.fromScale,dt=H.width*E.toScale;return y.extend(da(u,p,l),{u_patternscale_a:[T/ut,-q.height/2],u_patternscale_b:[T/dt,-H.height/2],u_sdfgamma:P.width/(256*Math.min(ut,dt)*y.browser.devicePixelRatio)/2,u_image:0,u_tex_y_a:q.y,u_tex_y_b:H.y,u_mix:E.t})};function Uo(u,p){return 1/Di(u,1,p.tileZoom)}function zu(u,p,l){return u.translatePosMatrix(p.tileID.posMatrix,p,l.paint.get("line-translate"),l.paint.get("line-translate-anchor"))}var pc=function(u,p,l,g,E){return{u_matrix:u,u_tl_parent:p,u_scale_parent:l,u_buffer_scale:1,u_fade_t:g.mix,u_opacity:g.opacity*E.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:E.paint.get("raster-brightness-min"),u_brightness_high:E.paint.get("raster-brightness-max"),u_saturation_factor:(T=E.paint.get("raster-saturation"),T>0?1-1/(1.001-T):-T),u_contrast_factor:(P=E.paint.get("raster-contrast"),P>0?1/(1-P):1+P),u_spin_weights:Hs(E.paint.get("raster-hue-rotate"))};var P,T};function Hs(u){u*=Math.PI/180;var p=Math.sin(u),l=Math.cos(u);return[(2*l+1)/3,(-Math.sqrt(3)*p-l+1)/3,(Math.sqrt(3)*p-l+1)/3]}var ga,Js=function(u,p,l,g,E,P,T,k,q,H){var ut=E.transform;return{u_is_size_zoom_constant:+("constant"===u||"source"===u),u_is_size_feature_constant:+("constant"===u||"camera"===u),u_size_t:p?p.uSizeT:0,u_size:p?p.uSize:0,u_camera_to_center_distance:ut.cameraToCenterDistance,u_pitch:ut.pitch/360*2*Math.PI,u_rotate_symbol:+l,u_aspect_ratio:ut.width/ut.height,u_fade_change:E.options.fadeDuration?E.symbolFadeChange:1,u_matrix:P,u_label_plane_matrix:T,u_coord_matrix:k,u_is_text:+q,u_pitch_with_map:+g,u_texsize:H,u_texture:0}},qo=function(u,p,l,g,E,P,T,k,q,H,ut){var dt=E.transform;return y.extend(Js(u,p,l,g,E,P,T,k,q,H),{u_gamma_scale:g?Math.cos(dt._pitch)*dt.cameraToCenterDistance:1,u_device_pixel_ratio:y.browser.devicePixelRatio,u_is_halo:+ut})},ma=function(u,p,l,g,E,P,T,k,q,H){return y.extend(qo(u,p,l,g,E,P,T,k,!0,q,!0),{u_texsize_icon:H,u_texture_icon:1})},za=function(u,p,l){return{u_matrix:u,u_opacity:p,u_color:l}},_s=function(u,p,l,g,E,P){return y.extend((k=P,H=E,ut=(q=l).imageManager.getPattern((T=g).from.toString()),dt=q.imageManager.getPattern(T.to.toString()),zt=(lt=q.imageManager.getPixelSize()).width,Rt=lt.height,jt=Math.pow(2,H.tileID.overscaledZ),qt=(Dt=H.tileSize*Math.pow(2,q.transform.tileZoom)/jt)*(H.tileID.canonical.x+H.tileID.wrap*jt),ee=Dt*H.tileID.canonical.y,{u_image:0,u_pattern_tl_a:ut.tl,u_pattern_br_a:ut.br,u_pattern_tl_b:dt.tl,u_pattern_br_b:dt.br,u_texsize:[zt,Rt],u_mix:k.t,u_pattern_size_a:ut.displaySize,u_pattern_size_b:dt.displaySize,u_scale_a:k.fromScale,u_scale_b:k.toScale,u_tile_units_to_pixels:1/Di(H,1,q.transform.tileZoom),u_pixel_coord_upper:[qt>>16,ee>>16],u_pixel_coord_lower:[65535&qt,65535&ee]}),{u_matrix:u,u_opacity:p});var T,k,q,H,ut,dt,lt,zt,Rt,jt,Dt,qt,ee},Fa={fillExtrusion:function(u,p){return{u_matrix:new y.UniformMatrix4f(u,p.u_matrix),u_lightpos:new y.Uniform3f(u,p.u_lightpos),u_lightintensity:new y.Uniform1f(u,p.u_lightintensity),u_lightcolor:new y.Uniform3f(u,p.u_lightcolor),u_vertical_gradient:new y.Uniform1f(u,p.u_vertical_gradient),u_opacity:new y.Uniform1f(u,p.u_opacity)}},fillExtrusionPattern:function(u,p){return{u_matrix:new y.UniformMatrix4f(u,p.u_matrix),u_lightpos:new y.Uniform3f(u,p.u_lightpos),u_lightintensity:new y.Uniform1f(u,p.u_lightintensity),u_lightcolor:new y.Uniform3f(u,p.u_lightcolor),u_vertical_gradient:new y.Uniform1f(u,p.u_vertical_gradient),u_height_factor:new y.Uniform1f(u,p.u_height_factor),u_image:new y.Uniform1i(u,p.u_image),u_texsize:new y.Uniform2f(u,p.u_texsize),u_pixel_coord_upper:new y.Uniform2f(u,p.u_pixel_coord_upper),u_pixel_coord_lower:new y.Uniform2f(u,p.u_pixel_coord_lower),u_scale:new y.Uniform3f(u,p.u_scale),u_fade:new y.Uniform1f(u,p.u_fade),u_opacity:new y.Uniform1f(u,p.u_opacity)}},fill:function(u,p){return{u_matrix:new y.UniformMatrix4f(u,p.u_matrix)}},fillPattern:function(u,p){return{u_matrix:new y.UniformMatrix4f(u,p.u_matrix),u_image:new y.Uniform1i(u,p.u_image),u_texsize:new y.Uniform2f(u,p.u_texsize),u_pixel_coord_upper:new y.Uniform2f(u,p.u_pixel_coord_upper),u_pixel_coord_lower:new y.Uniform2f(u,p.u_pixel_coord_lower),u_scale:new y.Uniform3f(u,p.u_scale),u_fade:new y.Uniform1f(u,p.u_fade)}},fillOutline:function(u,p){return{u_matrix:new y.UniformMatrix4f(u,p.u_matrix),u_world:new y.Uniform2f(u,p.u_world)}},fillOutlinePattern:function(u,p){return{u_matrix:new y.UniformMatrix4f(u,p.u_matrix),u_world:new y.Uniform2f(u,p.u_world),u_image:new y.Uniform1i(u,p.u_image),u_texsize:new y.Uniform2f(u,p.u_texsize),u_pixel_coord_upper:new y.Uniform2f(u,p.u_pixel_coord_upper),u_pixel_coord_lower:new y.Uniform2f(u,p.u_pixel_coord_lower),u_scale:new y.Uniform3f(u,p.u_scale),u_fade:new y.Uniform1f(u,p.u_fade)}},circle:function(u,p){return{u_camera_to_center_distance:new y.Uniform1f(u,p.u_camera_to_center_distance),u_scale_with_map:new y.Uniform1i(u,p.u_scale_with_map),u_pitch_with_map:new y.Uniform1i(u,p.u_pitch_with_map),u_extrude_scale:new y.Uniform2f(u,p.u_extrude_scale),u_device_pixel_ratio:new y.Uniform1f(u,p.u_device_pixel_ratio),u_matrix:new y.UniformMatrix4f(u,p.u_matrix)}},collisionBox:function(u,p){return{u_matrix:new y.UniformMatrix4f(u,p.u_matrix),u_camera_to_center_distance:new y.Uniform1f(u,p.u_camera_to_center_distance),u_pixels_to_tile_units:new y.Uniform1f(u,p.u_pixels_to_tile_units),u_extrude_scale:new y.Uniform2f(u,p.u_extrude_scale),u_overscale_factor:new y.Uniform1f(u,p.u_overscale_factor)}},collisionCircle:function(u,p){return{u_matrix:new y.UniformMatrix4f(u,p.u_matrix),u_inv_matrix:new y.UniformMatrix4f(u,p.u_inv_matrix),u_camera_to_center_distance:new y.Uniform1f(u,p.u_camera_to_center_distance),u_viewport_size:new y.Uniform2f(u,p.u_viewport_size)}},debug:function(u,p){return{u_color:new y.UniformColor(u,p.u_color),u_matrix:new y.UniformMatrix4f(u,p.u_matrix),u_overlay:new y.Uniform1i(u,p.u_overlay),u_overlay_scale:new y.Uniform1f(u,p.u_overlay_scale)}},clippingMask:function(u,p){return{u_matrix:new y.UniformMatrix4f(u,p.u_matrix)}},heatmap:function(u,p){return{u_extrude_scale:new y.Uniform1f(u,p.u_extrude_scale),u_intensity:new y.Uniform1f(u,p.u_intensity),u_matrix:new y.UniformMatrix4f(u,p.u_matrix)}},heatmapTexture:function(u,p){return{u_matrix:new y.UniformMatrix4f(u,p.u_matrix),u_world:new y.Uniform2f(u,p.u_world),u_image:new y.Uniform1i(u,p.u_image),u_color_ramp:new y.Uniform1i(u,p.u_color_ramp),u_opacity:new y.Uniform1f(u,p.u_opacity)}},hillshade:function(u,p){return{u_matrix:new y.UniformMatrix4f(u,p.u_matrix),u_image:new y.Uniform1i(u,p.u_image),u_latrange:new y.Uniform2f(u,p.u_latrange),u_light:new y.Uniform2f(u,p.u_light),u_shadow:new y.UniformColor(u,p.u_shadow),u_highlight:new y.UniformColor(u,p.u_highlight),u_accent:new y.UniformColor(u,p.u_accent)}},hillshadePrepare:function(u,p){return{u_matrix:new y.UniformMatrix4f(u,p.u_matrix),u_image:new y.Uniform1i(u,p.u_image),u_dimension:new y.Uniform2f(u,p.u_dimension),u_zoom:new y.Uniform1f(u,p.u_zoom),u_unpack:new y.Uniform4f(u,p.u_unpack)}},line:function(u,p){return{u_matrix:new y.UniformMatrix4f(u,p.u_matrix),u_ratio:new y.Uniform1f(u,p.u_ratio),u_device_pixel_ratio:new y.Uniform1f(u,p.u_device_pixel_ratio),u_units_to_pixels:new y.Uniform2f(u,p.u_units_to_pixels)}},lineGradient:function(u,p){return{u_matrix:new y.UniformMatrix4f(u,p.u_matrix),u_ratio:new y.Uniform1f(u,p.u_ratio),u_device_pixel_ratio:new y.Uniform1f(u,p.u_device_pixel_ratio),u_units_to_pixels:new y.Uniform2f(u,p.u_units_to_pixels),u_image:new y.Uniform1i(u,p.u_image),u_image_height:new y.Uniform1f(u,p.u_image_height)}},linePattern:function(u,p){return{u_matrix:new y.UniformMatrix4f(u,p.u_matrix),u_texsize:new y.Uniform2f(u,p.u_texsize),u_ratio:new y.Uniform1f(u,p.u_ratio),u_device_pixel_ratio:new y.Uniform1f(u,p.u_device_pixel_ratio),u_image:new y.Uniform1i(u,p.u_image),u_units_to_pixels:new y.Uniform2f(u,p.u_units_to_pixels),u_scale:new y.Uniform3f(u,p.u_scale),u_fade:new y.Uniform1f(u,p.u_fade)}},lineSDF:function(u,p){return{u_matrix:new y.UniformMatrix4f(u,p.u_matrix),u_ratio:new y.Uniform1f(u,p.u_ratio),u_device_pixel_ratio:new y.Uniform1f(u,p.u_device_pixel_ratio),u_units_to_pixels:new y.Uniform2f(u,p.u_units_to_pixels),u_patternscale_a:new y.Uniform2f(u,p.u_patternscale_a),u_patternscale_b:new y.Uniform2f(u,p.u_patternscale_b),u_sdfgamma:new y.Uniform1f(u,p.u_sdfgamma),u_image:new y.Uniform1i(u,p.u_image),u_tex_y_a:new y.Uniform1f(u,p.u_tex_y_a),u_tex_y_b:new y.Uniform1f(u,p.u_tex_y_b),u_mix:new y.Uniform1f(u,p.u_mix)}},raster:function(u,p){return{u_matrix:new y.UniformMatrix4f(u,p.u_matrix),u_tl_parent:new y.Uniform2f(u,p.u_tl_parent),u_scale_parent:new y.Uniform1f(u,p.u_scale_parent),u_buffer_scale:new y.Uniform1f(u,p.u_buffer_scale),u_fade_t:new y.Uniform1f(u,p.u_fade_t),u_opacity:new y.Uniform1f(u,p.u_opacity),u_image0:new y.Uniform1i(u,p.u_image0),u_image1:new y.Uniform1i(u,p.u_image1),u_brightness_low:new y.Uniform1f(u,p.u_brightness_low),u_brightness_high:new y.Uniform1f(u,p.u_brightness_high),u_saturation_factor:new y.Uniform1f(u,p.u_saturation_factor),u_contrast_factor:new y.Uniform1f(u,p.u_contrast_factor),u_spin_weights:new y.Uniform3f(u,p.u_spin_weights)}},symbolIcon:function(u,p){return{u_is_size_zoom_constant:new y.Uniform1i(u,p.u_is_size_zoom_constant),u_is_size_feature_constant:new y.Uniform1i(u,p.u_is_size_feature_constant),u_size_t:new y.Uniform1f(u,p.u_size_t),u_size:new y.Uniform1f(u,p.u_size),u_camera_to_center_distance:new y.Uniform1f(u,p.u_camera_to_center_distance),u_pitch:new y.Uniform1f(u,p.u_pitch),u_rotate_symbol:new y.Uniform1i(u,p.u_rotate_symbol),u_aspect_ratio:new y.Uniform1f(u,p.u_aspect_ratio),u_fade_change:new y.Uniform1f(u,p.u_fade_change),u_matrix:new y.UniformMatrix4f(u,p.u_matrix),u_label_plane_matrix:new y.UniformMatrix4f(u,p.u_label_plane_matrix),u_coord_matrix:new y.UniformMatrix4f(u,p.u_coord_matrix),u_is_text:new y.Uniform1i(u,p.u_is_text),u_pitch_with_map:new y.Uniform1i(u,p.u_pitch_with_map),u_texsize:new y.Uniform2f(u,p.u_texsize),u_texture:new y.Uniform1i(u,p.u_texture)}},symbolSDF:function(u,p){return{u_is_size_zoom_constant:new y.Uniform1i(u,p.u_is_size_zoom_constant),u_is_size_feature_constant:new y.Uniform1i(u,p.u_is_size_feature_constant),u_size_t:new y.Uniform1f(u,p.u_size_t),u_size:new y.Uniform1f(u,p.u_size),u_camera_to_center_distance:new y.Uniform1f(u,p.u_camera_to_center_distance),u_pitch:new y.Uniform1f(u,p.u_pitch),u_rotate_symbol:new y.Uniform1i(u,p.u_rotate_symbol),u_aspect_ratio:new y.Uniform1f(u,p.u_aspect_ratio),u_fade_change:new y.Uniform1f(u,p.u_fade_change),u_matrix:new y.UniformMatrix4f(u,p.u_matrix),u_label_plane_matrix:new y.UniformMatrix4f(u,p.u_label_plane_matrix),u_coord_matrix:new y.UniformMatrix4f(u,p.u_coord_matrix),u_is_text:new y.Uniform1i(u,p.u_is_text),u_pitch_with_map:new y.Uniform1i(u,p.u_pitch_with_map),u_texsize:new y.Uniform2f(u,p.u_texsize),u_texture:new y.Uniform1i(u,p.u_texture),u_gamma_scale:new y.Uniform1f(u,p.u_gamma_scale),u_device_pixel_ratio:new y.Uniform1f(u,p.u_device_pixel_ratio),u_is_halo:new y.Uniform1i(u,p.u_is_halo)}},symbolTextAndIcon:function(u,p){return{u_is_size_zoom_constant:new y.Uniform1i(u,p.u_is_size_zoom_constant),u_is_size_feature_constant:new y.Uniform1i(u,p.u_is_size_feature_constant),u_size_t:new y.Uniform1f(u,p.u_size_t),u_size:new y.Uniform1f(u,p.u_size),u_camera_to_center_distance:new y.Uniform1f(u,p.u_camera_to_center_distance),u_pitch:new y.Uniform1f(u,p.u_pitch),u_rotate_symbol:new y.Uniform1i(u,p.u_rotate_symbol),u_aspect_ratio:new y.Uniform1f(u,p.u_aspect_ratio),u_fade_change:new y.Uniform1f(u,p.u_fade_change),u_matrix:new y.UniformMatrix4f(u,p.u_matrix),u_label_plane_matrix:new y.UniformMatrix4f(u,p.u_label_plane_matrix),u_coord_matrix:new y.UniformMatrix4f(u,p.u_coord_matrix),u_is_text:new y.Uniform1i(u,p.u_is_text),u_pitch_with_map:new y.Uniform1i(u,p.u_pitch_with_map),u_texsize:new y.Uniform2f(u,p.u_texsize),u_texsize_icon:new y.Uniform2f(u,p.u_texsize_icon),u_texture:new y.Uniform1i(u,p.u_texture),u_texture_icon:new y.Uniform1i(u,p.u_texture_icon),u_gamma_scale:new y.Uniform1f(u,p.u_gamma_scale),u_device_pixel_ratio:new y.Uniform1f(u,p.u_device_pixel_ratio),u_is_halo:new y.Uniform1i(u,p.u_is_halo)}},background:function(u,p){return{u_matrix:new y.UniformMatrix4f(u,p.u_matrix),u_opacity:new y.Uniform1f(u,p.u_opacity),u_color:new y.UniformColor(u,p.u_color)}},backgroundPattern:function(u,p){return{u_matrix:new y.UniformMatrix4f(u,p.u_matrix),u_opacity:new y.Uniform1f(u,p.u_opacity),u_image:new y.Uniform1i(u,p.u_image),u_pattern_tl_a:new y.Uniform2f(u,p.u_pattern_tl_a),u_pattern_br_a:new y.Uniform2f(u,p.u_pattern_br_a),u_pattern_tl_b:new y.Uniform2f(u,p.u_pattern_tl_b),u_pattern_br_b:new y.Uniform2f(u,p.u_pattern_br_b),u_texsize:new y.Uniform2f(u,p.u_texsize),u_mix:new y.Uniform1f(u,p.u_mix),u_pattern_size_a:new y.Uniform2f(u,p.u_pattern_size_a),u_pattern_size_b:new y.Uniform2f(u,p.u_pattern_size_b),u_scale_a:new y.Uniform1f(u,p.u_scale_a),u_scale_b:new y.Uniform1f(u,p.u_scale_b),u_pixel_coord_upper:new y.Uniform2f(u,p.u_pixel_coord_upper),u_pixel_coord_lower:new y.Uniform2f(u,p.u_pixel_coord_lower),u_tile_units_to_pixels:new y.Uniform1f(u,p.u_tile_units_to_pixels)}}};function vo(u,p,l,g,E,P,T){for(var k=u.context,q=k.gl,H=u.useProgram("collisionBox"),ut=[],dt=0,lt=0,zt=0;zt<g.length;zt++){var Rt=g[zt],jt=p.getTile(Rt),Dt=jt.getBucket(l);if(Dt){var qt=Rt.posMatrix;0===E[0]&&0===E[1]||(qt=u.translatePosMatrix(Rt.posMatrix,jt,E,P));var ee=T?Dt.textCollisionBox:Dt.iconCollisionBox,oe=Dt.collisionCircleArray;if(oe.length>0){var Se=y.create(),ge=qt;y.mul(Se,Dt.placementInvProjMatrix,u.transform.glCoordMatrix),y.mul(Se,Se,Dt.placementViewportMatrix),ut.push({circleArray:oe,circleOffset:lt,transform:ge,invTransform:Se}),lt=dt+=oe.length/4}ee&&H.draw(k,q.LINES,ht.disabled,Ot.disabled,u.colorModeForRenderPass(),ne.disabled,Bo(qt,u.transform,jt),l.id,ee.layoutVertexBuffer,ee.indexBuffer,ee.segments,null,u.transform.zoom,null,null,ee.collisionVertexBuffer)}}if(T&&ut.length){var Ce=u.useProgram("collisionCircle"),be=new y.StructArrayLayout2f1f2i16;be.resize(4*dt),be._trim();for(var Ue=0,Ne=0,Ve=ut;Ne<Ve.length;Ne+=1)for(var er=Ve[Ne],ir=0;ir<er.circleArray.length/4;ir++){var rr=4*ir,Rr=er.circleArray[rr+0],Ye=er.circleArray[rr+1],_r=er.circleArray[rr+2],Ir=er.circleArray[rr+3];be.emplace(Ue++,Rr,Ye,_r,Ir,0),be.emplace(Ue++,Rr,Ye,_r,Ir,1),be.emplace(Ue++,Rr,Ye,_r,Ir,2),be.emplace(Ue++,Rr,Ye,_r,Ir,3)}(!ga||ga.length<2*dt)&&(ga=function(Kr){var pn=2*Kr,on=new y.StructArrayLayout3ui6;on.resize(pn),on._trim();for(var an=0;an<pn;an++){var $r=6*an;on.uint16[$r+0]=4*an+0,on.uint16[$r+1]=4*an+1,on.uint16[$r+2]=4*an+2,on.uint16[$r+3]=4*an+2,on.uint16[$r+4]=4*an+3,on.uint16[$r+5]=4*an+0}return on}(dt));for(var xr=k.createIndexBuffer(ga,!0),yr=k.createVertexBuffer(be,y.collisionCircleLayout.members,!0),dr=0,cr=ut;dr<cr.length;dr+=1){var ar=cr[dr],Vr=Xa(ar.transform,ar.invTransform,u.transform);Ce.draw(k,q.TRIANGLES,ht.disabled,Ot.disabled,u.colorModeForRenderPass(),ne.disabled,Vr,l.id,yr,xr,y.SegmentVector.simpleSegment(0,2*ar.circleOffset,ar.circleArray.length,ar.circleArray.length/2),null,u.transform.zoom,null,null,null)}yr.destroy(),xr.destroy()}}var Fu=y.identity(new Float32Array(16));function Wa(u,p,l,g,E,P){var T=y.getAnchorAlignment(u),k=-(T.horizontalAlign-.5)*p,q=-(T.verticalAlign-.5)*l,H=y.evaluateVariableOffset(u,g);return new y.Point((k/E+H[0])*P,(q/E+H[1])*P)}function Jo(u,p,l,g,E,P,T,k,q,H,ut){var dt=u.text.placedSymbolArray,lt=u.text.dynamicLayoutVertexArray,zt=u.icon.dynamicLayoutVertexArray,Rt={};lt.clear();for(var jt=0;jt<dt.length;jt++){var Dt=dt.get(jt),qt=Dt.hidden||!Dt.crossTileID||u.allowVerticalPlacement&&!Dt.placedOrientation?null:g[Dt.crossTileID];if(qt){var ee=new y.Point(Dt.anchorX,Dt.anchorY),oe=un(ee,l?k:T),Se=ko(P.cameraToCenterDistance,oe.signedDistanceFromCamera),ge=E.evaluateSizeForFeature(u.textSizeData,H,Dt)*Se/y.ONE_EM;l&&(ge*=u.tilePixelRatio/q);for(var Ce=Wa(qt.anchor,qt.width,qt.height,qt.textOffset,qt.textBoxScale,ge),be=l?un(ee.add(Ce),T).point:oe.point.add(p?Ce.rotate(-P.angle):Ce),Ue=u.allowVerticalPlacement&&Dt.placedOrientation===y.WritingMode.vertical?Math.PI/2:0,Ne=0;Ne<Dt.numGlyphs;Ne++)y.addDynamicAttributes(lt,be,Ue);ut&&Dt.associatedIconIndex>=0&&(Rt[Dt.associatedIconIndex]={shiftedAnchor:be,angle:Ue})}else Is(Dt.numGlyphs,lt)}if(ut){zt.clear();for(var Ve=u.icon.placedSymbolArray,er=0;er<Ve.length;er++){var ir=Ve.get(er);if(ir.hidden)Is(ir.numGlyphs,zt);else{var rr=Rt[er];if(rr)for(var Rr=0;Rr<ir.numGlyphs;Rr++)y.addDynamicAttributes(zt,rr.shiftedAnchor,rr.angle);else Is(ir.numGlyphs,zt)}}u.icon.dynamicLayoutVertexBuffer.updateData(zt)}u.text.dynamicLayoutVertexBuffer.updateData(lt)}function As(u,p,l){return l.iconsInText&&p?"symbolTextAndIcon":u?"symbolSDF":"symbolIcon"}function Ha(u,p,l,g,E,P,T,k,q,H,ut,dt){for(var lt=u.context,zt=lt.gl,Rt=u.transform,jt="map"===k,Dt="map"===q,qt=jt&&"point"!==l.layout.get("symbol-placement"),ee=jt&&!Dt&&!qt,oe=!l.layout.get("symbol-sort-key").isConstant(),Se=!1,ge=u.depthModeForSublayer(0,ht.ReadOnly),Ce=l.layout.get("text-variable-anchor"),be=[],Ue=0,Ne=g;Ue<Ne.length;Ue+=1){var Ve=Ne[Ue],er=p.getTile(Ve),ir=er.getBucket(l);if(ir){var rr=E?ir.text:ir.icon;if(rr&&rr.segments.get().length){var Rr=rr.programConfigurations.get(l.id),Ye=E||ir.sdfIcons,_r=E?ir.textSizeData:ir.iconSizeData,Ir=Dt||0!==Rt.pitch,xr=u.useProgram(As(Ye,E,ir),Rr),yr=y.evaluateSizeForZoom(_r,Rt.zoom),dr=void 0,cr=[0,0],ar=void 0,Vr=void 0,Kr=null,pn=void 0;if(E)ar=er.glyphAtlasTexture,Vr=zt.LINEAR,dr=er.glyphAtlasTexture.size,ir.iconsInText&&(cr=er.imageAtlasTexture.size,Kr=er.imageAtlasTexture,pn=Ir||u.options.rotating||u.options.zooming||"composite"===_r.kind||"camera"===_r.kind?zt.LINEAR:zt.NEAREST);else{var on=1!==l.layout.get("icon-size").constantOr(0)||ir.iconsNeedLinear;ar=er.imageAtlasTexture,Vr=Ye||u.options.rotating||u.options.zooming||on||Ir?zt.LINEAR:zt.NEAREST,dr=er.imageAtlasTexture.size}var an=Di(er,1,u.transform.zoom),$r=xi(Ve.posMatrix,Dt,jt,u.transform,an),hn=zn(Ve.posMatrix,Dt,jt,u.transform,an),Cn=Ce&&ir.hasTextData(),_a="none"!==l.layout.get("icon-text-fit")&&Cn&&ir.hasIconData();qt&&gs(ir,Ve.posMatrix,u,E,$r,hn,Dt,H);var xa=u.translatePosMatrix(Ve.posMatrix,er,P,T),Ds=qt||E&&Ce||_a?Fu:$r,ts=u.translatePosMatrix(hn,er,P,T,!0),bl=Ye&&0!==l.paint.get(E?"text-halo-width":"icon-halo-width").constantOr(1),nu={program:xr,buffers:rr,uniformValues:Ye?ir.iconsInText?ma(_r.kind,yr,ee,Dt,u,xa,Ds,ts,dr,cr):qo(_r.kind,yr,ee,Dt,u,xa,Ds,ts,E,dr,!0):Js(_r.kind,yr,ee,Dt,u,xa,Ds,ts,E,dr),atlasTexture:ar,atlasTextureIcon:Kr,atlasInterpolation:Vr,atlasInterpolationIcon:pn,isSDF:Ye,hasHalo:bl};if(oe&&ir.canOverlap){Se=!0;for(var Pu=0,yu=rr.segments.get();Pu<yu.length;Pu+=1){var wl=yu[Pu];be.push({segments:new y.SegmentVector([wl]),sortKey:wl.sortKey,state:nu})}}else be.push({segments:rr.segments,sortKey:0,state:nu})}}}Se&&be.sort(function(qs,Gu){return qs.sortKey-Gu.sortKey});for(var Ku=0,iu=be;Ku<iu.length;Ku+=1){var $u=iu[Ku],Go=$u.state;if(lt.activeTexture.set(zt.TEXTURE0),Go.atlasTexture.bind(Go.atlasInterpolation,zt.CLAMP_TO_EDGE),Go.atlasTextureIcon&&(lt.activeTexture.set(zt.TEXTURE1),Go.atlasTextureIcon&&Go.atlasTextureIcon.bind(Go.atlasInterpolationIcon,zt.CLAMP_TO_EDGE)),Go.isSDF){var vu=Go.uniformValues;Go.hasHalo&&(vu.u_is_halo=1,pu(Go.buffers,$u.segments,l,u,Go.program,ge,ut,dt,vu)),vu.u_is_halo=0}pu(Go.buffers,$u.segments,l,u,Go.program,ge,ut,dt,Go.uniformValues)}}function pu(u,p,l,g,E,P,T,k,q){var H=g.context;E.draw(H,H.gl.TRIANGLES,P,T,k,ne.disabled,q,l.id,u.layoutVertexBuffer,u.indexBuffer,p,l.paint,g.transform.zoom,u.programConfigurations.get(l.id),u.dynamicLayoutVertexBuffer,u.opacityVertexBuffer)}function _o(u,p,l,g,E,P,T){var k,q,H,ut,dt,lt=u.context.gl,zt=l.paint.get("fill-pattern"),Rt=zt&&zt.constantOr(1),jt=l.getCrossfadeParameters();T?(q=Rt&&!l.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",k=lt.LINES):(q=Rt?"fillPattern":"fill",k=lt.TRIANGLES);for(var Dt=0,qt=g;Dt<qt.length;Dt+=1){var ee=qt[Dt],oe=p.getTile(ee);if(!Rt||oe.patternsLoaded()){var Se=oe.getBucket(l);if(Se){var ge=Se.programConfigurations.get(l.id),Ce=u.useProgram(q,ge);Rt&&(u.context.activeTexture.set(lt.TEXTURE0),oe.imageAtlasTexture.bind(lt.LINEAR,lt.CLAMP_TO_EDGE),ge.updatePaintBuffers(jt));var be=zt.constantOr(null);if(be&&oe.imageAtlas){var Ue=oe.imageAtlas,Ne=Ue.patternPositions[be.to.toString()],Ve=Ue.patternPositions[be.from.toString()];Ne&&Ve&&ge.setConstantPatternPositions(Ne,Ve)}var er=u.translatePosMatrix(ee.posMatrix,oe,l.paint.get("fill-translate"),l.paint.get("fill-translate-anchor"));if(T){ut=Se.indexBuffer2,dt=Se.segments2;var ir=[lt.drawingBufferWidth,lt.drawingBufferHeight];H="fillOutlinePattern"===q&&Rt?Ci(er,u,jt,oe,ir):vs(er,ir)}else ut=Se.indexBuffer,dt=Se.segments,H=Rt?wn(er,u,jt,oe):Ws(er);Ce.draw(u.context,k,E,u.stencilModeForClipping(ee),P,ne.disabled,H,l.id,Se.layoutVertexBuffer,ut,dt,l.paint,u.transform.zoom,ge)}}}}function fu(u,p,l,g,E,P,T){for(var k=u.context,q=k.gl,H=l.paint.get("fill-extrusion-pattern"),ut=H.constantOr(1),dt=l.getCrossfadeParameters(),lt=l.paint.get("fill-extrusion-opacity"),zt=0,Rt=g;zt<Rt.length;zt+=1){var jt=Rt[zt],Dt=p.getTile(jt),qt=Dt.getBucket(l);if(qt){var ee=qt.programConfigurations.get(l.id),oe=u.useProgram(ut?"fillExtrusionPattern":"fillExtrusion",ee);ut&&(u.context.activeTexture.set(q.TEXTURE0),Dt.imageAtlasTexture.bind(q.LINEAR,q.CLAMP_TO_EDGE),ee.updatePaintBuffers(dt));var Se=H.constantOr(null);if(Se&&Dt.imageAtlas){var ge=Dt.imageAtlas,Ce=ge.patternPositions[Se.to.toString()],be=ge.patternPositions[Se.from.toString()];Ce&&be&&ee.setConstantPatternPositions(Ce,be)}var Ue=u.translatePosMatrix(jt.posMatrix,Dt,l.paint.get("fill-extrusion-translate"),l.paint.get("fill-extrusion-translate-anchor")),Ne=l.paint.get("fill-extrusion-vertical-gradient"),Ve=ut?Ia(Ue,u,Ne,lt,jt,dt,Dt):Su(Ue,u,Ne,lt);oe.draw(k,k.gl.TRIANGLES,E,P,T,ne.backCCW,Ve,l.id,qt.layoutVertexBuffer,qt.indexBuffer,qt.segments,l.paint,u.transform.zoom,ee)}}}function du(u,p,l,g,E,P){var T=u.context,k=T.gl,q=p.fbo;if(q){var H=u.useProgram("hillshade");T.activeTexture.set(k.TEXTURE0),k.bindTexture(k.TEXTURE_2D,q.colorAttachment.get());var ut=function(dt,lt,zt){var Rt=zt.paint.get("hillshade-shadow-color"),jt=zt.paint.get("hillshade-highlight-color"),Dt=zt.paint.get("hillshade-accent-color"),qt=zt.paint.get("hillshade-illumination-direction")*(Math.PI/180);"viewport"===zt.paint.get("hillshade-illumination-anchor")&&(qt-=dt.transform.angle);var ee,oe,Se,ge=!dt.options.moving;return{u_matrix:dt.transform.calculatePosMatrix(lt.tileID.toUnwrapped(),ge),u_image:0,u_latrange:(ee=lt.tileID,oe=Math.pow(2,ee.canonical.z),Se=ee.canonical.y,[new y.MercatorCoordinate(0,Se/oe).toLngLat().lat,new y.MercatorCoordinate(0,(Se+1)/oe).toLngLat().lat]),u_light:[zt.paint.get("hillshade-exaggeration"),qt],u_shadow:Rt,u_highlight:jt,u_accent:Dt}}(u,p,l);H.draw(T,k.TRIANGLES,g,E,P,ne.disabled,ut,l.id,u.rasterBoundsBuffer,u.quadTriangleIndexBuffer,u.rasterBoundsSegments)}}function Ks(u,p,l,g,E,P){var jt,Dt,qt,ee,T=u.context,k=T.gl,q=p.dem;if(q&&q.data){var H=q.dim,ut=q.stride,dt=q.getPixels();if(T.activeTexture.set(k.TEXTURE1),T.pixelStoreUnpackPremultiplyAlpha.set(!1),p.demTexture=p.demTexture||u.getTileTexture(ut),p.demTexture){var lt=p.demTexture;lt.update(dt,{premultiply:!1}),lt.bind(k.NEAREST,k.CLAMP_TO_EDGE)}else p.demTexture=new y.Texture(T,dt,k.RGBA,{premultiply:!1}),p.demTexture.bind(k.NEAREST,k.CLAMP_TO_EDGE);T.activeTexture.set(k.TEXTURE0);var zt=p.fbo;if(!zt){var Rt=new y.Texture(T,{width:H,height:H,data:null},k.RGBA);Rt.bind(k.LINEAR,k.CLAMP_TO_EDGE),(zt=p.fbo=T.createFramebuffer(H,H,!0)).colorAttachment.set(Rt.texture)}T.bindFramebuffer.set(zt.framebuffer),T.viewport.set([0,0,H,H]),u.useProgram("hillshadePrepare").draw(T,k.TRIANGLES,g,E,P,ne.disabled,(jt=p.tileID,qt=(Dt=q).stride,ee=y.create(),y.ortho(ee,0,y.EXTENT,-y.EXTENT,0,0,1),y.translate(ee,ee,[0,-y.EXTENT,0]),{u_matrix:ee,u_image:1,u_dimension:[qt,qt],u_zoom:jt.overscaledZ,u_unpack:Dt.getUnpackVector()}),l.id,u.rasterBoundsBuffer,u.quadTriangleIndexBuffer,u.rasterBoundsSegments),p.needsHillshadePrepare=!1}}function fc(u,p,l,g,E){var P=g.paint.get("raster-fade-duration");if(P>0){var T=y.browser.now(),k=(T-u.timeAdded)/P,q=p?(T-p.timeAdded)/P:-1,H=l.getSource(),ut=E.coveringZoomLevel({tileSize:H.tileSize,roundZoom:H.roundZoom}),dt=!p||Math.abs(p.tileID.overscaledZ-ut)>Math.abs(u.tileID.overscaledZ-ut),lt=dt&&u.refreshedUponExpiration?1:y.clamp(dt?k:1-q,0,1);return u.refreshedUponExpiration&&k>=1&&(u.refreshedUponExpiration=!1),p?{opacity:1,mix:1-lt}:{opacity:lt,mix:0}}return{opacity:1,mix:0}}var Bu=new y.Color(1,0,0,1),$s=new y.Color(0,1,0,1),xs=new y.Color(0,0,1,1),To=new y.Color(1,0,1,1),Qs=new y.Color(0,1,1,1);function xo(u,p,l,g){is(u,0,p+l/2,u.transform.width,l,g)}function ns(u,p,l,g){is(u,p-l/2,0,l,u.transform.height,g)}function is(u,p,l,g,E,P){var T=u.context,k=T.gl;k.enable(k.SCISSOR_TEST),k.scissor(p*y.browser.devicePixelRatio,l*y.browser.devicePixelRatio,g*y.browser.devicePixelRatio,E*y.browser.devicePixelRatio),T.clear({color:P}),k.disable(k.SCISSOR_TEST)}function Uu(u,p,l){var g=u.context,E=g.gl,P=l.posMatrix,T=u.useProgram("debug"),k=ht.disabled,q=Ot.disabled,H=u.colorModeForRenderPass();g.activeTexture.set(E.TEXTURE0),u.emptyTexture.bind(E.LINEAR,E.CLAMP_TO_EDGE),T.draw(g,E.LINE_STRIP,k,q,H,ne.disabled,_l(P,y.Color.red),"$debug",u.debugBuffer,u.tileBorderIndexBuffer,u.debugSegments);var ut=p.getTileByID(l.key).latestRawTileData,dt=Math.floor((ut&&ut.byteLength||0)/1024),lt=p.getTile(l).tileSize,zt=512/Math.min(lt,512)*(l.overscaledZ/u.transform.zoom)*.5,Rt=l.canonical.toString();l.overscaledZ!==l.canonical.z&&(Rt+=" => "+l.overscaledZ),function(jt,Dt){jt.initDebugOverlayCanvas();var qt=jt.debugOverlayCanvas,ee=jt.context.gl,oe=jt.debugOverlayCanvas.getContext("2d");oe.clearRect(0,0,qt.width,qt.height),oe.shadowColor="white",oe.shadowBlur=2,oe.lineWidth=1.5,oe.strokeStyle="white",oe.textBaseline="top",oe.font="bold 36px Open Sans, sans-serif",oe.fillText(Dt,5,5),oe.strokeText(Dt,5,5),jt.debugOverlayTexture.update(qt),jt.debugOverlayTexture.bind(ee.LINEAR,ee.CLAMP_TO_EDGE)}(u,Rt+" "+dt+"kb"),T.draw(g,E.TRIANGLES,k,q,Xt.alphaBlended,ne.disabled,_l(P,y.Color.transparent,zt),"$debug",u.debugBuffer,u.quadTriangleIndexBuffer,u.debugSegments)}var tu={symbol:function(u,p,l,g,E){if("translucent"===u.renderPass){var P=Ot.disabled,T=u.colorModeForRenderPass();l.layout.get("text-variable-anchor")&&function(k,q,H,ut,dt,lt,zt){for(var Rt=q.transform,jt="map"===dt,Dt="map"===lt,qt=0,ee=k;qt<ee.length;qt+=1){var oe=ee[qt],Se=ut.getTile(oe),ge=Se.getBucket(H);if(ge&&ge.text&&ge.text.segments.get().length){var Ce=y.evaluateSizeForZoom(ge.textSizeData,Rt.zoom),be=Di(Se,1,q.transform.zoom),Ue=xi(oe.posMatrix,Dt,jt,q.transform,be),Ne="none"!==H.layout.get("icon-text-fit")&&ge.hasIconData();if(Ce){var Ve=Math.pow(2,Rt.zoom-Se.tileID.overscaledZ);Jo(ge,jt,Dt,zt,y.symbolSize,Rt,Ue,oe.posMatrix,Ve,Ce,Ne)}}}}(g,u,l,p,l.layout.get("text-rotation-alignment"),l.layout.get("text-pitch-alignment"),E),0!==l.paint.get("icon-opacity").constantOr(1)&&Ha(u,p,l,g,!1,l.paint.get("icon-translate"),l.paint.get("icon-translate-anchor"),l.layout.get("icon-rotation-alignment"),l.layout.get("icon-pitch-alignment"),l.layout.get("icon-keep-upright"),P,T),0!==l.paint.get("text-opacity").constantOr(1)&&Ha(u,p,l,g,!0,l.paint.get("text-translate"),l.paint.get("text-translate-anchor"),l.layout.get("text-rotation-alignment"),l.layout.get("text-pitch-alignment"),l.layout.get("text-keep-upright"),P,T),p.map.showCollisionBoxes&&(vo(u,p,l,g,l.paint.get("text-translate"),l.paint.get("text-translate-anchor"),!0),vo(u,p,l,g,l.paint.get("icon-translate"),l.paint.get("icon-translate-anchor"),!1))}},circle:function(u,p,l,g){if("translucent"===u.renderPass){var E=l.paint.get("circle-opacity"),P=l.paint.get("circle-stroke-width"),T=l.paint.get("circle-stroke-opacity"),k=!l.layout.get("circle-sort-key").isConstant();if(0!==E.constantOr(1)||0!==P.constantOr(1)&&0!==T.constantOr(1)){for(var q=u.context,H=q.gl,ut=u.depthModeForSublayer(0,ht.ReadOnly),dt=Ot.disabled,lt=u.colorModeForRenderPass(),zt=[],Rt=0;Rt<g.length;Rt++){var jt=g[Rt],Dt=p.getTile(jt),qt=Dt.getBucket(l);if(qt){var ee=qt.programConfigurations.get(l.id),oe={programConfiguration:ee,program:u.useProgram("circle",ee),layoutVertexBuffer:qt.layoutVertexBuffer,indexBuffer:qt.indexBuffer,uniformValues:ku(u,jt,Dt,l)};if(k)for(var Se=0,ge=qt.segments.get();Se<ge.length;Se+=1){var Ce=ge[Se];zt.push({segments:new y.SegmentVector([Ce]),sortKey:Ce.sortKey,state:oe})}else zt.push({segments:qt.segments,sortKey:0,state:oe})}}k&&zt.sort(function(er,ir){return er.sortKey-ir.sortKey});for(var be=0,Ue=zt;be<Ue.length;be+=1){var Ne=Ue[be],Ve=Ne.state;Ve.program.draw(q,H.TRIANGLES,ut,dt,lt,ne.disabled,Ve.uniformValues,l.id,Ve.layoutVertexBuffer,Ve.indexBuffer,Ne.segments,l.paint,u.transform.zoom,Ve.programConfiguration)}}}},heatmap:function(u,p,l,g){if(0!==l.paint.get("heatmap-opacity"))if("offscreen"===u.renderPass){var E=u.context,P=E.gl,T=Ot.disabled,k=new Xt([P.ONE,P.ONE],y.Color.transparent,[!0,!0,!0,!0]);(function(zt,Rt,jt){var Dt=zt.gl;zt.activeTexture.set(Dt.TEXTURE1),zt.viewport.set([0,0,Rt.width/4,Rt.height/4]);var oe,Se,ge,Ce,be,qt=jt.heatmapFbo;if(qt)Dt.bindTexture(Dt.TEXTURE_2D,qt.colorAttachment.get()),zt.bindFramebuffer.set(qt.framebuffer);else{var ee=Dt.createTexture();Dt.bindTexture(Dt.TEXTURE_2D,ee),Dt.texParameteri(Dt.TEXTURE_2D,Dt.TEXTURE_WRAP_S,Dt.CLAMP_TO_EDGE),Dt.texParameteri(Dt.TEXTURE_2D,Dt.TEXTURE_WRAP_T,Dt.CLAMP_TO_EDGE),Dt.texParameteri(Dt.TEXTURE_2D,Dt.TEXTURE_MIN_FILTER,Dt.LINEAR),Dt.texParameteri(Dt.TEXTURE_2D,Dt.TEXTURE_MAG_FILTER,Dt.LINEAR),ge=ee,Ce=qt=jt.heatmapFbo=zt.createFramebuffer(Rt.width/4,Rt.height/4,!1),(be=(oe=zt).gl).texImage2D(be.TEXTURE_2D,0,be.RGBA,(Se=Rt).width/4,Se.height/4,0,be.RGBA,oe.extRenderToTextureHalfFloat?oe.extTextureHalfFloat.HALF_FLOAT_OES:be.UNSIGNED_BYTE,null),Ce.colorAttachment.set(ge)}})(E,u,l),E.clear({color:y.Color.transparent});for(var q=0;q<g.length;q++){var H=g[q];if(!p.hasRenderableParent(H)){var ut=p.getTile(H),dt=ut.getBucket(l);if(dt){var lt=dt.programConfigurations.get(l.id);u.useProgram("heatmap",lt).draw(E,P.TRIANGLES,ht.disabled,T,k,ne.disabled,kn(H.posMatrix,ut,u.transform.zoom,l.paint.get("heatmap-intensity")),l.id,dt.layoutVertexBuffer,dt.indexBuffer,dt.segments,l.paint,u.transform.zoom,lt)}}}E.viewport.set([0,0,u.width,u.height])}else"translucent"===u.renderPass&&(u.context.setColorMode(u.colorModeForRenderPass()),function(zt,Rt){var jt=zt.context,Dt=jt.gl,qt=Rt.heatmapFbo;if(qt){jt.activeTexture.set(Dt.TEXTURE0),Dt.bindTexture(Dt.TEXTURE_2D,qt.colorAttachment.get()),jt.activeTexture.set(Dt.TEXTURE1);var ee=Rt.colorRampTexture;ee||(ee=Rt.colorRampTexture=new y.Texture(jt,Rt.colorRamp,Dt.RGBA)),ee.bind(Dt.LINEAR,Dt.CLAMP_TO_EDGE),zt.useProgram("heatmapTexture").draw(jt,Dt.TRIANGLES,ht.disabled,Ot.disabled,zt.colorModeForRenderPass(),ne.disabled,function(oe,Se,ge,Ce){var be=y.create();y.ortho(be,0,oe.width,oe.height,0,0,1);var Ue=oe.context.gl;return{u_matrix:be,u_world:[Ue.drawingBufferWidth,Ue.drawingBufferHeight],u_image:0,u_color_ramp:1,u_opacity:Se.paint.get("heatmap-opacity")}}(zt,Rt),Rt.id,zt.viewportBuffer,zt.quadTriangleIndexBuffer,zt.viewportSegments,Rt.paint,zt.transform.zoom)}}(u,l))},line:function(u,p,l,g){if("translucent"===u.renderPass){var E=l.paint.get("line-opacity"),P=l.paint.get("line-width");if(0!==E.constantOr(1)&&0!==P.constantOr(1))for(var T=u.depthModeForSublayer(0,ht.ReadOnly),k=u.colorModeForRenderPass(),q=l.paint.get("line-dasharray"),H=l.paint.get("line-pattern"),ut=H.constantOr(1),dt=l.paint.get("line-gradient"),lt=l.getCrossfadeParameters(),zt=ut?"linePattern":q?"lineSDF":dt?"lineGradient":"line",Rt=u.context,jt=Rt.gl,Dt=!0,qt=0,ee=g;qt<ee.length;qt+=1){var oe=ee[qt],Se=p.getTile(oe);if(!ut||Se.patternsLoaded()){var ge=Se.getBucket(l);if(ge){var Ce=ge.programConfigurations.get(l.id),be=u.context.program.get(),Ue=u.useProgram(zt,Ce),Ne=Dt||Ue.program!==be,Ve=H.constantOr(null);if(Ve&&Se.imageAtlas){var er=Se.imageAtlas,ir=er.patternPositions[Ve.to.toString()],rr=er.patternPositions[Ve.from.toString()];ir&&rr&&Ce.setConstantPatternPositions(ir,rr)}var Rr=ut?Gn(u,Se,l,lt):q?Ho(u,Se,l,q,lt):dt?hu(u,Se,l,ge.lineClipsArray.length):da(u,Se,l);if(ut)Rt.activeTexture.set(jt.TEXTURE0),Se.imageAtlasTexture.bind(jt.LINEAR,jt.CLAMP_TO_EDGE),Ce.updatePaintBuffers(lt);else if(q&&(Ne||u.lineAtlas.dirty))Rt.activeTexture.set(jt.TEXTURE0),u.lineAtlas.bind(Rt);else if(dt){var Ye=ge.gradients[l.id],_r=Ye.texture;if(l.gradientVersion!==Ye.version){var Ir=256;if(l.stepInterpolant){var xr=p.getSource().maxzoom,yr=oe.canonical.z===xr?Math.ceil(1<<u.transform.maxZoom-oe.canonical.z):1;Ir=y.clamp(y.nextPowerOfTwo(ge.maxLineLength/y.EXTENT*1024*yr),256,Rt.maxTextureSize)}Ye.gradient=y.renderColorRamp({expression:l.gradientExpression(),evaluationKey:"lineProgress",resolution:Ir,image:Ye.gradient||void 0,clips:ge.lineClipsArray}),Ye.texture?Ye.texture.update(Ye.gradient):Ye.texture=new y.Texture(Rt,Ye.gradient,jt.RGBA),Ye.version=l.gradientVersion,_r=Ye.texture}Rt.activeTexture.set(jt.TEXTURE0),_r.bind(l.stepInterpolant?jt.NEAREST:jt.LINEAR,jt.CLAMP_TO_EDGE)}Ue.draw(Rt,jt.TRIANGLES,T,u.stencilModeForClipping(oe),k,ne.disabled,Rr,l.id,ge.layoutVertexBuffer,ge.indexBuffer,ge.segments,l.paint,u.transform.zoom,Ce,ge.layoutVertexBuffer2),Dt=!1}}}}},fill:function(u,p,l,g){var E=l.paint.get("fill-color"),P=l.paint.get("fill-opacity");if(0!==P.constantOr(1)){var T=u.colorModeForRenderPass(),k=l.paint.get("fill-pattern"),q=u.opaquePassEnabledForLayer()&&!k.constantOr(1)&&1===E.constantOr(y.Color.transparent).a&&1===P.constantOr(0)?"opaque":"translucent";if(u.renderPass===q){var H=u.depthModeForSublayer(1,"opaque"===u.renderPass?ht.ReadWrite:ht.ReadOnly);_o(u,p,l,g,H,T,!1)}if("translucent"===u.renderPass&&l.paint.get("fill-antialias")){var ut=u.depthModeForSublayer(l.getPaintProperty("fill-outline-color")?2:0,ht.ReadOnly);_o(u,p,l,g,ut,T,!0)}}},"fill-extrusion":function(u,p,l,g){var E=l.paint.get("fill-extrusion-opacity");if(0!==E&&"translucent"===u.renderPass){var P=new ht(u.context.gl.LEQUAL,ht.ReadWrite,u.depthRangeFor3D);if(1!==E||l.paint.get("fill-extrusion-pattern").constantOr(1))fu(u,p,l,g,P,Ot.disabled,Xt.disabled),fu(u,p,l,g,P,u.stencilModeFor3D(),u.colorModeForRenderPass());else{var T=u.colorModeForRenderPass();fu(u,p,l,g,P,Ot.disabled,T)}}},hillshade:function(u,p,l,g){if("offscreen"===u.renderPass||"translucent"===u.renderPass){for(var E=u.context,P=u.depthModeForSublayer(0,ht.ReadOnly),T=u.colorModeForRenderPass(),k="translucent"===u.renderPass?u.stencilConfigForOverlap(g):[{},g],q=k[0],H=0,ut=k[1];H<ut.length;H+=1){var dt=ut[H],lt=p.getTile(dt);lt.needsHillshadePrepare&&"offscreen"===u.renderPass?Ks(u,lt,l,P,Ot.disabled,T):"translucent"===u.renderPass&&du(u,lt,l,P,q[dt.overscaledZ],T)}E.viewport.set([0,0,u.width,u.height])}},raster:function(u,p,l,g){if("translucent"===u.renderPass&&0!==l.paint.get("raster-opacity")&&g.length)for(var E=u.context,P=E.gl,T=p.getSource(),k=u.useProgram("raster"),q=u.colorModeForRenderPass(),H=T instanceof Qt?[{},g]:u.stencilConfigForOverlap(g),ut=H[0],dt=H[1],lt=dt[dt.length-1].overscaledZ,zt=!u.options.moving,Rt=0,jt=dt;Rt<jt.length;Rt+=1){var Dt=jt[Rt],qt=u.depthModeForSublayer(Dt.overscaledZ-lt,1===l.paint.get("raster-opacity")?ht.ReadWrite:ht.ReadOnly,P.LESS),ee=p.getTile(Dt),oe=u.transform.calculatePosMatrix(Dt.toUnwrapped(),zt);ee.registerFadeDuration(l.paint.get("raster-fade-duration"));var Se=p.findLoadedParent(Dt,0),ge=fc(ee,Se,p,l,u.transform),Ce=void 0,be=void 0,Ue="nearest"===l.paint.get("raster-resampling")?P.NEAREST:P.LINEAR;E.activeTexture.set(P.TEXTURE0),ee.texture.bind(Ue,P.CLAMP_TO_EDGE,P.LINEAR_MIPMAP_NEAREST),E.activeTexture.set(P.TEXTURE1),Se?(Se.texture.bind(Ue,P.CLAMP_TO_EDGE,P.LINEAR_MIPMAP_NEAREST),Ce=Math.pow(2,Se.tileID.overscaledZ-ee.tileID.overscaledZ),be=[ee.tileID.canonical.x*Ce%1,ee.tileID.canonical.y*Ce%1]):ee.texture.bind(Ue,P.CLAMP_TO_EDGE,P.LINEAR_MIPMAP_NEAREST);var Ne=pc(oe,be||[0,0],Ce||1,ge,l);T instanceof Qt?k.draw(E,P.TRIANGLES,qt,Ot.disabled,q,ne.disabled,Ne,l.id,T.boundsBuffer,u.quadTriangleIndexBuffer,T.boundsSegments):k.draw(E,P.TRIANGLES,qt,ut[Dt.overscaledZ],q,ne.disabled,Ne,l.id,u.rasterBoundsBuffer,u.quadTriangleIndexBuffer,u.rasterBoundsSegments)}},background:function(u,p,l){var g=l.paint.get("background-color"),E=l.paint.get("background-opacity");if(0!==E){var P=u.context,T=P.gl,k=u.transform,q=k.tileSize,H=l.paint.get("background-pattern");if(!u.isPatternMissing(H)){var ut=!H&&1===g.a&&1===E&&u.opaquePassEnabledForLayer()?"opaque":"translucent";if(u.renderPass===ut){var dt=Ot.disabled,lt=u.depthModeForSublayer(0,"opaque"===ut?ht.ReadWrite:ht.ReadOnly),zt=u.colorModeForRenderPass(),Rt=u.useProgram(H?"backgroundPattern":"background"),jt=k.coveringTiles({tileSize:q});H&&(P.activeTexture.set(T.TEXTURE0),u.imageManager.bind(u.context));for(var Dt=l.getCrossfadeParameters(),qt=0,ee=jt;qt<ee.length;qt+=1){var oe=ee[qt],Se=u.transform.calculatePosMatrix(oe.toUnwrapped()),ge=H?_s(Se,E,u,H,{tileID:oe,tileSize:q},Dt):za(Se,E,g);Rt.draw(P,T.TRIANGLES,lt,dt,zt,ne.disabled,ge,l.id,u.tileExtentBuffer,u.quadTriangleIndexBuffer,u.tileExtentSegments)}}}}},debug:function(u,p,l){for(var g=0;g<l.length;g++)Uu(u,p,l[g])},custom:function(u,p,l){var g=u.context,E=l.implementation;if("offscreen"===u.renderPass){var P=E.prerender;P&&(u.setCustomLayerDefaults(),g.setColorMode(u.colorModeForRenderPass()),P.call(E,g.gl,u.transform.customLayerMatrix()),g.setDirty(),u.setBaseState())}else if("translucent"===u.renderPass){u.setCustomLayerDefaults(),g.setColorMode(u.colorModeForRenderPass()),g.setStencilMode(Ot.disabled);var T="3d"===E.renderingMode?new ht(u.context.gl.LEQUAL,ht.ReadWrite,u.depthRangeFor3D):u.depthModeForSublayer(0,ht.ReadOnly);g.setDepthMode(T),E.render(g.gl,u.transform.customLayerMatrix()),g.setDirty(),u.setBaseState(),g.bindFramebuffer.set(null)}}},Fn=function(u,p){this.context=new Yt(u),this.transform=p,this._tileTextures={},this.setup(),this.numSublayers=xt.maxUnderzooming+xt.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new Wi,this.gpuTimers={}};Fn.prototype.resize=function(u,p){if(this.width=u*y.browser.devicePixelRatio,this.height=p*y.browser.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(var l=0,g=this.style._order;l<g.length;l+=1)this.style._layers[g[l]].resize()},Fn.prototype.setup=function(){var u=this.context,p=new y.StructArrayLayout2i4;p.emplaceBack(0,0),p.emplaceBack(y.EXTENT,0),p.emplaceBack(0,y.EXTENT),p.emplaceBack(y.EXTENT,y.EXTENT),this.tileExtentBuffer=u.createVertexBuffer(p,so.members),this.tileExtentSegments=y.SegmentVector.simpleSegment(0,0,4,2);var l=new y.StructArrayLayout2i4;l.emplaceBack(0,0),l.emplaceBack(y.EXTENT,0),l.emplaceBack(0,y.EXTENT),l.emplaceBack(y.EXTENT,y.EXTENT),this.debugBuffer=u.createVertexBuffer(l,so.members),this.debugSegments=y.SegmentVector.simpleSegment(0,0,4,5);var g=new y.StructArrayLayout4i8;g.emplaceBack(0,0,0,0),g.emplaceBack(y.EXTENT,0,y.EXTENT,0),g.emplaceBack(0,y.EXTENT,0,y.EXTENT),g.emplaceBack(y.EXTENT,y.EXTENT,y.EXTENT,y.EXTENT),this.rasterBoundsBuffer=u.createVertexBuffer(g,Ht.members),this.rasterBoundsSegments=y.SegmentVector.simpleSegment(0,0,4,2);var E=new y.StructArrayLayout2i4;E.emplaceBack(0,0),E.emplaceBack(1,0),E.emplaceBack(0,1),E.emplaceBack(1,1),this.viewportBuffer=u.createVertexBuffer(E,so.members),this.viewportSegments=y.SegmentVector.simpleSegment(0,0,4,2);var P=new y.StructArrayLayout1ui2;P.emplaceBack(0),P.emplaceBack(1),P.emplaceBack(3),P.emplaceBack(2),P.emplaceBack(0),this.tileBorderIndexBuffer=u.createIndexBuffer(P);var T=new y.StructArrayLayout3ui6;T.emplaceBack(0,1,2),T.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=u.createIndexBuffer(T),this.emptyTexture=new y.Texture(u,{width:1,height:1,data:new Uint8Array([0,0,0,0])},u.gl.RGBA);var k=this.context.gl;this.stencilClearMode=new Ot({func:k.ALWAYS,mask:0},0,255,k.ZERO,k.ZERO,k.ZERO)},Fn.prototype.clearStencil=function(){var u=this.context,p=u.gl;this.nextStencilID=1,this.currentStencilSource=void 0;var l=y.create();y.ortho(l,0,this.width,this.height,0,0,1),y.scale(l,l,[p.drawingBufferWidth,p.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(u,p.TRIANGLES,ht.disabled,this.stencilClearMode,Xt.disabled,ne.disabled,Ya(l),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)},Fn.prototype._renderTileClippingMasks=function(u,p){if(this.currentStencilSource!==u.source&&u.isTileClipped()&&p&&p.length){this.currentStencilSource=u.source;var l=this.context,g=l.gl;this.nextStencilID+p.length>256&&this.clearStencil(),l.setColorMode(Xt.disabled),l.setDepthMode(ht.disabled);var E=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(var P=0,T=p;P<T.length;P+=1){var k=T[P],q=this._tileClippingMaskIDs[k.key]=this.nextStencilID++;E.draw(l,g.TRIANGLES,ht.disabled,new Ot({func:g.ALWAYS,mask:0},q,255,g.KEEP,g.KEEP,g.REPLACE),Xt.disabled,ne.disabled,Ya(k.posMatrix),"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}},Fn.prototype.stencilModeFor3D=function(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();var u=this.nextStencilID++,p=this.context.gl;return new Ot({func:p.NOTEQUAL,mask:255},u,255,p.KEEP,p.KEEP,p.REPLACE)},Fn.prototype.stencilModeForClipping=function(u){var p=this.context.gl;return new Ot({func:p.EQUAL,mask:255},this._tileClippingMaskIDs[u.key],0,p.KEEP,p.KEEP,p.REPLACE)},Fn.prototype.stencilConfigForOverlap=function(u){var p,l=this.context.gl,g=u.sort(function(q,H){return H.overscaledZ-q.overscaledZ}),E=g[g.length-1].overscaledZ,P=g[0].overscaledZ-E+1;if(P>1){this.currentStencilSource=void 0,this.nextStencilID+P>256&&this.clearStencil();for(var T={},k=0;k<P;k++)T[k+E]=new Ot({func:l.GEQUAL,mask:255},k+this.nextStencilID,255,l.KEEP,l.KEEP,l.REPLACE);return this.nextStencilID+=P,[T,g]}return[(p={},p[E]=Ot.disabled,p),g]},Fn.prototype.colorModeForRenderPass=function(){var u=this.context.gl;return this._showOverdrawInspector?new Xt([u.CONSTANT_COLOR,u.ONE],new y.Color(1/8,1/8,1/8,0),[!0,!0,!0,!0]):"opaque"===this.renderPass?Xt.unblended:Xt.alphaBlended},Fn.prototype.depthModeForSublayer=function(u,p,l){if(!this.opaquePassEnabledForLayer())return ht.disabled;var g=1-((1+this.currentLayer)*this.numSublayers+u)*this.depthEpsilon;return new ht(l||this.context.gl.LEQUAL,p,[g,g])},Fn.prototype.opaquePassEnabledForLayer=function(){return this.currentLayer<this.opaquePassCutoff},Fn.prototype.render=function(u,p){var l=this;this.style=u,this.options=p,this.lineAtlas=u.lineAtlas,this.imageManager=u.imageManager,this.glyphManager=u.glyphManager,this.symbolFadeChange=u.placement.symbolFadeChange(y.browser.now()),this.imageManager.beginFrame();var g=this.style._order,E=this.style.sourceCaches;for(var P in E){var T=E[P];T.used&&T.prepare(this.context)}var k,q,H={},ut={},dt={};for(var lt in E){var zt=E[lt];H[lt]=zt.getVisibleCoordinates(),ut[lt]=H[lt].slice().reverse(),dt[lt]=zt.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(var Rt=0;Rt<g.length;Rt++)if(this.style._layers[g[Rt]].is3D()){this.opaquePassCutoff=Rt;break}this.renderPass="offscreen";for(var jt=0,Dt=g;jt<Dt.length;jt+=1){var qt=this.style._layers[Dt[jt]];if(qt.hasOffscreenPass()&&!qt.isHidden(this.transform.zoom)){var ee=ut[qt.source];("custom"===qt.type||ee.length)&&this.renderLayer(this,E[qt.source],qt,ee)}}for(this.context.bindFramebuffer.set(null),this.context.clear({color:p.showOverdrawInspector?y.Color.black:y.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=p.showOverdrawInspector,this.depthRangeFor3D=[0,1-(u._order.length+2)*this.numSublayers*this.depthEpsilon],this.renderPass="opaque",this.currentLayer=g.length-1;this.currentLayer>=0;this.currentLayer--){var oe=this.style._layers[g[this.currentLayer]],Se=E[oe.source],ge=H[oe.source];this._renderTileClippingMasks(oe,ge),this.renderLayer(this,Se,oe,ge)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<g.length;this.currentLayer++){var Ce=this.style._layers[g[this.currentLayer]],be=E[Ce.source],Ue=("symbol"===Ce.type?dt:ut)[Ce.source];this._renderTileClippingMasks(Ce,H[Ce.source]),this.renderLayer(this,be,Ce,Ue)}this.options.showTileBoundaries&&(y.values(this.style._layers).forEach(function(Ne){Ne.source&&!Ne.isHidden(l.transform.zoom)&&(Ne.source!==(q&&q.id)&&(q=l.style.sourceCaches[Ne.source]),(!k||k.getSource().maxzoom<q.getSource().maxzoom)&&(k=q))}),k&&tu.debug(this,k,k.getVisibleCoordinates())),this.options.showPadding&&function(Ne){var Ve=Ne.transform.padding;xo(Ne,Ne.transform.height-(Ve.top||0),3,Bu),xo(Ne,Ve.bottom||0,3,$s),ns(Ne,Ve.left||0,3,xs),ns(Ne,Ne.transform.width-(Ve.right||0),3,To);var ir,rr,Rr,Ye,er=Ne.transform.centerPoint;is(ir=Ne,(rr=er.x)-1,(Rr=Ne.transform.height-er.y)-10,2,20,Ye=Qs),is(ir,rr-10,Rr-1,20,2,Ye)}(this),this.context.setDefault()},Fn.prototype.renderLayer=function(u,p,l,g){l.isHidden(this.transform.zoom)||("background"===l.type||"custom"===l.type||g.length)&&(this.id=l.id,this.gpuTimingStart(l),tu[l.type](u,p,l,g,this.style.placement.variableOffsets),this.gpuTimingEnd())},Fn.prototype.gpuTimingStart=function(u){if(this.options.gpuTiming){var p=this.context.extTimerQuery,l=this.gpuTimers[u.id];l||(l=this.gpuTimers[u.id]={calls:0,cpuTime:0,query:p.createQueryEXT()}),l.calls++,p.beginQueryEXT(p.TIME_ELAPSED_EXT,l.query)}},Fn.prototype.gpuTimingEnd=function(){if(this.options.gpuTiming){var u=this.context.extTimerQuery;u.endQueryEXT(u.TIME_ELAPSED_EXT)}},Fn.prototype.collectGpuTimers=function(){var u=this.gpuTimers;return this.gpuTimers={},u},Fn.prototype.queryGpuTimers=function(u){var p={};for(var l in u){var g=u[l],E=this.context.extTimerQuery,P=E.getQueryObjectEXT(g.query,E.QUERY_RESULT_EXT)/1e6;E.deleteQueryEXT(g.query),p[l]=P}return p},Fn.prototype.translatePosMatrix=function(u,p,l,g,E){if(!l[0]&&!l[1])return u;var P=E?"map"===g?this.transform.angle:0:"viewport"===g?-this.transform.angle:0;if(P){var T=Math.sin(P),k=Math.cos(P);l=[l[0]*k-l[1]*T,l[0]*T+l[1]*k]}var q=[E?l[0]:Di(p,l[0],this.transform.zoom),E?l[1]:Di(p,l[1],this.transform.zoom),0],H=new Float32Array(16);return y.translate(H,u,q),H},Fn.prototype.saveTileTexture=function(u){var p=this._tileTextures[u.size[0]];p?p.push(u):this._tileTextures[u.size[0]]=[u]},Fn.prototype.getTileTexture=function(u){var p=this._tileTextures[u];return p&&p.length>0?p.pop():null},Fn.prototype.isPatternMissing=function(u){if(!u)return!1;if(!u.from||!u.to)return!0;var p=this.imageManager.getPattern(u.from.toString()),l=this.imageManager.getPattern(u.to.toString());return!p||!l},Fn.prototype.useProgram=function(u,p){this.cache=this.cache||{};var l=""+u+(p?p.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"");return this.cache[l]||(this.cache[l]=new Ts(this.context,u,cu[u],p,Fa[u],this._showOverdrawInspector)),this.cache[l]},Fn.prototype.setCustomLayerDefaults=function(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()},Fn.prototype.setBaseState=function(){var u=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(u.FUNC_ADD)},Fn.prototype.initDebugOverlayCanvas=function(){null==this.debugOverlayCanvas&&(this.debugOverlayCanvas=y.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new y.Texture(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))},Fn.prototype.destroy=function(){this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy()};var os=function(u,p){this.points=u,this.planes=p};os.fromInvProjectionMatrix=function(u,p,l){var g=Math.pow(2,l),E=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(function(T){return y.transformMat4([],T,u)}).map(function(T){return y.scale$1([],T,1/T[3]/p*g)}),P=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(function(T){var k=y.sub([],E[T[0]],E[T[1]]),q=y.sub([],E[T[2]],E[T[1]]),H=y.normalize([],y.cross([],k,q)),ut=-y.dot(H,E[T[1]]);return H.concat(ut)});return new os(E,P)};var Ui=function(u,p){this.min=u,this.max=p,this.center=y.scale$2([],y.add([],this.min,this.max),.5)};Ui.prototype.quadrant=function(u){for(var p=[u%2==0,u<2],l=y.clone$2(this.min),g=y.clone$2(this.max),E=0;E<p.length;E++)l[E]=p[E]?this.min[E]:this.center[E],g[E]=p[E]?this.center[E]:this.max[E];return g[2]=this.max[2],new Ui(l,g)},Ui.prototype.distanceX=function(u){return Math.max(Math.min(this.max[0],u[0]),this.min[0])-u[0]},Ui.prototype.distanceY=function(u){return Math.max(Math.min(this.max[1],u[1]),this.min[1])-u[1]},Ui.prototype.intersects=function(u){for(var p=[[this.min[0],this.min[1],0,1],[this.max[0],this.min[1],0,1],[this.max[0],this.max[1],0,1],[this.min[0],this.max[1],0,1]],l=!0,g=0;g<u.planes.length;g++){for(var E=u.planes[g],P=0,T=0;T<p.length;T++)P+=y.dot$1(E,p[T])>=0;if(0===P)return 0;P!==p.length&&(l=!1)}if(l)return 2;for(var k=0;k<3;k++){for(var q=Number.MAX_VALUE,H=-Number.MAX_VALUE,ut=0;ut<u.points.length;ut++){var dt=u.points[ut][k]-this.min[k];q=Math.min(q,dt),H=Math.max(H,dt)}if(H<0||q>this.max[k]-this.min[k])return 0}return 1};var bo=function(u,p,l,g){if(void 0===u&&(u=0),void 0===p&&(p=0),void 0===l&&(l=0),void 0===g&&(g=0),isNaN(u)||u<0||isNaN(p)||p<0||isNaN(l)||l<0||isNaN(g)||g<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=u,this.bottom=p,this.left=l,this.right=g};bo.prototype.interpolate=function(u,p,l){return null!=p.top&&null!=u.top&&(this.top=y.number(u.top,p.top,l)),null!=p.bottom&&null!=u.bottom&&(this.bottom=y.number(u.bottom,p.bottom,l)),null!=p.left&&null!=u.left&&(this.left=y.number(u.left,p.left,l)),null!=p.right&&null!=u.right&&(this.right=y.number(u.right,p.right,l)),this},bo.prototype.getCenter=function(u,p){var l=y.clamp((this.left+u-this.right)/2,0,u),g=y.clamp((this.top+p-this.bottom)/2,0,p);return new y.Point(l,g)},bo.prototype.equals=function(u){return this.top===u.top&&this.bottom===u.bottom&&this.left===u.left&&this.right===u.right},bo.prototype.clone=function(){return new bo(this.top,this.bottom,this.left,this.right)},bo.prototype.toJSON=function(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}};var gn=function(u,p,l,g,E){this.tileSize=512,this.maxValidLatitude=85.051129,this._renderWorldCopies=void 0===E||E,this._minZoom=u||0,this._maxZoom=p||22,this._minPitch=null==l?0:l,this._maxPitch=null==g?60:g,this.setMaxBounds(),this.width=0,this.height=0,this._center=new y.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new bo,this._posMatrixCache={},this._alignedPosMatrixCache={}},Rn={minZoom:{configurable:!0},maxZoom:{configurable:!0},minPitch:{configurable:!0},maxPitch:{configurable:!0},renderWorldCopies:{configurable:!0},worldSize:{configurable:!0},centerOffset:{configurable:!0},size:{configurable:!0},bearing:{configurable:!0},pitch:{configurable:!0},fov:{configurable:!0},zoom:{configurable:!0},center:{configurable:!0},padding:{configurable:!0},centerPoint:{configurable:!0},unmodified:{configurable:!0},point:{configurable:!0}};gn.prototype.clone=function(){var u=new gn(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return u.tileSize=this.tileSize,u.latRange=this.latRange,u.width=this.width,u.height=this.height,u._center=this._center,u.zoom=this.zoom,u.angle=this.angle,u._fov=this._fov,u._pitch=this._pitch,u._unmodified=this._unmodified,u._edgeInsets=this._edgeInsets.clone(),u._calcMatrices(),u},Rn.minZoom.get=function(){return this._minZoom},Rn.minZoom.set=function(u){this._minZoom!==u&&(this._minZoom=u,this.zoom=Math.max(this.zoom,u))},Rn.maxZoom.get=function(){return this._maxZoom},Rn.maxZoom.set=function(u){this._maxZoom!==u&&(this._maxZoom=u,this.zoom=Math.min(this.zoom,u))},Rn.minPitch.get=function(){return this._minPitch},Rn.minPitch.set=function(u){this._minPitch!==u&&(this._minPitch=u,this.pitch=Math.max(this.pitch,u))},Rn.maxPitch.get=function(){return this._maxPitch},Rn.maxPitch.set=function(u){this._maxPitch!==u&&(this._maxPitch=u,this.pitch=Math.min(this.pitch,u))},Rn.renderWorldCopies.get=function(){return this._renderWorldCopies},Rn.renderWorldCopies.set=function(u){void 0===u?u=!0:null===u&&(u=!1),this._renderWorldCopies=u},Rn.worldSize.get=function(){return this.tileSize*this.scale},Rn.centerOffset.get=function(){return this.centerPoint._sub(this.size._div(2))},Rn.size.get=function(){return new y.Point(this.width,this.height)},Rn.bearing.get=function(){return-this.angle/Math.PI*180},Rn.bearing.set=function(u){var p=-y.wrap(u,-180,180)*Math.PI/180;this.angle!==p&&(this._unmodified=!1,this.angle=p,this._calcMatrices(),this.rotationMatrix=y.create$2(),y.rotate(this.rotationMatrix,this.rotationMatrix,this.angle))},Rn.pitch.get=function(){return this._pitch/Math.PI*180},Rn.pitch.set=function(u){var p=y.clamp(u,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==p&&(this._unmodified=!1,this._pitch=p,this._calcMatrices())},Rn.fov.get=function(){return this._fov/Math.PI*180},Rn.fov.set=function(u){u=Math.max(.01,Math.min(60,u)),this._fov!==u&&(this._unmodified=!1,this._fov=u/180*Math.PI,this._calcMatrices())},Rn.zoom.get=function(){return this._zoom},Rn.zoom.set=function(u){var p=Math.min(Math.max(u,this.minZoom),this.maxZoom);this._zoom!==p&&(this._unmodified=!1,this._zoom=p,this.scale=this.zoomScale(p),this.tileZoom=Math.floor(p),this.zoomFraction=p-this.tileZoom,this._constrain(),this._calcMatrices())},Rn.center.get=function(){return this._center},Rn.center.set=function(u){u.lat===this._center.lat&&u.lng===this._center.lng||(this._unmodified=!1,this._center=u,this._constrain(),this._calcMatrices())},Rn.padding.get=function(){return this._edgeInsets.toJSON()},Rn.padding.set=function(u){this._edgeInsets.equals(u)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,u,1),this._calcMatrices())},Rn.centerPoint.get=function(){return this._edgeInsets.getCenter(this.width,this.height)},gn.prototype.isPaddingEqual=function(u){return this._edgeInsets.equals(u)},gn.prototype.interpolatePadding=function(u,p,l){this._unmodified=!1,this._edgeInsets.interpolate(u,p,l),this._constrain(),this._calcMatrices()},gn.prototype.coveringZoomLevel=function(u){var p=(u.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/u.tileSize));return Math.max(0,p)},gn.prototype.getVisibleUnwrappedCoordinates=function(u){var p=[new y.UnwrappedTileID(0,u)];if(this._renderWorldCopies)for(var l=this.pointCoordinate(new y.Point(0,0)),g=this.pointCoordinate(new y.Point(this.width,0)),E=this.pointCoordinate(new y.Point(this.width,this.height)),P=this.pointCoordinate(new y.Point(0,this.height)),T=Math.floor(Math.min(l.x,g.x,E.x,P.x)),k=Math.floor(Math.max(l.x,g.x,E.x,P.x)),q=T-1;q<=k+1;q++)0!==q&&p.push(new y.UnwrappedTileID(q,u));return p},gn.prototype.coveringTiles=function(u){var p=this.coveringZoomLevel(u),l=p;if(void 0!==u.minzoom&&p<u.minzoom)return[];void 0!==u.maxzoom&&p>u.maxzoom&&(p=u.maxzoom);var g=y.MercatorCoordinate.fromLngLat(this.center),E=Math.pow(2,p),P=[E*g.x,E*g.y,0],T=os.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,p),k=u.minzoom||0;this.pitch<=60&&this._edgeInsets.top<.1&&(k=p);var q=function(Ne){return{aabb:new Ui([Ne*E,0,0],[(Ne+1)*E,E,0]),zoom:0,x:0,y:0,wrap:Ne,fullyVisible:!1}},H=[],ut=[],dt=p,lt=u.reparseOverscaled?l:p;if(this._renderWorldCopies)for(var zt=1;zt<=3;zt++)H.push(q(-zt)),H.push(q(zt));for(H.push(q(0));H.length>0;){var Rt=H.pop(),jt=Rt.x,Dt=Rt.y,qt=Rt.fullyVisible;if(!qt){var ee=Rt.aabb.intersects(T);if(0===ee)continue;qt=2===ee}var oe=Rt.aabb.distanceX(P),Se=Rt.aabb.distanceY(P),ge=Math.max(Math.abs(oe),Math.abs(Se));if(Rt.zoom===dt||ge>3+(1<<dt-Rt.zoom)-2&&Rt.zoom>=k)ut.push({tileID:new y.OverscaledTileID(Rt.zoom===dt?lt:Rt.zoom,Rt.wrap,Rt.zoom,jt,Dt),distanceSq:y.sqrLen([P[0]-.5-jt,P[1]-.5-Dt])});else for(var Ce=0;Ce<4;Ce++){var be=(jt<<1)+Ce%2,Ue=(Dt<<1)+(Ce>>1);H.push({aabb:Rt.aabb.quadrant(Ce),zoom:Rt.zoom+1,x:be,y:Ue,wrap:Rt.wrap,fullyVisible:qt})}}return ut.sort(function(Ne,Ve){return Ne.distanceSq-Ve.distanceSq}).map(function(Ne){return Ne.tileID})},gn.prototype.resize=function(u,p){this.width=u,this.height=p,this.pixelsToGLUnits=[2/u,-2/p],this._constrain(),this._calcMatrices()},Rn.unmodified.get=function(){return this._unmodified},gn.prototype.zoomScale=function(u){return Math.pow(2,u)},gn.prototype.scaleZoom=function(u){return Math.log(u)/Math.LN2},gn.prototype.project=function(u){var p=y.clamp(u.lat,-this.maxValidLatitude,this.maxValidLatitude);return new y.Point(y.mercatorXfromLng(u.lng)*this.worldSize,y.mercatorYfromLat(p)*this.worldSize)},gn.prototype.unproject=function(u){return new y.MercatorCoordinate(u.x/this.worldSize,u.y/this.worldSize).toLngLat()},Rn.point.get=function(){return this.project(this.center)},gn.prototype.setLocationAtPoint=function(u,p){var l=this.pointCoordinate(p),g=this.pointCoordinate(this.centerPoint),E=this.locationCoordinate(u),P=new y.MercatorCoordinate(E.x-(l.x-g.x),E.y-(l.y-g.y));this.center=this.coordinateLocation(P),this._renderWorldCopies&&(this.center=this.center.wrap())},gn.prototype.locationPoint=function(u){return this.coordinatePoint(this.locationCoordinate(u))},gn.prototype.pointLocation=function(u){return this.coordinateLocation(this.pointCoordinate(u))},gn.prototype.locationCoordinate=function(u){return y.MercatorCoordinate.fromLngLat(u)},gn.prototype.coordinateLocation=function(u){return u.toLngLat()},gn.prototype.pointCoordinate=function(u){var p=[u.x,u.y,0,1],l=[u.x,u.y,1,1];y.transformMat4(p,p,this.pixelMatrixInverse),y.transformMat4(l,l,this.pixelMatrixInverse);var g=p[3],E=l[3],P=p[1]/g,T=l[1]/E,k=p[2]/g,q=l[2]/E,H=k===q?0:(0-k)/(q-k);return new y.MercatorCoordinate(y.number(p[0]/g,l[0]/E,H)/this.worldSize,y.number(P,T,H)/this.worldSize)},gn.prototype.coordinatePoint=function(u){var p=[u.x*this.worldSize,u.y*this.worldSize,0,1];return y.transformMat4(p,p,this.pixelMatrix),new y.Point(p[0]/p[3],p[1]/p[3])},gn.prototype.getBounds=function(){return(new y.LngLatBounds).extend(this.pointLocation(new y.Point(0,0))).extend(this.pointLocation(new y.Point(this.width,0))).extend(this.pointLocation(new y.Point(this.width,this.height))).extend(this.pointLocation(new y.Point(0,this.height)))},gn.prototype.getMaxBounds=function(){return this.latRange&&2===this.latRange.length&&this.lngRange&&2===this.lngRange.length?new y.LngLatBounds([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null},gn.prototype.setMaxBounds=function(u){u?(this.lngRange=[u.getWest(),u.getEast()],this.latRange=[u.getSouth(),u.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])},gn.prototype.calculatePosMatrix=function(u,p){void 0===p&&(p=!1);var l=u.key,g=p?this._alignedPosMatrixCache:this._posMatrixCache;if(g[l])return g[l];var E=u.canonical,P=this.worldSize/this.zoomScale(E.z),T=E.x+Math.pow(2,E.z)*u.wrap,k=y.identity(new Float64Array(16));return y.translate(k,k,[T*P,E.y*P,0]),y.scale(k,k,[P/y.EXTENT,P/y.EXTENT,1]),y.multiply(k,p?this.alignedProjMatrix:this.projMatrix,k),g[l]=new Float32Array(k),g[l]},gn.prototype.customLayerMatrix=function(){return this.mercatorMatrix.slice()},gn.prototype._constrain=function(){if(this.center&&this.width&&this.height&&!this._constraining){this._constraining=!0;var u,p,l,g,E=-90,P=90,T=-180,k=180,q=this.size,H=this._unmodified;if(this.latRange){var ut=this.latRange;E=y.mercatorYfromLat(ut[1])*this.worldSize,u=(P=y.mercatorYfromLat(ut[0])*this.worldSize)-E<q.y?q.y/(P-E):0}if(this.lngRange){var dt=this.lngRange;T=y.mercatorXfromLng(dt[0])*this.worldSize,p=(k=y.mercatorXfromLng(dt[1])*this.worldSize)-T<q.x?q.x/(k-T):0}var lt=this.point,zt=Math.max(p||0,u||0);if(zt)return this.center=this.unproject(new y.Point(p?(k+T)/2:lt.x,u?(P+E)/2:lt.y)),this.zoom+=this.scaleZoom(zt),this._unmodified=H,void(this._constraining=!1);if(this.latRange){var Rt=lt.y,jt=q.y/2;Rt-jt<E&&(g=E+jt),Rt+jt>P&&(g=P-jt)}if(this.lngRange){var Dt=lt.x,qt=q.x/2;Dt-qt<T&&(l=T+qt),Dt+qt>k&&(l=k-qt)}void 0===l&&void 0===g||(this.center=this.unproject(new y.Point(void 0!==l?l:lt.x,void 0!==g?g:lt.y))),this._unmodified=H,this._constraining=!1}},gn.prototype._calcMatrices=function(){if(this.height){var u=this.centerOffset;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height;var p=Math.PI/2+this._pitch,l=this._fov*(.5+u.y/this.height),g=Math.sin(l)*this.cameraToCenterDistance/Math.sin(y.clamp(Math.PI-p-l,.01,Math.PI-.01)),E=this.point,P=E.x,T=E.y,k=1.01*(Math.cos(Math.PI/2-this._pitch)*g+this.cameraToCenterDistance),q=this.height/50,H=new Float64Array(16);y.perspective(H,this._fov,this.width/this.height,q,k),H[8]=2*-u.x/this.width,H[9]=2*u.y/this.height,y.scale(H,H,[1,-1,1]),y.translate(H,H,[0,0,-this.cameraToCenterDistance]),y.rotateX(H,H,this._pitch),y.rotateZ(H,H,this.angle),y.translate(H,H,[-P,-T,0]),this.mercatorMatrix=y.scale([],H,[this.worldSize,this.worldSize,this.worldSize]),y.scale(H,H,[1,1,y.mercatorZfromAltitude(1,this.center.lat)*this.worldSize,1]),this.projMatrix=H,this.invProjMatrix=y.invert([],this.projMatrix);var ut=this.width%2/2,dt=this.height%2/2,lt=Math.cos(this.angle),zt=Math.sin(this.angle),Rt=P-Math.round(P)+lt*ut+zt*dt,jt=T-Math.round(T)+lt*dt+zt*ut,Dt=new Float64Array(H);if(y.translate(Dt,Dt,[Rt>.5?Rt-1:Rt,jt>.5?jt-1:jt,0]),this.alignedProjMatrix=Dt,H=y.create(),y.scale(H,H,[this.width/2,-this.height/2,1]),y.translate(H,H,[1,-1,0]),this.labelPlaneMatrix=H,H=y.create(),y.scale(H,H,[1,-1,1]),y.translate(H,H,[-1,-1,0]),y.scale(H,H,[2/this.width,2/this.height,1]),this.glCoordMatrix=H,this.pixelMatrix=y.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),!(H=y.invert(new Float64Array(16),this.pixelMatrix)))throw new Error("failed to invert matrix");this.pixelMatrixInverse=H,this._posMatrixCache={},this._alignedPosMatrixCache={}}},gn.prototype.maxPitchScaleFactor=function(){if(!this.pixelMatrixInverse)return 1;var u=this.pointCoordinate(new y.Point(0,0)),p=[u.x*this.worldSize,u.y*this.worldSize,0,1];return y.transformMat4(p,p,this.pixelMatrix)[3]/this.cameraToCenterDistance},gn.prototype.getCameraPoint=function(){var u=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new y.Point(0,u))},gn.prototype.getCameraQueryGeometry=function(u){var p=this.getCameraPoint();if(1===u.length)return[u[0],p];for(var l=p.x,g=p.y,E=p.x,P=p.y,T=0,k=u;T<k.length;T+=1){var q=k[T];l=Math.min(l,q.x),g=Math.min(g,q.y),E=Math.max(E,q.x),P=Math.max(P,q.y)}return[new y.Point(l,g),new y.Point(E,g),new y.Point(E,P),new y.Point(l,P),new y.Point(l,g)]},Object.defineProperties(gn.prototype,Rn);var Ba=function(u){var p,l,g,E;this._hashName=u&&encodeURIComponent(u),y.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=(p=this._updateHashUnthrottled.bind(this),l=!1,g=null,E=function(){g=null,l&&(p(),g=setTimeout(E,300),l=!1)},function(){return l=!0,g||E(),g})};Ba.prototype.addTo=function(u){return this._map=u,y.window.addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this},Ba.prototype.remove=function(){return y.window.removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this},Ba.prototype.getHashString=function(u){var p=this._map.getCenter(),l=Math.round(100*this._map.getZoom())/100,g=Math.ceil((l*Math.LN2+Math.log(512/360/.5))/Math.LN10),E=Math.pow(10,g),P=Math.round(p.lng*E)/E,T=Math.round(p.lat*E)/E,k=this._map.getBearing(),q=this._map.getPitch(),H="";if(H+=u?"/"+P+"/"+T+"/"+l:l+"/"+T+"/"+P,(k||q)&&(H+="/"+Math.round(10*k)/10),q&&(H+="/"+Math.round(q)),this._hashName){var ut=this._hashName,dt=!1,lt=y.window.location.hash.slice(1).split("&").map(function(zt){var Rt=zt.split("=")[0];return Rt===ut?(dt=!0,Rt+"="+H):zt}).filter(function(zt){return zt});return dt||lt.push(ut+"="+H),"#"+lt.join("&")}return"#"+H},Ba.prototype._getCurrentHash=function(){var u,p=this,l=y.window.location.hash.replace("#","");return this._hashName?(l.split("&").map(function(g){return g.split("=")}).forEach(function(g){g[0]===p._hashName&&(u=g)}),(u&&u[1]||"").split("/")):l.split("/")},Ba.prototype._onHashChange=function(){var u=this._getCurrentHash();if(u.length>=3&&!u.some(function(l){return isNaN(l)})){var p=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(u[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+u[2],+u[1]],zoom:+u[0],bearing:p,pitch:+(u[4]||0)}),!0}return!1},Ba.prototype._updateHashUnthrottled=function(){var u=y.window.location.href.replace(/(#.+)?$/,this.getHashString());try{y.window.history.replaceState(y.window.history.state,null,u)}catch(p){}};var Pa={linearity:.3,easing:y.bezier(0,0,.3,1)},Ao=y.extend({deceleration:2500,maxSpeed:1400},Pa),ro=y.extend({deceleration:20,maxSpeed:1400},Pa),Ma=y.extend({deceleration:1e3,maxSpeed:360},Pa),Ja=y.extend({deceleration:1e3,maxSpeed:90},Pa),Cu=function(u){this._map=u,this.clear()};function Ls(u,p){(!u.duration||u.duration<p.duration)&&(u.duration=p.duration,u.easing=p.easing)}function as(u,p,l){var g=l.maxSpeed,E=l.linearity,P=l.deceleration,T=y.clamp(u*E/(p/1e3),-g,g),k=Math.abs(T)/(P*E);return{easing:l.easing,duration:1e3*k,amount:T*(k/2)}}Cu.prototype.clear=function(){this._inertiaBuffer=[]},Cu.prototype.record=function(u){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:y.browser.now(),settings:u})},Cu.prototype._drainInertiaBuffer=function(){for(var u=this._inertiaBuffer,p=y.browser.now();u.length>0&&p-u[0].time>160;)u.shift()},Cu.prototype._onMoveEnd=function(u){if(this._drainInertiaBuffer(),!(this._inertiaBuffer.length<2)){for(var p={zoom:0,bearing:0,pitch:0,pan:new y.Point(0,0),pinchAround:void 0,around:void 0},l=0,g=this._inertiaBuffer;l<g.length;l+=1){var E=g[l].settings;p.zoom+=E.zoomDelta||0,p.bearing+=E.bearingDelta||0,p.pitch+=E.pitchDelta||0,E.panDelta&&p.pan._add(E.panDelta),E.around&&(p.around=E.around),E.pinchAround&&(p.pinchAround=E.pinchAround)}var P=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,T={};if(p.pan.mag()){var k=as(p.pan.mag(),P,y.extend({},Ao,u||{}));T.offset=p.pan.mult(k.amount/p.pan.mag()),T.center=this._map.transform.center,Ls(T,k)}if(p.zoom){var q=as(p.zoom,P,ro);T.zoom=this._map.transform.zoom+q.amount,Ls(T,q)}if(p.bearing){var H=as(p.bearing,P,Ma);T.bearing=this._map.transform.bearing+y.clamp(H.amount,-179,179),Ls(T,H)}if(p.pitch){var ut=as(p.pitch,P,Ja);T.pitch=this._map.transform.pitch+ut.amount,Ls(T,ut)}if(T.zoom||T.bearing){var dt=void 0===p.pinchAround?p.around:p.pinchAround;T.around=dt?this._map.unproject(dt):this._map.getCenter()}return this.clear(),y.extend(T,{noMoveStart:!0})}};var mi=function(u){function p(g,E,P,T){void 0===T&&(T={});var k=ft.mousePos(E.getCanvasContainer(),P),q=E.unproject(k);u.call(this,g,y.extend({point:k,lngLat:q,originalEvent:P},T)),this._defaultPrevented=!1,this.target=E}u&&(p.__proto__=u),(p.prototype=Object.create(u&&u.prototype)).constructor=p;var l={defaultPrevented:{configurable:!0}};return p.prototype.preventDefault=function(){this._defaultPrevented=!0},l.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(p.prototype,l),p}(y.Event),Ta=function(u){function p(g,E,P){var T="touchend"===g?P.changedTouches:P.touches,k=ft.touchPos(E.getCanvasContainer(),T),q=k.map(function(dt){return E.unproject(dt)}),H=k.reduce(function(dt,lt,zt,Rt){return dt.add(lt.div(Rt.length))},new y.Point(0,0)),ut=E.unproject(H);u.call(this,g,{points:k,point:H,lngLats:q,lngLat:ut,originalEvent:P}),this._defaultPrevented=!1}u&&(p.__proto__=u),(p.prototype=Object.create(u&&u.prototype)).constructor=p;var l={defaultPrevented:{configurable:!0}};return p.prototype.preventDefault=function(){this._defaultPrevented=!0},l.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(p.prototype,l),p}(y.Event),wo=function(u){function p(g,E,P){u.call(this,g,{originalEvent:P}),this._defaultPrevented=!1}u&&(p.__proto__=u),(p.prototype=Object.create(u&&u.prototype)).constructor=p;var l={defaultPrevented:{configurable:!0}};return p.prototype.preventDefault=function(){this._defaultPrevented=!0},l.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(p.prototype,l),p}(y.Event),Eo=function(u,p){this._map=u,this._clickTolerance=p.clickTolerance};Eo.prototype.reset=function(){delete this._mousedownPos},Eo.prototype.wheel=function(u){return this._firePreventable(new wo(u.type,this._map,u))},Eo.prototype.mousedown=function(u,p){return this._mousedownPos=p,this._firePreventable(new mi(u.type,this._map,u))},Eo.prototype.mouseup=function(u){this._map.fire(new mi(u.type,this._map,u))},Eo.prototype.click=function(u,p){this._mousedownPos&&this._mousedownPos.dist(p)>=this._clickTolerance||this._map.fire(new mi(u.type,this._map,u))},Eo.prototype.dblclick=function(u){return this._firePreventable(new mi(u.type,this._map,u))},Eo.prototype.mouseover=function(u){this._map.fire(new mi(u.type,this._map,u))},Eo.prototype.mouseout=function(u){this._map.fire(new mi(u.type,this._map,u))},Eo.prototype.touchstart=function(u){return this._firePreventable(new Ta(u.type,this._map,u))},Eo.prototype.touchmove=function(u){this._map.fire(new Ta(u.type,this._map,u))},Eo.prototype.touchend=function(u){this._map.fire(new Ta(u.type,this._map,u))},Eo.prototype.touchcancel=function(u){this._map.fire(new Ta(u.type,this._map,u))},Eo.prototype._firePreventable=function(u){if(this._map.fire(u),u.defaultPrevented)return{}},Eo.prototype.isEnabled=function(){return!0},Eo.prototype.isActive=function(){return!1},Eo.prototype.enable=function(){},Eo.prototype.disable=function(){};var Hi=function(u){this._map=u};Hi.prototype.reset=function(){this._delayContextMenu=!1,delete this._contextMenuEvent},Hi.prototype.mousemove=function(u){this._map.fire(new mi(u.type,this._map,u))},Hi.prototype.mousedown=function(){this._delayContextMenu=!0},Hi.prototype.mouseup=function(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new mi("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)},Hi.prototype.contextmenu=function(u){this._delayContextMenu?this._contextMenuEvent=u:this._map.fire(new mi(u.type,this._map,u)),this._map.listens("contextmenu")&&u.preventDefault()},Hi.prototype.isEnabled=function(){return!0},Hi.prototype.isActive=function(){return!1},Hi.prototype.enable=function(){},Hi.prototype.disable=function(){};var nr=function(u,p){this._map=u,this._el=u.getCanvasContainer(),this._container=u.getContainer(),this._clickTolerance=p.clickTolerance||1};function ia(u,p){for(var l={},g=0;g<u.length;g++)l[u[g].identifier]=p[g];return l}nr.prototype.isEnabled=function(){return!!this._enabled},nr.prototype.isActive=function(){return!!this._active},nr.prototype.enable=function(){this.isEnabled()||(this._enabled=!0)},nr.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},nr.prototype.mousedown=function(u,p){this.isEnabled()&&u.shiftKey&&0===u.button&&(ft.disableDrag(),this._startPos=this._lastPos=p,this._active=!0)},nr.prototype.mousemoveWindow=function(u,p){if(this._active){var l=p;if(!(this._lastPos.equals(l)||!this._box&&l.dist(this._startPos)<this._clickTolerance)){var g=this._startPos;this._lastPos=l,this._box||(this._box=ft.create("div","maplibregl-boxzoom mapboxgl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair","mapboxgl-crosshair"),this._fireEvent("boxzoomstart",u));var E=Math.min(g.x,l.x),P=Math.max(g.x,l.x),T=Math.min(g.y,l.y),k=Math.max(g.y,l.y);ft.setTransform(this._box,"translate("+E+"px,"+T+"px)"),this._box.style.width=P-E+"px",this._box.style.height=k-T+"px"}}},nr.prototype.mouseupWindow=function(u,p){var l=this;if(this._active&&0===u.button){var g=this._startPos,E=p;if(this.reset(),ft.suppressClick(),g.x!==E.x||g.y!==E.y)return this._map.fire(new y.Event("boxzoomend",{originalEvent:u})),{cameraAnimation:function(P){return P.fitScreenCoordinates(g,E,l._map.getBearing(),{linear:!0})}};this._fireEvent("boxzoomcancel",u)}},nr.prototype.keydown=function(u){this._active&&27===u.keyCode&&(this.reset(),this._fireEvent("boxzoomcancel",u))},nr.prototype.reset=function(){this._active=!1,this._container.classList.remove("maplibregl-crosshair","mapboxgl-crosshair"),this._box&&(ft.remove(this._box),this._box=null),ft.enableDrag(),delete this._startPos,delete this._lastPos},nr.prototype._fireEvent=function(u,p){return this._map.fire(new y.Event(u,{originalEvent:p}))};var Ka=function(u){this.reset(),this.numTouches=u.numTouches};Ka.prototype.reset=function(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1},Ka.prototype.touchstart=function(u,p,l){(this.centroid||l.length>this.numTouches)&&(this.aborted=!0),this.aborted||(void 0===this.startTime&&(this.startTime=u.timeStamp),l.length===this.numTouches&&(this.centroid=function(g){for(var E=new y.Point(0,0),P=0,T=g;P<T.length;P+=1)E._add(T[P]);return E.div(g.length)}(p),this.touches=ia(l,p)))},Ka.prototype.touchmove=function(u,p,l){if(!this.aborted&&this.centroid){var g=ia(l,p);for(var E in this.touches){var P=g[E];(!P||P.dist(this.touches[E])>30)&&(this.aborted=!0)}}},Ka.prototype.touchend=function(u,p,l){if((!this.centroid||u.timeStamp-this.startTime>500)&&(this.aborted=!0),0===l.length){var g=!this.aborted&&this.centroid;if(this.reset(),g)return g}};var Aa=function(u){this.singleTap=new Ka(u),this.numTaps=u.numTaps,this.reset()};Aa.prototype.reset=function(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()},Aa.prototype.touchstart=function(u,p,l){this.singleTap.touchstart(u,p,l)},Aa.prototype.touchmove=function(u,p,l){this.singleTap.touchmove(u,p,l)},Aa.prototype.touchend=function(u,p,l){var g=this.singleTap.touchend(u,p,l);if(g){var E=u.timeStamp-this.lastTime<500,P=!this.lastTap||this.lastTap.dist(g)<30;if(E&&P||this.reset(),this.count++,this.lastTime=u.timeStamp,this.lastTap=g,this.count===this.numTaps)return this.reset(),g}};var qi=function(){this._zoomIn=new Aa({numTouches:1,numTaps:2}),this._zoomOut=new Aa({numTouches:2,numTaps:1}),this.reset()};qi.prototype.reset=function(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()},qi.prototype.touchstart=function(u,p,l){this._zoomIn.touchstart(u,p,l),this._zoomOut.touchstart(u,p,l)},qi.prototype.touchmove=function(u,p,l){this._zoomIn.touchmove(u,p,l),this._zoomOut.touchmove(u,p,l)},qi.prototype.touchend=function(u,p,l){var g=this,E=this._zoomIn.touchend(u,p,l),P=this._zoomOut.touchend(u,p,l);return E?(this._active=!0,u.preventDefault(),setTimeout(function(){return g.reset()},0),{cameraAnimation:function(T){return T.easeTo({duration:300,zoom:T.getZoom()+1,around:T.unproject(E)},{originalEvent:u})}}):P?(this._active=!0,u.preventDefault(),setTimeout(function(){return g.reset()},0),{cameraAnimation:function(T){return T.easeTo({duration:300,zoom:T.getZoom()-1,around:T.unproject(P)},{originalEvent:u})}}):void 0},qi.prototype.touchcancel=function(){this.reset()},qi.prototype.enable=function(){this._enabled=!0},qi.prototype.disable=function(){this._enabled=!1,this.reset()},qi.prototype.isEnabled=function(){return this._enabled},qi.prototype.isActive=function(){return this._active};var bs={0:1,2:2},Si=function(u){this.reset(),this._clickTolerance=u.clickTolerance||1};Si.prototype.reset=function(){this._active=!1,this._moved=!1,delete this._lastPoint,delete this._eventButton},Si.prototype._correctButton=function(u,p){return!1},Si.prototype._move=function(u,p){return{}},Si.prototype.mousedown=function(u,p){if(!this._lastPoint){var l=ft.mouseButton(u);this._correctButton(u,l)&&(this._lastPoint=p,this._eventButton=l)}},Si.prototype.mousemoveWindow=function(u,p){var g,P,l=this._lastPoint;if(l)if(u.preventDefault(),P=bs[this._eventButton],void 0===(g=u).buttons||(g.buttons&P)!==P)this.reset();else if(this._moved||!(p.dist(l)<this._clickTolerance))return this._moved=!0,this._lastPoint=p,this._move(l,p)},Si.prototype.mouseupWindow=function(u){this._lastPoint&&ft.mouseButton(u)===this._eventButton&&(this._moved&&ft.suppressClick(),this.reset())},Si.prototype.enable=function(){this._enabled=!0},Si.prototype.disable=function(){this._enabled=!1,this.reset()},Si.prototype.isEnabled=function(){return this._enabled},Si.prototype.isActive=function(){return this._active};var gr=function(u){function p(){u.apply(this,arguments)}return u&&(p.__proto__=u),(p.prototype=Object.create(u&&u.prototype)).constructor=p,p.prototype.mousedown=function(l,g){u.prototype.mousedown.call(this,l,g),this._lastPoint&&(this._active=!0)},p.prototype._correctButton=function(l,g){return 0===g&&!l.ctrlKey},p.prototype._move=function(l,g){return{around:g,panDelta:g.sub(l)}},p}(Si),ki=function(u){function p(){u.apply(this,arguments)}return u&&(p.__proto__=u),(p.prototype=Object.create(u&&u.prototype)).constructor=p,p.prototype._correctButton=function(l,g){return 0===g&&l.ctrlKey||2===g},p.prototype._move=function(l,g){var E=.8*(g.x-l.x);if(E)return this._active=!0,{bearingDelta:E}},p.prototype.contextmenu=function(l){l.preventDefault()},p}(Si),Ju=function(u){function p(){u.apply(this,arguments)}return u&&(p.__proto__=u),(p.prototype=Object.create(u&&u.prototype)).constructor=p,p.prototype._correctButton=function(l,g){return 0===g&&l.ctrlKey||2===g},p.prototype._move=function(l,g){var E=-.5*(g.y-l.y);if(E)return this._active=!0,{pitchDelta:E}},p.prototype.contextmenu=function(l){l.preventDefault()},p}(Si),$a=function(u){this._minTouches=1,this._clickTolerance=u.clickTolerance||1,this.reset()};$a.prototype.reset=function(){this._active=!1,this._touches={},this._sum=new y.Point(0,0)},$a.prototype.touchstart=function(u,p,l){return this._calculateTransform(u,p,l)},$a.prototype.touchmove=function(u,p,l){if(this._active&&!(l.length<this._minTouches))return u.preventDefault(),this._calculateTransform(u,p,l)},$a.prototype.touchend=function(u,p,l){this._calculateTransform(u,p,l),this._active&&l.length<this._minTouches&&this.reset()},$a.prototype.touchcancel=function(){this.reset()},$a.prototype._calculateTransform=function(u,p,l){l.length>0&&(this._active=!0);var g=ia(l,p),E=new y.Point(0,0),P=new y.Point(0,0),T=0;for(var k in g){var q=g[k],H=this._touches[k];H&&(E._add(q),P._add(q.sub(H)),T++,g[k]=q)}if(this._touches=g,!(T<this._minTouches)&&P.mag()){var ut=P.div(T);if(this._sum._add(ut),!(this._sum.mag()<this._clickTolerance))return{around:E.div(T),panDelta:ut}}},$a.prototype.enable=function(){this._enabled=!0},$a.prototype.disable=function(){this._enabled=!1,this.reset()},$a.prototype.isEnabled=function(){return this._enabled},$a.prototype.isActive=function(){return this._active};var yi=function(){this.reset()};function ws(u,p,l){for(var g=0;g<u.length;g++)if(u[g].identifier===l)return p[g]}function xl(u,p){return Math.log(u/p)/Math.LN2}yi.prototype.reset=function(){this._active=!1,delete this._firstTwoTouches},yi.prototype._start=function(u){},yi.prototype._move=function(u,p,l){return{}},yi.prototype.touchstart=function(u,p,l){this._firstTwoTouches||l.length<2||(this._firstTwoTouches=[l[0].identifier,l[1].identifier],this._start([p[0],p[1]]))},yi.prototype.touchmove=function(u,p,l){if(this._firstTwoTouches){u.preventDefault();var g=this._firstTwoTouches,E=g[1],P=ws(l,p,g[0]),T=ws(l,p,E);if(P&&T){var k=this._aroundCenter?null:P.add(T).div(2);return this._move([P,T],k,u)}}},yi.prototype.touchend=function(u,p,l){if(this._firstTwoTouches){var g=this._firstTwoTouches,E=g[1],P=ws(l,p,g[0]),T=ws(l,p,E);P&&T||(this._active&&ft.suppressClick(),this.reset())}},yi.prototype.touchcancel=function(){this.reset()},yi.prototype.enable=function(u){this._enabled=!0,this._aroundCenter=!!u&&"center"===u.around},yi.prototype.disable=function(){this._enabled=!1,this.reset()},yi.prototype.isEnabled=function(){return this._enabled},yi.prototype.isActive=function(){return this._active};var eu=function(u){function p(){u.apply(this,arguments)}return u&&(p.__proto__=u),(p.prototype=Object.create(u&&u.prototype)).constructor=p,p.prototype.reset=function(){u.prototype.reset.call(this),delete this._distance,delete this._startDistance},p.prototype._start=function(l){this._startDistance=this._distance=l[0].dist(l[1])},p.prototype._move=function(l,g){var E=this._distance;if(this._distance=l[0].dist(l[1]),this._active||!(Math.abs(xl(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:xl(this._distance,E),pinchAround:g}},p}(yi);function no(u,p){return 180*u.angleWith(p)/Math.PI}var zi=function(u){function p(){u.apply(this,arguments)}return u&&(p.__proto__=u),(p.prototype=Object.create(u&&u.prototype)).constructor=p,p.prototype.reset=function(){u.prototype.reset.call(this),delete this._minDiameter,delete this._startVector,delete this._vector},p.prototype._start=function(l){this._startVector=this._vector=l[0].sub(l[1]),this._minDiameter=l[0].dist(l[1])},p.prototype._move=function(l,g){var E=this._vector;if(this._vector=l[0].sub(l[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:no(this._vector,E),pinchAround:g}},p.prototype._isBelowThreshold=function(l){this._minDiameter=Math.min(this._minDiameter,l.mag());var g=25/(Math.PI*this._minDiameter)*360,E=no(l,this._startVector);return Math.abs(E)<g},p}(yi);function Lo(u){return Math.abs(u.y)>Math.abs(u.x)}var gu=function(u){function p(){u.apply(this,arguments)}return u&&(p.__proto__=u),(p.prototype=Object.create(u&&u.prototype)).constructor=p,p.prototype.reset=function(){u.prototype.reset.call(this),this._valid=void 0,delete this._firstMove,delete this._lastPoints},p.prototype._start=function(l){this._lastPoints=l,Lo(l[0].sub(l[1]))&&(this._valid=!1)},p.prototype._move=function(l,g,E){var P=l[0].sub(this._lastPoints[0]),T=l[1].sub(this._lastPoints[1]);if(this._valid=this.gestureBeginsVertically(P,T,E.timeStamp),this._valid)return this._lastPoints=l,this._active=!0,{pitchDelta:(P.y+T.y)/2*-.5}},p.prototype.gestureBeginsVertically=function(l,g,E){if(void 0!==this._valid)return this._valid;var P=l.mag()>=2,T=g.mag()>=2;if(P||T){if(!P||!T)return void 0===this._firstMove&&(this._firstMove=E),E-this._firstMove<100&&void 0;var k=l.y>0==g.y>0;return Lo(l)&&Lo(g)&&k}},p}(yi),Ko={panStep:100,bearingStep:15,pitchStep:10},oa=function(){var u=Ko;this._panStep=u.panStep,this._bearingStep=u.bearingStep,this._pitchStep=u.pitchStep,this._rotationDisabled=!1};function qu(u){return u*(2-u)}oa.prototype.reset=function(){this._active=!1},oa.prototype.keydown=function(u){var p=this;if(!(u.altKey||u.ctrlKey||u.metaKey)){var l=0,g=0,E=0,P=0,T=0;switch(u.keyCode){case 61:case 107:case 171:case 187:l=1;break;case 189:case 109:case 173:l=-1;break;case 37:u.shiftKey?g=-1:(u.preventDefault(),P=-1);break;case 39:u.shiftKey?g=1:(u.preventDefault(),P=1);break;case 38:u.shiftKey?E=1:(u.preventDefault(),T=-1);break;case 40:u.shiftKey?E=-1:(u.preventDefault(),T=1);break;default:return}return this._rotationDisabled&&(g=0,E=0),{cameraAnimation:function(k){var q=k.getZoom();k.easeTo({duration:300,easeId:"keyboardHandler",easing:qu,zoom:l?Math.round(q)+l*(u.shiftKey?2:1):q,bearing:k.getBearing()+g*p._bearingStep,pitch:k.getPitch()+E*p._pitchStep,offset:[-P*p._panStep,-T*p._panStep],center:k.getCenter()},{originalEvent:u})}}}},oa.prototype.enable=function(){this._enabled=!0},oa.prototype.disable=function(){this._enabled=!1,this.reset()},oa.prototype.isEnabled=function(){return this._enabled},oa.prototype.isActive=function(){return this._active},oa.prototype.disableRotation=function(){this._rotationDisabled=!0},oa.prototype.enableRotation=function(){this._rotationDisabled=!1};var Sn=function(u,p){this._map=u,this._el=u.getCanvasContainer(),this._handler=p,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=1/450,y.bindAll(["_onTimeout"],this)};Sn.prototype.setZoomRate=function(u){this._defaultZoomRate=u},Sn.prototype.setWheelZoomRate=function(u){this._wheelZoomRate=u},Sn.prototype.isEnabled=function(){return!!this._enabled},Sn.prototype.isActive=function(){return!!this._active||void 0!==this._finishTimeout},Sn.prototype.isZooming=function(){return!!this._zooming},Sn.prototype.enable=function(u){this.isEnabled()||(this._enabled=!0,this._aroundCenter=u&&"center"===u.around)},Sn.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},Sn.prototype.wheel=function(u){if(this.isEnabled()){var p=u.deltaMode===y.window.WheelEvent.DOM_DELTA_LINE?40*u.deltaY:u.deltaY,l=y.browser.now(),g=l-(this._lastWheelEventTime||0);this._lastWheelEventTime=l,0!==p&&p%4.000244140625==0?this._type="wheel":0!==p&&Math.abs(p)<4?this._type="trackpad":g>400?(this._type=null,this._lastValue=p,this._timeout=setTimeout(this._onTimeout,40,u)):this._type||(this._type=Math.abs(g*p)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,p+=this._lastValue)),u.shiftKey&&p&&(p/=4),this._type&&(this._lastWheelEvent=u,this._delta-=p,this._active||this._start(u)),u.preventDefault()}},Sn.prototype._onTimeout=function(u){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(u)},Sn.prototype._start=function(u){if(this._delta){this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);var p=ft.mousePos(this._el,u);this._around=y.LngLat.convert(this._aroundCenter?this._map.getCenter():this._map.unproject(p)),this._aroundPoint=this._map.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}},Sn.prototype.renderFrame=function(){var u=this;if(this._frameId&&(this._frameId=null,this.isActive())){var p=this._map.transform;if(0!==this._delta){var l="wheel"===this._type&&Math.abs(this._delta)>4.000244140625?this._wheelZoomRate:this._defaultZoomRate,g=2/(1+Math.exp(-Math.abs(this._delta*l)));this._delta<0&&0!==g&&(g=1/g);var E="number"==typeof this._targetZoom?p.zoomScale(this._targetZoom):p.scale;this._targetZoom=Math.min(p.maxZoom,Math.max(p.minZoom,p.scaleZoom(E*g))),"wheel"===this._type&&(this._startZoom=p.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}var P,T="number"==typeof this._targetZoom?this._targetZoom:p.zoom,k=this._startZoom,q=this._easing,H=!1;if("wheel"===this._type&&k&&q){var ut=Math.min((y.browser.now()-this._lastWheelEventTime)/200,1),dt=q(ut);P=y.number(k,T,dt),ut<1?this._frameId||(this._frameId=!0):H=!0}else P=T,H=!0;return this._active=!0,H&&(this._active=!1,this._finishTimeout=setTimeout(function(){u._zooming=!1,u._handler._triggerRenderFrame(),delete u._targetZoom,delete u._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!H,zoomDelta:P-p.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}},Sn.prototype._smoothOutEasing=function(u){var p=y.ease;if(this._prevEase){var l=this._prevEase,g=(y.browser.now()-l.start)/l.duration,E=l.easing(g+.01)-l.easing(g),P=.27/Math.sqrt(E*E+1e-4)*.01,T=Math.sqrt(.0729-P*P);p=y.bezier(P,T,.25,1)}return this._prevEase={start:y.browser.now(),duration:u,easing:p},p},Sn.prototype.reset=function(){this._active=!1};var ti=function(u,p){this._clickZoom=u,this._tapZoom=p};ti.prototype.enable=function(){this._clickZoom.enable(),this._tapZoom.enable()},ti.prototype.disable=function(){this._clickZoom.disable(),this._tapZoom.disable()},ti.prototype.isEnabled=function(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()},ti.prototype.isActive=function(){return this._clickZoom.isActive()||this._tapZoom.isActive()};var Ji=function(){this.reset()};Ji.prototype.reset=function(){this._active=!1},Ji.prototype.dblclick=function(u,p){return u.preventDefault(),{cameraAnimation:function(l){l.easeTo({duration:300,zoom:l.getZoom()+(u.shiftKey?-1:1),around:l.unproject(p)},{originalEvent:u})}}},Ji.prototype.enable=function(){this._enabled=!0},Ji.prototype.disable=function(){this._enabled=!1,this.reset()},Ji.prototype.isEnabled=function(){return this._enabled},Ji.prototype.isActive=function(){return this._active};var La=function(){this._tap=new Aa({numTouches:1,numTaps:1}),this.reset()};La.prototype.reset=function(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,this._tap.reset()},La.prototype.touchstart=function(u,p,l){this._swipePoint||(this._tapTime&&u.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?l.length>0&&(this._swipePoint=p[0],this._swipeTouch=l[0].identifier):this._tap.touchstart(u,p,l))},La.prototype.touchmove=function(u,p,l){if(this._tapTime){if(this._swipePoint){if(l[0].identifier!==this._swipeTouch)return;var g=p[0],E=g.y-this._swipePoint.y;return this._swipePoint=g,u.preventDefault(),this._active=!0,{zoomDelta:E/128}}}else this._tap.touchmove(u,p,l)},La.prototype.touchend=function(u,p,l){this._tapTime?this._swipePoint&&0===l.length&&this.reset():this._tap.touchend(u,p,l)&&(this._tapTime=u.timeStamp)},La.prototype.touchcancel=function(){this.reset()},La.prototype.enable=function(){this._enabled=!0},La.prototype.disable=function(){this._enabled=!1,this.reset()},La.prototype.isEnabled=function(){return this._enabled},La.prototype.isActive=function(){return this._active};var So=function(u,p,l){this._el=u,this._mousePan=p,this._touchPan=l};So.prototype.enable=function(u){this._inertiaOptions=u||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan","mapboxgl-touch-drag-pan")},So.prototype.disable=function(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan","mapboxgl-touch-drag-pan")},So.prototype.isEnabled=function(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()},So.prototype.isActive=function(){return this._mousePan.isActive()||this._touchPan.isActive()};var ss=function(u,p,l){this._pitchWithRotate=u.pitchWithRotate,this._mouseRotate=p,this._mousePitch=l};ss.prototype.enable=function(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()},ss.prototype.disable=function(){this._mouseRotate.disable(),this._mousePitch.disable()},ss.prototype.isEnabled=function(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())},ss.prototype.isActive=function(){return this._mouseRotate.isActive()||this._mousePitch.isActive()};var Os=function(u,p,l,g){this._el=u,this._touchZoom=p,this._touchRotate=l,this._tapDragZoom=g,this._rotationDisabled=!1,this._enabled=!0};Os.prototype.enable=function(u){this._touchZoom.enable(u),this._rotationDisabled||this._touchRotate.enable(u),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate","mapboxgl-touch-zoom-rotate")},Os.prototype.disable=function(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate","mapboxgl-touch-zoom-rotate")},Os.prototype.isEnabled=function(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()},Os.prototype.isActive=function(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()},Os.prototype.disableRotation=function(){this._rotationDisabled=!0,this._touchRotate.disable()},Os.prototype.enableRotation=function(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()};var aa=function(u){return u.zoom||u.drag||u.pitch||u.rotate},sa=function(u){function p(){u.apply(this,arguments)}return u&&(p.__proto__=u),(p.prototype=Object.create(u&&u.prototype)).constructor=p,p}(y.Event);function Qa(u){return u.panDelta&&u.panDelta.mag()||u.zoomDelta||u.bearingDelta||u.pitchDelta}var vr=function(u,p){this._map=u,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Cu(u),this._bearingSnap=p.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(p),y.bindAll(["handleEvent","handleWindowEvent"],this);var l=this._el;this._listeners=[[l,"touchstart",{passive:!0}],[l,"touchmove",{passive:!1}],[l,"touchend",void 0],[l,"touchcancel",void 0],[l,"mousedown",void 0],[l,"mousemove",void 0],[l,"mouseup",void 0],[y.window.document,"mousemove",{capture:!0}],[y.window.document,"mouseup",void 0],[l,"mouseover",void 0],[l,"mouseout",void 0],[l,"dblclick",void 0],[l,"click",void 0],[l,"keydown",{capture:!1}],[l,"keyup",void 0],[l,"wheel",{passive:!1}],[l,"contextmenu",void 0],[y.window,"blur",void 0]];for(var g=0,E=this._listeners;g<E.length;g+=1){var P=E[g],T=P[0];ft.addEventListener(T,P[1],T===y.window.document?this.handleWindowEvent:this.handleEvent,P[2])}};vr.prototype.destroy=function(){for(var u=0,p=this._listeners;u<p.length;u+=1){var l=p[u],g=l[0];ft.removeEventListener(g,l[1],g===y.window.document?this.handleWindowEvent:this.handleEvent,l[2])}},vr.prototype._addDefaultHandlers=function(u){var p=this._map,l=p.getCanvasContainer();this._add("mapEvent",new Eo(p,u));var g=p.boxZoom=new nr(p,u);this._add("boxZoom",g);var E=new qi,P=new Ji;p.doubleClickZoom=new ti(P,E),this._add("tapZoom",E),this._add("clickZoom",P);var T=new La;this._add("tapDragZoom",T);var k=p.touchPitch=new gu;this._add("touchPitch",k);var q=new ki(u),H=new Ju(u);p.dragRotate=new ss(u,q,H),this._add("mouseRotate",q,["mousePitch"]),this._add("mousePitch",H,["mouseRotate"]);var ut=new gr(u),dt=new $a(u);p.dragPan=new So(l,ut,dt),this._add("mousePan",ut),this._add("touchPan",dt,["touchZoom","touchRotate"]);var lt=new zi,zt=new eu;p.touchZoomRotate=new Os(l,zt,lt,T),this._add("touchRotate",lt,["touchPan","touchZoom"]),this._add("touchZoom",zt,["touchPan","touchRotate"]);var Rt=p.scrollZoom=new Sn(p,this);this._add("scrollZoom",Rt,["mousePan"]);var jt=p.keyboard=new oa;this._add("keyboard",jt),this._add("blockableMapEvent",new Hi(p));for(var Dt=0,qt=["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"];Dt<qt.length;Dt+=1){var ee=qt[Dt];u.interactive&&u[ee]&&p[ee].enable(u[ee])}},vr.prototype._add=function(u,p,l){this._handlers.push({handlerName:u,handler:p,allowed:l}),this._handlersById[u]=p},vr.prototype.stop=function(u){if(!this._updatingCamera){for(var p=0,l=this._handlers;p<l.length;p+=1)l[p].handler.reset();this._inertia.clear(),this._fireEvents({},{},u),this._changes=[]}},vr.prototype.isActive=function(){for(var u=0,p=this._handlers;u<p.length;u+=1)if(p[u].handler.isActive())return!0;return!1},vr.prototype.isZooming=function(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()},vr.prototype.isRotating=function(){return!!this._eventsInProgress.rotate},vr.prototype.isMoving=function(){return Boolean(aa(this._eventsInProgress))||this.isZooming()},vr.prototype._blockedByActive=function(u,p,l){for(var g in u)if(g!==l&&(!p||p.indexOf(g)<0))return!0;return!1},vr.prototype.handleWindowEvent=function(u){this.handleEvent(u,u.type+"Window")},vr.prototype._getMapTouches=function(u){for(var p=[],l=0,g=u;l<g.length;l+=1){var E=g[l];this._el.contains(E.target)&&p.push(E)}return p},vr.prototype.handleEvent=function(u,p){if("blur"!==u.type){this._updatingCamera=!0;for(var l="renderFrame"===u.type?void 0:u,g={needsRenderFrame:!1},E={},P={},T=u.touches?this._getMapTouches(u.touches):void 0,k=T?ft.touchPos(this._el,T):ft.mousePos(this._el,u),q=0,H=this._handlers;q<H.length;q+=1){var ut=H[q],dt=ut.handlerName,lt=ut.handler,zt=ut.allowed;if(lt.isEnabled()){var Rt=void 0;this._blockedByActive(P,zt,dt)?lt.reset():lt[p||u.type]&&(Rt=lt[p||u.type](u,k,T),this.mergeHandlerResult(g,E,Rt,dt,l),Rt&&Rt.needsRenderFrame&&this._triggerRenderFrame()),(Rt||lt.isActive())&&(P[dt]=lt)}}var jt={};for(var Dt in this._previousActiveHandlers)P[Dt]||(jt[Dt]=l);this._previousActiveHandlers=P,(Object.keys(jt).length||Qa(g))&&(this._changes.push([g,E,jt]),this._triggerRenderFrame()),(Object.keys(P).length||Qa(g))&&this._map._stop(!0),this._updatingCamera=!1;var qt=g.cameraAnimation;qt&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],qt(this._map))}else this.stop(!0)},vr.prototype.mergeHandlerResult=function(u,p,l,g,E){if(l){y.extend(u,l);var P={handlerName:g,originalEvent:l.originalEvent||E};void 0!==l.zoomDelta&&(p.zoom=P),void 0!==l.panDelta&&(p.drag=P),void 0!==l.pitchDelta&&(p.pitch=P),void 0!==l.bearingDelta&&(p.rotate=P)}},vr.prototype._applyChanges=function(){for(var u={},p={},l={},g=0,E=this._changes;g<E.length;g+=1){var P=E[g],T=P[0],k=P[1],q=P[2];T.panDelta&&(u.panDelta=(u.panDelta||new y.Point(0,0))._add(T.panDelta)),T.zoomDelta&&(u.zoomDelta=(u.zoomDelta||0)+T.zoomDelta),T.bearingDelta&&(u.bearingDelta=(u.bearingDelta||0)+T.bearingDelta),T.pitchDelta&&(u.pitchDelta=(u.pitchDelta||0)+T.pitchDelta),void 0!==T.around&&(u.around=T.around),void 0!==T.pinchAround&&(u.pinchAround=T.pinchAround),T.noInertia&&(u.noInertia=T.noInertia),y.extend(p,k),y.extend(l,q)}this._updateMapTransform(u,p,l),this._changes=[]},vr.prototype._updateMapTransform=function(u,p,l){var g=this._map,E=g.transform;if(!Qa(u))return this._fireEvents(p,l,!0);var P=u.panDelta,T=u.zoomDelta,k=u.bearingDelta,q=u.pitchDelta,H=u.around,ut=u.pinchAround;void 0!==ut&&(H=ut),g._stop(!0),H=H||g.transform.centerPoint;var dt=E.pointLocation(P?H.sub(P):H);k&&(E.bearing+=k),q&&(E.pitch+=q),T&&(E.zoom+=T),E.setLocationAtPoint(dt,H),this._map._update(),u.noInertia||this._inertia.record(u),this._fireEvents(p,l,!0)},vr.prototype._fireEvents=function(u,p,l){var g=this,E=aa(this._eventsInProgress),P=aa(u),T={};for(var k in u)this._eventsInProgress[k]||(T[k+"start"]=u[k].originalEvent),this._eventsInProgress[k]=u[k];for(var q in!E&&P&&this._fireEvent("movestart",P.originalEvent),T)this._fireEvent(q,T[q]);for(var H in P&&this._fireEvent("move",P.originalEvent),u)this._fireEvent(H,u[H].originalEvent);var ut,dt={};for(var lt in this._eventsInProgress){var zt=this._eventsInProgress[lt],Rt=zt.handlerName,jt=zt.originalEvent;this._handlersById[Rt].isActive()||(delete this._eventsInProgress[lt],dt[lt+"end"]=ut=p[Rt]||jt)}for(var Dt in dt)this._fireEvent(Dt,dt[Dt]);var qt=aa(this._eventsInProgress);if(l&&(E||P)&&!qt){this._updatingCamera=!0;var ee=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),oe=function(Se){return 0!==Se&&-g._bearingSnap<Se&&Se<g._bearingSnap};ee?(oe(ee.bearing||this._map.getBearing())&&(ee.bearing=0),this._map.easeTo(ee,{originalEvent:ut})):(this._map.fire(new y.Event("moveend",{originalEvent:ut})),oe(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}},vr.prototype._fireEvent=function(u,p){this._map.fire(new y.Event(u,p?{originalEvent:p}:{}))},vr.prototype._requestFrame=function(){var u=this;return this._map.triggerRepaint(),this._map._renderTaskQueue.add(function(p){delete u._frameId,u.handleEvent(new sa("renderFrame",{timeStamp:p})),u._applyChanges()})},vr.prototype._triggerRenderFrame=function(){void 0===this._frameId&&(this._frameId=this._requestFrame())};var Gr=function(u){function p(l,g){u.call(this),this._moving=!1,this._zooming=!1,this.transform=l,this._bearingSnap=g.bearingSnap,y.bindAll(["_renderFrameCallback"],this)}return u&&(p.__proto__=u),(p.prototype=Object.create(u&&u.prototype)).constructor=p,p.prototype.getCenter=function(){return new y.LngLat(this.transform.center.lng,this.transform.center.lat)},p.prototype.setCenter=function(l,g){return this.jumpTo({center:l},g)},p.prototype.panBy=function(l,g,E){return l=y.Point.convert(l).mult(-1),this.panTo(this.transform.center,y.extend({offset:l},g),E)},p.prototype.panTo=function(l,g,E){return this.easeTo(y.extend({center:l},g),E)},p.prototype.getZoom=function(){return this.transform.zoom},p.prototype.setZoom=function(l,g){return this.jumpTo({zoom:l},g),this},p.prototype.zoomTo=function(l,g,E){return this.easeTo(y.extend({zoom:l},g),E)},p.prototype.zoomIn=function(l,g){return this.zoomTo(this.getZoom()+1,l,g),this},p.prototype.zoomOut=function(l,g){return this.zoomTo(this.getZoom()-1,l,g),this},p.prototype.getBearing=function(){return this.transform.bearing},p.prototype.setBearing=function(l,g){return this.jumpTo({bearing:l},g),this},p.prototype.getPadding=function(){return this.transform.padding},p.prototype.setPadding=function(l,g){return this.jumpTo({padding:l},g),this},p.prototype.rotateTo=function(l,g,E){return this.easeTo(y.extend({bearing:l},g),E)},p.prototype.resetNorth=function(l,g){return this.rotateTo(0,y.extend({duration:1e3},l),g),this},p.prototype.resetNorthPitch=function(l,g){return this.easeTo(y.extend({bearing:0,pitch:0,duration:1e3},l),g),this},p.prototype.snapToNorth=function(l,g){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(l,g):this},p.prototype.getPitch=function(){return this.transform.pitch},p.prototype.setPitch=function(l,g){return this.jumpTo({pitch:l},g),this},p.prototype.cameraForBounds=function(l,g){l=y.LngLatBounds.convert(l);var E=g&&g.bearing||0;return this._cameraForBoxAndBearing(l.getNorthWest(),l.getSouthEast(),E,g)},p.prototype._cameraForBoxAndBearing=function(l,g,E,P){var T={top:0,bottom:0,right:0,left:0};if("number"==typeof(P=y.extend({padding:T,offset:[0,0],maxZoom:this.transform.maxZoom},P)).padding){var k=P.padding;P.padding={top:k,bottom:k,right:k,left:k}}P.padding=y.extend(T,P.padding);var q=this.transform,H=q.padding,ut=q.project(y.LngLat.convert(l)),dt=q.project(y.LngLat.convert(g)),lt=ut.rotate(-E*Math.PI/180),zt=dt.rotate(-E*Math.PI/180),Rt=new y.Point(Math.max(lt.x,zt.x),Math.max(lt.y,zt.y)),jt=new y.Point(Math.min(lt.x,zt.x),Math.min(lt.y,zt.y)),Dt=Rt.sub(jt),qt=(q.width-(H.left+H.right+P.padding.left+P.padding.right))/Dt.x,ee=(q.height-(H.top+H.bottom+P.padding.top+P.padding.bottom))/Dt.y;if(!(ee<0||qt<0)){var oe=Math.min(q.scaleZoom(q.scale*Math.min(qt,ee)),P.maxZoom),Se="number"==typeof P.offset.x?new y.Point(P.offset.x,P.offset.y):y.Point.convert(P.offset),ge=new y.Point((P.padding.left-P.padding.right)/2,(P.padding.top-P.padding.bottom)/2).rotate(E*Math.PI/180),Ce=Se.add(ge).mult(q.scale/q.zoomScale(oe));return{center:q.unproject(ut.add(dt).div(2).sub(Ce)),zoom:oe,bearing:E}}y.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.")},p.prototype.fitBounds=function(l,g,E){return this._fitInternal(this.cameraForBounds(l,g),g,E)},p.prototype.fitScreenCoordinates=function(l,g,E,P,T){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(y.Point.convert(l)),this.transform.pointLocation(y.Point.convert(g)),E,P),P,T)},p.prototype._fitInternal=function(l,g,E){return l?(delete(g=y.extend(l,g)).padding,g.linear?this.easeTo(g,E):this.flyTo(g,E)):this},p.prototype.jumpTo=function(l,g){this.stop();var E=this.transform,P=!1,T=!1,k=!1;return"zoom"in l&&E.zoom!==+l.zoom&&(P=!0,E.zoom=+l.zoom),void 0!==l.center&&(E.center=y.LngLat.convert(l.center)),"bearing"in l&&E.bearing!==+l.bearing&&(T=!0,E.bearing=+l.bearing),"pitch"in l&&E.pitch!==+l.pitch&&(k=!0,E.pitch=+l.pitch),null==l.padding||E.isPaddingEqual(l.padding)||(E.padding=l.padding),this.fire(new y.Event("movestart",g)).fire(new y.Event("move",g)),P&&this.fire(new y.Event("zoomstart",g)).fire(new y.Event("zoom",g)).fire(new y.Event("zoomend",g)),T&&this.fire(new y.Event("rotatestart",g)).fire(new y.Event("rotate",g)).fire(new y.Event("rotateend",g)),k&&this.fire(new y.Event("pitchstart",g)).fire(new y.Event("pitch",g)).fire(new y.Event("pitchend",g)),this.fire(new y.Event("moveend",g))},p.prototype.easeTo=function(l,g){var E=this;this._stop(!1,l.easeId),(!1===(l=y.extend({offset:[0,0],duration:500,easing:y.ease},l)).animate||!l.essential&&y.browser.prefersReducedMotion)&&(l.duration=0);var P=this.transform,T=this.getZoom(),k=this.getBearing(),q=this.getPitch(),H=this.getPadding(),ut="zoom"in l?+l.zoom:T,dt="bearing"in l?this._normalizeBearing(l.bearing,k):k,lt="pitch"in l?+l.pitch:q,zt="padding"in l?l.padding:P.padding,Rt=y.Point.convert(l.offset),jt=P.centerPoint.add(Rt),Dt=P.pointLocation(jt),qt=y.LngLat.convert(l.center||Dt);this._normalizeCenter(qt);var ee,oe,Se=P.project(Dt),ge=P.project(qt).sub(Se),Ce=P.zoomScale(ut-T);l.around&&(ee=y.LngLat.convert(l.around),oe=P.locationPoint(ee));var be={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||ut!==T,this._rotating=this._rotating||k!==dt,this._pitching=this._pitching||lt!==q,this._padding=!P.isPaddingEqual(zt),this._easeId=l.easeId,this._prepareEase(g,l.noMoveStart,be),this._ease(function(Ue){if(E._zooming&&(P.zoom=y.number(T,ut,Ue)),E._rotating&&(P.bearing=y.number(k,dt,Ue)),E._pitching&&(P.pitch=y.number(q,lt,Ue)),E._padding&&(P.interpolatePadding(H,zt,Ue),jt=P.centerPoint.add(Rt)),ee)P.setLocationAtPoint(ee,oe);else{var Ne=P.zoomScale(P.zoom-T),Ve=ut>T?Math.min(2,Ce):Math.max(.5,Ce),er=Math.pow(Ve,1-Ue),ir=P.unproject(Se.add(ge.mult(Ue*er)).mult(Ne));P.setLocationAtPoint(P.renderWorldCopies?ir.wrap():ir,jt)}E._fireMoveEvents(g)},function(Ue){E._afterEase(g,Ue)},l),this},p.prototype._prepareEase=function(l,g,E){void 0===E&&(E={}),this._moving=!0,g||E.moving||this.fire(new y.Event("movestart",l)),this._zooming&&!E.zooming&&this.fire(new y.Event("zoomstart",l)),this._rotating&&!E.rotating&&this.fire(new y.Event("rotatestart",l)),this._pitching&&!E.pitching&&this.fire(new y.Event("pitchstart",l))},p.prototype._fireMoveEvents=function(l){this.fire(new y.Event("move",l)),this._zooming&&this.fire(new y.Event("zoom",l)),this._rotating&&this.fire(new y.Event("rotate",l)),this._pitching&&this.fire(new y.Event("pitch",l))},p.prototype._afterEase=function(l,g){if(!this._easeId||!g||this._easeId!==g){delete this._easeId;var E=this._zooming,P=this._rotating,T=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,E&&this.fire(new y.Event("zoomend",l)),P&&this.fire(new y.Event("rotateend",l)),T&&this.fire(new y.Event("pitchend",l)),this.fire(new y.Event("moveend",l))}},p.prototype.flyTo=function(l,g){var E=this;if(!l.essential&&y.browser.prefersReducedMotion){var P=y.pick(l,["center","zoom","bearing","pitch","around"]);return this.jumpTo(P,g)}this.stop(),l=y.extend({offset:[0,0],speed:1.2,curve:1.42,easing:y.ease},l);var T=this.transform,k=this.getZoom(),q=this.getBearing(),H=this.getPitch(),ut=this.getPadding(),dt="zoom"in l?y.clamp(+l.zoom,T.minZoom,T.maxZoom):k,lt="bearing"in l?this._normalizeBearing(l.bearing,q):q,zt="pitch"in l?+l.pitch:H,Rt="padding"in l?l.padding:T.padding,jt=T.zoomScale(dt-k),Dt=y.Point.convert(l.offset),qt=T.centerPoint.add(Dt),ee=T.pointLocation(qt),oe=y.LngLat.convert(l.center||ee);this._normalizeCenter(oe);var Se=T.project(ee),ge=T.project(oe).sub(Se),Ce=l.curve,be=Math.max(T.width,T.height),Ue=be/jt,Ne=ge.mag();if("minZoom"in l){var Ve=y.clamp(Math.min(l.minZoom,k,dt),T.minZoom,T.maxZoom),er=be/T.zoomScale(Ve-k);Ce=Math.sqrt(er/Ne*2)}var ir=Ce*Ce;function rr(cr){var ar=(Ue*Ue-be*be+(cr?-1:1)*ir*ir*Ne*Ne)/(2*(cr?Ue:be)*ir*Ne);return Math.log(Math.sqrt(ar*ar+1)-ar)}function Rr(cr){return(Math.exp(cr)-Math.exp(-cr))/2}function Ye(cr){return(Math.exp(cr)+Math.exp(-cr))/2}var _r=rr(0),Ir=function(cr){return Ye(_r)/Ye(_r+Ce*cr)},xr=function(cr){return be*((Ye(_r)*(Rr(ar=_r+Ce*cr)/Ye(ar))-Rr(_r))/ir)/Ne;var ar},yr=(rr(1)-_r)/Ce;if(Math.abs(Ne)<1e-6||!isFinite(yr)){if(Math.abs(be-Ue)<1e-6)return this.easeTo(l,g);var dr=Ue<be?-1:1;yr=Math.abs(Math.log(Ue/be))/Ce,xr=function(){return 0},Ir=function(cr){return Math.exp(dr*Ce*cr)}}return l.duration="duration"in l?+l.duration:1e3*yr/("screenSpeed"in l?+l.screenSpeed/Ce:+l.speed),l.maxDuration&&l.duration>l.maxDuration&&(l.duration=0),this._zooming=!0,this._rotating=q!==lt,this._pitching=zt!==H,this._padding=!T.isPaddingEqual(Rt),this._prepareEase(g,!1),this._ease(function(cr){var ar=cr*yr,Vr=1/Ir(ar);T.zoom=1===cr?dt:k+T.scaleZoom(Vr),E._rotating&&(T.bearing=y.number(q,lt,cr)),E._pitching&&(T.pitch=y.number(H,zt,cr)),E._padding&&(T.interpolatePadding(ut,Rt,cr),qt=T.centerPoint.add(Dt));var Kr=1===cr?oe:T.unproject(Se.add(ge.mult(xr(ar))).mult(Vr));T.setLocationAtPoint(T.renderWorldCopies?Kr.wrap():Kr,qt),E._fireMoveEvents(g)},function(){return E._afterEase(g)},l),this},p.prototype.isEasing=function(){return!!this._easeFrameId},p.prototype.stop=function(){return this._stop()},p.prototype._stop=function(l,g){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){var E=this._onEaseEnd;delete this._onEaseEnd,E.call(this,g)}if(!l){var P=this.handlers;P&&P.stop(!1)}return this},p.prototype._ease=function(l,g,E){!1===E.animate||0===E.duration?(l(1),g()):(this._easeStart=y.browser.now(),this._easeOptions=E,this._onEaseFrame=l,this._onEaseEnd=g,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))},p.prototype._renderFrameCallback=function(){var l=Math.min((y.browser.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(l)),l<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},p.prototype._normalizeBearing=function(l,g){l=y.wrap(l,-180,180);var E=Math.abs(l-g);return Math.abs(l-360-g)<E&&(l-=360),Math.abs(l+360-g)<E&&(l+=360),l},p.prototype._normalizeCenter=function(l){var g=this.transform;if(g.renderWorldCopies&&!g.lngRange){var E=l.lng-g.center.lng;l.lng+=E>180?-360:E<-180?360:0}},p}(y.Evented),ho=function(u){void 0===u&&(u={}),this.options=u,y.bindAll(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)};ho.prototype.getDefaultPosition=function(){return"bottom-right"},ho.prototype.onAdd=function(u){var p=this.options&&this.options.compact;return this._map=u,this._container=ft.create("div","maplibregl-ctrl maplibregl-ctrl-attrib mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=ft.create("button","maplibregl-ctrl-attrib-button mapboxgl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._compactButton.type="button",this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=ft.create("div","maplibregl-ctrl-attrib-inner mapboxgl-ctrl-attrib-inner",this._container),this._innerContainer.setAttribute("role","list"),p&&this._container.classList.add("maplibregl-compact","mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),void 0===p&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container},ho.prototype.onRemove=function(){ft.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0},ho.prototype._setElementTitle=function(u,p){var l=this._map._getUIString("AttributionControl."+p);u.title=l,u.setAttribute("aria-label",l)},ho.prototype._toggleAttribution=function(){this._container.classList.contains("maplibregl-compact-show")||this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("maplibregl-compact-show","mapboxgl-compact-show"),this._compactButton.setAttribute("aria-pressed","false")):(this._container.classList.add("maplibregl-compact-show","mapboxgl-compact-show"),this._compactButton.setAttribute("aria-pressed","true"))},ho.prototype._updateEditLink=function(){var u=this._editLink;u||(u=this._editLink=this._container.querySelector(".mapbox-improve-map"));var p=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||y.config.ACCESS_TOKEN}];if(u){var l=p.reduce(function(g,E,P){return E.value&&(g+=E.key+"="+E.value+(P<p.length-1?"&":"")),g},"?");u.href=y.config.FEEDBACK_URL+"/"+l+(this._map._hash?this._map._hash.getHashString(!0):""),u.rel="noopener nofollow",this._setElementTitle(u,"MapFeedback")}},ho.prototype._updateData=function(u){!u||"metadata"!==u.sourceDataType&&"visibility"!==u.sourceDataType&&"style"!==u.dataType||(this._updateAttributions(),this._updateEditLink())},ho.prototype._updateAttributions=function(){if(this._map.style){var u=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?u=u.concat(this.options.customAttribution.map(function(k){return"string"!=typeof k?"":k})):"string"==typeof this.options.customAttribution&&u.push(this.options.customAttribution)),this._map.style.stylesheet){var p=this._map.style.stylesheet;this.styleOwner=p.owner,this.styleId=p.id}var l=this._map.style.sourceCaches;for(var g in l){var E=l[g];if(E.used){var P=E.getSource();P.attribution&&u.indexOf(P.attribution)<0&&u.push(P.attribution)}}u.sort(function(k,q){return k.length-q.length});var T=(u=u.filter(function(k,q){for(var H=q+1;H<u.length;H++)if(u[H].indexOf(k)>=0)return!1;return!0})).join(" | ");T!==this._attribHTML&&(this._attribHTML=T,u.length?(this._innerContainer.innerHTML=T,this._container.classList.remove("maplibregl-attrib-empty","mapboxgl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty","mapboxgl-attrib-empty"),this._editLink=null)}},ho.prototype._updateCompact=function(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("maplibregl-compact","mapboxgl-compact"):this._container.classList.remove("maplibregl-compact","maplibregl-compact-show","mapboxgl-compact","mapboxgl-compact-show")};var $o=function(){y.bindAll(["_updateLogo"],this),y.bindAll(["_updateCompact"],this)};$o.prototype.onAdd=function(u){this._map=u,this._container=ft.create("div","maplibregl-ctrl mapboxgl-ctrl");var p=ft.create("a","maplibregl-ctrl-logo mapboxgl-ctrl-logo");return p.target="_blank",p.rel="noopener nofollow",p.href="https://maplibre.org/",p.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),p.setAttribute("rel","noopener nofollow"),this._container.appendChild(p),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container},$o.prototype.onRemove=function(){ft.remove(this._container),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)},$o.prototype.getDefaultPosition=function(){return"bottom-left"},$o.prototype._updateLogo=function(u){u&&"metadata"!==u.sourceDataType||(this._container.style.display=this._logoRequired()?"block":"none")},$o.prototype._logoRequired=function(){if(this._map.style){var u=this._map.style.sourceCaches;for(var p in u)if(u[p].getSource().mapbox_logo)return!0;return!1}},$o.prototype._updateCompact=function(){var u=this._container.children;if(u.length){var p=u[0];this._map.getCanvasContainer().offsetWidth<250?p.classList.add("maplibregl-compact","mapboxgl-compact"):p.classList.remove("maplibregl-compact","mapboxgl-compact")}};var ya=function(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1};ya.prototype.add=function(u){var p=++this._id;return this._queue.push({callback:u,id:p,cancelled:!1}),p},ya.prototype.remove=function(u){for(var p=this._currentlyRunning,l=0,g=p?this._queue.concat(p):this._queue;l<g.length;l+=1){var E=g[l];if(E.id===u)return void(E.cancelled=!0)}},ya.prototype.run=function(u){void 0===u&&(u=0);var p=this._currentlyRunning=this._queue;this._queue=[];for(var l=0,g=p;l<g.length;l+=1){var E=g[l];if(!E.cancelled&&(E.callback(u),this._cleared))break}this._cleared=!1,this._currentlyRunning=!1},ya.prototype.clear=function(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]};var Oo={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm"},Wr=y.window.HTMLImageElement,ru=y.window.HTMLElement,Oa=y.window.ImageBitmap,Vn={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",transformRequest:null,accessToken:null,fadeDuration:300,crossSourceCollisions:!0},oi=function(u){function p(g){var E=this;if(null!=(g=y.extend({},Vn,g)).minZoom&&null!=g.maxZoom&&g.minZoom>g.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(null!=g.minPitch&&null!=g.maxPitch&&g.minPitch>g.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(null!=g.minPitch&&g.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(null!=g.maxPitch&&g.maxPitch>60)throw new Error("maxPitch must be less than or equal to 60");var P=new gn(g.minZoom,g.maxZoom,g.minPitch,g.maxPitch,g.renderWorldCopies);if(u.call(this,P,g),this._interactive=g.interactive,this._maxTileCacheSize=g.maxTileCacheSize,this._failIfMajorPerformanceCaveat=g.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=g.preserveDrawingBuffer,this._antialias=g.antialias,this._trackResize=g.trackResize,this._bearingSnap=g.bearingSnap,this._refreshExpiredTiles=g.refreshExpiredTiles,this._fadeDuration=g.fadeDuration,this._crossSourceCollisions=g.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=g.collectResourceTiming,this._renderTaskQueue=new ya,this._controls=[],this._mapId=y.uniqueId(),this._locale=y.extend({},Oo,g.locale),this._clickTolerance=g.clickTolerance,this._requestManager=new y.RequestManager(g.transformRequest,g.accessToken),"string"==typeof g.container){if(this._container=y.window.document.getElementById(g.container),!this._container)throw new Error("Container '"+g.container+"' not found.")}else{if(!(g.container instanceof ru))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=g.container}if(g.maxBounds&&this.setMaxBounds(g.maxBounds),y.bindAll(["_onWindowOnline","_onWindowResize","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),void 0===this.painter)throw new Error("Failed to initialize WebGL.");this.on("move",function(){return E._update(!1)}),this.on("moveend",function(){return E._update(!1)}),this.on("zoom",function(){return E._update(!0)}),void 0!==y.window&&(y.window.addEventListener("online",this._onWindowOnline,!1),y.window.addEventListener("resize",this._onWindowResize,!1),y.window.addEventListener("orientationchange",this._onWindowResize,!1)),this.handlers=new vr(this,g),this._hash=g.hash&&new Ba("string"==typeof g.hash&&g.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:g.center,zoom:g.zoom,bearing:g.bearing,pitch:g.pitch}),g.bounds&&(this.resize(),this.fitBounds(g.bounds,y.extend({},g.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=g.localIdeographFontFamily,g.style&&this.setStyle(g.style,{localIdeographFontFamily:g.localIdeographFontFamily}),g.attributionControl&&this.addControl(new ho({customAttribution:g.customAttribution})),this.addControl(new $o,g.logoPosition),this.on("style.load",function(){E.transform.unmodified&&E.jumpTo(E.style.stylesheet)}),this.on("data",function(T){E._update("style"===T.dataType),E.fire(new y.Event(T.dataType+"data",T))}),this.on("dataloading",function(T){E.fire(new y.Event(T.dataType+"dataloading",T))})}u&&(p.__proto__=u),(p.prototype=Object.create(u&&u.prototype)).constructor=p;var l={showTileBoundaries:{configurable:!0},showPadding:{configurable:!0},showCollisionBoxes:{configurable:!0},showOverdrawInspector:{configurable:!0},repaint:{configurable:!0},vertices:{configurable:!0},version:{configurable:!0}};return p.prototype._getMapId=function(){return this._mapId},p.prototype.addControl=function(g,E){if(void 0===E&&(E=g.getDefaultPosition?g.getDefaultPosition():"top-right"),!g||!g.onAdd)return this.fire(new y.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));var P=g.onAdd(this);this._controls.push(g);var T=this._controlPositions[E];return-1!==E.indexOf("bottom")?T.insertBefore(P,T.firstChild):T.appendChild(P),this},p.prototype.removeControl=function(g){if(!g||!g.onRemove)return this.fire(new y.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));var E=this._controls.indexOf(g);return E>-1&&this._controls.splice(E,1),g.onRemove(this),this},p.prototype.hasControl=function(g){return this._controls.indexOf(g)>-1},p.prototype.resize=function(g){var E=this._containerDimensions(),P=E[0],T=E[1];this._resizeCanvas(P,T),this.transform.resize(P,T),this.painter.resize(P,T);var k=!this._moving;return k&&(this.stop(),this.fire(new y.Event("movestart",g)).fire(new y.Event("move",g))),this.fire(new y.Event("resize",g)),k&&this.fire(new y.Event("moveend",g)),this},p.prototype.getBounds=function(){return this.transform.getBounds()},p.prototype.getMaxBounds=function(){return this.transform.getMaxBounds()},p.prototype.setMaxBounds=function(g){return this.transform.setMaxBounds(y.LngLatBounds.convert(g)),this._update()},p.prototype.setMinZoom=function(g){if((g=null==g?-2:g)>=-2&&g<=this.transform.maxZoom)return this.transform.minZoom=g,this._update(),this.getZoom()<g&&this.setZoom(g),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")},p.prototype.getMinZoom=function(){return this.transform.minZoom},p.prototype.setMaxZoom=function(g){if((g=null==g?22:g)>=this.transform.minZoom)return this.transform.maxZoom=g,this._update(),this.getZoom()>g&&this.setZoom(g),this;throw new Error("maxZoom must be greater than the current minZoom")},p.prototype.getMaxZoom=function(){return this.transform.maxZoom},p.prototype.setMinPitch=function(g){if((g=null==g?0:g)<0)throw new Error("minPitch must be greater than or equal to 0");if(g>=0&&g<=this.transform.maxPitch)return this.transform.minPitch=g,this._update(),this.getPitch()<g&&this.setPitch(g),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")},p.prototype.getMinPitch=function(){return this.transform.minPitch},p.prototype.setMaxPitch=function(g){if((g=null==g?60:g)>60)throw new Error("maxPitch must be less than or equal to 60");if(g>=this.transform.minPitch)return this.transform.maxPitch=g,this._update(),this.getPitch()>g&&this.setPitch(g),this;throw new Error("maxPitch must be greater than the current minPitch")},p.prototype.getMaxPitch=function(){return this.transform.maxPitch},p.prototype.getRenderWorldCopies=function(){return this.transform.renderWorldCopies},p.prototype.setRenderWorldCopies=function(g){return this.transform.renderWorldCopies=g,this._update()},p.prototype.project=function(g){return this.transform.locationPoint(y.LngLat.convert(g))},p.prototype.unproject=function(g){return this.transform.pointLocation(y.Point.convert(g))},p.prototype.isMoving=function(){return this._moving||this.handlers.isMoving()},p.prototype.isZooming=function(){return this._zooming||this.handlers.isZooming()},p.prototype.isRotating=function(){return this._rotating||this.handlers.isRotating()},p.prototype._createDelegatedListener=function(g,E,P){var T,k=this;if("mouseenter"===g||"mouseover"===g){var q=!1;return{layer:E,listener:P,delegates:{mousemove:function(ut){var dt=k.getLayer(E)?k.queryRenderedFeatures(ut.point,{layers:[E]}):[];dt.length?q||(q=!0,P.call(k,new mi(g,k,ut.originalEvent,{features:dt}))):q=!1},mouseout:function(){q=!1}}}}if("mouseleave"===g||"mouseout"===g){var H=!1;return{layer:E,listener:P,delegates:{mousemove:function(ut){(k.getLayer(E)?k.queryRenderedFeatures(ut.point,{layers:[E]}):[]).length?H=!0:H&&(H=!1,P.call(k,new mi(g,k,ut.originalEvent)))},mouseout:function(ut){H&&(H=!1,P.call(k,new mi(g,k,ut.originalEvent)))}}}}return{layer:E,listener:P,delegates:(T={},T[g]=function(ut){var dt=k.getLayer(E)?k.queryRenderedFeatures(ut.point,{layers:[E]}):[];dt.length&&(ut.features=dt,P.call(k,ut),delete ut.features)},T)}},p.prototype.on=function(g,E,P){if(void 0===P)return u.prototype.on.call(this,g,E);var T=this._createDelegatedListener(g,E,P);for(var k in this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[g]=this._delegatedListeners[g]||[],this._delegatedListeners[g].push(T),T.delegates)this.on(k,T.delegates[k]);return this},p.prototype.once=function(g,E,P){if(void 0===P)return u.prototype.once.call(this,g,E);var T=this._createDelegatedListener(g,E,P);for(var k in T.delegates)this.once(k,T.delegates[k]);return this},p.prototype.off=function(g,E,P){var T=this;return void 0===P?u.prototype.off.call(this,g,E):(this._delegatedListeners&&this._delegatedListeners[g]&&function(k){for(var q=k[g],H=0;H<q.length;H++){var ut=q[H];if(ut.layer===E&&ut.listener===P){for(var dt in ut.delegates)T.off(dt,ut.delegates[dt]);return q.splice(H,1),T}}}(this._delegatedListeners),this)},p.prototype.queryRenderedFeatures=function(g,E){if(!this.style)return[];var P;if(void 0!==E||void 0===g||g instanceof y.Point||Array.isArray(g)||(E=g,g=void 0),E=E||{},(g=g||[[0,0],[this.transform.width,this.transform.height]])instanceof y.Point||"number"==typeof g[0])P=[y.Point.convert(g)];else{var T=y.Point.convert(g[0]),k=y.Point.convert(g[1]);P=[T,new y.Point(k.x,T.y),k,new y.Point(T.x,k.y),T]}return this.style.queryRenderedFeatures(P,E,this.transform)},p.prototype.querySourceFeatures=function(g,E){return this.style.querySourceFeatures(g,E)},p.prototype.setStyle=function(g,E){return!1!==(E=y.extend({},{localIdeographFontFamily:this._localIdeographFontFamily},E)).diff&&E.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&g?(this._diffStyle(g,E),this):(this._localIdeographFontFamily=E.localIdeographFontFamily,this._updateStyle(g,E))},p.prototype.setTransformRequest=function(g){return this._requestManager.setTransformRequest(g),this},p.prototype._getUIString=function(g){var E=this._locale[g];if(null==E)throw new Error("Missing UI string '"+g+"'");return E},p.prototype._updateStyle=function(g,E){return this.style&&(this.style.setEventedParent(null),this.style._remove()),g?(this.style=new ja(this,E||{}),this.style.setEventedParent(this,{style:this.style}),"string"==typeof g?this.style.loadURL(g):this.style.loadJSON(g),this):(delete this.style,this)},p.prototype._lazyInitEmptyStyle=function(){this.style||(this.style=new ja(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())},p.prototype._diffStyle=function(g,E){var P=this;if("string"==typeof g){var T=this._requestManager.normalizeStyleURL(g),k=this._requestManager.transformRequest(T,y.ResourceType.Style);y.getJSON(k,function(q,H){q?P.fire(new y.ErrorEvent(q)):H&&P._updateDiff(H,E)})}else"object"==typeof g&&this._updateDiff(g,E)},p.prototype._updateDiff=function(g,E){try{this.style.setState(g)&&this._update(!0)}catch(P){y.warnOnce("Unable to perform style diff: "+(P.message||P.error||P)+".  Rebuilding the style from scratch."),this._updateStyle(g,E)}},p.prototype.getStyle=function(){if(this.style)return this.style.serialize()},p.prototype.isStyleLoaded=function(){return this.style?this.style.loaded():y.warnOnce("There is no style added to the map.")},p.prototype.addSource=function(g,E){return this._lazyInitEmptyStyle(),this.style.addSource(g,E),this._update(!0)},p.prototype.isSourceLoaded=function(g){var E=this.style&&this.style.sourceCaches[g];if(void 0!==E)return E.loaded();this.fire(new y.ErrorEvent(new Error("There is no source with ID '"+g+"'")))},p.prototype.areTilesLoaded=function(){var g=this.style&&this.style.sourceCaches;for(var E in g){var P=g[E]._tiles;for(var T in P){var k=P[T];if("loaded"!==k.state&&"errored"!==k.state)return!1}}return!0},p.prototype.addSourceType=function(g,E,P){return this._lazyInitEmptyStyle(),this.style.addSourceType(g,E,P)},p.prototype.removeSource=function(g){return this.style.removeSource(g),this._update(!0)},p.prototype.getSource=function(g){return this.style.getSource(g)},p.prototype.addImage=function(g,E,P){void 0===P&&(P={});var T=P.pixelRatio;void 0===T&&(T=1);var k=P.sdf;void 0===k&&(k=!1);var q=P.stretchX,H=P.stretchY,ut=P.content;if(this._lazyInitEmptyStyle(),E instanceof Wr||Oa&&E instanceof Oa){var dt=y.browser.getImageData(E);this.style.addImage(g,{data:new y.RGBAImage({width:dt.width,height:dt.height},dt.data),pixelRatio:T,stretchX:q,stretchY:H,content:ut,sdf:k,version:0})}else{if(void 0===E.width||void 0===E.height)return this.fire(new y.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));var lt=E;this.style.addImage(g,{data:new y.RGBAImage({width:E.width,height:E.height},new Uint8Array(E.data)),pixelRatio:T,stretchX:q,stretchY:H,content:ut,sdf:k,version:0,userImage:lt}),lt.onAdd&&lt.onAdd(this,g)}},p.prototype.updateImage=function(g,E){var P=this.style.getImage(g);if(!P)return this.fire(new y.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));var T=E instanceof Wr||Oa&&E instanceof Oa?y.browser.getImageData(E):E,k=T.width,q=T.height,H=T.data;return void 0===k||void 0===q?this.fire(new y.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`"))):k!==P.data.width||q!==P.data.height?this.fire(new y.ErrorEvent(new Error("The width and height of the updated image must be that same as the previous version of the image"))):(P.data.replace(H,!(E instanceof Wr||Oa&&E instanceof Oa)),void this.style.updateImage(g,P))},p.prototype.hasImage=function(g){return g?!!this.style.getImage(g):(this.fire(new y.ErrorEvent(new Error("Missing required image id"))),!1)},p.prototype.removeImage=function(g){this.style.removeImage(g)},p.prototype.loadImage=function(g,E){y.getImage(this._requestManager.transformRequest(g,y.ResourceType.Image),E)},p.prototype.listImages=function(){return this.style.listImages()},p.prototype.addLayer=function(g,E){return this._lazyInitEmptyStyle(),this.style.addLayer(g,E),this._update(!0)},p.prototype.moveLayer=function(g,E){return this.style.moveLayer(g,E),this._update(!0)},p.prototype.removeLayer=function(g){return this.style.removeLayer(g),this._update(!0)},p.prototype.getLayer=function(g){return this.style.getLayer(g)},p.prototype.setLayerZoomRange=function(g,E,P){return this.style.setLayerZoomRange(g,E,P),this._update(!0)},p.prototype.setFilter=function(g,E,P){return void 0===P&&(P={}),this.style.setFilter(g,E,P),this._update(!0)},p.prototype.getFilter=function(g){return this.style.getFilter(g)},p.prototype.setPaintProperty=function(g,E,P,T){return void 0===T&&(T={}),this.style.setPaintProperty(g,E,P,T),this._update(!0)},p.prototype.getPaintProperty=function(g,E){return this.style.getPaintProperty(g,E)},p.prototype.setLayoutProperty=function(g,E,P,T){return void 0===T&&(T={}),this.style.setLayoutProperty(g,E,P,T),this._update(!0)},p.prototype.getLayoutProperty=function(g,E){return this.style.getLayoutProperty(g,E)},p.prototype.setLight=function(g,E){return void 0===E&&(E={}),this._lazyInitEmptyStyle(),this.style.setLight(g,E),this._update(!0)},p.prototype.getLight=function(){return this.style.getLight()},p.prototype.setFeatureState=function(g,E){return this.style.setFeatureState(g,E),this._update()},p.prototype.removeFeatureState=function(g,E){return this.style.removeFeatureState(g,E),this._update()},p.prototype.getFeatureState=function(g){return this.style.getFeatureState(g)},p.prototype.getContainer=function(){return this._container},p.prototype.getCanvasContainer=function(){return this._canvasContainer},p.prototype.getCanvas=function(){return this._canvas},p.prototype._containerDimensions=function(){var g=0,E=0;return this._container&&(g=this._container.clientWidth||400,E=this._container.clientHeight||300),[g,E]},p.prototype._setupContainer=function(){var g=this._container;g.classList.add("maplibregl-map","mapboxgl-map");var E=this._canvasContainer=ft.create("div","maplibregl-canvas-container mapboxgl-canvas-container",g);this._interactive&&E.classList.add("maplibregl-interactive","mapboxgl-interactive"),this._canvas=ft.create("canvas","maplibregl-canvas mapboxgl-canvas",E),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map"),this._canvas.setAttribute("role","region");var P=this._containerDimensions();this._resizeCanvas(P[0],P[1]);var T=this._controlContainer=ft.create("div","maplibregl-control-container mapboxgl-control-container",g),k=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(function(q){k[q]=ft.create("div","maplibregl-ctrl-"+q+" mapboxgl-ctrl-"+q,T)}),this._container.addEventListener("scroll",this._onMapScroll,!1)},p.prototype._resizeCanvas=function(g,E){var P=y.browser.devicePixelRatio||1;this._canvas.width=P*g,this._canvas.height=P*E,this._canvas.style.width=g+"px",this._canvas.style.height=E+"px"},p.prototype._setupPainter=function(){var g=y.extend({},Bt.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),E=this._canvas.getContext("webgl",g)||this._canvas.getContext("experimental-webgl",g);E?(this.painter=new Fn(E,this.transform),y.webpSupported.testSupport(E)):this.fire(new y.ErrorEvent(new Error("Failed to initialize WebGL")))},p.prototype._contextLost=function(g){g.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new y.Event("webglcontextlost",{originalEvent:g}))},p.prototype._contextRestored=function(g){this._setupPainter(),this.resize(),this._update(),this.fire(new y.Event("webglcontextrestored",{originalEvent:g}))},p.prototype._onMapScroll=function(g){if(g.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},p.prototype.loaded=function(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()},p.prototype._update=function(g){return this.style?(this._styleDirty=this._styleDirty||g,this._sourcesDirty=!0,this.triggerRepaint(),this):this},p.prototype._requestRenderFrame=function(g){return this._update(),this._renderTaskQueue.add(g)},p.prototype._cancelRenderFrame=function(g){this._renderTaskQueue.remove(g)},p.prototype._render=function(g){var E,P=this,T=0,k=this.painter.context.extTimerQuery;if(this.listens("gpu-timing-frame")&&(E=k.createQueryEXT(),k.beginQueryEXT(k.TIME_ELAPSED_EXT,E),T=y.browser.now()),this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(g),!this._removed){var q=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;var H=this.transform.zoom,ut=y.browser.now();this.style.zoomHistory.update(H,ut);var dt=new y.EvaluationParameters(H,{now:ut,fadeDuration:this._fadeDuration,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),lt=dt.crossFadingFactor();1===lt&&lt===this._crossFadingFactor||(q=!0,this._crossFadingFactor=lt),this.style.update(dt)}if(this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,this._fadeDuration,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:this._fadeDuration,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer")}),this.fire(new y.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new y.Event("load"))),this.style&&(this.style.hasTransitions()||q)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),this.listens("gpu-timing-frame")){var zt=y.browser.now()-T;k.endQueryEXT(k.TIME_ELAPSED_EXT,E),setTimeout(function(){var Dt=k.getQueryObjectEXT(E,k.QUERY_RESULT_EXT)/1e6;k.deleteQueryEXT(E),P.fire(new y.Event("gpu-timing-frame",{cpuTime:zt,gpuTime:Dt}))},50)}if(this.listens("gpu-timing-layer")){var Rt=this.painter.collectGpuTimers();setTimeout(function(){var Dt=P.painter.queryGpuTimers(Rt);P.fire(new y.Event("gpu-timing-layer",{layerTimes:Dt}))},50)}var jt=this._sourcesDirty||this._styleDirty||this._placementDirty;return jt||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new y.Event("idle")),!this._loaded||this._fullyLoaded||jt||(this._fullyLoaded=!0),this}},p.prototype.remove=function(){this._hash&&this._hash.remove();for(var g=0,E=this._controls;g<E.length;g+=1)E[g].onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),void 0!==y.window&&(y.window.removeEventListener("resize",this._onWindowResize,!1),y.window.removeEventListener("orientationchange",this._onWindowResize,!1),y.window.removeEventListener("online",this._onWindowOnline,!1));var P=this.painter.context.gl.getExtension("WEBGL_lose_context");P&&P.loseContext(),Iu(this._canvasContainer),Iu(this._controlContainer),this._container.classList.remove("maplibregl-map","mapboxgl-map"),this._removed=!0,this.fire(new y.Event("remove"))},p.prototype.triggerRepaint=function(){var g=this;this.style&&!this._frame&&(this._frame=y.browser.frame(function(E){g._frame=null,g._render(E)}))},p.prototype._onWindowOnline=function(){this._update()},p.prototype._onWindowResize=function(g){this._trackResize&&this.resize({originalEvent:g})._update()},l.showTileBoundaries.get=function(){return!!this._showTileBoundaries},l.showTileBoundaries.set=function(g){this._showTileBoundaries!==g&&(this._showTileBoundaries=g,this._update())},l.showPadding.get=function(){return!!this._showPadding},l.showPadding.set=function(g){this._showPadding!==g&&(this._showPadding=g,this._update())},l.showCollisionBoxes.get=function(){return!!this._showCollisionBoxes},l.showCollisionBoxes.set=function(g){this._showCollisionBoxes!==g&&(this._showCollisionBoxes=g,g?this.style._generateCollisionBoxes():this._update())},l.showOverdrawInspector.get=function(){return!!this._showOverdrawInspector},l.showOverdrawInspector.set=function(g){this._showOverdrawInspector!==g&&(this._showOverdrawInspector=g,this._update())},l.repaint.get=function(){return!!this._repaint},l.repaint.set=function(g){this._repaint!==g&&(this._repaint=g,this.triggerRepaint())},l.vertices.get=function(){return!!this._vertices},l.vertices.set=function(g){this._vertices=g,this._update()},p.prototype._setCacheLimits=function(g,E){y.setCacheLimits(g,E)},l.version.get=function(){return y.version},Object.defineProperties(p.prototype,l),p}(Gr);function Iu(u){u.parentNode&&u.parentNode.removeChild(u)}var Qo={showCompass:!0,showZoom:!0,visualizePitch:!1},vi=function(u){var p=this;this.options=y.extend({},Qo,u),this._container=ft.create("div","maplibregl-ctrl maplibregl-ctrl-group mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",function(l){return l.preventDefault()}),this.options.showZoom&&(y.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in mapboxgl-ctrl-zoom-in",function(l){return p._map.zoomIn({},{originalEvent:l})}),ft.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden",!0),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out mapboxgl-ctrl-zoom-out",function(l){return p._map.zoomOut({},{originalEvent:l})}),ft.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden",!0)),this.options.showCompass&&(y.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("maplibregl-ctrl-compass mapboxgl-ctrl-compass",function(l){p.options.visualizePitch?p._map.resetNorthPitch({},{originalEvent:l}):p._map.resetNorth({},{originalEvent:l})}),this._compassIcon=ft.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden",!0))};vi.prototype._updateZoomButtons=function(){var u=this._map.getZoom(),p=u===this._map.getMaxZoom(),l=u===this._map.getMinZoom();this._zoomInButton.disabled=p,this._zoomOutButton.disabled=l,this._zoomInButton.setAttribute("aria-disabled",p.toString()),this._zoomOutButton.setAttribute("aria-disabled",l.toString())},vi.prototype._rotateCompassArrow=function(){var u=this.options.visualizePitch?"scale("+1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)+") rotateX("+this._map.transform.pitch+"deg) rotateZ("+this._map.transform.angle*(180/Math.PI)+"deg)":"rotate("+this._map.transform.angle*(180/Math.PI)+"deg)";this._compassIcon.style.transform=u},vi.prototype.onAdd=function(u){return this._map=u,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new va(this._map,this._compass,this.options.visualizePitch)),this._container},vi.prototype.onRemove=function(){ft.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map},vi.prototype._createButton=function(u,p){var l=ft.create("button",u,this._container);return l.type="button",l.addEventListener("click",p),l},vi.prototype._setButtonTitle=function(u,p){var l=this._map._getUIString("NavigationControl."+p);u.title=l,u.setAttribute("aria-label",l)};var va=function(u,p,l){void 0===l&&(l=!1),this._clickTolerance=10,this.element=p,this.mouseRotate=new ki({clickTolerance:u.dragRotate._mouseRotate._clickTolerance}),this.map=u,l&&(this.mousePitch=new Ju({clickTolerance:u.dragRotate._mousePitch._clickTolerance})),y.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),ft.addEventListener(p,"mousedown",this.mousedown),ft.addEventListener(p,"touchstart",this.touchstart,{passive:!1}),ft.addEventListener(p,"touchmove",this.touchmove),ft.addEventListener(p,"touchend",this.touchend),ft.addEventListener(p,"touchcancel",this.reset)};function mu(u,p,l){if(u=new y.LngLat(u.lng,u.lat),p){var g=new y.LngLat(u.lng-360,u.lat),E=new y.LngLat(u.lng+360,u.lat),P=l.locationPoint(u).distSqr(p);l.locationPoint(g).distSqr(p)<P?u=g:l.locationPoint(E).distSqr(p)<P&&(u=E)}for(;Math.abs(u.lng-l.center.lng)>180;){var T=l.locationPoint(u);if(T.x>=0&&T.y>=0&&T.x<=l.width&&T.y<=l.height)break;u.lng>l.center.lng?u.lng-=360:u.lng+=360}return u}va.prototype.down=function(u,p){this.mouseRotate.mousedown(u,p),this.mousePitch&&this.mousePitch.mousedown(u,p),ft.disableDrag()},va.prototype.move=function(u,p){var l=this.map,g=this.mouseRotate.mousemoveWindow(u,p);if(g&&g.bearingDelta&&l.setBearing(l.getBearing()+g.bearingDelta),this.mousePitch){var E=this.mousePitch.mousemoveWindow(u,p);E&&E.pitchDelta&&l.setPitch(l.getPitch()+E.pitchDelta)}},va.prototype.off=function(){var u=this.element;ft.removeEventListener(u,"mousedown",this.mousedown),ft.removeEventListener(u,"touchstart",this.touchstart,{passive:!1}),ft.removeEventListener(u,"touchmove",this.touchmove),ft.removeEventListener(u,"touchend",this.touchend),ft.removeEventListener(u,"touchcancel",this.reset),this.offTemp()},va.prototype.offTemp=function(){ft.enableDrag(),ft.removeEventListener(y.window,"mousemove",this.mousemove),ft.removeEventListener(y.window,"mouseup",this.mouseup)},va.prototype.mousedown=function(u){this.down(y.extend({},u,{ctrlKey:!0,preventDefault:function(){return u.preventDefault()}}),ft.mousePos(this.element,u)),ft.addEventListener(y.window,"mousemove",this.mousemove),ft.addEventListener(y.window,"mouseup",this.mouseup)},va.prototype.mousemove=function(u){this.move(u,ft.mousePos(this.element,u))},va.prototype.mouseup=function(u){this.mouseRotate.mouseupWindow(u),this.mousePitch&&this.mousePitch.mouseupWindow(u),this.offTemp()},va.prototype.touchstart=function(u){1!==u.targetTouches.length?this.reset():(this._startPos=this._lastPos=ft.touchPos(this.element,u.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:function(){return u.preventDefault()}},this._startPos))},va.prototype.touchmove=function(u){1!==u.targetTouches.length?this.reset():(this._lastPos=ft.touchPos(this.element,u.targetTouches)[0],this.move({preventDefault:function(){return u.preventDefault()}},this._lastPos))},va.prototype.touchend=function(u){0===u.targetTouches.length&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()},va.prototype.reset=function(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()};var e={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function n(u,p,l){var g=u.classList;for(var E in e)g.remove("maplibregl-"+l+"-anchor-"+E,"mapboxgl-"+l+"-anchor-"+E);g.add("maplibregl-"+l+"-anchor-"+p,"mapboxgl-"+l+"-anchor-"+p)}var c,f=function(u){function p(l,g){if(u.call(this),(l instanceof y.window.HTMLElement||g)&&(l=y.extend({element:l},g)),y.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress"],this),this._anchor=l&&l.anchor||"center",this._color=l&&l.color||"#3FB1CE",this._scale=l&&l.scale||1,this._draggable=l&&l.draggable||!1,this._clickTolerance=l&&l.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=l&&l.rotation||0,this._rotationAlignment=l&&l.rotationAlignment||"auto",this._pitchAlignment=l&&l.pitchAlignment&&"auto"!==l.pitchAlignment?l.pitchAlignment:this._rotationAlignment,l&&l.element)this._element=l.element,this._offset=y.Point.convert(l&&l.offset||[0,0]);else{this._defaultMarker=!0,this._element=ft.create("div"),this._element.setAttribute("aria-label","Map marker");var E=ft.createNS("http://www.w3.org/2000/svg","svg");E.setAttributeNS(null,"display","block"),E.setAttributeNS(null,"height","41px"),E.setAttributeNS(null,"width","27px"),E.setAttributeNS(null,"viewBox","0 0 27 41");var P=ft.createNS("http://www.w3.org/2000/svg","g");P.setAttributeNS(null,"stroke","none"),P.setAttributeNS(null,"stroke-width","1"),P.setAttributeNS(null,"fill","none"),P.setAttributeNS(null,"fill-rule","evenodd");var T=ft.createNS("http://www.w3.org/2000/svg","g");T.setAttributeNS(null,"fill-rule","nonzero");var k=ft.createNS("http://www.w3.org/2000/svg","g");k.setAttributeNS(null,"transform","translate(3.0, 29.0)"),k.setAttributeNS(null,"fill","#000000");for(var q=0,H=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];q<H.length;q+=1){var ut=H[q],dt=ft.createNS("http://www.w3.org/2000/svg","ellipse");dt.setAttributeNS(null,"opacity","0.04"),dt.setAttributeNS(null,"cx","10.5"),dt.setAttributeNS(null,"cy","5.80029008"),dt.setAttributeNS(null,"rx",ut.rx),dt.setAttributeNS(null,"ry",ut.ry),k.appendChild(dt)}var lt=ft.createNS("http://www.w3.org/2000/svg","g");lt.setAttributeNS(null,"fill",this._color);var zt=ft.createNS("http://www.w3.org/2000/svg","path");zt.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),lt.appendChild(zt);var Rt=ft.createNS("http://www.w3.org/2000/svg","g");Rt.setAttributeNS(null,"opacity","0.25"),Rt.setAttributeNS(null,"fill","#000000");var jt=ft.createNS("http://www.w3.org/2000/svg","path");jt.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),Rt.appendChild(jt);var Dt=ft.createNS("http://www.w3.org/2000/svg","g");Dt.setAttributeNS(null,"transform","translate(6.0, 7.0)"),Dt.setAttributeNS(null,"fill","#FFFFFF");var qt=ft.createNS("http://www.w3.org/2000/svg","g");qt.setAttributeNS(null,"transform","translate(8.0, 8.0)");var ee=ft.createNS("http://www.w3.org/2000/svg","circle");ee.setAttributeNS(null,"fill","#000000"),ee.setAttributeNS(null,"opacity","0.25"),ee.setAttributeNS(null,"cx","5.5"),ee.setAttributeNS(null,"cy","5.5"),ee.setAttributeNS(null,"r","5.4999962");var oe=ft.createNS("http://www.w3.org/2000/svg","circle");oe.setAttributeNS(null,"fill","#FFFFFF"),oe.setAttributeNS(null,"cx","5.5"),oe.setAttributeNS(null,"cy","5.5"),oe.setAttributeNS(null,"r","5.4999962"),qt.appendChild(ee),qt.appendChild(oe),T.appendChild(k),T.appendChild(lt),T.appendChild(Rt),T.appendChild(Dt),T.appendChild(qt),E.appendChild(T),E.setAttributeNS(null,"height",41*this._scale+"px"),E.setAttributeNS(null,"width",27*this._scale+"px"),this._element.appendChild(E),this._offset=y.Point.convert(l&&l.offset||[0,-14])}this._element.classList.add("maplibregl-marker","mapboxgl-marker"),this._element.addEventListener("dragstart",function(Se){Se.preventDefault()}),this._element.addEventListener("mousedown",function(Se){Se.preventDefault()}),n(this._element,this._anchor,"marker"),this._popup=null}return u&&(p.__proto__=u),(p.prototype=Object.create(u&&u.prototype)).constructor=p,p.prototype.addTo=function(l){return this.remove(),this._map=l,l.getCanvasContainer().appendChild(this._element),l.on("move",this._update),l.on("moveend",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this},p.prototype.remove=function(){return this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),ft.remove(this._element),this._popup&&this._popup.remove(),this},p.prototype.getLngLat=function(){return this._lngLat},p.prototype.setLngLat=function(l){return this._lngLat=y.LngLat.convert(l),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this},p.prototype.getElement=function(){return this._element},p.prototype.setPopup=function(l){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),l){if(!("offset"in l.options)){var g=Math.sqrt(Math.pow(13.5,2)/2);l.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[g,-1*(24.6+g)],"bottom-right":[-g,-1*(24.6+g)],left:[13.5,-24.6],right:[-13.5,-24.6]}:this._offset}this._popup=l,this._lngLat&&this._popup.setLngLat(this._lngLat),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this},p.prototype._onKeyPress=function(l){var g=l.code,E=l.charCode||l.keyCode;"Space"!==g&&"Enter"!==g&&32!==E&&13!==E||this.togglePopup()},p.prototype._onMapClick=function(l){var g=l.originalEvent.target,E=this._element;this._popup&&(g===E||E.contains(g))&&this.togglePopup()},p.prototype.getPopup=function(){return this._popup},p.prototype.togglePopup=function(){var l=this._popup;return l?(l.isOpen()?l.remove():l.addTo(this._map),this):this},p.prototype._update=function(l){if(this._map){this._map.transform.renderWorldCopies&&(this._lngLat=mu(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._offset);var g="";"viewport"===this._rotationAlignment||"auto"===this._rotationAlignment?g="rotateZ("+this._rotation+"deg)":"map"===this._rotationAlignment&&(g="rotateZ("+(this._rotation-this._map.getBearing())+"deg)");var E="";"viewport"===this._pitchAlignment||"auto"===this._pitchAlignment?E="rotateX(0deg)":"map"===this._pitchAlignment&&(E="rotateX("+this._map.getPitch()+"deg)"),l&&"moveend"!==l.type||(this._pos=this._pos.round()),ft.setTransform(this._element,e[this._anchor]+" translate("+this._pos.x+"px, "+this._pos.y+"px) "+E+" "+g)}},p.prototype.getOffset=function(){return this._offset},p.prototype.setOffset=function(l){return this._offset=y.Point.convert(l),this._update(),this},p.prototype._onMove=function(l){if(!this._isDragging){var g=this._clickTolerance||this._map._clickTolerance;this._isDragging=l.point.dist(this._pointerdownPos)>=g}this._isDragging&&(this._pos=l.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none","pending"===this._state&&(this._state="active",this.fire(new y.Event("dragstart"))),this.fire(new y.Event("drag")))},p.prototype._onUp=function(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),"active"===this._state&&this.fire(new y.Event("dragend")),this._state="inactive"},p.prototype._addDragHandler=function(l){this._element.contains(l.originalEvent.target)&&(l.preventDefault(),this._positionDelta=l.point.sub(this._pos).add(this._offset),this._pointerdownPos=l.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},p.prototype.setDraggable=function(l){return this._draggable=!!l,this._map&&(l?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this},p.prototype.isDraggable=function(){return this._draggable},p.prototype.setRotation=function(l){return this._rotation=l||0,this._update(),this},p.prototype.getRotation=function(){return this._rotation},p.prototype.setRotationAlignment=function(l){return this._rotationAlignment=l||"auto",this._update(),this},p.prototype.getRotationAlignment=function(){return this._rotationAlignment},p.prototype.setPitchAlignment=function(l){return this._pitchAlignment=l&&"auto"!==l?l:this._rotationAlignment,this._update(),this},p.prototype.getPitchAlignment=function(){return this._pitchAlignment},p}(y.Evented),x={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0},L=0,z=!1,W=function(u){function p(l){u.call(this),this.options=y.extend({},x,l),y.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker"],this)}return u&&(p.__proto__=u),(p.prototype=Object.create(u&&u.prototype)).constructor=p,p.prototype.onAdd=function(l){var g;return this._map=l,this._container=ft.create("div","maplibregl-ctrl maplibregl-ctrl-group mapboxgl-ctrl mapboxgl-ctrl-group"),g=this._setupUI,void 0!==c?g(c):void 0!==y.window.navigator.permissions?y.window.navigator.permissions.query({name:"geolocation"}).then(function(E){g(c="denied"!==E.state)}):g(c=!!y.window.navigator.geolocation),this._container},p.prototype.onRemove=function(){void 0!==this._geolocationWatchID&&(y.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),ft.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,L=0,z=!1},p.prototype._isOutOfMapMaxBounds=function(l){var g=this._map.getMaxBounds(),E=l.coords;return g&&(E.longitude<g.getWest()||E.longitude>g.getEast()||E.latitude<g.getSouth()||E.latitude>g.getNorth())},p.prototype._setErrorState=function(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error","mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting")}},p.prototype._onSuccess=function(l){if(this._map){if(this._isOutOfMapMaxBounds(l))return this._setErrorState(),this.fire(new y.Event("outofmaxbounds",l)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=l,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error","mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&"OFF"!==this._watchState&&this._updateMarker(l),this.options.trackUserLocation&&"ACTIVE_LOCK"!==this._watchState||this._updateCamera(l),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale","mapboxgl-user-location-dot-stale"),this.fire(new y.Event("geolocate",l)),this._finish()}},p.prototype._updateCamera=function(l){var g=new y.LngLat(l.coords.longitude,l.coords.latitude),E=l.coords.accuracy,P=this._map.getBearing(),T=y.extend({bearing:P},this.options.fitBoundsOptions);this._map.fitBounds(g.toBounds(E),T,{geolocateSource:!0})},p.prototype._updateMarker=function(l){if(l){var g=new y.LngLat(l.coords.longitude,l.coords.latitude);this._accuracyCircleMarker.setLngLat(g).addTo(this._map),this._userLocationDotMarker.setLngLat(g).addTo(this._map),this._accuracy=l.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},p.prototype._updateCircleRadius=function(){var l=this._map._container.clientHeight/2,g=this._map.unproject([0,l]),E=this._map.unproject([1,l]),P=g.distanceTo(E),T=Math.ceil(2*this._accuracy/P);this._circleElement.style.width=T+"px",this._circleElement.style.height=T+"px"},p.prototype._onZoom=function(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},p.prototype._onError=function(l){if(this._map){if(this.options.trackUserLocation)if(1===l.code){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error","mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;var g=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=g,this._geolocateButton.setAttribute("aria-label",g),void 0!==this._geolocationWatchID&&this._clearWatch()}else{if(3===l.code&&z)return;this._setErrorState()}"OFF"!==this._watchState&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale","mapboxgl-user-location-dot-stale"),this.fire(new y.Event("error",l)),this._finish()}},p.prototype._finish=function(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},p.prototype._setupUI=function(l){var g=this;if(this._container.addEventListener("contextmenu",function(T){return T.preventDefault()}),this._geolocateButton=ft.create("button","maplibregl-ctrl-geolocate mapboxgl-ctrl-geolocate",this._container),ft.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden",!0),this._geolocateButton.type="button",!1===l){y.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");var E=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=E,this._geolocateButton.setAttribute("aria-label",E)}else{var P=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=P,this._geolocateButton.setAttribute("aria-label",P)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=ft.create("div","maplibregl-user-location-dot mapboxgl-user-location-dot"),this._userLocationDotMarker=new f(this._dotElement),this._circleElement=ft.create("div","maplibregl-user-location-accuracy-circle mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new f({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",function(T){T.geolocateSource||"ACTIVE_LOCK"!==g._watchState||T.originalEvent&&"resize"===T.originalEvent.type||(g._watchState="BACKGROUND",g._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),g._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),g.fire(new y.Event("trackuserlocationend")))})},p.prototype.trigger=function(){if(!this._setup)return y.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new y.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":L--,z=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error","mapboxgl-ctrl-geolocate-background-error"),this.fire(new y.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new y.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error","mapboxgl-ctrl-geolocate-background-error")}if("OFF"===this._watchState&&void 0!==this._geolocationWatchID)this._clearWatch();else if(void 0===this._geolocationWatchID){var l;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),++L>1?(l={maximumAge:6e5,timeout:0},z=!0):(l=this.options.positionOptions,z=!1),this._geolocationWatchID=y.window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,l)}}else y.window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0},p.prototype._clearWatch=function(){y.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)},p}(y.Evented),gt={maxWidth:100,unit:"metric"},Zt=function(u){this.options=y.extend({},gt,u),y.bindAll(["_onMove","setUnit"],this)};function Ie(u,p,l){var g=l&&l.maxWidth||100,E=u._container.clientHeight/2,P=u.unproject([0,E]),T=u.unproject([g,E]),k=P.distanceTo(T);if(l&&"imperial"===l.unit){var q=3.2808*k;q>5280?Me(p,g,q/5280,u._getUIString("ScaleControl.Miles")):Me(p,g,q,u._getUIString("ScaleControl.Feet"))}else l&&"nautical"===l.unit?Me(p,g,k/1852,u._getUIString("ScaleControl.NauticalMiles")):k>=1e3?Me(p,g,k/1e3,u._getUIString("ScaleControl.Kilometers")):Me(p,g,k,u._getUIString("ScaleControl.Meters"))}function Me(u,p,l,g){var E,P,T,q,H,k=(E=l,(P=Math.pow(10,(""+Math.floor(E)).length-1))*(T=(T=E/P)>=10?10:T>=5?5:T>=3?3:T>=2?2:T>=1?1:(q=T,H=Math.pow(10,Math.ceil(-Math.log(q)/Math.LN10)),Math.round(q*H)/H)));u.style.width=p*(k/l)+"px",u.innerHTML=k+"&nbsp;"+g}Zt.prototype.getDefaultPosition=function(){return"bottom-left"},Zt.prototype._onMove=function(){Ie(this._map,this._container,this.options)},Zt.prototype.onAdd=function(u){return this._map=u,this._container=ft.create("div","maplibregl-ctrl maplibregl-ctrl-scale mapboxgl-ctrl mapboxgl-ctrl-scale",u.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container},Zt.prototype.onRemove=function(){ft.remove(this._container),this._map.off("move",this._onMove),this._map=void 0},Zt.prototype.setUnit=function(u){this.options.unit=u,Ie(this._map,this._container,this.options)};var tr=function(u){this._fullscreen=!1,u&&u.container&&(u.container instanceof y.window.HTMLElement?this._container=u.container:y.warnOnce("Full screen control 'container' must be a DOM element.")),y.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in y.window.document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in y.window.document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in y.window.document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in y.window.document&&(this._fullscreenchange="MSFullscreenChange")};tr.prototype.onAdd=function(u){return this._map=u,this._container||(this._container=this._map.getContainer()),this._controlContainer=ft.create("div","maplibregl-ctrl maplibregl-ctrl-group mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",y.warnOnce("This device does not support fullscreen mode.")),this._controlContainer},tr.prototype.onRemove=function(){ft.remove(this._controlContainer),this._map=null,y.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)},tr.prototype._checkFullscreenSupport=function(){return!!(y.window.document.fullscreenEnabled||y.window.document.mozFullScreenEnabled||y.window.document.msFullscreenEnabled||y.window.document.webkitFullscreenEnabled)},tr.prototype._setupUI=function(){var u=this._fullscreenButton=ft.create("button","maplibregl-ctrl-fullscreen mapboxgl-ctrl-fullscreen",this._controlContainer);ft.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",u).setAttribute("aria-hidden",!0),u.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),y.window.document.addEventListener(this._fullscreenchange,this._changeIcon)},tr.prototype._updateTitle=function(){var u=this._getTitle();this._fullscreenButton.setAttribute("aria-label",u),this._fullscreenButton.title=u},tr.prototype._getTitle=function(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")},tr.prototype._isFullscreen=function(){return this._fullscreen},tr.prototype._changeIcon=function(){(y.window.document.fullscreenElement||y.window.document.mozFullScreenElement||y.window.document.webkitFullscreenElement||y.window.document.msFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())},tr.prototype._onClickFullscreen=function(){this._isFullscreen()?y.window.document.exitFullscreen?y.window.document.exitFullscreen():y.window.document.mozCancelFullScreen?y.window.document.mozCancelFullScreen():y.window.document.msExitFullscreen?y.window.document.msExitFullscreen():y.window.document.webkitCancelFullScreen&&y.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()};var mr={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},Ar=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", "),Xr=function(u){function p(l){u.call(this),this.options=y.extend(Object.create(mr),l),y.bindAll(["_update","_onClose","remove","_onMouseMove","_onMouseUp","_onDrag"],this)}return u&&(p.__proto__=u),(p.prototype=Object.create(u&&u.prototype)).constructor=p,p.prototype.addTo=function(l){return this._map&&this.remove(),this._map=l,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer","mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer","mapboxgl-track-pointer")):this._map.on("move",this._update),this.fire(new y.Event("open")),this},p.prototype.isOpen=function(){return!!this._map},p.prototype.remove=function(){return this._content&&ft.remove(this._content),this._container&&(ft.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),delete this._map),this.fire(new y.Event("close")),this},p.prototype.getLngLat=function(){return this._lngLat},p.prototype.setLngLat=function(l){return this._lngLat=y.LngLat.convert(l),this._pos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer","mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer","mapboxgl-track-pointer")),this},p.prototype.trackPointer=function(){return this._trackPointer=!0,this._pos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer","mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer","mapboxgl-track-pointer")),this},p.prototype.getElement=function(){return this._container},p.prototype.setText=function(l){return this.setDOMContent(y.window.document.createTextNode(l))},p.prototype.setHTML=function(l){var g,E=y.window.document.createDocumentFragment(),P=y.window.document.createElement("body");for(P.innerHTML=l;g=P.firstChild;)E.appendChild(g);return this.setDOMContent(E)},p.prototype.getMaxWidth=function(){return this._container&&this._container.style.maxWidth},p.prototype.setMaxWidth=function(l){return this.options.maxWidth=l,this._update(),this},p.prototype.setDOMContent=function(l){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=ft.create("div","maplibregl-popup-content mapboxgl-popup-content",this._container);return this._content.appendChild(l),this._createCloseButton(),this._update(),this._focusFirstElement(),this},p.prototype.addClassName=function(l){this._container&&this._container.classList.add(l)},p.prototype.removeClassName=function(l){this._container&&this._container.classList.remove(l)},p.prototype.setOffset=function(l){return this.options.offset=l,this._update(),this},p.prototype.toggleClassName=function(l){if(this._container)return this._container.classList.toggle(l)},p.prototype._createCloseButton=function(){this.options.closeButton&&(this._closeButton=ft.create("button","maplibregl-popup-close-button mapboxgl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))},p.prototype._onMouseUp=function(l){this._update(l.point)},p.prototype._onMouseMove=function(l){this._update(l.point)},p.prototype._onDrag=function(l){this._update(l.point)},p.prototype._update=function(l){var g=this;if(this._map&&(this._lngLat||this._trackPointer)&&this._content&&(this._container||(this._container=ft.create("div","maplibregl-popup mapboxgl-popup",this._map.getContainer()),this._tip=ft.create("div","maplibregl-popup-tip mapboxgl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className&&this.options.className.split(" ").forEach(function(dt){return g._container.classList.add(dt)}),this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer","mapboxgl-popup-track-pointer")),this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=mu(this._lngLat,this._pos,this._map.transform)),!this._trackPointer||l)){var E=this._pos=this._trackPointer&&l?l:this._map.project(this._lngLat),P=this.options.anchor,T=function dt(lt){if(lt){if("number"==typeof lt){var zt=Math.round(Math.sqrt(.5*Math.pow(lt,2)));return{center:new y.Point(0,0),top:new y.Point(0,lt),"top-left":new y.Point(zt,zt),"top-right":new y.Point(-zt,zt),bottom:new y.Point(0,-lt),"bottom-left":new y.Point(zt,-zt),"bottom-right":new y.Point(-zt,-zt),left:new y.Point(lt,0),right:new y.Point(-lt,0)}}if(lt instanceof y.Point||Array.isArray(lt)){var Rt=y.Point.convert(lt);return{center:Rt,top:Rt,"top-left":Rt,"top-right":Rt,bottom:Rt,"bottom-left":Rt,"bottom-right":Rt,left:Rt,right:Rt}}return{center:y.Point.convert(lt.center||[0,0]),top:y.Point.convert(lt.top||[0,0]),"top-left":y.Point.convert(lt["top-left"]||[0,0]),"top-right":y.Point.convert(lt["top-right"]||[0,0]),bottom:y.Point.convert(lt.bottom||[0,0]),"bottom-left":y.Point.convert(lt["bottom-left"]||[0,0]),"bottom-right":y.Point.convert(lt["bottom-right"]||[0,0]),left:y.Point.convert(lt.left||[0,0]),right:y.Point.convert(lt.right||[0,0])}}return dt(new y.Point(0,0))}(this.options.offset);if(!P){var k,q=this._container.offsetWidth,H=this._container.offsetHeight;k=E.y+T.bottom.y<H?["top"]:E.y>this._map.transform.height-H?["bottom"]:[],E.x<q/2?k.push("left"):E.x>this._map.transform.width-q/2&&k.push("right"),P=0===k.length?"bottom":k.join("-")}var ut=E.add(T[P]).round();ft.setTransform(this._container,e[P]+" translate("+ut.x+"px,"+ut.y+"px)"),n(this._container,P,"popup")}},p.prototype._focusFirstElement=function(){if(this.options.focusAfterOpen&&this._container){var l=this._container.querySelector(Ar);l&&l.focus()}},p.prototype._onClose=function(){this.remove()},p}(y.Evented),Wn={version:y.version,supported:Bt,setRTLTextPlugin:y.setRTLTextPlugin,getRTLTextPluginStatus:y.getRTLTextPluginStatus,Map:oi,NavigationControl:vi,GeolocateControl:W,AttributionControl:ho,ScaleControl:Zt,FullscreenControl:tr,Popup:Xr,Marker:f,Style:ja,LngLat:y.LngLat,LngLatBounds:y.LngLatBounds,Point:y.Point,MercatorCoordinate:y.MercatorCoordinate,Evented:y.Evented,config:y.config,prewarm:function(){Pr().acquire(ye)},clearPrewarmedResources:function(){var u=lr;u&&(u.isPreloaded()&&1===u.numActive()?(u.release(ye),lr=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return y.config.ACCESS_TOKEN},set accessToken(u){y.config.ACCESS_TOKEN=u},get baseApiUrl(){return y.config.API_URL},set baseApiUrl(u){y.config.API_URL=u},get workerCount(){return Le.workerCount},set workerCount(u){Le.workerCount=u},get maxParallelImageRequests(){return y.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(u){y.config.MAX_PARALLEL_IMAGE_REQUESTS=u},clearStorage:function(u){y.clearTileCache(u)},workerUrl:"",addProtocol:function(u,p){y.config.REGISTERED_PROTOCOLS[u]=p},removeProtocol:function(u){delete y.config.REGISTERED_PROTOCOLS[u]}};return Wn}),yt}()},8228:He=>{"use strict";var fe=Object.getOwnPropertySymbols,Et=Object.prototype.hasOwnProperty,yt=Object.prototype.propertyIsEnumerable;function D(Bt){if(null==Bt)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(Bt)}He.exports=function(){try{if(!Object.assign)return!1;var Bt=new String("abc");if(Bt[5]="de","5"===Object.getOwnPropertyNames(Bt)[0])return!1;for(var ft={},It=0;It<10;It++)ft["_"+String.fromCharCode(It)]=It;if("0123456789"!==Object.getOwnPropertyNames(ft).map(function(Jt){return ft[Jt]}).join(""))return!1;var he={};return"abcdefghijklmnopqrst".split("").forEach(function(Jt){he[Jt]=Jt}),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},he)).join("")}catch(Jt){return!1}}()?Object.assign:function(Bt,ft){for(var It,he,Ft=D(Bt),Jt=1;Jt<arguments.length;Jt++){for(var Ze in It=Object(arguments[Jt]))Et.call(It,Ze)&&(Ft[Ze]=It[Ze]);if(fe){he=fe(It);for(var ve=0;ve<he.length;ve++)yt.call(It,he[ve])&&(Ft[he[ve]]=It[he[ve]])}}return Ft}},7859:He=>{"use strict";var fe=function(Et){return Et!=Et};He.exports=function(yt,D){return 0===yt&&0===D?1/yt==1/D:!!(yt===D||fe(yt)&&fe(D))}},4269:(He,fe,Et)=>{"use strict";var yt=Et(6886),D=Et(44),y=Et(7859),Bt=Et(8593),ft=Et(6343),It=D(Bt(),Object);yt(It,{getPolyfill:Bt,implementation:y,shim:ft}),He.exports=It},8593:(He,fe,Et)=>{"use strict";var yt=Et(7859);He.exports=function(){return"function"==typeof Object.is?Object.is:yt}},6343:(He,fe,Et)=>{"use strict";var yt=Et(8593),D=Et(6886);He.exports=function(){var Bt=yt();return D(Object,{is:Bt},{is:function(){return Object.is!==Bt}}),Bt}},6068:(He,fe,Et)=>{"use strict";var yt;if(!Object.keys){var D=Object.prototype.hasOwnProperty,y=Object.prototype.toString,Bt=Et(2666),ft=Object.prototype.propertyIsEnumerable,It=!ft.call({toString:null},"toString"),Ft=ft.call(function(){},"prototype"),he=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],Jt=function(_e){var We=_e.constructor;return We&&We.prototype===_e},Ze={$applicationCache:!0,$console:!0,$external:!0,$frame:!0,$frameElement:!0,$frames:!0,$innerHeight:!0,$innerWidth:!0,$onmozfullscreenchange:!0,$onmozfullscreenerror:!0,$outerHeight:!0,$outerWidth:!0,$pageXOffset:!0,$pageYOffset:!0,$parent:!0,$scrollLeft:!0,$scrollTop:!0,$scrollX:!0,$scrollY:!0,$self:!0,$webkitIndexedDB:!0,$webkitStorageInfo:!0,$window:!0},ve=function(){if("undefined"==typeof window)return!1;for(var _e in window)try{if(!Ze["$"+_e]&&D.call(window,_e)&&null!==window[_e]&&"object"==typeof window[_e])try{Jt(window[_e])}catch(We){return!0}}catch(We){return!0}return!1}();yt=function(We){var kt=null!==We&&"object"==typeof We,ie="[object Function]"===y.call(We),X=Bt(We),J=kt&&"[object String]"===y.call(We),$=[];if(!kt&&!ie&&!X)throw new TypeError("Object.keys called on a non-object");var St=Ft&&ie;if(J&&We.length>0&&!D.call(We,0))for(var Q=0;Q<We.length;++Q)$.push(String(Q));if(X&&We.length>0)for(var et=0;et<We.length;++et)$.push(String(et));else for(var st in We)(!St||"prototype"!==st)&&D.call(We,st)&&$.push(String(st));if(It)for(var j=function(_e){if("undefined"==typeof window||!ve)return Jt(_e);try{return Jt(_e)}catch(We){return!1}}(We),$t=0;$t<he.length;++$t)(!j||"constructor"!==he[$t])&&D.call(We,he[$t])&&$.push(he[$t]);return $}}He.exports=yt},8507:(He,fe,Et)=>{"use strict";var yt=Array.prototype.slice,D=Et(2666),y=Object.keys,Bt=y?function(Ft){return y(Ft)}:Et(6068),ft=Object.keys;Bt.shim=function(){return Object.keys?function(){var he=Object.keys(arguments);return he&&he.length===arguments.length}(1,2)||(Object.keys=function(Jt){return D(Jt)?ft(yt.call(Jt)):ft(Jt)}):Object.keys=Bt,Object.keys||Bt},He.exports=Bt},2666:He=>{"use strict";var fe=Object.prototype.toString;He.exports=function(yt){var D=fe.call(yt),y="[object Arguments]"===D;return y||(y="[object Array]"!==D&&null!==yt&&"object"==typeof yt&&"number"==typeof yt.length&&yt.length>=0&&"[object Function]"===fe.call(yt.callee)),y}},5751:He=>{He.exports=function(Et,yt,D,y){var Bt=Et[0],ft=Et[1],It=!1;void 0===D&&(D=0),void 0===y&&(y=yt.length);for(var Ft=(y-D)/2,he=0,Jt=Ft-1;he<Ft;Jt=he++){var Ze=yt[D+2*he+0],ve=yt[D+2*he+1],_e=yt[D+2*Jt+1];ve>ft!=_e>ft&&Bt<(yt[D+2*Jt+0]-Ze)*(ft-ve)/(_e-ve)+Ze&&(It=!It)}return It}},5503:(He,fe,Et)=>{var yt=Et(5751),D=Et(5891);He.exports=function(Bt,ft,It,Ft){return ft.length>0&&Array.isArray(ft[0])?D(Bt,ft,It,Ft):yt(Bt,ft,It,Ft)},He.exports.nested=D,He.exports.flat=yt},5891:He=>{He.exports=function(Et,yt,D,y){var Bt=Et[0],ft=Et[1],It=!1;void 0===D&&(D=0),void 0===y&&(y=yt.length);for(var Ft=y-D,he=0,Jt=Ft-1;he<Ft;Jt=he++){var Ze=yt[he+D][0],ve=yt[he+D][1],_e=yt[Jt+D][1];ve>ft!=_e>ft&&Bt<(yt[Jt+D][0]-Ze)*(ft-ve)/(_e-ve)+Ze&&(It=!It)}return It}},171:function(He){He.exports=function(){"use strict";function fe(le,ot){if(!(le instanceof ot))throw new TypeError("Cannot call a class as a function")}function Et(le,ot){for(var rt=0;rt<ot.length;rt++){var tt=ot[rt];tt.enumerable=tt.enumerable||!1,tt.configurable=!0,"value"in tt&&(tt.writable=!0),Object.defineProperty(le,tt.key,tt)}}function yt(le,ot,rt){return ot&&Et(le.prototype,ot),rt&&Et(le,rt),le}var D=function(ot,rt){this.next=null,this.key=ot,this.data=rt,this.left=null,this.right=null};function y(le,ot){return le>ot?1:le<ot?-1:0}function Bt(le,ot,rt){for(var tt=new D(null,null),Pt=tt,Kt=tt;;){var Ee=rt(le,ot.key);if(Ee<0){if(null===ot.left)break;if(rt(le,ot.left.key)<0&&(ot.left=(Ge=ot.left).right,Ge.right=ot,null===(ot=Ge).left))break;Kt.left=ot,Kt=ot,ot=ot.left}else{if(!(Ee>0))break;if(null===ot.right)break;var Ge;if(rt(le,ot.right.key)>0&&(ot.right=(Ge=ot.right).left,Ge.left=ot,null===(ot=Ge).right))break;Pt.right=ot,Pt=ot,ot=ot.right}}return Pt.right=ot.left,Kt.left=ot.right,ot.left=tt.right,ot.right=tt.left,ot}function ft(le,ot,rt,tt){var Pt=new D(le,ot);if(null===rt)return Pt.left=Pt.right=null,Pt;var Kt=tt(le,(rt=Bt(le,rt,tt)).key);return Kt<0?(Pt.left=rt.left,Pt.right=rt,rt.left=null):Kt>=0&&(Pt.right=rt.right,Pt.left=rt,rt.right=null),Pt}function It(le,ot,rt){var tt=null,Pt=null;if(ot){var Kt=rt((ot=Bt(le,ot,rt)).key,le);0===Kt?(tt=ot.left,Pt=ot.right):Kt<0?(Pt=ot.right,ot.right=null,tt=ot):(tt=ot.left,ot.left=null,Pt=ot)}return{left:tt,right:Pt}}function he(le,ot,rt,tt,Pt){if(le){tt(ot+(rt?"\u2514\u2500\u2500 ":"\u251c\u2500\u2500 ")+Pt(le)+"\n");var Kt=ot+(rt?"    ":"\u2502   ");le.left&&he(le.left,Kt,!1,tt,Pt),le.right&&he(le.right,Kt,!0,tt,Pt)}}var Jt=function(){function le(ot){void 0===ot&&(ot=y),this._root=null,this._size=0,this._comparator=ot}return le.prototype.insert=function(ot,rt){return this._size++,this._root=ft(ot,rt,this._root,this._comparator)},le.prototype.add=function(ot,rt){var tt=new D(ot,rt);null===this._root&&(tt.left=tt.right=null,this._size++,this._root=tt);var Pt=this._comparator,Kt=Bt(ot,this._root,Pt),Ee=Pt(ot,Kt.key);return 0===Ee?this._root=Kt:(Ee<0?(tt.left=Kt.left,tt.right=Kt,Kt.left=null):Ee>0&&(tt.right=Kt.right,tt.left=Kt,Kt.right=null),this._size++,this._root=tt),this._root},le.prototype.remove=function(ot){this._root=this._remove(ot,this._root,this._comparator)},le.prototype._remove=function(ot,rt,tt){var Pt;return null===rt?null:0===tt(ot,(rt=Bt(ot,rt,tt)).key)?(null===rt.left?Pt=rt.right:(Pt=Bt(ot,rt.left,tt)).right=rt.right,this._size--,Pt):rt},le.prototype.pop=function(){var ot=this._root;if(ot){for(;ot.left;)ot=ot.left;return this._root=Bt(ot.key,this._root,this._comparator),this._root=this._remove(ot.key,this._root,this._comparator),{key:ot.key,data:ot.data}}return null},le.prototype.findStatic=function(ot){for(var rt=this._root,tt=this._comparator;rt;){var Pt=tt(ot,rt.key);if(0===Pt)return rt;rt=Pt<0?rt.left:rt.right}return null},le.prototype.find=function(ot){return this._root&&(this._root=Bt(ot,this._root,this._comparator),0!==this._comparator(ot,this._root.key))?null:this._root},le.prototype.contains=function(ot){for(var rt=this._root,tt=this._comparator;rt;){var Pt=tt(ot,rt.key);if(0===Pt)return!0;rt=Pt<0?rt.left:rt.right}return!1},le.prototype.forEach=function(ot,rt){for(var tt=this._root,Pt=[],Kt=!1;!Kt;)null!==tt?(Pt.push(tt),tt=tt.left):0!==Pt.length?(tt=Pt.pop(),ot.call(rt,tt),tt=tt.right):Kt=!0;return this},le.prototype.range=function(ot,rt,tt,Pt){for(var Kt=[],Ee=this._comparator,Ge=this._root;0!==Kt.length||Ge;)if(Ge)Kt.push(Ge),Ge=Ge.left;else{if(Ee((Ge=Kt.pop()).key,rt)>0)break;if(Ee(Ge.key,ot)>=0&&tt.call(Pt,Ge))return this;Ge=Ge.right}return this},le.prototype.keys=function(){var ot=[];return this.forEach(function(rt){return ot.push(rt.key)}),ot},le.prototype.values=function(){var ot=[];return this.forEach(function(rt){return ot.push(rt.data)}),ot},le.prototype.min=function(){return this._root?this.minNode(this._root).key:null},le.prototype.max=function(){return this._root?this.maxNode(this._root).key:null},le.prototype.minNode=function(ot){if(void 0===ot&&(ot=this._root),ot)for(;ot.left;)ot=ot.left;return ot},le.prototype.maxNode=function(ot){if(void 0===ot&&(ot=this._root),ot)for(;ot.right;)ot=ot.right;return ot},le.prototype.at=function(ot){for(var rt=this._root,tt=!1,Pt=0,Kt=[];!tt;)if(rt)Kt.push(rt),rt=rt.left;else if(Kt.length>0){if(rt=Kt.pop(),Pt===ot)return rt;Pt++,rt=rt.right}else tt=!0;return null},le.prototype.next=function(ot){var rt=this._root,tt=null;if(ot.right){for(tt=ot.right;tt.left;)tt=tt.left;return tt}for(var Pt=this._comparator;rt;){var Kt=Pt(ot.key,rt.key);if(0===Kt)break;Kt<0?(tt=rt,rt=rt.left):rt=rt.right}return tt},le.prototype.prev=function(ot){var rt=this._root,tt=null;if(null!==ot.left){for(tt=ot.left;tt.right;)tt=tt.right;return tt}for(var Pt=this._comparator;rt;){var Kt=Pt(ot.key,rt.key);if(0===Kt)break;Kt<0?rt=rt.left:(tt=rt,rt=rt.right)}return tt},le.prototype.clear=function(){return this._root=null,this._size=0,this},le.prototype.toList=function(){return function(le){for(var ot=le,rt=[],tt=!1,Pt=new D(null,null),Kt=Pt;!tt;)ot?(rt.push(ot),ot=ot.left):rt.length>0?ot=(ot=Kt=Kt.next=rt.pop()).right:tt=!0;return Kt.next=null,Pt.next}(this._root)},le.prototype.load=function(ot,rt,tt){void 0===rt&&(rt=[]),void 0===tt&&(tt=!1);var Pt=ot.length,Kt=this._comparator;if(tt&&kt(ot,rt,0,Pt-1,Kt),null===this._root)this._root=Ze(ot,rt,0,Pt),this._size=Pt;else{var Ee=function(le,ot,rt){for(var tt=new D(null,null),Pt=tt,Kt=le,Ee=ot;null!==Kt&&null!==Ee;)rt(Kt.key,Ee.key)<0?(Pt.next=Kt,Kt=Kt.next):(Pt.next=Ee,Ee=Ee.next),Pt=Pt.next;return null!==Kt?Pt.next=Kt:null!==Ee&&(Pt.next=Ee),tt.next}(this.toList(),function(le,ot){for(var rt=new D(null,null),tt=rt,Pt=0;Pt<le.length;Pt++)tt=tt.next=new D(le[Pt],ot[Pt]);return tt.next=null,rt.next}(ot,rt),Kt);this._root=_e({head:Ee},0,Pt=this._size+Pt)}return this},le.prototype.isEmpty=function(){return null===this._root},Object.defineProperty(le.prototype,"size",{get:function(){return this._size},enumerable:!0,configurable:!0}),Object.defineProperty(le.prototype,"root",{get:function(){return this._root},enumerable:!0,configurable:!0}),le.prototype.toString=function(ot){void 0===ot&&(ot=function(Pt){return String(Pt.key)});var rt=[];return he(this._root,"",!0,function(tt){return rt.push(tt)},ot),rt.join("")},le.prototype.update=function(ot,rt,tt){var Pt=this._comparator,Kt=It(ot,this._root,Pt),Ee=Kt.left,Ge=Kt.right;Pt(ot,rt)<0?Ge=ft(rt,tt,Ge,Pt):Ee=ft(rt,tt,Ee,Pt),this._root=function(le,ot,rt){return null===ot?le:(null===le||((ot=Bt(le.key,ot,rt)).left=le),ot)}(Ee,Ge,Pt)},le.prototype.split=function(ot){return It(ot,this._root,this._comparator)},le}();function Ze(le,ot,rt,tt){var Pt=tt-rt;if(Pt>0){var Kt=rt+Math.floor(Pt/2),Xe=new D(le[Kt],ot[Kt]);return Xe.left=Ze(le,ot,rt,Kt),Xe.right=Ze(le,ot,Kt+1,tt),Xe}return null}function _e(le,ot,rt){var tt=rt-ot;if(tt>0){var Pt=ot+Math.floor(tt/2),Kt=_e(le,ot,Pt),Ee=le.head;return Ee.left=Kt,le.head=le.head.next,Ee.right=_e(le,Pt+1,rt),Ee}return null}function kt(le,ot,rt,tt,Pt){if(!(rt>=tt)){for(var Kt=le[rt+tt>>1],Ee=rt-1,Ge=tt+1;;){do{Ee++}while(Pt(le[Ee],Kt)<0);do{Ge--}while(Pt(le[Ge],Kt)>0);if(Ee>=Ge)break;var Xe=le[Ee];le[Ee]=le[Ge],le[Ge]=Xe,Xe=ot[Ee],ot[Ee]=ot[Ge],ot[Ge]=Xe}kt(le,ot,rt,Ge,Pt),kt(le,ot,Ge+1,tt,Pt)}}var ie=function(ot,rt){return ot.ll.x<=rt.x&&rt.x<=ot.ur.x&&ot.ll.y<=rt.y&&rt.y<=ot.ur.y},X=function(ot,rt){return rt.ur.x<ot.ll.x||ot.ur.x<rt.ll.x||rt.ur.y<ot.ll.y||ot.ur.y<rt.ll.y?null:{ll:{x:ot.ll.x<rt.ll.x?rt.ll.x:ot.ll.x,y:ot.ll.y<rt.ll.y?rt.ll.y:ot.ll.y},ur:{x:ot.ur.x<rt.ur.x?ot.ur.x:rt.ur.x,y:ot.ur.y<rt.ur.y?ot.ur.y:rt.ur.y}}},J=Number.EPSILON;void 0===J&&(J=Math.pow(2,-52));var $=J*J,St=function(ot,rt){if(-J<ot&&ot<J&&-J<rt&&rt<J)return 0;var tt=ot-rt;return tt*tt<$*ot*rt?0:ot<rt?-1:1},Q=function(){function le(){fe(this,le),this.reset()}return yt(le,[{key:"reset",value:function(){this.xRounder=new et,this.yRounder=new et}},{key:"round",value:function(rt,tt){return{x:this.xRounder.round(rt),y:this.yRounder.round(tt)}}}]),le}(),et=function(){function le(){fe(this,le),this.tree=new Jt,this.round(0)}return yt(le,[{key:"round",value:function(rt){var tt=this.tree.add(rt),Pt=this.tree.prev(tt);if(null!==Pt&&0===St(tt.key,Pt.key))return this.tree.remove(rt),Pt.key;var Kt=this.tree.next(tt);return null!==Kt&&0===St(tt.key,Kt.key)?(this.tree.remove(rt),Kt.key):rt}}]),le}(),st=new Q,j=function(ot,rt){return ot.x*rt.y-ot.y*rt.x},$t=function(ot,rt){return ot.x*rt.x+ot.y*rt.y},bt=function(ot,rt,tt){var Ee=j({x:rt.x-ot.x,y:rt.y-ot.y},{x:tt.x-ot.x,y:tt.y-ot.y});return St(Ee,0)},Mt=function(ot){return Math.sqrt($t(ot,ot))},ct=function(ot,rt,tt){var Pt={x:rt.x-ot.x,y:rt.y-ot.y},Kt={x:tt.x-ot.x,y:tt.y-ot.y};return j(Kt,Pt)/Mt(Kt)/Mt(Pt)},ze=function(ot,rt,tt){var Pt={x:rt.x-ot.x,y:rt.y-ot.y},Kt={x:tt.x-ot.x,y:tt.y-ot.y};return $t(Kt,Pt)/Mt(Kt)/Mt(Pt)},Te=function(ot,rt,tt){return 0===rt.y?null:{x:ot.x+rt.x/rt.y*(tt-ot.y),y:tt}},wt=function(ot,rt,tt){return 0===rt.x?null:{x:tt,y:ot.y+rt.y/rt.x*(tt-ot.x)}},Tt=function(){function le(ot,rt){fe(this,le),void 0===ot.events?ot.events=[this]:ot.events.push(this),this.point=ot,this.isLeft=rt}return yt(le,null,[{key:"compare",value:function(rt,tt){var Pt=le.comparePoints(rt.point,tt.point);return 0!==Pt?Pt:(rt.point!==tt.point&&rt.link(tt),rt.isLeft!==tt.isLeft?rt.isLeft?1:-1:Qt.compare(rt.segment,tt.segment))}},{key:"comparePoints",value:function(rt,tt){return rt.x<tt.x?-1:rt.x>tt.x?1:rt.y<tt.y?-1:rt.y>tt.y?1:0}}]),yt(le,[{key:"link",value:function(rt){if(rt.point===this.point)throw new Error("Tried to link already linked events");for(var tt=rt.point.events,Pt=0,Kt=tt.length;Pt<Kt;Pt++){var Ee=tt[Pt];this.point.events.push(Ee),Ee.point=this.point}this.checkForConsuming()}},{key:"checkForConsuming",value:function(){for(var rt=this.point.events.length,tt=0;tt<rt;tt++){var Pt=this.point.events[tt];if(void 0===Pt.segment.consumedBy)for(var Kt=tt+1;Kt<rt;Kt++){var Ee=this.point.events[Kt];void 0===Ee.consumedBy&&Pt.otherSE.point.events===Ee.otherSE.point.events&&Pt.segment.consume(Ee.segment)}}}},{key:"getAvailableLinkedEvents",value:function(){for(var rt=[],tt=0,Pt=this.point.events.length;tt<Pt;tt++){var Kt=this.point.events[tt];Kt!==this&&!Kt.segment.ringOut&&Kt.segment.isInResult()&&rt.push(Kt)}return rt}},{key:"getLeftmostComparator",value:function(rt){var tt=this,Pt=new Map,Kt=function(Ge){var Xe=Ge.otherSE;Pt.set(Ge,{sine:ct(tt.point,rt.point,Xe.point),cosine:ze(tt.point,rt.point,Xe.point)})};return function(Ee,Ge){Pt.has(Ee)||Kt(Ee),Pt.has(Ge)||Kt(Ge);var Xe=Pt.get(Ee),Re=Xe.sine,rn=Xe.cosine,cn=Pt.get(Ge),ur=cn.sine,Jr=cn.cosine;return Re>=0&&ur>=0?rn<Jr?1:rn>Jr?-1:0:Re<0&&ur<0?rn<Jr?-1:rn>Jr?1:0:ur<Re?-1:ur>Re?1:0}}}]),le}(),Ht=0,Qt=function(){function le(ot,rt,tt,Pt){fe(this,le),this.id=++Ht,this.leftSE=ot,ot.segment=this,ot.otherSE=rt,this.rightSE=rt,rt.segment=this,rt.otherSE=ot,this.rings=tt,this.windings=Pt}return yt(le,null,[{key:"compare",value:function(rt,tt){var Pt=rt.leftSE.point.x,Kt=tt.leftSE.point.x,Ee=rt.rightSE.point.x,Ge=tt.rightSE.point.x;if(Ge<Pt)return 1;if(Ee<Kt)return-1;var Xe=rt.leftSE.point.y,Re=tt.leftSE.point.y,rn=rt.rightSE.point.y,cn=tt.rightSE.point.y;if(Pt<Kt){if(Re<Xe&&Re<rn)return 1;if(Re>Xe&&Re>rn)return-1;var ur=rt.comparePoint(tt.leftSE.point);if(ur<0)return 1;if(ur>0)return-1;var Jr=tt.comparePoint(rt.rightSE.point);return 0!==Jr?Jr:-1}if(Pt>Kt){if(Xe<Re&&Xe<cn)return-1;if(Xe>Re&&Xe>cn)return 1;var di=tt.comparePoint(rt.leftSE.point);if(0!==di)return di;var On=rt.comparePoint(tt.rightSE.point);return On<0?1:On>0?-1:1}if(Xe<Re)return-1;if(Xe>Re)return 1;if(Ee<Ge){var Nn=tt.comparePoint(rt.rightSE.point);if(0!==Nn)return Nn}if(Ee>Ge){var _i=rt.comparePoint(tt.rightSE.point);if(_i<0)return 1;if(_i>0)return-1}if(Ee!==Ge){var ji=rn-Xe,fo=Ee-Pt,Xi=cn-Re,to=Ge-Kt;if(ji>fo&&Xi<to)return 1;if(ji<fo&&Xi>to)return-1}return Ee>Ge?1:Ee<Ge||rn<cn?-1:rn>cn?1:rt.id<tt.id?-1:rt.id>tt.id?1:0}}]),yt(le,[{key:"replaceRightSE",value:function(rt){this.rightSE=rt,this.rightSE.segment=this,this.rightSE.otherSE=this.leftSE,this.leftSE.otherSE=this.rightSE}},{key:"bbox",value:function(){var rt=this.leftSE.point.y,tt=this.rightSE.point.y;return{ll:{x:this.leftSE.point.x,y:rt<tt?rt:tt},ur:{x:this.rightSE.point.x,y:rt>tt?rt:tt}}}},{key:"vector",value:function(){return{x:this.rightSE.point.x-this.leftSE.point.x,y:this.rightSE.point.y-this.leftSE.point.y}}},{key:"isAnEndpoint",value:function(rt){return rt.x===this.leftSE.point.x&&rt.y===this.leftSE.point.y||rt.x===this.rightSE.point.x&&rt.y===this.rightSE.point.y}},{key:"comparePoint",value:function(rt){if(this.isAnEndpoint(rt))return 0;var tt=this.leftSE.point,Pt=this.rightSE.point,Kt=this.vector();if(tt.x===Pt.x)return rt.x===tt.x?0:rt.x<tt.x?1:-1;if(rt.x===tt.x+(rt.y-tt.y)/Kt.y*Kt.x)return 0;var Re=tt.y+(rt.x-tt.x)/Kt.x*Kt.y;return rt.y===Re?0:rt.y<Re?-1:1}},{key:"getIntersection",value:function(rt){var tt=this.bbox(),Pt=rt.bbox(),Kt=X(tt,Pt);if(null===Kt)return null;var Ee=this.leftSE.point,Ge=this.rightSE.point,Xe=rt.leftSE.point,Re=rt.rightSE.point,rn=ie(tt,Xe)&&0===this.comparePoint(Xe),cn=ie(Pt,Ee)&&0===rt.comparePoint(Ee),ur=ie(tt,Re)&&0===this.comparePoint(Re),Jr=ie(Pt,Ge)&&0===rt.comparePoint(Ge);if(cn&&rn)return Jr&&!ur?Ge:!Jr&&ur?Re:null;if(cn)return ur&&Ee.x===Re.x&&Ee.y===Re.y?null:Ee;if(rn)return Jr&&Ge.x===Xe.x&&Ge.y===Xe.y?null:Xe;if(Jr&&ur)return null;if(Jr)return Ge;if(ur)return Re;var di=function(ot,rt,tt,Pt){if(0===rt.x)return wt(tt,Pt,ot.x);if(0===Pt.x)return wt(ot,rt,tt.x);if(0===rt.y)return Te(tt,Pt,ot.y);if(0===Pt.y)return Te(ot,rt,tt.y);var Kt=j(rt,Pt);if(0==Kt)return null;var Ee={x:tt.x-ot.x,y:tt.y-ot.y},Ge=j(Ee,rt)/Kt,Xe=j(Ee,Pt)/Kt;return{x:(ot.x+Xe*rt.x+(tt.x+Ge*Pt.x))/2,y:(ot.y+Xe*rt.y+(tt.y+Ge*Pt.y))/2}}(Ee,this.vector(),Xe,rt.vector());return null!==di&&ie(Kt,di)?st.round(di.x,di.y):null}},{key:"split",value:function(rt){var tt=[],Pt=void 0!==rt.events,Kt=new Tt(rt,!0),Ee=new Tt(rt,!1),Ge=this.rightSE;this.replaceRightSE(Ee),tt.push(Ee),tt.push(Kt);var Xe=new le(Kt,Ge,this.rings.slice(),this.windings.slice());return Tt.comparePoints(Xe.leftSE.point,Xe.rightSE.point)>0&&Xe.swapEvents(),Tt.comparePoints(this.leftSE.point,this.rightSE.point)>0&&this.swapEvents(),Pt&&(Kt.checkForConsuming(),Ee.checkForConsuming()),tt}},{key:"swapEvents",value:function(){var rt=this.rightSE;this.rightSE=this.leftSE,this.leftSE=rt,this.leftSE.isLeft=!0,this.rightSE.isLeft=!1;for(var tt=0,Pt=this.windings.length;tt<Pt;tt++)this.windings[tt]*=-1}},{key:"consume",value:function(rt){for(var tt=this,Pt=rt;tt.consumedBy;)tt=tt.consumedBy;for(;Pt.consumedBy;)Pt=Pt.consumedBy;var Kt=le.compare(tt,Pt);if(0!==Kt){if(Kt>0){var Ee=tt;tt=Pt,Pt=Ee}if(tt.prev===Pt){var Ge=tt;tt=Pt,Pt=Ge}for(var Xe=0,Re=Pt.rings.length;Xe<Re;Xe++){var rn=Pt.rings[Xe],cn=Pt.windings[Xe],ur=tt.rings.indexOf(rn);-1===ur?(tt.rings.push(rn),tt.windings.push(cn)):tt.windings[ur]+=cn}Pt.rings=null,Pt.windings=null,Pt.consumedBy=tt,Pt.leftSE.consumedBy=tt.leftSE,Pt.rightSE.consumedBy=tt.rightSE}}},{key:"prevInResult",value:function(){return void 0!==this._prevInResult||(this._prevInResult=this.prev?this.prev.isInResult()?this.prev:this.prev.prevInResult():null),this._prevInResult}},{key:"beforeState",value:function(){return void 0!==this._beforeState||(this._beforeState=this.prev?(this.prev.consumedBy||this.prev).afterState():{rings:[],windings:[],multiPolys:[]}),this._beforeState}},{key:"afterState",value:function(){if(void 0!==this._afterState)return this._afterState;var rt=this.beforeState();this._afterState={rings:rt.rings.slice(0),windings:rt.windings.slice(0),multiPolys:[]};for(var tt=this._afterState.rings,Pt=this._afterState.windings,Kt=this._afterState.multiPolys,Ee=0,Ge=this.rings.length;Ee<Ge;Ee++){var Xe=this.rings[Ee],Re=this.windings[Ee],rn=tt.indexOf(Xe);-1===rn?(tt.push(Xe),Pt.push(Re)):Pt[rn]+=Re}for(var cn=[],ur=[],Jr=0,di=tt.length;Jr<di;Jr++)if(0!==Pt[Jr]){var On=tt[Jr],Nn=On.poly;if(-1===ur.indexOf(Nn))if(On.isExterior)cn.push(Nn);else{-1===ur.indexOf(Nn)&&ur.push(Nn);var _i=cn.indexOf(On.poly);-1!==_i&&cn.splice(_i,1)}}for(var ji=0,fo=cn.length;ji<fo;ji++){var Xi=cn[ji].multiPoly;-1===Kt.indexOf(Xi)&&Kt.push(Xi)}return this._afterState}},{key:"isInResult",value:function(){if(this.consumedBy)return!1;if(void 0!==this._isInResult)return this._isInResult;var rt=this.beforeState().multiPolys,tt=this.afterState().multiPolys;switch(ke.type){case"union":this._isInResult=0===rt.length!=(0===tt.length);break;case"intersection":var Ee,Ge;rt.length<tt.length?(Ee=rt.length,Ge=tt.length):(Ee=tt.length,Ge=rt.length),this._isInResult=Ge===ke.numMultiPolys&&Ee<Ge;break;case"xor":var Xe=Math.abs(rt.length-tt.length);this._isInResult=Xe%2==1;break;case"difference":var Re=function(cn){return 1===cn.length&&cn[0].isSubject};this._isInResult=Re(rt)!==Re(tt);break;default:throw new Error("Unrecognized operation type found ".concat(ke.type))}return this._isInResult}}],[{key:"fromRing",value:function(rt,tt,Pt){var Kt,Ee,Ge,Xe=Tt.comparePoints(rt,tt);if(Xe<0)Kt=rt,Ee=tt,Ge=1;else{if(!(Xe>0))throw new Error("Tried to create degenerate segment at [".concat(rt.x,", ").concat(rt.y,"]"));Kt=tt,Ee=rt,Ge=-1}return new le(new Tt(Kt,!0),new Tt(Ee,!1),[Pt],[Ge])}}]),le}(),vt=function(){function le(ot,rt,tt){if(fe(this,le),!Array.isArray(ot)||0===ot.length)throw new Error("Input geometry is not a valid Polygon or MultiPolygon");if(this.poly=rt,this.isExterior=tt,this.segments=[],"number"!=typeof ot[0][0]||"number"!=typeof ot[0][1])throw new Error("Input geometry is not a valid Polygon or MultiPolygon");var Pt=st.round(ot[0][0],ot[0][1]);this.bbox={ll:{x:Pt.x,y:Pt.y},ur:{x:Pt.x,y:Pt.y}};for(var Kt=Pt,Ee=1,Ge=ot.length;Ee<Ge;Ee++){if("number"!=typeof ot[Ee][0]||"number"!=typeof ot[Ee][1])throw new Error("Input geometry is not a valid Polygon or MultiPolygon");var Xe=st.round(ot[Ee][0],ot[Ee][1]);Xe.x===Kt.x&&Xe.y===Kt.y||(this.segments.push(Qt.fromRing(Kt,Xe,this)),Xe.x<this.bbox.ll.x&&(this.bbox.ll.x=Xe.x),Xe.y<this.bbox.ll.y&&(this.bbox.ll.y=Xe.y),Xe.x>this.bbox.ur.x&&(this.bbox.ur.x=Xe.x),Xe.y>this.bbox.ur.y&&(this.bbox.ur.y=Xe.y),Kt=Xe)}(Pt.x!==Kt.x||Pt.y!==Kt.y)&&this.segments.push(Qt.fromRing(Kt,Pt,this))}return yt(le,[{key:"getSweepEvents",value:function(){for(var rt=[],tt=0,Pt=this.segments.length;tt<Pt;tt++){var Kt=this.segments[tt];rt.push(Kt.leftSE),rt.push(Kt.rightSE)}return rt}}]),le}(),we=function(){function le(ot,rt){if(fe(this,le),!Array.isArray(ot))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");this.exteriorRing=new vt(ot[0],this,!0),this.bbox={ll:{x:this.exteriorRing.bbox.ll.x,y:this.exteriorRing.bbox.ll.y},ur:{x:this.exteriorRing.bbox.ur.x,y:this.exteriorRing.bbox.ur.y}},this.interiorRings=[];for(var tt=1,Pt=ot.length;tt<Pt;tt++){var Kt=new vt(ot[tt],this,!1);Kt.bbox.ll.x<this.bbox.ll.x&&(this.bbox.ll.x=Kt.bbox.ll.x),Kt.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=Kt.bbox.ll.y),Kt.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=Kt.bbox.ur.x),Kt.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=Kt.bbox.ur.y),this.interiorRings.push(Kt)}this.multiPoly=rt}return yt(le,[{key:"getSweepEvents",value:function(){for(var rt=this.exteriorRing.getSweepEvents(),tt=0,Pt=this.interiorRings.length;tt<Pt;tt++)for(var Kt=this.interiorRings[tt].getSweepEvents(),Ee=0,Ge=Kt.length;Ee<Ge;Ee++)rt.push(Kt[Ee]);return rt}}]),le}(),Fe=function(){function le(ot,rt){if(fe(this,le),!Array.isArray(ot))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");try{"number"==typeof ot[0][0][0]&&(ot=[ot])}catch(Ee){}this.polys=[],this.bbox={ll:{x:Number.POSITIVE_INFINITY,y:Number.POSITIVE_INFINITY},ur:{x:Number.NEGATIVE_INFINITY,y:Number.NEGATIVE_INFINITY}};for(var tt=0,Pt=ot.length;tt<Pt;tt++){var Kt=new we(ot[tt],this);Kt.bbox.ll.x<this.bbox.ll.x&&(this.bbox.ll.x=Kt.bbox.ll.x),Kt.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=Kt.bbox.ll.y),Kt.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=Kt.bbox.ur.x),Kt.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=Kt.bbox.ur.y),this.polys.push(Kt)}this.isSubject=rt}return yt(le,[{key:"getSweepEvents",value:function(){for(var rt=[],tt=0,Pt=this.polys.length;tt<Pt;tt++)for(var Kt=this.polys[tt].getSweepEvents(),Ee=0,Ge=Kt.length;Ee<Ge;Ee++)rt.push(Kt[Ee]);return rt}}]),le}(),Er=function(){function le(ot){fe(this,le),this.events=ot;for(var rt=0,tt=ot.length;rt<tt;rt++)ot[rt].segment.ringOut=this;this.poly=null}return yt(le,null,[{key:"factory",value:function(rt){for(var tt=[],Pt=0,Kt=rt.length;Pt<Kt;Pt++){var Ee=rt[Pt];if(Ee.isInResult()&&!Ee.ringOut){for(var Ge=null,Xe=Ee.leftSE,Re=Ee.rightSE,rn=[Xe],cn=Xe.point,ur=[];Ge=Xe,rn.push(Xe=Re),Xe.point!==cn;)for(;;){var Jr=Xe.getAvailableLinkedEvents();if(0===Jr.length){var di=rn[0].point,On=rn[rn.length-1].point;throw new Error("Unable to complete output ring starting at [".concat(di.x,",")+" ".concat(di.y,"]. Last matching segment found ends at")+" [".concat(On.x,", ").concat(On.y,"]."))}if(1===Jr.length){Re=Jr[0].otherSE;break}for(var Nn=null,_i=0,ji=ur.length;_i<ji;_i++)if(ur[_i].point===Xe.point){Nn=_i;break}if(null===Nn){ur.push({index:rn.length,point:Xe.point});var to=Xe.getLeftmostComparator(Ge);Re=Jr.sort(to)[0].otherSE;break}var fo=ur.splice(Nn)[0],Xi=rn.splice(fo.index);Xi.unshift(Xi[0].otherSE),tt.push(new le(Xi.reverse()))}tt.push(new le(rn))}}return tt}}]),yt(le,[{key:"getGeom",value:function(){for(var rt=this.events[0].point,tt=[rt],Pt=1,Kt=this.events.length-1;Pt<Kt;Pt++){var Ee=this.events[Pt].point;0!==bt(Ee,rt,this.events[Pt+1].point)&&(tt.push(Ee),rt=Ee)}if(1===tt.length)return null;0===bt(tt[0],rt,tt[1])&&tt.shift(),tt.push(tt[0]);for(var rn=this.isExteriorRing()?1:-1,cn=this.isExteriorRing()?0:tt.length-1,ur=this.isExteriorRing()?tt.length:-1,Jr=[],di=cn;di!=ur;di+=rn)Jr.push([tt[di].x,tt[di].y]);return Jr}},{key:"isExteriorRing",value:function(){if(void 0===this._isExteriorRing){var rt=this.enclosingRing();this._isExteriorRing=!rt||!rt.isExteriorRing()}return this._isExteriorRing}},{key:"enclosingRing",value:function(){return void 0===this._enclosingRing&&(this._enclosingRing=this._calcEnclosingRing()),this._enclosingRing}},{key:"_calcEnclosingRing",value:function(){for(var rt=this.events[0],tt=1,Pt=this.events.length;tt<Pt;tt++){var Kt=this.events[tt];Tt.compare(rt,Kt)>0&&(rt=Kt)}for(var Ee=rt.segment.prevInResult(),Ge=Ee?Ee.prevInResult():null;;){if(!Ee)return null;if(!Ge)return Ee.ringOut;if(Ge.ringOut!==Ee.ringOut)return Ge.ringOut.enclosingRing()!==Ee.ringOut?Ee.ringOut:Ee.ringOut.enclosingRing();Ee=Ge.prevInResult(),Ge=Ee?Ee.prevInResult():null}}}]),le}(),Oe=function(){function le(ot){fe(this,le),this.exteriorRing=ot,ot.poly=this,this.interiorRings=[]}return yt(le,[{key:"addInterior",value:function(rt){this.interiorRings.push(rt),rt.poly=this}},{key:"getGeom",value:function(){var rt=[this.exteriorRing.getGeom()];if(null===rt[0])return null;for(var tt=0,Pt=this.interiorRings.length;tt<Pt;tt++){var Kt=this.interiorRings[tt].getGeom();null!==Kt&&rt.push(Kt)}return rt}}]),le}(),Zr=function(){function le(ot){fe(this,le),this.rings=ot,this.polys=this._composePolys(ot)}return yt(le,[{key:"getGeom",value:function(){for(var rt=[],tt=0,Pt=this.polys.length;tt<Pt;tt++){var Kt=this.polys[tt].getGeom();null!==Kt&&rt.push(Kt)}return rt}},{key:"_composePolys",value:function(rt){for(var tt=[],Pt=0,Kt=rt.length;Pt<Kt;Pt++){var Ee=rt[Pt];if(!Ee.poly)if(Ee.isExteriorRing())tt.push(new Oe(Ee));else{var Ge=Ee.enclosingRing();Ge.poly||tt.push(new Oe(Ge)),Ge.poly.addInterior(Ee)}}return tt}}]),le}(),Mr=function(){function le(ot){var rt=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Qt.compare;fe(this,le),this.queue=ot,this.tree=new Jt(rt),this.segments=[]}return yt(le,[{key:"process",value:function(rt){var tt=rt.segment,Pt=[];if(rt.consumedBy)return rt.isLeft?this.queue.remove(rt.otherSE):this.tree.remove(tt),Pt;var Kt=rt.isLeft?this.tree.insert(tt):this.tree.find(tt);if(!Kt)throw new Error("Unable to find segment #".concat(tt.id," ")+"[".concat(tt.leftSE.point.x,", ").concat(tt.leftSE.point.y,"] -> ")+"[".concat(tt.rightSE.point.x,", ").concat(tt.rightSE.point.y,"] ")+"in SweepLine tree. Please submit a bug report.");for(var Ee=Kt,Ge=Kt,Xe=void 0,Re=void 0;void 0===Xe;)null===(Ee=this.tree.prev(Ee))?Xe=null:void 0===Ee.key.consumedBy&&(Xe=Ee.key);for(;void 0===Re;)null===(Ge=this.tree.next(Ge))?Re=null:void 0===Ge.key.consumedBy&&(Re=Ge.key);if(rt.isLeft){var rn=null;if(Xe){var cn=Xe.getIntersection(tt);if(null!==cn&&(tt.isAnEndpoint(cn)||(rn=cn),!Xe.isAnEndpoint(cn)))for(var ur=this._splitSafely(Xe,cn),Jr=0,di=ur.length;Jr<di;Jr++)Pt.push(ur[Jr])}var On=null;if(Re){var Nn=Re.getIntersection(tt);if(null!==Nn&&(tt.isAnEndpoint(Nn)||(On=Nn),!Re.isAnEndpoint(Nn)))for(var _i=this._splitSafely(Re,Nn),ji=0,fo=_i.length;ji<fo;ji++)Pt.push(_i[ji])}if(null!==rn||null!==On){var Xi;Xi=null===rn?On:null===On||Tt.comparePoints(rn,On)<=0?rn:On,this.queue.remove(tt.rightSE),Pt.push(tt.rightSE);for(var $n=tt.split(Xi),go=0,Oi=$n.length;go<Oi;go++)Pt.push($n[go])}Pt.length>0?(this.tree.remove(tt),Pt.push(rt)):(this.segments.push(tt),tt.prev=Xe)}else{if(Xe&&Re){var Je=Xe.getIntersection(Re);if(null!==Je){if(!Xe.isAnEndpoint(Je))for(var gi=this._splitSafely(Xe,Je),Z=0,Y=gi.length;Z<Y;Z++)Pt.push(gi[Z]);if(!Re.isAnEndpoint(Je))for(var it=this._splitSafely(Re,Je),ht=0,Ot=it.length;ht<Ot;ht++)Pt.push(it[ht])}}this.tree.remove(tt)}return Pt}},{key:"_splitSafely",value:function(rt,tt){this.tree.remove(rt);var Pt=rt.rightSE;this.queue.remove(Pt);var Kt=rt.split(tt);return Kt.push(Pt),void 0===rt.consumedBy&&this.tree.insert(rt),Kt}}]),le}(),Yr="undefined"!=typeof process&&process.env.POLYGON_CLIPPING_MAX_QUEUE_SIZE||1e6,Sr="undefined"!=typeof process&&process.env.POLYGON_CLIPPING_MAX_SWEEPLINE_SEGMENTS||1e6,ke=new(function(){function le(){fe(this,le)}return yt(le,[{key:"run",value:function(rt,tt,Pt){ke.type=rt,st.reset();for(var Kt=[new Fe(tt,!0)],Ee=0,Ge=Pt.length;Ee<Ge;Ee++)Kt.push(new Fe(Pt[Ee],!1));if(ke.numMultiPolys=Kt.length,"difference"===ke.type)for(var Xe=Kt[0],Re=1;Re<Kt.length;)null!==X(Kt[Re].bbox,Xe.bbox)?Re++:Kt.splice(Re,1);if("intersection"===ke.type)for(var rn=0,cn=Kt.length;rn<cn;rn++)for(var ur=Kt[rn],Jr=rn+1,di=Kt.length;Jr<di;Jr++)if(null===X(ur.bbox,Kt[Jr].bbox))return[];for(var On=new Jt(Tt.compare),Nn=0,_i=Kt.length;Nn<_i;Nn++)for(var ji=Kt[Nn].getSweepEvents(),fo=0,Xi=ji.length;fo<Xi;fo++)if(On.insert(ji[fo]),On.size>Yr)throw new Error("Infinite loop when putting segment endpoints in a priority queue (queue size too big). Please file a bug report.");for(var to=new Mr(On),$n=On.size,go=On.pop();go;){var Oi=go.key;if(On.size===$n){var Je=Oi.segment;throw new Error("Unable to pop() ".concat(Oi.isLeft?"left":"right"," SweepEvent ")+"[".concat(Oi.point.x,", ").concat(Oi.point.y,"] from segment #").concat(Je.id," ")+"[".concat(Je.leftSE.point.x,", ").concat(Je.leftSE.point.y,"] -> ")+"[".concat(Je.rightSE.point.x,", ").concat(Je.rightSE.point.y,"] from queue. ")+"Please file a bug report.")}if(On.size>Yr)throw new Error("Infinite loop when passing sweep line over endpoints (queue size too big). Please file a bug report.");if(to.segments.length>Sr)throw new Error("Infinite loop when passing sweep line over endpoints (too many sweep line segments). Please file a bug report.");for(var gi=to.process(Oi),Z=0,Y=gi.length;Z<Y;Z++){var it=gi[Z];void 0===it.consumedBy&&On.insert(it)}$n=On.size,go=On.pop()}st.reset();var ht=Er.factory(to.segments);return new Zr(ht).getGeom()}}]),le}());return{union:function(ot){for(var rt=arguments.length,tt=new Array(rt>1?rt-1:0),Pt=1;Pt<rt;Pt++)tt[Pt-1]=arguments[Pt];return ke.run("union",ot,tt)},intersection:function(ot){for(var rt=arguments.length,tt=new Array(rt>1?rt-1:0),Pt=1;Pt<rt;Pt++)tt[Pt-1]=arguments[Pt];return ke.run("intersection",ot,tt)},xor:function(ot){for(var rt=arguments.length,tt=new Array(rt>1?rt-1:0),Pt=1;Pt<rt;Pt++)tt[Pt-1]=arguments[Pt];return ke.run("xor",ot,tt)},difference:function(ot){for(var rt=arguments.length,tt=new Array(rt>1?rt-1:0),Pt=1;Pt<rt;Pt++)tt[Pt-1]=arguments[Pt];return ke.run("difference",ot,tt)}}}()},3036:function(He){He.exports=function(){"use strict";function fe(kt,ie,X,J,$){!function St(Q,et,st,j,$t){for(;j>st;){if(j-st>600){var bt=j-st+1,Mt=et-st+1,ct=Math.log(bt),ze=.5*Math.exp(2*ct/3),Te=.5*Math.sqrt(ct*ze*(bt-ze)/bt)*(Mt-bt/2<0?-1:1);St(Q,et,Math.max(st,Math.floor(et-Mt*ze/bt+Te)),Math.min(j,Math.floor(et+(bt-Mt)*ze/bt+Te)),$t)}var Tt=Q[et],Ht=st,Qt=j;for(Et(Q,st,et),$t(Q[j],Tt)>0&&Et(Q,st,j);Ht<Qt;){for(Et(Q,Ht,Qt),Ht++,Qt--;$t(Q[Ht],Tt)<0;)Ht++;for(;$t(Q[Qt],Tt)>0;)Qt--}0===$t(Q[st],Tt)?Et(Q,st,Qt):Et(Q,++Qt,j),Qt<=et&&(st=Qt+1),et<=Qt&&(j=Qt-1)}}(kt,ie,X||0,J||kt.length-1,$||yt)}function Et(kt,ie,X){var J=kt[ie];kt[ie]=kt[X],kt[X]=J}function yt(kt,ie){return kt<ie?-1:kt>ie?1:0}var D=function(kt){void 0===kt&&(kt=9),this._maxEntries=Math.max(4,kt),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()};function y(kt,ie,X){if(!X)return ie.indexOf(kt);for(var J=0;J<ie.length;J++)if(X(kt,ie[J]))return J;return-1}function Bt(kt,ie){ft(kt,0,kt.children.length,ie,kt)}function ft(kt,ie,X,J,$){$||($=_e(null)),$.minX=1/0,$.minY=1/0,$.maxX=-1/0,$.maxY=-1/0;for(var St=ie;St<X;St++){var Q=kt.children[St];It($,kt.leaf?J(Q):Q)}return $}function It(kt,ie){return kt.minX=Math.min(kt.minX,ie.minX),kt.minY=Math.min(kt.minY,ie.minY),kt.maxX=Math.max(kt.maxX,ie.maxX),kt.maxY=Math.max(kt.maxY,ie.maxY),kt}function Ft(kt,ie){return kt.minX-ie.minX}function he(kt,ie){return kt.minY-ie.minY}function Jt(kt){return(kt.maxX-kt.minX)*(kt.maxY-kt.minY)}function Ze(kt){return kt.maxX-kt.minX+(kt.maxY-kt.minY)}function ve(kt,ie){return kt.minX<=ie.minX&&kt.minY<=ie.minY&&ie.maxX<=kt.maxX&&ie.maxY<=kt.maxY}function ce(kt,ie){return ie.minX<=kt.maxX&&ie.minY<=kt.maxY&&ie.maxX>=kt.minX&&ie.maxY>=kt.minY}function _e(kt){return{children:kt,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function We(kt,ie,X,J,$){for(var St=[ie,X];St.length;)if(!((X=St.pop())-(ie=St.pop())<=J)){var Q=ie+Math.ceil((X-ie)/J/2)*J;fe(kt,Q,ie,X,$),St.push(ie,Q,Q,X)}}return D.prototype.all=function(){return this._all(this.data,[])},D.prototype.search=function(kt){var ie=this.data,X=[];if(!ce(kt,ie))return X;for(var J=this.toBBox,$=[];ie;){for(var St=0;St<ie.children.length;St++){var Q=ie.children[St],et=ie.leaf?J(Q):Q;ce(kt,et)&&(ie.leaf?X.push(Q):ve(kt,et)?this._all(Q,X):$.push(Q))}ie=$.pop()}return X},D.prototype.collides=function(kt){var ie=this.data;if(!ce(kt,ie))return!1;for(var X=[];ie;){for(var J=0;J<ie.children.length;J++){var $=ie.children[J],St=ie.leaf?this.toBBox($):$;if(ce(kt,St)){if(ie.leaf||ve(kt,St))return!0;X.push($)}}ie=X.pop()}return!1},D.prototype.load=function(kt){if(!kt||!kt.length)return this;if(kt.length<this._minEntries){for(var ie=0;ie<kt.length;ie++)this.insert(kt[ie]);return this}var X=this._build(kt.slice(),0,kt.length-1,0);if(this.data.children.length)if(this.data.height===X.height)this._splitRoot(this.data,X);else{if(this.data.height<X.height){var J=this.data;this.data=X,X=J}this._insert(X,this.data.height-X.height-1,!0)}else this.data=X;return this},D.prototype.insert=function(kt){return kt&&this._insert(kt,this.data.height-1),this},D.prototype.clear=function(){return this.data=_e([]),this},D.prototype.remove=function(kt,ie){if(!kt)return this;for(var X,J,$,St=this.data,Q=this.toBBox(kt),et=[],st=[];St||et.length;){if(St||(St=et.pop(),J=et[et.length-1],X=st.pop(),$=!0),St.leaf){var j=y(kt,St.children,ie);if(-1!==j)return St.children.splice(j,1),et.push(St),this._condense(et),this}$||St.leaf||!ve(St,Q)?J?(X++,St=J.children[X],$=!1):St=null:(et.push(St),st.push(X),X=0,J=St,St=St.children[0])}return this},D.prototype.toBBox=function(kt){return kt},D.prototype.compareMinX=function(kt,ie){return kt.minX-ie.minX},D.prototype.compareMinY=function(kt,ie){return kt.minY-ie.minY},D.prototype.toJSON=function(){return this.data},D.prototype.fromJSON=function(kt){return this.data=kt,this},D.prototype._all=function(kt,ie){for(var X=[];kt;)kt.leaf?ie.push.apply(ie,kt.children):X.push.apply(X,kt.children),kt=X.pop();return ie},D.prototype._build=function(kt,ie,X,J){var $,St=X-ie+1,Q=this._maxEntries;if(St<=Q)return Bt($=_e(kt.slice(ie,X+1)),this.toBBox),$;J||(J=Math.ceil(Math.log(St)/Math.log(Q)),Q=Math.ceil(St/Math.pow(Q,J-1))),($=_e([])).leaf=!1,$.height=J;var et=Math.ceil(St/Q),st=et*Math.ceil(Math.sqrt(Q));We(kt,ie,X,st,this.compareMinX);for(var j=ie;j<=X;j+=st){var $t=Math.min(j+st-1,X);We(kt,j,$t,et,this.compareMinY);for(var bt=j;bt<=$t;bt+=et){var Mt=Math.min(bt+et-1,$t);$.children.push(this._build(kt,bt,Mt,J-1))}}return Bt($,this.toBBox),$},D.prototype._chooseSubtree=function(kt,ie,X,J){for(;J.push(ie),!ie.leaf&&J.length-1!==X;){for(var $=1/0,St=1/0,Q=void 0,et=0;et<ie.children.length;et++){var st=ie.children[et],j=Jt(st),$t=(bt=kt,Mt=st,(Math.max(Mt.maxX,bt.maxX)-Math.min(Mt.minX,bt.minX))*(Math.max(Mt.maxY,bt.maxY)-Math.min(Mt.minY,bt.minY))-j);$t<St?(St=$t,$=j<$?j:$,Q=st):$t===St&&j<$&&($=j,Q=st)}ie=Q||ie.children[0]}var bt,Mt;return ie},D.prototype._insert=function(kt,ie,X){var J=X?kt:this.toBBox(kt),$=[],St=this._chooseSubtree(J,this.data,ie,$);for(St.children.push(kt),It(St,J);ie>=0&&$[ie].children.length>this._maxEntries;)this._split($,ie),ie--;this._adjustParentBBoxes(J,$,ie)},D.prototype._split=function(kt,ie){var X=kt[ie],J=X.children.length,$=this._minEntries;this._chooseSplitAxis(X,$,J);var St=this._chooseSplitIndex(X,$,J),Q=_e(X.children.splice(St,X.children.length-St));Q.height=X.height,Q.leaf=X.leaf,Bt(X,this.toBBox),Bt(Q,this.toBBox),ie?kt[ie-1].children.push(Q):this._splitRoot(X,Q)},D.prototype._splitRoot=function(kt,ie){this.data=_e([kt,ie]),this.data.height=kt.height+1,this.data.leaf=!1,Bt(this.data,this.toBBox)},D.prototype._chooseSplitIndex=function(kt,ie,X){for(var J,$,St,Q,et,st,j,$t=1/0,bt=1/0,Mt=ie;Mt<=X-ie;Mt++){var ct=ft(kt,0,Mt,this.toBBox),ze=ft(kt,Mt,X,this.toBBox),Te=($=ct,St=ze,void 0,void 0,void 0,void 0,Q=Math.max($.minX,St.minX),et=Math.max($.minY,St.minY),st=Math.min($.maxX,St.maxX),j=Math.min($.maxY,St.maxY),Math.max(0,st-Q)*Math.max(0,j-et)),wt=Jt(ct)+Jt(ze);Te<$t?($t=Te,J=Mt,bt=wt<bt?wt:bt):Te===$t&&wt<bt&&(bt=wt,J=Mt)}return J||X-ie},D.prototype._chooseSplitAxis=function(kt,ie,X){var J=kt.leaf?this.compareMinX:Ft,$=kt.leaf?this.compareMinY:he;this._allDistMargin(kt,ie,X,J)<this._allDistMargin(kt,ie,X,$)&&kt.children.sort(J)},D.prototype._allDistMargin=function(kt,ie,X,J){kt.children.sort(J);for(var $=this.toBBox,St=ft(kt,0,ie,$),Q=ft(kt,X-ie,X,$),et=Ze(St)+Ze(Q),st=ie;st<X-ie;st++){var j=kt.children[st];It(St,kt.leaf?$(j):j),et+=Ze(St)}for(var $t=X-ie-1;$t>=ie;$t--){var bt=kt.children[$t];It(Q,kt.leaf?$(bt):bt),et+=Ze(Q)}return et},D.prototype._adjustParentBBoxes=function(kt,ie,X){for(var J=X;J>=0;J--)It(ie[J],kt)},D.prototype._condense=function(kt){for(var ie=kt.length-1,X=void 0;ie>=0;ie--)0===kt[ie].children.length?ie>0?(X=kt[ie-1].children).splice(X.indexOf(kt[ie]),1):this.clear():Bt(kt[ie],this.toBBox)},D}()},565:He=>{"use strict";var fe=Object,Et=TypeError;He.exports=function(){if(null!=this&&this!==fe(this))throw new Et("RegExp.prototype.flags getter called on non-object");var D="";return this.global&&(D+="g"),this.ignoreCase&&(D+="i"),this.multiline&&(D+="m"),this.dotAll&&(D+="s"),this.unicode&&(D+="u"),this.sticky&&(D+="y"),D}},437:(He,fe,Et)=>{"use strict";var yt=Et(6886),D=Et(44),y=Et(565),Bt=Et(3880),ft=Et(9129),It=D(y);yt(It,{getPolyfill:Bt,implementation:y,shim:ft}),He.exports=It},3880:(He,fe,Et)=>{"use strict";var yt=Et(565),D=Et(6886).supportsDescriptors,y=Object.getOwnPropertyDescriptor,Bt=TypeError;He.exports=function(){if(!D)throw new Bt("RegExp.prototype.flags requires a true ES5 environment that supports property descriptors");if("gim"===/a/gim.flags){var It=y(RegExp.prototype,"flags");if(It&&"function"==typeof It.get&&"boolean"==typeof/a/.dotAll)return It.get}return yt}},9129:(He,fe,Et)=>{"use strict";var yt=Et(6886).supportsDescriptors,D=Et(3880),y=Object.getOwnPropertyDescriptor,Bt=Object.defineProperty,ft=TypeError,It=Object.getPrototypeOf,Ft=/a/;He.exports=function(){if(!yt||!It)throw new ft("RegExp.prototype.flags requires a true ES5 environment that supports property descriptors");var Jt=D(),Ze=It(Ft),ve=y(Ze,"flags");return(!ve||ve.get!==Jt)&&Bt(Ze,"flags",{configurable:!0,enumerable:!1,get:Jt}),Jt}},5322:function(He,fe){!function(Et){"use strict";const yt=134217729;function y(_e,We,kt,ie,X){let J,$,St,Q,et=We[0],st=ie[0],j=0,$t=0;st>et==st>-et?(J=et,et=We[++j]):(J=st,st=ie[++$t]);let bt=0;if(j<_e&&$t<kt)for(st>et==st>-et?(St=J-(($=et+J)-et),et=We[++j]):(St=J-(($=st+J)-st),st=ie[++$t]),J=$,0!==St&&(X[bt++]=St);j<_e&&$t<kt;)st>et==st>-et?(St=J-(($=J+et)-(Q=$-J))+(et-Q),et=We[++j]):(St=J-(($=J+st)-(Q=$-J))+(st-Q),st=ie[++$t]),J=$,0!==St&&(X[bt++]=St);for(;j<_e;)St=J-(($=J+et)-(Q=$-J))+(et-Q),et=We[++j],J=$,0!==St&&(X[bt++]=St);for(;$t<kt;)St=J-(($=J+st)-(Q=$-J))+(st-Q),st=ie[++$t],J=$,0!==St&&(X[bt++]=St);return 0===J&&0!==bt||(X[bt++]=J),bt}function Bt(_e){return new Float64Array(_e)}const he=Bt(4),Jt=Bt(8),Ze=Bt(12),ve=Bt(16),ce=Bt(4);Et.orient2d=function(_e,We,kt,ie,X,J){const $=(We-J)*(kt-X),St=(_e-X)*(ie-J),Q=$-St;if(0===$||0===St||$>0!=St>0)return Q;const et=Math.abs($+St);return Math.abs(Q)>=33306690738754716e-32*et?Q:-function(st,j,$t,bt,Mt,ct,ze){let Te,wt,re,Tt,Ht,Qt,vt,we,Fe,Er,Oe,Zr,Mr,Yr,Sr,Cr,ke,fi;const Mn=st-Mt,Xn=$t-Mt,li=j-ct,Jn=bt-ct;Ht=(Sr=(we=Mn-(vt=(Qt=yt*Mn)-(Qt-Mn)))*(Er=Jn-(Fe=(Qt=yt*Jn)-(Qt-Jn)))-((Yr=Mn*Jn)-vt*Fe-we*Fe-vt*Er))-(Oe=Sr-(ke=(we=li-(vt=(Qt=yt*li)-(Qt-li)))*(Er=Xn-(Fe=(Qt=yt*Xn)-(Qt-Xn)))-((Cr=li*Xn)-vt*Fe-we*Fe-vt*Er))),he[0]=Sr-(Oe+Ht)+(Ht-ke),Ht=(Mr=Yr-((Zr=Yr+Oe)-(Ht=Zr-Yr))+(Oe-Ht))-(Oe=Mr-Cr),he[1]=Mr-(Oe+Ht)+(Ht-Cr),Ht=(fi=Zr+Oe)-Zr,he[2]=Zr-(fi-Ht)+(Oe-Ht),he[3]=fi;let le=function(Kt,Ee){let Ge=Ee[0];for(let Xe=1;Xe<4;Xe++)Ge+=Ee[Xe];return Ge}(0,he),ot=22204460492503146e-32*ze;if(le>=ot||-le>=ot||(Te=st-(Mn+(Ht=st-Mn))+(Ht-Mt),re=$t-(Xn+(Ht=$t-Xn))+(Ht-Mt),wt=j-(li+(Ht=j-li))+(Ht-ct),Tt=bt-(Jn+(Ht=bt-Jn))+(Ht-ct),0===Te&&0===wt&&0===re&&0===Tt)||(ot=11093356479670487e-47*ze+33306690738754706e-32*Math.abs(le),(le+=Mn*Tt+Jn*Te-(li*re+Xn*wt))>=ot||-le>=ot))return le;Ht=(Sr=(we=Te-(vt=(Qt=yt*Te)-(Qt-Te)))*(Er=Jn-(Fe=(Qt=yt*Jn)-(Qt-Jn)))-((Yr=Te*Jn)-vt*Fe-we*Fe-vt*Er))-(Oe=Sr-(ke=(we=wt-(vt=(Qt=yt*wt)-(Qt-wt)))*(Er=Xn-(Fe=(Qt=yt*Xn)-(Qt-Xn)))-((Cr=wt*Xn)-vt*Fe-we*Fe-vt*Er))),ce[0]=Sr-(Oe+Ht)+(Ht-ke),Ht=(Mr=Yr-((Zr=Yr+Oe)-(Ht=Zr-Yr))+(Oe-Ht))-(Oe=Mr-Cr),ce[1]=Mr-(Oe+Ht)+(Ht-Cr),Ht=(fi=Zr+Oe)-Zr,ce[2]=Zr-(fi-Ht)+(Oe-Ht),ce[3]=fi;const rt=y(4,he,4,ce,Jt);Ht=(Sr=(we=Mn-(vt=(Qt=yt*Mn)-(Qt-Mn)))*(Er=Tt-(Fe=(Qt=yt*Tt)-(Qt-Tt)))-((Yr=Mn*Tt)-vt*Fe-we*Fe-vt*Er))-(Oe=Sr-(ke=(we=li-(vt=(Qt=yt*li)-(Qt-li)))*(Er=re-(Fe=(Qt=yt*re)-(Qt-re)))-((Cr=li*re)-vt*Fe-we*Fe-vt*Er))),ce[0]=Sr-(Oe+Ht)+(Ht-ke),Ht=(Mr=Yr-((Zr=Yr+Oe)-(Ht=Zr-Yr))+(Oe-Ht))-(Oe=Mr-Cr),ce[1]=Mr-(Oe+Ht)+(Ht-Cr),Ht=(fi=Zr+Oe)-Zr,ce[2]=Zr-(fi-Ht)+(Oe-Ht),ce[3]=fi;const tt=y(rt,Jt,4,ce,Ze);Ht=(Sr=(we=Te-(vt=(Qt=yt*Te)-(Qt-Te)))*(Er=Tt-(Fe=(Qt=yt*Tt)-(Qt-Tt)))-((Yr=Te*Tt)-vt*Fe-we*Fe-vt*Er))-(Oe=Sr-(ke=(we=wt-(vt=(Qt=yt*wt)-(Qt-wt)))*(Er=re-(Fe=(Qt=yt*re)-(Qt-re)))-((Cr=wt*re)-vt*Fe-we*Fe-vt*Er))),ce[0]=Sr-(Oe+Ht)+(Ht-ke),Ht=(Mr=Yr-((Zr=Yr+Oe)-(Ht=Zr-Yr))+(Oe-Ht))-(Oe=Mr-Cr),ce[1]=Mr-(Oe+Ht)+(Ht-Cr),Ht=(fi=Zr+Oe)-Zr,ce[2]=Zr-(fi-Ht)+(Oe-Ht),ce[3]=fi;const Pt=y(tt,Ze,4,ce,ve);return ve[Pt-1]}(_e,We,kt,ie,X,J,et)},Et.orient2dfast=function(_e,We,kt,ie,X,J){return(We-J)*(kt-X)-(_e-X)*(ie-J)},Object.defineProperty(Et,"__esModule",{value:!0})}(fe)},6257:He=>{"use strict";He.exports={eudist:function(Et,yt,D){for(var y=Et.length,Bt=0,ft=0;ft<y;ft++){var It=(Et[ft]||0)-(yt[ft]||0);Bt+=It*It}return D?Math.sqrt(Bt):Bt},mandist:function(Et,yt,D){for(var y=Et.length,Bt=0,ft=0;ft<y;ft++)Bt+=Math.abs((Et[ft]||0)-(yt[ft]||0));return D?Math.sqrt(Bt):Bt},dist:function(Et,yt,D){var y=Math.abs(Et-yt);return D?y:y*y}}},6019:(He,fe,Et)=>{"use strict";var yt=Et(6257),D=yt.eudist,y=yt.dist;He.exports={kmrand:function(ft,It){for(var Ft={},he=[],Jt=It<<2,Ze=ft.length,ve=ft[0].length>0;he.length<It&&Jt-- >0;){var ce=ft[Math.floor(Math.random()*Ze)],_e=ve?ce.join("_"):""+ce;Ft[_e]||(Ft[_e]=!0,he.push(ce))}if(he.length<It)throw new Error("Error initializating clusters");return he},kmpp:function(ft,It){var Ft=ft[0].length?D:y,he=[],Jt=ft.length,Ze=ft[0].length>0,ce=ft[Math.floor(Math.random()*Jt)];for(Ze&&ce.join("_"),he.push(ce);he.length<It;){for(var We=[],kt=he.length,ie=0,X=[],J=0;J<Jt;J++){for(var $=1/0,St=0;St<kt;St++){var Q=Ft(ft[J],he[St]);Q<=$&&($=Q)}We[J]=$}for(var et=0;et<Jt;et++)ie+=We[et];for(var st=0;st<Jt;st++)X[st]={i:st,v:ft[st],pr:We[st]/ie,cs:0};X.sort(function(Mt,ct){return Mt.pr-ct.pr}),X[0].cs=X[0].pr;for(var j=1;j<Jt;j++)X[j].cs=X[j-1].cs+X[j].pr;for(var $t=Math.random(),bt=0;bt<Jt-1&&X[bt++].cs<$t;);he.push(X[bt-1].v)}return he}}},3212:(He,fe,Et)=>{"use strict";var yt=Et(6257),D=Et(6019),y=yt.eudist,It=D.kmrand,Ft=D.kmpp;function Jt(ve,ce,_e){_e=_e||[];for(var We=0;We<ve;We++)_e[We]=ce;return _e}He.exports=function(ve,ce,_e,We){var kt=[],ie=[],X=[],J=[],$=!1,St=We||1e4,Q=ve.length,et=ve[0].length,st=et>0,j=[];if(_e)kt="kmrand"==_e?It(ve,ce):"kmpp"==_e?Ft(ve,ce):_e;else for(var $t={};kt.length<ce;){var bt=Math.floor(Math.random()*Q);$t[bt]||($t[bt]=!0,kt.push(ve[bt]))}do{Jt(ce,0,j);for(var Mt=0;Mt<Q;Mt++){for(var ct=1/0,ze=0,Te=0;Te<ce;Te++)(J=st?y(ve[Mt],kt[Te]):Math.abs(ve[Mt]-kt[Te]))<=ct&&(ct=J,ze=Te);X[Mt]=ze,j[ze]++}for(var wt=[],Tt=(ie=[],0);Tt<ce;Tt++)wt[Tt]=st?Jt(et,0,wt[Tt]):0,ie[Tt]=kt[Tt];if(st){for(var Ht=0;Ht<ce;Ht++)kt[Ht]=[];for(var Qt=0;Qt<Q;Qt++)for(var we=wt[X[Qt]],Fe=ve[Qt],Er=0;Er<et;Er++)we[Er]+=Fe[Er];$=!0;for(var Oe=0;Oe<ce;Oe++){for(var Zr=kt[Oe],Mr=wt[Oe],Yr=ie[Oe],Sr=j[Oe],Cr=0;Cr<et;Cr++)Zr[Cr]=Mr[Cr]/Sr||0;if($)for(var ke=0;ke<et;ke++)if(Yr[ke]!=Zr[ke]){$=!1;break}}}else{for(var fi=0;fi<Q;fi++)wt[X[fi]]+=ve[fi];for(var Xn=0;Xn<ce;Xn++)kt[Xn]=wt[Xn]/j[Xn]||0;$=!0;for(var li=0;li<ce;li++)if(ie[li]!=kt[li]){$=!1;break}}$=$||--St<=0}while(!$);return{it:1e4-St,k:ce,idxs:X,centroids:kt}}},54:(He,fe,Et)=>{"use strict";Et.r(fe),Et.d(fe,{default:()=>yt});class yt{constructor(Bt=[],ft=D){if(this.data=Bt,this.length=this.data.length,this.compare=ft,this.length>0)for(let It=(this.length>>1)-1;It>=0;It--)this._down(It)}push(Bt){this.data.push(Bt),this.length++,this._up(this.length-1)}pop(){if(0===this.length)return;const Bt=this.data[0],ft=this.data.pop();return this.length--,this.length>0&&(this.data[0]=ft,this._down(0)),Bt}peek(){return this.data[0]}_up(Bt){const{data:ft,compare:It}=this,Ft=ft[Bt];for(;Bt>0;){const he=Bt-1>>1,Jt=ft[he];if(It(Ft,Jt)>=0)break;ft[Bt]=Jt,Bt=he}ft[Bt]=Ft}_down(Bt){const{data:ft,compare:It}=this,Ft=this.length>>1,he=ft[Bt];for(;Bt<Ft;){let Jt=1+(Bt<<1),Ze=ft[Jt];const ve=Jt+1;if(ve<this.length&&It(ft[ve],Ze)<0&&(Jt=ve,Ze=ft[ve]),It(Ze,he)>=0)break;ft[Bt]=Ze,Bt=Jt}ft[Bt]=he}}function D(y,Bt){return y<Bt?-1:y>Bt?1:0}},7299:function(He,fe){!function(Et){"use strict";function yt(){}function D(e){this.message=e||""}function y(e){this.message=e||""}function Bt(e){this.message=e||""}function ft(){}function It(e){return null===e?Ut:e.color}function Ft(e){return null===e?null:e.parent}function he(e,n){null!==e&&(e.color=n)}function Jt(e){return null===e?null:e.left}function Ze(e){return null===e?null:e.right}function ve(){this.root_=null,this.size_=0}function ce(){}function _e(){this.array_=[],arguments[0]instanceof $n&&this.addAll(arguments[0])}function We(){}function kt(e){this.message=e||""}function ie(){this.array_=[]}"fill"in Array.prototype||Object.defineProperty(Array.prototype,"fill",{configurable:!0,value:function(e){if(null==this)throw new TypeError(this+" is not an object");var n=Object(this),c=Math.max(Math.min(n.length,9007199254740991),0)||0,f=1 in arguments&&parseInt(Number(arguments[1]),10)||0;f=f<0?Math.max(c+f,0):Math.min(f,c);var x=2 in arguments&&void 0!==arguments[2]?parseInt(Number(arguments[2]),10)||0:c;for(x=x<0?Math.max(c+arguments[2],0):Math.min(x,c);f<x;)n[f]=e,++f;return n},writable:!0}),Number.isFinite=Number.isFinite||function(e){return"number"==typeof e&&isFinite(e)},Number.isInteger=Number.isInteger||function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e},Number.parseFloat=Number.parseFloat||parseFloat,Number.isNaN=Number.isNaN||function(e){return e!=e},Math.trunc=Math.trunc||function(e){return e<0?Math.ceil(e):Math.floor(e)};var X=function(){};X.prototype.interfaces_=function(){return[]},X.prototype.getClass=function(){return X},X.prototype.equalsWithTolerance=function(e,n,c){return Math.abs(e-n)<=c};var J=function(e){function n(c){e.call(this,c),this.name="IllegalArgumentException",this.message=c,this.stack=(new e).stack}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n}(Error),$=function(){},St={MAX_VALUE:{configurable:!0}};$.isNaN=function(e){return Number.isNaN(e)},$.doubleToLongBits=function(e){return e},$.longBitsToDouble=function(e){return e},$.isInfinite=function(e){return!Number.isFinite(e)},St.MAX_VALUE.get=function(){return Number.MAX_VALUE},Object.defineProperties($,St);var Q=function(){},et=function(){},st=function(){},j=function e(){if(this.x=null,this.y=null,this.z=null,0===arguments.length)this.x=0,this.y=0,this.z=e.NULL_ORDINATE;else if(1===arguments.length){var n=arguments[0];this.x=n.x,this.y=n.y,this.z=n.z}else 2===arguments.length?(this.x=arguments[0],this.y=arguments[1],this.z=e.NULL_ORDINATE):3===arguments.length&&(this.x=arguments[0],this.y=arguments[1],this.z=arguments[2])},$t={DimensionalComparator:{configurable:!0},serialVersionUID:{configurable:!0},NULL_ORDINATE:{configurable:!0},X:{configurable:!0},Y:{configurable:!0},Z:{configurable:!0}};j.prototype.setOrdinate=function(e,n){switch(e){case j.X:this.x=n;break;case j.Y:this.y=n;break;case j.Z:this.z=n;break;default:throw new J("Invalid ordinate index: "+e)}},j.prototype.equals2D=function(){if(1===arguments.length){var e=arguments[0];return this.x===e.x&&this.y===e.y}if(2===arguments.length){var n=arguments[0],c=arguments[1];return!!X.equalsWithTolerance(this.x,n.x,c)&&!!X.equalsWithTolerance(this.y,n.y,c)}},j.prototype.getOrdinate=function(e){switch(e){case j.X:return this.x;case j.Y:return this.y;case j.Z:return this.z}throw new J("Invalid ordinate index: "+e)},j.prototype.equals3D=function(e){return this.x===e.x&&this.y===e.y&&(this.z===e.z||$.isNaN(this.z))&&$.isNaN(e.z)},j.prototype.equals=function(e){return e instanceof j&&this.equals2D(e)},j.prototype.equalInZ=function(e,n){return X.equalsWithTolerance(this.z,e.z,n)},j.prototype.compareTo=function(e){return this.x<e.x?-1:this.x>e.x?1:this.y<e.y?-1:this.y>e.y?1:0},j.prototype.clone=function(){},j.prototype.copy=function(){return new j(this)},j.prototype.toString=function(){return"("+this.x+", "+this.y+", "+this.z+")"},j.prototype.distance3D=function(e){var n=this.x-e.x,c=this.y-e.y,f=this.z-e.z;return Math.sqrt(n*n+c*c+f*f)},j.prototype.distance=function(e){var n=this.x-e.x,c=this.y-e.y;return Math.sqrt(n*n+c*c)},j.prototype.hashCode=function(){var e=17;return 37*(e=37*e+j.hashCode(this.x))+j.hashCode(this.y)},j.prototype.setCoordinate=function(e){this.x=e.x,this.y=e.y,this.z=e.z},j.prototype.interfaces_=function(){return[Q,et,yt]},j.prototype.getClass=function(){return j},j.hashCode=function(){if(1===arguments.length){var n=$.doubleToLongBits(arguments[0]);return Math.trunc((n^n)>>>32)}},$t.DimensionalComparator.get=function(){return bt},$t.serialVersionUID.get=function(){return 0x5cbf2c235c7e5800},$t.NULL_ORDINATE.get=function(){return $.NaN},$t.X.get=function(){return 0},$t.Y.get=function(){return 1},$t.Z.get=function(){return 2},Object.defineProperties(j,$t);var bt=function(e){if(this._dimensionsToTest=2,0!==arguments.length&&1===arguments.length){var n=arguments[0];if(2!==n&&3!==n)throw new J("only 2 or 3 dimensions may be specified");this._dimensionsToTest=n}};bt.prototype.compare=function(e,n){var c=e,f=n,x=bt.compare(c.x,f.x);if(0!==x)return x;var L=bt.compare(c.y,f.y);return 0!==L?L:this._dimensionsToTest<=2?0:bt.compare(c.z,f.z)},bt.prototype.interfaces_=function(){return[st]},bt.prototype.getClass=function(){return bt},bt.compare=function(e,n){return e<n?-1:e>n?1:$.isNaN(e)?$.isNaN(n)?0:-1:$.isNaN(n)?1:0};var Mt=function(){};Mt.prototype.create=function(){},Mt.prototype.interfaces_=function(){return[]},Mt.prototype.getClass=function(){return Mt};var ct=function(){},ze={INTERIOR:{configurable:!0},BOUNDARY:{configurable:!0},EXTERIOR:{configurable:!0},NONE:{configurable:!0}};ct.prototype.interfaces_=function(){return[]},ct.prototype.getClass=function(){return ct},ct.toLocationSymbol=function(e){switch(e){case ct.EXTERIOR:return"e";case ct.BOUNDARY:return"b";case ct.INTERIOR:return"i";case ct.NONE:return"-"}throw new J("Unknown location value: "+e)},ze.INTERIOR.get=function(){return 0},ze.BOUNDARY.get=function(){return 1},ze.EXTERIOR.get=function(){return 2},ze.NONE.get=function(){return-1},Object.defineProperties(ct,ze);var Te=function(e,n){return e.interfaces_&&e.interfaces_().indexOf(n)>-1},wt=function(){},re={LOG_10:{configurable:!0}};wt.prototype.interfaces_=function(){return[]},wt.prototype.getClass=function(){return wt},wt.log10=function(e){var n=Math.log(e);return $.isInfinite(n)||$.isNaN(n)?n:n/wt.LOG_10},wt.min=function(e,n,c,f){var x=e;return n<x&&(x=n),c<x&&(x=c),f<x&&(x=f),x},wt.clamp=function(){if("number"==typeof arguments[2]&&"number"==typeof arguments[0]&&"number"==typeof arguments[1]){var e=arguments[0],n=arguments[1],c=arguments[2];return e<n?n:e>c?c:e}if(Number.isInteger(arguments[2])&&Number.isInteger(arguments[0])&&Number.isInteger(arguments[1])){var f=arguments[0],x=arguments[1],L=arguments[2];return f<x?x:f>L?L:f}},wt.wrap=function(e,n){return e<0?n- -e%n:e%n},wt.max=function(){if(3===arguments.length){var n=arguments[1],c=arguments[2],f=arguments[0];return n>f&&(f=n),c>f&&(f=c),f}if(4===arguments.length){var L=arguments[1],z=arguments[2],W=arguments[3],gt=arguments[0];return L>gt&&(gt=L),z>gt&&(gt=z),W>gt&&(gt=W),gt}},wt.average=function(e,n){return(e+n)/2},re.LOG_10.get=function(){return Math.log(10)},Object.defineProperties(wt,re);var Tt=function(e){this.str=e};Tt.prototype.append=function(e){this.str+=e},Tt.prototype.setCharAt=function(e,n){this.str=this.str.substr(0,e)+n+this.str.substr(e+1)},Tt.prototype.toString=function(e){return this.str};var Ht=function(e){this.value=e};Ht.prototype.intValue=function(){return this.value},Ht.prototype.compareTo=function(e){return this.value<e?-1:this.value>e?1:0},Ht.isNaN=function(e){return Number.isNaN(e)};var Qt=function(){};Qt.isWhitespace=function(e){return e<=32&&e>=0||127===e},Qt.toUpperCase=function(e){return e.toUpperCase()};var vt=function e(){this._hi=0,this._lo=0,0===arguments.length?this.init(0):1===arguments.length?"number"==typeof arguments[0]||arguments[0]instanceof e?this.init(arguments[0]):"string"==typeof arguments[0]&&e.call(this,e.parse(arguments[0])):2===arguments.length&&this.init(arguments[0],arguments[1])},we={PI:{configurable:!0},TWO_PI:{configurable:!0},PI_2:{configurable:!0},E:{configurable:!0},NaN:{configurable:!0},EPS:{configurable:!0},SPLIT:{configurable:!0},MAX_PRINT_DIGITS:{configurable:!0},TEN:{configurable:!0},ONE:{configurable:!0},SCI_NOT_EXPONENT_CHAR:{configurable:!0},SCI_NOT_ZERO:{configurable:!0}};vt.prototype.le=function(e){return(this._hi<e._hi||this._hi===e._hi)&&this._lo<=e._lo},vt.prototype.extractSignificantDigits=function(e,n){var c=this.abs(),f=vt.magnitude(c._hi),x=vt.TEN.pow(f);(c=c.divide(x)).gt(vt.TEN)?(c=c.divide(vt.TEN),f+=1):c.lt(vt.ONE)&&(c=c.multiply(vt.TEN),f-=1);for(var L=f+1,z=new Tt,W=vt.MAX_PRINT_DIGITS-1,gt=0;gt<=W;gt++){e&&gt===L&&z.append(".");var Zt=Math.trunc(c._hi);if(Zt<0)break;var Ie=!1,Me=0;Zt>9?(Ie=!0,Me="9"):Me="0"+Zt,z.append(Me),c=c.subtract(vt.valueOf(Zt)).multiply(vt.TEN),Ie&&c.selfAdd(vt.TEN);var tr=!0,mr=vt.magnitude(c._hi);if(mr<0&&Math.abs(mr)>=W-gt&&(tr=!1),!tr)break}return n[0]=f,z.toString()},vt.prototype.sqr=function(){return this.multiply(this)},vt.prototype.doubleValue=function(){return this._hi+this._lo},vt.prototype.subtract=function(){return arguments[0]instanceof vt?this.add(arguments[0].negate()):"number"==typeof arguments[0]?this.add(-arguments[0]):void 0},vt.prototype.equals=function(){if(1===arguments.length){var e=arguments[0];return this._hi===e._hi&&this._lo===e._lo}},vt.prototype.isZero=function(){return 0===this._hi&&0===this._lo},vt.prototype.selfSubtract=function(){if(arguments[0]instanceof vt){var e=arguments[0];return this.isNaN()?this:this.selfAdd(-e._hi,-e._lo)}if("number"==typeof arguments[0]){var n=arguments[0];return this.isNaN()?this:this.selfAdd(-n,0)}},vt.prototype.getSpecialNumberString=function(){return this.isZero()?"0.0":this.isNaN()?"NaN ":null},vt.prototype.min=function(e){return this.le(e)?this:e},vt.prototype.selfDivide=function(){if(1===arguments.length){if(arguments[0]instanceof vt){var e=arguments[0];return this.selfDivide(e._hi,e._lo)}if("number"==typeof arguments[0])return this.selfDivide(arguments[0],0)}else if(2===arguments.length){var c=arguments[0],x=null,L=null,z=null,W=null,gt=null,Zt=null,Ie=null,Me=null;return this._hi=Me=(gt=this._hi/c)+(Zt=(this._hi-(Ie=gt*c)-(Me=(x=(Zt=vt.SPLIT*gt)-(x=Zt-gt))*(z=(Me=vt.SPLIT*c)-(z=Me-c))-Ie+x*(W=c-z)+(L=gt-x)*z+L*W)+this._lo-gt*arguments[1])/c),this._lo=gt-Me+Zt,this}},vt.prototype.dump=function(){return"DD<"+this._hi+", "+this._lo+">"},vt.prototype.divide=function(){if(arguments[0]instanceof vt){var e=arguments[0],n=null,c=null,f=null,x=null,L=null,z=null,W=null,gt=null;return c=(L=this._hi/e._hi)-(n=(z=vt.SPLIT*L)-(n=z-L)),gt=n*(f=(gt=vt.SPLIT*e._hi)-(f=gt-e._hi))-(W=L*e._hi)+n*(x=e._hi-f)+c*f+c*x,new vt(gt=L+(z=(this._hi-W-gt+this._lo-L*e._lo)/e._hi),L-gt+z)}if("number"==typeof arguments[0]){var Zt=arguments[0];return $.isNaN(Zt)?vt.createNaN():vt.copy(this).selfDivide(Zt,0)}},vt.prototype.ge=function(e){return(this._hi>e._hi||this._hi===e._hi)&&this._lo>=e._lo},vt.prototype.pow=function(e){if(0===e)return vt.valueOf(1);var n=new vt(this),c=vt.valueOf(1),f=Math.abs(e);if(f>1)for(;f>0;)f%2==1&&c.selfMultiply(n),(f/=2)>0&&(n=n.sqr());else c=n;return e<0?c.reciprocal():c},vt.prototype.ceil=function(){if(this.isNaN())return vt.NaN;var e=Math.ceil(this._hi),n=0;return e===this._hi&&(n=Math.ceil(this._lo)),new vt(e,n)},vt.prototype.compareTo=function(e){return this._hi<e._hi?-1:this._hi>e._hi?1:this._lo<e._lo?-1:this._lo>e._lo?1:0},vt.prototype.rint=function(){return this.isNaN()?this:this.add(.5).floor()},vt.prototype.setValue=function(){return arguments[0]instanceof vt||"number"==typeof arguments[0]?(this.init(arguments[0]),this):void 0},vt.prototype.max=function(e){return this.ge(e)?this:e},vt.prototype.sqrt=function(){if(this.isZero())return vt.valueOf(0);if(this.isNegative())return vt.NaN;var e=1/Math.sqrt(this._hi),c=vt.valueOf(this._hi*e),f=this.subtract(c.sqr())._hi*(.5*e);return c.add(f)},vt.prototype.selfAdd=function(){if(1===arguments.length){if(arguments[0]instanceof vt){var e=arguments[0];return this.selfAdd(e._hi,e._lo)}if("number"==typeof arguments[0]){var n=arguments[0],c=null,f=null,x=null,z=null,W=null;return this._hi=(c=(x=this._hi+n)+(W=n-(z=x-this._hi)+(this._hi-(x-z))+this._lo))+(f=W+(x-c)),this._lo=f+(c-this._hi),this}}else if(2===arguments.length){var gt=arguments[0],Zt=arguments[1],Ie=null,Me=null,tr=null,mr=null,Ar=null,Xr=null,Wn=null;Ar=(mr=this._hi+gt)-(Xr=mr-this._hi),tr=(Me=this._lo+Zt)-(Wn=Me-this._lo);var u=(Ie=mr+(Xr=(Ar=gt-Xr+(this._hi-Ar))+Me))+(Xr=(tr=Zt-Wn+(this._lo-tr))+(Xr+(mr-Ie))),p=Xr+(Ie-u);return this._hi=u,this._lo=p,this}},vt.prototype.selfMultiply=function(){if(1===arguments.length){if(arguments[0]instanceof vt){var e=arguments[0];return this.selfMultiply(e._hi,e._lo)}if("number"==typeof arguments[0])return this.selfMultiply(arguments[0],0)}else if(2===arguments.length){var c=arguments[0],x=null,L=null,z=null,W=null,gt=null,Zt=null;x=(gt=vt.SPLIT*this._hi)-this._hi,x=gt-x;var Ie=(gt=this._hi*c)+(Zt=x*(z=(Zt=vt.SPLIT*c)-(z=Zt-c))-gt+x*(W=c-z)+(L=this._hi-x)*z+L*W+(this._hi*arguments[1]+this._lo*c)),Me=Zt+(x=gt-Ie);return this._hi=Ie,this._lo=Me,this}},vt.prototype.selfSqr=function(){return this.selfMultiply(this)},vt.prototype.floor=function(){if(this.isNaN())return vt.NaN;var e=Math.floor(this._hi),n=0;return e===this._hi&&(n=Math.floor(this._lo)),new vt(e,n)},vt.prototype.negate=function(){return this.isNaN()?this:new vt(-this._hi,-this._lo)},vt.prototype.clone=function(){},vt.prototype.multiply=function(){if(arguments[0]instanceof vt){var e=arguments[0];return e.isNaN()?vt.createNaN():vt.copy(this).selfMultiply(e)}if("number"==typeof arguments[0]){var n=arguments[0];return $.isNaN(n)?vt.createNaN():vt.copy(this).selfMultiply(n,0)}},vt.prototype.isNaN=function(){return $.isNaN(this._hi)},vt.prototype.intValue=function(){return Math.trunc(this._hi)},vt.prototype.toString=function(){var e=vt.magnitude(this._hi);return e>=-3&&e<=20?this.toStandardNotation():this.toSciNotation()},vt.prototype.toStandardNotation=function(){var e=this.getSpecialNumberString();if(null!==e)return e;var n=new Array(1).fill(null),c=this.extractSignificantDigits(!0,n),f=n[0]+1,x=c;return"."===c.charAt(0)?x="0"+c:f<0?x="0."+vt.stringOfChar("0",-f)+c:-1===c.indexOf(".")&&(x=c+vt.stringOfChar("0",f-c.length)+".0"),this.isNegative()?"-"+x:x},vt.prototype.reciprocal=function(){var n,f,x,z,e=null,c=null,L=null,W=null;n=(x=1/this._hi)-(e=(L=vt.SPLIT*x)-(e=L-x)),c=(W=vt.SPLIT*this._hi)-this._hi;var gt=x+(L=(1-(z=x*this._hi)-(W=e*(c=W-c)-z+e*(f=this._hi-c)+n*c+n*f)-x*this._lo)/this._hi);return new vt(gt,x-gt+L)},vt.prototype.toSciNotation=function(){if(this.isZero())return vt.SCI_NOT_ZERO;var e=this.getSpecialNumberString();if(null!==e)return e;var n=new Array(1).fill(null),c=this.extractSignificantDigits(!1,n),f=vt.SCI_NOT_EXPONENT_CHAR+n[0];if("0"===c.charAt(0))throw new Error("Found leading zero: "+c);var x="";c.length>1&&(x=c.substring(1));var L=c.charAt(0)+"."+x;return this.isNegative()?"-"+L+f:L+f},vt.prototype.abs=function(){return this.isNaN()?vt.NaN:this.isNegative()?this.negate():new vt(this)},vt.prototype.isPositive=function(){return(this._hi>0||0===this._hi)&&this._lo>0},vt.prototype.lt=function(e){return(this._hi<e._hi||this._hi===e._hi)&&this._lo<e._lo},vt.prototype.add=function(){if(arguments[0]instanceof vt){var e=arguments[0];return vt.copy(this).selfAdd(e)}if("number"==typeof arguments[0]){var n=arguments[0];return vt.copy(this).selfAdd(n)}},vt.prototype.init=function(){if(1===arguments.length){if("number"==typeof arguments[0])this._hi=arguments[0],this._lo=0;else if(arguments[0]instanceof vt){var n=arguments[0];this._hi=n._hi,this._lo=n._lo}}else if(2===arguments.length){var f=arguments[1];this._hi=arguments[0],this._lo=f}},vt.prototype.gt=function(e){return(this._hi>e._hi||this._hi===e._hi)&&this._lo>e._lo},vt.prototype.isNegative=function(){return(this._hi<0||0===this._hi)&&this._lo<0},vt.prototype.trunc=function(){return this.isNaN()?vt.NaN:this.isPositive()?this.floor():this.ceil()},vt.prototype.signum=function(){return this._hi>0?1:this._hi<0?-1:this._lo>0?1:this._lo<0?-1:0},vt.prototype.interfaces_=function(){return[yt,Q,et]},vt.prototype.getClass=function(){return vt},vt.sqr=function(e){return vt.valueOf(e).selfMultiply(e)},vt.valueOf=function(){return"string"==typeof arguments[0]?vt.parse(arguments[0]):"number"==typeof arguments[0]?new vt(arguments[0]):void 0},vt.sqrt=function(e){return vt.valueOf(e).sqrt()},vt.parse=function(e){for(var n=0,c=e.length;Qt.isWhitespace(e.charAt(n));)n++;var f=!1;if(n<c){var x=e.charAt(n);"-"!==x&&"+"!==x||(n++,"-"===x&&(f=!0))}for(var L=new vt,z=0,W=0,gt=0;!(n>=c);){var Zt=e.charAt(n);if(n++,Qt.isDigit(Zt)){var Ie=Zt-"0";L.selfMultiply(vt.TEN),L.selfAdd(Ie),z++}else{if("."!==Zt){if("e"===Zt||"E"===Zt){var Me=e.substring(n);try{gt=Ht.parseInt(Me)}catch(Wn){throw Wn instanceof Error?new Error("Invalid exponent "+Me+" in string "+e):Wn}break}throw new Error("Unexpected character '"+Zt+"' at position "+n+" in string "+e)}W=z}}var tr=L,mr=z-W-gt;if(0===mr)tr=L;else if(mr>0){var Ar=vt.TEN.pow(mr);tr=L.divide(Ar)}else if(mr<0){var Xr=vt.TEN.pow(-mr);tr=L.multiply(Xr)}return f?tr.negate():tr},vt.createNaN=function(){return new vt($.NaN,$.NaN)},vt.copy=function(e){return new vt(e)},vt.magnitude=function(e){var n=Math.abs(e),c=Math.log(n)/Math.log(10),f=Math.trunc(Math.floor(c));return 10*Math.pow(10,f)<=n&&(f+=1),f},vt.stringOfChar=function(e,n){for(var c=new Tt,f=0;f<n;f++)c.append(e);return c.toString()},we.PI.get=function(){return new vt(3.141592653589793,12246467991473532e-32)},we.TWO_PI.get=function(){return new vt(6.283185307179586,24492935982947064e-32)},we.PI_2.get=function(){return new vt(1.5707963267948966,6123233995736766e-32)},we.E.get=function(){return new vt(2.718281828459045,14456468917292502e-32)},we.NaN.get=function(){return new vt($.NaN,$.NaN)},we.EPS.get=function(){return 123259516440783e-46},we.SPLIT.get=function(){return 134217729},we.MAX_PRINT_DIGITS.get=function(){return 32},we.TEN.get=function(){return vt.valueOf(10)},we.ONE.get=function(){return vt.valueOf(1)},we.SCI_NOT_EXPONENT_CHAR.get=function(){return"E"},we.SCI_NOT_ZERO.get=function(){return"0.0E0"},Object.defineProperties(vt,we);var Fe=function(){},Er={DP_SAFE_EPSILON:{configurable:!0}};Fe.prototype.interfaces_=function(){return[]},Fe.prototype.getClass=function(){return Fe},Fe.orientationIndex=function(e,n,c){var f=Fe.orientationIndexFilter(e,n,c);if(f<=1)return f;var x=vt.valueOf(n.x).selfAdd(-e.x),L=vt.valueOf(n.y).selfAdd(-e.y),z=vt.valueOf(c.x).selfAdd(-n.x),W=vt.valueOf(c.y).selfAdd(-n.y);return x.selfMultiply(W).selfSubtract(L.selfMultiply(z)).signum()},Fe.signOfDet2x2=function(e,n,c,f){return e.multiply(f).selfSubtract(n.multiply(c)).signum()},Fe.intersection=function(e,n,c,f){var x=vt.valueOf(f.y).selfSubtract(c.y).selfMultiply(vt.valueOf(n.x).selfSubtract(e.x)),L=vt.valueOf(f.x).selfSubtract(c.x).selfMultiply(vt.valueOf(n.y).selfSubtract(e.y)),z=x.subtract(L),W=vt.valueOf(f.x).selfSubtract(c.x).selfMultiply(vt.valueOf(e.y).selfSubtract(c.y)),gt=vt.valueOf(f.y).selfSubtract(c.y).selfMultiply(vt.valueOf(e.x).selfSubtract(c.x)),Zt=W.subtract(gt).selfDivide(z).doubleValue(),Ie=vt.valueOf(e.x).selfAdd(vt.valueOf(n.x).selfSubtract(e.x).selfMultiply(Zt)).doubleValue(),Me=vt.valueOf(n.x).selfSubtract(e.x).selfMultiply(vt.valueOf(e.y).selfSubtract(c.y)),tr=vt.valueOf(n.y).selfSubtract(e.y).selfMultiply(vt.valueOf(e.x).selfSubtract(c.x)),mr=Me.subtract(tr).selfDivide(z).doubleValue(),Ar=vt.valueOf(c.y).selfAdd(vt.valueOf(f.y).selfSubtract(c.y).selfMultiply(mr)).doubleValue();return new j(Ie,Ar)},Fe.orientationIndexFilter=function(e,n,c){var f=null,x=(e.x-c.x)*(n.y-c.y),L=(e.y-c.y)*(n.x-c.x),z=x-L;if(x>0){if(L<=0)return Fe.signum(z);f=x+L}else{if(!(x<0)||L>=0)return Fe.signum(z);f=-x-L}var W=Fe.DP_SAFE_EPSILON*f;return z>=W||-z>=W?Fe.signum(z):2},Fe.signum=function(e){return e>0?1:e<0?-1:0},Er.DP_SAFE_EPSILON.get=function(){return 1e-15},Object.defineProperties(Fe,Er);var Oe=function(){},Zr={X:{configurable:!0},Y:{configurable:!0},Z:{configurable:!0},M:{configurable:!0}};Zr.X.get=function(){return 0},Zr.Y.get=function(){return 1},Zr.Z.get=function(){return 2},Zr.M.get=function(){return 3},Oe.prototype.setOrdinate=function(e,n,c){},Oe.prototype.size=function(){},Oe.prototype.getOrdinate=function(e,n){},Oe.prototype.getCoordinate=function(){},Oe.prototype.getCoordinateCopy=function(e){},Oe.prototype.getDimension=function(){},Oe.prototype.getX=function(e){},Oe.prototype.clone=function(){},Oe.prototype.expandEnvelope=function(e){},Oe.prototype.copy=function(){},Oe.prototype.getY=function(e){},Oe.prototype.toCoordinateArray=function(){},Oe.prototype.interfaces_=function(){return[et]},Oe.prototype.getClass=function(){return Oe},Object.defineProperties(Oe,Zr);var Mr=function(){},Yr=function(e){function n(){e.call(this,"Projective point not representable on the Cartesian plane.")}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype.interfaces_=function(){return[]},n.prototype.getClass=function(){return n},n}(Mr),Sr=function(){};Sr.arraycopy=function(e,n,c,f,x){for(var L=0,z=n;z<n+x;z++)c[f+L]=e[z],L++},Sr.getProperty=function(e){return{"line.separator":"\n"}[e]};var Cr=function e(){if(this.x=null,this.y=null,this.w=null,0===arguments.length)this.x=0,this.y=0,this.w=1;else if(1===arguments.length){var n=arguments[0];this.x=n.x,this.y=n.y,this.w=1}else if(2===arguments.length){if("number"==typeof arguments[0]&&"number"==typeof arguments[1]){var f=arguments[1];this.x=arguments[0],this.y=f,this.w=1}else if(arguments[0]instanceof e&&arguments[1]instanceof e){var x=arguments[0],L=arguments[1];this.x=x.y*L.w-L.y*x.w,this.y=L.x*x.w-x.x*L.w,this.w=x.x*L.y-L.x*x.y}else if(arguments[0]instanceof j&&arguments[1]instanceof j){var z=arguments[0],W=arguments[1];this.x=z.y-W.y,this.y=W.x-z.x,this.w=z.x*W.y-W.x*z.y}}else if(3===arguments.length){var Zt=arguments[1],Ie=arguments[2];this.x=arguments[0],this.y=Zt,this.w=Ie}else if(4===arguments.length){var Me=arguments[0],tr=arguments[1],mr=arguments[2],Ar=arguments[3],Xr=Me.y-tr.y,Wn=tr.x-Me.x,u=Me.x*tr.y-tr.x*Me.y,p=mr.y-Ar.y,l=Ar.x-mr.x,g=mr.x*Ar.y-Ar.x*mr.y;this.x=Wn*g-l*u,this.y=p*u-Xr*g,this.w=Xr*l-p*Wn}};Cr.prototype.getY=function(){var e=this.y/this.w;if($.isNaN(e)||$.isInfinite(e))throw new Yr;return e},Cr.prototype.getX=function(){var e=this.x/this.w;if($.isNaN(e)||$.isInfinite(e))throw new Yr;return e},Cr.prototype.getCoordinate=function(){var e=new j;return e.x=this.getX(),e.y=this.getY(),e},Cr.prototype.interfaces_=function(){return[]},Cr.prototype.getClass=function(){return Cr},Cr.intersection=function(e,n,c,f){var x=e.y-n.y,L=n.x-e.x,z=e.x*n.y-n.x*e.y,W=c.y-f.y,gt=f.x-c.x,Zt=c.x*f.y-f.x*c.y,Ie=x*gt-W*L,Me=(L*Zt-gt*z)/Ie,tr=(W*z-x*Zt)/Ie;if($.isNaN(Me)||$.isInfinite(Me)||$.isNaN(tr)||$.isInfinite(tr))throw new Yr;return new j(Me,tr)};var ke=function e(){if(this._minx=null,this._maxx=null,this._miny=null,this._maxy=null,0===arguments.length)this.init();else if(1===arguments.length)if(arguments[0]instanceof j){var n=arguments[0];this.init(n.x,n.x,n.y,n.y)}else arguments[0]instanceof e&&this.init(arguments[0]);else if(2===arguments.length){var f=arguments[0],x=arguments[1];this.init(f.x,x.x,f.y,x.y)}else 4===arguments.length&&this.init(arguments[0],arguments[1],arguments[2],arguments[3])},fi={serialVersionUID:{configurable:!0}};ke.prototype.getArea=function(){return this.getWidth()*this.getHeight()},ke.prototype.equals=function(e){if(!(e instanceof ke))return!1;var n=e;return this.isNull()?n.isNull():this._maxx===n.getMaxX()&&this._maxy===n.getMaxY()&&this._minx===n.getMinX()&&this._miny===n.getMinY()},ke.prototype.intersection=function(e){return this.isNull()||e.isNull()||!this.intersects(e)?new ke:new ke(this._minx>e._minx?this._minx:e._minx,this._maxx<e._maxx?this._maxx:e._maxx,this._miny>e._miny?this._miny:e._miny,this._maxy<e._maxy?this._maxy:e._maxy)},ke.prototype.isNull=function(){return this._maxx<this._minx},ke.prototype.getMaxX=function(){return this._maxx},ke.prototype.covers=function(){if(1===arguments.length){if(arguments[0]instanceof j){var e=arguments[0];return this.covers(e.x,e.y)}if(arguments[0]instanceof ke){var n=arguments[0];return!this.isNull()&&!n.isNull()&&n.getMinX()>=this._minx&&n.getMaxX()<=this._maxx&&n.getMinY()>=this._miny&&n.getMaxY()<=this._maxy}}else if(2===arguments.length){var c=arguments[0],f=arguments[1];return!this.isNull()&&c>=this._minx&&c<=this._maxx&&f>=this._miny&&f<=this._maxy}},ke.prototype.intersects=function(){if(1===arguments.length){if(arguments[0]instanceof ke){var e=arguments[0];return!this.isNull()&&!e.isNull()&&!(e._minx>this._maxx||e._maxx<this._minx||e._miny>this._maxy||e._maxy<this._miny)}if(arguments[0]instanceof j){var n=arguments[0];return this.intersects(n.x,n.y)}}else if(2===arguments.length){var c=arguments[0],f=arguments[1];return!this.isNull()&&!(c>this._maxx||c<this._minx||f>this._maxy||f<this._miny)}},ke.prototype.getMinY=function(){return this._miny},ke.prototype.getMinX=function(){return this._minx},ke.prototype.expandToInclude=function(){if(1===arguments.length){if(arguments[0]instanceof j){var e=arguments[0];this.expandToInclude(e.x,e.y)}else if(arguments[0]instanceof ke){var n=arguments[0];if(n.isNull())return null;this.isNull()?(this._minx=n.getMinX(),this._maxx=n.getMaxX(),this._miny=n.getMinY(),this._maxy=n.getMaxY()):(n._minx<this._minx&&(this._minx=n._minx),n._maxx>this._maxx&&(this._maxx=n._maxx),n._miny<this._miny&&(this._miny=n._miny),n._maxy>this._maxy&&(this._maxy=n._maxy))}}else if(2===arguments.length){var c=arguments[0],f=arguments[1];this.isNull()?(this._minx=c,this._maxx=c,this._miny=f,this._maxy=f):(c<this._minx&&(this._minx=c),c>this._maxx&&(this._maxx=c),f<this._miny&&(this._miny=f),f>this._maxy&&(this._maxy=f))}},ke.prototype.minExtent=function(){if(this.isNull())return 0;var e=this.getWidth(),n=this.getHeight();return e<n?e:n},ke.prototype.getWidth=function(){return this.isNull()?0:this._maxx-this._minx},ke.prototype.compareTo=function(e){var n=e;return this.isNull()?n.isNull()?0:-1:n.isNull()?1:this._minx<n._minx?-1:this._minx>n._minx?1:this._miny<n._miny?-1:this._miny>n._miny?1:this._maxx<n._maxx?-1:this._maxx>n._maxx?1:this._maxy<n._maxy?-1:this._maxy>n._maxy?1:0},ke.prototype.translate=function(e,n){if(this.isNull())return null;this.init(this.getMinX()+e,this.getMaxX()+e,this.getMinY()+n,this.getMaxY()+n)},ke.prototype.toString=function(){return"Env["+this._minx+" : "+this._maxx+", "+this._miny+" : "+this._maxy+"]"},ke.prototype.setToNull=function(){this._minx=0,this._maxx=-1,this._miny=0,this._maxy=-1},ke.prototype.getHeight=function(){return this.isNull()?0:this._maxy-this._miny},ke.prototype.maxExtent=function(){if(this.isNull())return 0;var e=this.getWidth(),n=this.getHeight();return e>n?e:n},ke.prototype.expandBy=function(){if(1===arguments.length){var e=arguments[0];this.expandBy(e,e)}else if(2===arguments.length){var n=arguments[0],c=arguments[1];if(this.isNull())return null;this._minx-=n,this._maxx+=n,this._miny-=c,this._maxy+=c,(this._minx>this._maxx||this._miny>this._maxy)&&this.setToNull()}},ke.prototype.contains=function(){if(1===arguments.length){if(arguments[0]instanceof ke)return this.covers(arguments[0]);if(arguments[0]instanceof j)return this.covers(arguments[0])}else if(2===arguments.length)return this.covers(arguments[0],arguments[1])},ke.prototype.centre=function(){return this.isNull()?null:new j((this.getMinX()+this.getMaxX())/2,(this.getMinY()+this.getMaxY())/2)},ke.prototype.init=function(){if(0===arguments.length)this.setToNull();else if(1===arguments.length){if(arguments[0]instanceof j){var e=arguments[0];this.init(e.x,e.x,e.y,e.y)}else if(arguments[0]instanceof ke){var n=arguments[0];this._minx=n._minx,this._maxx=n._maxx,this._miny=n._miny,this._maxy=n._maxy}}else if(2===arguments.length){var c=arguments[0],f=arguments[1];this.init(c.x,f.x,c.y,f.y)}else if(4===arguments.length){var x=arguments[0],L=arguments[1],z=arguments[2],W=arguments[3];x<L?(this._minx=x,this._maxx=L):(this._minx=L,this._maxx=x),z<W?(this._miny=z,this._maxy=W):(this._miny=W,this._maxy=z)}},ke.prototype.getMaxY=function(){return this._maxy},ke.prototype.distance=function(e){if(this.intersects(e))return 0;var n=0;this._maxx<e._minx?n=e._minx-this._maxx:this._minx>e._maxx&&(n=this._minx-e._maxx);var c=0;return this._maxy<e._miny?c=e._miny-this._maxy:this._miny>e._maxy&&(c=this._miny-e._maxy),0===n?c:0===c?n:Math.sqrt(n*n+c*c)},ke.prototype.hashCode=function(){var e=17;return 37*(e=37*(e=37*(e=37*e+j.hashCode(this._minx))+j.hashCode(this._maxx))+j.hashCode(this._miny))+j.hashCode(this._maxy)},ke.prototype.interfaces_=function(){return[Q,yt]},ke.prototype.getClass=function(){return ke},ke.intersects=function(){if(3===arguments.length){var e=arguments[0],n=arguments[1],c=arguments[2];return c.x>=(e.x<n.x?e.x:n.x)&&c.x<=(e.x>n.x?e.x:n.x)&&c.y>=(e.y<n.y?e.y:n.y)&&c.y<=(e.y>n.y?e.y:n.y)}if(4===arguments.length){var f=arguments[0],x=arguments[1],L=arguments[2],z=arguments[3],W=Math.min(L.x,z.x),gt=Math.max(L.x,z.x),Zt=Math.min(f.x,x.x),Ie=Math.max(f.x,x.x);return!(Zt>gt||Ie<W||(W=Math.min(L.y,z.y),gt=Math.max(L.y,z.y),Zt=Math.min(f.y,x.y),Ie=Math.max(f.y,x.y),Zt>gt||Ie<W))}},fi.serialVersionUID.get=function(){return 0x51845cd552189800},Object.defineProperties(ke,fi);var Mn={typeStr:/^\s*(\w+)\s*\(\s*(.*)\s*\)\s*$/,emptyTypeStr:/^\s*(\w+)\s*EMPTY\s*$/,spaces:/\s+/,parenComma:/\)\s*,\s*\(/,doubleParenComma:/\)\s*\)\s*,\s*\(\s*\(/,trimParens:/^\s*\(?(.*?)\)?\s*$/},Xn=function(e){this.geometryFactory=e||new nn};Xn.prototype.read=function(e){var n,c;e=e.replace(/[\n\r]/g," ");var x=Mn.typeStr.exec(e);if(-1!==e.search("EMPTY")&&((x=Mn.emptyTypeStr.exec(e))[2]=void 0),x&&(c=x[1].toLowerCase(),Jn[c]&&(n=Jn[c].apply(this,[x[2]]))),void 0===n)throw new Error("Could not parse WKT "+e);return n},Xn.prototype.write=function(e){return this.extractGeometry(e)},Xn.prototype.extractGeometry=function(e){var n=e.getGeometryType().toLowerCase();if(!li[n])return null;var c=n.toUpperCase();return e.isEmpty()?c+" EMPTY":c+"("+li[n].apply(this,[e])+")"};var li={coordinate:function(e){return e.x+" "+e.y},point:function(e){return li.coordinate.call(this,e._coordinates._coordinates[0])},multipoint:function(e){for(var n=[],c=0,f=e._geometries.length;c<f;++c)n.push("("+li.point.apply(this,[e._geometries[c]])+")");return n.join(",")},linestring:function(e){for(var n=[],c=0,f=e._points._coordinates.length;c<f;++c)n.push(li.coordinate.apply(this,[e._points._coordinates[c]]));return n.join(",")},linearring:function(e){for(var n=[],c=0,f=e._points._coordinates.length;c<f;++c)n.push(li.coordinate.apply(this,[e._points._coordinates[c]]));return n.join(",")},multilinestring:function(e){for(var n=[],c=0,f=e._geometries.length;c<f;++c)n.push("("+li.linestring.apply(this,[e._geometries[c]])+")");return n.join(",")},polygon:function(e){var n=[];n.push("("+li.linestring.apply(this,[e._shell])+")");for(var c=0,f=e._holes.length;c<f;++c)n.push("("+li.linestring.apply(this,[e._holes[c]])+")");return n.join(",")},multipolygon:function(e){for(var n=[],c=0,f=e._geometries.length;c<f;++c)n.push("("+li.polygon.apply(this,[e._geometries[c]])+")");return n.join(",")},geometrycollection:function(e){for(var n=[],c=0,f=e._geometries.length;c<f;++c)n.push(this.extractGeometry(e._geometries[c]));return n.join(",")}},Jn={point:function(e){if(void 0===e)return this.geometryFactory.createPoint();var n=e.trim().split(Mn.spaces);return this.geometryFactory.createPoint(new j(Number.parseFloat(n[0]),Number.parseFloat(n[1])))},multipoint:function(e){if(void 0===e)return this.geometryFactory.createMultiPoint();for(var n,c=e.trim().split(","),f=[],x=0,L=c.length;x<L;++x)n=c[x].replace(Mn.trimParens,"$1"),f.push(Jn.point.apply(this,[n]));return this.geometryFactory.createMultiPoint(f)},linestring:function(e){if(void 0===e)return this.geometryFactory.createLineString();for(var n,c=e.trim().split(","),f=[],x=0,L=c.length;x<L;++x)n=c[x].trim().split(Mn.spaces),f.push(new j(Number.parseFloat(n[0]),Number.parseFloat(n[1])));return this.geometryFactory.createLineString(f)},linearring:function(e){if(void 0===e)return this.geometryFactory.createLinearRing();for(var n,c=e.trim().split(","),f=[],x=0,L=c.length;x<L;++x)n=c[x].trim().split(Mn.spaces),f.push(new j(Number.parseFloat(n[0]),Number.parseFloat(n[1])));return this.geometryFactory.createLinearRing(f)},multilinestring:function(e){if(void 0===e)return this.geometryFactory.createMultiLineString();for(var n,c=e.trim().split(Mn.parenComma),f=[],x=0,L=c.length;x<L;++x)n=c[x].replace(Mn.trimParens,"$1"),f.push(Jn.linestring.apply(this,[n]));return this.geometryFactory.createMultiLineString(f)},polygon:function(e){if(void 0===e)return this.geometryFactory.createPolygon();for(var n,c,f,x,L=e.trim().split(Mn.parenComma),z=[],W=0,gt=L.length;W<gt;++W)n=L[W].replace(Mn.trimParens,"$1"),c=Jn.linestring.apply(this,[n]),f=this.geometryFactory.createLinearRing(c._points),0===W?x=f:z.push(f);return this.geometryFactory.createPolygon(x,z)},multipolygon:function(e){if(void 0===e)return this.geometryFactory.createMultiPolygon();for(var n,c=e.trim().split(Mn.doubleParenComma),f=[],x=0,L=c.length;x<L;++x)n=c[x].replace(Mn.trimParens,"$1"),f.push(Jn.polygon.apply(this,[n]));return this.geometryFactory.createMultiPolygon(f)},geometrycollection:function(e){if(void 0===e)return this.geometryFactory.createGeometryCollection();for(var n=(e=e.replace(/,\s*([A-Za-z])/g,"|$1")).trim().split("|"),c=[],f=0,x=n.length;f<x;++f)c.push(this.read(n[f]));return this.geometryFactory.createGeometryCollection(c)}},le=function(e){this.parser=new Xn(e)};le.prototype.write=function(e){return this.parser.write(e)},le.toLineString=function(e,n){if(2!==arguments.length)throw new Error("Not implemented");return"LINESTRING ( "+e.x+" "+e.y+", "+n.x+" "+n.y+" )"};var ot=function(e){function n(c){e.call(this,c),this.name="RuntimeException",this.message=c,this.stack=(new e).stack}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n}(Error),rt=function(e){function n(){e.call(this),0===arguments.length?e.call(this):1===arguments.length&&e.call(this,arguments[0])}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype.interfaces_=function(){return[]},n.prototype.getClass=function(){return n},n}(ot),tt=function(){};tt.prototype.interfaces_=function(){return[]},tt.prototype.getClass=function(){return tt},tt.shouldNeverReachHere=function(){if(0===arguments.length)tt.shouldNeverReachHere(null);else if(1===arguments.length){var e=arguments[0];throw new rt("Should never reach here"+(null!==e?": "+e:""))}},tt.isTrue=function(){var n;if(1===arguments.length)tt.isTrue(arguments[0],null);else if(2===arguments.length&&(n=arguments[1],!arguments[0]))throw null===n?new rt:new rt(n)},tt.equals=function(){var e,n,c;if(2===arguments.length)tt.equals(e=arguments[0],n=arguments[1],null);else if(3===arguments.length&&(c=arguments[2],!(n=arguments[1]).equals(e=arguments[0])))throw new rt("Expected "+e+" but encountered "+n+(null!==c?": "+c:""))};var Pt=function(){this._result=null,this._inputLines=Array(2).fill().map(function(){return Array(2)}),this._intPt=new Array(2).fill(null),this._intLineIndex=null,this._isProper=null,this._pa=null,this._pb=null,this._precisionModel=null,this._intPt[0]=new j,this._intPt[1]=new j,this._pa=this._intPt[0],this._pb=this._intPt[1],this._result=0},Kt={DONT_INTERSECT:{configurable:!0},DO_INTERSECT:{configurable:!0},COLLINEAR:{configurable:!0},NO_INTERSECTION:{configurable:!0},POINT_INTERSECTION:{configurable:!0},COLLINEAR_INTERSECTION:{configurable:!0}};Pt.prototype.getIndexAlongSegment=function(e,n){return this.computeIntLineIndex(),this._intLineIndex[e][n]},Pt.prototype.getTopologySummary=function(){var e=new Tt;return this.isEndPoint()&&e.append(" endpoint"),this._isProper&&e.append(" proper"),this.isCollinear()&&e.append(" collinear"),e.toString()},Pt.prototype.computeIntersection=function(e,n,c,f){this._inputLines[0][0]=e,this._inputLines[0][1]=n,this._inputLines[1][0]=c,this._inputLines[1][1]=f,this._result=this.computeIntersect(e,n,c,f)},Pt.prototype.getIntersectionNum=function(){return this._result},Pt.prototype.computeIntLineIndex=function(){if(0===arguments.length)null===this._intLineIndex&&(this._intLineIndex=Array(2).fill().map(function(){return Array(2)}),this.computeIntLineIndex(0),this.computeIntLineIndex(1));else if(1===arguments.length){var e=arguments[0];this.getEdgeDistance(e,0)>this.getEdgeDistance(e,1)?(this._intLineIndex[e][0]=0,this._intLineIndex[e][1]=1):(this._intLineIndex[e][0]=1,this._intLineIndex[e][1]=0)}},Pt.prototype.isProper=function(){return this.hasIntersection()&&this._isProper},Pt.prototype.setPrecisionModel=function(e){this._precisionModel=e},Pt.prototype.isInteriorIntersection=function(){if(0===arguments.length)return!!this.isInteriorIntersection(0)||!!this.isInteriorIntersection(1);if(1===arguments.length){for(var e=arguments[0],n=0;n<this._result;n++)if(!this._intPt[n].equals2D(this._inputLines[e][0])&&!this._intPt[n].equals2D(this._inputLines[e][1]))return!0;return!1}},Pt.prototype.getIntersection=function(e){return this._intPt[e]},Pt.prototype.isEndPoint=function(){return this.hasIntersection()&&!this._isProper},Pt.prototype.hasIntersection=function(){return this._result!==Pt.NO_INTERSECTION},Pt.prototype.getEdgeDistance=function(e,n){return Pt.computeEdgeDistance(this._intPt[n],this._inputLines[e][0],this._inputLines[e][1])},Pt.prototype.isCollinear=function(){return this._result===Pt.COLLINEAR_INTERSECTION},Pt.prototype.toString=function(){return le.toLineString(this._inputLines[0][0],this._inputLines[0][1])+" - "+le.toLineString(this._inputLines[1][0],this._inputLines[1][1])+this.getTopologySummary()},Pt.prototype.getEndpoint=function(e,n){return this._inputLines[e][n]},Pt.prototype.isIntersection=function(e){for(var n=0;n<this._result;n++)if(this._intPt[n].equals2D(e))return!0;return!1},Pt.prototype.getIntersectionAlongSegment=function(e,n){return this.computeIntLineIndex(),this._intPt[this._intLineIndex[e][n]]},Pt.prototype.interfaces_=function(){return[]},Pt.prototype.getClass=function(){return Pt},Pt.computeEdgeDistance=function(e,n,c){var f=Math.abs(c.x-n.x),x=Math.abs(c.y-n.y),L=-1;if(e.equals(n))L=0;else if(e.equals(c))L=f>x?f:x;else{var z=Math.abs(e.x-n.x),W=Math.abs(e.y-n.y);0!==(L=f>x?z:W)||e.equals(n)||(L=Math.max(z,W))}return tt.isTrue(!(0===L&&!e.equals(n)),"Bad distance calculation"),L},Pt.nonRobustComputeEdgeDistance=function(e,n,c){var f=e.x-n.x,x=e.y-n.y,L=Math.sqrt(f*f+x*x);return tt.isTrue(!(0===L&&!e.equals(n)),"Invalid distance calculation"),L},Kt.DONT_INTERSECT.get=function(){return 0},Kt.DO_INTERSECT.get=function(){return 1},Kt.COLLINEAR.get=function(){return 2},Kt.NO_INTERSECTION.get=function(){return 0},Kt.POINT_INTERSECTION.get=function(){return 1},Kt.COLLINEAR_INTERSECTION.get=function(){return 2},Object.defineProperties(Pt,Kt);var Ee=function(e){function n(){e.apply(this,arguments)}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype.isInSegmentEnvelopes=function(c){var f=new ke(this._inputLines[0][0],this._inputLines[0][1]),x=new ke(this._inputLines[1][0],this._inputLines[1][1]);return f.contains(c)&&x.contains(c)},n.prototype.computeIntersection=function(){if(3!==arguments.length)return e.prototype.computeIntersection.apply(this,arguments);var c=arguments[0],f=arguments[1],x=arguments[2];if(this._isProper=!1,ke.intersects(f,x,c)&&0===Re.orientationIndex(f,x,c)&&0===Re.orientationIndex(x,f,c))return this._isProper=!0,(c.equals(f)||c.equals(x))&&(this._isProper=!1),this._result=e.POINT_INTERSECTION,null;this._result=e.NO_INTERSECTION},n.prototype.normalizeToMinimum=function(c,f,x,L,z){z.x=this.smallestInAbsValue(c.x,f.x,x.x,L.x),z.y=this.smallestInAbsValue(c.y,f.y,x.y,L.y),c.x-=z.x,c.y-=z.y,f.x-=z.x,f.y-=z.y,x.x-=z.x,x.y-=z.y,L.x-=z.x,L.y-=z.y},n.prototype.safeHCoordinateIntersection=function(c,f,x,L){var z=null;try{z=Cr.intersection(c,f,x,L)}catch(W){if(!(W instanceof Yr))throw W;z=n.nearestEndpoint(c,f,x,L)}return z},n.prototype.intersection=function(c,f,x,L){var z=this.intersectionWithNormalization(c,f,x,L);return this.isInSegmentEnvelopes(z)||(z=new j(n.nearestEndpoint(c,f,x,L))),null!==this._precisionModel&&this._precisionModel.makePrecise(z),z},n.prototype.smallestInAbsValue=function(c,f,x,L){var z=c,W=Math.abs(z);return Math.abs(f)<W&&(z=f,W=Math.abs(f)),Math.abs(x)<W&&(z=x,W=Math.abs(x)),Math.abs(L)<W&&(z=L),z},n.prototype.checkDD=function(c,f,x,L,z){var W=Fe.intersection(c,f,x,L),gt=this.isInSegmentEnvelopes(W);Sr.out.println("DD in env = "+gt+"  --------------------- "+W),z.distance(W)>1e-4&&Sr.out.println("Distance = "+z.distance(W))},n.prototype.intersectionWithNormalization=function(c,f,x,L){var z=new j(c),W=new j(f),gt=new j(x),Zt=new j(L),Ie=new j;this.normalizeToEnvCentre(z,W,gt,Zt,Ie);var Me=this.safeHCoordinateIntersection(z,W,gt,Zt);return Me.x+=Ie.x,Me.y+=Ie.y,Me},n.prototype.computeCollinearIntersection=function(c,f,x,L){var z=ke.intersects(c,f,x),W=ke.intersects(c,f,L),gt=ke.intersects(x,L,c),Zt=ke.intersects(x,L,f);return z&&W?(this._intPt[0]=x,this._intPt[1]=L,e.COLLINEAR_INTERSECTION):gt&&Zt?(this._intPt[0]=c,this._intPt[1]=f,e.COLLINEAR_INTERSECTION):z&&gt?(this._intPt[0]=x,this._intPt[1]=c,!x.equals(c)||W||Zt?e.COLLINEAR_INTERSECTION:e.POINT_INTERSECTION):z&&Zt?(this._intPt[0]=x,this._intPt[1]=f,!x.equals(f)||W||gt?e.COLLINEAR_INTERSECTION:e.POINT_INTERSECTION):W&&gt?(this._intPt[0]=L,this._intPt[1]=c,!L.equals(c)||z||Zt?e.COLLINEAR_INTERSECTION:e.POINT_INTERSECTION):W&&Zt?(this._intPt[0]=L,this._intPt[1]=f,!L.equals(f)||z||gt?e.COLLINEAR_INTERSECTION:e.POINT_INTERSECTION):e.NO_INTERSECTION},n.prototype.normalizeToEnvCentre=function(c,f,x,L,z){var W=c.x<f.x?c.x:f.x,gt=c.y<f.y?c.y:f.y,Zt=c.x>f.x?c.x:f.x,Ie=c.y>f.y?c.y:f.y,Me=x.x<L.x?x.x:L.x,tr=x.y<L.y?x.y:L.y,mr=x.x>L.x?x.x:L.x,Ar=x.y>L.y?x.y:L.y,Wn=((gt>tr?gt:tr)+(Ie<Ar?Ie:Ar))/2;z.x=((W>Me?W:Me)+(Zt<mr?Zt:mr))/2,z.y=Wn,c.x-=z.x,c.y-=z.y,f.x-=z.x,f.y-=z.y,x.x-=z.x,x.y-=z.y,L.x-=z.x,L.y-=z.y},n.prototype.computeIntersect=function(c,f,x,L){if(this._isProper=!1,!ke.intersects(c,f,x,L))return e.NO_INTERSECTION;var z=Re.orientationIndex(c,f,x),W=Re.orientationIndex(c,f,L);if(z>0&&W>0||z<0&&W<0)return e.NO_INTERSECTION;var gt=Re.orientationIndex(x,L,c),Zt=Re.orientationIndex(x,L,f);return gt>0&&Zt>0||gt<0&&Zt<0?e.NO_INTERSECTION:0===z&&0===W&&0===gt&&0===Zt?this.computeCollinearIntersection(c,f,x,L):(0===z||0===W||0===gt||0===Zt?(this._isProper=!1,c.equals2D(x)||c.equals2D(L)?this._intPt[0]=c:f.equals2D(x)||f.equals2D(L)?this._intPt[0]=f:0===z?this._intPt[0]=new j(x):0===W?this._intPt[0]=new j(L):0===gt?this._intPt[0]=new j(c):0===Zt&&(this._intPt[0]=new j(f))):(this._isProper=!0,this._intPt[0]=this.intersection(c,f,x,L)),e.POINT_INTERSECTION)},n.prototype.interfaces_=function(){return[]},n.prototype.getClass=function(){return n},n.nearestEndpoint=function(c,f,x,L){var z=c,W=Re.distancePointLine(c,x,L),gt=Re.distancePointLine(f,x,L);return gt<W&&(W=gt,z=f),(gt=Re.distancePointLine(x,c,f))<W&&(W=gt,z=x),(gt=Re.distancePointLine(L,c,f))<W&&(W=gt,z=L),z},n}(Pt),Ge=function(){};Ge.prototype.interfaces_=function(){return[]},Ge.prototype.getClass=function(){return Ge},Ge.orientationIndex=function(e,n,c){return Ge.signOfDet2x2(n.x-e.x,n.y-e.y,c.x-n.x,c.y-n.y)},Ge.signOfDet2x2=function(e,n,c,f){var x=null,L=null,z=null;if(x=1,0===e||0===f)return 0===n||0===c?0:n>0?c>0?-x:x:c>0?x:-x;if(0===n||0===c)return f>0?e>0?x:-x:e>0?-x:x;if(n>0?f>0?n<=f||(x=-x,L=e,e=c,c=L,L=n,n=f,f=L):n<=-f?(x=-x,c=-c,f=-f):(L=e,e=-c,c=L,L=n,n=-f,f=L):f>0?-n<=f?(x=-x,e=-e,n=-n):(L=-e,e=c,c=L,L=-n,n=f,f=L):n>=f?(e=-e,n=-n,c=-c,f=-f):(x=-x,L=-e,e=-c,c=L,L=-n,n=-f,f=L),e>0){if(!(c>0&&e<=c))return x}else{if(c>0||!(e>=c))return-x;x=-x,e=-e,c=-c}for(;;){if((f-=(z=Math.floor(c/e))*n)<0)return-x;if(f>n)return x;if(e>(c-=z*e)+c){if(n<f+f)return x}else{if(n>f+f)return-x;c=e-c,f=n-f,x=-x}if(0===f)return 0===c?0:-x;if(0===c||(e-=(z=Math.floor(e/c))*c,(n-=z*f)<0))return x;if(n>f)return-x;if(c>e+e){if(f<n+n)return-x}else{if(f>n+n)return x;e=c-e,n=f-n,x=-x}if(0===n)return 0===e?0:x;if(0===e)return-x}};var Xe=function(){this._p=null,this._crossingCount=0,this._isPointOnSegment=!1,this._p=arguments[0]};Xe.prototype.countSegment=function(e,n){if(e.x<this._p.x&&n.x<this._p.x)return null;if(this._p.x===n.x&&this._p.y===n.y)return this._isPointOnSegment=!0,null;if(e.y===this._p.y&&n.y===this._p.y){var c=e.x,f=n.x;return c>f&&(c=n.x,f=e.x),this._p.x>=c&&this._p.x<=f&&(this._isPointOnSegment=!0),null}if(e.y>this._p.y&&n.y<=this._p.y||n.y>this._p.y&&e.y<=this._p.y){var L=e.y-this._p.y,W=n.y-this._p.y,gt=Ge.signOfDet2x2(e.x-this._p.x,L,n.x-this._p.x,W);if(0===gt)return this._isPointOnSegment=!0,null;W<L&&(gt=-gt),gt>0&&this._crossingCount++}},Xe.prototype.isPointInPolygon=function(){return this.getLocation()!==ct.EXTERIOR},Xe.prototype.getLocation=function(){return this._isPointOnSegment?ct.BOUNDARY:this._crossingCount%2==1?ct.INTERIOR:ct.EXTERIOR},Xe.prototype.isOnSegment=function(){return this._isPointOnSegment},Xe.prototype.interfaces_=function(){return[]},Xe.prototype.getClass=function(){return Xe},Xe.locatePointInRing=function(){if(arguments[0]instanceof j&&Te(arguments[1],Oe)){for(var n=arguments[1],c=new Xe(arguments[0]),f=new j,x=new j,L=1;L<n.size();L++)if(n.getCoordinate(L,f),n.getCoordinate(L-1,x),c.countSegment(f,x),c.isOnSegment())return c.getLocation();return c.getLocation()}if(arguments[0]instanceof j&&arguments[1]instanceof Array){for(var W=arguments[1],gt=new Xe(arguments[0]),Zt=1;Zt<W.length;Zt++)if(gt.countSegment(W[Zt],W[Zt-1]),gt.isOnSegment())return gt.getLocation();return gt.getLocation()}};var Re=function(){},rn={CLOCKWISE:{configurable:!0},RIGHT:{configurable:!0},COUNTERCLOCKWISE:{configurable:!0},LEFT:{configurable:!0},COLLINEAR:{configurable:!0},STRAIGHT:{configurable:!0}};Re.prototype.interfaces_=function(){return[]},Re.prototype.getClass=function(){return Re},Re.orientationIndex=function(e,n,c){return Fe.orientationIndex(e,n,c)},Re.signedArea=function(){if(arguments[0]instanceof Array){var e=arguments[0];if(e.length<3)return 0;for(var n=0,c=e[0].x,f=1;f<e.length-1;f++)n+=(e[f].x-c)*(e[f-1].y-e[f+1].y);return n/2}if(Te(arguments[0],Oe)){var z=arguments[0],W=z.size();if(W<3)return 0;var gt=new j,Zt=new j,Ie=new j;z.getCoordinate(0,Zt),z.getCoordinate(1,Ie);var Me=Zt.x;Ie.x-=Me;for(var tr=0,mr=1;mr<W-1;mr++)gt.y=Zt.y,Zt.x=Ie.x,Zt.y=Ie.y,z.getCoordinate(mr+1,Ie),Ie.x-=Me,tr+=Zt.x*(gt.y-Ie.y);return tr/2}},Re.distanceLineLine=function(e,n,c,f){if(e.equals(n))return Re.distancePointLine(e,c,f);if(c.equals(f))return Re.distancePointLine(f,e,n);var x=!1;if(ke.intersects(e,n,c,f)){var L=(n.x-e.x)*(f.y-c.y)-(n.y-e.y)*(f.x-c.x);if(0===L)x=!0;else{var W=((e.y-c.y)*(n.x-e.x)-(e.x-c.x)*(n.y-e.y))/L,gt=((e.y-c.y)*(f.x-c.x)-(e.x-c.x)*(f.y-c.y))/L;(gt<0||gt>1||W<0||W>1)&&(x=!0)}}else x=!0;return x?wt.min(Re.distancePointLine(e,c,f),Re.distancePointLine(n,c,f),Re.distancePointLine(c,e,n),Re.distancePointLine(f,e,n)):0},Re.isPointInRing=function(e,n){return Re.locatePointInRing(e,n)!==ct.EXTERIOR},Re.computeLength=function(e){var n=e.size();if(n<=1)return 0;var c=0,f=new j;e.getCoordinate(0,f);for(var x=f.x,L=f.y,z=1;z<n;z++){e.getCoordinate(z,f);var W=f.x,gt=f.y,Zt=W-x,Ie=gt-L;c+=Math.sqrt(Zt*Zt+Ie*Ie),x=W,L=gt}return c},Re.isCCW=function(e){var n=e.length-1;if(n<3)throw new J("Ring has fewer than 4 points, so orientation cannot be determined");for(var c=e[0],f=0,x=1;x<=n;x++){var L=e[x];L.y>c.y&&(c=L,f=x)}var z=f;do{(z-=1)<0&&(z=n)}while(e[z].equals2D(c)&&z!==f);var W=f;do{W=(W+1)%n}while(e[W].equals2D(c)&&W!==f);var gt=e[z],Zt=e[W];if(gt.equals2D(c)||Zt.equals2D(c)||gt.equals2D(Zt))return!1;var Ie=Re.computeOrientation(gt,c,Zt);return 0===Ie?gt.x>Zt.x:Ie>0},Re.locatePointInRing=function(e,n){return Xe.locatePointInRing(e,n)},Re.distancePointLinePerpendicular=function(e,n,c){var f=(c.x-n.x)*(c.x-n.x)+(c.y-n.y)*(c.y-n.y);return Math.abs(((n.y-e.y)*(c.x-n.x)-(n.x-e.x)*(c.y-n.y))/f)*Math.sqrt(f)},Re.computeOrientation=function(e,n,c){return Re.orientationIndex(e,n,c)},Re.distancePointLine=function(){if(2===arguments.length){var e=arguments[0],n=arguments[1];if(0===n.length)throw new J("Line array must contain at least one vertex");for(var c=e.distance(n[0]),f=0;f<n.length-1;f++){var x=Re.distancePointLine(e,n[f],n[f+1]);x<c&&(c=x)}return c}if(3===arguments.length){var L=arguments[0],z=arguments[1],W=arguments[2];if(z.x===W.x&&z.y===W.y)return L.distance(z);var gt=(W.x-z.x)*(W.x-z.x)+(W.y-z.y)*(W.y-z.y),Zt=((L.x-z.x)*(W.x-z.x)+(L.y-z.y)*(W.y-z.y))/gt;return Zt<=0?L.distance(z):Zt>=1?L.distance(W):Math.abs(((z.y-L.y)*(W.x-z.x)-(z.x-L.x)*(W.y-z.y))/gt)*Math.sqrt(gt)}},Re.isOnLine=function(e,n){for(var c=new Ee,f=1;f<n.length;f++)if(c.computeIntersection(e,n[f-1],n[f]),c.hasIntersection())return!0;return!1},rn.CLOCKWISE.get=function(){return-1},rn.RIGHT.get=function(){return Re.CLOCKWISE},rn.COUNTERCLOCKWISE.get=function(){return 1},rn.LEFT.get=function(){return Re.COUNTERCLOCKWISE},rn.COLLINEAR.get=function(){return 0},rn.STRAIGHT.get=function(){return Re.COLLINEAR},Object.defineProperties(Re,rn);var cn=function(){};cn.prototype.filter=function(e){},cn.prototype.interfaces_=function(){return[]},cn.prototype.getClass=function(){return cn};var ur=function(){var e=arguments[0];this._envelope=null,this._factory=null,this._SRID=null,this._userData=null,this._factory=e,this._SRID=e.getSRID()},Jr={serialVersionUID:{configurable:!0},SORTINDEX_POINT:{configurable:!0},SORTINDEX_MULTIPOINT:{configurable:!0},SORTINDEX_LINESTRING:{configurable:!0},SORTINDEX_LINEARRING:{configurable:!0},SORTINDEX_MULTILINESTRING:{configurable:!0},SORTINDEX_POLYGON:{configurable:!0},SORTINDEX_MULTIPOLYGON:{configurable:!0},SORTINDEX_GEOMETRYCOLLECTION:{configurable:!0},geometryChangedFilter:{configurable:!0}};ur.prototype.isGeometryCollection=function(){return this.getSortIndex()===ur.SORTINDEX_GEOMETRYCOLLECTION},ur.prototype.getFactory=function(){return this._factory},ur.prototype.getGeometryN=function(e){return this},ur.prototype.getArea=function(){return 0},ur.prototype.isRectangle=function(){return!1},ur.prototype.equals=function(){if(arguments[0]instanceof ur){var e=arguments[0];return null!==e&&this.equalsTopo(e)}if(arguments[0]instanceof Object){var n=arguments[0];return n instanceof ur&&this.equalsExact(n)}},ur.prototype.equalsExact=function(e){return this===e||this.equalsExact(e,0)},ur.prototype.geometryChanged=function(){this.apply(ur.geometryChangedFilter)},ur.prototype.geometryChangedAction=function(){this._envelope=null},ur.prototype.equalsNorm=function(e){return null!==e&&this.norm().equalsExact(e.norm())},ur.prototype.getLength=function(){return 0},ur.prototype.getNumGeometries=function(){return 1},ur.prototype.compareTo=function(){if(1===arguments.length){var e=arguments[0],n=e;return this.getSortIndex()!==n.getSortIndex()?this.getSortIndex()-n.getSortIndex():this.isEmpty()&&n.isEmpty()?0:this.isEmpty()?-1:n.isEmpty()?1:this.compareToSameClass(e)}if(2===arguments.length){var c=arguments[0],f=arguments[1];return this.getSortIndex()!==c.getSortIndex()?this.getSortIndex()-c.getSortIndex():this.isEmpty()&&c.isEmpty()?0:this.isEmpty()?-1:c.isEmpty()?1:this.compareToSameClass(c,f)}},ur.prototype.getUserData=function(){return this._userData},ur.prototype.getSRID=function(){return this._SRID},ur.prototype.getEnvelope=function(){return this.getFactory().toGeometry(this.getEnvelopeInternal())},ur.prototype.checkNotGeometryCollection=function(e){if(e.getSortIndex()===ur.SORTINDEX_GEOMETRYCOLLECTION)throw new J("This method does not support GeometryCollection arguments")},ur.prototype.equal=function(e,n,c){return 0===c?e.equals(n):e.distance(n)<=c},ur.prototype.norm=function(){var e=this.copy();return e.normalize(),e},ur.prototype.getPrecisionModel=function(){return this._factory.getPrecisionModel()},ur.prototype.getEnvelopeInternal=function(){return null===this._envelope&&(this._envelope=this.computeEnvelopeInternal()),new ke(this._envelope)},ur.prototype.setSRID=function(e){this._SRID=e},ur.prototype.setUserData=function(e){this._userData=e},ur.prototype.compare=function(e,n){for(var c=e.iterator(),f=n.iterator();c.hasNext()&&f.hasNext();){var x=c.next(),L=f.next(),z=x.compareTo(L);if(0!==z)return z}return c.hasNext()?1:f.hasNext()?-1:0},ur.prototype.hashCode=function(){return this.getEnvelopeInternal().hashCode()},ur.prototype.isGeometryCollectionOrDerived=function(){return this.getSortIndex()===ur.SORTINDEX_GEOMETRYCOLLECTION||this.getSortIndex()===ur.SORTINDEX_MULTIPOINT||this.getSortIndex()===ur.SORTINDEX_MULTILINESTRING||this.getSortIndex()===ur.SORTINDEX_MULTIPOLYGON},ur.prototype.interfaces_=function(){return[et,Q,yt]},ur.prototype.getClass=function(){return ur},ur.hasNonEmptyElements=function(e){for(var n=0;n<e.length;n++)if(!e[n].isEmpty())return!0;return!1},ur.hasNullElements=function(e){for(var n=0;n<e.length;n++)if(null===e[n])return!0;return!1},Jr.serialVersionUID.get=function(){return 0x799ea46522854c00},Jr.SORTINDEX_POINT.get=function(){return 0},Jr.SORTINDEX_MULTIPOINT.get=function(){return 1},Jr.SORTINDEX_LINESTRING.get=function(){return 2},Jr.SORTINDEX_LINEARRING.get=function(){return 3},Jr.SORTINDEX_MULTILINESTRING.get=function(){return 4},Jr.SORTINDEX_POLYGON.get=function(){return 5},Jr.SORTINDEX_MULTIPOLYGON.get=function(){return 6},Jr.SORTINDEX_GEOMETRYCOLLECTION.get=function(){return 7},Jr.geometryChangedFilter.get=function(){return di},Object.defineProperties(ur,Jr);var di=function(){};di.interfaces_=function(){return[cn]},di.filter=function(e){e.geometryChangedAction()};var On=function(){};On.prototype.filter=function(e){},On.prototype.interfaces_=function(){return[]},On.prototype.getClass=function(){return On};var Nn=function(){},_i={Mod2BoundaryNodeRule:{configurable:!0},EndPointBoundaryNodeRule:{configurable:!0},MultiValentEndPointBoundaryNodeRule:{configurable:!0},MonoValentEndPointBoundaryNodeRule:{configurable:!0},MOD2_BOUNDARY_RULE:{configurable:!0},ENDPOINT_BOUNDARY_RULE:{configurable:!0},MULTIVALENT_ENDPOINT_BOUNDARY_RULE:{configurable:!0},MONOVALENT_ENDPOINT_BOUNDARY_RULE:{configurable:!0},OGC_SFS_BOUNDARY_RULE:{configurable:!0}};Nn.prototype.isInBoundary=function(e){},Nn.prototype.interfaces_=function(){return[]},Nn.prototype.getClass=function(){return Nn},_i.Mod2BoundaryNodeRule.get=function(){return ji},_i.EndPointBoundaryNodeRule.get=function(){return fo},_i.MultiValentEndPointBoundaryNodeRule.get=function(){return Xi},_i.MonoValentEndPointBoundaryNodeRule.get=function(){return to},_i.MOD2_BOUNDARY_RULE.get=function(){return new ji},_i.ENDPOINT_BOUNDARY_RULE.get=function(){return new fo},_i.MULTIVALENT_ENDPOINT_BOUNDARY_RULE.get=function(){return new Xi},_i.MONOVALENT_ENDPOINT_BOUNDARY_RULE.get=function(){return new to},_i.OGC_SFS_BOUNDARY_RULE.get=function(){return Nn.MOD2_BOUNDARY_RULE},Object.defineProperties(Nn,_i);var ji=function(){};ji.prototype.isInBoundary=function(e){return e%2==1},ji.prototype.interfaces_=function(){return[Nn]},ji.prototype.getClass=function(){return ji};var fo=function(){};fo.prototype.isInBoundary=function(e){return e>0},fo.prototype.interfaces_=function(){return[Nn]},fo.prototype.getClass=function(){return fo};var Xi=function(){};Xi.prototype.isInBoundary=function(e){return e>1},Xi.prototype.interfaces_=function(){return[Nn]},Xi.prototype.getClass=function(){return Xi};var to=function(){};to.prototype.isInBoundary=function(e){return 1===e},to.prototype.interfaces_=function(){return[Nn]},to.prototype.getClass=function(){return to};var $n=function(){};$n.prototype.add=function(){},$n.prototype.addAll=function(){},$n.prototype.isEmpty=function(){},$n.prototype.iterator=function(){},$n.prototype.size=function(){},$n.prototype.toArray=function(){},$n.prototype.remove=function(){},(D.prototype=new Error).name="IndexOutOfBoundsException";var go=function(){};go.prototype.hasNext=function(){},go.prototype.next=function(){},go.prototype.remove=function(){};var Oi=function(e){function n(){e.apply(this,arguments)}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype.get=function(){},n.prototype.set=function(){},n.prototype.isEmpty=function(){},n}($n);(y.prototype=new Error).name="NoSuchElementException";var Je=function(e){function n(){e.call(this),this.array_=[],arguments[0]instanceof $n&&this.addAll(arguments[0])}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype.ensureCapacity=function(){},n.prototype.interfaces_=function(){return[e,$n]},n.prototype.add=function(c){return 1===arguments.length?this.array_.push(c):this.array_.splice(arguments[0],arguments[1]),!0},n.prototype.clear=function(){this.array_=[]},n.prototype.addAll=function(c){for(var f=c.iterator();f.hasNext();)this.add(f.next());return!0},n.prototype.set=function(c,f){var x=this.array_[c];return this.array_[c]=f,x},n.prototype.iterator=function(){return new gi(this)},n.prototype.get=function(c){if(c<0||c>=this.size())throw new D;return this.array_[c]},n.prototype.isEmpty=function(){return 0===this.array_.length},n.prototype.size=function(){return this.array_.length},n.prototype.toArray=function(){for(var c=[],f=0,x=this.array_.length;f<x;f++)c.push(this.array_[f]);return c},n.prototype.remove=function(c){for(var f=!1,x=0,L=this.array_.length;x<L;x++)if(this.array_[x]===c){this.array_.splice(x,1),f=!0;break}return f},n}(Oi),gi=function(e){function n(c){e.call(this),this.arrayList_=c,this.position_=0}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype.next=function(){if(this.position_===this.arrayList_.size())throw new y;return this.arrayList_.get(this.position_++)},n.prototype.hasNext=function(){return this.position_<this.arrayList_.size()},n.prototype.set=function(c){return this.arrayList_.set(this.position_-1,c)},n.prototype.remove=function(){this.arrayList_.remove(this.arrayList_.get(this.position_))},n}(go),Z=function(e){function n(){if(e.call(this),0!==arguments.length)if(1===arguments.length){var f=arguments[0];this.ensureCapacity(f.length),this.add(f,!0)}else if(2===arguments.length){var x=arguments[0],L=arguments[1];this.ensureCapacity(x.length),this.add(x,L)}}e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n;var c={coordArrayType:{configurable:!0}};return c.coordArrayType.get=function(){return new Array(0).fill(null)},n.prototype.getCoordinate=function(f){return this.get(f)},n.prototype.addAll=function(){if(2===arguments.length){for(var x=arguments[1],L=!1,z=arguments[0].iterator();z.hasNext();)this.add(z.next(),x),L=!0;return L}return e.prototype.addAll.apply(this,arguments)},n.prototype.clone=function(){for(var f=e.prototype.clone.call(this),x=0;x<this.size();x++)f.add(x,this.get(x).copy());return f},n.prototype.toCoordinateArray=function(){return this.toArray(n.coordArrayType)},n.prototype.add=function(){if(1===arguments.length)e.prototype.add.call(this,arguments[0]);else if(2===arguments.length){if(arguments[0]instanceof Array&&"boolean"==typeof arguments[1])return this.add(arguments[0],arguments[1],!0),!0;if(arguments[0]instanceof j&&"boolean"==typeof arguments[1]){var z=arguments[0];if(!arguments[1]&&this.size()>=1&&this.get(this.size()-1).equals2D(z))return null;e.prototype.add.call(this,z)}else if(arguments[0]instanceof Object&&"boolean"==typeof arguments[1])return this.add(arguments[0],arguments[1]),!0}else if(3===arguments.length){if("boolean"==typeof arguments[2]&&arguments[0]instanceof Array&&"boolean"==typeof arguments[1]){var Zt=arguments[0],Ie=arguments[1];if(arguments[2])for(var Me=0;Me<Zt.length;Me++)this.add(Zt[Me],Ie);else for(var tr=Zt.length-1;tr>=0;tr--)this.add(Zt[tr],Ie);return!0}if("boolean"==typeof arguments[2]&&Number.isInteger(arguments[0])&&arguments[1]instanceof j){var mr=arguments[0],Ar=arguments[1];if(!arguments[2]){var Xr=this.size();if(Xr>0&&(mr>0&&this.get(mr-1).equals2D(Ar)||mr<Xr&&this.get(mr).equals2D(Ar)))return null}e.prototype.add.call(this,mr,Ar)}}else if(4===arguments.length){var Wn=arguments[0],u=arguments[1],p=arguments[2],l=arguments[3],g=1;p>l&&(g=-1);for(var E=p;E!==l;E+=g)this.add(Wn[E],u);return!0}},n.prototype.closeRing=function(){this.size()>0&&this.add(new j(this.get(0)),!1)},n.prototype.interfaces_=function(){return[]},n.prototype.getClass=function(){return n},Object.defineProperties(n,c),n}(Je),Y=function(){},it={ForwardComparator:{configurable:!0},BidirectionalComparator:{configurable:!0},coordArrayType:{configurable:!0}};it.ForwardComparator.get=function(){return ht},it.BidirectionalComparator.get=function(){return Ot},it.coordArrayType.get=function(){return new Array(0).fill(null)},Y.prototype.interfaces_=function(){return[]},Y.prototype.getClass=function(){return Y},Y.isRing=function(e){return!(e.length<4||!e[0].equals2D(e[e.length-1]))},Y.ptNotInList=function(e,n){for(var c=0;c<e.length;c++){var f=e[c];if(Y.indexOf(f,n)<0)return f}return null},Y.scroll=function(e,n){var c=Y.indexOf(n,e);if(c<0)return null;var f=new Array(e.length).fill(null);Sr.arraycopy(e,c,f,0,e.length-c),Sr.arraycopy(e,0,f,e.length-c,c),Sr.arraycopy(f,0,e,0,e.length)},Y.equals=function(){if(2===arguments.length){var e=arguments[0],n=arguments[1];if(e===n)return!0;if(null===e||null===n||e.length!==n.length)return!1;for(var c=0;c<e.length;c++)if(!e[c].equals(n[c]))return!1;return!0}if(3===arguments.length){var f=arguments[0],x=arguments[1],L=arguments[2];if(f===x)return!0;if(null===f||null===x||f.length!==x.length)return!1;for(var z=0;z<f.length;z++)if(0!==L.compare(f[z],x[z]))return!1;return!0}},Y.intersection=function(e,n){for(var c=new Z,f=0;f<e.length;f++)n.intersects(e[f])&&c.add(e[f],!0);return c.toCoordinateArray()},Y.hasRepeatedPoints=function(e){for(var n=1;n<e.length;n++)if(e[n-1].equals(e[n]))return!0;return!1},Y.removeRepeatedPoints=function(e){return Y.hasRepeatedPoints(e)?new Z(e,!1).toCoordinateArray():e},Y.reverse=function(e){for(var n=e.length-1,c=Math.trunc(n/2),f=0;f<=c;f++){var x=e[f];e[f]=e[n-f],e[n-f]=x}},Y.removeNull=function(e){for(var n=0,c=0;c<e.length;c++)null!==e[c]&&n++;var f=new Array(n).fill(null);if(0===n)return f;for(var x=0,L=0;L<e.length;L++)null!==e[L]&&(f[x++]=e[L]);return f},Y.copyDeep=function(){if(1===arguments.length){for(var e=arguments[0],n=new Array(e.length).fill(null),c=0;c<e.length;c++)n[c]=new j(e[c]);return n}if(5===arguments.length)for(var f=arguments[0],x=arguments[1],L=arguments[2],z=arguments[3],W=arguments[4],gt=0;gt<W;gt++)L[z+gt]=new j(f[x+gt])},Y.isEqualReversed=function(e,n){for(var c=0;c<e.length;c++)if(0!==e[c].compareTo(n[e.length-c-1]))return!1;return!0},Y.envelope=function(e){for(var n=new ke,c=0;c<e.length;c++)n.expandToInclude(e[c]);return n},Y.toCoordinateArray=function(e){return e.toArray(Y.coordArrayType)},Y.atLeastNCoordinatesOrNothing=function(e,n){return n.length>=e?n:[]},Y.indexOf=function(e,n){for(var c=0;c<n.length;c++)if(e.equals(n[c]))return c;return-1},Y.increasingDirection=function(e){for(var n=0;n<Math.trunc(e.length/2);n++){var f=e[n].compareTo(e[e.length-1-n]);if(0!==f)return f}return 1},Y.compare=function(e,n){for(var c=0;c<e.length&&c<n.length;){var f=e[c].compareTo(n[c]);if(0!==f)return f;c++}return c<n.length?-1:c<e.length?1:0},Y.minCoordinate=function(e){for(var n=null,c=0;c<e.length;c++)(null===n||n.compareTo(e[c])>0)&&(n=e[c]);return n},Y.extract=function(e,n,c){n=wt.clamp(n,0,e.length);var f=(c=wt.clamp(c,-1,e.length))-n+1;c<0&&(f=0),n>=e.length&&(f=0),c<n&&(f=0);var x=new Array(f).fill(null);if(0===f)return x;for(var L=0,z=n;z<=c;z++)x[L++]=e[z];return x},Object.defineProperties(Y,it);var ht=function(){};ht.prototype.compare=function(e,n){return Y.compare(e,n)},ht.prototype.interfaces_=function(){return[st]},ht.prototype.getClass=function(){return ht};var Ot=function(){};Ot.prototype.compare=function(e,n){var c=e,f=n;if(c.length<f.length)return-1;if(c.length>f.length)return 1;if(0===c.length)return 0;var x=Y.compare(c,f);return Y.isEqualReversed(c,f)?0:x},Ot.prototype.OLDcompare=function(e,n){var c=e,f=n;if(c.length<f.length)return-1;if(c.length>f.length)return 1;if(0===c.length)return 0;for(var x=Y.increasingDirection(c),L=Y.increasingDirection(f),z=x>0?0:c.length-1,W=L>0?0:c.length-1,gt=0;gt<c.length;gt++){var Zt=c[z].compareTo(f[W]);if(0!==Zt)return Zt;z+=x,W+=L}return 0},Ot.prototype.interfaces_=function(){return[st]},Ot.prototype.getClass=function(){return Ot};var Xt=function(){};Xt.prototype.get=function(){},Xt.prototype.put=function(){},Xt.prototype.size=function(){},Xt.prototype.values=function(){},Xt.prototype.entrySet=function(){};var ne=function(e){function n(){e.apply(this,arguments)}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n}(Xt);(Bt.prototype=new Error).name="OperationNotSupported",(ft.prototype=new $n).contains=function(){};var Yt=function(e){function n(){e.call(this),this.array_=[],arguments[0]instanceof $n&&this.addAll(arguments[0])}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype.contains=function(c){for(var f=0,x=this.array_.length;f<x;f++)if(this.array_[f]===c)return!0;return!1},n.prototype.add=function(c){return!this.contains(c)&&(this.array_.push(c),!0)},n.prototype.addAll=function(c){for(var f=c.iterator();f.hasNext();)this.add(f.next());return!0},n.prototype.remove=function(c){throw new Error},n.prototype.size=function(){return this.array_.length},n.prototype.isEmpty=function(){return 0===this.array_.length},n.prototype.toArray=function(){for(var c=[],f=0,x=this.array_.length;f<x;f++)c.push(this.array_[f]);return c},n.prototype.iterator=function(){return new xt(this)},n}(ft),xt=function(e){function n(c){e.call(this),this.hashSet_=c,this.position_=0}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype.next=function(){if(this.position_===this.hashSet_.size())throw new y;return this.hashSet_.array_[this.position_++]},n.prototype.hasNext=function(){return this.position_<this.hashSet_.size()},n.prototype.remove=function(){throw new Bt},n}(go),Ut=0;(ve.prototype=new ne).get=function(e){for(var n=this.root_;null!==n;){var c=e.compareTo(n.key);if(c<0)n=n.left;else{if(!(c>0))return n.value;n=n.right}}return null},ve.prototype.put=function(e,n){if(null===this.root_)return this.root_={key:e,value:n,left:null,right:null,parent:null,color:Ut,getValue:function(){return this.value},getKey:function(){return this.key}},this.size_=1,null;var c,f,x=this.root_;do{if(c=x,(f=e.compareTo(x.key))<0)x=x.left;else{if(!(f>0)){var L=x.value;return x.value=n,L}x=x.right}}while(null!==x);var z={key:e,left:null,right:null,value:n,parent:c,color:Ut,getValue:function(){return this.value},getKey:function(){return this.key}};return f<0?c.left=z:c.right=z,this.fixAfterInsertion(z),this.size_++,null},ve.prototype.fixAfterInsertion=function(e){for(e.color=1;null!=e&&e!==this.root_&&1===e.parent.color;)if(Ft(e)===Jt(Ft(Ft(e)))){var n=Ze(Ft(Ft(e)));1===It(n)?(he(Ft(e),Ut),he(n,Ut),he(Ft(Ft(e)),1),e=Ft(Ft(e))):(e===Ze(Ft(e))&&(e=Ft(e),this.rotateLeft(e)),he(Ft(e),Ut),he(Ft(Ft(e)),1),this.rotateRight(Ft(Ft(e))))}else{var c=Jt(Ft(Ft(e)));1===It(c)?(he(Ft(e),Ut),he(c,Ut),he(Ft(Ft(e)),1),e=Ft(Ft(e))):(e===Jt(Ft(e))&&(e=Ft(e),this.rotateRight(e)),he(Ft(e),Ut),he(Ft(Ft(e)),1),this.rotateLeft(Ft(Ft(e))))}this.root_.color=Ut},ve.prototype.values=function(){var e=new Je,n=this.getFirstEntry();if(null!==n)for(e.add(n.value);null!==(n=ve.successor(n));)e.add(n.value);return e},ve.prototype.entrySet=function(){var e=new Yt,n=this.getFirstEntry();if(null!==n)for(e.add(n);null!==(n=ve.successor(n));)e.add(n);return e},ve.prototype.rotateLeft=function(e){if(null!=e){var n=e.right;e.right=n.left,null!=n.left&&(n.left.parent=e),n.parent=e.parent,null===e.parent?this.root_=n:e.parent.left===e?e.parent.left=n:e.parent.right=n,n.left=e,e.parent=n}},ve.prototype.rotateRight=function(e){if(null!=e){var n=e.left;e.left=n.right,null!=n.right&&(n.right.parent=e),n.parent=e.parent,null===e.parent?this.root_=n:e.parent.right===e?e.parent.right=n:e.parent.left=n,n.right=e,e.parent=n}},ve.prototype.getFirstEntry=function(){var e=this.root_;if(null!=e)for(;null!=e.left;)e=e.left;return e},ve.successor=function(e){if(null===e)return null;if(null!==e.right){for(var n=e.right;null!==n.left;)n=n.left;return n}for(var c=e.parent,f=e;null!==c&&f===c.right;)f=c,c=c.parent;return c},ve.prototype.size=function(){return this.size_};var je=function(){};je.prototype.interfaces_=function(){return[]},je.prototype.getClass=function(){return je},ce.prototype=new ft,(_e.prototype=new ce).contains=function(e){for(var n=0,c=this.array_.length;n<c;n++)if(0===this.array_[n].compareTo(e))return!0;return!1},_e.prototype.add=function(e){if(this.contains(e))return!1;for(var n=0,c=this.array_.length;n<c;n++)if(1===this.array_[n].compareTo(e))return this.array_.splice(n,0,e),!0;return this.array_.push(e),!0},_e.prototype.addAll=function(e){for(var n=e.iterator();n.hasNext();)this.add(n.next());return!0},_e.prototype.remove=function(e){throw new Bt},_e.prototype.size=function(){return this.array_.length},_e.prototype.isEmpty=function(){return 0===this.array_.length},_e.prototype.toArray=function(){for(var e=[],n=0,c=this.array_.length;n<c;n++)e.push(this.array_[n]);return e},_e.prototype.iterator=function(){return new or(this)};var or=function(e){this.treeSet_=e,this.position_=0};or.prototype.next=function(){if(this.position_===this.treeSet_.size())throw new y;return this.treeSet_.array_[this.position_++]},or.prototype.hasNext=function(){return this.position_<this.treeSet_.size()},or.prototype.remove=function(){throw new Bt};var ye=function(){};ye.sort=function(){var e,n,c,x=arguments[0];if(1===arguments.length)x.sort(function(z,W){return z.compareTo(W)});else if(2===arguments.length)c=arguments[1],x.sort(function(z,W){return c.compare(z,W)});else if(3===arguments.length){(n=x.slice(arguments[1],arguments[2])).sort();var L=x.slice(0,arguments[1]).concat(n,x.slice(arguments[2],x.length));for(x.splice(0,x.length),e=0;e<L.length;e++)x.push(L[e])}else if(4===arguments.length)for(n=x.slice(arguments[1],arguments[2]),c=arguments[3],n.sort(function(z,W){return c.compare(z,W)}),L=x.slice(0,arguments[1]).concat(n,x.slice(arguments[2],x.length)),x.splice(0,x.length),e=0;e<L.length;e++)x.push(L[e])},ye.asList=function(e){for(var n=new Je,c=0,f=e.length;c<f;c++)n.add(e[c]);return n};var Le=function(){},lr={P:{configurable:!0},L:{configurable:!0},A:{configurable:!0},FALSE:{configurable:!0},TRUE:{configurable:!0},DONTCARE:{configurable:!0},SYM_FALSE:{configurable:!0},SYM_TRUE:{configurable:!0},SYM_DONTCARE:{configurable:!0},SYM_P:{configurable:!0},SYM_L:{configurable:!0},SYM_A:{configurable:!0}};lr.P.get=function(){return 0},lr.L.get=function(){return 1},lr.A.get=function(){return 2},lr.FALSE.get=function(){return-1},lr.TRUE.get=function(){return-2},lr.DONTCARE.get=function(){return-3},lr.SYM_FALSE.get=function(){return"F"},lr.SYM_TRUE.get=function(){return"T"},lr.SYM_DONTCARE.get=function(){return"*"},lr.SYM_P.get=function(){return"0"},lr.SYM_L.get=function(){return"1"},lr.SYM_A.get=function(){return"2"},Le.prototype.interfaces_=function(){return[]},Le.prototype.getClass=function(){return Le},Le.toDimensionSymbol=function(e){switch(e){case Le.FALSE:return Le.SYM_FALSE;case Le.TRUE:return Le.SYM_TRUE;case Le.DONTCARE:return Le.SYM_DONTCARE;case Le.P:return Le.SYM_P;case Le.L:return Le.SYM_L;case Le.A:return Le.SYM_A}throw new J("Unknown dimension value: "+e)},Le.toDimensionValue=function(e){switch(Qt.toUpperCase(e)){case Le.SYM_FALSE:return Le.FALSE;case Le.SYM_TRUE:return Le.TRUE;case Le.SYM_DONTCARE:return Le.DONTCARE;case Le.SYM_P:return Le.P;case Le.SYM_L:return Le.L;case Le.SYM_A:return Le.A}throw new J("Unknown dimension symbol: "+e)},Object.defineProperties(Le,lr);var pr=function(){};pr.prototype.filter=function(e){},pr.prototype.interfaces_=function(){return[]},pr.prototype.getClass=function(){return pr};var Pr=function(){};Pr.prototype.filter=function(e,n){},Pr.prototype.isDone=function(){},Pr.prototype.isGeometryChanged=function(){},Pr.prototype.interfaces_=function(){return[]},Pr.prototype.getClass=function(){return Pr};var De=function(e){function n(f,x){if(e.call(this,x),this._geometries=f||[],e.hasNullElements(this._geometries))throw new J("geometries must not contain null elements")}e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n;var c={serialVersionUID:{configurable:!0}};return n.prototype.computeEnvelopeInternal=function(){for(var f=new ke,x=0;x<this._geometries.length;x++)f.expandToInclude(this._geometries[x].getEnvelopeInternal());return f},n.prototype.getGeometryN=function(f){return this._geometries[f]},n.prototype.getSortIndex=function(){return e.SORTINDEX_GEOMETRYCOLLECTION},n.prototype.getCoordinates=function(){for(var f=new Array(this.getNumPoints()).fill(null),x=-1,L=0;L<this._geometries.length;L++)for(var z=this._geometries[L].getCoordinates(),W=0;W<z.length;W++)f[++x]=z[W];return f},n.prototype.getArea=function(){for(var f=0,x=0;x<this._geometries.length;x++)f+=this._geometries[x].getArea();return f},n.prototype.equalsExact=function(){if(2===arguments.length){var f=arguments[0],x=arguments[1];if(!this.isEquivalentClass(f))return!1;var L=f;if(this._geometries.length!==L._geometries.length)return!1;for(var z=0;z<this._geometries.length;z++)if(!this._geometries[z].equalsExact(L._geometries[z],x))return!1;return!0}return e.prototype.equalsExact.apply(this,arguments)},n.prototype.normalize=function(){for(var f=0;f<this._geometries.length;f++)this._geometries[f].normalize();ye.sort(this._geometries)},n.prototype.getCoordinate=function(){return this.isEmpty()?null:this._geometries[0].getCoordinate()},n.prototype.getBoundaryDimension=function(){for(var f=Le.FALSE,x=0;x<this._geometries.length;x++)f=Math.max(f,this._geometries[x].getBoundaryDimension());return f},n.prototype.getDimension=function(){for(var f=Le.FALSE,x=0;x<this._geometries.length;x++)f=Math.max(f,this._geometries[x].getDimension());return f},n.prototype.getLength=function(){for(var f=0,x=0;x<this._geometries.length;x++)f+=this._geometries[x].getLength();return f},n.prototype.getNumPoints=function(){for(var f=0,x=0;x<this._geometries.length;x++)f+=this._geometries[x].getNumPoints();return f},n.prototype.getNumGeometries=function(){return this._geometries.length},n.prototype.reverse=function(){for(var x=new Array(this._geometries.length).fill(null),L=0;L<this._geometries.length;L++)x[L]=this._geometries[L].reverse();return this.getFactory().createGeometryCollection(x)},n.prototype.compareToSameClass=function(){if(1===arguments.length){var f=arguments[0],x=new _e(ye.asList(this._geometries)),L=new _e(ye.asList(f._geometries));return this.compare(x,L)}if(2===arguments.length){for(var W=arguments[1],gt=arguments[0],Zt=this.getNumGeometries(),Ie=gt.getNumGeometries(),Me=0;Me<Zt&&Me<Ie;){var tr=this.getGeometryN(Me),mr=gt.getGeometryN(Me),Ar=tr.compareToSameClass(mr,W);if(0!==Ar)return Ar;Me++}return Me<Zt?1:Me<Ie?-1:0}},n.prototype.apply=function(){if(Te(arguments[0],On))for(var f=arguments[0],x=0;x<this._geometries.length;x++)this._geometries[x].apply(f);else if(Te(arguments[0],Pr)){var L=arguments[0];if(0===this._geometries.length)return null;for(var z=0;z<this._geometries.length&&(this._geometries[z].apply(L),!L.isDone());z++);L.isGeometryChanged()&&this.geometryChanged()}else if(Te(arguments[0],pr)){var W=arguments[0];W.filter(this);for(var gt=0;gt<this._geometries.length;gt++)this._geometries[gt].apply(W)}else if(Te(arguments[0],cn)){var Zt=arguments[0];Zt.filter(this);for(var Ie=0;Ie<this._geometries.length;Ie++)this._geometries[Ie].apply(Zt)}},n.prototype.getBoundary=function(){return this.checkNotGeometryCollection(this),tt.shouldNeverReachHere(),null},n.prototype.clone=function(){var f=e.prototype.clone.call(this);f._geometries=new Array(this._geometries.length).fill(null);for(var x=0;x<this._geometries.length;x++)f._geometries[x]=this._geometries[x].clone();return f},n.prototype.getGeometryType=function(){return"GeometryCollection"},n.prototype.copy=function(){for(var f=new Array(this._geometries.length).fill(null),x=0;x<f.length;x++)f[x]=this._geometries[x].copy();return new n(f,this._factory)},n.prototype.isEmpty=function(){for(var f=0;f<this._geometries.length;f++)if(!this._geometries[f].isEmpty())return!1;return!0},n.prototype.interfaces_=function(){return[]},n.prototype.getClass=function(){return n},c.serialVersionUID.get=function(){return-0x4f07bcb1f857d800},Object.defineProperties(n,c),n}(ur),sr=function(e){function n(){e.apply(this,arguments)}e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n;var c={serialVersionUID:{configurable:!0}};return n.prototype.getSortIndex=function(){return ur.SORTINDEX_MULTILINESTRING},n.prototype.equalsExact=function(){if(2===arguments.length){var f=arguments[0],x=arguments[1];return!!this.isEquivalentClass(f)&&e.prototype.equalsExact.call(this,f,x)}return e.prototype.equalsExact.apply(this,arguments)},n.prototype.getBoundaryDimension=function(){return this.isClosed()?Le.FALSE:0},n.prototype.isClosed=function(){if(this.isEmpty())return!1;for(var f=0;f<this._geometries.length;f++)if(!this._geometries[f].isClosed())return!1;return!0},n.prototype.getDimension=function(){return 1},n.prototype.reverse=function(){for(var f=this._geometries.length,x=new Array(f).fill(null),L=0;L<this._geometries.length;L++)x[f-1-L]=this._geometries[L].reverse();return this.getFactory().createMultiLineString(x)},n.prototype.getBoundary=function(){return new Be(this).getBoundary()},n.prototype.getGeometryType=function(){return"MultiLineString"},n.prototype.copy=function(){for(var f=new Array(this._geometries.length).fill(null),x=0;x<f.length;x++)f[x]=this._geometries[x].copy();return new n(f,this._factory)},n.prototype.interfaces_=function(){return[je]},n.prototype.getClass=function(){return n},c.serialVersionUID.get=function(){return 0x7155d2ab4afa8000},Object.defineProperties(n,c),n}(De),Be=function(){if(this._geom=null,this._geomFact=null,this._bnRule=null,this._endpointMap=null,1===arguments.length){var e=arguments[0],n=Nn.MOD2_BOUNDARY_RULE;this._geom=e,this._geomFact=e.getFactory(),this._bnRule=n}else if(2===arguments.length){var c=arguments[0],f=arguments[1];this._geom=c,this._geomFact=c.getFactory(),this._bnRule=f}};Be.prototype.boundaryMultiLineString=function(e){if(this._geom.isEmpty())return this.getEmptyMultiPoint();var n=this.computeBoundaryCoordinates(e);return 1===n.length?this._geomFact.createPoint(n[0]):this._geomFact.createMultiPointFromCoords(n)},Be.prototype.getBoundary=function(){return this._geom instanceof zr?this.boundaryLineString(this._geom):this._geom instanceof sr?this.boundaryMultiLineString(this._geom):this._geom.getBoundary()},Be.prototype.boundaryLineString=function(e){return this._geom.isEmpty()?this.getEmptyMultiPoint():e.isClosed()?this._bnRule.isInBoundary(2)?e.getStartPoint():this._geomFact.createMultiPoint():this._geomFact.createMultiPoint([e.getStartPoint(),e.getEndPoint()])},Be.prototype.getEmptyMultiPoint=function(){return this._geomFact.createMultiPoint()},Be.prototype.computeBoundaryCoordinates=function(e){var n=new Je;this._endpointMap=new ve;for(var c=0;c<e.getNumGeometries();c++){var f=e.getGeometryN(c);0!==f.getNumPoints()&&(this.addEndpoint(f.getCoordinateN(0)),this.addEndpoint(f.getCoordinateN(f.getNumPoints()-1)))}for(var x=this._endpointMap.entrySet().iterator();x.hasNext();){var L=x.next(),z=L.getValue().count;this._bnRule.isInBoundary(z)&&n.add(L.getKey())}return Y.toCoordinateArray(n)},Be.prototype.addEndpoint=function(e){var n=this._endpointMap.get(e);null===n&&(n=new sn,this._endpointMap.put(e,n)),n.count++},Be.prototype.interfaces_=function(){return[]},Be.prototype.getClass=function(){return Be},Be.getBoundary=function(){return 1===arguments.length?new Be(arguments[0]).getBoundary():2===arguments.length?new Be(arguments[0],arguments[1]).getBoundary():void 0};var sn=function(){this.count=null};sn.prototype.interfaces_=function(){return[]},sn.prototype.getClass=function(){return sn};var qr=function(){},Tr={NEWLINE:{configurable:!0},SIMPLE_ORDINATE_FORMAT:{configurable:!0}};qr.prototype.interfaces_=function(){return[]},qr.prototype.getClass=function(){return qr},qr.chars=function(e,n){for(var c=new Array(n).fill(null),f=0;f<n;f++)c[f]=e;return String(c)},qr.getStackTrace=function(){if(1===arguments.length){var e=arguments[0],n=new function(){},c=new function(){}(n);return e.printStackTrace(c),n.toString()}if(2===arguments.length){for(var x=arguments[1],L="",z=new function(){}(new function(){}(qr.getStackTrace(arguments[0]))),W=0;W<x;W++)try{L+=z.readLine()+qr.NEWLINE}catch(gt){if(!(gt instanceof We))throw gt;tt.shouldNeverReachHere()}return L}},qr.split=function(e,n){for(var c=n.length,f=new Je,x=""+e,L=x.indexOf(n);L>=0;){var z=x.substring(0,L);f.add(z),L=(x=x.substring(L+c)).indexOf(n)}x.length>0&&f.add(x);for(var W=new Array(f.size()).fill(null),gt=0;gt<W.length;gt++)W[gt]=f.get(gt);return W},qr.toString=function(){if(1===arguments.length)return qr.SIMPLE_ORDINATE_FORMAT.format(arguments[0])},qr.spaces=function(e){return qr.chars(" ",e)},Tr.NEWLINE.get=function(){return Sr.getProperty("line.separator")},Tr.SIMPLE_ORDINATE_FORMAT.get=function(){return new function(){}("0.#")},Object.defineProperties(qr,Tr);var wr=function(){};wr.prototype.interfaces_=function(){return[]},wr.prototype.getClass=function(){return wr},wr.copyCoord=function(e,n,c,f){for(var x=Math.min(e.getDimension(),c.getDimension()),L=0;L<x;L++)c.setOrdinate(f,L,e.getOrdinate(n,L))},wr.isRing=function(e){var n=e.size();return 0===n||!(n<=3)&&e.getOrdinate(0,Oe.X)===e.getOrdinate(n-1,Oe.X)&&e.getOrdinate(0,Oe.Y)===e.getOrdinate(n-1,Oe.Y)},wr.isEqual=function(e,n){var c=e.size();if(c!==n.size())return!1;for(var f=Math.min(e.getDimension(),n.getDimension()),x=0;x<c;x++)for(var L=0;L<f;L++){var z=e.getOrdinate(x,L),W=n.getOrdinate(x,L);if(!(e.getOrdinate(x,L)===n.getOrdinate(x,L)||$.isNaN(z)&&$.isNaN(W)))return!1}return!0},wr.extend=function(e,n,c){var f=e.create(c,n.getDimension()),x=n.size();if(wr.copy(n,0,f,0,x),x>0)for(var L=x;L<c;L++)wr.copy(n,x-1,f,L,1);return f},wr.reverse=function(e){for(var n=e.size()-1,c=Math.trunc(n/2),f=0;f<=c;f++)wr.swap(e,f,n-f)},wr.swap=function(e,n,c){if(n===c)return null;for(var f=0;f<e.getDimension();f++){var x=e.getOrdinate(n,f);e.setOrdinate(n,f,e.getOrdinate(c,f)),e.setOrdinate(c,f,x)}},wr.copy=function(e,n,c,f,x){for(var L=0;L<x;L++)wr.copyCoord(e,n+L,c,f+L)},wr.toString=function(){if(1===arguments.length){var e=arguments[0],n=e.size();if(0===n)return"()";var c=e.getDimension(),f=new Tt;f.append("(");for(var x=0;x<n;x++){x>0&&f.append(" ");for(var L=0;L<c;L++)L>0&&f.append(","),f.append(qr.toString(e.getOrdinate(x,L)))}return f.append(")"),f.toString()}},wr.ensureValidRing=function(e,n){var c=n.size();return 0===c?n:c<=3?wr.createClosedRing(e,n,4):n.getOrdinate(0,Oe.X)===n.getOrdinate(c-1,Oe.X)&&n.getOrdinate(0,Oe.Y)===n.getOrdinate(c-1,Oe.Y)?n:wr.createClosedRing(e,n,c+1)},wr.createClosedRing=function(e,n,c){var f=e.create(c,n.getDimension()),x=n.size();wr.copy(n,0,f,0,x);for(var L=x;L<c;L++)wr.copy(n,0,f,L,1);return f};var zr=function(e){function n(f,x){e.call(this,x),this._points=null,this.init(f)}e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n;var c={serialVersionUID:{configurable:!0}};return n.prototype.computeEnvelopeInternal=function(){return this.isEmpty()?new ke:this._points.expandEnvelope(new ke)},n.prototype.isRing=function(){return this.isClosed()&&this.isSimple()},n.prototype.getSortIndex=function(){return e.SORTINDEX_LINESTRING},n.prototype.getCoordinates=function(){return this._points.toCoordinateArray()},n.prototype.equalsExact=function(){if(2===arguments.length){var f=arguments[0],x=arguments[1];if(!this.isEquivalentClass(f))return!1;var L=f;if(this._points.size()!==L._points.size())return!1;for(var z=0;z<this._points.size();z++)if(!this.equal(this._points.getCoordinate(z),L._points.getCoordinate(z),x))return!1;return!0}return e.prototype.equalsExact.apply(this,arguments)},n.prototype.normalize=function(){for(var f=0;f<Math.trunc(this._points.size()/2);f++){var x=this._points.size()-1-f;if(!this._points.getCoordinate(f).equals(this._points.getCoordinate(x)))return this._points.getCoordinate(f).compareTo(this._points.getCoordinate(x))>0&&wr.reverse(this._points),null}},n.prototype.getCoordinate=function(){return this.isEmpty()?null:this._points.getCoordinate(0)},n.prototype.getBoundaryDimension=function(){return this.isClosed()?Le.FALSE:0},n.prototype.isClosed=function(){return!this.isEmpty()&&this.getCoordinateN(0).equals2D(this.getCoordinateN(this.getNumPoints()-1))},n.prototype.getEndPoint=function(){return this.isEmpty()?null:this.getPointN(this.getNumPoints()-1)},n.prototype.getDimension=function(){return 1},n.prototype.getLength=function(){return Re.computeLength(this._points)},n.prototype.getNumPoints=function(){return this._points.size()},n.prototype.reverse=function(){var f=this._points.copy();return wr.reverse(f),this.getFactory().createLineString(f)},n.prototype.compareToSameClass=function(){if(1===arguments.length){for(var f=arguments[0],x=0,L=0;x<this._points.size()&&L<f._points.size();){var z=this._points.getCoordinate(x).compareTo(f._points.getCoordinate(L));if(0!==z)return z;x++,L++}return x<this._points.size()?1:L<f._points.size()?-1:0}if(2===arguments.length)return arguments[1].compare(this._points,arguments[0]._points)},n.prototype.apply=function(){if(Te(arguments[0],On))for(var f=arguments[0],x=0;x<this._points.size();x++)f.filter(this._points.getCoordinate(x));else if(Te(arguments[0],Pr)){var L=arguments[0];if(0===this._points.size())return null;for(var z=0;z<this._points.size()&&(L.filter(this._points,z),!L.isDone());z++);L.isGeometryChanged()&&this.geometryChanged()}else(Te(arguments[0],pr)||Te(arguments[0],cn))&&arguments[0].filter(this)},n.prototype.getBoundary=function(){return new Be(this).getBoundary()},n.prototype.isEquivalentClass=function(f){return f instanceof n},n.prototype.clone=function(){var f=e.prototype.clone.call(this);return f._points=this._points.clone(),f},n.prototype.getCoordinateN=function(f){return this._points.getCoordinate(f)},n.prototype.getGeometryType=function(){return"LineString"},n.prototype.copy=function(){return new n(this._points.copy(),this._factory)},n.prototype.getCoordinateSequence=function(){return this._points},n.prototype.isEmpty=function(){return 0===this._points.size()},n.prototype.init=function(f){if(null===f&&(f=this.getFactory().getCoordinateSequenceFactory().create([])),1===f.size())throw new J("Invalid number of points in LineString (found "+f.size()+" - must be 0 or >= 2)");this._points=f},n.prototype.isCoordinate=function(f){for(var x=0;x<this._points.size();x++)if(this._points.getCoordinate(x).equals(f))return!0;return!1},n.prototype.getStartPoint=function(){return this.isEmpty()?null:this.getPointN(0)},n.prototype.getPointN=function(f){return this.getFactory().createPoint(this._points.getCoordinate(f))},n.prototype.interfaces_=function(){return[je]},n.prototype.getClass=function(){return n},c.serialVersionUID.get=function(){return 0x2b2b51ba435c8e00},Object.defineProperties(n,c),n}(ur),ui=function(){};ui.prototype.interfaces_=function(){return[]},ui.prototype.getClass=function(){return ui};var Tn=function(e){function n(f,x){e.call(this,x),this._coordinates=f||null,this.init(this._coordinates)}e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n;var c={serialVersionUID:{configurable:!0}};return n.prototype.computeEnvelopeInternal=function(){if(this.isEmpty())return new ke;var f=new ke;return f.expandToInclude(this._coordinates.getX(0),this._coordinates.getY(0)),f},n.prototype.getSortIndex=function(){return e.SORTINDEX_POINT},n.prototype.getCoordinates=function(){return this.isEmpty()?[]:[this.getCoordinate()]},n.prototype.equalsExact=function(){if(2===arguments.length){var f=arguments[0],x=arguments[1];return!!this.isEquivalentClass(f)&&(!(!this.isEmpty()||!f.isEmpty())||this.isEmpty()===f.isEmpty()&&this.equal(f.getCoordinate(),this.getCoordinate(),x))}return e.prototype.equalsExact.apply(this,arguments)},n.prototype.normalize=function(){},n.prototype.getCoordinate=function(){return 0!==this._coordinates.size()?this._coordinates.getCoordinate(0):null},n.prototype.getBoundaryDimension=function(){return Le.FALSE},n.prototype.getDimension=function(){return 0},n.prototype.getNumPoints=function(){return this.isEmpty()?0:1},n.prototype.reverse=function(){return this.copy()},n.prototype.getX=function(){if(null===this.getCoordinate())throw new Error("getX called on empty Point");return this.getCoordinate().x},n.prototype.compareToSameClass=function(){if(1===arguments.length){var f=arguments[0];return this.getCoordinate().compareTo(f.getCoordinate())}if(2===arguments.length)return arguments[1].compare(this._coordinates,arguments[0]._coordinates)},n.prototype.apply=function(){if(Te(arguments[0],On)){var f=arguments[0];if(this.isEmpty())return null;f.filter(this.getCoordinate())}else if(Te(arguments[0],Pr)){var x=arguments[0];if(this.isEmpty())return null;x.filter(this._coordinates,0),x.isGeometryChanged()&&this.geometryChanged()}else(Te(arguments[0],pr)||Te(arguments[0],cn))&&arguments[0].filter(this)},n.prototype.getBoundary=function(){return this.getFactory().createGeometryCollection(null)},n.prototype.clone=function(){var f=e.prototype.clone.call(this);return f._coordinates=this._coordinates.clone(),f},n.prototype.getGeometryType=function(){return"Point"},n.prototype.copy=function(){return new n(this._coordinates.copy(),this._factory)},n.prototype.getCoordinateSequence=function(){return this._coordinates},n.prototype.getY=function(){if(null===this.getCoordinate())throw new Error("getY called on empty Point");return this.getCoordinate().y},n.prototype.isEmpty=function(){return 0===this._coordinates.size()},n.prototype.init=function(f){null===f&&(f=this.getFactory().getCoordinateSequenceFactory().create([])),tt.isTrue(f.size()<=1),this._coordinates=f},n.prototype.isSimple=function(){return!0},n.prototype.interfaces_=function(){return[ui]},n.prototype.getClass=function(){return n},c.serialVersionUID.get=function(){return 0x44077bad161cbc00},Object.defineProperties(n,c),n}(ur),xn=function(){};xn.prototype.interfaces_=function(){return[]},xn.prototype.getClass=function(){return xn};var ln=function(e){function n(f,x,L){if(e.call(this,L),this._shell=null,this._holes=null,null===f&&(f=this.getFactory().createLinearRing()),null===x&&(x=[]),e.hasNullElements(x))throw new J("holes must not contain null elements");if(f.isEmpty()&&e.hasNonEmptyElements(x))throw new J("shell is empty but holes are not");this._shell=f,this._holes=x}e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n;var c={serialVersionUID:{configurable:!0}};return n.prototype.computeEnvelopeInternal=function(){return this._shell.getEnvelopeInternal()},n.prototype.getSortIndex=function(){return e.SORTINDEX_POLYGON},n.prototype.getCoordinates=function(){if(this.isEmpty())return[];for(var f=new Array(this.getNumPoints()).fill(null),x=-1,L=this._shell.getCoordinates(),z=0;z<L.length;z++)f[++x]=L[z];for(var W=0;W<this._holes.length;W++)for(var gt=this._holes[W].getCoordinates(),Zt=0;Zt<gt.length;Zt++)f[++x]=gt[Zt];return f},n.prototype.getArea=function(){var f=0;f+=Math.abs(Re.signedArea(this._shell.getCoordinateSequence()));for(var x=0;x<this._holes.length;x++)f-=Math.abs(Re.signedArea(this._holes[x].getCoordinateSequence()));return f},n.prototype.isRectangle=function(){if(0!==this.getNumInteriorRing()||null===this._shell||5!==this._shell.getNumPoints())return!1;for(var f=this._shell.getCoordinateSequence(),x=this.getEnvelopeInternal(),L=0;L<5;L++){var z=f.getX(L);if(z!==x.getMinX()&&z!==x.getMaxX())return!1;var W=f.getY(L);if(W!==x.getMinY()&&W!==x.getMaxY())return!1}for(var gt=f.getX(0),Zt=f.getY(0),Ie=1;Ie<=4;Ie++){var Me=f.getX(Ie),tr=f.getY(Ie);if(Me!==gt==(tr!==Zt))return!1;gt=Me,Zt=tr}return!0},n.prototype.equalsExact=function(){if(2===arguments.length){var f=arguments[0],x=arguments[1];if(!this.isEquivalentClass(f))return!1;var L=f;if(!this._shell.equalsExact(L._shell,x)||this._holes.length!==L._holes.length)return!1;for(var gt=0;gt<this._holes.length;gt++)if(!this._holes[gt].equalsExact(L._holes[gt],x))return!1;return!0}return e.prototype.equalsExact.apply(this,arguments)},n.prototype.normalize=function(){if(0===arguments.length){this.normalize(this._shell,!0);for(var f=0;f<this._holes.length;f++)this.normalize(this._holes[f],!1);ye.sort(this._holes)}else if(2===arguments.length){var x=arguments[0],L=arguments[1];if(x.isEmpty())return null;var z=new Array(x.getCoordinates().length-1).fill(null);Sr.arraycopy(x.getCoordinates(),0,z,0,z.length);var W=Y.minCoordinate(x.getCoordinates());Y.scroll(z,W),Sr.arraycopy(z,0,x.getCoordinates(),0,z.length),x.getCoordinates()[z.length]=z[0],Re.isCCW(x.getCoordinates())===L&&Y.reverse(x.getCoordinates())}},n.prototype.getCoordinate=function(){return this._shell.getCoordinate()},n.prototype.getNumInteriorRing=function(){return this._holes.length},n.prototype.getBoundaryDimension=function(){return 1},n.prototype.getDimension=function(){return 2},n.prototype.getLength=function(){var f=0;f+=this._shell.getLength();for(var x=0;x<this._holes.length;x++)f+=this._holes[x].getLength();return f},n.prototype.getNumPoints=function(){for(var f=this._shell.getNumPoints(),x=0;x<this._holes.length;x++)f+=this._holes[x].getNumPoints();return f},n.prototype.reverse=function(){var f=this.copy();f._shell=this._shell.copy().reverse(),f._holes=new Array(this._holes.length).fill(null);for(var x=0;x<this._holes.length;x++)f._holes[x]=this._holes[x].copy().reverse();return f},n.prototype.convexHull=function(){return this.getExteriorRing().convexHull()},n.prototype.compareToSameClass=function(){if(1===arguments.length)return this._shell.compareToSameClass(arguments[0]._shell);if(2===arguments.length){var W=arguments[1],gt=arguments[0],Me=this._shell.compareToSameClass(gt._shell,W);if(0!==Me)return Me;for(var tr=this.getNumInteriorRing(),mr=gt.getNumInteriorRing(),Ar=0;Ar<tr&&Ar<mr;){var Xr=this.getInteriorRingN(Ar),Wn=gt.getInteriorRingN(Ar),u=Xr.compareToSameClass(Wn,W);if(0!==u)return u;Ar++}return Ar<tr?1:Ar<mr?-1:0}},n.prototype.apply=function(f){if(Te(f,On)){this._shell.apply(f);for(var x=0;x<this._holes.length;x++)this._holes[x].apply(f)}else if(Te(f,Pr)){if(this._shell.apply(f),!f.isDone())for(var L=0;L<this._holes.length&&(this._holes[L].apply(f),!f.isDone());L++);f.isGeometryChanged()&&this.geometryChanged()}else if(Te(f,pr))f.filter(this);else if(Te(f,cn)){f.filter(this),this._shell.apply(f);for(var z=0;z<this._holes.length;z++)this._holes[z].apply(f)}},n.prototype.getBoundary=function(){if(this.isEmpty())return this.getFactory().createMultiLineString();var f=new Array(this._holes.length+1).fill(null);f[0]=this._shell;for(var x=0;x<this._holes.length;x++)f[x+1]=this._holes[x];return f.length<=1?this.getFactory().createLinearRing(f[0].getCoordinateSequence()):this.getFactory().createMultiLineString(f)},n.prototype.clone=function(){var f=e.prototype.clone.call(this);f._shell=this._shell.clone(),f._holes=new Array(this._holes.length).fill(null);for(var x=0;x<this._holes.length;x++)f._holes[x]=this._holes[x].clone();return f},n.prototype.getGeometryType=function(){return"Polygon"},n.prototype.copy=function(){for(var f=this._shell.copy(),x=new Array(this._holes.length).fill(null),L=0;L<x.length;L++)x[L]=this._holes[L].copy();return new n(f,x,this._factory)},n.prototype.getExteriorRing=function(){return this._shell},n.prototype.isEmpty=function(){return this._shell.isEmpty()},n.prototype.getInteriorRingN=function(f){return this._holes[f]},n.prototype.interfaces_=function(){return[xn]},n.prototype.getClass=function(){return n},c.serialVersionUID.get=function(){return-0x307ffefd8dc97200},Object.defineProperties(n,c),n}(ur),xi=function(e){function n(){e.apply(this,arguments)}e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n;var c={serialVersionUID:{configurable:!0}};return n.prototype.getSortIndex=function(){return ur.SORTINDEX_MULTIPOINT},n.prototype.isValid=function(){return!0},n.prototype.equalsExact=function(){if(2===arguments.length){var f=arguments[0],x=arguments[1];return!!this.isEquivalentClass(f)&&e.prototype.equalsExact.call(this,f,x)}return e.prototype.equalsExact.apply(this,arguments)},n.prototype.getCoordinate=function(){return 1===arguments.length?this._geometries[arguments[0]].getCoordinate():e.prototype.getCoordinate.apply(this,arguments)},n.prototype.getBoundaryDimension=function(){return Le.FALSE},n.prototype.getDimension=function(){return 0},n.prototype.getBoundary=function(){return this.getFactory().createGeometryCollection(null)},n.prototype.getGeometryType=function(){return"MultiPoint"},n.prototype.copy=function(){for(var f=new Array(this._geometries.length).fill(null),x=0;x<f.length;x++)f[x]=this._geometries[x].copy();return new n(f,this._factory)},n.prototype.interfaces_=function(){return[ui]},n.prototype.getClass=function(){return n},c.serialVersionUID.get=function(){return-0x6fb1ed4162e0fc00},Object.defineProperties(n,c),n}(De),zn=function(e){function n(f,x){f instanceof j&&x instanceof nn&&(f=x.getCoordinateSequenceFactory().create(f)),e.call(this,f,x),this.validateConstruction()}e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n;var c={MINIMUM_VALID_SIZE:{configurable:!0},serialVersionUID:{configurable:!0}};return n.prototype.getSortIndex=function(){return ur.SORTINDEX_LINEARRING},n.prototype.getBoundaryDimension=function(){return Le.FALSE},n.prototype.isClosed=function(){return!!this.isEmpty()||e.prototype.isClosed.call(this)},n.prototype.reverse=function(){var f=this._points.copy();return wr.reverse(f),this.getFactory().createLinearRing(f)},n.prototype.validateConstruction=function(){if(!this.isEmpty()&&!e.prototype.isClosed.call(this))throw new J("Points of LinearRing do not form a closed linestring");if(this.getCoordinateSequence().size()>=1&&this.getCoordinateSequence().size()<n.MINIMUM_VALID_SIZE)throw new J("Invalid number of points in LinearRing (found "+this.getCoordinateSequence().size()+" - must be 0 or >= 4)")},n.prototype.getGeometryType=function(){return"LinearRing"},n.prototype.copy=function(){return new n(this._points.copy(),this._factory)},n.prototype.interfaces_=function(){return[]},n.prototype.getClass=function(){return n},c.MINIMUM_VALID_SIZE.get=function(){return 4},c.serialVersionUID.get=function(){return-0x3b229e262367a600},Object.defineProperties(n,c),n}(zr),un=function(e){function n(){e.apply(this,arguments)}e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n;var c={serialVersionUID:{configurable:!0}};return n.prototype.getSortIndex=function(){return ur.SORTINDEX_MULTIPOLYGON},n.prototype.equalsExact=function(){if(2===arguments.length){var f=arguments[0],x=arguments[1];return!!this.isEquivalentClass(f)&&e.prototype.equalsExact.call(this,f,x)}return e.prototype.equalsExact.apply(this,arguments)},n.prototype.getBoundaryDimension=function(){return 1},n.prototype.getDimension=function(){return 2},n.prototype.reverse=function(){for(var x=new Array(this._geometries.length).fill(null),L=0;L<this._geometries.length;L++)x[L]=this._geometries[L].reverse();return this.getFactory().createMultiPolygon(x)},n.prototype.getBoundary=function(){if(this.isEmpty())return this.getFactory().createMultiLineString();for(var f=new Je,x=0;x<this._geometries.length;x++)for(var L=this._geometries[x].getBoundary(),z=0;z<L.getNumGeometries();z++)f.add(L.getGeometryN(z));var W=new Array(f.size()).fill(null);return this.getFactory().createMultiLineString(f.toArray(W))},n.prototype.getGeometryType=function(){return"MultiPolygon"},n.prototype.copy=function(){for(var f=new Array(this._geometries.length).fill(null),x=0;x<f.length;x++)f[x]=this._geometries[x].copy();return new n(f,this._factory)},n.prototype.interfaces_=function(){return[xn]},n.prototype.getClass=function(){return n},c.serialVersionUID.get=function(){return-0x7a5aa1369171980},Object.defineProperties(n,c),n}(De),ko=function(e){this._factory=e||null,this._isUserDataCopied=!1},An={NoOpGeometryOperation:{configurable:!0},CoordinateOperation:{configurable:!0},CoordinateSequenceOperation:{configurable:!0}};ko.prototype.setCopyUserData=function(e){this._isUserDataCopied=e},ko.prototype.edit=function(e,n){if(null===e)return null;var c=this.editInternal(e,n);return this._isUserDataCopied&&c.setUserData(e.getUserData()),c},ko.prototype.editInternal=function(e,n){return null===this._factory&&(this._factory=e.getFactory()),e instanceof De?this.editGeometryCollection(e,n):e instanceof ln?this.editPolygon(e,n):e instanceof Tn||e instanceof zr?n.edit(e,this._factory):(tt.shouldNeverReachHere("Unsupported Geometry class: "+e.getClass().getName()),null)},ko.prototype.editGeometryCollection=function(e,n){for(var c=n.edit(e,this._factory),f=new Je,x=0;x<c.getNumGeometries();x++){var L=this.edit(c.getGeometryN(x),n);null===L||L.isEmpty()||f.add(L)}return c.getClass()===xi?this._factory.createMultiPoint(f.toArray([])):c.getClass()===sr?this._factory.createMultiLineString(f.toArray([])):c.getClass()===un?this._factory.createMultiPolygon(f.toArray([])):this._factory.createGeometryCollection(f.toArray([]))},ko.prototype.editPolygon=function(e,n){var c=n.edit(e,this._factory);if(null===c&&(c=this._factory.createPolygon(null)),c.isEmpty())return c;var f=this.edit(c.getExteriorRing(),n);if(null===f||f.isEmpty())return this._factory.createPolygon();for(var x=new Je,L=0;L<c.getNumInteriorRing();L++){var z=this.edit(c.getInteriorRingN(L),n);null===z||z.isEmpty()||x.add(z)}return this._factory.createPolygon(f,x.toArray([]))},ko.prototype.interfaces_=function(){return[]},ko.prototype.getClass=function(){return ko},ko.GeometryEditorOperation=function(){},An.NoOpGeometryOperation.get=function(){return gs},An.CoordinateOperation.get=function(){return Vs},An.CoordinateSequenceOperation.get=function(){return oo},Object.defineProperties(ko,An);var gs=function(){};gs.prototype.edit=function(e,n){return e},gs.prototype.interfaces_=function(){return[ko.GeometryEditorOperation]},gs.prototype.getClass=function(){return gs};var Vs=function(){};Vs.prototype.edit=function(e,n){var c=this.editCoordinates(e.getCoordinates(),e);return null===c?e:e instanceof zn?n.createLinearRing(c):e instanceof zr?n.createLineString(c):e instanceof Tn?c.length>0?n.createPoint(c[0]):n.createPoint():e},Vs.prototype.interfaces_=function(){return[ko.GeometryEditorOperation]},Vs.prototype.getClass=function(){return Vs};var oo=function(){};oo.prototype.edit=function(e,n){return e instanceof zn?n.createLinearRing(this.edit(e.getCoordinateSequence(),e)):e instanceof zr?n.createLineString(this.edit(e.getCoordinateSequence(),e)):e instanceof Tn?n.createPoint(this.edit(e.getCoordinateSequence(),e)):e},oo.prototype.interfaces_=function(){return[ko.GeometryEditorOperation]},oo.prototype.getClass=function(){return oo};var Un=function(){if(this._dimension=3,this._coordinates=null,1===arguments.length){if(arguments[0]instanceof Array)this._coordinates=arguments[0],this._dimension=3;else if(Number.isInteger(arguments[0])){var e=arguments[0];this._coordinates=new Array(e).fill(null);for(var n=0;n<e;n++)this._coordinates[n]=new j}else if(Te(arguments[0],Oe)){var c=arguments[0];if(null===c)return this._coordinates=new Array(0).fill(null),null;this._dimension=c.getDimension(),this._coordinates=new Array(c.size()).fill(null);for(var f=0;f<this._coordinates.length;f++)this._coordinates[f]=c.getCoordinateCopy(f)}}else if(2===arguments.length)if(arguments[0]instanceof Array&&Number.isInteger(arguments[1])){var x=arguments[0],L=arguments[1];this._coordinates=x,this._dimension=L,null===x&&(this._coordinates=new Array(0).fill(null))}else if(Number.isInteger(arguments[0])&&Number.isInteger(arguments[1])){var z=arguments[0],W=arguments[1];this._coordinates=new Array(z).fill(null),this._dimension=W;for(var gt=0;gt<z;gt++)this._coordinates[gt]=new j}},ml={serialVersionUID:{configurable:!0}};Un.prototype.setOrdinate=function(e,n,c){switch(n){case Oe.X:this._coordinates[e].x=c;break;case Oe.Y:this._coordinates[e].y=c;break;case Oe.Z:this._coordinates[e].z=c;break;default:throw new J("invalid ordinateIndex")}},Un.prototype.size=function(){return this._coordinates.length},Un.prototype.getOrdinate=function(e,n){switch(n){case Oe.X:return this._coordinates[e].x;case Oe.Y:return this._coordinates[e].y;case Oe.Z:return this._coordinates[e].z}return $.NaN},Un.prototype.getCoordinate=function(){if(1===arguments.length)return this._coordinates[arguments[0]];if(2===arguments.length){var n=arguments[0],c=arguments[1];c.x=this._coordinates[n].x,c.y=this._coordinates[n].y,c.z=this._coordinates[n].z}},Un.prototype.getCoordinateCopy=function(e){return new j(this._coordinates[e])},Un.prototype.getDimension=function(){return this._dimension},Un.prototype.getX=function(e){return this._coordinates[e].x},Un.prototype.clone=function(){for(var e=new Array(this.size()).fill(null),n=0;n<this._coordinates.length;n++)e[n]=this._coordinates[n].clone();return new Un(e,this._dimension)},Un.prototype.expandEnvelope=function(e){for(var n=0;n<this._coordinates.length;n++)e.expandToInclude(this._coordinates[n]);return e},Un.prototype.copy=function(){for(var e=new Array(this.size()).fill(null),n=0;n<this._coordinates.length;n++)e[n]=this._coordinates[n].copy();return new Un(e,this._dimension)},Un.prototype.toString=function(){if(this._coordinates.length>0){var e=new Tt(17*this._coordinates.length);e.append("("),e.append(this._coordinates[0]);for(var n=1;n<this._coordinates.length;n++)e.append(", "),e.append(this._coordinates[n]);return e.append(")"),e.toString()}return"()"},Un.prototype.getY=function(e){return this._coordinates[e].y},Un.prototype.toCoordinateArray=function(){return this._coordinates},Un.prototype.interfaces_=function(){return[Oe,yt]},Un.prototype.getClass=function(){return Un},ml.serialVersionUID.get=function(){return-0xcb44a778db18e00},Object.defineProperties(Un,ml);var pa=function(){},mo={serialVersionUID:{configurable:!0},instanceObject:{configurable:!0}};pa.prototype.readResolve=function(){return pa.instance()},pa.prototype.create=function(){if(1===arguments.length){if(arguments[0]instanceof Array)return new Un(arguments[0]);if(Te(arguments[0],Oe))return new Un(arguments[0])}else if(2===arguments.length){var c=arguments[0],f=arguments[1];return f>3&&(f=3),f<2?new Un(c):new Un(c,f)}},pa.prototype.interfaces_=function(){return[Mt,yt]},pa.prototype.getClass=function(){return pa},pa.instance=function(){return pa.instanceObject},mo.serialVersionUID.get=function(){return-0x38e49fa6cf6f2e00},mo.instanceObject.get=function(){return new pa},Object.defineProperties(pa,mo);var Is=function(e){function n(){e.call(this),this.map_=new Map}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype.get=function(c){return this.map_.get(c)||null},n.prototype.put=function(c,f){return this.map_.set(c,f),f},n.prototype.values=function(){for(var c=new Je,f=this.map_.values(),x=f.next();!x.done;)c.add(x.value),x=f.next();return c},n.prototype.entrySet=function(){var c=new Yt;return this.map_.entries().forEach(function(f){return c.add(f)}),c},n.prototype.size=function(){return this.map_.size()},n}(Xt),bn=function e(){if(this._modelType=null,this._scale=null,0===arguments.length)this._modelType=e.FLOATING;else if(1===arguments.length)if(arguments[0]instanceof Di){var n=arguments[0];this._modelType=n,n===e.FIXED&&this.setScale(1)}else if("number"==typeof arguments[0]){var c=arguments[0];this._modelType=e.FIXED,this.setScale(c)}else if(arguments[0]instanceof e){var f=arguments[0];this._modelType=f._modelType,this._scale=f._scale}},Mi={serialVersionUID:{configurable:!0},maximumPreciseValue:{configurable:!0}};bn.prototype.equals=function(e){return e instanceof bn&&this._modelType===e._modelType&&this._scale===e._scale},bn.prototype.compareTo=function(e){var n=e,c=this.getMaximumSignificantDigits(),f=n.getMaximumSignificantDigits();return new Ht(c).compareTo(new Ht(f))},bn.prototype.getScale=function(){return this._scale},bn.prototype.isFloating=function(){return this._modelType===bn.FLOATING||this._modelType===bn.FLOATING_SINGLE},bn.prototype.getType=function(){return this._modelType},bn.prototype.toString=function(){var e="UNKNOWN";return this._modelType===bn.FLOATING?e="Floating":this._modelType===bn.FLOATING_SINGLE?e="Floating-Single":this._modelType===bn.FIXED&&(e="Fixed (Scale="+this.getScale()+")"),e},bn.prototype.makePrecise=function(){if("number"==typeof arguments[0]){var e=arguments[0];return $.isNaN(e)||this._modelType===bn.FLOATING_SINGLE?e:this._modelType===bn.FIXED?Math.round(e*this._scale)/this._scale:e}if(arguments[0]instanceof j){var n=arguments[0];if(this._modelType===bn.FLOATING)return null;n.x=this.makePrecise(n.x),n.y=this.makePrecise(n.y)}},bn.prototype.getMaximumSignificantDigits=function(){var e=16;return this._modelType===bn.FLOATING?e=16:this._modelType===bn.FLOATING_SINGLE?e=6:this._modelType===bn.FIXED&&(e=1+Math.trunc(Math.ceil(Math.log(this.getScale())/Math.log(10)))),e},bn.prototype.setScale=function(e){this._scale=Math.abs(e)},bn.prototype.interfaces_=function(){return[yt,Q]},bn.prototype.getClass=function(){return bn},bn.mostPrecise=function(e,n){return e.compareTo(n)>=0?e:n},Mi.serialVersionUID.get=function(){return 0x6bee6404e9a25c00},Mi.maximumPreciseValue.get=function(){return 9007199254740992},Object.defineProperties(bn,Mi);var Di=function e(n){this._name=n||null,e.nameToTypeMap.put(n,this)},zo={serialVersionUID:{configurable:!0},nameToTypeMap:{configurable:!0}};Di.prototype.readResolve=function(){return Di.nameToTypeMap.get(this._name)},Di.prototype.toString=function(){return this._name},Di.prototype.interfaces_=function(){return[yt]},Di.prototype.getClass=function(){return Di},zo.serialVersionUID.get=function(){return-552860263173159e4},zo.nameToTypeMap.get=function(){return new Is},Object.defineProperties(Di,zo),bn.Type=Di,bn.FIXED=new Di("FIXED"),bn.FLOATING=new Di("FLOATING"),bn.FLOATING_SINGLE=new Di("FLOATING SINGLE");var nn=function e(){this._precisionModel=new bn,this._SRID=0,this._coordinateSequenceFactory=e.getDefaultCoordinateSequenceFactory(),0===arguments.length||(1===arguments.length?Te(arguments[0],Mt)?this._coordinateSequenceFactory=arguments[0]:arguments[0]instanceof bn&&(this._precisionModel=arguments[0]):2===arguments.length?(this._precisionModel=arguments[0],this._SRID=arguments[1]):3===arguments.length&&(this._precisionModel=arguments[0],this._SRID=arguments[1],this._coordinateSequenceFactory=arguments[2]))},Ps={serialVersionUID:{configurable:!0}};nn.prototype.toGeometry=function(e){return e.isNull()?this.createPoint(null):e.getMinX()===e.getMaxX()&&e.getMinY()===e.getMaxY()?this.createPoint(new j(e.getMinX(),e.getMinY())):e.getMinX()===e.getMaxX()||e.getMinY()===e.getMaxY()?this.createLineString([new j(e.getMinX(),e.getMinY()),new j(e.getMaxX(),e.getMaxY())]):this.createPolygon(this.createLinearRing([new j(e.getMinX(),e.getMinY()),new j(e.getMinX(),e.getMaxY()),new j(e.getMaxX(),e.getMaxY()),new j(e.getMaxX(),e.getMinY()),new j(e.getMinX(),e.getMinY())]),null)},nn.prototype.createLineString=function(e){return e?e instanceof Array?new zr(this.getCoordinateSequenceFactory().create(e),this):Te(e,Oe)?new zr(e,this):void 0:new zr(this.getCoordinateSequenceFactory().create([]),this)},nn.prototype.createMultiLineString=function(){return 0===arguments.length?new sr(null,this):1===arguments.length?new sr(arguments[0],this):void 0},nn.prototype.buildGeometry=function(e){for(var n=null,c=!1,f=!1,x=e.iterator();x.hasNext();){var L=x.next(),z=L.getClass();null===n&&(n=z),z!==n&&(c=!0),L.isGeometryCollectionOrDerived()&&(f=!0)}if(null===n)return this.createGeometryCollection();if(c||f)return this.createGeometryCollection(nn.toGeometryArray(e));var W=e.iterator().next();if(e.size()>1){if(W instanceof ln)return this.createMultiPolygon(nn.toPolygonArray(e));if(W instanceof zr)return this.createMultiLineString(nn.toLineStringArray(e));if(W instanceof Tn)return this.createMultiPoint(nn.toPointArray(e));tt.shouldNeverReachHere("Unhandled class: "+W.getClass().getName())}return W},nn.prototype.createMultiPointFromCoords=function(e){return this.createMultiPoint(null!==e?this.getCoordinateSequenceFactory().create(e):null)},nn.prototype.createPoint=function(){if(0===arguments.length)return this.createPoint(this.getCoordinateSequenceFactory().create([]));if(1===arguments.length){if(arguments[0]instanceof j){var e=arguments[0];return this.createPoint(null!==e?this.getCoordinateSequenceFactory().create([e]):null)}if(Te(arguments[0],Oe))return new Tn(arguments[0],this)}},nn.prototype.getCoordinateSequenceFactory=function(){return this._coordinateSequenceFactory},nn.prototype.createPolygon=function(){if(0===arguments.length)return new ln(null,null,this);if(1===arguments.length){if(Te(arguments[0],Oe))return this.createPolygon(this.createLinearRing(arguments[0]));if(arguments[0]instanceof Array)return this.createPolygon(this.createLinearRing(arguments[0]));if(arguments[0]instanceof zn)return this.createPolygon(arguments[0],null)}else if(2===arguments.length)return new ln(arguments[0],arguments[1],this)},nn.prototype.getSRID=function(){return this._SRID},nn.prototype.createGeometryCollection=function(){return 0===arguments.length?new De(null,this):1===arguments.length?new De(arguments[0],this):void 0},nn.prototype.createGeometry=function(e){return new ko(this).edit(e,{edit:function(){if(2===arguments.length)return this._coordinateSequenceFactory.create(arguments[0])}})},nn.prototype.getPrecisionModel=function(){return this._precisionModel},nn.prototype.createLinearRing=function(){if(0===arguments.length)return this.createLinearRing(this.getCoordinateSequenceFactory().create([]));if(1===arguments.length){if(arguments[0]instanceof Array){var e=arguments[0];return this.createLinearRing(null!==e?this.getCoordinateSequenceFactory().create(e):null)}if(Te(arguments[0],Oe))return new zn(arguments[0],this)}},nn.prototype.createMultiPolygon=function(){return 0===arguments.length?new un(null,this):1===arguments.length?new un(arguments[0],this):void 0},nn.prototype.createMultiPoint=function(){if(0===arguments.length)return new xi(null,this);if(1===arguments.length){if(arguments[0]instanceof Array)return new xi(arguments[0],this);if(arguments[0]instanceof Array){var n=arguments[0];return this.createMultiPoint(null!==n?this.getCoordinateSequenceFactory().create(n):null)}if(Te(arguments[0],Oe)){var c=arguments[0];if(null===c)return this.createMultiPoint(new Array(0).fill(null));for(var f=new Array(c.size()).fill(null),x=0;x<c.size();x++){var L=this.getCoordinateSequenceFactory().create(1,c.getDimension());wr.copy(c,x,L,0,1),f[x]=this.createPoint(L)}return this.createMultiPoint(f)}}},nn.prototype.interfaces_=function(){return[yt]},nn.prototype.getClass=function(){return nn},nn.toMultiPolygonArray=function(e){var n=new Array(e.size()).fill(null);return e.toArray(n)},nn.toGeometryArray=function(e){if(null===e)return null;var n=new Array(e.size()).fill(null);return e.toArray(n)},nn.getDefaultCoordinateSequenceFactory=function(){return pa.instance()},nn.toMultiLineStringArray=function(e){var n=new Array(e.size()).fill(null);return e.toArray(n)},nn.toLineStringArray=function(e){var n=new Array(e.size()).fill(null);return e.toArray(n)},nn.toMultiPointArray=function(e){var n=new Array(e.size()).fill(null);return e.toArray(n)},nn.toLinearRingArray=function(e){var n=new Array(e.size()).fill(null);return e.toArray(n)},nn.toPointArray=function(e){var n=new Array(e.size()).fill(null);return e.toArray(n)},nn.toPolygonArray=function(e){var n=new Array(e.size()).fill(null);return e.toArray(n)},nn.createPointFromInternalCoord=function(e,n){return n.getPrecisionModel().makePrecise(e),n.getFactory().createPoint(e)},Ps.serialVersionUID.get=function(){return-0x5ea75f2051eeb400},Object.defineProperties(nn,Ps);var Kc=["Point","MultiPoint","LineString","MultiLineString","Polygon","MultiPolygon"],jo=function(e){this.geometryFactory=e||new nn};jo.prototype.read=function(e){var n,c=(n="string"==typeof e?JSON.parse(e):e).type;if(!Za[c])throw new Error("Unknown GeoJSON type: "+n.type);return-1!==Kc.indexOf(c)?Za[c].apply(this,[n.coordinates]):Za[c].apply(this,"GeometryCollection"===c?[n.geometries]:[n])},jo.prototype.write=function(e){var n=e.getGeometryType();if(!ra[n])throw new Error("Geometry is not supported");return ra[n].apply(this,[e])};var Za={Feature:function(e){var n={};for(var c in e)n[c]=e[c];if(e.geometry){if(!Za[e.geometry.type])throw new Error("Unknown GeoJSON type: "+e.type);n.geometry=this.read(e.geometry)}return e.bbox&&(n.bbox=Za.bbox.apply(this,[e.bbox])),n},FeatureCollection:function(e){var n={};if(e.features){n.features=[];for(var c=0;c<e.features.length;++c)n.features.push(this.read(e.features[c]))}return e.bbox&&(n.bbox=this.parse.bbox.apply(this,[e.bbox])),n},coordinates:function(e){for(var n=[],c=0;c<e.length;++c){var f=e[c];n.push(new j(f[0],f[1]))}return n},bbox:function(e){return this.geometryFactory.createLinearRing([new j(e[0],e[1]),new j(e[2],e[1]),new j(e[2],e[3]),new j(e[0],e[3]),new j(e[0],e[1])])},Point:function(e){var n=new j(e[0],e[1]);return this.geometryFactory.createPoint(n)},MultiPoint:function(e){for(var n=[],c=0;c<e.length;++c)n.push(Za.Point.apply(this,[e[c]]));return this.geometryFactory.createMultiPoint(n)},LineString:function(e){var n=Za.coordinates.apply(this,[e]);return this.geometryFactory.createLineString(n)},MultiLineString:function(e){for(var n=[],c=0;c<e.length;++c)n.push(Za.LineString.apply(this,[e[c]]));return this.geometryFactory.createMultiLineString(n)},Polygon:function(e){for(var n=Za.coordinates.apply(this,[e[0]]),c=this.geometryFactory.createLinearRing(n),f=[],x=1;x<e.length;++x){var z=Za.coordinates.apply(this,[e[x]]),W=this.geometryFactory.createLinearRing(z);f.push(W)}return this.geometryFactory.createPolygon(c,f)},MultiPolygon:function(e){for(var n=[],c=0;c<e.length;++c)n.push(Za.Polygon.apply(this,[e[c]]));return this.geometryFactory.createMultiPolygon(n)},GeometryCollection:function(e){for(var n=[],c=0;c<e.length;++c)n.push(this.read(e[c]));return this.geometryFactory.createGeometryCollection(n)}},ra={coordinate:function(e){return[e.x,e.y]},Point:function(e){return{type:"Point",coordinates:ra.coordinate.apply(this,[e.getCoordinate()])}},MultiPoint:function(e){for(var n=[],c=0;c<e._geometries.length;++c){var x=ra.Point.apply(this,[e._geometries[c]]);n.push(x.coordinates)}return{type:"MultiPoint",coordinates:n}},LineString:function(e){for(var n=[],c=e.getCoordinates(),f=0;f<c.length;++f)n.push(ra.coordinate.apply(this,[c[f]]));return{type:"LineString",coordinates:n}},MultiLineString:function(e){for(var n=[],c=0;c<e._geometries.length;++c){var x=ra.LineString.apply(this,[e._geometries[c]]);n.push(x.coordinates)}return{type:"MultiLineString",coordinates:n}},Polygon:function(e){var n=[],c=ra.LineString.apply(this,[e._shell]);n.push(c.coordinates);for(var f=0;f<e._holes.length;++f){var L=ra.LineString.apply(this,[e._holes[f]]);n.push(L.coordinates)}return{type:"Polygon",coordinates:n}},MultiPolygon:function(e){for(var n=[],c=0;c<e._geometries.length;++c){var x=ra.Polygon.apply(this,[e._geometries[c]]);n.push(x.coordinates)}return{type:"MultiPolygon",coordinates:n}},GeometryCollection:function(e){for(var n=[],c=0;c<e._geometries.length;++c){var f=e._geometries[c],x=f.getGeometryType();n.push(ra[x].apply(this,[f]))}return{type:"GeometryCollection",geometries:n}}},Mo=function(e){this.geometryFactory=e||new nn,this.precisionModel=this.geometryFactory.getPrecisionModel(),this.parser=new jo(this.geometryFactory)};Mo.prototype.read=function(e){var n=this.parser.read(e);return this.precisionModel.getType()===bn.FIXED&&this.reducePrecision(n),n},Mo.prototype.reducePrecision=function(e){var n,c;if(e.coordinate)this.precisionModel.makePrecise(e.coordinate);else if(e.points)for(n=0,c=e.points.length;n<c;n++)this.precisionModel.makePrecise(e.points[n]);else if(e.geometries)for(n=0,c=e.geometries.length;n<c;n++)this.reducePrecision(e.geometries[n])};var yo=function(){this.parser=new jo(this.geometryFactory)};yo.prototype.write=function(e){return this.parser.write(e)};var $e=function(){},Zs={ON:{configurable:!0},LEFT:{configurable:!0},RIGHT:{configurable:!0}};$e.prototype.interfaces_=function(){return[]},$e.prototype.getClass=function(){return $e},$e.opposite=function(e){return e===$e.LEFT?$e.RIGHT:e===$e.RIGHT?$e.LEFT:e},Zs.ON.get=function(){return 0},Zs.LEFT.get=function(){return 1},Zs.RIGHT.get=function(){return 2},Object.defineProperties($e,Zs),(kt.prototype=new Error).name="EmptyStackException",(ie.prototype=new Oi).add=function(e){return this.array_.push(e),!0},ie.prototype.get=function(e){if(e<0||e>=this.size())throw new Error;return this.array_[e]},ie.prototype.push=function(e){return this.array_.push(e),e},ie.prototype.pop=function(e){if(0===this.array_.length)throw new kt;return this.array_.pop()},ie.prototype.peek=function(){if(0===this.array_.length)throw new kt;return this.array_[this.array_.length-1]},ie.prototype.empty=function(){return 0===this.array_.length},ie.prototype.isEmpty=function(){return this.empty()},ie.prototype.search=function(e){return this.array_.indexOf(e)},ie.prototype.size=function(){return this.array_.length},ie.prototype.toArray=function(){for(var e=[],n=0,c=this.array_.length;n<c;n++)e.push(this.array_[n]);return e};var Sa=function(){this._minIndex=-1,this._minCoord=null,this._minDe=null,this._orientedDe=null};Sa.prototype.getCoordinate=function(){return this._minCoord},Sa.prototype.getRightmostSide=function(e,n){var c=this.getRightmostSideOfSegment(e,n);return c<0&&(c=this.getRightmostSideOfSegment(e,n-1)),c<0&&(this._minCoord=null,this.checkForRightmostCoordinate(e)),c},Sa.prototype.findRightmostEdgeAtVertex=function(){var e=this._minDe.getEdge().getCoordinates();tt.isTrue(this._minIndex>0&&this._minIndex<e.length,"rightmost point expected to be interior vertex of edge");var n=e[this._minIndex-1],c=e[this._minIndex+1],f=Re.computeOrientation(this._minCoord,c,n),x=!1;(n.y<this._minCoord.y&&c.y<this._minCoord.y&&f===Re.COUNTERCLOCKWISE||n.y>this._minCoord.y&&c.y>this._minCoord.y&&f===Re.CLOCKWISE)&&(x=!0),x&&(this._minIndex=this._minIndex-1)},Sa.prototype.getRightmostSideOfSegment=function(e,n){var c=e.getEdge().getCoordinates();if(n<0||n+1>=c.length||c[n].y===c[n+1].y)return-1;var f=$e.LEFT;return c[n].y<c[n+1].y&&(f=$e.RIGHT),f},Sa.prototype.getEdge=function(){return this._orientedDe},Sa.prototype.checkForRightmostCoordinate=function(e){for(var n=e.getEdge().getCoordinates(),c=0;c<n.length-1;c++)(null===this._minCoord||n[c].x>this._minCoord.x)&&(this._minDe=e,this._minIndex=c,this._minCoord=n[c])},Sa.prototype.findRightmostEdgeAtNode=function(){var e=this._minDe.getNode().getEdges();this._minDe=e.getRightmostEdge(),this._minDe.isForward()||(this._minDe=this._minDe.getSym(),this._minIndex=this._minDe.getEdge().getCoordinates().length-1)},Sa.prototype.findEdge=function(e){for(var n=e.iterator();n.hasNext();){var c=n.next();c.isForward()&&this.checkForRightmostCoordinate(c)}tt.isTrue(0!==this._minIndex||this._minCoord.equals(this._minDe.getCoordinate()),"inconsistency in rightmost processing"),0===this._minIndex?this.findRightmostEdgeAtNode():this.findRightmostEdgeAtVertex(),this._orientedDe=this._minDe,this.getRightmostSide(this._minDe,this._minIndex)===$e.LEFT&&(this._orientedDe=this._minDe.getSym())},Sa.prototype.interfaces_=function(){return[]},Sa.prototype.getClass=function(){return Sa};var Fs=function(e){function n(c,f){e.call(this,n.msgWithCoord(c,f)),this.pt=f?new j(f):null,this.name="TopologyException"}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype.getCoordinate=function(){return this.pt},n.prototype.interfaces_=function(){return[]},n.prototype.getClass=function(){return n},n.msgWithCoord=function(c,f){return f?c:c+" [ "+f+" ]"},n}(ot),Ru=function(){this.array_=[]};Ru.prototype.addLast=function(e){this.array_.push(e)},Ru.prototype.removeFirst=function(){return this.array_.shift()},Ru.prototype.isEmpty=function(){return 0===this.array_.length};var na=function(){this._finder=null,this._dirEdgeList=new Je,this._nodes=new Je,this._rightMostCoord=null,this._env=null,this._finder=new Sa};na.prototype.clearVisitedEdges=function(){for(var e=this._dirEdgeList.iterator();e.hasNext();)e.next().setVisited(!1)},na.prototype.getRightmostCoordinate=function(){return this._rightMostCoord},na.prototype.computeNodeDepth=function(e){for(var n=null,c=e.getEdges().iterator();c.hasNext();){var f=c.next();if(f.isVisited()||f.getSym().isVisited()){n=f;break}}if(null===n)throw new Fs("unable to find edge to compute depths at "+e.getCoordinate());e.getEdges().computeDepths(n);for(var x=e.getEdges().iterator();x.hasNext();){var L=x.next();L.setVisited(!0),this.copySymDepths(L)}},na.prototype.computeDepth=function(e){this.clearVisitedEdges();var n=this._finder.getEdge();n.setEdgeDepths($e.RIGHT,e),this.copySymDepths(n),this.computeDepths(n)},na.prototype.create=function(e){this.addReachable(e),this._finder.findEdge(this._dirEdgeList),this._rightMostCoord=this._finder.getCoordinate()},na.prototype.findResultEdges=function(){for(var e=this._dirEdgeList.iterator();e.hasNext();){var n=e.next();n.getDepth($e.RIGHT)>=1&&n.getDepth($e.LEFT)<=0&&!n.isInteriorAreaEdge()&&n.setInResult(!0)}},na.prototype.computeDepths=function(e){var n=new Yt,c=new Ru,f=e.getNode();for(c.addLast(f),n.add(f),e.setVisited(!0);!c.isEmpty();){var x=c.removeFirst();n.add(x),this.computeNodeDepth(x);for(var L=x.getEdges().iterator();L.hasNext();){var z=L.next().getSym();if(!z.isVisited()){var W=z.getNode();n.contains(W)||(c.addLast(W),n.add(W))}}}},na.prototype.compareTo=function(e){return this._rightMostCoord.x<e._rightMostCoord.x?-1:this._rightMostCoord.x>e._rightMostCoord.x?1:0},na.prototype.getEnvelope=function(){if(null===this._env){for(var e=new ke,n=this._dirEdgeList.iterator();n.hasNext();)for(var c=n.next().getEdge().getCoordinates(),f=0;f<c.length-1;f++)e.expandToInclude(c[f]);this._env=e}return this._env},na.prototype.addReachable=function(e){var n=new ie;for(n.add(e);!n.empty();){var c=n.pop();this.add(c,n)}},na.prototype.copySymDepths=function(e){var n=e.getSym();n.setDepth($e.LEFT,e.getDepth($e.RIGHT)),n.setDepth($e.RIGHT,e.getDepth($e.LEFT))},na.prototype.add=function(e,n){e.setVisited(!0),this._nodes.add(e);for(var c=e.getEdges().iterator();c.hasNext();){var f=c.next();this._dirEdgeList.add(f);var x=f.getSym().getNode();x.isVisited()||n.push(x)}},na.prototype.getNodes=function(){return this._nodes},na.prototype.getDirectedEdges=function(){return this._dirEdgeList},na.prototype.interfaces_=function(){return[Q]},na.prototype.getClass=function(){return na};var ci=function e(){if(this.location=null,1===arguments.length){if(arguments[0]instanceof Array)this.init(arguments[0].length);else if(Number.isInteger(arguments[0])){var c=arguments[0];this.init(1),this.location[$e.ON]=c}else if(arguments[0]instanceof e){var f=arguments[0];if(this.init(f.location.length),null!==f)for(var x=0;x<this.location.length;x++)this.location[x]=f.location[x]}}else if(3===arguments.length){var L=arguments[0],z=arguments[1],W=arguments[2];this.init(3),this.location[$e.ON]=L,this.location[$e.LEFT]=z,this.location[$e.RIGHT]=W}};ci.prototype.setAllLocations=function(e){for(var n=0;n<this.location.length;n++)this.location[n]=e},ci.prototype.isNull=function(){for(var e=0;e<this.location.length;e++)if(this.location[e]!==ct.NONE)return!1;return!0},ci.prototype.setAllLocationsIfNull=function(e){for(var n=0;n<this.location.length;n++)this.location[n]===ct.NONE&&(this.location[n]=e)},ci.prototype.isLine=function(){return 1===this.location.length},ci.prototype.merge=function(e){if(e.location.length>this.location.length){var n=new Array(3).fill(null);n[$e.ON]=this.location[$e.ON],n[$e.LEFT]=ct.NONE,n[$e.RIGHT]=ct.NONE,this.location=n}for(var c=0;c<this.location.length;c++)this.location[c]===ct.NONE&&c<e.location.length&&(this.location[c]=e.location[c])},ci.prototype.getLocations=function(){return this.location},ci.prototype.flip=function(){if(this.location.length<=1)return null;var e=this.location[$e.LEFT];this.location[$e.LEFT]=this.location[$e.RIGHT],this.location[$e.RIGHT]=e},ci.prototype.toString=function(){var e=new Tt;return this.location.length>1&&e.append(ct.toLocationSymbol(this.location[$e.LEFT])),e.append(ct.toLocationSymbol(this.location[$e.ON])),this.location.length>1&&e.append(ct.toLocationSymbol(this.location[$e.RIGHT])),e.toString()},ci.prototype.setLocations=function(e,n,c){this.location[$e.ON]=e,this.location[$e.LEFT]=n,this.location[$e.RIGHT]=c},ci.prototype.get=function(e){return e<this.location.length?this.location[e]:ct.NONE},ci.prototype.isArea=function(){return this.location.length>1},ci.prototype.isAnyNull=function(){for(var e=0;e<this.location.length;e++)if(this.location[e]===ct.NONE)return!0;return!1},ci.prototype.setLocation=function(){1===arguments.length?this.setLocation($e.ON,arguments[0]):2===arguments.length&&(this.location[arguments[0]]=arguments[1])},ci.prototype.init=function(e){this.location=new Array(e).fill(null),this.setAllLocations(ct.NONE)},ci.prototype.isEqualOnSide=function(e,n){return this.location[n]===e.location[n]},ci.prototype.allPositionsEqual=function(e){for(var n=0;n<this.location.length;n++)if(this.location[n]!==e)return!1;return!0},ci.prototype.interfaces_=function(){return[]},ci.prototype.getClass=function(){return ci};var Yn=function e(){if(this.elt=new Array(2).fill(null),1===arguments.length){if(Number.isInteger(arguments[0])){var n=arguments[0];this.elt[0]=new ci(n),this.elt[1]=new ci(n)}else if(arguments[0]instanceof e){var c=arguments[0];this.elt[0]=new ci(c.elt[0]),this.elt[1]=new ci(c.elt[1])}}else if(2===arguments.length){var f=arguments[0],x=arguments[1];this.elt[0]=new ci(ct.NONE),this.elt[1]=new ci(ct.NONE),this.elt[f].setLocation(x)}else if(3===arguments.length){var L=arguments[0],z=arguments[1],W=arguments[2];this.elt[0]=new ci(L,z,W),this.elt[1]=new ci(L,z,W)}else if(4===arguments.length){var gt=arguments[0],Zt=arguments[1],Ie=arguments[2],Me=arguments[3];this.elt[0]=new ci(ct.NONE,ct.NONE,ct.NONE),this.elt[1]=new ci(ct.NONE,ct.NONE,ct.NONE),this.elt[gt].setLocations(Zt,Ie,Me)}};Yn.prototype.getGeometryCount=function(){var e=0;return this.elt[0].isNull()||e++,this.elt[1].isNull()||e++,e},Yn.prototype.setAllLocations=function(e,n){this.elt[e].setAllLocations(n)},Yn.prototype.isNull=function(e){return this.elt[e].isNull()},Yn.prototype.setAllLocationsIfNull=function(){if(1===arguments.length){var e=arguments[0];this.setAllLocationsIfNull(0,e),this.setAllLocationsIfNull(1,e)}else 2===arguments.length&&this.elt[arguments[0]].setAllLocationsIfNull(arguments[1])},Yn.prototype.isLine=function(e){return this.elt[e].isLine()},Yn.prototype.merge=function(e){for(var n=0;n<2;n++)null===this.elt[n]&&null!==e.elt[n]?this.elt[n]=new ci(e.elt[n]):this.elt[n].merge(e.elt[n])},Yn.prototype.flip=function(){this.elt[0].flip(),this.elt[1].flip()},Yn.prototype.getLocation=function(){return 1===arguments.length?this.elt[arguments[0]].get($e.ON):2===arguments.length?this.elt[arguments[0]].get(arguments[1]):void 0},Yn.prototype.toString=function(){var e=new Tt;return null!==this.elt[0]&&(e.append("A:"),e.append(this.elt[0].toString())),null!==this.elt[1]&&(e.append(" B:"),e.append(this.elt[1].toString())),e.toString()},Yn.prototype.isArea=function(){return 0===arguments.length?this.elt[0].isArea()||this.elt[1].isArea():1===arguments.length?this.elt[arguments[0]].isArea():void 0},Yn.prototype.isAnyNull=function(e){return this.elt[e].isAnyNull()},Yn.prototype.setLocation=function(){2===arguments.length?this.elt[arguments[0]].setLocation($e.ON,arguments[1]):3===arguments.length&&this.elt[arguments[0]].setLocation(arguments[1],arguments[2])},Yn.prototype.isEqualOnSide=function(e,n){return this.elt[0].isEqualOnSide(e.elt[0],n)&&this.elt[1].isEqualOnSide(e.elt[1],n)},Yn.prototype.allPositionsEqual=function(e,n){return this.elt[e].allPositionsEqual(n)},Yn.prototype.toLine=function(e){this.elt[e].isArea()&&(this.elt[e]=new ci(this.elt[e].location[0]))},Yn.prototype.interfaces_=function(){return[]},Yn.prototype.getClass=function(){return Yn},Yn.toLineLabel=function(e){for(var n=new Yn(ct.NONE),c=0;c<2;c++)n.setLocation(c,e.getLocation(c));return n};var Yi=function(){this._startDe=null,this._maxNodeDegree=-1,this._edges=new Je,this._pts=new Je,this._label=new Yn(ct.NONE),this._ring=null,this._isHole=null,this._shell=null,this._holes=new Je,this._geometryFactory=null;var e=arguments[0];this._geometryFactory=arguments[1],this.computePoints(e),this.computeRing()};Yi.prototype.computeRing=function(){if(null!==this._ring)return null;for(var e=new Array(this._pts.size()).fill(null),n=0;n<this._pts.size();n++)e[n]=this._pts.get(n);this._ring=this._geometryFactory.createLinearRing(e),this._isHole=Re.isCCW(this._ring.getCoordinates())},Yi.prototype.isIsolated=function(){return 1===this._label.getGeometryCount()},Yi.prototype.computePoints=function(e){this._startDe=e;var n=e,c=!0;do{if(null===n)throw new Fs("Found null DirectedEdge");if(n.getEdgeRing()===this)throw new Fs("Directed Edge visited twice during ring-building at "+n.getCoordinate());this._edges.add(n);var f=n.getLabel();tt.isTrue(f.isArea()),this.mergeLabel(f),this.addPoints(n.getEdge(),n.isForward(),c),c=!1,this.setEdgeRing(n,this),n=this.getNext(n)}while(n!==this._startDe)},Yi.prototype.getLinearRing=function(){return this._ring},Yi.prototype.getCoordinate=function(e){return this._pts.get(e)},Yi.prototype.computeMaxNodeDegree=function(){this._maxNodeDegree=0;var e=this._startDe;do{var n=e.getNode().getEdges().getOutgoingDegree(this);n>this._maxNodeDegree&&(this._maxNodeDegree=n),e=this.getNext(e)}while(e!==this._startDe);this._maxNodeDegree*=2},Yi.prototype.addPoints=function(e,n,c){var f=e.getCoordinates();if(n){var x=1;c&&(x=0);for(var L=x;L<f.length;L++)this._pts.add(f[L])}else{var z=f.length-2;c&&(z=f.length-1);for(var W=z;W>=0;W--)this._pts.add(f[W])}},Yi.prototype.isHole=function(){return this._isHole},Yi.prototype.setInResult=function(){var e=this._startDe;do{e.getEdge().setInResult(!0),e=e.getNext()}while(e!==this._startDe)},Yi.prototype.containsPoint=function(e){var n=this.getLinearRing();if(!n.getEnvelopeInternal().contains(e)||!Re.isPointInRing(e,n.getCoordinates()))return!1;for(var c=this._holes.iterator();c.hasNext();)if(c.next().containsPoint(e))return!1;return!0},Yi.prototype.addHole=function(e){this._holes.add(e)},Yi.prototype.isShell=function(){return null===this._shell},Yi.prototype.getLabel=function(){return this._label},Yi.prototype.getEdges=function(){return this._edges},Yi.prototype.getMaxNodeDegree=function(){return this._maxNodeDegree<0&&this.computeMaxNodeDegree(),this._maxNodeDegree},Yi.prototype.getShell=function(){return this._shell},Yi.prototype.mergeLabel=function(){if(1===arguments.length){var e=arguments[0];this.mergeLabel(e,0),this.mergeLabel(e,1)}else if(2===arguments.length){var c=arguments[1],f=arguments[0].getLocation(c,$e.RIGHT);if(f===ct.NONE)return null;if(this._label.getLocation(c)===ct.NONE)return this._label.setLocation(c,f),null}},Yi.prototype.setShell=function(e){this._shell=e,null!==e&&e.addHole(this)},Yi.prototype.toPolygon=function(e){for(var n=new Array(this._holes.size()).fill(null),c=0;c<this._holes.size();c++)n[c]=this._holes.get(c).getLinearRing();return e.createPolygon(this.getLinearRing(),n)},Yi.prototype.interfaces_=function(){return[]},Yi.prototype.getClass=function(){return Yi};var yl=function(e){function n(){e.call(this,arguments[0],arguments[1])}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype.setEdgeRing=function(c,f){c.setMinEdgeRing(f)},n.prototype.getNext=function(c){return c.getNextMin()},n.prototype.interfaces_=function(){return[]},n.prototype.getClass=function(){return n},n}(Yi),vl=function(e){function n(){e.call(this,arguments[0],arguments[1])}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype.buildMinimalRings=function(){var c=new Je,f=this._startDe;do{if(null===f.getMinEdgeRing()){var x=new yl(f,this._geometryFactory);c.add(x)}f=f.getNext()}while(f!==this._startDe);return c},n.prototype.setEdgeRing=function(c,f){c.setEdgeRing(f)},n.prototype.linkDirectedEdgesForMinimalEdgeRings=function(){var c=this._startDe;do{c.getNode().getEdges().linkMinimalDirectedEdges(this),c=c.getNext()}while(c!==this._startDe)},n.prototype.getNext=function(c){return c.getNext()},n.prototype.interfaces_=function(){return[]},n.prototype.getClass=function(){return n},n}(Yi),Xo=function(){this._label=null,this._isInResult=!1,this._isCovered=!1,this._isCoveredSet=!1,this._isVisited=!1,0!==arguments.length&&1===arguments.length&&(this._label=arguments[0])};Xo.prototype.setVisited=function(e){this._isVisited=e},Xo.prototype.setInResult=function(e){this._isInResult=e},Xo.prototype.isCovered=function(){return this._isCovered},Xo.prototype.isCoveredSet=function(){return this._isCoveredSet},Xo.prototype.setLabel=function(e){this._label=e},Xo.prototype.getLabel=function(){return this._label},Xo.prototype.setCovered=function(e){this._isCovered=e,this._isCoveredSet=!0},Xo.prototype.updateIM=function(e){tt.isTrue(this._label.getGeometryCount()>=2,"found partial label"),this.computeIM(e)},Xo.prototype.isInResult=function(){return this._isInResult},Xo.prototype.isVisited=function(){return this._isVisited},Xo.prototype.interfaces_=function(){return[]},Xo.prototype.getClass=function(){return Xo};var Nu=function(e){function n(){e.call(this),this._coord=null,this._edges=null;var f=arguments[1];this._coord=arguments[0],this._edges=f,this._label=new Yn(0,ct.NONE)}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype.isIncidentEdgeInResult=function(){for(var c=this.getEdges().getEdges().iterator();c.hasNext();)if(c.next().getEdge().isInResult())return!0;return!1},n.prototype.isIsolated=function(){return 1===this._label.getGeometryCount()},n.prototype.getCoordinate=function(){return this._coord},n.prototype.print=function(c){c.println("node "+this._coord+" lbl: "+this._label)},n.prototype.computeIM=function(c){},n.prototype.computeMergedLocation=function(c,f){var x=ct.NONE;if(x=this._label.getLocation(f),!c.isNull(f)){var L=c.getLocation(f);x!==ct.BOUNDARY&&(x=L)}return x},n.prototype.setLabel=function(){if(2!==arguments.length)return e.prototype.setLabel.apply(this,arguments);var c=arguments[0],f=arguments[1];null===this._label?this._label=new Yn(c,f):this._label.setLocation(c,f)},n.prototype.getEdges=function(){return this._edges},n.prototype.mergeLabel=function(){if(arguments[0]instanceof n)this.mergeLabel(arguments[0]._label);else if(arguments[0]instanceof Yn)for(var f=arguments[0],x=0;x<2;x++){var L=this.computeMergedLocation(f,x);this._label.getLocation(x)===ct.NONE&&this._label.setLocation(x,L)}},n.prototype.add=function(c){this._edges.insert(c),c.setNode(this)},n.prototype.setLabelBoundary=function(c){if(null===this._label)return null;var f=ct.NONE;null!==this._label&&(f=this._label.getLocation(c));var x=null;switch(f){case ct.BOUNDARY:x=ct.INTERIOR;break;case ct.INTERIOR:default:x=ct.BOUNDARY}this._label.setLocation(c,x)},n.prototype.interfaces_=function(){return[]},n.prototype.getClass=function(){return n},n}(Xo),Ca=function(){this.nodeMap=new ve,this.nodeFact=null,this.nodeFact=arguments[0]};Ca.prototype.find=function(e){return this.nodeMap.get(e)},Ca.prototype.addNode=function(){if(arguments[0]instanceof j){var e=arguments[0],n=this.nodeMap.get(e);return null===n&&(n=this.nodeFact.createNode(e),this.nodeMap.put(e,n)),n}if(arguments[0]instanceof Nu){var c=arguments[0],f=this.nodeMap.get(c.getCoordinate());return null===f?(this.nodeMap.put(c.getCoordinate(),c),c):(f.mergeLabel(c),f)}},Ca.prototype.print=function(e){for(var n=this.iterator();n.hasNext();)n.next().print(e)},Ca.prototype.iterator=function(){return this.nodeMap.values().iterator()},Ca.prototype.values=function(){return this.nodeMap.values()},Ca.prototype.getBoundaryNodes=function(e){for(var n=new Je,c=this.iterator();c.hasNext();){var f=c.next();f.getLabel().getLocation(e)===ct.BOUNDARY&&n.add(f)}return n},Ca.prototype.add=function(e){var n=e.getCoordinate();this.addNode(n).add(e)},Ca.prototype.interfaces_=function(){return[]},Ca.prototype.getClass=function(){return Ca};var ni=function(){},Yo={NE:{configurable:!0},NW:{configurable:!0},SW:{configurable:!0},SE:{configurable:!0}};ni.prototype.interfaces_=function(){return[]},ni.prototype.getClass=function(){return ni},ni.isNorthern=function(e){return e===ni.NE||e===ni.NW},ni.isOpposite=function(e,n){return e!==n&&(e-n+4)%4==2},ni.commonHalfPlane=function(e,n){if(e===n)return e;if((e-n+4)%4==2)return-1;var c=e<n?e:n;return 0===c&&3===(e>n?e:n)?3:c},ni.isInHalfPlane=function(e,n){return n===ni.SE?e===ni.SE||e===ni.SW:e===n||e===n+1},ni.quadrant=function(){if("number"==typeof arguments[0]&&"number"==typeof arguments[1]){var e=arguments[0],n=arguments[1];if(0===e&&0===n)throw new J("Cannot compute the quadrant for point ( "+e+", "+n+" )");return e>=0?n>=0?ni.NE:ni.SE:n>=0?ni.NW:ni.SW}if(arguments[0]instanceof j&&arguments[1]instanceof j){var c=arguments[0],f=arguments[1];if(f.x===c.x&&f.y===c.y)throw new J("Cannot compute the quadrant for two identical points "+c);return f.x>=c.x?f.y>=c.y?ni.NE:ni.SE:f.y>=c.y?ni.NW:ni.SW}},Yo.NE.get=function(){return 0},Yo.NW.get=function(){return 1},Yo.SW.get=function(){return 2},Yo.SE.get=function(){return 3},Object.defineProperties(ni,Yo);var Wi=function(){if(this._edge=null,this._label=null,this._node=null,this._p0=null,this._p1=null,this._dx=null,this._dy=null,this._quadrant=null,1===arguments.length)this._edge=arguments[0];else if(3===arguments.length){var c=arguments[1],f=arguments[2];this._edge=arguments[0],this.init(c,f),this._label=null}else if(4===arguments.length){var L=arguments[1],z=arguments[2],W=arguments[3];this._edge=arguments[0],this.init(L,z),this._label=W}};Wi.prototype.compareDirection=function(e){return this._dx===e._dx&&this._dy===e._dy?0:this._quadrant>e._quadrant?1:this._quadrant<e._quadrant?-1:Re.computeOrientation(e._p0,e._p1,this._p1)},Wi.prototype.getDy=function(){return this._dy},Wi.prototype.getCoordinate=function(){return this._p0},Wi.prototype.setNode=function(e){this._node=e},Wi.prototype.print=function(e){var n=Math.atan2(this._dy,this._dx),c=this.getClass().getName(),f=c.lastIndexOf("."),x=c.substring(f+1);e.print("  "+x+": "+this._p0+" - "+this._p1+" "+this._quadrant+":"+n+"   "+this._label)},Wi.prototype.compareTo=function(e){return this.compareDirection(e)},Wi.prototype.getDirectedCoordinate=function(){return this._p1},Wi.prototype.getDx=function(){return this._dx},Wi.prototype.getLabel=function(){return this._label},Wi.prototype.getEdge=function(){return this._edge},Wi.prototype.getQuadrant=function(){return this._quadrant},Wi.prototype.getNode=function(){return this._node},Wi.prototype.toString=function(){var e=Math.atan2(this._dy,this._dx),n=this.getClass().getName(),c=n.lastIndexOf(".");return"  "+n.substring(c+1)+": "+this._p0+" - "+this._p1+" "+this._quadrant+":"+e+"   "+this._label},Wi.prototype.computeLabel=function(e){},Wi.prototype.init=function(e,n){this._p0=e,this._p1=n,this._dx=n.x-e.x,this._dy=n.y-e.y,this._quadrant=ni.quadrant(this._dx,this._dy),tt.isTrue(!(0===this._dx&&0===this._dy),"EdgeEnd with identical endpoints found")},Wi.prototype.interfaces_=function(){return[Q]},Wi.prototype.getClass=function(){return Wi};var Bs=function(e){function n(){var c=arguments[0],f=arguments[1];if(e.call(this,c),this._isForward=null,this._isInResult=!1,this._isVisited=!1,this._sym=null,this._next=null,this._nextMin=null,this._edgeRing=null,this._minEdgeRing=null,this._depth=[0,-999,-999],this._isForward=f,f)this.init(c.getCoordinate(0),c.getCoordinate(1));else{var x=c.getNumPoints()-1;this.init(c.getCoordinate(x),c.getCoordinate(x-1))}this.computeDirectedLabel()}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype.getNextMin=function(){return this._nextMin},n.prototype.getDepth=function(c){return this._depth[c]},n.prototype.setVisited=function(c){this._isVisited=c},n.prototype.computeDirectedLabel=function(){this._label=new Yn(this._edge.getLabel()),this._isForward||this._label.flip()},n.prototype.getNext=function(){return this._next},n.prototype.setDepth=function(c,f){if(-999!==this._depth[c]&&this._depth[c]!==f)throw new Fs("assigned depths do not match",this.getCoordinate());this._depth[c]=f},n.prototype.isInteriorAreaEdge=function(){for(var c=!0,f=0;f<2;f++)this._label.isArea(f)&&this._label.getLocation(f,$e.LEFT)===ct.INTERIOR&&this._label.getLocation(f,$e.RIGHT)===ct.INTERIOR||(c=!1);return c},n.prototype.setNextMin=function(c){this._nextMin=c},n.prototype.print=function(c){e.prototype.print.call(this,c),c.print(" "+this._depth[$e.LEFT]+"/"+this._depth[$e.RIGHT]),c.print(" ("+this.getDepthDelta()+")"),this._isInResult&&c.print(" inResult")},n.prototype.setMinEdgeRing=function(c){this._minEdgeRing=c},n.prototype.isLineEdge=function(){var c=this._label.isLine(0)||this._label.isLine(1),f=!this._label.isArea(0)||this._label.allPositionsEqual(0,ct.EXTERIOR),x=!this._label.isArea(1)||this._label.allPositionsEqual(1,ct.EXTERIOR);return c&&f&&x},n.prototype.setEdgeRing=function(c){this._edgeRing=c},n.prototype.getMinEdgeRing=function(){return this._minEdgeRing},n.prototype.getDepthDelta=function(){var c=this._edge.getDepthDelta();return this._isForward||(c=-c),c},n.prototype.setInResult=function(c){this._isInResult=c},n.prototype.getSym=function(){return this._sym},n.prototype.isForward=function(){return this._isForward},n.prototype.getEdge=function(){return this._edge},n.prototype.printEdge=function(c){this.print(c),c.print(" "),this._isForward?this._edge.print(c):this._edge.printReverse(c)},n.prototype.setSym=function(c){this._sym=c},n.prototype.setVisitedEdge=function(c){this.setVisited(c),this._sym.setVisited(c)},n.prototype.setEdgeDepths=function(c,f){var x=this.getEdge().getDepthDelta();this._isForward||(x=-x);var L=1;c===$e.LEFT&&(L=-1);var z=$e.opposite(c),W=f+x*L;this.setDepth(c,f),this.setDepth(z,W)},n.prototype.getEdgeRing=function(){return this._edgeRing},n.prototype.isInResult=function(){return this._isInResult},n.prototype.setNext=function(c){this._next=c},n.prototype.isVisited=function(){return this._isVisited},n.prototype.interfaces_=function(){return[]},n.prototype.getClass=function(){return n},n.depthFactor=function(c,f){return c===ct.EXTERIOR&&f===ct.INTERIOR?1:c===ct.INTERIOR&&f===ct.EXTERIOR?-1:0},n}(Wi),js=function(){};js.prototype.createNode=function(e){return new Nu(e,null)},js.prototype.interfaces_=function(){return[]},js.prototype.getClass=function(){return js};var ii=function(){this._edges=new Je,this._nodes=null,this._edgeEndList=new Je,0===arguments.length?this._nodes=new Ca(new js):1===arguments.length&&(this._nodes=new Ca(arguments[0]))};ii.prototype.printEdges=function(e){e.println("Edges:");for(var n=0;n<this._edges.size();n++){e.println("edge "+n+":");var c=this._edges.get(n);c.print(e),c.eiList.print(e)}},ii.prototype.find=function(e){return this._nodes.find(e)},ii.prototype.addNode=function(){return arguments[0]instanceof Nu||arguments[0]instanceof j?this._nodes.addNode(arguments[0]):void 0},ii.prototype.getNodeIterator=function(){return this._nodes.iterator()},ii.prototype.linkResultDirectedEdges=function(){for(var e=this._nodes.iterator();e.hasNext();)e.next().getEdges().linkResultDirectedEdges()},ii.prototype.debugPrintln=function(e){Sr.out.println(e)},ii.prototype.isBoundaryNode=function(e,n){var c=this._nodes.find(n);if(null===c)return!1;var f=c.getLabel();return null!==f&&f.getLocation(e)===ct.BOUNDARY},ii.prototype.linkAllDirectedEdges=function(){for(var e=this._nodes.iterator();e.hasNext();)e.next().getEdges().linkAllDirectedEdges()},ii.prototype.matchInSameDirection=function(e,n,c,f){return!!e.equals(c)&&Re.computeOrientation(e,n,f)===Re.COLLINEAR&&ni.quadrant(e,n)===ni.quadrant(c,f)},ii.prototype.getEdgeEnds=function(){return this._edgeEndList},ii.prototype.debugPrint=function(e){Sr.out.print(e)},ii.prototype.getEdgeIterator=function(){return this._edges.iterator()},ii.prototype.findEdgeInSameDirection=function(e,n){for(var c=0;c<this._edges.size();c++){var f=this._edges.get(c),x=f.getCoordinates();if(this.matchInSameDirection(e,n,x[0],x[1])||this.matchInSameDirection(e,n,x[x.length-1],x[x.length-2]))return f}return null},ii.prototype.insertEdge=function(e){this._edges.add(e)},ii.prototype.findEdgeEnd=function(e){for(var n=this.getEdgeEnds().iterator();n.hasNext();){var c=n.next();if(c.getEdge()===e)return c}return null},ii.prototype.addEdges=function(e){for(var n=e.iterator();n.hasNext();){var c=n.next();this._edges.add(c);var f=new Bs(c,!0),x=new Bs(c,!1);f.setSym(x),x.setSym(f),this.add(f),this.add(x)}},ii.prototype.add=function(e){this._nodes.add(e),this._edgeEndList.add(e)},ii.prototype.getNodes=function(){return this._nodes.values()},ii.prototype.findEdge=function(e,n){for(var c=0;c<this._edges.size();c++){var f=this._edges.get(c),x=f.getCoordinates();if(e.equals(x[0])&&n.equals(x[1]))return f}return null},ii.prototype.interfaces_=function(){return[]},ii.prototype.getClass=function(){return ii},ii.linkResultDirectedEdges=function(e){for(var n=e.iterator();n.hasNext();)n.next().getEdges().linkResultDirectedEdges()};var ao=function(){this._geometryFactory=null,this._shellList=new Je,this._geometryFactory=arguments[0]};ao.prototype.sortShellsAndHoles=function(e,n,c){for(var f=e.iterator();f.hasNext();){var x=f.next();x.isHole()?c.add(x):n.add(x)}},ao.prototype.computePolygons=function(e){for(var n=new Je,c=e.iterator();c.hasNext();){var f=c.next().toPolygon(this._geometryFactory);n.add(f)}return n},ao.prototype.placeFreeHoles=function(e,n){for(var c=n.iterator();c.hasNext();){var f=c.next();if(null===f.getShell()){var x=this.findEdgeRingContaining(f,e);if(null===x)throw new Fs("unable to assign hole to a shell",f.getCoordinate(0));f.setShell(x)}}},ao.prototype.buildMinimalEdgeRings=function(e,n,c){for(var f=new Je,x=e.iterator();x.hasNext();){var L=x.next();if(L.getMaxNodeDegree()>2){L.linkDirectedEdgesForMinimalEdgeRings();var z=L.buildMinimalRings(),W=this.findShell(z);null!==W?(this.placePolygonHoles(W,z),n.add(W)):c.addAll(z)}else f.add(L)}return f},ao.prototype.containsPoint=function(e){for(var n=this._shellList.iterator();n.hasNext();)if(n.next().containsPoint(e))return!0;return!1},ao.prototype.buildMaximalEdgeRings=function(e){for(var n=new Je,c=e.iterator();c.hasNext();){var f=c.next();if(f.isInResult()&&f.getLabel().isArea()&&null===f.getEdgeRing()){var x=new vl(f,this._geometryFactory);n.add(x),x.setInResult()}}return n},ao.prototype.placePolygonHoles=function(e,n){for(var c=n.iterator();c.hasNext();){var f=c.next();f.isHole()&&f.setShell(e)}},ao.prototype.getPolygons=function(){return this.computePolygons(this._shellList)},ao.prototype.findEdgeRingContaining=function(e,n){for(var c=e.getLinearRing(),f=c.getEnvelopeInternal(),x=c.getCoordinateN(0),L=null,z=null,W=n.iterator();W.hasNext();){var gt=W.next(),Zt=gt.getLinearRing(),Ie=Zt.getEnvelopeInternal();null!==L&&(z=L.getLinearRing().getEnvelopeInternal());var Me=!1;Ie.contains(f)&&Re.isPointInRing(x,Zt.getCoordinates())&&(Me=!0),Me&&(null===L||z.contains(Ie))&&(L=gt)}return L},ao.prototype.findShell=function(e){for(var n=0,c=null,f=e.iterator();f.hasNext();){var x=f.next();x.isHole()||(c=x,n++)}return tt.isTrue(n<=1,"found two shells in MinimalEdgeRing list"),c},ao.prototype.add=function(){if(1===arguments.length){var e=arguments[0];this.add(e.getEdgeEnds(),e.getNodes())}else if(2===arguments.length){var n=arguments[0];ii.linkResultDirectedEdges(arguments[1]);var f=this.buildMaximalEdgeRings(n),x=new Je,L=this.buildMinimalEdgeRings(f,this._shellList,x);this.sortShellsAndHoles(L,this._shellList,x),this.placeFreeHoles(this._shellList,x)}},ao.prototype.interfaces_=function(){return[]},ao.prototype.getClass=function(){return ao};var ja=function(){};ja.prototype.getBounds=function(){},ja.prototype.interfaces_=function(){return[]},ja.prototype.getClass=function(){return ja};var so=function(){this._bounds=null,this._item=null;var n=arguments[1];this._bounds=arguments[0],this._item=n};so.prototype.getItem=function(){return this._item},so.prototype.getBounds=function(){return this._bounds},so.prototype.interfaces_=function(){return[ja,yt]},so.prototype.getClass=function(){return so};var bi=function(){this._size=null,this._items=null,this._size=0,this._items=new Je,this._items.add(null)};bi.prototype.poll=function(){if(this.isEmpty())return null;var e=this._items.get(1);return this._items.set(1,this._items.get(this._size)),this._size-=1,this.reorder(1),e},bi.prototype.size=function(){return this._size},bi.prototype.reorder=function(e){for(var n=null,c=this._items.get(e);2*e<=this._size&&((n=2*e)!==this._size&&this._items.get(n+1).compareTo(this._items.get(n))<0&&n++,this._items.get(n).compareTo(c)<0);e=n)this._items.set(e,this._items.get(n));this._items.set(e,c)},bi.prototype.clear=function(){this._size=0,this._items.clear()},bi.prototype.isEmpty=function(){return 0===this._size},bi.prototype.add=function(e){this._items.add(null),this._size+=1;var n=this._size;for(this._items.set(0,e);e.compareTo(this._items.get(Math.trunc(n/2)))<0;n/=2)this._items.set(n,this._items.get(Math.trunc(n/2)));this._items.set(n,e)},bi.prototype.interfaces_=function(){return[]},bi.prototype.getClass=function(){return bi};var ms=function(){};ms.prototype.visitItem=function(e){},ms.prototype.interfaces_=function(){return[]},ms.prototype.getClass=function(){return ms};var uu=function(){};uu.prototype.insert=function(e,n){},uu.prototype.remove=function(e,n){},uu.prototype.query=function(){},uu.prototype.interfaces_=function(){return[]},uu.prototype.getClass=function(){return uu};var uo=function(){this._childBoundables=new Je,this._bounds=null,this._level=null,0!==arguments.length&&1===arguments.length&&(this._level=arguments[0])},Yu={serialVersionUID:{configurable:!0}};uo.prototype.getLevel=function(){return this._level},uo.prototype.size=function(){return this._childBoundables.size()},uo.prototype.getChildBoundables=function(){return this._childBoundables},uo.prototype.addChildBoundable=function(e){tt.isTrue(null===this._bounds),this._childBoundables.add(e)},uo.prototype.isEmpty=function(){return this._childBoundables.isEmpty()},uo.prototype.getBounds=function(){return null===this._bounds&&(this._bounds=this.computeBounds()),this._bounds},uo.prototype.interfaces_=function(){return[ja,yt]},uo.prototype.getClass=function(){return uo},Yu.serialVersionUID.get=function(){return 0x5a1e55ec41369800},Object.defineProperties(uo,Yu);var fa=function(){};fa.reverseOrder=function(){return{compare:function(e,n){return n.compareTo(e)}}},fa.min=function(e){return fa.sort(e),e.get(0)},fa.sort=function(e,n){var c=e.toArray();n?ye.sort(c,n):ye.sort(c);for(var f=e.iterator(),x=0,L=c.length;x<L;x++)f.next(),f.set(c[x])},fa.singletonList=function(e){var n=new Je;return n.add(e),n};var Ri=function(){this._boundable1=null,this._boundable2=null,this._distance=null,this._itemDistance=null;var n=arguments[1],c=arguments[2];this._boundable1=arguments[0],this._boundable2=n,this._itemDistance=c,this._distance=this.distance()};Ri.prototype.expandToQueue=function(e,n){var c=Ri.isComposite(this._boundable1),f=Ri.isComposite(this._boundable2);if(c&&f)return Ri.area(this._boundable1)>Ri.area(this._boundable2)?(this.expand(this._boundable1,this._boundable2,e,n),null):(this.expand(this._boundable2,this._boundable1,e,n),null);if(c)return this.expand(this._boundable1,this._boundable2,e,n),null;if(f)return this.expand(this._boundable2,this._boundable1,e,n),null;throw new J("neither boundable is composite")},Ri.prototype.isLeaves=function(){return!(Ri.isComposite(this._boundable1)||Ri.isComposite(this._boundable2))},Ri.prototype.compareTo=function(e){return this._distance<e._distance?-1:this._distance>e._distance?1:0},Ri.prototype.expand=function(e,n,c,f){for(var x=e.getChildBoundables().iterator();x.hasNext();){var L=x.next(),z=new Ri(L,n,this._itemDistance);z.getDistance()<f&&c.add(z)}},Ri.prototype.getBoundable=function(e){return 0===e?this._boundable1:this._boundable2},Ri.prototype.getDistance=function(){return this._distance},Ri.prototype.distance=function(){return this.isLeaves()?this._itemDistance.distance(this._boundable1,this._boundable2):this._boundable1.getBounds().distance(this._boundable2.getBounds())},Ri.prototype.interfaces_=function(){return[Q]},Ri.prototype.getClass=function(){return Ri},Ri.area=function(e){return e.getBounds().getArea()},Ri.isComposite=function(e){return e instanceof uo};var lo=function e(){if(this._root=null,this._built=!1,this._itemBoundables=new Je,this._nodeCapacity=null,0===arguments.length)this._nodeCapacity=e.DEFAULT_NODE_CAPACITY;else if(1===arguments.length){var c=arguments[0];tt.isTrue(c>1,"Node capacity must be greater than 1"),this._nodeCapacity=c}},wu={IntersectsOp:{configurable:!0},serialVersionUID:{configurable:!0},DEFAULT_NODE_CAPACITY:{configurable:!0}};lo.prototype.getNodeCapacity=function(){return this._nodeCapacity},lo.prototype.lastNode=function(e){return e.get(e.size()-1)},lo.prototype.size=function(){if(0===arguments.length)return this.isEmpty()?0:(this.build(),this.size(this._root));if(1===arguments.length){for(var e=0,n=arguments[0].getChildBoundables().iterator();n.hasNext();){var c=n.next();c instanceof uo?e+=this.size(c):c instanceof so&&(e+=1)}return e}},lo.prototype.removeItem=function(e,n){for(var c=null,f=e.getChildBoundables().iterator();f.hasNext();){var x=f.next();x instanceof so&&x.getItem()===n&&(c=x)}return null!==c&&(e.getChildBoundables().remove(c),!0)},lo.prototype.itemsTree=function(){if(0===arguments.length){this.build();var e=this.itemsTree(this._root);return null===e?new Je:e}if(1===arguments.length){for(var n=arguments[0],c=new Je,f=n.getChildBoundables().iterator();f.hasNext();){var x=f.next();if(x instanceof uo){var L=this.itemsTree(x);null!==L&&c.add(L)}else x instanceof so?c.add(x.getItem()):tt.shouldNeverReachHere()}return c.size()<=0?null:c}},lo.prototype.insert=function(e,n){tt.isTrue(!this._built,"Cannot insert items into an STR packed R-tree after it has been built."),this._itemBoundables.add(new so(e,n))},lo.prototype.boundablesAtLevel=function(){if(1===arguments.length){var e=arguments[0],n=new Je;return this.boundablesAtLevel(e,this._root,n),n}if(3===arguments.length){var c=arguments[0],f=arguments[1],x=arguments[2];if(tt.isTrue(c>-2),f.getLevel()===c)return x.add(f),null;for(var L=f.getChildBoundables().iterator();L.hasNext();){var z=L.next();z instanceof uo?this.boundablesAtLevel(c,z,x):(tt.isTrue(z instanceof so),-1===c&&x.add(z))}return null}},lo.prototype.query=function(){if(1===arguments.length){var e=arguments[0];this.build();var n=new Je;return this.isEmpty()||this.getIntersectsOp().intersects(this._root.getBounds(),e)&&this.query(e,this._root,n),n}if(2===arguments.length){var c=arguments[0],f=arguments[1];if(this.build(),this.isEmpty())return null;this.getIntersectsOp().intersects(this._root.getBounds(),c)&&this.query(c,this._root,f)}else if(3===arguments.length)if(Te(arguments[2],ms)&&arguments[0]instanceof Object&&arguments[1]instanceof uo)for(var x=arguments[0],z=arguments[2],W=arguments[1].getChildBoundables(),gt=0;gt<W.size();gt++){var Zt=W.get(gt);this.getIntersectsOp().intersects(Zt.getBounds(),x)&&(Zt instanceof uo?this.query(x,Zt,z):Zt instanceof so?z.visitItem(Zt.getItem()):tt.shouldNeverReachHere())}else if(Te(arguments[2],Oi)&&arguments[0]instanceof Object&&arguments[1]instanceof uo)for(var Ie=arguments[0],tr=arguments[2],mr=arguments[1].getChildBoundables(),Ar=0;Ar<mr.size();Ar++){var Xr=mr.get(Ar);this.getIntersectsOp().intersects(Xr.getBounds(),Ie)&&(Xr instanceof uo?this.query(Ie,Xr,tr):Xr instanceof so?tr.add(Xr.getItem()):tt.shouldNeverReachHere())}},lo.prototype.build=function(){if(this._built)return null;this._root=this._itemBoundables.isEmpty()?this.createNode(0):this.createHigherLevels(this._itemBoundables,-1),this._itemBoundables=null,this._built=!0},lo.prototype.getRoot=function(){return this.build(),this._root},lo.prototype.remove=function(){if(2===arguments.length){var e=arguments[0],n=arguments[1];return this.build(),!!this.getIntersectsOp().intersects(this._root.getBounds(),e)&&this.remove(e,this._root,n)}if(3===arguments.length){var c=arguments[0],f=arguments[1],x=arguments[2],L=this.removeItem(f,x);if(L)return!0;for(var z=null,W=f.getChildBoundables().iterator();W.hasNext();){var gt=W.next();if(this.getIntersectsOp().intersects(gt.getBounds(),c)&&gt instanceof uo&&(L=this.remove(c,gt,x))){z=gt;break}}return null!==z&&z.getChildBoundables().isEmpty()&&f.getChildBoundables().remove(z),L}},lo.prototype.createHigherLevels=function(e,n){tt.isTrue(!e.isEmpty());var c=this.createParentBoundables(e,n+1);return 1===c.size()?c.get(0):this.createHigherLevels(c,n+1)},lo.prototype.depth=function(){if(0===arguments.length)return this.isEmpty()?0:(this.build(),this.depth(this._root));if(1===arguments.length){for(var e=0,n=arguments[0].getChildBoundables().iterator();n.hasNext();){var c=n.next();if(c instanceof uo){var f=this.depth(c);f>e&&(e=f)}}return e+1}},lo.prototype.createParentBoundables=function(e,n){tt.isTrue(!e.isEmpty());var c=new Je;c.add(this.createNode(n));var f=new Je(e);fa.sort(f,this.getComparator());for(var x=f.iterator();x.hasNext();){var L=x.next();this.lastNode(c).getChildBoundables().size()===this.getNodeCapacity()&&c.add(this.createNode(n)),this.lastNode(c).addChildBoundable(L)}return c},lo.prototype.isEmpty=function(){return this._built?this._root.isEmpty():this._itemBoundables.isEmpty()},lo.prototype.interfaces_=function(){return[yt]},lo.prototype.getClass=function(){return lo},lo.compareDoubles=function(e,n){return e>n?1:e<n?-1:0},wu.IntersectsOp.get=function(){return Zl},wu.serialVersionUID.get=function(){return-0x35ef64c82d4c5400},wu.DEFAULT_NODE_CAPACITY.get=function(){return 10},Object.defineProperties(lo,wu);var Zl=function(){},lu=function(){};lu.prototype.distance=function(e,n){},lu.prototype.interfaces_=function(){return[]},lu.prototype.getClass=function(){return lu};var Wu=function(e){function n(f){e.call(this,f=f||n.DEFAULT_NODE_CAPACITY)}e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n;var c={STRtreeNode:{configurable:!0},serialVersionUID:{configurable:!0},xComparator:{configurable:!0},yComparator:{configurable:!0},intersectsOp:{configurable:!0},DEFAULT_NODE_CAPACITY:{configurable:!0}};return n.prototype.createParentBoundablesFromVerticalSlices=function(f,x){tt.isTrue(f.length>0);for(var L=new Je,z=0;z<f.length;z++)L.addAll(this.createParentBoundablesFromVerticalSlice(f[z],x));return L},n.prototype.createNode=function(f){return new Eu(f)},n.prototype.size=function(){return 0===arguments.length?e.prototype.size.call(this):e.prototype.size.apply(this,arguments)},n.prototype.insert=function(){if(2!==arguments.length)return e.prototype.insert.apply(this,arguments);var f=arguments[0],x=arguments[1];if(f.isNull())return null;e.prototype.insert.call(this,f,x)},n.prototype.getIntersectsOp=function(){return n.intersectsOp},n.prototype.verticalSlices=function(f,x){for(var L=Math.trunc(Math.ceil(f.size()/x)),z=new Array(x).fill(null),W=f.iterator(),gt=0;gt<x;gt++){z[gt]=new Je;for(var Zt=0;W.hasNext()&&Zt<L;){var Ie=W.next();z[gt].add(Ie),Zt++}}return z},n.prototype.query=function(){if(1===arguments.length)return e.prototype.query.call(this,arguments[0]);2===arguments.length?e.prototype.query.call(this,arguments[0],arguments[1]):3===arguments.length&&(Te(arguments[2],ms)&&arguments[0]instanceof Object&&arguments[1]instanceof uo||Te(arguments[2],Oi)&&arguments[0]instanceof Object&&arguments[1]instanceof uo)&&e.prototype.query.call(this,arguments[0],arguments[1],arguments[2])},n.prototype.getComparator=function(){return n.yComparator},n.prototype.createParentBoundablesFromVerticalSlice=function(f,x){return e.prototype.createParentBoundables.call(this,f,x)},n.prototype.remove=function(){return 2===arguments.length?e.prototype.remove.call(this,arguments[0],arguments[1]):e.prototype.remove.apply(this,arguments)},n.prototype.depth=function(){return 0===arguments.length?e.prototype.depth.call(this):e.prototype.depth.apply(this,arguments)},n.prototype.createParentBoundables=function(f,x){tt.isTrue(!f.isEmpty());var L=Math.trunc(Math.ceil(f.size()/this.getNodeCapacity())),z=new Je(f);fa.sort(z,n.xComparator);var W=this.verticalSlices(z,Math.trunc(Math.ceil(Math.sqrt(L))));return this.createParentBoundablesFromVerticalSlices(W,x)},n.prototype.nearestNeighbour=function(){if(1===arguments.length){if(Te(arguments[0],lu)){var f=arguments[0],x=new Ri(this.getRoot(),this.getRoot(),f);return this.nearestNeighbour(x)}if(arguments[0]instanceof Ri)return this.nearestNeighbour(arguments[0],$.POSITIVE_INFINITY)}else if(2===arguments.length){if(arguments[0]instanceof n&&Te(arguments[1],lu)){var z=arguments[0],W=arguments[1],gt=new Ri(this.getRoot(),z.getRoot(),W);return this.nearestNeighbour(gt)}if(arguments[0]instanceof Ri&&"number"==typeof arguments[1]){var Zt=arguments[0],Ie=arguments[1],Me=null,tr=new bi;for(tr.add(Zt);!tr.isEmpty()&&Ie>0;){var mr=tr.poll(),Ar=mr.getDistance();if(Ar>=Ie)break;mr.isLeaves()?(Ie=Ar,Me=mr):mr.expandToQueue(tr,Ie)}return[Me.getBoundable(0).getItem(),Me.getBoundable(1).getItem()]}}else if(3===arguments.length){var u=arguments[2],p=new so(arguments[0],arguments[1]),l=new Ri(this.getRoot(),p,u);return this.nearestNeighbour(l)[0]}},n.prototype.interfaces_=function(){return[uu,yt]},n.prototype.getClass=function(){return n},n.centreX=function(f){return n.avg(f.getMinX(),f.getMaxX())},n.avg=function(f,x){return(f+x)/2},n.centreY=function(f){return n.avg(f.getMinY(),f.getMaxY())},c.STRtreeNode.get=function(){return Eu},c.serialVersionUID.get=function(){return 0x39920f7d5f261e0},c.xComparator.get=function(){return{interfaces_:function(){return[st]},compare:function(f,x){return e.compareDoubles(n.centreX(f.getBounds()),n.centreX(x.getBounds()))}}},c.yComparator.get=function(){return{interfaces_:function(){return[st]},compare:function(f,x){return e.compareDoubles(n.centreY(f.getBounds()),n.centreY(x.getBounds()))}}},c.intersectsOp.get=function(){return{interfaces_:function(){return[e.IntersectsOp]},intersects:function(f,x){return f.intersects(x)}}},c.DEFAULT_NODE_CAPACITY.get=function(){return 10},Object.defineProperties(n,c),n}(lo),Eu=function(e){function n(){e.call(this,arguments[0])}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype.computeBounds=function(){for(var c=null,f=this.getChildBoundables().iterator();f.hasNext();){var x=f.next();null===c?c=new ke(x.getBounds()):c.expandToInclude(x.getBounds())}return c},n.prototype.interfaces_=function(){return[]},n.prototype.getClass=function(){return n},n}(uo),eo=function(){};eo.prototype.interfaces_=function(){return[]},eo.prototype.getClass=function(){return eo},eo.relativeSign=function(e,n){return e<n?-1:e>n?1:0},eo.compare=function(e,n,c){if(n.equals2D(c))return 0;var f=eo.relativeSign(n.x,c.x),x=eo.relativeSign(n.y,c.y);switch(e){case 0:return eo.compareValue(f,x);case 1:return eo.compareValue(x,f);case 2:return eo.compareValue(x,-f);case 3:return eo.compareValue(-f,x);case 4:return eo.compareValue(-f,-x);case 5:return eo.compareValue(-x,-f);case 6:return eo.compareValue(-x,f);case 7:return eo.compareValue(f,-x)}return tt.shouldNeverReachHere("invalid octant value"),0},eo.compareValue=function(e,n){return e<0?-1:e>0?1:n<0?-1:n>0?1:0};var Us=function(){this._segString=null,this.coord=null,this.segmentIndex=null,this._segmentOctant=null,this._isInterior=null;var e=arguments[0],n=arguments[1],c=arguments[2],f=arguments[3];this._segString=e,this.coord=new j(n),this.segmentIndex=c,this._segmentOctant=f,this._isInterior=!n.equals2D(e.getCoordinate(c))};Us.prototype.getCoordinate=function(){return this.coord},Us.prototype.print=function(e){e.print(this.coord),e.print(" seg # = "+this.segmentIndex)},Us.prototype.compareTo=function(e){var n=e;return this.segmentIndex<n.segmentIndex?-1:this.segmentIndex>n.segmentIndex?1:this.coord.equals2D(n.coord)?0:eo.compare(this._segmentOctant,this.coord,n.coord)},Us.prototype.isEndPoint=function(e){return 0===this.segmentIndex&&!this._isInterior||this.segmentIndex===e},Us.prototype.isInterior=function(){return this._isInterior},Us.prototype.interfaces_=function(){return[Q]},Us.prototype.getClass=function(){return Us};var Qn=function(){this._nodeMap=new ve,this._edge=null,this._edge=arguments[0]};Qn.prototype.getSplitCoordinates=function(){var e=new Z;this.addEndpoints();for(var n=this.iterator(),c=n.next();n.hasNext();){var f=n.next();this.addEdgeCoordinates(c,f,e),c=f}return e.toCoordinateArray()},Qn.prototype.addCollapsedNodes=function(){var e=new Je;this.findCollapsesFromInsertedNodes(e),this.findCollapsesFromExistingVertices(e);for(var n=e.iterator();n.hasNext();){var c=n.next().intValue();this.add(this._edge.getCoordinate(c),c)}},Qn.prototype.print=function(e){e.println("Intersections:");for(var n=this.iterator();n.hasNext();)n.next().print(e)},Qn.prototype.findCollapsesFromExistingVertices=function(e){for(var n=0;n<this._edge.size()-2;n++){var c=this._edge.getCoordinate(n),f=this._edge.getCoordinate(n+2);c.equals2D(f)&&e.add(new Ht(n+1))}},Qn.prototype.addEdgeCoordinates=function(e,n,c){var f=this._edge.getCoordinate(n.segmentIndex),x=n.isInterior()||!n.coord.equals2D(f);c.add(new j(e.coord),!1);for(var L=e.segmentIndex+1;L<=n.segmentIndex;L++)c.add(this._edge.getCoordinate(L));x&&c.add(new j(n.coord))},Qn.prototype.iterator=function(){return this._nodeMap.values().iterator()},Qn.prototype.addSplitEdges=function(e){this.addEndpoints(),this.addCollapsedNodes();for(var n=this.iterator(),c=n.next();n.hasNext();){var f=n.next(),x=this.createSplitEdge(c,f);e.add(x),c=f}},Qn.prototype.findCollapseIndex=function(e,n,c){if(!e.coord.equals2D(n.coord))return!1;var f=n.segmentIndex-e.segmentIndex;return n.isInterior()||f--,1===f&&(c[0]=e.segmentIndex+1,!0)},Qn.prototype.findCollapsesFromInsertedNodes=function(e){for(var n=new Array(1).fill(null),c=this.iterator(),f=c.next();c.hasNext();){var x=c.next();this.findCollapseIndex(f,x,n)&&e.add(new Ht(n[0])),f=x}},Qn.prototype.getEdge=function(){return this._edge},Qn.prototype.addEndpoints=function(){var e=this._edge.size()-1;this.add(this._edge.getCoordinate(0),0),this.add(this._edge.getCoordinate(e),e)},Qn.prototype.createSplitEdge=function(e,n){var c=n.segmentIndex-e.segmentIndex+2,f=this._edge.getCoordinate(n.segmentIndex),x=n.isInterior()||!n.coord.equals2D(f);x||c--;var L=new Array(c).fill(null),z=0;L[z++]=new j(e.coord);for(var W=e.segmentIndex+1;W<=n.segmentIndex;W++)L[z++]=this._edge.getCoordinate(W);return x&&(L[z]=new j(n.coord)),new wi(L,this._edge.getData())},Qn.prototype.add=function(e,n){var c=new Us(this._edge,e,n,this._edge.getSegmentOctant(n)),f=this._nodeMap.get(c);return null!==f?(tt.isTrue(f.coord.equals2D(e),"Found equal nodes with different coordinates"),f):(this._nodeMap.put(c,c),c)},Qn.prototype.checkSplitEdgesCorrectness=function(e){var n=this._edge.getCoordinates(),c=e.get(0).getCoordinate(0);if(!c.equals2D(n[0]))throw new ot("bad split edge start point at "+c);var f=e.get(e.size()-1).getCoordinates(),x=f[f.length-1];if(!x.equals2D(n[n.length-1]))throw new ot("bad split edge end point at "+x)},Qn.prototype.interfaces_=function(){return[]},Qn.prototype.getClass=function(){return Qn};var Ms=function(){};Ms.prototype.interfaces_=function(){return[]},Ms.prototype.getClass=function(){return Ms},Ms.octant=function(){if("number"==typeof arguments[0]&&"number"==typeof arguments[1]){var e=arguments[0],n=arguments[1];if(0===e&&0===n)throw new J("Cannot compute the octant for point ( "+e+", "+n+" )");var c=Math.abs(e),f=Math.abs(n);return e>=0?n>=0?c>=f?0:1:c>=f?7:6:n>=0?c>=f?3:2:c>=f?4:5}if(arguments[0]instanceof j&&arguments[1]instanceof j){var x=arguments[0],L=arguments[1],z=L.x-x.x,W=L.y-x.y;if(0===z&&0===W)throw new J("Cannot compute the octant for two identical points "+x);return Ms.octant(z,W)}};var Fo=function(){};Fo.prototype.getCoordinates=function(){},Fo.prototype.size=function(){},Fo.prototype.getCoordinate=function(e){},Fo.prototype.isClosed=function(){},Fo.prototype.setData=function(e){},Fo.prototype.getData=function(){},Fo.prototype.interfaces_=function(){return[]},Fo.prototype.getClass=function(){return Fo};var rs=function(){};rs.prototype.addIntersection=function(e,n){},rs.prototype.interfaces_=function(){return[Fo]},rs.prototype.getClass=function(){return rs};var wi=function(){this._nodeList=new Qn(this),this._pts=null,this._data=null;var n=arguments[1];this._pts=arguments[0],this._data=n};wi.prototype.getCoordinates=function(){return this._pts},wi.prototype.size=function(){return this._pts.length},wi.prototype.getCoordinate=function(e){return this._pts[e]},wi.prototype.isClosed=function(){return this._pts[0].equals(this._pts[this._pts.length-1])},wi.prototype.getSegmentOctant=function(e){return e===this._pts.length-1?-1:this.safeOctant(this.getCoordinate(e),this.getCoordinate(e+1))},wi.prototype.setData=function(e){this._data=e},wi.prototype.safeOctant=function(e,n){return e.equals2D(n)?0:Ms.octant(e,n)},wi.prototype.getData=function(){return this._data},wi.prototype.addIntersection=function(){if(2===arguments.length)this.addIntersectionNode(arguments[0],arguments[1]);else if(4===arguments.length){var f=arguments[1],L=new j(arguments[0].getIntersection(arguments[3]));this.addIntersection(L,f)}},wi.prototype.toString=function(){return le.toLineString(new Un(this._pts))},wi.prototype.getNodeList=function(){return this._nodeList},wi.prototype.addIntersectionNode=function(e,n){var c=n,f=c+1;return f<this._pts.length&&e.equals2D(this._pts[f])&&(c=f),this._nodeList.add(e,c)},wi.prototype.addIntersections=function(e,n,c){for(var f=0;f<e.getIntersectionNum();f++)this.addIntersection(e,n,c,f)},wi.prototype.interfaces_=function(){return[rs]},wi.prototype.getClass=function(){return wi},wi.getNodedSubstrings=function(){if(1===arguments.length){var e=arguments[0],n=new Je;return wi.getNodedSubstrings(e,n),n}if(2===arguments.length)for(var f=arguments[1],x=arguments[0].iterator();x.hasNext();)x.next().getNodeList().addSplitEdges(f)};var kr=function(){if(this.p0=null,this.p1=null,0===arguments.length)this.p0=new j,this.p1=new j;else if(1===arguments.length){var e=arguments[0];this.p0=new j(e.p0),this.p1=new j(e.p1)}else if(2===arguments.length)this.p0=arguments[0],this.p1=arguments[1];else if(4===arguments.length){var f=arguments[2],x=arguments[3];this.p0=new j(arguments[0],arguments[1]),this.p1=new j(f,x)}},Xs={serialVersionUID:{configurable:!0}};kr.prototype.minX=function(){return Math.min(this.p0.x,this.p1.x)},kr.prototype.orientationIndex=function(){if(arguments[0]instanceof kr){var e=arguments[0],n=Re.orientationIndex(this.p0,this.p1,e.p0),c=Re.orientationIndex(this.p0,this.p1,e.p1);return n>=0&&c>=0||n<=0&&c<=0?Math.max(n,c):0}if(arguments[0]instanceof j)return Re.orientationIndex(this.p0,this.p1,arguments[0])},kr.prototype.toGeometry=function(e){return e.createLineString([this.p0,this.p1])},kr.prototype.isVertical=function(){return this.p0.x===this.p1.x},kr.prototype.equals=function(e){if(!(e instanceof kr))return!1;var n=e;return this.p0.equals(n.p0)&&this.p1.equals(n.p1)},kr.prototype.intersection=function(e){var n=new Ee;return n.computeIntersection(this.p0,this.p1,e.p0,e.p1),n.hasIntersection()?n.getIntersection(0):null},kr.prototype.project=function(){if(arguments[0]instanceof j){var e=arguments[0];if(e.equals(this.p0)||e.equals(this.p1))return new j(e);var n=this.projectionFactor(e),c=new j;return c.x=this.p0.x+n*(this.p1.x-this.p0.x),c.y=this.p0.y+n*(this.p1.y-this.p0.y),c}if(arguments[0]instanceof kr){var f=arguments[0],x=this.projectionFactor(f.p0),L=this.projectionFactor(f.p1);if(x>=1&&L>=1||x<=0&&L<=0)return null;var z=this.project(f.p0);x<0&&(z=this.p0),x>1&&(z=this.p1);var W=this.project(f.p1);return L<0&&(W=this.p0),L>1&&(W=this.p1),new kr(z,W)}},kr.prototype.normalize=function(){this.p1.compareTo(this.p0)<0&&this.reverse()},kr.prototype.angle=function(){return Math.atan2(this.p1.y-this.p0.y,this.p1.x-this.p0.x)},kr.prototype.getCoordinate=function(e){return 0===e?this.p0:this.p1},kr.prototype.distancePerpendicular=function(e){return Re.distancePointLinePerpendicular(e,this.p0,this.p1)},kr.prototype.minY=function(){return Math.min(this.p0.y,this.p1.y)},kr.prototype.midPoint=function(){return kr.midPoint(this.p0,this.p1)},kr.prototype.projectionFactor=function(e){if(e.equals(this.p0))return 0;if(e.equals(this.p1))return 1;var n=this.p1.x-this.p0.x,c=this.p1.y-this.p0.y,f=n*n+c*c;return f<=0?$.NaN:((e.x-this.p0.x)*n+(e.y-this.p0.y)*c)/f},kr.prototype.closestPoints=function(e){var n=this.intersection(e);if(null!==n)return[n,n];var c=new Array(2).fill(null),f=$.MAX_VALUE,x=null,L=this.closestPoint(e.p0);f=L.distance(e.p0),c[0]=L,c[1]=e.p0;var z=this.closestPoint(e.p1);(x=z.distance(e.p1))<f&&(f=x,c[0]=z,c[1]=e.p1);var W=e.closestPoint(this.p0);(x=W.distance(this.p0))<f&&(f=x,c[0]=this.p0,c[1]=W);var gt=e.closestPoint(this.p1);return(x=gt.distance(this.p1))<f&&(f=x,c[0]=this.p1,c[1]=gt),c},kr.prototype.closestPoint=function(e){var n=this.projectionFactor(e);return n>0&&n<1?this.project(e):this.p0.distance(e)<this.p1.distance(e)?this.p0:this.p1},kr.prototype.maxX=function(){return Math.max(this.p0.x,this.p1.x)},kr.prototype.getLength=function(){return this.p0.distance(this.p1)},kr.prototype.compareTo=function(e){var n=e,c=this.p0.compareTo(n.p0);return 0!==c?c:this.p1.compareTo(n.p1)},kr.prototype.reverse=function(){var e=this.p0;this.p0=this.p1,this.p1=e},kr.prototype.equalsTopo=function(e){return this.p0.equals(e.p0)&&(this.p1.equals(e.p1)||this.p0.equals(e.p1))&&this.p1.equals(e.p0)},kr.prototype.lineIntersection=function(e){try{return Cr.intersection(this.p0,this.p1,e.p0,e.p1)}catch(n){if(!(n instanceof Yr))throw n}return null},kr.prototype.maxY=function(){return Math.max(this.p0.y,this.p1.y)},kr.prototype.pointAlongOffset=function(e,n){var c=this.p0.x+e*(this.p1.x-this.p0.x),f=this.p0.y+e*(this.p1.y-this.p0.y),x=this.p1.x-this.p0.x,L=this.p1.y-this.p0.y,z=Math.sqrt(x*x+L*L),W=0,gt=0;if(0!==n){if(z<=0)throw new Error("Cannot compute offset from zero-length line segment");W=n*x/z,gt=n*L/z}return new j(c-gt,f+W)},kr.prototype.setCoordinates=function(){if(1===arguments.length){var e=arguments[0];this.setCoordinates(e.p0,e.p1)}else if(2===arguments.length){var n=arguments[0],c=arguments[1];this.p0.x=n.x,this.p0.y=n.y,this.p1.x=c.x,this.p1.y=c.y}},kr.prototype.segmentFraction=function(e){var n=this.projectionFactor(e);return n<0?n=0:(n>1||$.isNaN(n))&&(n=1),n},kr.prototype.toString=function(){return"LINESTRING( "+this.p0.x+" "+this.p0.y+", "+this.p1.x+" "+this.p1.y+")"},kr.prototype.isHorizontal=function(){return this.p0.y===this.p1.y},kr.prototype.distance=function(){if(arguments[0]instanceof kr){var e=arguments[0];return Re.distanceLineLine(this.p0,this.p1,e.p0,e.p1)}if(arguments[0]instanceof j)return Re.distancePointLine(arguments[0],this.p0,this.p1)},kr.prototype.pointAlong=function(e){var n=new j;return n.x=this.p0.x+e*(this.p1.x-this.p0.x),n.y=this.p0.y+e*(this.p1.y-this.p0.y),n},kr.prototype.hashCode=function(){var e=$.doubleToLongBits(this.p0.x);e^=31*$.doubleToLongBits(this.p0.y);var n=Math.trunc(e)^Math.trunc(e>>32),c=$.doubleToLongBits(this.p1.x);return c^=31*$.doubleToLongBits(this.p1.y),n^Math.trunc(c)^Math.trunc(c>>32)},kr.prototype.interfaces_=function(){return[Q,yt]},kr.prototype.getClass=function(){return kr},kr.midPoint=function(e,n){return new j((e.x+n.x)/2,(e.y+n.y)/2)},Xs.serialVersionUID.get=function(){return 0x2d2172135f411c00},Object.defineProperties(kr,Xs);var ys=function(){this.tempEnv1=new ke,this.tempEnv2=new ke,this._overlapSeg1=new kr,this._overlapSeg2=new kr};ys.prototype.overlap=function(){if(2!==arguments.length&&4===arguments.length){var c=arguments[2],f=arguments[3];arguments[0].getLineSegment(arguments[1],this._overlapSeg1),c.getLineSegment(f,this._overlapSeg2),this.overlap(this._overlapSeg1,this._overlapSeg2)}},ys.prototype.interfaces_=function(){return[]},ys.prototype.getClass=function(){return ys};var co=function(){this._pts=null,this._start=null,this._end=null,this._env=null,this._context=null,this._id=null;var n=arguments[1],c=arguments[2],f=arguments[3];this._pts=arguments[0],this._start=n,this._end=c,this._context=f};co.prototype.getLineSegment=function(e,n){n.p0=this._pts[e],n.p1=this._pts[e+1]},co.prototype.computeSelect=function(e,n,c,f){if(f.tempEnv1.init(this._pts[n],this._pts[c]),c-n==1)return f.select(this,n),null;if(!e.intersects(f.tempEnv1))return null;var z=Math.trunc((n+c)/2);n<z&&this.computeSelect(e,n,z,f),z<c&&this.computeSelect(e,z,c,f)},co.prototype.getCoordinates=function(){for(var e=new Array(this._end-this._start+1).fill(null),n=0,c=this._start;c<=this._end;c++)e[n++]=this._pts[c];return e},co.prototype.computeOverlaps=function(e,n){this.computeOverlapsInternal(this._start,this._end,e,e._start,e._end,n)},co.prototype.setId=function(e){this._id=e},co.prototype.select=function(e,n){this.computeSelect(e,this._start,this._end,n)},co.prototype.getEnvelope=function(){return null===this._env&&(this._env=new ke(this._pts[this._start],this._pts[this._end])),this._env},co.prototype.getEndIndex=function(){return this._end},co.prototype.getStartIndex=function(){return this._start},co.prototype.getContext=function(){return this._context},co.prototype.getId=function(){return this._id},co.prototype.computeOverlapsInternal=function(e,n,c,f,x,L){var z=this._pts[e],W=this._pts[n],gt=c._pts[f],Zt=c._pts[x];if(n-e==1&&x-f==1)return L.overlap(this,e,c,f),null;if(L.tempEnv1.init(z,W),L.tempEnv2.init(gt,Zt),!L.tempEnv1.intersects(L.tempEnv2))return null;var Ie=Math.trunc((e+n)/2),Me=Math.trunc((f+x)/2);e<Ie&&(f<Me&&this.computeOverlapsInternal(e,Ie,c,f,Me,L),Me<x&&this.computeOverlapsInternal(e,Ie,c,Me,x,L)),Ie<n&&(f<Me&&this.computeOverlapsInternal(Ie,n,c,f,Me,L),Me<x&&this.computeOverlapsInternal(Ie,n,c,Me,x,L))},co.prototype.interfaces_=function(){return[]},co.prototype.getClass=function(){return co};var Wo=function(){};Wo.prototype.interfaces_=function(){return[]},Wo.prototype.getClass=function(){return Wo},Wo.getChainStartIndices=function(e){var n=0,c=new Je;c.add(new Ht(n));do{var f=Wo.findChainEnd(e,n);c.add(new Ht(f)),n=f}while(n<e.length-1);return Wo.toIntArray(c)},Wo.findChainEnd=function(e,n){for(var c=n;c<e.length-1&&e[c].equals2D(e[c+1]);)c++;if(c>=e.length-1)return e.length-1;for(var f=ni.quadrant(e[c],e[c+1]),x=n+1;x<e.length&&(e[x-1].equals2D(e[x])||ni.quadrant(e[x-1],e[x])===f);)x++;return x-1},Wo.getChains=function(){if(1===arguments.length)return Wo.getChains(arguments[0],null);if(2===arguments.length){for(var n=arguments[0],c=arguments[1],f=new Je,x=Wo.getChainStartIndices(n),L=0;L<x.length-1;L++){var z=new co(n,x[L],x[L+1],c);f.add(z)}return f}},Wo.toIntArray=function(e){for(var n=new Array(e.size()).fill(null),c=0;c<n.length;c++)n[c]=e.get(c).intValue();return n};var Ys=function(){};Ys.prototype.computeNodes=function(e){},Ys.prototype.getNodedSubstrings=function(){},Ys.prototype.interfaces_=function(){return[]},Ys.prototype.getClass=function(){return Ys};var Ei=function(){this._segInt=null,0!==arguments.length&&1===arguments.length&&this.setSegmentIntersector(arguments[0])};Ei.prototype.setSegmentIntersector=function(e){this._segInt=e},Ei.prototype.interfaces_=function(){return[Ys]},Ei.prototype.getClass=function(){return Ei};var cu=function(e){function n(f){f?e.call(this,f):e.call(this),this._monoChains=new Je,this._index=new Wu,this._idCounter=0,this._nodedSegStrings=null,this._nOverlaps=0}e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n;var c={SegmentOverlapAction:{configurable:!0}};return n.prototype.getMonotoneChains=function(){return this._monoChains},n.prototype.getNodedSubstrings=function(){return wi.getNodedSubstrings(this._nodedSegStrings)},n.prototype.getIndex=function(){return this._index},n.prototype.add=function(f){for(var x=Wo.getChains(f.getCoordinates(),f).iterator();x.hasNext();){var L=x.next();L.setId(this._idCounter++),this._index.insert(L.getEnvelope(),L),this._monoChains.add(L)}},n.prototype.computeNodes=function(f){this._nodedSegStrings=f;for(var x=f.iterator();x.hasNext();)this.add(x.next());this.intersectChains()},n.prototype.intersectChains=function(){for(var f=new Hu(this._segInt),x=this._monoChains.iterator();x.hasNext();)for(var L=x.next(),z=this._index.query(L.getEnvelope()).iterator();z.hasNext();){var W=z.next();if(W.getId()>L.getId()&&(L.computeOverlaps(W,f),this._nOverlaps++),this._segInt.isDone())return null}},n.prototype.interfaces_=function(){return[]},n.prototype.getClass=function(){return n},c.SegmentOverlapAction.get=function(){return Hu},Object.defineProperties(n,c),n}(Ei),Hu=function(e){function n(){e.call(this),this._si=null,this._si=arguments[0]}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype.overlap=function(){if(4!==arguments.length)return e.prototype.overlap.apply(this,arguments);var f=arguments[1],x=arguments[2],L=arguments[3],z=arguments[0].getContext(),W=x.getContext();this._si.processIntersections(z,f,W,L)},n.prototype.interfaces_=function(){return[]},n.prototype.getClass=function(){return n},n}(ys),qn=function e(){if(this._quadrantSegments=e.DEFAULT_QUADRANT_SEGMENTS,this._endCapStyle=e.CAP_ROUND,this._joinStyle=e.JOIN_ROUND,this._mitreLimit=e.DEFAULT_MITRE_LIMIT,this._isSingleSided=!1,this._simplifyFactor=e.DEFAULT_SIMPLIFY_FACTOR,0!==arguments.length)if(1===arguments.length)this.setQuadrantSegments(arguments[0]);else if(2===arguments.length){var f=arguments[1];this.setQuadrantSegments(arguments[0]),this.setEndCapStyle(f)}else if(4===arguments.length){var L=arguments[1],z=arguments[2],W=arguments[3];this.setQuadrantSegments(arguments[0]),this.setEndCapStyle(L),this.setJoinStyle(z),this.setMitreLimit(W)}},Ts={CAP_ROUND:{configurable:!0},CAP_FLAT:{configurable:!0},CAP_SQUARE:{configurable:!0},JOIN_ROUND:{configurable:!0},JOIN_MITRE:{configurable:!0},JOIN_BEVEL:{configurable:!0},DEFAULT_QUADRANT_SEGMENTS:{configurable:!0},DEFAULT_MITRE_LIMIT:{configurable:!0},DEFAULT_SIMPLIFY_FACTOR:{configurable:!0}};qn.prototype.getEndCapStyle=function(){return this._endCapStyle},qn.prototype.isSingleSided=function(){return this._isSingleSided},qn.prototype.setQuadrantSegments=function(e){this._quadrantSegments=e,0===this._quadrantSegments&&(this._joinStyle=qn.JOIN_BEVEL),this._quadrantSegments<0&&(this._joinStyle=qn.JOIN_MITRE,this._mitreLimit=Math.abs(this._quadrantSegments)),e<=0&&(this._quadrantSegments=1),this._joinStyle!==qn.JOIN_ROUND&&(this._quadrantSegments=qn.DEFAULT_QUADRANT_SEGMENTS)},qn.prototype.getJoinStyle=function(){return this._joinStyle},qn.prototype.setJoinStyle=function(e){this._joinStyle=e},qn.prototype.setSimplifyFactor=function(e){this._simplifyFactor=e<0?0:e},qn.prototype.getSimplifyFactor=function(){return this._simplifyFactor},qn.prototype.getQuadrantSegments=function(){return this._quadrantSegments},qn.prototype.setEndCapStyle=function(e){this._endCapStyle=e},qn.prototype.getMitreLimit=function(){return this._mitreLimit},qn.prototype.setMitreLimit=function(e){this._mitreLimit=e},qn.prototype.setSingleSided=function(e){this._isSingleSided=e},qn.prototype.interfaces_=function(){return[]},qn.prototype.getClass=function(){return qn},qn.bufferDistanceError=function(e){var n=Math.PI/2/e;return 1-Math.cos(n/2)},Ts.CAP_ROUND.get=function(){return 1},Ts.CAP_FLAT.get=function(){return 2},Ts.CAP_SQUARE.get=function(){return 3},Ts.JOIN_ROUND.get=function(){return 1},Ts.JOIN_MITRE.get=function(){return 2},Ts.JOIN_BEVEL.get=function(){return 3},Ts.DEFAULT_QUADRANT_SEGMENTS.get=function(){return 8},Ts.DEFAULT_MITRE_LIMIT.get=function(){return 5},Ts.DEFAULT_SIMPLIFY_FACTOR.get=function(){return.01},Object.defineProperties(qn,Ts);var Ni=function(e){this._distanceTol=null,this._isDeleted=null,this._angleOrientation=Re.COUNTERCLOCKWISE,this._inputLine=e||null},Su={INIT:{configurable:!0},DELETE:{configurable:!0},KEEP:{configurable:!0},NUM_PTS_TO_CHECK:{configurable:!0}};Ni.prototype.isDeletable=function(e,n,c,f){var x=this._inputLine[e],L=this._inputLine[n],z=this._inputLine[c];return!!this.isConcave(x,L,z)&&!!this.isShallow(x,L,z,f)&&this.isShallowSampled(x,L,e,c,f)},Ni.prototype.deleteShallowConcavities=function(){for(var e=1,n=this.findNextNonDeletedIndex(e),c=this.findNextNonDeletedIndex(n),f=!1;c<this._inputLine.length;){var x=!1;this.isDeletable(e,n,c,this._distanceTol)&&(this._isDeleted[n]=Ni.DELETE,x=!0,f=!0),n=this.findNextNonDeletedIndex(e=x?c:n),c=this.findNextNonDeletedIndex(n)}return f},Ni.prototype.isShallowConcavity=function(e,n,c,f){return Re.computeOrientation(e,n,c)===this._angleOrientation&&Re.distancePointLine(n,e,c)<f},Ni.prototype.isShallowSampled=function(e,n,c,f,x){var L=Math.trunc((f-c)/Ni.NUM_PTS_TO_CHECK);L<=0&&(L=1);for(var z=c;z<f;z+=L)if(!this.isShallow(e,n,this._inputLine[z],x))return!1;return!0},Ni.prototype.isConcave=function(e,n,c){return Re.computeOrientation(e,n,c)===this._angleOrientation},Ni.prototype.simplify=function(e){this._distanceTol=Math.abs(e),e<0&&(this._angleOrientation=Re.CLOCKWISE),this._isDeleted=new Array(this._inputLine.length).fill(null);var n=!1;do{n=this.deleteShallowConcavities()}while(n);return this.collapseLine()},Ni.prototype.findNextNonDeletedIndex=function(e){for(var n=e+1;n<this._inputLine.length&&this._isDeleted[n]===Ni.DELETE;)n++;return n},Ni.prototype.isShallow=function(e,n,c,f){return Re.distancePointLine(n,e,c)<f},Ni.prototype.collapseLine=function(){for(var e=new Z,n=0;n<this._inputLine.length;n++)this._isDeleted[n]!==Ni.DELETE&&e.add(this._inputLine[n]);return e.toCoordinateArray()},Ni.prototype.interfaces_=function(){return[]},Ni.prototype.getClass=function(){return Ni},Ni.simplify=function(e,n){return new Ni(e).simplify(n)},Su.INIT.get=function(){return 0},Su.DELETE.get=function(){return 1},Su.KEEP.get=function(){return 1},Su.NUM_PTS_TO_CHECK.get=function(){return 10},Object.defineProperties(Ni,Su);var Ia=function(){this._ptList=null,this._precisionModel=null,this._minimimVertexDistance=0,this._ptList=new Je},Ws={COORDINATE_ARRAY_TYPE:{configurable:!0}};Ia.prototype.getCoordinates=function(){return this._ptList.toArray(Ia.COORDINATE_ARRAY_TYPE)},Ia.prototype.setPrecisionModel=function(e){this._precisionModel=e},Ia.prototype.addPt=function(e){var n=new j(e);if(this._precisionModel.makePrecise(n),this.isRedundant(n))return null;this._ptList.add(n)},Ia.prototype.revere=function(){},Ia.prototype.addPts=function(e,n){if(n)for(var c=0;c<e.length;c++)this.addPt(e[c]);else for(var f=e.length-1;f>=0;f--)this.addPt(e[f])},Ia.prototype.isRedundant=function(e){if(this._ptList.size()<1)return!1;var n=this._ptList.get(this._ptList.size()-1);return e.distance(n)<this._minimimVertexDistance},Ia.prototype.toString=function(){return(new nn).createLineString(this.getCoordinates()).toString()},Ia.prototype.closeRing=function(){if(this._ptList.size()<1)return null;var e=new j(this._ptList.get(0)),n=this._ptList.get(this._ptList.size()-1);if(e.equals(n))return null;this._ptList.add(e)},Ia.prototype.setMinimumVertexDistance=function(e){this._minimimVertexDistance=e},Ia.prototype.interfaces_=function(){return[]},Ia.prototype.getClass=function(){return Ia},Ws.COORDINATE_ARRAY_TYPE.get=function(){return new Array(0).fill(null)},Object.defineProperties(Ia,Ws);var wn=function(){},vs={PI_TIMES_2:{configurable:!0},PI_OVER_2:{configurable:!0},PI_OVER_4:{configurable:!0},COUNTERCLOCKWISE:{configurable:!0},CLOCKWISE:{configurable:!0},NONE:{configurable:!0}};wn.prototype.interfaces_=function(){return[]},wn.prototype.getClass=function(){return wn},wn.toDegrees=function(e){return 180*e/Math.PI},wn.normalize=function(e){for(;e>Math.PI;)e-=wn.PI_TIMES_2;for(;e<=-Math.PI;)e+=wn.PI_TIMES_2;return e},wn.angle=function(){if(1===arguments.length){var e=arguments[0];return Math.atan2(e.y,e.x)}if(2===arguments.length){var n=arguments[0],c=arguments[1];return Math.atan2(c.y-n.y,c.x-n.x)}},wn.isAcute=function(e,n,c){return(e.x-n.x)*(c.x-n.x)+(e.y-n.y)*(c.y-n.y)>0},wn.isObtuse=function(e,n,c){return(e.x-n.x)*(c.x-n.x)+(e.y-n.y)*(c.y-n.y)<0},wn.interiorAngle=function(e,n,c){var f=wn.angle(n,e),x=wn.angle(n,c);return Math.abs(x-f)},wn.normalizePositive=function(e){if(e<0){for(;e<0;)e+=wn.PI_TIMES_2;e>=wn.PI_TIMES_2&&(e=0)}else{for(;e>=wn.PI_TIMES_2;)e-=wn.PI_TIMES_2;e<0&&(e=0)}return e},wn.angleBetween=function(e,n,c){var f=wn.angle(n,e),x=wn.angle(n,c);return wn.diff(f,x)},wn.diff=function(e,n){var c=null;return(c=e<n?n-e:e-n)>Math.PI&&(c=2*Math.PI-c),c},wn.toRadians=function(e){return e*Math.PI/180},wn.getTurn=function(e,n){var c=Math.sin(n-e);return c>0?wn.COUNTERCLOCKWISE:c<0?wn.CLOCKWISE:wn.NONE},wn.angleBetweenOriented=function(e,n,c){var f=wn.angle(n,e),x=wn.angle(n,c)-f;return x<=-Math.PI?x+wn.PI_TIMES_2:x>Math.PI?x-wn.PI_TIMES_2:x},vs.PI_TIMES_2.get=function(){return 2*Math.PI},vs.PI_OVER_2.get=function(){return Math.PI/2},vs.PI_OVER_4.get=function(){return Math.PI/4},vs.COUNTERCLOCKWISE.get=function(){return Re.COUNTERCLOCKWISE},vs.CLOCKWISE.get=function(){return Re.CLOCKWISE},vs.NONE.get=function(){return Re.COLLINEAR},Object.defineProperties(wn,vs);var Ci=function e(){this._maxCurveSegmentError=0,this._filletAngleQuantum=null,this._closingSegLengthFactor=1,this._segList=null,this._distance=0,this._precisionModel=null,this._bufParams=null,this._li=null,this._s0=null,this._s1=null,this._s2=null,this._seg0=new kr,this._seg1=new kr,this._offset0=new kr,this._offset1=new kr,this._side=0,this._hasNarrowConcaveAngle=!1;var c=arguments[1],f=arguments[2];this._precisionModel=arguments[0],this._bufParams=c,this._li=new Ee,this._filletAngleQuantum=Math.PI/2/c.getQuadrantSegments(),c.getQuadrantSegments()>=8&&c.getJoinStyle()===qn.JOIN_ROUND&&(this._closingSegLengthFactor=e.MAX_CLOSING_SEG_LEN_FACTOR),this.init(f)},ku={OFFSET_SEGMENT_SEPARATION_FACTOR:{configurable:!0},INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR:{configurable:!0},CURVE_VERTEX_SNAP_DISTANCE_FACTOR:{configurable:!0},MAX_CLOSING_SEG_LEN_FACTOR:{configurable:!0}};Ci.prototype.addNextSegment=function(e,n){if(this._s0=this._s1,this._s1=this._s2,this._s2=e,this._seg0.setCoordinates(this._s0,this._s1),this.computeOffsetSegment(this._seg0,this._side,this._distance,this._offset0),this._seg1.setCoordinates(this._s1,this._s2),this.computeOffsetSegment(this._seg1,this._side,this._distance,this._offset1),this._s1.equals(this._s2))return null;var c=Re.computeOrientation(this._s0,this._s1,this._s2),f=c===Re.CLOCKWISE&&this._side===$e.LEFT||c===Re.COUNTERCLOCKWISE&&this._side===$e.RIGHT;0===c?this.addCollinear(n):f?this.addOutsideTurn(c,n):this.addInsideTurn(c,n)},Ci.prototype.addLineEndCap=function(e,n){var c=new kr(e,n),f=new kr;this.computeOffsetSegment(c,$e.LEFT,this._distance,f);var x=new kr;this.computeOffsetSegment(c,$e.RIGHT,this._distance,x);var W=Math.atan2(n.y-e.y,n.x-e.x);switch(this._bufParams.getEndCapStyle()){case qn.CAP_ROUND:this._segList.addPt(f.p1),this.addFilletArc(n,W+Math.PI/2,W-Math.PI/2,Re.CLOCKWISE,this._distance),this._segList.addPt(x.p1);break;case qn.CAP_FLAT:this._segList.addPt(f.p1),this._segList.addPt(x.p1);break;case qn.CAP_SQUARE:var gt=new j;gt.x=Math.abs(this._distance)*Math.cos(W),gt.y=Math.abs(this._distance)*Math.sin(W);var Zt=new j(f.p1.x+gt.x,f.p1.y+gt.y),Ie=new j(x.p1.x+gt.x,x.p1.y+gt.y);this._segList.addPt(Zt),this._segList.addPt(Ie)}},Ci.prototype.getCoordinates=function(){return this._segList.getCoordinates()},Ci.prototype.addMitreJoin=function(e,n,c,f){var x=!0,L=null;try{L=Cr.intersection(n.p0,n.p1,c.p0,c.p1),(f<=0?1:L.distance(e)/Math.abs(f))>this._bufParams.getMitreLimit()&&(x=!1)}catch(z){if(!(z instanceof Yr))throw z;L=new j(0,0),x=!1}x?this._segList.addPt(L):this.addLimitedMitreJoin(n,c,f,this._bufParams.getMitreLimit())},Ci.prototype.addFilletCorner=function(e,n,c,f,x){var W=Math.atan2(n.y-e.y,n.x-e.x),Ie=Math.atan2(c.y-e.y,c.x-e.x);f===Re.CLOCKWISE?W<=Ie&&(W+=2*Math.PI):W>=Ie&&(W-=2*Math.PI),this._segList.addPt(n),this.addFilletArc(e,W,Ie,f,x),this._segList.addPt(c)},Ci.prototype.addOutsideTurn=function(e,n){if(this._offset0.p1.distance(this._offset1.p0)<this._distance*Ci.OFFSET_SEGMENT_SEPARATION_FACTOR)return this._segList.addPt(this._offset0.p1),null;this._bufParams.getJoinStyle()===qn.JOIN_MITRE?this.addMitreJoin(this._s1,this._offset0,this._offset1,this._distance):this._bufParams.getJoinStyle()===qn.JOIN_BEVEL?this.addBevelJoin(this._offset0,this._offset1):(n&&this._segList.addPt(this._offset0.p1),this.addFilletCorner(this._s1,this._offset0.p1,this._offset1.p0,e,this._distance),this._segList.addPt(this._offset1.p0))},Ci.prototype.createSquare=function(e){this._segList.addPt(new j(e.x+this._distance,e.y+this._distance)),this._segList.addPt(new j(e.x+this._distance,e.y-this._distance)),this._segList.addPt(new j(e.x-this._distance,e.y-this._distance)),this._segList.addPt(new j(e.x-this._distance,e.y+this._distance)),this._segList.closeRing()},Ci.prototype.addSegments=function(e,n){this._segList.addPts(e,n)},Ci.prototype.addFirstSegment=function(){this._segList.addPt(this._offset1.p0)},Ci.prototype.addLastSegment=function(){this._segList.addPt(this._offset1.p1)},Ci.prototype.initSideSegments=function(e,n,c){this._s1=e,this._s2=n,this._side=c,this._seg1.setCoordinates(e,n),this.computeOffsetSegment(this._seg1,c,this._distance,this._offset1)},Ci.prototype.addLimitedMitreJoin=function(e,n,c,f){var x=this._seg0.p1,L=wn.angle(x,this._seg0.p0),z=wn.angleBetweenOriented(this._seg0.p0,x,this._seg1.p1)/2,W=wn.normalize(L+z),gt=wn.normalize(W+Math.PI),Zt=f*c,Ie=c-Zt*Math.abs(Math.sin(z)),Me=x.x+Zt*Math.cos(gt),tr=x.y+Zt*Math.sin(gt),mr=new j(Me,tr),Ar=new kr(x,mr),Xr=Ar.pointAlongOffset(1,Ie),Wn=Ar.pointAlongOffset(1,-Ie);this._side===$e.LEFT?(this._segList.addPt(Xr),this._segList.addPt(Wn)):(this._segList.addPt(Wn),this._segList.addPt(Xr))},Ci.prototype.computeOffsetSegment=function(e,n,c,f){var x=n===$e.LEFT?1:-1,L=e.p1.x-e.p0.x,z=e.p1.y-e.p0.y,W=Math.sqrt(L*L+z*z),gt=x*c*L/W,Zt=x*c*z/W;f.p0.x=e.p0.x-Zt,f.p0.y=e.p0.y+gt,f.p1.x=e.p1.x-Zt,f.p1.y=e.p1.y+gt},Ci.prototype.addFilletArc=function(e,n,c,f,x){var L=f===Re.CLOCKWISE?-1:1,z=Math.abs(n-c),W=Math.trunc(z/this._filletAngleQuantum+.5);if(W<1)return null;for(var gt=z/W,Zt=0,Ie=new j;Zt<z;){var Me=n+L*Zt;Ie.x=e.x+x*Math.cos(Me),Ie.y=e.y+x*Math.sin(Me),this._segList.addPt(Ie),Zt+=gt}},Ci.prototype.addInsideTurn=function(e,n){if(this._li.computeIntersection(this._offset0.p0,this._offset0.p1,this._offset1.p0,this._offset1.p1),this._li.hasIntersection())this._segList.addPt(this._li.getIntersection(0));else if(this._hasNarrowConcaveAngle=!0,this._offset0.p1.distance(this._offset1.p0)<this._distance*Ci.INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR)this._segList.addPt(this._offset0.p1);else{if(this._segList.addPt(this._offset0.p1),this._closingSegLengthFactor>0){var c=new j((this._closingSegLengthFactor*this._offset0.p1.x+this._s1.x)/(this._closingSegLengthFactor+1),(this._closingSegLengthFactor*this._offset0.p1.y+this._s1.y)/(this._closingSegLengthFactor+1));this._segList.addPt(c);var f=new j((this._closingSegLengthFactor*this._offset1.p0.x+this._s1.x)/(this._closingSegLengthFactor+1),(this._closingSegLengthFactor*this._offset1.p0.y+this._s1.y)/(this._closingSegLengthFactor+1));this._segList.addPt(f)}else this._segList.addPt(this._s1);this._segList.addPt(this._offset1.p0)}},Ci.prototype.createCircle=function(e){var n=new j(e.x+this._distance,e.y);this._segList.addPt(n),this.addFilletArc(e,0,2*Math.PI,-1,this._distance),this._segList.closeRing()},Ci.prototype.addBevelJoin=function(e,n){this._segList.addPt(e.p1),this._segList.addPt(n.p0)},Ci.prototype.init=function(e){this._distance=e,this._maxCurveSegmentError=e*(1-Math.cos(this._filletAngleQuantum/2)),this._segList=new Ia,this._segList.setPrecisionModel(this._precisionModel),this._segList.setMinimumVertexDistance(e*Ci.CURVE_VERTEX_SNAP_DISTANCE_FACTOR)},Ci.prototype.addCollinear=function(e){this._li.computeIntersection(this._s0,this._s1,this._s1,this._s2),this._li.getIntersectionNum()>=2&&(this._bufParams.getJoinStyle()===qn.JOIN_BEVEL||this._bufParams.getJoinStyle()===qn.JOIN_MITRE?(e&&this._segList.addPt(this._offset0.p1),this._segList.addPt(this._offset1.p0)):this.addFilletCorner(this._s1,this._offset0.p1,this._offset1.p0,Re.CLOCKWISE,this._distance))},Ci.prototype.closeRing=function(){this._segList.closeRing()},Ci.prototype.hasNarrowConcaveAngle=function(){return this._hasNarrowConcaveAngle},Ci.prototype.interfaces_=function(){return[]},Ci.prototype.getClass=function(){return Ci},ku.OFFSET_SEGMENT_SEPARATION_FACTOR.get=function(){return.001},ku.INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR.get=function(){return.001},ku.CURVE_VERTEX_SNAP_DISTANCE_FACTOR.get=function(){return 1e-6},ku.MAX_CLOSING_SEG_LEN_FACTOR.get=function(){return 80},Object.defineProperties(Ci,ku);var Bo=function(){this._distance=0,this._precisionModel=null,this._bufParams=null;var n=arguments[1];this._precisionModel=arguments[0],this._bufParams=n};Bo.prototype.getOffsetCurve=function(e,n){if(this._distance=n,0===n)return null;var c=n<0,f=Math.abs(n),x=this.getSegGen(f);e.length<=1?this.computePointCurve(e[0],x):this.computeOffsetCurve(e,c,x);var L=x.getCoordinates();return c&&Y.reverse(L),L},Bo.prototype.computeSingleSidedBufferCurve=function(e,n,c){var f=this.simplifyTolerance(this._distance);if(n){c.addSegments(e,!0);var x=Ni.simplify(e,-f),L=x.length-1;c.initSideSegments(x[L],x[L-1],$e.LEFT),c.addFirstSegment();for(var z=L-2;z>=0;z--)c.addNextSegment(x[z],!0)}else{c.addSegments(e,!1);var W=Ni.simplify(e,f),gt=W.length-1;c.initSideSegments(W[0],W[1],$e.LEFT),c.addFirstSegment();for(var Zt=2;Zt<=gt;Zt++)c.addNextSegment(W[Zt],!0)}c.addLastSegment(),c.closeRing()},Bo.prototype.computeRingBufferCurve=function(e,n,c){var f=this.simplifyTolerance(this._distance);n===$e.RIGHT&&(f=-f);var x=Ni.simplify(e,f),L=x.length-1;c.initSideSegments(x[L-1],x[0],n);for(var z=1;z<=L;z++)c.addNextSegment(x[z],1!==z);c.closeRing()},Bo.prototype.computeLineBufferCurve=function(e,n){var c=this.simplifyTolerance(this._distance),f=Ni.simplify(e,c),x=f.length-1;n.initSideSegments(f[0],f[1],$e.LEFT);for(var L=2;L<=x;L++)n.addNextSegment(f[L],!0);n.addLastSegment(),n.addLineEndCap(f[x-1],f[x]);var z=Ni.simplify(e,-c),W=z.length-1;n.initSideSegments(z[W],z[W-1],$e.LEFT);for(var gt=W-2;gt>=0;gt--)n.addNextSegment(z[gt],!0);n.addLastSegment(),n.addLineEndCap(z[1],z[0]),n.closeRing()},Bo.prototype.computePointCurve=function(e,n){switch(this._bufParams.getEndCapStyle()){case qn.CAP_ROUND:n.createCircle(e);break;case qn.CAP_SQUARE:n.createSquare(e)}},Bo.prototype.getLineCurve=function(e,n){if(this._distance=n,n<0&&!this._bufParams.isSingleSided()||0===n)return null;var c=Math.abs(n),f=this.getSegGen(c);return e.length<=1?this.computePointCurve(e[0],f):this._bufParams.isSingleSided()?this.computeSingleSidedBufferCurve(e,n<0,f):this.computeLineBufferCurve(e,f),f.getCoordinates()},Bo.prototype.getBufferParameters=function(){return this._bufParams},Bo.prototype.simplifyTolerance=function(e){return e*this._bufParams.getSimplifyFactor()},Bo.prototype.getRingCurve=function(e,n,c){if(this._distance=c,e.length<=2)return this.getLineCurve(e,c);if(0===c)return Bo.copyCoordinates(e);var f=this.getSegGen(c);return this.computeRingBufferCurve(e,n,f),f.getCoordinates()},Bo.prototype.computeOffsetCurve=function(e,n,c){var f=this.simplifyTolerance(this._distance);if(n){var x=Ni.simplify(e,-f),L=x.length-1;c.initSideSegments(x[L],x[L-1],$e.LEFT),c.addFirstSegment();for(var z=L-2;z>=0;z--)c.addNextSegment(x[z],!0)}else{var W=Ni.simplify(e,f),gt=W.length-1;c.initSideSegments(W[0],W[1],$e.LEFT),c.addFirstSegment();for(var Zt=2;Zt<=gt;Zt++)c.addNextSegment(W[Zt],!0)}c.addLastSegment()},Bo.prototype.getSegGen=function(e){return new Ci(this._precisionModel,this._bufParams,e)},Bo.prototype.interfaces_=function(){return[]},Bo.prototype.getClass=function(){return Bo},Bo.copyCoordinates=function(e){for(var n=new Array(e.length).fill(null),c=0;c<n.length;c++)n[c]=new j(e[c]);return n};var Xa=function(){this._subgraphs=null,this._seg=new kr,this._cga=new Re,this._subgraphs=arguments[0]},_l={DepthSegment:{configurable:!0}};Xa.prototype.findStabbedSegments=function(){if(1===arguments.length){for(var e=arguments[0],n=new Je,c=this._subgraphs.iterator();c.hasNext();){var f=c.next(),x=f.getEnvelope();e.y<x.getMinY()||e.y>x.getMaxY()||this.findStabbedSegments(e,f.getDirectedEdges(),n)}return n}if(3===arguments.length)if(Te(arguments[2],Oi)&&arguments[0]instanceof j&&arguments[1]instanceof Bs){for(var L=arguments[0],z=arguments[1],W=arguments[2],gt=z.getEdge().getCoordinates(),Zt=0;Zt<gt.length-1;Zt++)if(this._seg.p0=gt[Zt],this._seg.p1=gt[Zt+1],this._seg.p0.y>this._seg.p1.y&&this._seg.reverse(),!(Math.max(this._seg.p0.x,this._seg.p1.x)<L.x||this._seg.isHorizontal()||L.y<this._seg.p0.y||L.y>this._seg.p1.y||Re.computeOrientation(this._seg.p0,this._seg.p1,L)===Re.RIGHT)){var Ie=z.getDepth($e.LEFT);this._seg.p0.equals(gt[Zt])||(Ie=z.getDepth($e.RIGHT));var Me=new Ya(this._seg,Ie);W.add(Me)}}else if(Te(arguments[2],Oi)&&arguments[0]instanceof j&&Te(arguments[1],Oi))for(var tr=arguments[0],Ar=arguments[2],Xr=arguments[1].iterator();Xr.hasNext();){var Wn=Xr.next();Wn.isForward()&&this.findStabbedSegments(tr,Wn,Ar)}},Xa.prototype.getDepth=function(e){var n=this.findStabbedSegments(e);return 0===n.size()?0:fa.min(n)._leftDepth},Xa.prototype.interfaces_=function(){return[]},Xa.prototype.getClass=function(){return Xa},_l.DepthSegment.get=function(){return Ya},Object.defineProperties(Xa,_l);var Ya=function(){this._upwardSeg=null,this._leftDepth=null;var n=arguments[1];this._upwardSeg=new kr(arguments[0]),this._leftDepth=n};Ya.prototype.compareTo=function(e){var n=e;if(this._upwardSeg.minX()>=n._upwardSeg.maxX())return 1;if(this._upwardSeg.maxX()<=n._upwardSeg.minX())return-1;var c=this._upwardSeg.orientationIndex(n._upwardSeg);return 0!==c||0!=(c=-1*n._upwardSeg.orientationIndex(this._upwardSeg))?c:this._upwardSeg.compareTo(n._upwardSeg)},Ya.prototype.compareX=function(e,n){var c=e.p0.compareTo(n.p0);return 0!==c?c:e.p1.compareTo(n.p1)},Ya.prototype.toString=function(){return this._upwardSeg.toString()},Ya.prototype.interfaces_=function(){return[Q]},Ya.prototype.getClass=function(){return Ya};var kn=function(e,n,c){this.p0=e||null,this.p1=n||null,this.p2=c||null};kn.prototype.area=function(){return kn.area(this.p0,this.p1,this.p2)},kn.prototype.signedArea=function(){return kn.signedArea(this.p0,this.p1,this.p2)},kn.prototype.interpolateZ=function(e){if(null===e)throw new J("Supplied point is null.");return kn.interpolateZ(e,this.p0,this.p1,this.p2)},kn.prototype.longestSideLength=function(){return kn.longestSideLength(this.p0,this.p1,this.p2)},kn.prototype.isAcute=function(){return kn.isAcute(this.p0,this.p1,this.p2)},kn.prototype.circumcentre=function(){return kn.circumcentre(this.p0,this.p1,this.p2)},kn.prototype.area3D=function(){return kn.area3D(this.p0,this.p1,this.p2)},kn.prototype.centroid=function(){return kn.centroid(this.p0,this.p1,this.p2)},kn.prototype.inCentre=function(){return kn.inCentre(this.p0,this.p1,this.p2)},kn.prototype.interfaces_=function(){return[]},kn.prototype.getClass=function(){return kn},kn.area=function(e,n,c){return Math.abs(((c.x-e.x)*(n.y-e.y)-(n.x-e.x)*(c.y-e.y))/2)},kn.signedArea=function(e,n,c){return((c.x-e.x)*(n.y-e.y)-(n.x-e.x)*(c.y-e.y))/2},kn.det=function(e,n,c,f){return e*f-n*c},kn.interpolateZ=function(e,n,c,f){var x=n.x,L=n.y,z=c.x-x,W=f.x-x,gt=c.y-L,Zt=f.y-L,Ie=z*Zt-W*gt,Me=e.x-x,tr=e.y-L;return n.z+(Zt*Me-W*tr)/Ie*(c.z-n.z)+(-gt*Me+z*tr)/Ie*(f.z-n.z)},kn.longestSideLength=function(e,n,c){var f=e.distance(n),x=n.distance(c),L=c.distance(e),z=f;return x>z&&(z=x),L>z&&(z=L),z},kn.isAcute=function(e,n,c){return!!wn.isAcute(e,n,c)&&!!wn.isAcute(n,c,e)&&!!wn.isAcute(c,e,n)},kn.circumcentre=function(e,n,c){var f=c.x,x=c.y,L=e.x-f,z=e.y-x,W=n.x-f,gt=n.y-x,Zt=2*kn.det(L,z,W,gt),Ie=kn.det(z,L*L+z*z,gt,W*W+gt*gt),Me=kn.det(L,L*L+z*z,W,W*W+gt*gt);return new j(f-Ie/Zt,x+Me/Zt)},kn.perpendicularBisector=function(e,n){var c=n.x-e.x,f=n.y-e.y,x=new Cr(e.x+c/2,e.y+f/2,1),L=new Cr(e.x-f+c/2,e.y+c+f/2,1);return new Cr(x,L)},kn.angleBisector=function(e,n,c){var f=n.distance(e),x=f/(f+n.distance(c));return new j(e.x+x*(c.x-e.x),e.y+x*(c.y-e.y))},kn.area3D=function(e,n,c){var f=n.x-e.x,x=n.y-e.y,L=n.z-e.z,z=c.x-e.x,W=c.y-e.y,gt=c.z-e.z,Zt=x*gt-L*W,Ie=L*z-f*gt,Me=f*W-x*z;return Math.sqrt(Zt*Zt+Ie*Ie+Me*Me)/2},kn.centroid=function(e,n,c){return new j((e.x+n.x+c.x)/3,(e.y+n.y+c.y)/3)},kn.inCentre=function(e,n,c){var f=n.distance(c),x=e.distance(c),L=e.distance(n),z=f+x+L;return new j((f*e.x+x*n.x+L*c.x)/z,(f*e.y+x*n.y+L*c.y)/z)};var da=function(){this._inputGeom=null,this._distance=null,this._curveBuilder=null,this._curveList=new Je;var n=arguments[1],c=arguments[2];this._inputGeom=arguments[0],this._distance=n,this._curveBuilder=c};da.prototype.addPoint=function(e){if(this._distance<=0)return null;var n=e.getCoordinates(),c=this._curveBuilder.getLineCurve(n,this._distance);this.addCurve(c,ct.EXTERIOR,ct.INTERIOR)},da.prototype.addPolygon=function(e){var n=this._distance,c=$e.LEFT;this._distance<0&&(n=-this._distance,c=$e.RIGHT);var f=e.getExteriorRing(),x=Y.removeRepeatedPoints(f.getCoordinates());if(this._distance<0&&this.isErodedCompletely(f,this._distance)||this._distance<=0&&x.length<3)return null;this.addPolygonRing(x,n,c,ct.EXTERIOR,ct.INTERIOR);for(var L=0;L<e.getNumInteriorRing();L++){var z=e.getInteriorRingN(L),W=Y.removeRepeatedPoints(z.getCoordinates());this._distance>0&&this.isErodedCompletely(z,-this._distance)||this.addPolygonRing(W,n,$e.opposite(c),ct.INTERIOR,ct.EXTERIOR)}},da.prototype.isTriangleErodedCompletely=function(e,n){var c=new kn(e[0],e[1],e[2]),f=c.inCentre();return Re.distancePointLine(f,c.p0,c.p1)<Math.abs(n)},da.prototype.addLineString=function(e){if(this._distance<=0&&!this._curveBuilder.getBufferParameters().isSingleSided())return null;var n=Y.removeRepeatedPoints(e.getCoordinates()),c=this._curveBuilder.getLineCurve(n,this._distance);this.addCurve(c,ct.EXTERIOR,ct.INTERIOR)},da.prototype.addCurve=function(e,n,c){if(null===e||e.length<2)return null;var f=new wi(e,new Yn(0,ct.BOUNDARY,n,c));this._curveList.add(f)},da.prototype.getCurves=function(){return this.add(this._inputGeom),this._curveList},da.prototype.addPolygonRing=function(e,n,c,f,x){if(0===n&&e.length<zn.MINIMUM_VALID_SIZE)return null;var L=f,z=x;e.length>=zn.MINIMUM_VALID_SIZE&&Re.isCCW(e)&&(L=x,z=f,c=$e.opposite(c));var W=this._curveBuilder.getRingCurve(e,c,n);this.addCurve(W,L,z)},da.prototype.add=function(e){if(e.isEmpty())return null;e instanceof ln?this.addPolygon(e):e instanceof zr?this.addLineString(e):e instanceof Tn?this.addPoint(e):(e instanceof xi||e instanceof sr||e instanceof un||e instanceof De)&&this.addCollection(e)},da.prototype.isErodedCompletely=function(e,n){var c=e.getCoordinates();if(c.length<4)return n<0;if(4===c.length)return this.isTriangleErodedCompletely(c,n);var f=e.getEnvelopeInternal(),x=Math.min(f.getHeight(),f.getWidth());return n<0&&2*Math.abs(n)>x},da.prototype.addCollection=function(e){for(var n=0;n<e.getNumGeometries();n++){var c=e.getGeometryN(n);this.add(c)}},da.prototype.interfaces_=function(){return[]},da.prototype.getClass=function(){return da};var hu=function(){};hu.prototype.locate=function(e){},hu.prototype.interfaces_=function(){return[]},hu.prototype.getClass=function(){return hu};var Gn=function(){this._parent=null,this._atStart=null,this._max=null,this._index=null,this._subcollectionIterator=null;var e=arguments[0];this._parent=e,this._atStart=!0,this._index=0,this._max=e.getNumGeometries()};Gn.prototype.next=function(){if(this._atStart)return this._atStart=!1,Gn.isAtomic(this._parent)&&this._index++,this._parent;if(null!==this._subcollectionIterator){if(this._subcollectionIterator.hasNext())return this._subcollectionIterator.next();this._subcollectionIterator=null}if(this._index>=this._max)throw new y;var e=this._parent.getGeometryN(this._index++);return e instanceof De?(this._subcollectionIterator=new Gn(e),this._subcollectionIterator.next()):e},Gn.prototype.remove=function(){throw new Error(this.getClass().getName())},Gn.prototype.hasNext=function(){if(this._atStart)return!0;if(null!==this._subcollectionIterator){if(this._subcollectionIterator.hasNext())return!0;this._subcollectionIterator=null}return!(this._index>=this._max)},Gn.prototype.interfaces_=function(){return[go]},Gn.prototype.getClass=function(){return Gn},Gn.isAtomic=function(e){return!(e instanceof De)};var Ho=function(){this._geom=null,this._geom=arguments[0]};Ho.prototype.locate=function(e){return Ho.locate(e,this._geom)},Ho.prototype.interfaces_=function(){return[hu]},Ho.prototype.getClass=function(){return Ho},Ho.isPointInRing=function(e,n){return!!n.getEnvelopeInternal().intersects(e)&&Re.isPointInRing(e,n.getCoordinates())},Ho.containsPointInPolygon=function(e,n){if(n.isEmpty())return!1;var c=n.getExteriorRing();if(!Ho.isPointInRing(e,c))return!1;for(var f=0;f<n.getNumInteriorRing();f++){var x=n.getInteriorRingN(f);if(Ho.isPointInRing(e,x))return!1}return!0},Ho.containsPoint=function(e,n){if(n instanceof ln)return Ho.containsPointInPolygon(e,n);if(n instanceof De)for(var c=new Gn(n);c.hasNext();){var f=c.next();if(f!==n&&Ho.containsPoint(e,f))return!0}return!1},Ho.locate=function(e,n){return n.isEmpty()?ct.EXTERIOR:Ho.containsPoint(e,n)?ct.INTERIOR:ct.EXTERIOR};var Uo=function(){this._edgeMap=new ve,this._edgeList=null,this._ptInAreaLocation=[ct.NONE,ct.NONE]};Uo.prototype.getNextCW=function(e){this.getEdges();var n=this._edgeList.indexOf(e),c=n-1;return 0===n&&(c=this._edgeList.size()-1),this._edgeList.get(c)},Uo.prototype.propagateSideLabels=function(e){for(var n=ct.NONE,c=this.iterator();c.hasNext();){var f=c.next().getLabel();f.isArea(e)&&f.getLocation(e,$e.LEFT)!==ct.NONE&&(n=f.getLocation(e,$e.LEFT))}if(n===ct.NONE)return null;for(var x=n,L=this.iterator();L.hasNext();){var z=L.next(),W=z.getLabel();if(W.getLocation(e,$e.ON)===ct.NONE&&W.setLocation(e,$e.ON,x),W.isArea(e)){var gt=W.getLocation(e,$e.LEFT),Zt=W.getLocation(e,$e.RIGHT);if(Zt!==ct.NONE){if(Zt!==x)throw new Fs("side location conflict",z.getCoordinate());gt===ct.NONE&&tt.shouldNeverReachHere("found single null side (at "+z.getCoordinate()+")"),x=gt}else tt.isTrue(W.getLocation(e,$e.LEFT)===ct.NONE,"found single null side"),W.setLocation(e,$e.RIGHT,x),W.setLocation(e,$e.LEFT,x)}}},Uo.prototype.getCoordinate=function(){var e=this.iterator();return e.hasNext()?e.next().getCoordinate():null},Uo.prototype.print=function(e){Sr.out.println("EdgeEndStar:   "+this.getCoordinate());for(var n=this.iterator();n.hasNext();)n.next().print(e)},Uo.prototype.isAreaLabelsConsistent=function(e){return this.computeEdgeEndLabels(e.getBoundaryNodeRule()),this.checkAreaLabelsConsistent(0)},Uo.prototype.checkAreaLabelsConsistent=function(e){var n=this.getEdges();if(n.size()<=0)return!0;var c=n.size()-1,f=n.get(c).getLabel().getLocation(e,$e.LEFT);tt.isTrue(f!==ct.NONE,"Found unlabelled area edge");for(var x=f,L=this.iterator();L.hasNext();){var z=L.next().getLabel();tt.isTrue(z.isArea(e),"Found non-area edge");var W=z.getLocation(e,$e.LEFT),gt=z.getLocation(e,$e.RIGHT);if(W===gt||gt!==x)return!1;x=W}return!0},Uo.prototype.findIndex=function(e){this.iterator();for(var n=0;n<this._edgeList.size();n++)if(this._edgeList.get(n)===e)return n;return-1},Uo.prototype.iterator=function(){return this.getEdges().iterator()},Uo.prototype.getEdges=function(){return null===this._edgeList&&(this._edgeList=new Je(this._edgeMap.values())),this._edgeList},Uo.prototype.getLocation=function(e,n,c){return this._ptInAreaLocation[e]===ct.NONE&&(this._ptInAreaLocation[e]=Ho.locate(n,c[e].getGeometry())),this._ptInAreaLocation[e]},Uo.prototype.toString=function(){var e=new Tt;e.append("EdgeEndStar:   "+this.getCoordinate()),e.append("\n");for(var n=this.iterator();n.hasNext();){var c=n.next();e.append(c),e.append("\n")}return e.toString()},Uo.prototype.computeEdgeEndLabels=function(e){for(var n=this.iterator();n.hasNext();)n.next().computeLabel(e)},Uo.prototype.computeLabelling=function(e){this.computeEdgeEndLabels(e[0].getBoundaryNodeRule()),this.propagateSideLabels(0),this.propagateSideLabels(1);for(var n=[!1,!1],c=this.iterator();c.hasNext();)for(var f=c.next().getLabel(),x=0;x<2;x++)f.isLine(x)&&f.getLocation(x)===ct.BOUNDARY&&(n[x]=!0);for(var L=this.iterator();L.hasNext();)for(var z=L.next(),W=z.getLabel(),gt=0;gt<2;gt++)if(W.isAnyNull(gt)){var Zt=ct.NONE;if(n[gt])Zt=ct.EXTERIOR;else{var Ie=z.getCoordinate();Zt=this.getLocation(gt,Ie,e)}W.setAllLocationsIfNull(gt,Zt)}},Uo.prototype.getDegree=function(){return this._edgeMap.size()},Uo.prototype.insertEdgeEnd=function(e,n){this._edgeMap.put(e,n),this._edgeList=null},Uo.prototype.interfaces_=function(){return[]},Uo.prototype.getClass=function(){return Uo};var zu=function(e){function n(){e.call(this),this._resultAreaEdgeList=null,this._label=null,this._SCANNING_FOR_INCOMING=1,this._LINKING_TO_OUTGOING=2}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype.linkResultDirectedEdges=function(){this.getResultAreaEdges();for(var c=null,f=null,x=this._SCANNING_FOR_INCOMING,L=0;L<this._resultAreaEdgeList.size();L++){var z=this._resultAreaEdgeList.get(L),W=z.getSym();if(z.getLabel().isArea())switch(null===c&&z.isInResult()&&(c=z),x){case this._SCANNING_FOR_INCOMING:if(!W.isInResult())continue;f=W,x=this._LINKING_TO_OUTGOING;break;case this._LINKING_TO_OUTGOING:if(!z.isInResult())continue;f.setNext(z),x=this._SCANNING_FOR_INCOMING}}if(x===this._LINKING_TO_OUTGOING){if(null===c)throw new Fs("no outgoing dirEdge found",this.getCoordinate());tt.isTrue(c.isInResult(),"unable to link last incoming dirEdge"),f.setNext(c)}},n.prototype.insert=function(c){this.insertEdgeEnd(c,c)},n.prototype.getRightmostEdge=function(){var c=this.getEdges(),f=c.size();if(f<1)return null;var x=c.get(0);if(1===f)return x;var L=c.get(f-1),z=x.getQuadrant(),W=L.getQuadrant();return ni.isNorthern(z)&&ni.isNorthern(W)?x:ni.isNorthern(z)||ni.isNorthern(W)?0!==x.getDy()?x:0!==L.getDy()?L:(tt.shouldNeverReachHere("found two horizontal edges incident on node"),null):L},n.prototype.print=function(c){Sr.out.println("DirectedEdgeStar: "+this.getCoordinate());for(var f=this.iterator();f.hasNext();){var x=f.next();c.print("out "),x.print(c),c.println(),c.print("in "),x.getSym().print(c),c.println()}},n.prototype.getResultAreaEdges=function(){if(null!==this._resultAreaEdgeList)return this._resultAreaEdgeList;this._resultAreaEdgeList=new Je;for(var c=this.iterator();c.hasNext();){var f=c.next();(f.isInResult()||f.getSym().isInResult())&&this._resultAreaEdgeList.add(f)}return this._resultAreaEdgeList},n.prototype.updateLabelling=function(c){for(var f=this.iterator();f.hasNext();){var x=f.next().getLabel();x.setAllLocationsIfNull(0,c.getLocation(0)),x.setAllLocationsIfNull(1,c.getLocation(1))}},n.prototype.linkAllDirectedEdges=function(){this.getEdges();for(var c=null,f=null,x=this._edgeList.size()-1;x>=0;x--){var L=this._edgeList.get(x),z=L.getSym();null===f&&(f=z),null!==c&&z.setNext(c),c=L}f.setNext(c)},n.prototype.computeDepths=function(){if(1===arguments.length){var c=arguments[0],f=this.findIndex(c),x=c.getDepth($e.LEFT),L=c.getDepth($e.RIGHT),z=this.computeDepths(f+1,this._edgeList.size(),x);if(this.computeDepths(0,f,z)!==L)throw new Fs("depth mismatch at "+c.getCoordinate())}else if(3===arguments.length){for(var gt=arguments[1],Zt=arguments[2],Ie=arguments[0];Ie<gt;Ie++){var Me=this._edgeList.get(Ie);Me.setEdgeDepths($e.RIGHT,Zt),Zt=Me.getDepth($e.LEFT)}return Zt}},n.prototype.mergeSymLabels=function(){for(var c=this.iterator();c.hasNext();){var f=c.next();f.getLabel().merge(f.getSym().getLabel())}},n.prototype.linkMinimalDirectedEdges=function(c){for(var f=null,x=null,L=this._SCANNING_FOR_INCOMING,z=this._resultAreaEdgeList.size()-1;z>=0;z--){var W=this._resultAreaEdgeList.get(z),gt=W.getSym();switch(null===f&&W.getEdgeRing()===c&&(f=W),L){case this._SCANNING_FOR_INCOMING:if(gt.getEdgeRing()!==c)continue;x=gt,L=this._LINKING_TO_OUTGOING;break;case this._LINKING_TO_OUTGOING:if(W.getEdgeRing()!==c)continue;x.setNextMin(W),L=this._SCANNING_FOR_INCOMING}}L===this._LINKING_TO_OUTGOING&&(tt.isTrue(null!==f,"found null for first outgoing dirEdge"),tt.isTrue(f.getEdgeRing()===c,"unable to link last incoming dirEdge"),x.setNextMin(f))},n.prototype.getOutgoingDegree=function(){if(0===arguments.length){for(var c=0,f=this.iterator();f.hasNext();)f.next().isInResult()&&c++;return c}if(1===arguments.length){for(var x=arguments[0],L=0,z=this.iterator();z.hasNext();)z.next().getEdgeRing()===x&&L++;return L}},n.prototype.getLabel=function(){return this._label},n.prototype.findCoveredLineEdges=function(){for(var c=ct.NONE,f=this.iterator();f.hasNext();){var x=f.next(),L=x.getSym();if(!x.isLineEdge()){if(x.isInResult()){c=ct.INTERIOR;break}if(L.isInResult()){c=ct.EXTERIOR;break}}}if(c===ct.NONE)return null;for(var z=c,W=this.iterator();W.hasNext();){var gt=W.next(),Zt=gt.getSym();gt.isLineEdge()?gt.getEdge().setCovered(z===ct.INTERIOR):(gt.isInResult()&&(z=ct.EXTERIOR),Zt.isInResult()&&(z=ct.INTERIOR))}},n.prototype.computeLabelling=function(c){e.prototype.computeLabelling.call(this,c),this._label=new Yn(ct.NONE);for(var f=this.iterator();f.hasNext();)for(var x=f.next().getEdge().getLabel(),L=0;L<2;L++){var z=x.getLocation(L);z!==ct.INTERIOR&&z!==ct.BOUNDARY||this._label.setLocation(L,ct.INTERIOR)}},n.prototype.interfaces_=function(){return[]},n.prototype.getClass=function(){return n},n}(Uo),pc=function(e){function n(){e.apply(this,arguments)}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype.createNode=function(c){return new Nu(c,new zu)},n.prototype.interfaces_=function(){return[]},n.prototype.getClass=function(){return n},n}(js),Hs=function e(){this._pts=null,this._orientation=null;var n=arguments[0];this._pts=n,this._orientation=e.orientation(n)};Hs.prototype.compareTo=function(e){return Hs.compareOriented(this._pts,this._orientation,e._pts,e._orientation)},Hs.prototype.interfaces_=function(){return[Q]},Hs.prototype.getClass=function(){return Hs},Hs.orientation=function(e){return 1===Y.increasingDirection(e)},Hs.compareOriented=function(e,n,c,f){for(var x=n?1:-1,L=f?1:-1,z=n?e.length:-1,W=f?c.length:-1,gt=n?0:e.length-1,Zt=f?0:c.length-1;;){var Ie=e[gt].compareTo(c[Zt]);if(0!==Ie)return Ie;var Me=(gt+=x)===z,tr=(Zt+=L)===W;if(Me&&!tr)return-1;if(!Me&&tr)return 1;if(Me&&tr)return 0}};var ga=function(){this._edges=new Je,this._ocaMap=new ve};ga.prototype.print=function(e){e.print("MULTILINESTRING ( ");for(var n=0;n<this._edges.size();n++){var c=this._edges.get(n);n>0&&e.print(","),e.print("(");for(var f=c.getCoordinates(),x=0;x<f.length;x++)x>0&&e.print(","),e.print(f[x].x+" "+f[x].y);e.println(")")}e.print(")  ")},ga.prototype.addAll=function(e){for(var n=e.iterator();n.hasNext();)this.add(n.next())},ga.prototype.findEdgeIndex=function(e){for(var n=0;n<this._edges.size();n++)if(this._edges.get(n).equals(e))return n;return-1},ga.prototype.iterator=function(){return this._edges.iterator()},ga.prototype.getEdges=function(){return this._edges},ga.prototype.get=function(e){return this._edges.get(e)},ga.prototype.findEqualEdge=function(e){var n=new Hs(e.getCoordinates());return this._ocaMap.get(n)},ga.prototype.add=function(e){this._edges.add(e);var n=new Hs(e.getCoordinates());this._ocaMap.put(n,e)},ga.prototype.interfaces_=function(){return[]},ga.prototype.getClass=function(){return ga};var Js=function(){};Js.prototype.processIntersections=function(e,n,c,f){},Js.prototype.isDone=function(){},Js.prototype.interfaces_=function(){return[]},Js.prototype.getClass=function(){return Js};var qo=function(){this._hasIntersection=!1,this._hasProper=!1,this._hasProperInterior=!1,this._hasInterior=!1,this._properIntersectionPoint=null,this._li=null,this._isSelfIntersection=null,this.numIntersections=0,this.numInteriorIntersections=0,this.numProperIntersections=0,this.numTests=0,this._li=arguments[0]};qo.prototype.isTrivialIntersection=function(e,n,c,f){if(e===c&&1===this._li.getIntersectionNum()){if(qo.isAdjacentSegments(n,f))return!0;if(e.isClosed()){var x=e.size()-1;if(0===n&&f===x||0===f&&n===x)return!0}}return!1},qo.prototype.getProperIntersectionPoint=function(){return this._properIntersectionPoint},qo.prototype.hasProperInteriorIntersection=function(){return this._hasProperInterior},qo.prototype.getLineIntersector=function(){return this._li},qo.prototype.hasProperIntersection=function(){return this._hasProper},qo.prototype.processIntersections=function(e,n,c,f){if(e===c&&n===f)return null;this.numTests++;var x=e.getCoordinates()[n],L=e.getCoordinates()[n+1],z=c.getCoordinates()[f],W=c.getCoordinates()[f+1];this._li.computeIntersection(x,L,z,W),this._li.hasIntersection()&&(this.numIntersections++,this._li.isInteriorIntersection()&&(this.numInteriorIntersections++,this._hasInterior=!0),this.isTrivialIntersection(e,n,c,f)||(this._hasIntersection=!0,e.addIntersections(this._li,n,0),c.addIntersections(this._li,f,1),this._li.isProper()&&(this.numProperIntersections++,this._hasProper=!0,this._hasProperInterior=!0)))},qo.prototype.hasIntersection=function(){return this._hasIntersection},qo.prototype.isDone=function(){return!1},qo.prototype.hasInteriorIntersection=function(){return this._hasInterior},qo.prototype.interfaces_=function(){return[Js]},qo.prototype.getClass=function(){return qo},qo.isAdjacentSegments=function(e,n){return 1===Math.abs(e-n)};var ma=function(){this.coord=null,this.segmentIndex=null,this.dist=null;var n=arguments[1],c=arguments[2];this.coord=new j(arguments[0]),this.segmentIndex=n,this.dist=c};ma.prototype.getSegmentIndex=function(){return this.segmentIndex},ma.prototype.getCoordinate=function(){return this.coord},ma.prototype.print=function(e){e.print(this.coord),e.print(" seg # = "+this.segmentIndex),e.println(" dist = "+this.dist)},ma.prototype.compareTo=function(e){return this.compare(e.segmentIndex,e.dist)},ma.prototype.isEndPoint=function(e){return 0===this.segmentIndex&&0===this.dist||this.segmentIndex===e},ma.prototype.toString=function(){return this.coord+" seg # = "+this.segmentIndex+" dist = "+this.dist},ma.prototype.getDistance=function(){return this.dist},ma.prototype.compare=function(e,n){return this.segmentIndex<e?-1:this.segmentIndex>e?1:this.dist<n?-1:this.dist>n?1:0},ma.prototype.interfaces_=function(){return[Q]},ma.prototype.getClass=function(){return ma};var za=function(){this._nodeMap=new ve,this.edge=null,this.edge=arguments[0]};za.prototype.print=function(e){e.println("Intersections:");for(var n=this.iterator();n.hasNext();)n.next().print(e)},za.prototype.iterator=function(){return this._nodeMap.values().iterator()},za.prototype.addSplitEdges=function(e){this.addEndpoints();for(var n=this.iterator(),c=n.next();n.hasNext();){var f=n.next(),x=this.createSplitEdge(c,f);e.add(x),c=f}},za.prototype.addEndpoints=function(){var e=this.edge.pts.length-1;this.add(this.edge.pts[0],0,0),this.add(this.edge.pts[e],e,0)},za.prototype.createSplitEdge=function(e,n){var c=n.segmentIndex-e.segmentIndex+2,x=n.dist>0||!n.coord.equals2D(this.edge.pts[n.segmentIndex]);x||c--;var L=new Array(c).fill(null),z=0;L[z++]=new j(e.coord);for(var W=e.segmentIndex+1;W<=n.segmentIndex;W++)L[z++]=this.edge.pts[W];return x&&(L[z]=n.coord),new Wa(L,new Yn(this.edge._label))},za.prototype.add=function(e,n,c){var f=new ma(e,n,c),x=this._nodeMap.get(f);return null!==x?x:(this._nodeMap.put(f,f),f)},za.prototype.isIntersection=function(e){for(var n=this.iterator();n.hasNext();)if(n.next().coord.equals(e))return!0;return!1},za.prototype.interfaces_=function(){return[]},za.prototype.getClass=function(){return za};var _s=function(){};_s.prototype.getChainStartIndices=function(e){var n=0,c=new Je;c.add(new Ht(n));do{var f=this.findChainEnd(e,n);c.add(new Ht(f)),n=f}while(n<e.length-1);return _s.toIntArray(c)},_s.prototype.findChainEnd=function(e,n){for(var c=ni.quadrant(e[n],e[n+1]),f=n+1;f<e.length&&ni.quadrant(e[f-1],e[f])===c;)f++;return f-1},_s.prototype.interfaces_=function(){return[]},_s.prototype.getClass=function(){return _s},_s.toIntArray=function(e){for(var n=new Array(e.size()).fill(null),c=0;c<n.length;c++)n[c]=e.get(c).intValue();return n};var Fa=function(){this.e=null,this.pts=null,this.startIndex=null,this.env1=new ke,this.env2=new ke;var e=arguments[0];this.e=e,this.pts=e.getCoordinates();var n=new _s;this.startIndex=n.getChainStartIndices(this.pts)};Fa.prototype.getCoordinates=function(){return this.pts},Fa.prototype.getMaxX=function(e){var n=this.pts[this.startIndex[e]].x,c=this.pts[this.startIndex[e+1]].x;return n>c?n:c},Fa.prototype.getMinX=function(e){var n=this.pts[this.startIndex[e]].x,c=this.pts[this.startIndex[e+1]].x;return n<c?n:c},Fa.prototype.computeIntersectsForChain=function(){if(4===arguments.length){var e=arguments[0],n=arguments[1],c=arguments[2];this.computeIntersectsForChain(this.startIndex[e],this.startIndex[e+1],n,n.startIndex[c],n.startIndex[c+1],arguments[3])}else if(6===arguments.length){var x=arguments[0],L=arguments[1],z=arguments[2],W=arguments[3],gt=arguments[4],Zt=arguments[5],Ie=this.pts[x],Me=this.pts[L],tr=z.pts[W],mr=z.pts[gt];if(L-x==1&&gt-W==1)return Zt.addIntersections(this.e,x,z.e,W),null;if(this.env1.init(Ie,Me),this.env2.init(tr,mr),!this.env1.intersects(this.env2))return null;var Ar=Math.trunc((x+L)/2),Xr=Math.trunc((W+gt)/2);x<Ar&&(W<Xr&&this.computeIntersectsForChain(x,Ar,z,W,Xr,Zt),Xr<gt&&this.computeIntersectsForChain(x,Ar,z,Xr,gt,Zt)),Ar<L&&(W<Xr&&this.computeIntersectsForChain(Ar,L,z,W,Xr,Zt),Xr<gt&&this.computeIntersectsForChain(Ar,L,z,Xr,gt,Zt))}},Fa.prototype.getStartIndexes=function(){return this.startIndex},Fa.prototype.computeIntersects=function(e,n){for(var c=0;c<this.startIndex.length-1;c++)for(var f=0;f<e.startIndex.length-1;f++)this.computeIntersectsForChain(c,e,f,n)},Fa.prototype.interfaces_=function(){return[]},Fa.prototype.getClass=function(){return Fa};var vo=function e(){this._depth=Array(2).fill().map(function(){return Array(3)});for(var n=0;n<2;n++)for(var c=0;c<3;c++)this._depth[n][c]=e.NULL_VALUE},Fu={NULL_VALUE:{configurable:!0}};vo.prototype.getDepth=function(e,n){return this._depth[e][n]},vo.prototype.setDepth=function(e,n,c){this._depth[e][n]=c},vo.prototype.isNull=function(){if(0===arguments.length){for(var e=0;e<2;e++)for(var n=0;n<3;n++)if(this._depth[e][n]!==vo.NULL_VALUE)return!1;return!0}return 1===arguments.length?this._depth[arguments[0]][1]===vo.NULL_VALUE:2===arguments.length?this._depth[arguments[0]][arguments[1]]===vo.NULL_VALUE:void 0},vo.prototype.normalize=function(){for(var e=0;e<2;e++)if(!this.isNull(e)){var n=this._depth[e][1];this._depth[e][2]<n&&(n=this._depth[e][2]),n<0&&(n=0);for(var c=1;c<3;c++){var f=0;this._depth[e][c]>n&&(f=1),this._depth[e][c]=f}}},vo.prototype.getDelta=function(e){return this._depth[e][$e.RIGHT]-this._depth[e][$e.LEFT]},vo.prototype.getLocation=function(e,n){return this._depth[e][n]<=0?ct.EXTERIOR:ct.INTERIOR},vo.prototype.toString=function(){return"A: "+this._depth[0][1]+","+this._depth[0][2]+" B: "+this._depth[1][1]+","+this._depth[1][2]},vo.prototype.add=function(){if(1===arguments.length)for(var e=arguments[0],n=0;n<2;n++)for(var c=1;c<3;c++){var f=e.getLocation(n,c);f!==ct.EXTERIOR&&f!==ct.INTERIOR||(this.isNull(n,c)?this._depth[n][c]=vo.depthAtLocation(f):this._depth[n][c]+=vo.depthAtLocation(f))}else 3===arguments.length&&arguments[2]===ct.INTERIOR&&this._depth[arguments[0]][arguments[1]]++},vo.prototype.interfaces_=function(){return[]},vo.prototype.getClass=function(){return vo},vo.depthAtLocation=function(e){return e===ct.EXTERIOR?0:e===ct.INTERIOR?1:vo.NULL_VALUE},Fu.NULL_VALUE.get=function(){return-1},Object.defineProperties(vo,Fu);var Wa=function(e){function n(){if(e.call(this),this.pts=null,this._env=null,this.eiList=new za(this),this._name=null,this._mce=null,this._isIsolated=!0,this._depth=new vo,this._depthDelta=0,1===arguments.length)n.call(this,arguments[0],null);else if(2===arguments.length){var x=arguments[1];this.pts=arguments[0],this._label=x}}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype.getDepth=function(){return this._depth},n.prototype.getCollapsedEdge=function(){var c=new Array(2).fill(null);return c[0]=this.pts[0],c[1]=this.pts[1],new n(c,Yn.toLineLabel(this._label))},n.prototype.isIsolated=function(){return this._isIsolated},n.prototype.getCoordinates=function(){return this.pts},n.prototype.setIsolated=function(c){this._isIsolated=c},n.prototype.setName=function(c){this._name=c},n.prototype.equals=function(c){if(!(c instanceof n))return!1;var f=c;if(this.pts.length!==f.pts.length)return!1;for(var x=!0,L=!0,z=this.pts.length,W=0;W<this.pts.length;W++)if(this.pts[W].equals2D(f.pts[W])||(x=!1),this.pts[W].equals2D(f.pts[--z])||(L=!1),!x&&!L)return!1;return!0},n.prototype.getCoordinate=function(){return 0===arguments.length?this.pts.length>0?this.pts[0]:null:1===arguments.length?this.pts[arguments[0]]:void 0},n.prototype.print=function(c){c.print("edge "+this._name+": "),c.print("LINESTRING (");for(var f=0;f<this.pts.length;f++)f>0&&c.print(","),c.print(this.pts[f].x+" "+this.pts[f].y);c.print(")  "+this._label+" "+this._depthDelta)},n.prototype.computeIM=function(c){n.updateIM(this._label,c)},n.prototype.isCollapsed=function(){return!!this._label.isArea()&&3===this.pts.length&&!!this.pts[0].equals(this.pts[2])},n.prototype.isClosed=function(){return this.pts[0].equals(this.pts[this.pts.length-1])},n.prototype.getMaximumSegmentIndex=function(){return this.pts.length-1},n.prototype.getDepthDelta=function(){return this._depthDelta},n.prototype.getNumPoints=function(){return this.pts.length},n.prototype.printReverse=function(c){c.print("edge "+this._name+": ");for(var f=this.pts.length-1;f>=0;f--)c.print(this.pts[f]+" ");c.println("")},n.prototype.getMonotoneChainEdge=function(){return null===this._mce&&(this._mce=new Fa(this)),this._mce},n.prototype.getEnvelope=function(){if(null===this._env){this._env=new ke;for(var c=0;c<this.pts.length;c++)this._env.expandToInclude(this.pts[c])}return this._env},n.prototype.addIntersection=function(c,f,x,L){var z=new j(c.getIntersection(L)),W=f,gt=c.getEdgeDistance(x,L),Zt=W+1;Zt<this.pts.length&&z.equals2D(this.pts[Zt])&&(W=Zt,gt=0),this.eiList.add(z,W,gt)},n.prototype.toString=function(){var c=new Tt;c.append("edge "+this._name+": "),c.append("LINESTRING (");for(var f=0;f<this.pts.length;f++)f>0&&c.append(","),c.append(this.pts[f].x+" "+this.pts[f].y);return c.append(")  "+this._label+" "+this._depthDelta),c.toString()},n.prototype.isPointwiseEqual=function(c){if(this.pts.length!==c.pts.length)return!1;for(var f=0;f<this.pts.length;f++)if(!this.pts[f].equals2D(c.pts[f]))return!1;return!0},n.prototype.setDepthDelta=function(c){this._depthDelta=c},n.prototype.getEdgeIntersectionList=function(){return this.eiList},n.prototype.addIntersections=function(c,f,x){for(var L=0;L<c.getIntersectionNum();L++)this.addIntersection(c,f,x,L)},n.prototype.interfaces_=function(){return[]},n.prototype.getClass=function(){return n},n.updateIM=function(){if(2!==arguments.length)return e.prototype.updateIM.apply(this,arguments);var c=arguments[0],f=arguments[1];f.setAtLeastIfValid(c.getLocation(0,$e.ON),c.getLocation(1,$e.ON),1),c.isArea()&&(f.setAtLeastIfValid(c.getLocation(0,$e.LEFT),c.getLocation(1,$e.LEFT),2),f.setAtLeastIfValid(c.getLocation(0,$e.RIGHT),c.getLocation(1,$e.RIGHT),2))},n}(Xo),Jo=function(e){this._workingPrecisionModel=null,this._workingNoder=null,this._geomFact=null,this._graph=null,this._edgeList=new ga,this._bufParams=e||null};Jo.prototype.setWorkingPrecisionModel=function(e){this._workingPrecisionModel=e},Jo.prototype.insertUniqueEdge=function(e){var n=this._edgeList.findEqualEdge(e);if(null!==n){var c=n.getLabel(),f=e.getLabel();n.isPointwiseEqual(e)||(f=new Yn(e.getLabel())).flip(),c.merge(f);var x=Jo.depthDelta(f),L=n.getDepthDelta()+x;n.setDepthDelta(L)}else this._edgeList.add(e),e.setDepthDelta(Jo.depthDelta(e.getLabel()))},Jo.prototype.buildSubgraphs=function(e,n){for(var c=new Je,f=e.iterator();f.hasNext();){var x=f.next(),L=x.getRightmostCoordinate(),z=new Xa(c).getDepth(L);x.computeDepth(z),x.findResultEdges(),c.add(x),n.add(x.getDirectedEdges(),x.getNodes())}},Jo.prototype.createSubgraphs=function(e){for(var n=new Je,c=e.getNodes().iterator();c.hasNext();){var f=c.next();if(!f.isVisited()){var x=new na;x.create(f),n.add(x)}}return fa.sort(n,fa.reverseOrder()),n},Jo.prototype.createEmptyResultGeometry=function(){return this._geomFact.createPolygon()},Jo.prototype.getNoder=function(e){if(null!==this._workingNoder)return this._workingNoder;var n=new cu,c=new Ee;return c.setPrecisionModel(e),n.setSegmentIntersector(new qo(c)),n},Jo.prototype.buffer=function(e,n){var c=this._workingPrecisionModel;null===c&&(c=e.getPrecisionModel()),this._geomFact=e.getFactory();var f=new Bo(c,this._bufParams),x=new da(e,n,f).getCurves();if(x.size()<=0)return this.createEmptyResultGeometry();this.computeNodedEdges(x,c),this._graph=new ii(new pc),this._graph.addEdges(this._edgeList.getEdges());var L=this.createSubgraphs(this._graph),z=new ao(this._geomFact);this.buildSubgraphs(L,z);var W=z.getPolygons();return W.size()<=0?this.createEmptyResultGeometry():this._geomFact.buildGeometry(W)},Jo.prototype.computeNodedEdges=function(e,n){var c=this.getNoder(n);c.computeNodes(e);for(var f=c.getNodedSubstrings().iterator();f.hasNext();){var x=f.next(),L=x.getCoordinates();if(2!==L.length||!L[0].equals2D(L[1])){var z=x.getData(),W=new Wa(x.getCoordinates(),new Yn(z));this.insertUniqueEdge(W)}}},Jo.prototype.setNoder=function(e){this._workingNoder=e},Jo.prototype.interfaces_=function(){return[]},Jo.prototype.getClass=function(){return Jo},Jo.depthDelta=function(e){var n=e.getLocation(0,$e.LEFT),c=e.getLocation(0,$e.RIGHT);return n===ct.INTERIOR&&c===ct.EXTERIOR?1:n===ct.EXTERIOR&&c===ct.INTERIOR?-1:0},Jo.convertSegStrings=function(e){for(var n=new nn,c=new Je;e.hasNext();){var f=e.next(),x=n.createLineString(f.getCoordinates());c.add(x)}return n.buildGeometry(c)};var As=function(){if(this._noder=null,this._scaleFactor=null,this._offsetX=null,this._offsetY=null,this._isScaled=!1,2===arguments.length){var n=arguments[1];this._noder=arguments[0],this._scaleFactor=n,this._offsetX=0,this._offsetY=0,this._isScaled=!this.isIntegerPrecision()}else if(4===arguments.length){var f=arguments[1],x=arguments[2],L=arguments[3];this._noder=arguments[0],this._scaleFactor=f,this._offsetX=x,this._offsetY=L,this._isScaled=!this.isIntegerPrecision()}};As.prototype.rescale=function(){if(Te(arguments[0],$n))for(var e=arguments[0].iterator();e.hasNext();){var n=e.next();this.rescale(n.getCoordinates())}else if(arguments[0]instanceof Array){for(var c=arguments[0],f=0;f<c.length;f++)c[f].x=c[f].x/this._scaleFactor+this._offsetX,c[f].y=c[f].y/this._scaleFactor+this._offsetY;2===c.length&&c[0].equals2D(c[1])&&Sr.out.println(c)}},As.prototype.scale=function(){if(Te(arguments[0],$n)){for(var e=arguments[0],n=new Je,c=e.iterator();c.hasNext();){var f=c.next();n.add(new wi(this.scale(f.getCoordinates()),f.getData()))}return n}if(arguments[0]instanceof Array){for(var x=arguments[0],L=new Array(x.length).fill(null),z=0;z<x.length;z++)L[z]=new j(Math.round((x[z].x-this._offsetX)*this._scaleFactor),Math.round((x[z].y-this._offsetY)*this._scaleFactor),x[z].z);return Y.removeRepeatedPoints(L)}},As.prototype.isIntegerPrecision=function(){return 1===this._scaleFactor},As.prototype.getNodedSubstrings=function(){var e=this._noder.getNodedSubstrings();return this._isScaled&&this.rescale(e),e},As.prototype.computeNodes=function(e){var n=e;this._isScaled&&(n=this.scale(e)),this._noder.computeNodes(n)},As.prototype.interfaces_=function(){return[Ys]},As.prototype.getClass=function(){return As};var Ha=function(){this._li=new Ee,this._segStrings=null,this._segStrings=arguments[0]},pu={fact:{configurable:!0}};Ha.prototype.checkEndPtVertexIntersections=function(){if(0===arguments.length)for(var e=this._segStrings.iterator();e.hasNext();){var n=e.next().getCoordinates();this.checkEndPtVertexIntersections(n[0],this._segStrings),this.checkEndPtVertexIntersections(n[n.length-1],this._segStrings)}else if(2===arguments.length)for(var c=arguments[0],f=arguments[1].iterator();f.hasNext();)for(var x=f.next().getCoordinates(),L=1;L<x.length-1;L++)if(x[L].equals(c))throw new ot("found endpt/interior pt intersection at index "+L+" :pt "+c)},Ha.prototype.checkInteriorIntersections=function(){if(0===arguments.length)for(var e=this._segStrings.iterator();e.hasNext();)for(var n=e.next(),c=this._segStrings.iterator();c.hasNext();){var f=c.next();this.checkInteriorIntersections(n,f)}else if(2===arguments.length)for(var x=arguments[0],L=arguments[1],z=x.getCoordinates(),W=L.getCoordinates(),gt=0;gt<z.length-1;gt++)for(var Zt=0;Zt<W.length-1;Zt++)this.checkInteriorIntersections(x,gt,L,Zt);else if(4===arguments.length){var Ie=arguments[0],Me=arguments[1],tr=arguments[2],mr=arguments[3];if(Ie===tr&&Me===mr)return null;var Ar=Ie.getCoordinates()[Me],Xr=Ie.getCoordinates()[Me+1],Wn=tr.getCoordinates()[mr],u=tr.getCoordinates()[mr+1];if(this._li.computeIntersection(Ar,Xr,Wn,u),this._li.hasIntersection()&&(this._li.isProper()||this.hasInteriorIntersection(this._li,Ar,Xr)||this.hasInteriorIntersection(this._li,Wn,u)))throw new ot("found non-noded intersection at "+Ar+"-"+Xr+" and "+Wn+"-"+u)}},Ha.prototype.checkValid=function(){this.checkEndPtVertexIntersections(),this.checkInteriorIntersections(),this.checkCollapses()},Ha.prototype.checkCollapses=function(){if(0===arguments.length)for(var e=this._segStrings.iterator();e.hasNext();){var n=e.next();this.checkCollapses(n)}else if(1===arguments.length)for(var c=arguments[0].getCoordinates(),f=0;f<c.length-2;f++)this.checkCollapse(c[f],c[f+1],c[f+2])},Ha.prototype.hasInteriorIntersection=function(e,n,c){for(var f=0;f<e.getIntersectionNum();f++){var x=e.getIntersection(f);if(!x.equals(n)&&!x.equals(c))return!0}return!1},Ha.prototype.checkCollapse=function(e,n,c){if(e.equals(c))throw new ot("found non-noded collapse at "+Ha.fact.createLineString([e,n,c]))},Ha.prototype.interfaces_=function(){return[]},Ha.prototype.getClass=function(){return Ha},pu.fact.get=function(){return new nn},Object.defineProperties(Ha,pu);var _o=function(){this._li=null,this._pt=null,this._originalPt=null,this._ptScaled=null,this._p0Scaled=null,this._p1Scaled=null,this._scaleFactor=null,this._minx=null,this._maxx=null,this._miny=null,this._maxy=null,this._corner=new Array(4).fill(null),this._safeEnv=null;var e=arguments[0],n=arguments[1],c=arguments[2];if(this._originalPt=e,this._pt=e,this._scaleFactor=n,this._li=c,n<=0)throw new J("Scale factor must be non-zero");1!==n&&(this._pt=new j(this.scale(e.x),this.scale(e.y)),this._p0Scaled=new j,this._p1Scaled=new j),this.initCorners(this._pt)},fu={SAFE_ENV_EXPANSION_FACTOR:{configurable:!0}};_o.prototype.intersectsScaled=function(e,n){var c=Math.min(e.x,n.x),f=Math.max(e.x,n.x),x=Math.min(e.y,n.y),L=Math.max(e.y,n.y),z=this._maxx<c||this._minx>f||this._maxy<x||this._miny>L;if(z)return!1;var W=this.intersectsToleranceSquare(e,n);return tt.isTrue(!(z&&W),"Found bad envelope test"),W},_o.prototype.initCorners=function(e){this._minx=e.x-.5,this._maxx=e.x+.5,this._miny=e.y-.5,this._maxy=e.y+.5,this._corner[0]=new j(this._maxx,this._maxy),this._corner[1]=new j(this._minx,this._maxy),this._corner[2]=new j(this._minx,this._miny),this._corner[3]=new j(this._maxx,this._miny)},_o.prototype.intersects=function(e,n){return 1===this._scaleFactor?this.intersectsScaled(e,n):(this.copyScaled(e,this._p0Scaled),this.copyScaled(n,this._p1Scaled),this.intersectsScaled(this._p0Scaled,this._p1Scaled))},_o.prototype.scale=function(e){return Math.round(e*this._scaleFactor)},_o.prototype.getCoordinate=function(){return this._originalPt},_o.prototype.copyScaled=function(e,n){n.x=this.scale(e.x),n.y=this.scale(e.y)},_o.prototype.getSafeEnvelope=function(){if(null===this._safeEnv){var e=_o.SAFE_ENV_EXPANSION_FACTOR/this._scaleFactor;this._safeEnv=new ke(this._originalPt.x-e,this._originalPt.x+e,this._originalPt.y-e,this._originalPt.y+e)}return this._safeEnv},_o.prototype.intersectsPixelClosure=function(e,n){return this._li.computeIntersection(e,n,this._corner[0],this._corner[1]),!!(this._li.hasIntersection()||(this._li.computeIntersection(e,n,this._corner[1],this._corner[2]),this._li.hasIntersection()||(this._li.computeIntersection(e,n,this._corner[2],this._corner[3]),this._li.hasIntersection()||(this._li.computeIntersection(e,n,this._corner[3],this._corner[0]),this._li.hasIntersection()))))},_o.prototype.intersectsToleranceSquare=function(e,n){var c=!1,f=!1;return this._li.computeIntersection(e,n,this._corner[0],this._corner[1]),!!(this._li.isProper()||(this._li.computeIntersection(e,n,this._corner[1],this._corner[2]),this._li.isProper()||(this._li.hasIntersection()&&(c=!0),this._li.computeIntersection(e,n,this._corner[2],this._corner[3]),this._li.isProper()||(this._li.hasIntersection()&&(f=!0),this._li.computeIntersection(e,n,this._corner[3],this._corner[0]),this._li.isProper()||c&&f||e.equals(this._pt)||n.equals(this._pt)))))},_o.prototype.addSnappedNode=function(e,n){var c=e.getCoordinate(n),f=e.getCoordinate(n+1);return!!this.intersects(c,f)&&(e.addIntersection(this.getCoordinate(),n),!0)},_o.prototype.interfaces_=function(){return[]},_o.prototype.getClass=function(){return _o},fu.SAFE_ENV_EXPANSION_FACTOR.get=function(){return.75},Object.defineProperties(_o,fu);var du=function(){this.tempEnv1=new ke,this.selectedSegment=new kr};du.prototype.select=function(){1!==arguments.length&&2===arguments.length&&(arguments[0].getLineSegment(arguments[1],this.selectedSegment),this.select(this.selectedSegment))},du.prototype.interfaces_=function(){return[]},du.prototype.getClass=function(){return du};var Ks=function(){this._index=null,this._index=arguments[0]},fc={HotPixelSnapAction:{configurable:!0}};Ks.prototype.snap=function(){if(1===arguments.length)return this.snap(arguments[0],null,-1);if(3===arguments.length){var n=arguments[0],c=arguments[1],f=arguments[2],x=n.getSafeEnvelope(),L=new Bu(n,c,f);return this._index.query(x,{interfaces_:function(){return[ms]},visitItem:function(z){z.select(x,L)}}),L.isNodeAdded()}},Ks.prototype.interfaces_=function(){return[]},Ks.prototype.getClass=function(){return Ks},fc.HotPixelSnapAction.get=function(){return Bu},Object.defineProperties(Ks,fc);var Bu=function(e){function n(){e.call(this),this._hotPixel=null,this._parentEdge=null,this._hotPixelVertexIndex=null,this._isNodeAdded=!1;var f=arguments[1],x=arguments[2];this._hotPixel=arguments[0],this._parentEdge=f,this._hotPixelVertexIndex=x}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype.isNodeAdded=function(){return this._isNodeAdded},n.prototype.select=function(){if(2!==arguments.length)return e.prototype.select.apply(this,arguments);var f=arguments[1],x=arguments[0].getContext();if(null!==this._parentEdge&&x===this._parentEdge&&f===this._hotPixelVertexIndex)return null;this._isNodeAdded=this._hotPixel.addSnappedNode(x,f)},n.prototype.interfaces_=function(){return[]},n.prototype.getClass=function(){return n},n}(du),$s=function(){this._li=null,this._interiorIntersections=null,this._li=arguments[0],this._interiorIntersections=new Je};$s.prototype.processIntersections=function(e,n,c,f){if(e===c&&n===f)return null;var x=e.getCoordinates()[n],L=e.getCoordinates()[n+1],z=c.getCoordinates()[f],W=c.getCoordinates()[f+1];if(this._li.computeIntersection(x,L,z,W),this._li.hasIntersection()&&this._li.isInteriorIntersection()){for(var gt=0;gt<this._li.getIntersectionNum();gt++)this._interiorIntersections.add(this._li.getIntersection(gt));e.addIntersections(this._li,n,0),c.addIntersections(this._li,f,1)}},$s.prototype.isDone=function(){return!1},$s.prototype.getInteriorIntersections=function(){return this._interiorIntersections},$s.prototype.interfaces_=function(){return[Js]},$s.prototype.getClass=function(){return $s};var xs=function(){this._pm=null,this._li=null,this._scaleFactor=null,this._noder=null,this._pointSnapper=null,this._nodedSegStrings=null;var e=arguments[0];this._pm=e,this._li=new Ee,this._li.setPrecisionModel(e),this._scaleFactor=e.getScale()};xs.prototype.checkCorrectness=function(e){var n=wi.getNodedSubstrings(e),c=new Ha(n);try{c.checkValid()}catch(f){if(!(f instanceof Mr))throw f;f.printStackTrace()}},xs.prototype.getNodedSubstrings=function(){return wi.getNodedSubstrings(this._nodedSegStrings)},xs.prototype.snapRound=function(e,n){var c=this.findInteriorIntersections(e,n);this.computeIntersectionSnaps(c),this.computeVertexSnaps(e)},xs.prototype.findInteriorIntersections=function(e,n){var c=new $s(n);return this._noder.setSegmentIntersector(c),this._noder.computeNodes(e),c.getInteriorIntersections()},xs.prototype.computeVertexSnaps=function(){if(Te(arguments[0],$n))for(var e=arguments[0].iterator();e.hasNext();){var n=e.next();this.computeVertexSnaps(n)}else if(arguments[0]instanceof wi)for(var c=arguments[0],f=c.getCoordinates(),x=0;x<f.length;x++){var L=new _o(f[x],this._scaleFactor,this._li);this._pointSnapper.snap(L,c,x)&&c.addIntersection(f[x],x)}},xs.prototype.computeNodes=function(e){this._nodedSegStrings=e,this._noder=new cu,this._pointSnapper=new Ks(this._noder.getIndex()),this.snapRound(e,this._li)},xs.prototype.computeIntersectionSnaps=function(e){for(var n=e.iterator();n.hasNext();){var c=n.next(),f=new _o(c,this._scaleFactor,this._li);this._pointSnapper.snap(f)}},xs.prototype.interfaces_=function(){return[Ys]},xs.prototype.getClass=function(){return xs};var To=function(){if(this._argGeom=null,this._distance=null,this._bufParams=new qn,this._resultGeometry=null,this._saveException=null,1===arguments.length)this._argGeom=arguments[0];else if(2===arguments.length){var c=arguments[1];this._argGeom=arguments[0],this._bufParams=c}},Qs={CAP_ROUND:{configurable:!0},CAP_BUTT:{configurable:!0},CAP_FLAT:{configurable:!0},CAP_SQUARE:{configurable:!0},MAX_PRECISION_DIGITS:{configurable:!0}};To.prototype.bufferFixedPrecision=function(e){var n=new As(new xs(new bn(1)),e.getScale()),c=new Jo(this._bufParams);c.setWorkingPrecisionModel(e),c.setNoder(n),this._resultGeometry=c.buffer(this._argGeom,this._distance)},To.prototype.bufferReducedPrecision=function(){var e=this;if(0===arguments.length){for(var n=To.MAX_PRECISION_DIGITS;n>=0;n--){try{e.bufferReducedPrecision(n)}catch(L){if(!(L instanceof Fs))throw L;e._saveException=L}if(null!==e._resultGeometry)return null}throw this._saveException}if(1===arguments.length){var f=To.precisionScaleFactor(this._argGeom,this._distance,arguments[0]),x=new bn(f);this.bufferFixedPrecision(x)}},To.prototype.computeGeometry=function(){if(this.bufferOriginalPrecision(),null!==this._resultGeometry)return null;var e=this._argGeom.getFactory().getPrecisionModel();e.getType()===bn.FIXED?this.bufferFixedPrecision(e):this.bufferReducedPrecision()},To.prototype.setQuadrantSegments=function(e){this._bufParams.setQuadrantSegments(e)},To.prototype.bufferOriginalPrecision=function(){try{var e=new Jo(this._bufParams);this._resultGeometry=e.buffer(this._argGeom,this._distance)}catch(n){if(!(n instanceof ot))throw n;this._saveException=n}},To.prototype.getResultGeometry=function(e){return this._distance=e,this.computeGeometry(),this._resultGeometry},To.prototype.setEndCapStyle=function(e){this._bufParams.setEndCapStyle(e)},To.prototype.interfaces_=function(){return[]},To.prototype.getClass=function(){return To},To.bufferOp=function(){if(2===arguments.length){var n=arguments[1];return new To(arguments[0]).getResultGeometry(n)}if(3===arguments.length){if(Number.isInteger(arguments[2])&&arguments[0]instanceof ur&&"number"==typeof arguments[1]){var f=arguments[1],x=arguments[2],L=new To(arguments[0]);return L.setQuadrantSegments(x),L.getResultGeometry(f)}if(arguments[2]instanceof qn&&arguments[0]instanceof ur&&"number"==typeof arguments[1]){var W=arguments[1];return new To(arguments[0],arguments[2]).getResultGeometry(W)}}else if(4===arguments.length){var Ie=arguments[1],Me=arguments[2],tr=arguments[3],mr=new To(arguments[0]);return mr.setQuadrantSegments(Me),mr.setEndCapStyle(tr),mr.getResultGeometry(Ie)}},To.precisionScaleFactor=function(e,n,c){var f=e.getEnvelopeInternal(),x=wt.max(Math.abs(f.getMaxX()),Math.abs(f.getMaxY()),Math.abs(f.getMinX()),Math.abs(f.getMinY()))+2*(n>0?n:0),L=c-Math.trunc(Math.log(x)/Math.log(10)+1);return Math.pow(10,L)},Qs.CAP_ROUND.get=function(){return qn.CAP_ROUND},Qs.CAP_BUTT.get=function(){return qn.CAP_FLAT},Qs.CAP_FLAT.get=function(){return qn.CAP_FLAT},Qs.CAP_SQUARE.get=function(){return qn.CAP_SQUARE},Qs.MAX_PRECISION_DIGITS.get=function(){return 12},Object.defineProperties(To,Qs);var xo=function(){this._pt=[new j,new j],this._distance=$.NaN,this._isNull=!0};xo.prototype.getCoordinates=function(){return this._pt},xo.prototype.getCoordinate=function(e){return this._pt[e]},xo.prototype.setMinimum=function(){if(1===arguments.length){var e=arguments[0];this.setMinimum(e._pt[0],e._pt[1])}else if(2===arguments.length){var n=arguments[0],c=arguments[1];if(this._isNull)return this.initialize(n,c),null;var f=n.distance(c);f<this._distance&&this.initialize(n,c,f)}},xo.prototype.initialize=function(){if(0===arguments.length)this._isNull=!0;else if(2===arguments.length){var e=arguments[0],n=arguments[1];this._pt[0].setCoordinate(e),this._pt[1].setCoordinate(n),this._distance=e.distance(n),this._isNull=!1}else if(3===arguments.length){var f=arguments[1],x=arguments[2];this._pt[0].setCoordinate(arguments[0]),this._pt[1].setCoordinate(f),this._distance=x,this._isNull=!1}},xo.prototype.getDistance=function(){return this._distance},xo.prototype.setMaximum=function(){if(1===arguments.length){var e=arguments[0];this.setMaximum(e._pt[0],e._pt[1])}else if(2===arguments.length){var n=arguments[0],c=arguments[1];if(this._isNull)return this.initialize(n,c),null;var f=n.distance(c);f>this._distance&&this.initialize(n,c,f)}},xo.prototype.interfaces_=function(){return[]},xo.prototype.getClass=function(){return xo};var ns=function(){};ns.prototype.interfaces_=function(){return[]},ns.prototype.getClass=function(){return ns},ns.computeDistance=function(){if(arguments[2]instanceof xo&&arguments[0]instanceof zr&&arguments[1]instanceof j)for(var n=arguments[1],c=arguments[2],f=arguments[0].getCoordinates(),x=new kr,L=0;L<f.length-1;L++){x.setCoordinates(f[L],f[L+1]);var z=x.closestPoint(n);c.setMinimum(z,n)}else if(arguments[2]instanceof xo&&arguments[0]instanceof ln&&arguments[1]instanceof j){var W=arguments[0],gt=arguments[1],Zt=arguments[2];ns.computeDistance(W.getExteriorRing(),gt,Zt);for(var Ie=0;Ie<W.getNumInteriorRing();Ie++)ns.computeDistance(W.getInteriorRingN(Ie),gt,Zt)}else if(arguments[2]instanceof xo&&arguments[0]instanceof ur&&arguments[1]instanceof j){var Me=arguments[0],tr=arguments[1],mr=arguments[2];if(Me instanceof zr)ns.computeDistance(Me,tr,mr);else if(Me instanceof ln)ns.computeDistance(Me,tr,mr);else if(Me instanceof De)for(var Ar=Me,Xr=0;Xr<Ar.getNumGeometries();Xr++){var Wn=Ar.getGeometryN(Xr);ns.computeDistance(Wn,tr,mr)}else mr.setMinimum(Me.getCoordinate(),tr)}else if(arguments[2]instanceof xo&&arguments[0]instanceof kr&&arguments[1]instanceof j){var p=arguments[1],l=arguments[2],g=arguments[0].closestPoint(p);l.setMinimum(g,p)}};var is=function(e){this._maxPtDist=new xo,this._inputGeom=e||null},Uu={MaxPointDistanceFilter:{configurable:!0},MaxMidpointDistanceFilter:{configurable:!0}};is.prototype.computeMaxMidpointDistance=function(e){var n=new Fn(this._inputGeom);e.apply(n),this._maxPtDist.setMaximum(n.getMaxPointDistance())},is.prototype.computeMaxVertexDistance=function(e){var n=new tu(this._inputGeom);e.apply(n),this._maxPtDist.setMaximum(n.getMaxPointDistance())},is.prototype.findDistance=function(e){return this.computeMaxVertexDistance(e),this.computeMaxMidpointDistance(e),this._maxPtDist.getDistance()},is.prototype.getDistancePoints=function(){return this._maxPtDist},is.prototype.interfaces_=function(){return[]},is.prototype.getClass=function(){return is},Uu.MaxPointDistanceFilter.get=function(){return tu},Uu.MaxMidpointDistanceFilter.get=function(){return Fn},Object.defineProperties(is,Uu);var tu=function(e){this._maxPtDist=new xo,this._minPtDist=new xo,this._geom=e||null};tu.prototype.filter=function(e){this._minPtDist.initialize(),ns.computeDistance(this._geom,e,this._minPtDist),this._maxPtDist.setMaximum(this._minPtDist)},tu.prototype.getMaxPointDistance=function(){return this._maxPtDist},tu.prototype.interfaces_=function(){return[On]},tu.prototype.getClass=function(){return tu};var Fn=function(e){this._maxPtDist=new xo,this._minPtDist=new xo,this._geom=e||null};Fn.prototype.filter=function(e,n){if(0===n)return null;var c=e.getCoordinate(n-1),f=e.getCoordinate(n),x=new j((c.x+f.x)/2,(c.y+f.y)/2);this._minPtDist.initialize(),ns.computeDistance(this._geom,x,this._minPtDist),this._maxPtDist.setMaximum(this._minPtDist)},Fn.prototype.isDone=function(){return!1},Fn.prototype.isGeometryChanged=function(){return!1},Fn.prototype.getMaxPointDistance=function(){return this._maxPtDist},Fn.prototype.interfaces_=function(){return[Pr]},Fn.prototype.getClass=function(){return Fn};var os=function(e){this._comps=e||null};os.prototype.filter=function(e){e instanceof ln&&this._comps.add(e)},os.prototype.interfaces_=function(){return[pr]},os.prototype.getClass=function(){return os},os.getPolygons=function(){if(1===arguments.length)return os.getPolygons(arguments[0],new Je);if(2===arguments.length){var n=arguments[0],c=arguments[1];return n instanceof ln?c.add(n):n instanceof De&&n.apply(new os(c)),c}};var Ui=function(){if(this._lines=null,this._isForcedToLineString=!1,1===arguments.length)this._lines=arguments[0];else if(2===arguments.length){var c=arguments[1];this._lines=arguments[0],this._isForcedToLineString=c}};Ui.prototype.filter=function(e){if(this._isForcedToLineString&&e instanceof zn){var n=e.getFactory().createLineString(e.getCoordinateSequence());return this._lines.add(n),null}e instanceof zr&&this._lines.add(e)},Ui.prototype.setForceToLineString=function(e){this._isForcedToLineString=e},Ui.prototype.interfaces_=function(){return[cn]},Ui.prototype.getClass=function(){return Ui},Ui.getGeometry=function(){if(1===arguments.length){var e=arguments[0];return e.getFactory().buildGeometry(Ui.getLines(e))}if(2===arguments.length){var n=arguments[0],c=arguments[1];return n.getFactory().buildGeometry(Ui.getLines(n,c))}},Ui.getLines=function(){if(1===arguments.length)return Ui.getLines(arguments[0],!1);if(2===arguments.length){if(Te(arguments[0],$n)&&Te(arguments[1],$n)){for(var c=arguments[1],f=arguments[0].iterator();f.hasNext();){var x=f.next();Ui.getLines(x,c)}return c}if(arguments[0]instanceof ur&&"boolean"==typeof arguments[1]){var L=arguments[0],z=arguments[1],W=new Je;return L.apply(new Ui(W,z)),W}if(arguments[0]instanceof ur&&Te(arguments[1],$n)){var gt=arguments[0],Zt=arguments[1];return gt instanceof zr?Zt.add(gt):gt.apply(new Ui(Zt)),Zt}}else if(3===arguments.length){if("boolean"==typeof arguments[2]&&Te(arguments[0],$n)&&Te(arguments[1],$n)){for(var Me=arguments[1],tr=arguments[2],mr=arguments[0].iterator();mr.hasNext();){var Ar=mr.next();Ui.getLines(Ar,Me,tr)}return Me}if("boolean"==typeof arguments[2]&&arguments[0]instanceof ur&&Te(arguments[1],$n)){var Wn=arguments[1];return arguments[0].apply(new Ui(Wn,arguments[2])),Wn}}};var bo=function(){if(this._boundaryRule=Nn.OGC_SFS_BOUNDARY_RULE,this._isIn=null,this._numBoundaries=null,0!==arguments.length&&1===arguments.length){var e=arguments[0];if(null===e)throw new J("Rule must be non-null");this._boundaryRule=e}};bo.prototype.locateInternal=function(){if(arguments[0]instanceof j&&arguments[1]instanceof ln){var e=arguments[0],n=arguments[1];if(n.isEmpty())return ct.EXTERIOR;var c=n.getExteriorRing(),f=this.locateInPolygonRing(e,c);if(f===ct.EXTERIOR)return ct.EXTERIOR;if(f===ct.BOUNDARY)return ct.BOUNDARY;for(var x=0;x<n.getNumInteriorRing();x++){var L=n.getInteriorRingN(x),z=this.locateInPolygonRing(e,L);if(z===ct.INTERIOR)return ct.EXTERIOR;if(z===ct.BOUNDARY)return ct.BOUNDARY}return ct.INTERIOR}if(arguments[0]instanceof j&&arguments[1]instanceof zr){var W=arguments[0],gt=arguments[1];if(!gt.getEnvelopeInternal().intersects(W))return ct.EXTERIOR;var Zt=gt.getCoordinates();return gt.isClosed()||!W.equals(Zt[0])&&!W.equals(Zt[Zt.length-1])?Re.isOnLine(W,Zt)?ct.INTERIOR:ct.EXTERIOR:ct.BOUNDARY}if(arguments[0]instanceof j&&arguments[1]instanceof Tn){var Ie=arguments[0];return arguments[1].getCoordinate().equals2D(Ie)?ct.INTERIOR:ct.EXTERIOR}},bo.prototype.locateInPolygonRing=function(e,n){return n.getEnvelopeInternal().intersects(e)?Re.locatePointInRing(e,n.getCoordinates()):ct.EXTERIOR},bo.prototype.intersects=function(e,n){return this.locate(e,n)!==ct.EXTERIOR},bo.prototype.updateLocationInfo=function(e){e===ct.INTERIOR&&(this._isIn=!0),e===ct.BOUNDARY&&this._numBoundaries++},bo.prototype.computeLocation=function(e,n){if(n instanceof Tn&&this.updateLocationInfo(this.locateInternal(e,n)),n instanceof zr)this.updateLocationInfo(this.locateInternal(e,n));else if(n instanceof ln)this.updateLocationInfo(this.locateInternal(e,n));else if(n instanceof sr)for(var c=n,f=0;f<c.getNumGeometries();f++){var x=c.getGeometryN(f);this.updateLocationInfo(this.locateInternal(e,x))}else if(n instanceof un)for(var L=n,z=0;z<L.getNumGeometries();z++){var W=L.getGeometryN(z);this.updateLocationInfo(this.locateInternal(e,W))}else if(n instanceof De)for(var gt=new Gn(n);gt.hasNext();){var Zt=gt.next();Zt!==n&&this.computeLocation(e,Zt)}},bo.prototype.locate=function(e,n){return n.isEmpty()?ct.EXTERIOR:n instanceof zr||n instanceof ln?this.locateInternal(e,n):(this._isIn=!1,this._numBoundaries=0,this.computeLocation(e,n),this._boundaryRule.isInBoundary(this._numBoundaries)?ct.BOUNDARY:this._numBoundaries>0||this._isIn?ct.INTERIOR:ct.EXTERIOR)},bo.prototype.interfaces_=function(){return[]},bo.prototype.getClass=function(){return bo};var gn=function e(){if(this._component=null,this._segIndex=null,this._pt=null,2===arguments.length)e.call(this,arguments[0],e.INSIDE_AREA,arguments[1]);else if(3===arguments.length){var x=arguments[1],L=arguments[2];this._component=arguments[0],this._segIndex=x,this._pt=L}},Rn={INSIDE_AREA:{configurable:!0}};gn.prototype.isInsideArea=function(){return this._segIndex===gn.INSIDE_AREA},gn.prototype.getCoordinate=function(){return this._pt},gn.prototype.getGeometryComponent=function(){return this._component},gn.prototype.getSegmentIndex=function(){return this._segIndex},gn.prototype.interfaces_=function(){return[]},gn.prototype.getClass=function(){return gn},Rn.INSIDE_AREA.get=function(){return-1},Object.defineProperties(gn,Rn);var Ba=function(e){this._pts=e||null};Ba.prototype.filter=function(e){e instanceof Tn&&this._pts.add(e)},Ba.prototype.interfaces_=function(){return[pr]},Ba.prototype.getClass=function(){return Ba},Ba.getPoints=function(){if(1===arguments.length){var e=arguments[0];return e instanceof Tn?fa.singletonList(e):Ba.getPoints(e,new Je)}if(2===arguments.length){var n=arguments[0],c=arguments[1];return n instanceof Tn?c.add(n):n instanceof De&&n.apply(new Ba(c)),c}};var Pa=function(){this._locations=null,this._locations=arguments[0]};Pa.prototype.filter=function(e){(e instanceof Tn||e instanceof zr||e instanceof ln)&&this._locations.add(new gn(e,0,e.getCoordinate()))},Pa.prototype.interfaces_=function(){return[pr]},Pa.prototype.getClass=function(){return Pa},Pa.getLocations=function(e){var n=new Je;return e.apply(new Pa(n)),n};var Ao=function(){if(this._geom=null,this._terminateDistance=0,this._ptLocator=new bo,this._minDistanceLocation=null,this._minDistance=$.MAX_VALUE,2===arguments.length)this._geom=[arguments[0],arguments[1]],this._terminateDistance=0;else if(3===arguments.length){var c=arguments[0],f=arguments[1],x=arguments[2];this._geom=new Array(2).fill(null),this._geom[0]=c,this._geom[1]=f,this._terminateDistance=x}};Ao.prototype.computeContainmentDistance=function(){if(0===arguments.length){var e=new Array(2).fill(null);if(this.computeContainmentDistance(0,e),this._minDistance<=this._terminateDistance)return null;this.computeContainmentDistance(1,e)}else if(2===arguments.length){var n=arguments[0],c=arguments[1],f=1-n,x=os.getPolygons(this._geom[n]);if(x.size()>0){var L=Pa.getLocations(this._geom[f]);if(this.computeContainmentDistance(L,x,c),this._minDistance<=this._terminateDistance)return this._minDistanceLocation[f]=c[0],this._minDistanceLocation[n]=c[1],null}}else if(3===arguments.length)if(arguments[2]instanceof Array&&Te(arguments[0],Oi)&&Te(arguments[1],Oi)){for(var z=arguments[0],W=arguments[1],gt=arguments[2],Zt=0;Zt<z.size();Zt++)for(var Ie=z.get(Zt),Me=0;Me<W.size();Me++)if(this.computeContainmentDistance(Ie,W.get(Me),gt),this._minDistance<=this._terminateDistance)return null}else if(arguments[2]instanceof Array&&arguments[0]instanceof gn&&arguments[1]instanceof ln){var tr=arguments[0],mr=arguments[1],Ar=arguments[2],Xr=tr.getCoordinate();if(ct.EXTERIOR!==this._ptLocator.locate(Xr,mr))return this._minDistance=0,Ar[0]=tr,Ar[1]=new gn(mr,Xr),null}},Ao.prototype.computeMinDistanceLinesPoints=function(e,n,c){for(var f=0;f<e.size();f++)for(var x=e.get(f),L=0;L<n.size();L++){var z=n.get(L);if(this.computeMinDistance(x,z,c),this._minDistance<=this._terminateDistance)return null}},Ao.prototype.computeFacetDistance=function(){var e=new Array(2).fill(null),n=Ui.getLines(this._geom[0]),c=Ui.getLines(this._geom[1]),f=Ba.getPoints(this._geom[0]),x=Ba.getPoints(this._geom[1]);return this.computeMinDistanceLines(n,c,e),this.updateMinDistance(e,!1),this._minDistance<=this._terminateDistance?null:(e[0]=null,e[1]=null,this.computeMinDistanceLinesPoints(n,x,e),this.updateMinDistance(e,!1),this._minDistance<=this._terminateDistance?null:(e[0]=null,e[1]=null,this.computeMinDistanceLinesPoints(c,f,e),this.updateMinDistance(e,!0),this._minDistance<=this._terminateDistance?null:(e[0]=null,e[1]=null,this.computeMinDistancePoints(f,x,e),void this.updateMinDistance(e,!1))))},Ao.prototype.nearestLocations=function(){return this.computeMinDistance(),this._minDistanceLocation},Ao.prototype.updateMinDistance=function(e,n){if(null===e[0])return null;n?(this._minDistanceLocation[0]=e[1],this._minDistanceLocation[1]=e[0]):(this._minDistanceLocation[0]=e[0],this._minDistanceLocation[1]=e[1])},Ao.prototype.nearestPoints=function(){return this.computeMinDistance(),[this._minDistanceLocation[0].getCoordinate(),this._minDistanceLocation[1].getCoordinate()]},Ao.prototype.computeMinDistance=function(){if(0===arguments.length){if(null!==this._minDistanceLocation||(this._minDistanceLocation=new Array(2).fill(null),this.computeContainmentDistance(),this._minDistance<=this._terminateDistance))return null;this.computeFacetDistance()}else if(3===arguments.length)if(arguments[2]instanceof Array&&arguments[0]instanceof zr&&arguments[1]instanceof Tn){var e=arguments[0],n=arguments[1],c=arguments[2];if(e.getEnvelopeInternal().distance(n.getEnvelopeInternal())>this._minDistance)return null;for(var f=e.getCoordinates(),x=n.getCoordinate(),L=0;L<f.length-1;L++){var z=Re.distancePointLine(x,f[L],f[L+1]);if(z<this._minDistance){this._minDistance=z;var W=new kr(f[L],f[L+1]).closestPoint(x);c[0]=new gn(e,L,W),c[1]=new gn(n,0,x)}if(this._minDistance<=this._terminateDistance)return null}}else if(arguments[2]instanceof Array&&arguments[0]instanceof zr&&arguments[1]instanceof zr){var gt=arguments[0],Zt=arguments[1],Ie=arguments[2];if(gt.getEnvelopeInternal().distance(Zt.getEnvelopeInternal())>this._minDistance)return null;for(var Me=gt.getCoordinates(),tr=Zt.getCoordinates(),mr=0;mr<Me.length-1;mr++)for(var Ar=0;Ar<tr.length-1;Ar++){var Xr=Re.distanceLineLine(Me[mr],Me[mr+1],tr[Ar],tr[Ar+1]);if(Xr<this._minDistance){this._minDistance=Xr;var Wn=new kr(Me[mr],Me[mr+1]),u=new kr(tr[Ar],tr[Ar+1]),p=Wn.closestPoints(u);Ie[0]=new gn(gt,mr,p[0]),Ie[1]=new gn(Zt,Ar,p[1])}if(this._minDistance<=this._terminateDistance)return null}}},Ao.prototype.computeMinDistancePoints=function(e,n,c){for(var f=0;f<e.size();f++)for(var x=e.get(f),L=0;L<n.size();L++){var z=n.get(L),W=x.getCoordinate().distance(z.getCoordinate());if(W<this._minDistance&&(this._minDistance=W,c[0]=new gn(x,0,x.getCoordinate()),c[1]=new gn(z,0,z.getCoordinate())),this._minDistance<=this._terminateDistance)return null}},Ao.prototype.distance=function(){if(null===this._geom[0]||null===this._geom[1])throw new J("null geometries are not supported");return this._geom[0].isEmpty()||this._geom[1].isEmpty()?0:(this.computeMinDistance(),this._minDistance)},Ao.prototype.computeMinDistanceLines=function(e,n,c){for(var f=0;f<e.size();f++)for(var x=e.get(f),L=0;L<n.size();L++){var z=n.get(L);if(this.computeMinDistance(x,z,c),this._minDistance<=this._terminateDistance)return null}},Ao.prototype.interfaces_=function(){return[]},Ao.prototype.getClass=function(){return Ao},Ao.distance=function(e,n){return new Ao(e,n).distance()},Ao.isWithinDistance=function(e,n,c){return new Ao(e,n,c).distance()<=c},Ao.nearestPoints=function(e,n){return new Ao(e,n).nearestPoints()};var ro=function(){this._pt=[new j,new j],this._distance=$.NaN,this._isNull=!0};ro.prototype.getCoordinates=function(){return this._pt},ro.prototype.getCoordinate=function(e){return this._pt[e]},ro.prototype.setMinimum=function(){if(1===arguments.length){var e=arguments[0];this.setMinimum(e._pt[0],e._pt[1])}else if(2===arguments.length){var n=arguments[0],c=arguments[1];if(this._isNull)return this.initialize(n,c),null;var f=n.distance(c);f<this._distance&&this.initialize(n,c,f)}},ro.prototype.initialize=function(){if(0===arguments.length)this._isNull=!0;else if(2===arguments.length){var e=arguments[0],n=arguments[1];this._pt[0].setCoordinate(e),this._pt[1].setCoordinate(n),this._distance=e.distance(n),this._isNull=!1}else if(3===arguments.length){var f=arguments[1],x=arguments[2];this._pt[0].setCoordinate(arguments[0]),this._pt[1].setCoordinate(f),this._distance=x,this._isNull=!1}},ro.prototype.toString=function(){return le.toLineString(this._pt[0],this._pt[1])},ro.prototype.getDistance=function(){return this._distance},ro.prototype.setMaximum=function(){if(1===arguments.length){var e=arguments[0];this.setMaximum(e._pt[0],e._pt[1])}else if(2===arguments.length){var n=arguments[0],c=arguments[1];if(this._isNull)return this.initialize(n,c),null;var f=n.distance(c);f>this._distance&&this.initialize(n,c,f)}},ro.prototype.interfaces_=function(){return[]},ro.prototype.getClass=function(){return ro};var Ma=function(){};Ma.prototype.interfaces_=function(){return[]},Ma.prototype.getClass=function(){return Ma},Ma.computeDistance=function(){if(arguments[2]instanceof ro&&arguments[0]instanceof zr&&arguments[1]instanceof j)for(var e=arguments[0],n=arguments[1],c=arguments[2],f=new kr,x=e.getCoordinates(),L=0;L<x.length-1;L++){f.setCoordinates(x[L],x[L+1]);var z=f.closestPoint(n);c.setMinimum(z,n)}else if(arguments[2]instanceof ro&&arguments[0]instanceof ln&&arguments[1]instanceof j){var W=arguments[0],gt=arguments[1],Zt=arguments[2];Ma.computeDistance(W.getExteriorRing(),gt,Zt);for(var Ie=0;Ie<W.getNumInteriorRing();Ie++)Ma.computeDistance(W.getInteriorRingN(Ie),gt,Zt)}else if(arguments[2]instanceof ro&&arguments[0]instanceof ur&&arguments[1]instanceof j){var Me=arguments[0],tr=arguments[1],mr=arguments[2];if(Me instanceof zr)Ma.computeDistance(Me,tr,mr);else if(Me instanceof ln)Ma.computeDistance(Me,tr,mr);else if(Me instanceof De)for(var Ar=Me,Xr=0;Xr<Ar.getNumGeometries();Xr++){var Wn=Ar.getGeometryN(Xr);Ma.computeDistance(Wn,tr,mr)}else mr.setMinimum(Me.getCoordinate(),tr)}else if(arguments[2]instanceof ro&&arguments[0]instanceof kr&&arguments[1]instanceof j){var p=arguments[1],l=arguments[2],g=arguments[0].closestPoint(p);l.setMinimum(g,p)}};var Ja=function(){this._g0=null,this._g1=null,this._ptDist=new ro,this._densifyFrac=0;var n=arguments[1];this._g0=arguments[0],this._g1=n},Cu={MaxPointDistanceFilter:{configurable:!0},MaxDensifiedByFractionDistanceFilter:{configurable:!0}};Ja.prototype.getCoordinates=function(){return this._ptDist.getCoordinates()},Ja.prototype.setDensifyFraction=function(e){if(e>1||e<=0)throw new J("Fraction is not in range (0.0 - 1.0]");this._densifyFrac=e},Ja.prototype.compute=function(e,n){this.computeOrientedDistance(e,n,this._ptDist),this.computeOrientedDistance(n,e,this._ptDist)},Ja.prototype.distance=function(){return this.compute(this._g0,this._g1),this._ptDist.getDistance()},Ja.prototype.computeOrientedDistance=function(e,n,c){var f=new Ls(n);if(e.apply(f),c.setMaximum(f.getMaxPointDistance()),this._densifyFrac>0){var x=new as(n,this._densifyFrac);e.apply(x),c.setMaximum(x.getMaxPointDistance())}},Ja.prototype.orientedDistance=function(){return this.computeOrientedDistance(this._g0,this._g1,this._ptDist),this._ptDist.getDistance()},Ja.prototype.interfaces_=function(){return[]},Ja.prototype.getClass=function(){return Ja},Ja.distance=function(){if(2===arguments.length)return new Ja(arguments[0],arguments[1]).distance();if(3===arguments.length){var x=arguments[2],L=new Ja(arguments[0],arguments[1]);return L.setDensifyFraction(x),L.distance()}},Cu.MaxPointDistanceFilter.get=function(){return Ls},Cu.MaxDensifiedByFractionDistanceFilter.get=function(){return as},Object.defineProperties(Ja,Cu);var Ls=function(){this._maxPtDist=new ro,this._minPtDist=new ro,this._euclideanDist=new Ma,this._geom=null,this._geom=arguments[0]};Ls.prototype.filter=function(e){this._minPtDist.initialize(),Ma.computeDistance(this._geom,e,this._minPtDist),this._maxPtDist.setMaximum(this._minPtDist)},Ls.prototype.getMaxPointDistance=function(){return this._maxPtDist},Ls.prototype.interfaces_=function(){return[On]},Ls.prototype.getClass=function(){return Ls};var as=function(){this._maxPtDist=new ro,this._minPtDist=new ro,this._geom=null,this._numSubSegs=0;var n=arguments[1];this._geom=arguments[0],this._numSubSegs=Math.trunc(Math.round(1/n))};as.prototype.filter=function(e,n){if(0===n)return null;for(var c=e.getCoordinate(n-1),f=e.getCoordinate(n),x=(f.x-c.x)/this._numSubSegs,L=(f.y-c.y)/this._numSubSegs,z=0;z<this._numSubSegs;z++){var Zt=new j(c.x+z*x,c.y+z*L);this._minPtDist.initialize(),Ma.computeDistance(this._geom,Zt,this._minPtDist),this._maxPtDist.setMaximum(this._minPtDist)}},as.prototype.isDone=function(){return!1},as.prototype.isGeometryChanged=function(){return!1},as.prototype.getMaxPointDistance=function(){return this._maxPtDist},as.prototype.interfaces_=function(){return[Pr]},as.prototype.getClass=function(){return as};var mi=function(e,n,c){this._minValidDistance=null,this._maxValidDistance=null,this._minDistanceFound=null,this._maxDistanceFound=null,this._isValid=!0,this._errMsg=null,this._errorLocation=null,this._errorIndicator=null,this._input=e||null,this._bufDistance=n||null,this._result=c||null},Ta={VERBOSE:{configurable:!0},MAX_DISTANCE_DIFF_FRAC:{configurable:!0}};mi.prototype.checkMaximumDistance=function(e,n,c){var f=new Ja(n,e);if(f.setDensifyFraction(.25),this._maxDistanceFound=f.orientedDistance(),this._maxDistanceFound>c){this._isValid=!1;var x=f.getCoordinates();this._errorLocation=x[1],this._errorIndicator=e.getFactory().createLineString(x),this._errMsg="Distance between buffer curve and input is too large ("+this._maxDistanceFound+" at "+le.toLineString(x[0],x[1])+")"}},mi.prototype.isValid=function(){var e=Math.abs(this._bufDistance),n=mi.MAX_DISTANCE_DIFF_FRAC*e;return this._minValidDistance=e-n,this._maxValidDistance=e+n,!(!this._input.isEmpty()&&!this._result.isEmpty())||(this._bufDistance>0?this.checkPositiveValid():this.checkNegativeValid(),mi.VERBOSE&&Sr.out.println("Min Dist= "+this._minDistanceFound+"  err= "+(1-this._minDistanceFound/this._bufDistance)+"  Max Dist= "+this._maxDistanceFound+"  err= "+(this._maxDistanceFound/this._bufDistance-1)),this._isValid)},mi.prototype.checkNegativeValid=function(){if(!(this._input instanceof ln||this._input instanceof un||this._input instanceof De))return null;var e=this.getPolygonLines(this._input);if(this.checkMinimumDistance(e,this._result,this._minValidDistance),!this._isValid)return null;this.checkMaximumDistance(e,this._result,this._maxValidDistance)},mi.prototype.getErrorIndicator=function(){return this._errorIndicator},mi.prototype.checkMinimumDistance=function(e,n,c){var f=new Ao(e,n,c);if(this._minDistanceFound=f.distance(),this._minDistanceFound<c){this._isValid=!1;var x=f.nearestPoints();this._errorLocation=f.nearestPoints()[1],this._errorIndicator=e.getFactory().createLineString(x),this._errMsg="Distance between buffer curve and input is too small ("+this._minDistanceFound+" at "+le.toLineString(x[0],x[1])+" )"}},mi.prototype.checkPositiveValid=function(){var e=this._result.getBoundary();if(this.checkMinimumDistance(this._input,e,this._minValidDistance),!this._isValid)return null;this.checkMaximumDistance(this._input,e,this._maxValidDistance)},mi.prototype.getErrorLocation=function(){return this._errorLocation},mi.prototype.getPolygonLines=function(e){for(var n=new Je,c=new Ui(n),f=os.getPolygons(e).iterator();f.hasNext();)f.next().apply(c);return e.getFactory().buildGeometry(n)},mi.prototype.getErrorMessage=function(){return this._errMsg},mi.prototype.interfaces_=function(){return[]},mi.prototype.getClass=function(){return mi},Ta.VERBOSE.get=function(){return!1},Ta.MAX_DISTANCE_DIFF_FRAC.get=function(){return.012},Object.defineProperties(mi,Ta);var wo=function(e,n,c){this._isValid=!0,this._errorMsg=null,this._errorLocation=null,this._errorIndicator=null,this._input=e||null,this._distance=n||null,this._result=c||null},Eo={VERBOSE:{configurable:!0},MAX_ENV_DIFF_FRAC:{configurable:!0}};wo.prototype.isValid=function(){return this.checkPolygonal(),this._isValid?(this.checkExpectedEmpty(),this._isValid?(this.checkEnvelope(),this._isValid?(this.checkArea(),this._isValid?(this.checkDistance(),this._isValid):this._isValid):this._isValid):this._isValid):this._isValid},wo.prototype.checkEnvelope=function(){if(this._distance<0)return null;var e=this._distance*wo.MAX_ENV_DIFF_FRAC;0===e&&(e=.001);var n=new ke(this._input.getEnvelopeInternal());n.expandBy(this._distance);var c=new ke(this._result.getEnvelopeInternal());c.expandBy(e),c.contains(n)||(this._isValid=!1,this._errorMsg="Buffer envelope is incorrect",this._errorIndicator=this._input.getFactory().toGeometry(c)),this.report("Envelope")},wo.prototype.checkDistance=function(){var e=new mi(this._input,this._distance,this._result);e.isValid()||(this._isValid=!1,this._errorMsg=e.getErrorMessage(),this._errorLocation=e.getErrorLocation(),this._errorIndicator=e.getErrorIndicator()),this.report("Distance")},wo.prototype.checkArea=function(){var e=this._input.getArea(),n=this._result.getArea();this._distance>0&&e>n&&(this._isValid=!1,this._errorMsg="Area of positive buffer is smaller than input",this._errorIndicator=this._result),this._distance<0&&e<n&&(this._isValid=!1,this._errorMsg="Area of negative buffer is larger than input",this._errorIndicator=this._result),this.report("Area")},wo.prototype.checkPolygonal=function(){this._result instanceof ln||this._result instanceof un||(this._isValid=!1),this._errorMsg="Result is not polygonal",this._errorIndicator=this._result,this.report("Polygonal")},wo.prototype.getErrorIndicator=function(){return this._errorIndicator},wo.prototype.getErrorLocation=function(){return this._errorLocation},wo.prototype.checkExpectedEmpty=function(){return this._input.getDimension()>=2||this._distance>0?null:(this._result.isEmpty()||(this._isValid=!1,this._errorMsg="Result is non-empty",this._errorIndicator=this._result),void this.report("ExpectedEmpty"))},wo.prototype.report=function(e){if(!wo.VERBOSE)return null;Sr.out.println("Check "+e+": "+(this._isValid?"passed":"FAILED"))},wo.prototype.getErrorMessage=function(){return this._errorMsg},wo.prototype.interfaces_=function(){return[]},wo.prototype.getClass=function(){return wo},wo.isValidMsg=function(e,n,c){var f=new wo(e,n,c);return f.isValid()?null:f.getErrorMessage()},wo.isValid=function(e,n,c){return!!new wo(e,n,c).isValid()},Eo.VERBOSE.get=function(){return!1},Eo.MAX_ENV_DIFF_FRAC.get=function(){return.012},Object.defineProperties(wo,Eo);var Hi=function(){this._pts=null,this._data=null;var n=arguments[1];this._pts=arguments[0],this._data=n};Hi.prototype.getCoordinates=function(){return this._pts},Hi.prototype.size=function(){return this._pts.length},Hi.prototype.getCoordinate=function(e){return this._pts[e]},Hi.prototype.isClosed=function(){return this._pts[0].equals(this._pts[this._pts.length-1])},Hi.prototype.getSegmentOctant=function(e){return e===this._pts.length-1?-1:Ms.octant(this.getCoordinate(e),this.getCoordinate(e+1))},Hi.prototype.setData=function(e){this._data=e},Hi.prototype.getData=function(){return this._data},Hi.prototype.toString=function(){return le.toLineString(new Un(this._pts))},Hi.prototype.interfaces_=function(){return[Fo]},Hi.prototype.getClass=function(){return Hi};var nr=function(){this._findAllIntersections=!1,this._isCheckEndSegmentsOnly=!1,this._li=null,this._interiorIntersection=null,this._intSegments=null,this._intersections=new Je,this._intersectionCount=0,this._keepIntersections=!0,this._li=arguments[0],this._interiorIntersection=null};nr.prototype.getInteriorIntersection=function(){return this._interiorIntersection},nr.prototype.setCheckEndSegmentsOnly=function(e){this._isCheckEndSegmentsOnly=e},nr.prototype.getIntersectionSegments=function(){return this._intSegments},nr.prototype.count=function(){return this._intersectionCount},nr.prototype.getIntersections=function(){return this._intersections},nr.prototype.setFindAllIntersections=function(e){this._findAllIntersections=e},nr.prototype.setKeepIntersections=function(e){this._keepIntersections=e},nr.prototype.processIntersections=function(e,n,c,f){if(!this._findAllIntersections&&this.hasIntersection()||e===c&&n===f||this._isCheckEndSegmentsOnly&&!this.isEndSegment(e,n)&&!this.isEndSegment(c,f))return null;var x=e.getCoordinates()[n],L=e.getCoordinates()[n+1],z=c.getCoordinates()[f],W=c.getCoordinates()[f+1];this._li.computeIntersection(x,L,z,W),this._li.hasIntersection()&&this._li.isInteriorIntersection()&&(this._intSegments=new Array(4).fill(null),this._intSegments[0]=x,this._intSegments[1]=L,this._intSegments[2]=z,this._intSegments[3]=W,this._interiorIntersection=this._li.getIntersection(0),this._keepIntersections&&this._intersections.add(this._interiorIntersection),this._intersectionCount++)},nr.prototype.isEndSegment=function(e,n){return 0===n||n>=e.size()-2},nr.prototype.hasIntersection=function(){return null!==this._interiorIntersection},nr.prototype.isDone=function(){return!this._findAllIntersections&&null!==this._interiorIntersection},nr.prototype.interfaces_=function(){return[Js]},nr.prototype.getClass=function(){return nr},nr.createAllIntersectionsFinder=function(e){var n=new nr(e);return n.setFindAllIntersections(!0),n},nr.createAnyIntersectionFinder=function(e){return new nr(e)},nr.createIntersectionCounter=function(e){var n=new nr(e);return n.setFindAllIntersections(!0),n.setKeepIntersections(!1),n};var ia=function(){this._li=new Ee,this._segStrings=null,this._findAllIntersections=!1,this._segInt=null,this._isValid=!0,this._segStrings=arguments[0]};ia.prototype.execute=function(){if(null!==this._segInt)return null;this.checkInteriorIntersections()},ia.prototype.getIntersections=function(){return this._segInt.getIntersections()},ia.prototype.isValid=function(){return this.execute(),this._isValid},ia.prototype.setFindAllIntersections=function(e){this._findAllIntersections=e},ia.prototype.checkInteriorIntersections=function(){this._isValid=!0,this._segInt=new nr(this._li),this._segInt.setFindAllIntersections(this._findAllIntersections);var e=new cu;if(e.setSegmentIntersector(this._segInt),e.computeNodes(this._segStrings),this._segInt.hasIntersection())return this._isValid=!1,null},ia.prototype.checkValid=function(){if(this.execute(),!this._isValid)throw new Fs(this.getErrorMessage(),this._segInt.getInteriorIntersection())},ia.prototype.getErrorMessage=function(){if(this._isValid)return"no intersections found";var e=this._segInt.getIntersectionSegments();return"found non-noded intersection between "+le.toLineString(e[0],e[1])+" and "+le.toLineString(e[2],e[3])},ia.prototype.interfaces_=function(){return[]},ia.prototype.getClass=function(){return ia},ia.computeIntersections=function(e){var n=new ia(e);return n.setFindAllIntersections(!0),n.isValid(),n.getIntersections()};var Ka=function e(){this._nv=null,this._nv=new ia(e.toSegmentStrings(arguments[0]))};Ka.prototype.checkValid=function(){this._nv.checkValid()},Ka.prototype.interfaces_=function(){return[]},Ka.prototype.getClass=function(){return Ka},Ka.toSegmentStrings=function(e){for(var n=new Je,c=e.iterator();c.hasNext();){var f=c.next();n.add(new Hi(f.getCoordinates(),f))}return n},Ka.checkValid=function(e){new Ka(e).checkValid()};var Aa=function(e){this._mapOp=e};Aa.prototype.map=function(e){for(var n=new Je,c=0;c<e.getNumGeometries();c++){var f=this._mapOp.map(e.getGeometryN(c));f.isEmpty()||n.add(f)}return e.getFactory().createGeometryCollection(nn.toGeometryArray(n))},Aa.prototype.interfaces_=function(){return[]},Aa.prototype.getClass=function(){return Aa},Aa.map=function(e,n){return new Aa(n).map(e)};var qi=function(){this._op=null,this._geometryFactory=null,this._ptLocator=null,this._lineEdgesList=new Je,this._resultLineList=new Je;var n=arguments[1],c=arguments[2];this._op=arguments[0],this._geometryFactory=n,this._ptLocator=c};qi.prototype.collectLines=function(e){for(var n=this._op.getGraph().getEdgeEnds().iterator();n.hasNext();){var c=n.next();this.collectLineEdge(c,e,this._lineEdgesList),this.collectBoundaryTouchEdge(c,e,this._lineEdgesList)}},qi.prototype.labelIsolatedLine=function(e,n){var c=this._ptLocator.locate(e.getCoordinate(),this._op.getArgGeometry(n));e.getLabel().setLocation(n,c)},qi.prototype.build=function(e){return this.findCoveredLineEdges(),this.collectLines(e),this.buildLines(e),this._resultLineList},qi.prototype.collectLineEdge=function(e,n,c){var f=e.getLabel(),x=e.getEdge();e.isLineEdge()&&(e.isVisited()||!Wr.isResultOfOp(f,n)||x.isCovered()||(c.add(x),e.setVisitedEdge(!0)))},qi.prototype.findCoveredLineEdges=function(){for(var e=this._op.getGraph().getNodes().iterator();e.hasNext();)e.next().getEdges().findCoveredLineEdges();for(var n=this._op.getGraph().getEdgeEnds().iterator();n.hasNext();){var c=n.next(),f=c.getEdge();if(c.isLineEdge()&&!f.isCoveredSet()){var x=this._op.isCoveredByA(c.getCoordinate());f.setCovered(x)}}},qi.prototype.labelIsolatedLines=function(e){for(var n=e.iterator();n.hasNext();){var c=n.next(),f=c.getLabel();c.isIsolated()&&(f.isNull(0)?this.labelIsolatedLine(c,0):this.labelIsolatedLine(c,1))}},qi.prototype.buildLines=function(e){for(var n=this._lineEdgesList.iterator();n.hasNext();){var c=n.next(),f=this._geometryFactory.createLineString(c.getCoordinates());this._resultLineList.add(f),c.setInResult(!0)}},qi.prototype.collectBoundaryTouchEdge=function(e,n,c){var f=e.getLabel();return e.isLineEdge()||e.isVisited()||e.isInteriorAreaEdge()||e.getEdge().isInResult()?null:(tt.isTrue(!(e.isInResult()||e.getSym().isInResult())||!e.getEdge().isInResult()),void(Wr.isResultOfOp(f,n)&&n===Wr.INTERSECTION&&(c.add(e.getEdge()),e.setVisitedEdge(!0))))},qi.prototype.interfaces_=function(){return[]},qi.prototype.getClass=function(){return qi};var bs=function(){this._op=null,this._geometryFactory=null,this._resultPointList=new Je;var n=arguments[1];this._op=arguments[0],this._geometryFactory=n};bs.prototype.filterCoveredNodeToPoint=function(e){var n=e.getCoordinate();if(!this._op.isCoveredByLA(n)){var c=this._geometryFactory.createPoint(n);this._resultPointList.add(c)}},bs.prototype.extractNonCoveredResultNodes=function(e){for(var n=this._op.getGraph().getNodes().iterator();n.hasNext();){var c=n.next();if(!(c.isInResult()||c.isIncidentEdgeInResult()||0!==c.getEdges().getDegree()&&e!==Wr.INTERSECTION)){var f=c.getLabel();Wr.isResultOfOp(f,e)&&this.filterCoveredNodeToPoint(c)}}},bs.prototype.build=function(e){return this.extractNonCoveredResultNodes(e),this._resultPointList},bs.prototype.interfaces_=function(){return[]},bs.prototype.getClass=function(){return bs};var Si=function(){this._inputGeom=null,this._factory=null,this._pruneEmptyGeometry=!0,this._preserveGeometryCollectionType=!0,this._preserveCollections=!1,this._preserveType=!1};Si.prototype.transformPoint=function(e,n){return this._factory.createPoint(this.transformCoordinates(e.getCoordinateSequence(),e))},Si.prototype.transformPolygon=function(e,n){var c=!0,f=this.transformLinearRing(e.getExteriorRing(),e);null!==f&&f instanceof zn&&!f.isEmpty()||(c=!1);for(var x=new Je,L=0;L<e.getNumInteriorRing();L++){var z=this.transformLinearRing(e.getInteriorRingN(L),e);null===z||z.isEmpty()||(z instanceof zn||(c=!1),x.add(z))}if(c)return this._factory.createPolygon(f,x.toArray([]));var W=new Je;return null!==f&&W.add(f),W.addAll(x),this._factory.buildGeometry(W)},Si.prototype.createCoordinateSequence=function(e){return this._factory.getCoordinateSequenceFactory().create(e)},Si.prototype.getInputGeometry=function(){return this._inputGeom},Si.prototype.transformMultiLineString=function(e,n){for(var c=new Je,f=0;f<e.getNumGeometries();f++){var x=this.transformLineString(e.getGeometryN(f),e);null!==x&&(x.isEmpty()||c.add(x))}return this._factory.buildGeometry(c)},Si.prototype.transformCoordinates=function(e,n){return this.copy(e)},Si.prototype.transformLineString=function(e,n){return this._factory.createLineString(this.transformCoordinates(e.getCoordinateSequence(),e))},Si.prototype.transformMultiPoint=function(e,n){for(var c=new Je,f=0;f<e.getNumGeometries();f++){var x=this.transformPoint(e.getGeometryN(f),e);null!==x&&(x.isEmpty()||c.add(x))}return this._factory.buildGeometry(c)},Si.prototype.transformMultiPolygon=function(e,n){for(var c=new Je,f=0;f<e.getNumGeometries();f++){var x=this.transformPolygon(e.getGeometryN(f),e);null!==x&&(x.isEmpty()||c.add(x))}return this._factory.buildGeometry(c)},Si.prototype.copy=function(e){return e.copy()},Si.prototype.transformGeometryCollection=function(e,n){for(var c=new Je,f=0;f<e.getNumGeometries();f++){var x=this.transform(e.getGeometryN(f));null!==x&&(this._pruneEmptyGeometry&&x.isEmpty()||c.add(x))}return this._preserveGeometryCollectionType?this._factory.createGeometryCollection(nn.toGeometryArray(c)):this._factory.buildGeometry(c)},Si.prototype.transform=function(e){if(this._inputGeom=e,this._factory=e.getFactory(),e instanceof Tn)return this.transformPoint(e,null);if(e instanceof xi)return this.transformMultiPoint(e,null);if(e instanceof zn)return this.transformLinearRing(e,null);if(e instanceof zr)return this.transformLineString(e,null);if(e instanceof sr)return this.transformMultiLineString(e,null);if(e instanceof ln)return this.transformPolygon(e,null);if(e instanceof un)return this.transformMultiPolygon(e,null);if(e instanceof De)return this.transformGeometryCollection(e,null);throw new J("Unknown Geometry subtype: "+e.getClass().getName())},Si.prototype.transformLinearRing=function(e,n){var c=this.transformCoordinates(e.getCoordinateSequence(),e);if(null===c)return this._factory.createLinearRing(null);var f=c.size();return f>0&&f<4&&!this._preserveType?this._factory.createLineString(c):this._factory.createLinearRing(c)},Si.prototype.interfaces_=function(){return[]},Si.prototype.getClass=function(){return Si};var gr=function e(){if(this._snapTolerance=0,this._srcPts=null,this._seg=new kr,this._allowSnappingToSourceVertices=!1,this._isClosed=!1,arguments[0]instanceof zr&&"number"==typeof arguments[1]){var c=arguments[1];e.call(this,arguments[0].getCoordinates(),c)}else if(arguments[0]instanceof Array&&"number"==typeof arguments[1]){var f=arguments[0],x=arguments[1];this._srcPts=f,this._isClosed=e.isClosed(f),this._snapTolerance=x}};gr.prototype.snapVertices=function(e,n){for(var c=this._isClosed?e.size()-1:e.size(),f=0;f<c;f++){var x=e.get(f),L=this.findSnapForVertex(x,n);null!==L&&(e.set(f,new j(L)),0===f&&this._isClosed&&e.set(e.size()-1,new j(L)))}},gr.prototype.findSnapForVertex=function(e,n){for(var c=0;c<n.length;c++){if(e.equals2D(n[c]))return null;if(e.distance(n[c])<this._snapTolerance)return n[c]}return null},gr.prototype.snapTo=function(e){var n=new Z(this._srcPts);return this.snapVertices(n,e),this.snapSegments(n,e),n.toCoordinateArray()},gr.prototype.snapSegments=function(e,n){if(0===n.length)return null;var c=n.length;n[0].equals2D(n[n.length-1])&&(c=n.length-1);for(var f=0;f<c;f++){var x=n[f],L=this.findSegmentIndexToSnap(x,e);L>=0&&e.add(L+1,new j(x),!1)}},gr.prototype.findSegmentIndexToSnap=function(e,n){for(var c=$.MAX_VALUE,f=-1,x=0;x<n.size()-1;x++){if(this._seg.p0=n.get(x),this._seg.p1=n.get(x+1),this._seg.p0.equals2D(e)||this._seg.p1.equals2D(e)){if(this._allowSnappingToSourceVertices)continue;return-1}var L=this._seg.distance(e);L<this._snapTolerance&&L<c&&(c=L,f=x)}return f},gr.prototype.setAllowSnappingToSourceVertices=function(e){this._allowSnappingToSourceVertices=e},gr.prototype.interfaces_=function(){return[]},gr.prototype.getClass=function(){return gr},gr.isClosed=function(e){return!(e.length<=1)&&e[0].equals2D(e[e.length-1])};var ki=function(e){this._srcGeom=e||null},Ju={SNAP_PRECISION_FACTOR:{configurable:!0}};ki.prototype.snapTo=function(e,n){var c=this.extractTargetCoordinates(e);return new $a(n,c).transform(this._srcGeom)},ki.prototype.snapToSelf=function(e,n){var c=this.extractTargetCoordinates(this._srcGeom),f=new $a(e,c,!0).transform(this._srcGeom),x=f;return n&&Te(x,xn)&&(x=f.buffer(0)),x},ki.prototype.computeSnapTolerance=function(e){return this.computeMinimumSegmentLength(e)/10},ki.prototype.extractTargetCoordinates=function(e){for(var n=new _e,c=e.getCoordinates(),f=0;f<c.length;f++)n.add(c[f]);return n.toArray(new Array(0).fill(null))},ki.prototype.computeMinimumSegmentLength=function(e){for(var n=$.MAX_VALUE,c=0;c<e.length-1;c++){var f=e[c].distance(e[c+1]);f<n&&(n=f)}return n},ki.prototype.interfaces_=function(){return[]},ki.prototype.getClass=function(){return ki},ki.snap=function(e,n,c){var f=new Array(2).fill(null),x=new ki(e);f[0]=x.snapTo(n,c);var L=new ki(n);return f[1]=L.snapTo(f[0],c),f},ki.computeOverlaySnapTolerance=function(){if(1===arguments.length){var e=arguments[0],n=ki.computeSizeBasedSnapTolerance(e),c=e.getPrecisionModel();if(c.getType()===bn.FIXED){var f=1/c.getScale()*2/1.415;f>n&&(n=f)}return n}if(2===arguments.length){var L=arguments[1];return Math.min(ki.computeOverlaySnapTolerance(arguments[0]),ki.computeOverlaySnapTolerance(L))}},ki.computeSizeBasedSnapTolerance=function(e){var n=e.getEnvelopeInternal();return Math.min(n.getHeight(),n.getWidth())*ki.SNAP_PRECISION_FACTOR},ki.snapToSelf=function(e,n,c){return new ki(e).snapToSelf(n,c)},Ju.SNAP_PRECISION_FACTOR.get=function(){return 1e-9},Object.defineProperties(ki,Ju);var $a=function(e){function n(c,f,x){e.call(this),this._snapTolerance=c||null,this._snapPts=f||null,this._isSelfSnap=void 0!==x&&x}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype.snapLine=function(c,f){var x=new gr(c,this._snapTolerance);return x.setAllowSnappingToSourceVertices(this._isSelfSnap),x.snapTo(f)},n.prototype.transformCoordinates=function(c,f){var x=c.toCoordinateArray(),L=this.snapLine(x,this._snapPts);return this._factory.getCoordinateSequenceFactory().create(L)},n.prototype.interfaces_=function(){return[]},n.prototype.getClass=function(){return n},n}(Si),yi=function(){this._isFirst=!0,this._commonMantissaBitsCount=53,this._commonBits=0,this._commonSignExp=null};yi.prototype.getCommon=function(){return $.longBitsToDouble(this._commonBits)},yi.prototype.add=function(e){var n=$.doubleToLongBits(e);return this._isFirst?(this._commonBits=n,this._commonSignExp=yi.signExpBits(this._commonBits),this._isFirst=!1,null):yi.signExpBits(n)!==this._commonSignExp?(this._commonBits=0,null):(this._commonMantissaBitsCount=yi.numCommonMostSigMantissaBits(this._commonBits,n),void(this._commonBits=yi.zeroLowerBits(this._commonBits,64-(12+this._commonMantissaBitsCount))))},yi.prototype.toString=function(){if(1===arguments.length){var e=arguments[0],n=$.longBitsToDouble(e),c="0000000000000000000000000000000000000000000000000000000000000000"+$.toBinaryString(e),f=c.substring(c.length-64);return f.substring(0,1)+"  "+f.substring(1,12)+"(exp) "+f.substring(12)+" [ "+n+" ]"}},yi.prototype.interfaces_=function(){return[]},yi.prototype.getClass=function(){return yi},yi.getBit=function(e,n){return 0!=(e&1<<n)?1:0},yi.signExpBits=function(e){return e>>52},yi.zeroLowerBits=function(e,n){return e&~((1<<n)-1)},yi.numCommonMostSigMantissaBits=function(e,n){for(var c=0,f=52;f>=0;f--){if(yi.getBit(e,f)!==yi.getBit(n,f))return c;c++}return 52};var ws=function(){this._commonCoord=null,this._ccFilter=new eu},xl={CommonCoordinateFilter:{configurable:!0},Translater:{configurable:!0}};ws.prototype.addCommonBits=function(e){var n=new no(this._commonCoord);e.apply(n),e.geometryChanged()},ws.prototype.removeCommonBits=function(e){if(0===this._commonCoord.x&&0===this._commonCoord.y)return e;var n=new j(this._commonCoord);n.x=-n.x,n.y=-n.y;var c=new no(n);return e.apply(c),e.geometryChanged(),e},ws.prototype.getCommonCoordinate=function(){return this._commonCoord},ws.prototype.add=function(e){e.apply(this._ccFilter),this._commonCoord=this._ccFilter.getCommonCoordinate()},ws.prototype.interfaces_=function(){return[]},ws.prototype.getClass=function(){return ws},xl.CommonCoordinateFilter.get=function(){return eu},xl.Translater.get=function(){return no},Object.defineProperties(ws,xl);var eu=function(){this._commonBitsX=new yi,this._commonBitsY=new yi};eu.prototype.filter=function(e){this._commonBitsX.add(e.x),this._commonBitsY.add(e.y)},eu.prototype.getCommonCoordinate=function(){return new j(this._commonBitsX.getCommon(),this._commonBitsY.getCommon())},eu.prototype.interfaces_=function(){return[On]},eu.prototype.getClass=function(){return eu};var no=function(){this.trans=null,this.trans=arguments[0]};no.prototype.filter=function(e,n){var c=e.getOrdinate(n,0)+this.trans.x,f=e.getOrdinate(n,1)+this.trans.y;e.setOrdinate(n,0,c),e.setOrdinate(n,1,f)},no.prototype.isDone=function(){return!1},no.prototype.isGeometryChanged=function(){return!0},no.prototype.interfaces_=function(){return[Pr]},no.prototype.getClass=function(){return no};var zi=function(e,n){this._geom=new Array(2).fill(null),this._snapTolerance=null,this._cbr=null,this._geom[0]=e,this._geom[1]=n,this.computeSnapTolerance()};zi.prototype.selfSnap=function(e){return new ki(e).snapTo(e,this._snapTolerance)},zi.prototype.removeCommonBits=function(e){this._cbr=new ws,this._cbr.add(e[0]),this._cbr.add(e[1]);var n=new Array(2).fill(null);return n[0]=this._cbr.removeCommonBits(e[0].copy()),n[1]=this._cbr.removeCommonBits(e[1].copy()),n},zi.prototype.prepareResult=function(e){return this._cbr.addCommonBits(e),e},zi.prototype.getResultGeometry=function(e){var n=this.snap(this._geom),c=Wr.overlayOp(n[0],n[1],e);return this.prepareResult(c)},zi.prototype.checkValid=function(e){e.isValid()||Sr.out.println("Snapped geometry is invalid")},zi.prototype.computeSnapTolerance=function(){this._snapTolerance=ki.computeOverlaySnapTolerance(this._geom[0],this._geom[1])},zi.prototype.snap=function(e){var n=this.removeCommonBits(e);return ki.snap(n[0],n[1],this._snapTolerance)},zi.prototype.interfaces_=function(){return[]},zi.prototype.getClass=function(){return zi},zi.overlayOp=function(e,n,c){return new zi(e,n).getResultGeometry(c)},zi.union=function(e,n){return zi.overlayOp(e,n,Wr.UNION)},zi.intersection=function(e,n){return zi.overlayOp(e,n,Wr.INTERSECTION)},zi.symDifference=function(e,n){return zi.overlayOp(e,n,Wr.SYMDIFFERENCE)},zi.difference=function(e,n){return zi.overlayOp(e,n,Wr.DIFFERENCE)};var Lo=function(e,n){this._geom=new Array(2).fill(null),this._geom[0]=e,this._geom[1]=n};Lo.prototype.getResultGeometry=function(e){var n=null,c=!1,f=null;try{n=Wr.overlayOp(this._geom[0],this._geom[1],e),c=!0}catch(x){if(!(x instanceof ot))throw x;f=x}if(!c)try{n=zi.overlayOp(this._geom[0],this._geom[1],e)}catch(x){throw x instanceof ot?f:x}return n},Lo.prototype.interfaces_=function(){return[]},Lo.prototype.getClass=function(){return Lo},Lo.overlayOp=function(e,n,c){return new Lo(e,n).getResultGeometry(c)},Lo.union=function(e,n){return Lo.overlayOp(e,n,Wr.UNION)},Lo.intersection=function(e,n){return Lo.overlayOp(e,n,Wr.INTERSECTION)},Lo.symDifference=function(e,n){return Lo.overlayOp(e,n,Wr.SYMDIFFERENCE)},Lo.difference=function(e,n){return Lo.overlayOp(e,n,Wr.DIFFERENCE)};var gu=function(){this.mce=null,this.chainIndex=null;var n=arguments[1];this.mce=arguments[0],this.chainIndex=n};gu.prototype.computeIntersections=function(e,n){this.mce.computeIntersectsForChain(this.chainIndex,e.mce,e.chainIndex,n)},gu.prototype.interfaces_=function(){return[]},gu.prototype.getClass=function(){return gu};var Ko=function e(){if(this._label=null,this._xValue=null,this._eventType=null,this._insertEvent=null,this._deleteEventIndex=null,this._obj=null,2===arguments.length){var n=arguments[0],c=arguments[1];this._eventType=e.DELETE,this._xValue=n,this._insertEvent=c}else if(3===arguments.length){var f=arguments[0],x=arguments[1],L=arguments[2];this._eventType=e.INSERT,this._label=f,this._xValue=x,this._obj=L}},oa={INSERT:{configurable:!0},DELETE:{configurable:!0}};Ko.prototype.isDelete=function(){return this._eventType===Ko.DELETE},Ko.prototype.setDeleteEventIndex=function(e){this._deleteEventIndex=e},Ko.prototype.getObject=function(){return this._obj},Ko.prototype.compareTo=function(e){return this._xValue<e._xValue?-1:this._xValue>e._xValue?1:this._eventType<e._eventType?-1:this._eventType>e._eventType?1:0},Ko.prototype.getInsertEvent=function(){return this._insertEvent},Ko.prototype.isInsert=function(){return this._eventType===Ko.INSERT},Ko.prototype.isSameLabel=function(e){return null!==this._label&&this._label===e._label},Ko.prototype.getDeleteEventIndex=function(){return this._deleteEventIndex},Ko.prototype.interfaces_=function(){return[Q]},Ko.prototype.getClass=function(){return Ko},oa.INSERT.get=function(){return 1},oa.DELETE.get=function(){return 2},Object.defineProperties(Ko,oa);var qu=function(){};qu.prototype.interfaces_=function(){return[]},qu.prototype.getClass=function(){return qu};var Sn=function(){this._hasIntersection=!1,this._hasProper=!1,this._hasProperInterior=!1,this._properIntersectionPoint=null,this._li=null,this._includeProper=null,this._recordIsolated=null,this._isSelfIntersection=null,this._numIntersections=0,this.numTests=0,this._bdyNodes=null,this._isDone=!1,this._isDoneWhenProperInt=!1;var n=arguments[1],c=arguments[2];this._li=arguments[0],this._includeProper=n,this._recordIsolated=c};Sn.prototype.isTrivialIntersection=function(e,n,c,f){if(e===c&&1===this._li.getIntersectionNum()){if(Sn.isAdjacentSegments(n,f))return!0;if(e.isClosed()){var x=e.getNumPoints()-1;if(0===n&&f===x||0===f&&n===x)return!0}}return!1},Sn.prototype.getProperIntersectionPoint=function(){return this._properIntersectionPoint},Sn.prototype.setIsDoneIfProperInt=function(e){this._isDoneWhenProperInt=e},Sn.prototype.hasProperInteriorIntersection=function(){return this._hasProperInterior},Sn.prototype.isBoundaryPointInternal=function(e,n){for(var c=n.iterator();c.hasNext();){var f=c.next().getCoordinate();if(e.isIntersection(f))return!0}return!1},Sn.prototype.hasProperIntersection=function(){return this._hasProper},Sn.prototype.hasIntersection=function(){return this._hasIntersection},Sn.prototype.isDone=function(){return this._isDone},Sn.prototype.isBoundaryPoint=function(e,n){return!(null===n||!this.isBoundaryPointInternal(e,n[0])&&!this.isBoundaryPointInternal(e,n[1]))},Sn.prototype.setBoundaryNodes=function(e,n){this._bdyNodes=new Array(2).fill(null),this._bdyNodes[0]=e,this._bdyNodes[1]=n},Sn.prototype.addIntersections=function(e,n,c,f){if(e===c&&n===f)return null;this.numTests++;var x=e.getCoordinates()[n],L=e.getCoordinates()[n+1],z=c.getCoordinates()[f],W=c.getCoordinates()[f+1];this._li.computeIntersection(x,L,z,W),this._li.hasIntersection()&&(this._recordIsolated&&(e.setIsolated(!1),c.setIsolated(!1)),this._numIntersections++,this.isTrivialIntersection(e,n,c,f)||(this._hasIntersection=!0,!this._includeProper&&this._li.isProper()||(e.addIntersections(this._li,n,0),c.addIntersections(this._li,f,1)),this._li.isProper()&&(this._properIntersectionPoint=this._li.getIntersection(0).copy(),this._hasProper=!0,this._isDoneWhenProperInt&&(this._isDone=!0),this.isBoundaryPoint(this._li,this._bdyNodes)||(this._hasProperInterior=!0))))},Sn.prototype.interfaces_=function(){return[]},Sn.prototype.getClass=function(){return Sn},Sn.isAdjacentSegments=function(e,n){return 1===Math.abs(e-n)};var ti=function(e){function n(){e.call(this),this.events=new Je,this.nOverlaps=null}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype.prepareEvents=function(){fa.sort(this.events);for(var c=0;c<this.events.size();c++){var f=this.events.get(c);f.isDelete()&&f.getInsertEvent().setDeleteEventIndex(c)}},n.prototype.computeIntersections=function(){if(1===arguments.length){var c=arguments[0];this.nOverlaps=0,this.prepareEvents();for(var f=0;f<this.events.size();f++){var x=this.events.get(f);if(x.isInsert()&&this.processOverlaps(f,x.getDeleteEventIndex(),x,c),c.isDone())break}}else if(3===arguments.length)if(arguments[2]instanceof Sn&&Te(arguments[0],Oi)&&Te(arguments[1],Oi)){var L=arguments[0],z=arguments[1],W=arguments[2];this.addEdges(L,L),this.addEdges(z,z),this.computeIntersections(W)}else if("boolean"==typeof arguments[2]&&Te(arguments[0],Oi)&&arguments[1]instanceof Sn){var gt=arguments[0],Zt=arguments[1];arguments[2]?this.addEdges(gt,null):this.addEdges(gt),this.computeIntersections(Zt)}},n.prototype.addEdge=function(c,f){for(var x=c.getMonotoneChainEdge(),L=x.getStartIndexes(),z=0;z<L.length-1;z++){var W=new gu(x,z),gt=new Ko(f,x.getMinX(z),W);this.events.add(gt),this.events.add(new Ko(x.getMaxX(z),gt))}},n.prototype.processOverlaps=function(c,f,x,L){for(var z=x.getObject(),W=c;W<f;W++){var gt=this.events.get(W);if(gt.isInsert()){var Zt=gt.getObject();x.isSameLabel(gt)||(z.computeIntersections(Zt,L),this.nOverlaps++)}}},n.prototype.addEdges=function(){if(1===arguments.length)for(var c=arguments[0].iterator();c.hasNext();){var f=c.next();this.addEdge(f,f)}else if(2===arguments.length)for(var L=arguments[1],z=arguments[0].iterator();z.hasNext();){var W=z.next();this.addEdge(W,L)}},n.prototype.interfaces_=function(){return[]},n.prototype.getClass=function(){return n},n}(qu),Ji=function(){this._min=$.POSITIVE_INFINITY,this._max=$.NEGATIVE_INFINITY},La={NodeComparator:{configurable:!0}};Ji.prototype.getMin=function(){return this._min},Ji.prototype.intersects=function(e,n){return!(this._min>n||this._max<e)},Ji.prototype.getMax=function(){return this._max},Ji.prototype.toString=function(){return le.toLineString(new j(this._min,0),new j(this._max,0))},Ji.prototype.interfaces_=function(){return[]},Ji.prototype.getClass=function(){return Ji},La.NodeComparator.get=function(){return So},Object.defineProperties(Ji,La);var So=function(){};So.prototype.compare=function(e,n){var x=(e._min+e._max)/2,L=(n._min+n._max)/2;return x<L?-1:x>L?1:0},So.prototype.interfaces_=function(){return[st]},So.prototype.getClass=function(){return So};var ss=function(e){function n(){e.call(this),this._item=null;var f=arguments[1],x=arguments[2];this._min=arguments[0],this._max=f,this._item=x}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype.query=function(c,f,x){if(!this.intersects(c,f))return null;x.visitItem(this._item)},n.prototype.interfaces_=function(){return[]},n.prototype.getClass=function(){return n},n}(Ji),Os=function(e){function n(){e.call(this),this._node1=null,this._node2=null;var f=arguments[1];this._node1=arguments[0],this._node2=f,this.buildExtent(this._node1,this._node2)}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype.buildExtent=function(c,f){this._min=Math.min(c._min,f._min),this._max=Math.max(c._max,f._max)},n.prototype.query=function(c,f,x){if(!this.intersects(c,f))return null;null!==this._node1&&this._node1.query(c,f,x),null!==this._node2&&this._node2.query(c,f,x)},n.prototype.interfaces_=function(){return[]},n.prototype.getClass=function(){return n},n}(Ji),aa=function(){this._leaves=new Je,this._root=null,this._level=0};aa.prototype.buildTree=function(){fa.sort(this._leaves,new Ji.NodeComparator);for(var e=this._leaves,n=null,c=new Je;;){if(this.buildLevel(e,c),1===c.size())return c.get(0);n=e,e=c,c=n}},aa.prototype.insert=function(e,n,c){if(null!==this._root)throw new Error("Index cannot be added to once it has been queried");this._leaves.add(new ss(e,n,c))},aa.prototype.query=function(e,n,c){this.init(),this._root.query(e,n,c)},aa.prototype.buildRoot=function(){if(null!==this._root)return null;this._root=this.buildTree()},aa.prototype.printNode=function(e){Sr.out.println(le.toLineString(new j(e._min,this._level),new j(e._max,this._level)))},aa.prototype.init=function(){if(null!==this._root)return null;this.buildRoot()},aa.prototype.buildLevel=function(e,n){this._level++,n.clear();for(var c=0;c<e.size();c+=2){var f=e.get(c);if(null===(c+1<e.size()?e.get(c):null))n.add(f);else{var x=new Os(e.get(c),e.get(c+1));n.add(x)}}},aa.prototype.interfaces_=function(){return[]},aa.prototype.getClass=function(){return aa};var sa=function(){this._items=new Je};sa.prototype.visitItem=function(e){this._items.add(e)},sa.prototype.getItems=function(){return this._items},sa.prototype.interfaces_=function(){return[ms]},sa.prototype.getClass=function(){return sa};var Qa=function(){this._index=null;var e=arguments[0];if(!Te(e,xn))throw new J("Argument must be Polygonal");this._index=new ho(e)},vr={SegmentVisitor:{configurable:!0},IntervalIndexedGeometry:{configurable:!0}};Qa.prototype.locate=function(e){var n=new Xe(e),c=new Gr(n);return this._index.query(e.y,e.y,c),n.getLocation()},Qa.prototype.interfaces_=function(){return[hu]},Qa.prototype.getClass=function(){return Qa},vr.SegmentVisitor.get=function(){return Gr},vr.IntervalIndexedGeometry.get=function(){return ho},Object.defineProperties(Qa,vr);var Gr=function(){this._counter=null,this._counter=arguments[0]};Gr.prototype.visitItem=function(e){var n=e;this._counter.countSegment(n.getCoordinate(0),n.getCoordinate(1))},Gr.prototype.interfaces_=function(){return[ms]},Gr.prototype.getClass=function(){return Gr};var ho=function(){this._index=new aa,this.init(arguments[0])};ho.prototype.init=function(e){for(var n=Ui.getLines(e).iterator();n.hasNext();){var c=n.next().getCoordinates();this.addLine(c)}},ho.prototype.addLine=function(e){for(var n=1;n<e.length;n++){var c=new kr(e[n-1],e[n]),f=Math.min(c.p0.y,c.p1.y),x=Math.max(c.p0.y,c.p1.y);this._index.insert(f,x,c)}},ho.prototype.query=function(){if(2===arguments.length){var e=arguments[0],n=arguments[1],c=new sa;return this._index.query(e,n,c),c.getItems()}3===arguments.length&&this._index.query(arguments[0],arguments[1],arguments[2])},ho.prototype.interfaces_=function(){return[]},ho.prototype.getClass=function(){return ho};var $o=function(e){function n(){if(e.call(this),this._parentGeom=null,this._lineEdgeMap=new Is,this._boundaryNodeRule=null,this._useBoundaryDeterminationRule=!0,this._argIndex=null,this._boundaryNodes=null,this._hasTooFewPoints=!1,this._invalidPoint=null,this._areaPtLocator=null,this._ptLocator=new bo,2===arguments.length){var f=arguments[1],x=Nn.OGC_SFS_BOUNDARY_RULE;this._argIndex=arguments[0],this._parentGeom=f,this._boundaryNodeRule=x,null!==f&&this.add(f)}else if(3===arguments.length){var z=arguments[1],W=arguments[2];this._argIndex=arguments[0],this._parentGeom=z,this._boundaryNodeRule=W,null!==z&&this.add(z)}}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype.insertBoundaryPoint=function(c,f){var x=this._nodes.addNode(f).getLabel(),L=1;x.getLocation(c,$e.ON)===ct.BOUNDARY&&L++;var z=n.determineBoundary(this._boundaryNodeRule,L);x.setLocation(c,z)},n.prototype.computeSelfNodes=function(){if(2===arguments.length)return this.computeSelfNodes(arguments[0],arguments[1],!1);if(3===arguments.length){var L=arguments[1],z=arguments[2],W=new Sn(arguments[0],!0,!1);return W.setIsDoneIfProperInt(z),this.createEdgeSetIntersector().computeIntersections(this._edges,W,L||!(this._parentGeom instanceof zn||this._parentGeom instanceof ln||this._parentGeom instanceof un)),this.addSelfIntersectionNodes(this._argIndex),W}},n.prototype.computeSplitEdges=function(c){for(var f=this._edges.iterator();f.hasNext();)f.next().eiList.addSplitEdges(c)},n.prototype.computeEdgeIntersections=function(c,f,x){var L=new Sn(f,x,!0);return L.setBoundaryNodes(this.getBoundaryNodes(),c.getBoundaryNodes()),this.createEdgeSetIntersector().computeIntersections(this._edges,c._edges,L),L},n.prototype.getGeometry=function(){return this._parentGeom},n.prototype.getBoundaryNodeRule=function(){return this._boundaryNodeRule},n.prototype.hasTooFewPoints=function(){return this._hasTooFewPoints},n.prototype.addPoint=function(){if(arguments[0]instanceof Tn){var c=arguments[0].getCoordinate();this.insertPoint(this._argIndex,c,ct.INTERIOR)}else arguments[0]instanceof j&&this.insertPoint(this._argIndex,arguments[0],ct.INTERIOR)},n.prototype.addPolygon=function(c){this.addPolygonRing(c.getExteriorRing(),ct.EXTERIOR,ct.INTERIOR);for(var f=0;f<c.getNumInteriorRing();f++){var x=c.getInteriorRingN(f);this.addPolygonRing(x,ct.INTERIOR,ct.EXTERIOR)}},n.prototype.addEdge=function(c){this.insertEdge(c);var f=c.getCoordinates();this.insertPoint(this._argIndex,f[0],ct.BOUNDARY),this.insertPoint(this._argIndex,f[f.length-1],ct.BOUNDARY)},n.prototype.addLineString=function(c){var f=Y.removeRepeatedPoints(c.getCoordinates());if(f.length<2)return this._hasTooFewPoints=!0,this._invalidPoint=f[0],null;var x=new Wa(f,new Yn(this._argIndex,ct.INTERIOR));this._lineEdgeMap.put(c,x),this.insertEdge(x),tt.isTrue(f.length>=2,"found LineString with single point"),this.insertBoundaryPoint(this._argIndex,f[0]),this.insertBoundaryPoint(this._argIndex,f[f.length-1])},n.prototype.getInvalidPoint=function(){return this._invalidPoint},n.prototype.getBoundaryPoints=function(){for(var c=this.getBoundaryNodes(),f=new Array(c.size()).fill(null),x=0,L=c.iterator();L.hasNext();){var z=L.next();f[x++]=z.getCoordinate().copy()}return f},n.prototype.getBoundaryNodes=function(){return null===this._boundaryNodes&&(this._boundaryNodes=this._nodes.getBoundaryNodes(this._argIndex)),this._boundaryNodes},n.prototype.addSelfIntersectionNode=function(c,f,x){if(this.isBoundaryNode(c,f))return null;x===ct.BOUNDARY&&this._useBoundaryDeterminationRule?this.insertBoundaryPoint(c,f):this.insertPoint(c,f,x)},n.prototype.addPolygonRing=function(c,f,x){if(c.isEmpty())return null;var L=Y.removeRepeatedPoints(c.getCoordinates());if(L.length<4)return this._hasTooFewPoints=!0,this._invalidPoint=L[0],null;var z=f,W=x;Re.isCCW(L)&&(z=x,W=f);var gt=new Wa(L,new Yn(this._argIndex,ct.BOUNDARY,z,W));this._lineEdgeMap.put(c,gt),this.insertEdge(gt),this.insertPoint(this._argIndex,L[0],ct.BOUNDARY)},n.prototype.insertPoint=function(c,f,x){var L=this._nodes.addNode(f),z=L.getLabel();null===z?L._label=new Yn(c,x):z.setLocation(c,x)},n.prototype.createEdgeSetIntersector=function(){return new ti},n.prototype.addSelfIntersectionNodes=function(c){for(var f=this._edges.iterator();f.hasNext();)for(var x=f.next(),L=x.getLabel().getLocation(c),z=x.eiList.iterator();z.hasNext();){var W=z.next();this.addSelfIntersectionNode(c,W.coord,L)}},n.prototype.add=function(){if(1!==arguments.length)return e.prototype.add.apply(this,arguments);var c=arguments[0];if(c.isEmpty())return null;if(c instanceof un&&(this._useBoundaryDeterminationRule=!1),c instanceof ln)this.addPolygon(c);else if(c instanceof zr)this.addLineString(c);else if(c instanceof Tn)this.addPoint(c);else if(c instanceof xi)this.addCollection(c);else if(c instanceof sr)this.addCollection(c);else if(c instanceof un)this.addCollection(c);else{if(!(c instanceof De))throw new Error(c.getClass().getName());this.addCollection(c)}},n.prototype.addCollection=function(c){for(var f=0;f<c.getNumGeometries();f++){var x=c.getGeometryN(f);this.add(x)}},n.prototype.locate=function(c){return Te(this._parentGeom,xn)&&this._parentGeom.getNumGeometries()>50?(null===this._areaPtLocator&&(this._areaPtLocator=new Qa(this._parentGeom)),this._areaPtLocator.locate(c)):this._ptLocator.locate(c,this._parentGeom)},n.prototype.findEdge=function(){return 1===arguments.length?this._lineEdgeMap.get(arguments[0]):e.prototype.findEdge.apply(this,arguments)},n.prototype.interfaces_=function(){return[]},n.prototype.getClass=function(){return n},n.determineBoundary=function(c,f){return c.isInBoundary(f)?ct.BOUNDARY:ct.INTERIOR},n}(ii),ya=function(){if(this._li=new Ee,this._resultPrecisionModel=null,this._arg=null,1===arguments.length){var e=arguments[0];this.setComputationPrecision(e.getPrecisionModel()),this._arg=new Array(1).fill(null),this._arg[0]=new $o(0,e)}else if(2===arguments.length){var n=arguments[0],c=arguments[1],f=Nn.OGC_SFS_BOUNDARY_RULE;n.getPrecisionModel().compareTo(c.getPrecisionModel())>=0?this.setComputationPrecision(n.getPrecisionModel()):this.setComputationPrecision(c.getPrecisionModel()),this._arg=new Array(2).fill(null),this._arg[0]=new $o(0,n,f),this._arg[1]=new $o(1,c,f)}else if(3===arguments.length){var x=arguments[0],L=arguments[1],z=arguments[2];x.getPrecisionModel().compareTo(L.getPrecisionModel())>=0?this.setComputationPrecision(x.getPrecisionModel()):this.setComputationPrecision(L.getPrecisionModel()),this._arg=new Array(2).fill(null),this._arg[0]=new $o(0,x,z),this._arg[1]=new $o(1,L,z)}};ya.prototype.getArgGeometry=function(e){return this._arg[e].getGeometry()},ya.prototype.setComputationPrecision=function(e){this._resultPrecisionModel=e,this._li.setPrecisionModel(this._resultPrecisionModel)},ya.prototype.interfaces_=function(){return[]},ya.prototype.getClass=function(){return ya};var Oo=function(){};Oo.prototype.interfaces_=function(){return[]},Oo.prototype.getClass=function(){return Oo},Oo.map=function(){if(arguments[0]instanceof ur&&Te(arguments[1],Oo.MapOp)){for(var e=arguments[0],n=arguments[1],c=new Je,f=0;f<e.getNumGeometries();f++){var x=n.map(e.getGeometryN(f));null!==x&&c.add(x)}return e.getFactory().buildGeometry(c)}if(Te(arguments[0],$n)&&Te(arguments[1],Oo.MapOp)){for(var L=arguments[0],z=arguments[1],W=new Je,gt=L.iterator();gt.hasNext();){var Zt=gt.next(),Ie=z.map(Zt);null!==Ie&&W.add(Ie)}return W}},Oo.MapOp=function(){};var Wr=function(e){function n(){var c=arguments[0];e.call(this,c,arguments[1]),this._ptLocator=new bo,this._geomFact=null,this._resultGeom=null,this._graph=null,this._edgeList=new ga,this._resultPolyList=new Je,this._resultLineList=new Je,this._resultPointList=new Je,this._graph=new ii(new pc),this._geomFact=c.getFactory()}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype.insertUniqueEdge=function(c){var f=this._edgeList.findEqualEdge(c);if(null!==f){var x=f.getLabel(),L=c.getLabel();f.isPointwiseEqual(c)||(L=new Yn(c.getLabel())).flip();var z=f.getDepth();z.isNull()&&z.add(x),z.add(L),x.merge(L)}else this._edgeList.add(c)},n.prototype.getGraph=function(){return this._graph},n.prototype.cancelDuplicateResultEdges=function(){for(var c=this._graph.getEdgeEnds().iterator();c.hasNext();){var f=c.next(),x=f.getSym();f.isInResult()&&x.isInResult()&&(f.setInResult(!1),x.setInResult(!1))}},n.prototype.isCoveredByLA=function(c){return!!this.isCovered(c,this._resultLineList)||!!this.isCovered(c,this._resultPolyList)},n.prototype.computeGeometry=function(c,f,x,L){var z=new Je;return z.addAll(c),z.addAll(f),z.addAll(x),z.isEmpty()?n.createEmptyResult(L,this._arg[0].getGeometry(),this._arg[1].getGeometry(),this._geomFact):this._geomFact.buildGeometry(z)},n.prototype.mergeSymLabels=function(){for(var c=this._graph.getNodes().iterator();c.hasNext();)c.next().getEdges().mergeSymLabels()},n.prototype.isCovered=function(c,f){for(var x=f.iterator();x.hasNext();){var L=x.next();if(this._ptLocator.locate(c,L)!==ct.EXTERIOR)return!0}return!1},n.prototype.replaceCollapsedEdges=function(){for(var c=new Je,f=this._edgeList.iterator();f.hasNext();){var x=f.next();x.isCollapsed()&&(f.remove(),c.add(x.getCollapsedEdge()))}this._edgeList.addAll(c)},n.prototype.updateNodeLabelling=function(){for(var c=this._graph.getNodes().iterator();c.hasNext();){var f=c.next(),x=f.getEdges().getLabel();f.getLabel().merge(x)}},n.prototype.getResultGeometry=function(c){return this.computeOverlay(c),this._resultGeom},n.prototype.insertUniqueEdges=function(c){for(var f=c.iterator();f.hasNext();){var x=f.next();this.insertUniqueEdge(x)}},n.prototype.computeOverlay=function(c){this.copyPoints(0),this.copyPoints(1),this._arg[0].computeSelfNodes(this._li,!1),this._arg[1].computeSelfNodes(this._li,!1),this._arg[0].computeEdgeIntersections(this._arg[1],this._li,!0);var f=new Je;this._arg[0].computeSplitEdges(f),this._arg[1].computeSplitEdges(f),this.insertUniqueEdges(f),this.computeLabelsFromDepths(),this.replaceCollapsedEdges(),Ka.checkValid(this._edgeList.getEdges()),this._graph.addEdges(this._edgeList.getEdges()),this.computeLabelling(),this.labelIncompleteNodes(),this.findResultAreaEdges(c),this.cancelDuplicateResultEdges();var x=new ao(this._geomFact);x.add(this._graph),this._resultPolyList=x.getPolygons();var L=new qi(this,this._geomFact,this._ptLocator);this._resultLineList=L.build(c);var z=new bs(this,this._geomFact,this._ptLocator);this._resultPointList=z.build(c),this._resultGeom=this.computeGeometry(this._resultPointList,this._resultLineList,this._resultPolyList,c)},n.prototype.labelIncompleteNode=function(c,f){var x=this._ptLocator.locate(c.getCoordinate(),this._arg[f].getGeometry());c.getLabel().setLocation(f,x)},n.prototype.copyPoints=function(c){for(var f=this._arg[c].getNodeIterator();f.hasNext();){var x=f.next();this._graph.addNode(x.getCoordinate()).setLabel(c,x.getLabel().getLocation(c))}},n.prototype.findResultAreaEdges=function(c){for(var f=this._graph.getEdgeEnds().iterator();f.hasNext();){var x=f.next(),L=x.getLabel();L.isArea()&&!x.isInteriorAreaEdge()&&n.isResultOfOp(L.getLocation(0,$e.RIGHT),L.getLocation(1,$e.RIGHT),c)&&x.setInResult(!0)}},n.prototype.computeLabelsFromDepths=function(){for(var c=this._edgeList.iterator();c.hasNext();){var f=c.next(),x=f.getLabel(),L=f.getDepth();if(!L.isNull()){L.normalize();for(var z=0;z<2;z++)x.isNull(z)||!x.isArea()||L.isNull(z)||(0===L.getDelta(z)?x.toLine(z):(tt.isTrue(!L.isNull(z,$e.LEFT),"depth of LEFT side has not been initialized"),x.setLocation(z,$e.LEFT,L.getLocation(z,$e.LEFT)),tt.isTrue(!L.isNull(z,$e.RIGHT),"depth of RIGHT side has not been initialized"),x.setLocation(z,$e.RIGHT,L.getLocation(z,$e.RIGHT))))}}},n.prototype.computeLabelling=function(){for(var c=this._graph.getNodes().iterator();c.hasNext();)c.next().getEdges().computeLabelling(this._arg);this.mergeSymLabels(),this.updateNodeLabelling()},n.prototype.labelIncompleteNodes=function(){for(var c=this._graph.getNodes().iterator();c.hasNext();){var f=c.next(),x=f.getLabel();f.isIsolated()&&(x.isNull(0)?this.labelIncompleteNode(f,0):this.labelIncompleteNode(f,1)),f.getEdges().updateLabelling(x)}},n.prototype.isCoveredByA=function(c){return!!this.isCovered(c,this._resultPolyList)},n.prototype.interfaces_=function(){return[]},n.prototype.getClass=function(){return n},n}(ya);Wr.overlayOp=function(e,n,c){return new Wr(e,n).getResultGeometry(c)},Wr.intersection=function(e,n){if(e.isEmpty()||n.isEmpty())return Wr.createEmptyResult(Wr.INTERSECTION,e,n,e.getFactory());if(e.isGeometryCollection()){var c=n;return Aa.map(e,{interfaces_:function(){return[Oo.MapOp]},map:function(f){return f.intersection(c)}})}return e.checkNotGeometryCollection(e),e.checkNotGeometryCollection(n),Lo.overlayOp(e,n,Wr.INTERSECTION)},Wr.symDifference=function(e,n){if(e.isEmpty()||n.isEmpty()){if(e.isEmpty()&&n.isEmpty())return Wr.createEmptyResult(Wr.SYMDIFFERENCE,e,n,e.getFactory());if(e.isEmpty())return n.copy();if(n.isEmpty())return e.copy()}return e.checkNotGeometryCollection(e),e.checkNotGeometryCollection(n),Lo.overlayOp(e,n,Wr.SYMDIFFERENCE)},Wr.resultDimension=function(e,n,c){var f=n.getDimension(),x=c.getDimension(),L=-1;switch(e){case Wr.INTERSECTION:L=Math.min(f,x);break;case Wr.UNION:L=Math.max(f,x);break;case Wr.DIFFERENCE:L=f;break;case Wr.SYMDIFFERENCE:L=Math.max(f,x)}return L},Wr.createEmptyResult=function(e,n,c,f){var x=null;switch(Wr.resultDimension(e,n,c)){case-1:x=f.createGeometryCollection(new Array(0).fill(null));break;case 0:x=f.createPoint();break;case 1:x=f.createLineString();break;case 2:x=f.createPolygon()}return x},Wr.difference=function(e,n){return e.isEmpty()?Wr.createEmptyResult(Wr.DIFFERENCE,e,n,e.getFactory()):n.isEmpty()?e.copy():(e.checkNotGeometryCollection(e),e.checkNotGeometryCollection(n),Lo.overlayOp(e,n,Wr.DIFFERENCE))},Wr.isResultOfOp=function(){if(2===arguments.length){var e=arguments[0],n=arguments[1],c=e.getLocation(0),f=e.getLocation(1);return Wr.isResultOfOp(c,f,n)}if(3===arguments.length){var x=arguments[0],L=arguments[1];switch(x===ct.BOUNDARY&&(x=ct.INTERIOR),L===ct.BOUNDARY&&(L=ct.INTERIOR),arguments[2]){case Wr.INTERSECTION:return x===ct.INTERIOR&&L===ct.INTERIOR;case Wr.UNION:return x===ct.INTERIOR||L===ct.INTERIOR;case Wr.DIFFERENCE:return x===ct.INTERIOR&&L!==ct.INTERIOR;case Wr.SYMDIFFERENCE:return x===ct.INTERIOR&&L!==ct.INTERIOR||x!==ct.INTERIOR&&L===ct.INTERIOR}return!1}},Wr.INTERSECTION=1,Wr.UNION=2,Wr.DIFFERENCE=3,Wr.SYMDIFFERENCE=4;var ru=function(){this._g=null,this._boundaryDistanceTolerance=null,this._linework=null,this._ptLocator=new bo,this._seg=new kr;var e=arguments[0],n=arguments[1];this._g=e,this._boundaryDistanceTolerance=n,this._linework=this.extractLinework(e)};ru.prototype.isWithinToleranceOfBoundary=function(e){for(var n=0;n<this._linework.getNumGeometries();n++)for(var c=this._linework.getGeometryN(n).getCoordinateSequence(),f=0;f<c.size()-1;f++)if(c.getCoordinate(f,this._seg.p0),c.getCoordinate(f+1,this._seg.p1),this._seg.distance(e)<=this._boundaryDistanceTolerance)return!0;return!1},ru.prototype.getLocation=function(e){return this.isWithinToleranceOfBoundary(e)?ct.BOUNDARY:this._ptLocator.locate(e,this._g)},ru.prototype.extractLinework=function(e){var n=new Oa;e.apply(n);var c=n.getLinework(),f=nn.toLineStringArray(c);return e.getFactory().createMultiLineString(f)},ru.prototype.interfaces_=function(){return[]},ru.prototype.getClass=function(){return ru};var Oa=function(){this._linework=null,this._linework=new Je};Oa.prototype.getLinework=function(){return this._linework},Oa.prototype.filter=function(e){if(e instanceof ln){var n=e;this._linework.add(n.getExteriorRing());for(var c=0;c<n.getNumInteriorRing();c++)this._linework.add(n.getInteriorRingN(c))}},Oa.prototype.interfaces_=function(){return[pr]},Oa.prototype.getClass=function(){return Oa};var Vn=function(){this._g=null,this._doLeft=!0,this._doRight=!0,this._g=arguments[0]};Vn.prototype.extractPoints=function(e,n,c){for(var f=e.getCoordinates(),x=0;x<f.length-1;x++)this.computeOffsetPoints(f[x],f[x+1],n,c)},Vn.prototype.setSidesToGenerate=function(e,n){this._doLeft=e,this._doRight=n},Vn.prototype.getPoints=function(e){for(var n=new Je,c=Ui.getLines(this._g).iterator();c.hasNext();){var f=c.next();this.extractPoints(f,e,n)}return n},Vn.prototype.computeOffsetPoints=function(e,n,c,f){var x=n.x-e.x,L=n.y-e.y,z=Math.sqrt(x*x+L*L),W=c*x/z,gt=c*L/z,Zt=(n.x+e.x)/2,Ie=(n.y+e.y)/2;if(this._doLeft){var Me=new j(Zt-gt,Ie+W);f.add(Me)}if(this._doRight){var tr=new j(Zt+gt,Ie-W);f.add(tr)}},Vn.prototype.interfaces_=function(){return[]},Vn.prototype.getClass=function(){return Vn};var oi=function e(){this._geom=null,this._locFinder=null,this._location=new Array(3).fill(null),this._invalidLocation=null,this._boundaryDistanceTolerance=e.TOLERANCE,this._testCoords=new Je;var n=arguments[0],c=arguments[1],f=arguments[2];this._boundaryDistanceTolerance=e.computeBoundaryDistanceTolerance(n,c),this._geom=[n,c,f],this._locFinder=[new ru(this._geom[0],this._boundaryDistanceTolerance),new ru(this._geom[1],this._boundaryDistanceTolerance),new ru(this._geom[2],this._boundaryDistanceTolerance)]},Iu={TOLERANCE:{configurable:!0}};oi.prototype.reportResult=function(e,n,c){Sr.out.println("Overlay result invalid - A:"+ct.toLocationSymbol(n[0])+" B:"+ct.toLocationSymbol(n[1])+" expected:"+(c?"i":"e")+" actual:"+ct.toLocationSymbol(n[2]))},oi.prototype.isValid=function(e){return this.addTestPts(this._geom[0]),this.addTestPts(this._geom[1]),this.checkValid(e)},oi.prototype.checkValid=function(){if(1===arguments.length){for(var e=arguments[0],n=0;n<this._testCoords.size();n++){var c=this._testCoords.get(n);if(!this.checkValid(e,c))return this._invalidLocation=c,!1}return!0}if(2===arguments.length){var f=arguments[0],x=arguments[1];return this._location[0]=this._locFinder[0].getLocation(x),this._location[1]=this._locFinder[1].getLocation(x),this._location[2]=this._locFinder[2].getLocation(x),!!oi.hasLocation(this._location,ct.BOUNDARY)||this.isValidResult(f,this._location)}},oi.prototype.addTestPts=function(e){var n=new Vn(e);this._testCoords.addAll(n.getPoints(5*this._boundaryDistanceTolerance))},oi.prototype.isValidResult=function(e,n){var c=Wr.isResultOfOp(n[0],n[1],e),f=!(c^n[2]===ct.INTERIOR);return f||this.reportResult(e,n,c),f},oi.prototype.getInvalidLocation=function(){return this._invalidLocation},oi.prototype.interfaces_=function(){return[]},oi.prototype.getClass=function(){return oi},oi.hasLocation=function(e,n){for(var c=0;c<3;c++)if(e[c]===n)return!0;return!1},oi.computeBoundaryDistanceTolerance=function(e,n){return Math.min(ki.computeSizeBasedSnapTolerance(e),ki.computeSizeBasedSnapTolerance(n))},oi.isValid=function(e,n,c,f){return new oi(e,n,f).isValid(c)},Iu.TOLERANCE.get=function(){return 1e-6},Object.defineProperties(oi,Iu);var Qo=function e(n){this._geomFactory=null,this._skipEmpty=!1,this._inputGeoms=null,this._geomFactory=e.extractFactory(n),this._inputGeoms=n};Qo.prototype.extractElements=function(e,n){if(null===e)return null;for(var c=0;c<e.getNumGeometries();c++){var f=e.getGeometryN(c);this._skipEmpty&&f.isEmpty()||n.add(f)}},Qo.prototype.combine=function(){for(var e=new Je,n=this._inputGeoms.iterator();n.hasNext();){var c=n.next();this.extractElements(c,e)}return 0===e.size()?null!==this._geomFactory?this._geomFactory.createGeometryCollection(null):null:this._geomFactory.buildGeometry(e)},Qo.prototype.interfaces_=function(){return[]},Qo.prototype.getClass=function(){return Qo},Qo.combine=function(){return 1===arguments.length?new Qo(arguments[0]).combine():2===arguments.length?new Qo(Qo.createList(arguments[0],arguments[1])).combine():3===arguments.length?new Qo(Qo.createList(arguments[0],arguments[1],arguments[2])).combine():void 0},Qo.extractFactory=function(e){return e.isEmpty()?null:e.iterator().next().getFactory()},Qo.createList=function(){if(2===arguments.length){var e=arguments[0],n=arguments[1],c=new Je;return c.add(e),c.add(n),c}if(3===arguments.length){var f=arguments[0],x=arguments[1],L=arguments[2],z=new Je;return z.add(f),z.add(x),z.add(L),z}};var vi=function(){this._inputPolys=null,this._geomFactory=null,this._inputPolys=arguments[0],null===this._inputPolys&&(this._inputPolys=new Je)},va={STRTREE_NODE_CAPACITY:{configurable:!0}};vi.prototype.reduceToGeometries=function(e){for(var n=new Je,c=e.iterator();c.hasNext();){var f=c.next(),x=null;Te(f,Oi)?x=this.unionTree(f):f instanceof ur&&(x=f),n.add(x)}return n},vi.prototype.extractByEnvelope=function(e,n,c){for(var f=new Je,x=0;x<n.getNumGeometries();x++){var L=n.getGeometryN(x);L.getEnvelopeInternal().intersects(e)?f.add(L):c.add(L)}return this._geomFactory.buildGeometry(f)},vi.prototype.unionOptimized=function(e,n){var c=e.getEnvelopeInternal(),f=n.getEnvelopeInternal();if(!c.intersects(f))return Qo.combine(e,n);if(e.getNumGeometries()<=1&&n.getNumGeometries()<=1)return this.unionActual(e,n);var x=c.intersection(f);return this.unionUsingEnvelopeIntersection(e,n,x)},vi.prototype.union=function(){if(null===this._inputPolys)throw new Error("union() method cannot be called twice");if(this._inputPolys.isEmpty())return null;this._geomFactory=this._inputPolys.iterator().next().getFactory();for(var e=new Wu(vi.STRTREE_NODE_CAPACITY),n=this._inputPolys.iterator();n.hasNext();){var c=n.next();e.insert(c.getEnvelopeInternal(),c)}this._inputPolys=null;var f=e.itemsTree();return this.unionTree(f)},vi.prototype.binaryUnion=function(){if(1===arguments.length){var e=arguments[0];return this.binaryUnion(e,0,e.size())}if(3===arguments.length){var n=arguments[0],c=arguments[1],f=arguments[2];if(f-c<=1){var x=vi.getGeometry(n,c);return this.unionSafe(x,null)}if(f-c==2)return this.unionSafe(vi.getGeometry(n,c),vi.getGeometry(n,c+1));var L=Math.trunc((f+c)/2),z=this.binaryUnion(n,c,L),W=this.binaryUnion(n,L,f);return this.unionSafe(z,W)}},vi.prototype.repeatedUnion=function(e){for(var n=null,c=e.iterator();c.hasNext();){var f=c.next();n=null===n?f.copy():n.union(f)}return n},vi.prototype.unionSafe=function(e,n){return null===e&&null===n?null:null===e?n.copy():null===n?e.copy():this.unionOptimized(e,n)},vi.prototype.unionActual=function(e,n){return vi.restrictToPolygons(e.union(n))},vi.prototype.unionTree=function(e){var n=this.reduceToGeometries(e);return this.binaryUnion(n)},vi.prototype.unionUsingEnvelopeIntersection=function(e,n,c){var f=new Je,x=this.extractByEnvelope(c,e,f),L=this.extractByEnvelope(c,n,f),z=this.unionActual(x,L);return f.add(z),Qo.combine(f)},vi.prototype.bufferUnion=function(){if(1===arguments.length){var e=arguments[0];return e.get(0).getFactory().buildGeometry(e).buffer(0)}if(2===arguments.length){var n=arguments[0],c=arguments[1];return n.getFactory().createGeometryCollection([n,c]).buffer(0)}},vi.prototype.interfaces_=function(){return[]},vi.prototype.getClass=function(){return vi},vi.restrictToPolygons=function(e){if(Te(e,xn))return e;var n=os.getPolygons(e);return 1===n.size()?n.get(0):e.getFactory().createMultiPolygon(nn.toPolygonArray(n))},vi.getGeometry=function(e,n){return n>=e.size()?null:e.get(n)},vi.union=function(e){return new vi(e).union()},va.STRTREE_NODE_CAPACITY.get=function(){return 4},Object.defineProperties(vi,va);var mu=function(){};mu.prototype.interfaces_=function(){return[]},mu.prototype.getClass=function(){return mu},mu.union=function(e,n){if(e.isEmpty()||n.isEmpty()){if(e.isEmpty()&&n.isEmpty())return Wr.createEmptyResult(Wr.UNION,e,n,e.getFactory());if(e.isEmpty())return n.copy();if(n.isEmpty())return e.copy()}return e.checkNotGeometryCollection(e),e.checkNotGeometryCollection(n),Lo.overlayOp(e,n,Wr.UNION)},Et.GeoJSONReader=Mo,Et.GeoJSONWriter=yo,Et.OverlayOp=Wr,Et.UnionOp=mu,Et.BufferOp=To,Object.defineProperty(Et,"__esModule",{value:!0})}(fe)},5422:(He,fe,Et)=>{"use strict";Et.r(fe),Et.d(fe,{ObservationModule:()=>Zy});var yt=Et(8002),D=Et(7716),y=Et(5072),Bt=Et(5987),ft=Et(6215);let It=(()=>{class i{constructor(){this._initialState={geometry:{},inState:!0},this._observation=new ft.X(this._initialState)}getObservation(){return this._observation.asObservable()}updateObservation(o){return this._observation.next(Object.assign({},o)),this.getObservation()}resetObservation(){return this._observation.next(Object.assign({},this._initialState)),this.getObservation()}}return i.\u0275fac=function(o){return new(o||i)},i.\u0275prov=D.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();var Ft=Et(7832),he=Et(5257),Jt=Et(1954);let Ze=(()=>{class i{}return i.LocationHelperText="Use the map below to draw a point at the location at which the observation you wish to report was made.",i.ContactHelperText="Please complete the following fields below for your observation report. Providing contact information will enable the Game Commission to contact you should they need to discuss your observation.",i})();var ve=Et(1769);let ce=(()=>{class i{constructor(){this.header="",this.content=""}}return i.\u0275fac=function(o){return new(o||i)},i.\u0275cmp=D.Xpm({type:i,selectors:[["app-intro-helper-text"]],inputs:{header:"header",content:"content"},decls:6,vars:2,consts:[[1,"appHelperContainer"],[1,"appHelperHeader","appHelperText"],[1,"appHelperContent","appHelperText"]],template:function(o,h){1&o&&(D.TgZ(0,"div",0),D.TgZ(1,"h2",1),D._uU(2),D.qZA(),D._UZ(3,"mat-divider"),D.TgZ(4,"div",2),D._uU(5),D.qZA(),D.qZA()),2&o&&(D.xp6(2),D.Oqu(h.header),D.xp6(3),D.hij(" ",h.content," "))},directives:[ve.d],styles:[".appHelperContainer[_ngcontent-%COMP%]{margin-top:1rem}.appHelperText[_ngcontent-%COMP%]{color:#434343;font-size:1.125rem}.appHelperHeader[_ngcontent-%COMP%]{font-weight:800;line-height:2.625rem;margin-bottom:0}.appHelperContent[_ngcontent-%COMP%]{font-weight:400;line-height:1.5rem;margin-bottom:.5rem}"]}),i})();var _e=Et(2340);let We=(()=>{class i{}return i.PointPaintStyle={"circle-radius":10,"circle-color":"#ff2218","circle-opacity":.75,"circle-stroke-width":2,"circle-stroke-color":"#3E0000"},i})();function $(i,a,o){void 0===o&&(o={});var h={type:"Feature"};return(0===o.id||o.id)&&(h.id=o.id),o.bbox&&(h.bbox=o.bbox),h.properties=a||{},h.geometry=i,h}function Q(i,a,o){if(void 0===o&&(o={}),!i)throw new Error("coordinates is required");if(!Array.isArray(i))throw new Error("coordinates must be an Array");if(i.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!Zr(i[0])||!Zr(i[1]))throw new Error("coordinates must contain numbers");return $({type:"Point",coordinates:i},a,o)}function st(i,a,o){void 0===o&&(o={});for(var h=0,m=i;h<m.length;h++){var v=m[h];if(v.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var b=0;b<v[v.length-1].length;b++)if(v[v.length-1][b]!==v[0][b])throw new Error("First and last Position are not equivalent.")}return $({type:"Polygon",coordinates:i},a,o)}function $t(i,a,o){if(void 0===o&&(o={}),i.length<2)throw new Error("coordinates must be an array of two or more positions");return $({type:"LineString",coordinates:i},a,o)}function Mt(i,a){void 0===a&&(a={});var o={type:"FeatureCollection"};return a.id&&(o.id=a.id),a.bbox&&(o.bbox=a.bbox),o.features=i,o}function Zr(i){return!isNaN(i)&&null!==i&&!Array.isArray(i)}function ke(i){if(Array.isArray(i))return i;if("Feature"===i.type){if(null!==i.geometry)return i.geometry.coordinates}else if(i.coordinates)return i.coordinates;throw new Error("coords must be GeoJSON Feature, Geometry Object or an Array")}function Jn(i){return"Feature"===i.type?i.geometry:i}function ot(i,a,o){if(void 0===o&&(o={}),!i)throw new Error("point is required");if(!a)throw new Error("polygon is required");var h=function(i){if(!i)throw new Error("coord is required");if(!Array.isArray(i)){if("Feature"===i.type&&null!==i.geometry&&"Point"===i.geometry.type)return i.geometry.coordinates;if("Point"===i.type)return i.coordinates}if(Array.isArray(i)&&i.length>=2&&!Array.isArray(i[0])&&!Array.isArray(i[1]))return i;throw new Error("coord must be GeoJSON Point or an Array of numbers")}(i),m=Jn(a),v=m.type,b=a.bbox,I=m.coordinates;if(b&&!1===function(i,a){return a[0]<=i[0]&&a[1]<=i[1]&&a[2]>=i[0]&&a[3]>=i[1]}(h,b))return!1;"Polygon"===v&&(I=[I]);for(var M=!1,C=0;C<I.length&&!M;C++)if(rt(h,I[C][0],o.ignoreBoundary)){for(var O=!1,R=1;R<I[C].length&&!O;)rt(h,I[C][R],!o.ignoreBoundary)&&(O=!0),R++;O||(M=!0)}return M}function rt(i,a,o){var h=!1;a[0][0]===a[a.length-1][0]&&a[0][1]===a[a.length-1][1]&&(a=a.slice(0,a.length-1));for(var m=0,v=a.length-1;m<a.length;v=m++){var b=a[m][0],I=a[m][1],M=a[v][0],C=a[v][1];if(i[1]*(b-M)+I*(M-i[0])+C*(i[0]-b)==0&&(b-i[0])*(M-i[0])<=0&&(I-i[1])*(C-i[1])<=0)return!o;I>i[1]!=C>i[1]&&i[0]<(M-b)*(i[1]-I)/(C-I)+b&&(h=!h)}return h}function Pt(i,a,o){if(null!==i)for(var h,m,v,b,I,M,C,N,O=0,R=0,B=i.type,Lt="FeatureCollection"===B,mt="Feature"===B,te=Lt?i.features.length:1,Nt=0;Nt<te;Nt++){I=(N=!!(C=Lt?i.features[Nt].geometry:mt?i.geometry:i)&&"GeometryCollection"===C.type)?C.geometries.length:1;for(var pt=0;pt<I;pt++){var At=0,se=0;if(null!==(b=N?C.geometries[pt]:C)){M=b.coordinates;var ae=b.type;switch(O=!o||"Polygon"!==ae&&"MultiPolygon"!==ae?0:1,ae){case null:break;case"Point":if(!1===a(M,R,Nt,At,se))return!1;R++,At++;break;case"LineString":case"MultiPoint":for(h=0;h<M.length;h++){if(!1===a(M[h],R,Nt,At,se))return!1;R++,"MultiPoint"===ae&&At++}"LineString"===ae&&At++;break;case"Polygon":case"MultiLineString":for(h=0;h<M.length;h++){for(m=0;m<M[h].length-O;m++){if(!1===a(M[h][m],R,Nt,At,se))return!1;R++}"MultiLineString"===ae&&At++,"Polygon"===ae&&se++}"Polygon"===ae&&At++;break;case"MultiPolygon":for(h=0;h<M.length;h++){for(se=0,m=0;m<M[h].length;m++){for(v=0;v<M[h][m].length-O;v++){if(!1===a(M[h][m][v],R,Nt,At,se))return!1;R++}se++}At++}break;case"GeometryCollection":for(h=0;h<b.geometries.length;h++)if(!1===Pt(b.geometries[h],a,o))return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function Xe(i,a){if("Feature"===i.type)a(i,0);else if("FeatureCollection"===i.type)for(var o=0;o<i.features.length&&!1!==a(i.features[o],o);o++);}function Jr(i,a){!function(i,a){var o,h,m,v,b,I,M,C,O,R,N=0,B="FeatureCollection"===i.type,Lt="Feature"===i.type,mt=B?i.features.length:1;for(o=0;o<mt;o++){for(C=B?i.features[o].properties:Lt?i.properties:{},O=B?i.features[o].bbox:Lt?i.bbox:void 0,R=B?i.features[o].id:Lt?i.id:void 0,b=(M=!!(I=B?i.features[o].geometry:Lt?i.geometry:i)&&"GeometryCollection"===I.type)?I.geometries.length:1,m=0;m<b;m++)if(null!==(v=M?I.geometries[m]:I))switch(v.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":if(!1===a(v,N,C,O,R))return!1;break;case"GeometryCollection":for(h=0;h<v.geometries.length;h++)if(!1===a(v.geometries[h],N,C,O,R))return!1;break;default:throw new Error("Unknown Geometry Type")}else if(!1===a(null,N,C,O,R))return!1;N++}}(i,function(o,h,m,v,b){var M,I=null===o?null:o.type;switch(I){case null:case"Point":case"LineString":case"Polygon":return!1!==a($(o,m,{bbox:v,id:b}),h,0)&&void 0}switch(I){case"MultiPoint":M="Point";break;case"MultiLineString":M="LineString";break;case"MultiPolygon":M="Polygon"}for(var C=0;C<o.coordinates.length;C++)if(!1===a($({type:M,coordinates:o.coordinates[C]},m),h,C))return!1})}const Je=function(i){if(!i)throw new Error("geojson is required");var a=[];return Jr(i,function(o){!function(i,a){var o=[],h=i.geometry;if(null!==h){switch(h.type){case"Polygon":o=ke(h);break;case"LineString":o=[ke(h)]}o.forEach(function(m){(function(i,a){var o=[];return i.reduce(function(h,m){var v=$t([h,m],a);return v.bbox=function(i,a){var o=i[0],h=i[1],m=a[0],v=a[1];return[o<m?o:m,h<v?h:v,o>m?o:m,h>v?h:v]}(h,m),o.push(v),m}),o})(m,i.properties).forEach(function(b){b.id=a.length,a.push(b)})})}}(o,a)}),Mt(a)};var gi=Et(2689);function Y(i,a){var o=ke(i),h=ke(a);if(2!==o.length)throw new Error("<intersects> line1 must only contain 2 coordinates");if(2!==h.length)throw new Error("<intersects> line2 must only contain 2 coordinates");var m=o[0][0],v=o[0][1],b=o[1][0],I=o[1][1],M=h[0][0],C=h[0][1],O=h[1][0],R=h[1][1],N=(R-C)*(b-m)-(O-M)*(I-v);if(0===N)return null;var mt=((O-M)*(v-C)-(R-C)*(m-M))/N,te=((b-m)*(v-C)-(I-v)*(m-M))/N;return mt>=0&&mt<=1&&te>=0&&te<=1?Q([m+mt*(b-m),v+mt*(I-v)]):null}const it=function(i,a){var o={},h=[];if("LineString"===i.type&&(i=$(i)),"LineString"===a.type&&(a=$(a)),"Feature"===i.type&&"Feature"===a.type&&null!==i.geometry&&null!==a.geometry&&"LineString"===i.geometry.type&&"LineString"===a.geometry.type&&2===i.geometry.coordinates.length&&2===a.geometry.coordinates.length){var m=Y(i,a);return m&&h.push(m),Mt(h)}var v=gi();return v.load(Je(a)),Xe(Je(i),function(b){Xe(v.search(b),function(I){var M=Y(b,I);if(M){var C=ke(M).join(",");o[C]||(o[C]=!0,h.push(M))}})}),Mt(h)};function ht(i,a){void 0===a&&(a={});var o=Jn(i);switch(!a.properties&&"Feature"===i.type&&(a.properties=i.properties),o.type){case"Polygon":return function(i,a){return void 0===a&&(a={}),ne(Jn(i).coordinates,a.properties?a.properties:"Feature"===i.type?i.properties:{})}(o,a);case"MultiPolygon":return function(i,a){void 0===a&&(a={});var o=Jn(i),m=a.properties?a.properties:"Feature"===i.type?i.properties:{},v=[];return o.coordinates.forEach(function(b){v.push(ne(b,m))}),Mt(v)}(o,a);default:throw new Error("invalid poly")}}function ne(i,a){return i.length>1?function(i,a,o){return void 0===o&&(o={}),$({type:"MultiLineString",coordinates:i},a,o)}(i,a):$t(i[0],a)}function Ut(i,a){for(var o=0;o<i.coordinates.length-1;o++)if(Le(i.coordinates[o],i.coordinates[o+1],a.coordinates))return!0;return!1}function or(i,a){for(var o=0,h=a.coordinates;o<h.length;o++)if(ot(h[o],i))return!0;return it(a,ht(i)).features.length>0}function Le(i,a,o){var v=a[0]-i[0],b=a[1]-i[1];return 0==(o[0]-i[0])*b-(o[1]-i[1])*v&&(Math.abs(v)>=Math.abs(b)?v>0?i[0]<=o[0]&&o[0]<=a[0]:a[0]<=o[0]&&o[0]<=i[0]:b>0?i[1]<=o[1]&&o[1]<=a[1]:a[1]<=o[1]&&o[1]<=i[1])}function De(i){var a=[1/0,1/0,-1/0,-1/0];return Pt(i,function(o){a[0]>o[0]&&(a[0]=o[0]),a[1]>o[1]&&(a[1]=o[1]),a[2]<o[0]&&(a[2]=o[0]),a[3]<o[1]&&(a[3]=o[1])}),a}De.default=De;const sr=De;Et(8228),Et(6896);var $e=new ArrayBuffer(16);new Float64Array($e),new Uint32Array($e),Et(5454),function(){function i(a){this.points=a.points||[],this.duration=a.duration||1e4,this.sharpness=a.sharpness||.85,this.centers=[],this.controls=[],this.stepLength=a.stepLength||60,this.length=this.points.length,this.delay=0;for(var o=0;o<this.length;o++)this.points[o].z=this.points[o].z||0;for(o=0;o<this.length-1;o++){var h=this.points[o],m=this.points[o+1];this.centers.push({x:(h.x+m.x)/2,y:(h.y+m.y)/2,z:(h.z+m.z)/2})}for(this.controls.push([this.points[0],this.points[0]]),o=0;o<this.centers.length-1;o++){var v=this.points[o+1].x-(this.centers[o].x+this.centers[o+1].x)/2,b=this.points[o+1].y-(this.centers[o].y+this.centers[o+1].y)/2,I=this.points[o+1].z-(this.centers[o].y+this.centers[o+1].z)/2;this.controls.push([{x:(1-this.sharpness)*this.points[o+1].x+this.sharpness*(this.centers[o].x+v),y:(1-this.sharpness)*this.points[o+1].y+this.sharpness*(this.centers[o].y+b),z:(1-this.sharpness)*this.points[o+1].z+this.sharpness*(this.centers[o].z+I)},{x:(1-this.sharpness)*this.points[o+1].x+this.sharpness*(this.centers[o+1].x+v),y:(1-this.sharpness)*this.points[o+1].y+this.sharpness*(this.centers[o+1].y+b),z:(1-this.sharpness)*this.points[o+1].z+this.sharpness*(this.centers[o+1].z+I)}])}return this.controls.push([this.points[this.length-1],this.points[this.length-1]]),this.steps=this.cacheSteps(this.stepLength),this}i.prototype.cacheSteps=function(a){var o=[],h=this.pos(0);o.push(0);for(var m=0;m<this.duration;m+=10){var v=this.pos(m);Math.sqrt((v.x-h.x)*(v.x-h.x)+(v.y-h.y)*(v.y-h.y)+(v.z-h.z)*(v.z-h.z))>a&&(o.push(m),h=v)}return o},i.prototype.vector=function(a){var o=this.pos(a+10),h=this.pos(a-10);return{angle:180*Math.atan2(o.y-h.y,o.x-h.x)/3.14,speed:Math.sqrt((h.x-o.x)*(h.x-o.x)+(h.y-o.y)*(h.y-o.y)+(h.z-o.z)*(h.z-o.z))}},i.prototype.pos=function(a){var o=a-this.delay;o<0&&(o=0),o>this.duration&&(o=this.duration-1);var h=o/this.duration;if(h>=1)return this.points[this.length-1];var m=Math.floor((this.points.length-1)*h);return function(i,a,o,h,m){var v=function(i){var a=i*i;return[a*i,3*a*(1-i),3*i*(1-i)*(1-i),(1-i)*(1-i)*(1-i)]}(i);return{x:m.x*v[0]+h.x*v[1]+o.x*v[2]+a.x*v[3],y:m.y*v[0]+h.y*v[1]+o.y*v[2]+a.y*v[3],z:m.z*v[0]+h.z*v[1]+o.z*v[2]+a.z*v[3]}}((this.length-1)*h-m,this.points[m],this.controls[m][1],this.controls[m+1][0],this.points[m+1])}}();Et(1604),Et(8309);var Qa=Math.PI/180,vr=180/Math.PI,Gr=function(i,a){this.lon=i,this.lat=a,this.x=Qa*i,this.y=Qa*a};Gr.prototype.view=function(){return String(this.lon).slice(0,4)+","+String(this.lat).slice(0,4)},Gr.prototype.antipode=function(){return new Gr(this.lon<0?180+this.lon:-1*(180-this.lon),-1*this.lat)};var ho=function(){this.coords=[],this.length=0};ho.prototype.move_to=function(i){this.length++,this.coords.push(i)};var $o=function(i){this.properties=i||{},this.geometries=[]};$o.prototype.json=function(){if(this.geometries.length<=0)return{geometry:{type:"LineString",coordinates:null},type:"Feature",properties:this.properties};if(1===this.geometries.length)return{geometry:{type:"LineString",coordinates:this.geometries[0].coords},type:"Feature",properties:this.properties};for(var i=[],a=0;a<this.geometries.length;a++)i.push(this.geometries[a].coords);return{geometry:{type:"MultiLineString",coordinates:i},type:"Feature",properties:this.properties}},$o.prototype.wkt=function(){for(var i="",a="LINESTRING(",o=function(v){a+=v[0]+" "+v[1]+","},h=0;h<this.geometries.length;h++){if(0===this.geometries[h].coords.length)return"LINESTRING(empty)";this.geometries[h].coords.forEach(o),i+=a.substring(0,a.length-1)+")"}return i};var ya=function(i,a,o){if(!i||void 0===i.x||void 0===i.y)throw new Error("GreatCircle constructor expects two args: start and end objects with x and y properties");if(!a||void 0===a.x||void 0===a.y)throw new Error("GreatCircle constructor expects two args: start and end objects with x and y properties");this.start=new Gr(i.x,i.y),this.end=new Gr(a.x,a.y),this.properties=o||{};var h=this.start.x-this.end.x,v=Math.pow(Math.sin((this.start.y-this.end.y)/2),2)+Math.cos(this.start.y)*Math.cos(this.end.y)*Math.pow(Math.sin(h/2),2);if(this.g=2*Math.asin(Math.sqrt(v)),this.g===Math.PI)throw new Error("it appears "+i.view()+" and "+a.view()+" are 'antipodal', e.g diametrically opposite, thus there is no single route but rather infinite");if(isNaN(this.g))throw new Error("could not calculate great circle between "+i+" and "+a)};ya.prototype.interpolate=function(i){var a=Math.sin((1-i)*this.g)/Math.sin(this.g),o=Math.sin(i*this.g)/Math.sin(this.g),h=a*Math.cos(this.start.y)*Math.cos(this.start.x)+o*Math.cos(this.end.y)*Math.cos(this.end.x),m=a*Math.cos(this.start.y)*Math.sin(this.start.x)+o*Math.cos(this.end.y)*Math.sin(this.end.x),v=a*Math.sin(this.start.y)+o*Math.sin(this.end.y),b=vr*Math.atan2(v,Math.sqrt(Math.pow(h,2)+Math.pow(m,2)));return[vr*Math.atan2(m,h),b]},ya.prototype.Arc=function(i,a){var o=[];if(!i||i<=2)o.push([this.start.lon,this.start.lat]),o.push([this.end.lon,this.end.lat]);else for(var h=1/(i-1),m=0;m<i;++m){var b=this.interpolate(h*m);o.push(b)}for(var I=!1,M=0,C=a&&a.offset?a.offset:10,O=180-C,R=-180+C,N=360-C,B=1;B<o.length;++B){var Lt=o[B-1][0],mt=o[B][0],te=Math.abs(mt-Lt);te>N&&(mt>O&&Lt<R||Lt>O&&mt<R)?I=!0:te>M&&(M=te)}var Nt=[];if(I&&M<C){var pt=[];Nt.push(pt);for(var At=0;At<o.length;++At){var se=parseFloat(o[At][0]);if(At>0&&Math.abs(se-o[At-1][0])>N){var ae=parseFloat(o[At-1][0]),xe=parseFloat(o[At-1][1]),me=parseFloat(o[At][0]),Ae=parseFloat(o[At][1]);if(ae>-180&&ae<R&&180===me&&At+1<o.length&&o[At-1][0]>-180&&o[At-1][0]<R){pt.push([-180,o[At][1]]),At++,pt.push([o[At][0],o[At][1]]);continue}if(ae>O&&ae<180&&-180===me&&At+1<o.length&&o[At-1][0]>O&&o[At-1][0]<180){pt.push([180,o[At][1]]),At++,pt.push([o[At][0],o[At][1]]);continue}if(ae<R&&me>O){var Vt=ae;ae=me,me=Vt;var dn=xe;xe=Ae,Ae=dn}if(ae>O&&me<R&&(me+=360),ae<=180&&me>=180&&ae<me){var Br=(180-ae)/(me-ae),Ln=Br*Ae+(1-Br)*xe;pt.push([o[At-1][0]>O?180:-180,Ln]),(pt=[]).push([o[At-1][0]>O?-180:180,Ln]),Nt.push(pt)}else Nt.push(pt=[]);pt.push([se,o[At][1]])}else pt.push([o[At][0],o[At][1]])}}else{var Bn=[];Nt.push(Bn);for(var br=0;br<o.length;++br)Bn.push([o[br][0],o[br][1]])}for(var fn=new $o(this.properties),Hr=0;Hr<Nt.length;++Hr){var Li=new ho;fn.geometries.push(Li);for(var Pi=Nt[Hr],Hn=0;Hn<Pi.length;++Hn)Li.move_to(Pi[Hn])}return fn},Et(2978);var be=[],Ue=[],Ne=[],Ve=[],er=[],ir=[],rr=[],Rr=[],Ye=[],_r=[],Ir=[],xr=[],yr=[],dr=[],cr=[],ar=[],Vr=[],Kr=[],pn=[],on=[],an=[],$r=[],hn=[],Cn=[];rr[85]=_r[85]=-1,Rr[85]=Ir[85]=0,Ye[85]=xr[85]=1,pn[85]=$r[85]=1,on[85]=hn[85]=0,an[85]=Cn[85]=1,be[85]=Ve[85]=0,Ue[85]=er[85]=-1,Ne[85]=cr[85]=0,ar[85]=yr[85]=0,Vr[85]=dr[85]=1,ir[85]=Kr[85]=1,$r[1]=$r[169]=0,hn[1]=hn[169]=-1,Cn[1]=Cn[169]=0,yr[1]=yr[169]=-1,dr[1]=dr[169]=0,cr[1]=cr[169]=0,_r[4]=_r[166]=0,Ir[4]=Ir[166]=-1,xr[4]=xr[166]=1,ar[4]=ar[166]=1,Vr[4]=Vr[166]=0,Kr[4]=Kr[166]=0,rr[16]=rr[154]=0,Rr[16]=Rr[154]=1,Ye[16]=Ye[154]=1,Ve[16]=Ve[154]=1,er[16]=er[154]=0,ir[16]=ir[154]=1,pn[64]=pn[106]=0,on[64]=on[106]=1,an[64]=an[106]=0,be[64]=be[106]=-1,Ue[64]=Ue[106]=0,Ne[64]=Ne[106]=1,pn[2]=pn[168]=0,on[2]=on[168]=-1,an[2]=an[168]=1,$r[2]=$r[168]=0,hn[2]=hn[168]=-1,Cn[2]=Cn[168]=0,yr[2]=yr[168]=-1,dr[2]=dr[168]=0,cr[2]=cr[168]=0,ar[2]=ar[168]=-1,Vr[2]=Vr[168]=0,Kr[2]=Kr[168]=1,rr[8]=rr[162]=0,Rr[8]=Rr[162]=-1,Ye[8]=Ye[162]=0,_r[8]=_r[162]=0,Ir[8]=Ir[162]=-1,xr[8]=xr[162]=1,yr[8]=yr[162]=1,dr[8]=dr[162]=0,cr[8]=cr[162]=1,ar[8]=ar[162]=1,Vr[8]=Vr[162]=0,Kr[8]=Kr[162]=0,rr[32]=rr[138]=0,Rr[32]=Rr[138]=1,Ye[32]=Ye[138]=1,_r[32]=_r[138]=0,Ir[32]=Ir[138]=1,xr[32]=xr[138]=0,be[32]=be[138]=1,Ue[32]=Ue[138]=0,Ne[32]=Ne[138]=0,Ve[32]=Ve[138]=1,er[32]=er[138]=0,ir[32]=ir[138]=1,$r[128]=$r[42]=0,hn[128]=hn[42]=1,Cn[128]=Cn[42]=1,pn[128]=pn[42]=0,on[128]=on[42]=1,an[128]=an[42]=0,be[128]=be[42]=-1,Ue[128]=Ue[42]=0,Ne[128]=Ne[42]=1,Ve[128]=Ve[42]=-1,er[128]=er[42]=0,ir[128]=ir[42]=0,_r[5]=_r[165]=-1,Ir[5]=Ir[165]=0,xr[5]=xr[165]=0,$r[5]=$r[165]=1,hn[5]=hn[165]=0,Cn[5]=Cn[165]=0,ar[20]=ar[150]=0,Vr[20]=Vr[150]=1,Kr[20]=Kr[150]=1,Ve[20]=Ve[150]=0,er[20]=er[150]=-1,ir[20]=ir[150]=1,rr[80]=rr[90]=-1,Rr[80]=Rr[90]=0,Ye[80]=Ye[90]=1,pn[80]=pn[90]=1,on[80]=on[90]=0,an[80]=an[90]=1,yr[65]=yr[105]=0,dr[65]=dr[105]=1,cr[65]=cr[105]=0,be[65]=be[105]=0,Ue[65]=Ue[105]=-1,Ne[65]=Ne[105]=0,rr[160]=rr[10]=-1,Rr[160]=Rr[10]=0,Ye[160]=Ye[10]=1,_r[160]=_r[10]=-1,Ir[160]=Ir[10]=0,xr[160]=xr[10]=0,$r[160]=$r[10]=1,hn[160]=hn[10]=0,Cn[160]=Cn[10]=0,pn[160]=pn[10]=1,on[160]=on[10]=0,an[160]=an[10]=1,ar[130]=ar[40]=0,Vr[130]=Vr[40]=1,Kr[130]=Kr[40]=1,yr[130]=yr[40]=0,dr[130]=dr[40]=1,cr[130]=cr[40]=0,be[130]=be[40]=0,Ue[130]=Ue[40]=-1,Ne[130]=Ne[40]=0,Ve[130]=Ve[40]=0,er[130]=er[40]=-1,ir[130]=ir[40]=1,_r[37]=_r[133]=0,Ir[37]=Ir[133]=1,xr[37]=xr[133]=1,$r[37]=$r[133]=0,hn[37]=hn[133]=1,Cn[37]=Cn[133]=0,be[37]=be[133]=-1,Ue[37]=Ue[133]=0,Ne[37]=Ne[133]=0,Ve[37]=Ve[133]=1,er[37]=er[133]=0,ir[37]=ir[133]=0,ar[148]=ar[22]=-1,Vr[148]=Vr[22]=0,Kr[148]=Kr[22]=0,$r[148]=$r[22]=0,hn[148]=hn[22]=-1,Cn[148]=Cn[22]=1,pn[148]=pn[22]=0,on[148]=on[22]=1,an[148]=an[22]=1,Ve[148]=Ve[22]=-1,er[148]=er[22]=0,ir[148]=ir[22]=1,rr[82]=rr[88]=0,Rr[82]=Rr[88]=-1,Ye[82]=Ye[88]=1,ar[82]=ar[88]=1,Vr[82]=Vr[88]=0,Kr[82]=Kr[88]=1,yr[82]=yr[88]=-1,dr[82]=dr[88]=0,cr[82]=cr[88]=1,pn[82]=pn[88]=0,on[82]=on[88]=-1,an[82]=an[88]=0,rr[73]=rr[97]=0,Rr[73]=Rr[97]=1,Ye[73]=Ye[97]=0,_r[73]=_r[97]=0,Ir[73]=Ir[97]=-1,xr[73]=xr[97]=0,yr[73]=yr[97]=1,dr[73]=dr[97]=0,cr[73]=cr[97]=0,be[73]=be[97]=1,Ue[73]=Ue[97]=0,Ne[73]=Ne[97]=1,rr[145]=rr[25]=0,Rr[145]=Rr[25]=-1,Ye[145]=Ye[25]=0,yr[145]=yr[25]=1,dr[145]=dr[25]=0,cr[145]=cr[25]=1,$r[145]=$r[25]=0,hn[145]=hn[25]=1,Cn[145]=Cn[25]=1,Ve[145]=Ve[25]=-1,er[145]=er[25]=0,ir[145]=ir[25]=0,_r[70]=_r[100]=0,Ir[70]=Ir[100]=1,xr[70]=xr[100]=0,ar[70]=ar[100]=-1,Vr[70]=Vr[100]=0,Kr[70]=Kr[100]=1,pn[70]=pn[100]=0,on[70]=on[100]=-1,an[70]=an[100]=1,be[70]=be[100]=1,Ue[70]=Ue[100]=0,Ne[70]=Ne[100]=0,_r[101]=_r[69]=0,Ir[101]=Ir[69]=1,xr[101]=xr[69]=0,be[101]=be[69]=1,Ue[101]=Ue[69]=0,Ne[101]=Ne[69]=0,$r[149]=$r[21]=0,hn[149]=hn[21]=1,Cn[149]=Cn[21]=1,Ve[149]=Ve[21]=-1,er[149]=er[21]=0,ir[149]=ir[21]=0,ar[86]=ar[84]=-1,Vr[86]=Vr[84]=0,Kr[86]=Kr[84]=1,pn[86]=pn[84]=0,on[86]=on[84]=-1,an[86]=an[84]=1,rr[89]=rr[81]=0,Rr[89]=Rr[81]=-1,Ye[89]=Ye[81]=0,yr[89]=yr[81]=1,dr[89]=dr[81]=0,cr[89]=cr[81]=1,rr[96]=rr[74]=0,Rr[96]=Rr[74]=1,Ye[96]=Ye[74]=0,_r[96]=_r[74]=-1,Ir[96]=Ir[74]=0,xr[96]=xr[74]=1,pn[96]=pn[74]=1,on[96]=on[74]=0,an[96]=an[74]=0,be[96]=be[74]=1,Ue[96]=Ue[74]=0,Ne[96]=Ne[74]=1,rr[24]=rr[146]=0,Rr[24]=Rr[146]=-1,Ye[24]=Ye[146]=1,ar[24]=ar[146]=1,Vr[24]=Vr[146]=0,Kr[24]=Kr[146]=1,yr[24]=yr[146]=0,dr[24]=dr[146]=1,cr[24]=cr[146]=1,Ve[24]=Ve[146]=0,er[24]=er[146]=-1,ir[24]=ir[146]=0,_r[6]=_r[164]=-1,Ir[6]=Ir[164]=0,xr[6]=xr[164]=1,ar[6]=ar[164]=-1,Vr[6]=Vr[164]=0,Kr[6]=Kr[164]=0,$r[6]=$r[164]=0,hn[6]=hn[164]=-1,Cn[6]=Cn[164]=1,pn[6]=pn[164]=1,on[6]=on[164]=0,an[6]=an[164]=0,yr[129]=yr[41]=0,dr[129]=dr[41]=1,cr[129]=cr[41]=1,$r[129]=$r[41]=0,hn[129]=hn[41]=1,Cn[129]=Cn[41]=0,be[129]=be[41]=-1,Ue[129]=Ue[41]=0,Ne[129]=Ne[41]=0,Ve[129]=Ve[41]=0,er[129]=er[41]=-1,ir[129]=ir[41]=0,ar[66]=ar[104]=0,Vr[66]=Vr[104]=1,Kr[66]=Kr[104]=0,yr[66]=yr[104]=-1,dr[66]=dr[104]=0,cr[66]=cr[104]=1,pn[66]=pn[104]=0,on[66]=on[104]=-1,an[66]=an[104]=0,be[66]=be[104]=0,Ue[66]=Ue[104]=-1,Ne[66]=Ne[104]=1,rr[144]=rr[26]=-1,Rr[144]=Rr[26]=0,Ye[144]=Ye[26]=0,$r[144]=$r[26]=1,hn[144]=hn[26]=0,Cn[144]=Cn[26]=1,pn[144]=pn[26]=0,on[144]=on[26]=1,an[144]=an[26]=1,Ve[144]=Ve[26]=-1,er[144]=er[26]=0,ir[144]=ir[26]=1,_r[36]=_r[134]=0,Ir[36]=Ir[134]=1,xr[36]=xr[134]=1,ar[36]=ar[134]=0,Vr[36]=Vr[134]=1,Kr[36]=Kr[134]=0,be[36]=be[134]=0,Ue[36]=Ue[134]=-1,Ne[36]=Ne[134]=1,Ve[36]=Ve[134]=1,er[36]=er[134]=0,ir[36]=ir[134]=0,rr[9]=rr[161]=-1,Rr[9]=Rr[161]=0,Ye[9]=Ye[161]=0,_r[9]=_r[161]=0,Ir[9]=Ir[161]=-1,xr[9]=xr[161]=0,yr[9]=yr[161]=1,dr[9]=dr[161]=0,cr[9]=cr[161]=0,$r[9]=$r[161]=1,hn[9]=hn[161]=0,Cn[9]=Cn[161]=1,rr[136]=0,Rr[136]=1,Ye[136]=1,_r[136]=0,Ir[136]=1,xr[136]=0,ar[136]=-1,Vr[136]=0,Kr[136]=1,yr[136]=-1,dr[136]=0,cr[136]=0,$r[136]=0,hn[136]=-1,Cn[136]=0,pn[136]=0,on[136]=-1,an[136]=1,be[136]=1,Ue[136]=0,Ne[136]=0,Ve[136]=1,er[136]=0,ir[136]=1,rr[34]=0,Rr[34]=-1,Ye[34]=0,_r[34]=0,Ir[34]=-1,xr[34]=1,ar[34]=1,Vr[34]=0,Kr[34]=0,yr[34]=1,dr[34]=0,cr[34]=1,$r[34]=0,hn[34]=1,Cn[34]=1,pn[34]=0,on[34]=1,an[34]=0,be[34]=-1,Ue[34]=0,Ne[34]=1,Ve[34]=-1,er[34]=0,ir[34]=0,rr[35]=0,Rr[35]=1,Ye[35]=1,_r[35]=0,Ir[35]=-1,xr[35]=1,ar[35]=1,Vr[35]=0,Kr[35]=0,yr[35]=-1,dr[35]=0,cr[35]=0,$r[35]=0,hn[35]=-1,Cn[35]=0,pn[35]=0,on[35]=1,an[35]=0,be[35]=-1,Ue[35]=0,Ne[35]=1,Ve[35]=1,er[35]=0,ir[35]=1,rr[153]=0,Rr[153]=1,Ye[153]=1,yr[153]=-1,dr[153]=0,cr[153]=0,$r[153]=0,hn[153]=-1,Cn[153]=0,Ve[153]=1,er[153]=0,ir[153]=1,_r[102]=0,Ir[102]=-1,xr[102]=1,ar[102]=1,Vr[102]=0,Kr[102]=0,pn[102]=0,on[102]=1,an[102]=0,be[102]=-1,Ue[102]=0,Ne[102]=1,rr[155]=0,Rr[155]=-1,Ye[155]=0,yr[155]=1,dr[155]=0,cr[155]=1,$r[155]=0,hn[155]=1,Cn[155]=1,Ve[155]=-1,er[155]=0,ir[155]=0,_r[103]=0,Ir[103]=1,xr[103]=0,ar[103]=-1,Vr[103]=0,Kr[103]=1,pn[103]=0,on[103]=-1,an[103]=1,be[103]=1,Ue[103]=0,Ne[103]=0,rr[152]=0,Rr[152]=1,Ye[152]=1,ar[152]=-1,Vr[152]=0,Kr[152]=1,yr[152]=-1,dr[152]=0,cr[152]=0,$r[152]=0,hn[152]=-1,Cn[152]=0,pn[152]=0,on[152]=-1,an[152]=1,Ve[152]=1,er[152]=0,ir[152]=1,rr[156]=0,Rr[156]=-1,Ye[156]=1,ar[156]=1,Vr[156]=0,Kr[156]=1,yr[156]=-1,dr[156]=0,cr[156]=0,$r[156]=0,hn[156]=-1,Cn[156]=0,pn[156]=0,on[156]=1,an[156]=1,Ve[156]=-1,er[156]=0,ir[156]=1,rr[137]=0,Rr[137]=1,Ye[137]=1,_r[137]=0,Ir[137]=1,xr[137]=0,yr[137]=-1,dr[137]=0,cr[137]=0,$r[137]=0,hn[137]=-1,Cn[137]=0,be[137]=1,Ue[137]=0,Ne[137]=0,Ve[137]=1,er[137]=0,ir[137]=1,rr[139]=0,Rr[139]=1,Ye[139]=1,_r[139]=0,Ir[139]=-1,xr[139]=0,yr[139]=1,dr[139]=0,cr[139]=0,$r[139]=0,hn[139]=1,Cn[139]=0,be[139]=-1,Ue[139]=0,Ne[139]=0,Ve[139]=1,er[139]=0,ir[139]=1,rr[98]=0,Rr[98]=-1,Ye[98]=0,_r[98]=0,Ir[98]=-1,xr[98]=1,ar[98]=1,Vr[98]=0,Kr[98]=0,yr[98]=1,dr[98]=0,cr[98]=1,pn[98]=0,on[98]=1,an[98]=0,be[98]=-1,Ue[98]=0,Ne[98]=1,rr[99]=0,Rr[99]=1,Ye[99]=0,_r[99]=0,Ir[99]=-1,xr[99]=1,ar[99]=1,Vr[99]=0,Kr[99]=0,yr[99]=-1,dr[99]=0,cr[99]=1,pn[99]=0,on[99]=-1,an[99]=0,be[99]=1,Ue[99]=0,Ne[99]=1,_r[38]=0,Ir[38]=-1,xr[38]=1,ar[38]=1,Vr[38]=0,Kr[38]=0,$r[38]=0,hn[38]=1,Cn[38]=1,pn[38]=0,on[38]=1,an[38]=0,be[38]=-1,Ue[38]=0,Ne[38]=1,Ve[38]=-1,er[38]=0,ir[38]=0,_r[39]=0,Ir[39]=1,xr[39]=1,ar[39]=-1,Vr[39]=0,Kr[39]=0,$r[39]=0,hn[39]=-1,Cn[39]=1,pn[39]=0,on[39]=1,an[39]=0,be[39]=-1,Ue[39]=0,Ne[39]=1,Ve[39]=1,er[39]=0,ir[39]=0;var _a=function(i){return[[i.bottomleft,0],[0,0],[0,i.leftbottom]]},xa=function(i){return[[1,i.rightbottom],[1,0],[i.bottomright,0]]},Ds=function(i){return[[i.topright,1],[1,1],[1,i.righttop]]},ts=function(i){return[[0,i.lefttop],[0,1],[i.topleft,1]]},bl=function(i){return[[i.bottomright,0],[i.bottomleft,0],[0,i.leftbottom],[0,i.lefttop]]},nu=function(i){return[[i.bottomright,0],[i.bottomleft,0],[1,i.righttop],[1,i.rightbottom]]},Pu=function(i){return[[1,i.righttop],[1,i.rightbottom],[i.topleft,1],[i.topright,1]]},yu=function(i){return[[0,i.leftbottom],[0,i.lefttop],[i.topleft,1],[i.topright,1]]},Fr=[],Lr=[],Qr=[],tn=[],vn=[],mn=[],ei=[],ai=[];tn[1]=vn[1]=18,tn[169]=vn[169]=18,Qr[4]=Lr[4]=12,Qr[166]=Lr[166]=12,Fr[16]=ai[16]=4,Fr[154]=ai[154]=4,mn[64]=ei[64]=22,mn[106]=ei[106]=22,Qr[2]=mn[2]=17,tn[2]=vn[2]=18,Qr[168]=mn[168]=17,tn[168]=vn[168]=18,Fr[8]=tn[8]=9,Lr[8]=Qr[8]=12,Fr[162]=tn[162]=9,Lr[162]=Qr[162]=12,Fr[32]=ai[32]=4,Lr[32]=ei[32]=1,Fr[138]=ai[138]=4,Lr[138]=ei[138]=1,vn[128]=ai[128]=21,mn[128]=ei[128]=22,vn[42]=ai[42]=21,mn[42]=ei[42]=22,Lr[5]=vn[5]=14,Lr[165]=vn[165]=14,Qr[20]=ai[20]=6,Qr[150]=ai[150]=6,Fr[80]=mn[80]=11,Fr[90]=mn[90]=11,tn[65]=ei[65]=3,tn[105]=ei[105]=3,Fr[160]=mn[160]=11,Lr[160]=vn[160]=14,Fr[10]=mn[10]=11,Lr[10]=vn[10]=14,Qr[130]=ai[130]=6,tn[130]=ei[130]=3,Qr[40]=ai[40]=6,tn[40]=ei[40]=3,Lr[101]=ei[101]=1,Lr[69]=ei[69]=1,vn[149]=ai[149]=21,vn[21]=ai[21]=21,Qr[86]=mn[86]=17,Qr[84]=mn[84]=17,Fr[89]=tn[89]=9,Fr[81]=tn[81]=9,Fr[96]=ei[96]=0,Lr[96]=mn[96]=15,Fr[74]=ei[74]=0,Lr[74]=mn[74]=15,Fr[24]=Qr[24]=8,tn[24]=ai[24]=7,Fr[146]=Qr[146]=8,tn[146]=ai[146]=7,Lr[6]=mn[6]=15,Qr[6]=vn[6]=16,Lr[164]=mn[164]=15,Qr[164]=vn[164]=16,tn[129]=ai[129]=7,vn[129]=ei[129]=20,tn[41]=ai[41]=7,vn[41]=ei[41]=20,Qr[66]=ei[66]=2,tn[66]=mn[66]=19,Qr[104]=ei[104]=2,tn[104]=mn[104]=19,Fr[144]=vn[144]=10,mn[144]=ai[144]=23,Fr[26]=vn[26]=10,mn[26]=ai[26]=23,Lr[36]=ai[36]=5,Qr[36]=ei[36]=2,Lr[134]=ai[134]=5,Qr[134]=ei[134]=2,Fr[9]=vn[9]=10,Lr[9]=tn[9]=13,Fr[161]=vn[161]=10,Lr[161]=tn[161]=13,Lr[37]=ai[37]=5,vn[37]=ei[37]=20,Lr[133]=ai[133]=5,vn[133]=ei[133]=20,Qr[148]=vn[148]=16,mn[148]=ai[148]=23,Qr[22]=vn[22]=16,mn[22]=ai[22]=23,Fr[82]=Qr[82]=8,tn[82]=mn[82]=19,Fr[88]=Qr[88]=8,tn[88]=mn[88]=19,Fr[73]=ei[73]=0,Lr[73]=tn[73]=13,Fr[97]=ei[97]=0,Lr[97]=tn[97]=13,Fr[145]=tn[145]=9,vn[145]=ai[145]=21,Fr[25]=tn[25]=9,vn[25]=ai[25]=21,Lr[70]=ei[70]=1,Qr[70]=mn[70]=17,Lr[100]=ei[100]=1,Qr[100]=mn[100]=17,Fr[34]=tn[34]=9,Lr[34]=Qr[34]=12,vn[34]=ai[34]=21,mn[34]=ei[34]=22,Fr[136]=ai[136]=4,Lr[136]=ei[136]=1,Qr[136]=mn[136]=17,tn[136]=vn[136]=18,Fr[35]=ai[35]=4,Lr[35]=Qr[35]=12,tn[35]=vn[35]=18,mn[35]=ei[35]=22,Fr[153]=ai[153]=4,tn[153]=vn[153]=18,Lr[102]=Qr[102]=12,mn[102]=ei[102]=22,Fr[155]=tn[155]=9,vn[155]=ai[155]=23,Lr[103]=ei[103]=1,Qr[103]=mn[103]=17,Fr[152]=ai[152]=4,Qr[152]=mn[152]=17,tn[152]=vn[152]=18,Fr[156]=Qr[156]=8,tn[156]=vn[156]=18,mn[156]=ai[156]=23,Fr[137]=ai[137]=4,Lr[137]=ei[137]=1,tn[137]=vn[137]=18,Fr[139]=ai[139]=4,Lr[139]=tn[139]=13,vn[139]=ei[139]=20,Fr[98]=tn[98]=9,Lr[98]=Qr[98]=12,mn[98]=ei[98]=22,Fr[99]=ei[99]=0,Lr[99]=Qr[99]=12,tn[99]=mn[99]=19,Lr[38]=Qr[38]=12,vn[38]=ai[38]=21,mn[38]=ei[38]=22,Lr[39]=ai[39]=5,Qr[39]=vn[39]=16,mn[39]=ei[39]=22;var Or=[];function vc(i,a,o){return function(i){return(i>0)-(i<0)||+i}((a[0]-i[0])*(o[1]-a[1])-(o[0]-a[0])*(a[1]-i[1]))}function ou(i,a){return a.geometry.coordinates[0].every(function(o){return ot(Q(o),i)})}Or[1]=Or[169]=_a,Or[4]=Or[166]=xa,Or[16]=Or[154]=Ds,Or[64]=Or[106]=ts,Or[168]=Or[2]=bl,Or[162]=Or[8]=nu,Or[138]=Or[32]=Pu,Or[42]=Or[128]=yu,Or[5]=Or[165]=function(i){return[[0,0],[0,i.leftbottom],[1,i.rightbottom],[1,0]]},Or[20]=Or[150]=function(i){return[[1,0],[i.bottomright,0],[i.topright,1],[1,1]]},Or[80]=Or[90]=function(i){return[[1,1],[1,i.righttop],[0,i.lefttop],[0,1]]},Or[65]=Or[105]=function(i){return[[i.bottomleft,0],[0,0],[0,1],[i.topleft,1]]},Or[160]=Or[10]=function(i){return[[1,i.righttop],[1,i.rightbottom],[0,i.leftbottom],[0,i.lefttop]]},Or[130]=Or[40]=function(i){return[[i.topleft,1],[i.topright,1],[i.bottomright,0],[i.bottomleft,0]]},Or[85]=function(){return[[0,0],[0,1],[1,1],[1,0]]},Or[101]=Or[69]=function(i){return[[1,i.rightbottom],[1,0],[0,0],[0,1],[i.topleft,1]]},Or[149]=Or[21]=function(i){return[[i.topright,1],[1,1],[1,0],[0,0],[0,i.leftbottom]]},Or[86]=Or[84]=function(i){return[[1,0],[i.bottomright,0],[0,i.lefttop],[0,1],[1,1]]},Or[89]=Or[81]=function(i){return[[1,1],[1,i.righttop],[i.bottomleft,0],[0,0],[0,1]]},Or[96]=Or[74]=function(i){return[[1,i.righttop],[1,i.rightbottom],[0,i.lefttop],[0,1],[i.topleft,1]]},Or[24]=Or[146]=function(i){return[[1,1],[1,i.righttop],[i.bottomright,0],[i.bottomleft,0],[i.topright,1]]},Or[6]=Or[164]=function(i){return[[1,i.rightbottom],[1,0],[i.bottomright,0],[0,i.leftbottom],[0,i.lefttop]]},Or[129]=Or[41]=function(i){return[[i.topright,1],[i.bottomleft,0],[0,0],[0,i.leftbottom],[i.topleft,1]]},Or[66]=Or[104]=function(i){return[[i.bottomright,0],[i.bottomleft,0],[0,i.lefttop],[0,1],[i.topleft,1]]},Or[144]=Or[26]=function(i){return[[1,1],[1,i.righttop],[0,i.leftbottom],[0,i.lefttop],[i.topright,1]]},Or[36]=Or[134]=function(i){return[[1,i.rightbottom],[1,0],[i.bottomright,0],[i.topleft,1],[i.topright,1]]},Or[9]=Or[161]=function(i){return[[1,i.righttop],[1,i.rightbottom],[i.bottomleft,0],[0,0],[0,i.leftbottom]]},Or[37]=Or[133]=function(i){return[[1,i.rightbottom],[1,0],[0,0],[0,i.leftbottom],[i.topleft,1],[i.topright,1]]},Or[148]=Or[22]=function(i){return[[1,1],[1,0],[i.bottomright,0],[0,i.leftbottom],[0,i.lefttop],[i.topright,1]]},Or[82]=Or[88]=function(i){return[[1,1],[1,i.righttop],[i.bottomright,0],[i.bottomleft,0],[0,i.lefttop],[0,1]]},Or[73]=Or[97]=function(i){return[[1,i.righttop],[1,i.rightbottom],[i.bottomleft,0],[0,0],[0,1],[i.topleft,1]]},Or[145]=Or[25]=function(i){return[[1,1],[1,i.righttop],[i.bottomleft,0],[0,0],[0,i.leftbottom],[i.topright,1]]},Or[70]=Or[100]=function(i){return[[1,i.rightbottom],[1,0],[i.bottomright,0],[0,i.lefttop],[0,1],[i.topleft,1]]},Or[34]=function(i){return[yu(i),nu(i)]},Or[35]=function(i){return[[1,i.righttop],[1,i.rightbottom],[i.bottomright,0],[i.bottomleft,0],[0,i.leftbottom],[0,i.lefttop],[i.topleft,1],[i.topright,1]]},Or[136]=function(i){return[Pu(i),bl(i)]},Or[153]=function(i){return[Ds(i),_a(i)]},Or[102]=function(i){return[xa(i),ts(i)]},Or[155]=function(i){return[[1,1],[1,i.righttop],[i.bottomleft,0],[0,0],[0,i.leftbottom],[i.topright,1]]},Or[103]=function(i){return[[1,i.rightbottom],[1,0],[i.bottomright,0],[0,i.lefttop],[0,1],[i.topleft,1]]},Or[152]=function(i){return[Ds(i),bl(i)]},Or[156]=function(i){return[[1,1],[1,i.righttop],[i.bottomright,0],[i.bottomleft,0],[0,i.leftbottom],[0,i.lefttop],[i.topright,1]]},Or[137]=function(i){return[Pu(i),_a(i)]},Or[139]=function(i){return[[1,i.righttop],[1,i.rightbottom],[i.bottomleft,0],[0,0],[0,i.leftbottom],[i.topleft,1],[i.topright,1]]},Or[98]=function(i){return[nu(i),ts(i)]},Or[99]=function(i){return[[1,i.righttop],[1,i.rightbottom],[i.bottomright,0],[i.bottomleft,0],[0,i.lefttop],[0,1],[i.topleft,1]]},Or[38]=function(i){return[xa(i),yu(i)]},Or[39]=function(i){return[[1,i.rightbottom],[1,0],[i.bottomright,0],[0,i.leftbottom],[0,i.lefttop],[i.topleft,1],[i.topright,1]]};const Lp=function(){function i(a){this.id=i.buildId(a),this.coordinates=a,this.innerEdges=[],this.outerEdges=[],this.outerEdgesSorted=!1}return i.buildId=function(a){return a.join(",")},i.prototype.removeInnerEdge=function(a){this.innerEdges=this.innerEdges.filter(function(o){return o.from.id!==a.from.id})},i.prototype.removeOuterEdge=function(a){this.outerEdges=this.outerEdges.filter(function(o){return o.to.id!==a.to.id})},i.prototype.addOuterEdge=function(a){this.outerEdges.push(a),this.outerEdgesSorted=!1},i.prototype.sortOuterEdges=function(){var a=this;this.outerEdgesSorted||(this.outerEdges.sort(function(o,h){var m=o.to,v=h.to;if(m.coordinates[0]-a.coordinates[0]>=0&&v.coordinates[0]-a.coordinates[0]<0)return 1;if(m.coordinates[0]-a.coordinates[0]<0&&v.coordinates[0]-a.coordinates[0]>=0)return-1;if(m.coordinates[0]-a.coordinates[0]==0&&v.coordinates[0]-a.coordinates[0]==0)return m.coordinates[1]-a.coordinates[1]>=0||v.coordinates[1]-a.coordinates[1]>=0?m.coordinates[1]-v.coordinates[1]:v.coordinates[1]-m.coordinates[1];var b=vc(a.coordinates,m.coordinates,v.coordinates);return b<0?1:b>0?-1:Math.pow(m.coordinates[0]-a.coordinates[0],2)+Math.pow(m.coordinates[1]-a.coordinates[1],2)-(Math.pow(v.coordinates[0]-a.coordinates[0],2)+Math.pow(v.coordinates[1]-a.coordinates[1],2))}),this.outerEdgesSorted=!0)},i.prototype.getOuterEdges=function(){return this.sortOuterEdges(),this.outerEdges},i.prototype.getOuterEdge=function(a){return this.sortOuterEdges(),this.outerEdges[a]},i.prototype.addInnerEdge=function(a){this.innerEdges.push(a)},i}(),Op=function(){function i(a,o){this.from=a,this.to=o,this.next=void 0,this.label=void 0,this.symetric=void 0,this.ring=void 0,this.from.addOuterEdge(this),this.to.addInnerEdge(this)}return i.prototype.getSymetric=function(){return this.symetric||(this.symetric=new i(this.to,this.from),this.symetric.symetric=this),this.symetric},i.prototype.deleteEdge=function(){this.from.removeOuterEdge(this),this.to.removeInnerEdge(this)},i.prototype.isEqual=function(a){return this.from.id===a.from.id&&this.to.id===a.to.id},i.prototype.toString=function(){return"Edge { "+this.from.id+" -> "+this.to.id+" }"},i.prototype.toLineString=function(){return $t([this.from.coordinates,this.to.coordinates])},i.prototype.compareTo=function(a){return vc(a.from.coordinates,a.to.coordinates,this.to.coordinates)},i}(),qf=function(){function i(){this.edges=[],this.polygon=void 0,this.envelope=void 0}return i.prototype.push=function(a){this.edges.push(a),this.polygon=this.envelope=void 0},i.prototype.get=function(a){return this.edges[a]},Object.defineProperty(i.prototype,"length",{get:function(){return this.edges.length},enumerable:!0,configurable:!0}),i.prototype.forEach=function(a){this.edges.forEach(a)},i.prototype.map=function(a){return this.edges.map(a)},i.prototype.some=function(a){return this.edges.some(a)},i.prototype.isValid=function(){return!0},i.prototype.isHole=function(){var a=this,o=this.edges.reduce(function(b,I,M){return I.from.coordinates[1]>a.edges[b].from.coordinates[1]&&(b=M),b},0),h=(0===o?this.length:o)-1,m=(o+1)%this.length,v=vc(this.edges[h].from.coordinates,this.edges[o].from.coordinates,this.edges[m].from.coordinates);return 0===v?this.edges[h].from.coordinates[0]>this.edges[m].from.coordinates[0]:v>0},i.prototype.toMultiPoint=function(){return function(i,a,o){return void 0===o&&(o={}),$({type:"MultiPoint",coordinates:i},a,o)}(this.edges.map(function(a){return a.from.coordinates}))},i.prototype.toPolygon=function(){if(this.polygon)return this.polygon;var a=this.edges.map(function(o){return o.from.coordinates});return a.push(this.edges[0].from.coordinates),this.polygon=st([a])},i.prototype.getEnvelope=function(){return this.envelope?this.envelope:this.envelope=function(i){return function(i,a){void 0===a&&(a={});var o=Number(i[0]),h=Number(i[1]),m=Number(i[2]),v=Number(i[3]);if(6===i.length)throw new Error("@turf/bbox-polygon does not support BBox with 6 positions");var b=[o,h];return st([[b,[m,h],[m,v],[o,v],b]],a.properties,{bbox:i,id:a.id})}(sr(i))}(this.toPolygon())},i.findEdgeRingContaining=function(a,o){var m,v,h=a.getEnvelope();return o.forEach(function(b){var I=b.getEnvelope();if(v&&(m=v.getEnvelope()),!function(i,a){var o=i.geometry.coordinates[0].map(function(b){return b[0]}),h=i.geometry.coordinates[0].map(function(b){return b[1]}),m=a.geometry.coordinates[0].map(function(b){return b[0]}),v=a.geometry.coordinates[0].map(function(b){return b[1]});return Math.max.apply(null,o)===Math.max.apply(null,m)&&Math.max.apply(null,h)===Math.max.apply(null,v)&&Math.min.apply(null,o)===Math.min.apply(null,m)&&Math.min.apply(null,h)===Math.min.apply(null,v)}(I,h)&&ou(I,h)){for(var M=a.map(function(Lt){return Lt.from.coordinates}),C=void 0,O=function(Lt){b.some(function(mt){return function(i,a){return i[0]===a[0]&&i[1]===a[1]}(Lt,mt.from.coordinates)})||(C=Lt)},R=0,N=M;R<N.length;R++)O(N[R]);C&&b.inside(Q(C))&&(!v||ou(m,I))&&(v=b)}}),v},i.prototype.inside=function(a){return ot(a,this.toPolygon())},i}();function zp(i){for(var a=i,o=[];a.parent;)o.unshift(a),a=a.parent;return o}!function(){function i(){this.edges=[],this.nodes={}}i.fromGeoJson=function(a){!function(i){if(!i)throw new Error("No geojson passed");if("FeatureCollection"!==i.type&&"GeometryCollection"!==i.type&&"MultiLineString"!==i.type&&"LineString"!==i.type&&"Feature"!==i.type)throw new Error("Invalid input type '"+i.type+"'. Geojson must be FeatureCollection, GeometryCollection, LineString, MultiLineString or Feature")}(a);var o=new i;return Jr(a,function(h){(function(i,a,o){if(!i)throw new Error("No feature passed");if(!i||"Feature"!==i.type||!i.geometry)throw new Error("Invalid input to "+o+", Feature with geometry required");if(!i.geometry||i.geometry.type!==a)throw new Error("Invalid input to "+o+": must be a "+a+", given "+i.geometry.type)})(h,"LineString","Graph::fromGeoJson"),function(i,a,o,h){var m=o;Pt(i,function(v,b,I,M,C){m=0===b?v:a(m,v)},void 0)}(h,function(m,v){if(m){var b=o.getNode(m),I=o.getNode(v);o.addEdge(b,I)}return v})}),o},i.prototype.getNode=function(a){var o=Lp.buildId(a),h=this.nodes[o];return h||(h=this.nodes[o]=new Lp(a)),h},i.prototype.addEdge=function(a,o){var h=new Op(a,o),m=h.getSymetric();this.edges.push(h),this.edges.push(m)},i.prototype.deleteDangles=function(){var a=this;Object.keys(this.nodes).map(function(o){return a.nodes[o]}).forEach(function(o){return a._removeIfDangle(o)})},i.prototype._removeIfDangle=function(a){var o=this;if(a.innerEdges.length<=1){var h=a.getOuterEdges().map(function(m){return m.to});this.removeNode(a),h.forEach(function(m){return o._removeIfDangle(m)})}},i.prototype.deleteCutEdges=function(){var a=this;this._computeNextCWEdges(),this._findLabeledEdgeRings(),this.edges.forEach(function(o){o.label===o.symetric.label&&(a.removeEdge(o.symetric),a.removeEdge(o))})},i.prototype._computeNextCWEdges=function(a){var o=this;void 0===a?Object.keys(this.nodes).forEach(function(h){return o._computeNextCWEdges(o.nodes[h])}):a.getOuterEdges().forEach(function(h,m){a.getOuterEdge((0===m?a.getOuterEdges().length:m)-1).symetric.next=h})},i.prototype._computeNextCCWEdges=function(a,o){for(var m,v,h=a.getOuterEdges(),b=h.length-1;b>=0;--b){var I=h[b],M=I.symetric,C=void 0,O=void 0;I.label===o&&(C=I),M.label===o&&(O=M),C&&O&&(O&&(v=O),C&&(v&&(v.next=C,v=void 0),m||(m=C)))}v&&(v.next=m)},i.prototype._findLabeledEdgeRings=function(){var a=[],o=0;return this.edges.forEach(function(h){if(!(h.label>=0)){a.push(h);var m=h;do{m.label=o,m=m.next}while(!h.isEqual(m));o++}}),a},i.prototype.getEdgeRings=function(){var a=this;this._computeNextCWEdges(),this.edges.forEach(function(h){h.label=void 0}),this._findLabeledEdgeRings().forEach(function(h){a._findIntersectionNodes(h).forEach(function(m){a._computeNextCCWEdges(m,h.label)})});var o=[];return this.edges.forEach(function(h){h.ring||o.push(a._findEdgeRing(h))}),o},i.prototype._findIntersectionNodes=function(a){var o=[],h=a,m=function(){var v=0;h.from.getOuterEdges().forEach(function(b){b.label===a.label&&++v}),v>1&&o.push(h.from),h=h.next};do{m()}while(!a.isEqual(h));return o},i.prototype._findEdgeRing=function(a){var o=a,h=new qf;do{h.push(o),o.ring=h,o=o.next}while(!a.isEqual(o));return h},i.prototype.removeNode=function(a){var o=this;a.getOuterEdges().forEach(function(h){return o.removeEdge(h)}),a.innerEdges.forEach(function(h){return o.removeEdge(h)}),delete this.nodes[a.id]},i.prototype.removeEdge=function(a){this.edges=this.edges.filter(function(o){return!o.isEqual(a)}),a.deleteEdge()}}(),Et(9331),Et(6882),Et(3212);var ah={search:function(i,a,o,h){i.cleanDirty();var m=(h=h||{}).heuristic||ah.heuristics.manhattan,v=h.closest||!1,b=new Jl(function(i){return i.f}),I=a;for(a.h=m(a,o),b.push(a);b.size()>0;){var M=b.pop();if(M===o)return zp(M);M.closed=!0;for(var C=i.neighbors(M),O=0,R=C.length;O<R;++O){var N=C[O];if(!N.closed&&!N.isWall()){var B=M.g+N.getCost(M),Lt=N.visited;(!Lt||B<N.g)&&(N.visited=!0,N.parent=M,N.h=N.h||m(N,o),N.g=B,N.f=N.g+N.h,i.markDirty(N),v&&(N.h<I.h||N.h===I.h&&N.g<I.g)&&(I=N),Lt?b.rescoreElement(N):b.push(N))}}}return v?zp(I):[]},heuristics:{manhattan:function(i,a){return Math.abs(a.x-i.x)+Math.abs(a.y-i.y)},diagonal:function(i,a){var h=Math.sqrt(2),m=Math.abs(a.x-i.x),v=Math.abs(a.y-i.y);return 1*(m+v)+(h-2)*Math.min(m,v)}},cleanNode:function(i){i.f=0,i.g=0,i.h=0,i.visited=!1,i.closed=!1,i.parent=null}};function Ml(i,a){a=a||{},this.nodes=[],this.diagonal=!!a.diagonal,this.grid=[];for(var o=0;o<i.length;o++){this.grid[o]=[];for(var h=0,m=i[o];h<m.length;h++){var v=new Tl(o,h,m[h]);this.grid[o][h]=v,this.nodes.push(v)}}this.init()}function Tl(i,a,o){this.x=i,this.y=a,this.weight=o}function Jl(i){this.content=[],this.scoreFunction=i}function ba(){this._=null}function Al(i){i.U=i.C=i.L=i.R=i.P=i.N=null}function tl(i,a){var o=a,h=a.R,m=o.U;m?m.L===o?m.L=h:m.R=h:i._=h,h.U=m,o.U=h,o.R=h.L,o.R&&(o.R.U=o),h.L=o}function Da(i,a){var o=a,h=a.L,m=o.U;m?m.L===o?m.L=h:m.R=h:i._=h,h.U=m,o.U=h,o.L=h.R,o.L&&(o.L.U=o),h.R=o}function Bh(i){for(;i.L;)i=i.L;return i}Ml.prototype.init=function(){this.dirtyNodes=[];for(var i=0;i<this.nodes.length;i++)ah.cleanNode(this.nodes[i])},Ml.prototype.cleanDirty=function(){for(var i=0;i<this.dirtyNodes.length;i++)ah.cleanNode(this.dirtyNodes[i]);this.dirtyNodes=[]},Ml.prototype.markDirty=function(i){this.dirtyNodes.push(i)},Ml.prototype.neighbors=function(i){var a=[],o=i.x,h=i.y,m=this.grid;return m[o-1]&&m[o-1][h]&&a.push(m[o-1][h]),m[o+1]&&m[o+1][h]&&a.push(m[o+1][h]),m[o]&&m[o][h-1]&&a.push(m[o][h-1]),m[o]&&m[o][h+1]&&a.push(m[o][h+1]),this.diagonal&&(m[o-1]&&m[o-1][h-1]&&a.push(m[o-1][h-1]),m[o+1]&&m[o+1][h-1]&&a.push(m[o+1][h-1]),m[o-1]&&m[o-1][h+1]&&a.push(m[o-1][h+1]),m[o+1]&&m[o+1][h+1]&&a.push(m[o+1][h+1])),a},Ml.prototype.toString=function(){for(var o,h,m,v,i=[],a=this.grid,b=0,I=a.length;b<I;b++){for(o=[],m=0,v=(h=a[b]).length;m<v;m++)o.push(h[m].weight);i.push(o.join(" "))}return i.join("\n")},Tl.prototype.toString=function(){return"["+this.x+" "+this.y+"]"},Tl.prototype.getCost=function(i){return i&&i.x!==this.x&&i.y!==this.y?1.41421*this.weight:this.weight},Tl.prototype.isWall=function(){return 0===this.weight},Jl.prototype={push:function(i){this.content.push(i),this.sinkDown(this.content.length-1)},pop:function(){var i=this.content[0],a=this.content.pop();return this.content.length>0&&(this.content[0]=a,this.bubbleUp(0)),i},remove:function(i){var a=this.content.indexOf(i),o=this.content.pop();a!==this.content.length-1&&(this.content[a]=o,this.scoreFunction(o)<this.scoreFunction(i)?this.sinkDown(a):this.bubbleUp(a))},size:function(){return this.content.length},rescoreElement:function(i){this.sinkDown(this.content.indexOf(i))},sinkDown:function(i){for(var a=this.content[i];i>0;){var o=(i+1>>1)-1,h=this.content[o];if(!(this.scoreFunction(a)<this.scoreFunction(h)))break;this.content[o]=a,this.content[i]=h,i=o}},bubbleUp:function(i){for(var a=this.content.length,o=this.content[i],h=this.scoreFunction(o);;){var I,m=i+1<<1,v=m-1,b=null;if(v<a&&(I=this.scoreFunction(this.content[v]))<h&&(b=v),m<a&&this.scoreFunction(this.content[m])<(null===b?h:I)&&(b=m),null===b)break;this.content[i]=this.content[b],this.content[b]=o,i=b}}},ba.prototype={constructor:ba,insert:function(i,a){var o,h,m;if(i){if(a.P=i,a.N=i.N,i.N&&(i.N.P=a),i.N=a,i.R){for(i=i.R;i.L;)i=i.L;i.L=a}else i.R=a;o=i}else this._?(i=Bh(this._),a.P=null,a.N=i,i.P=i.L=a,o=i):(a.P=a.N=null,this._=a,o=null);for(a.L=a.R=null,a.U=o,a.C=!0,i=a;o&&o.C;)o===(h=o.U).L?(m=h.R)&&m.C?(o.C=m.C=!1,h.C=!0,i=h):(i===o.R&&(tl(this,o),o=(i=o).U),o.C=!1,h.C=!0,Da(this,h)):(m=h.L)&&m.C?(o.C=m.C=!1,h.C=!0,i=h):(i===o.L&&(Da(this,o),o=(i=o).U),o.C=!1,h.C=!0,tl(this,h)),o=i.U;this._.C=!1},remove:function(i){i.N&&(i.N.P=i.P),i.P&&(i.P.N=i.N),i.N=i.P=null;var o,v,b,a=i.U,h=i.L,m=i.R;if(v=h?m?Bh(m):h:m,a?a.L===i?a.L=v:a.R=v:this._=v,h&&m?(b=v.C,v.C=i.C,v.L=h,h.U=v,v!==m?(a=v.U,v.U=i.U,a.L=i=v.R,v.R=m,m.U=v):(v.U=a,a=v,i=v.R)):(b=i.C,i=v),i&&(i.U=a),!b){if(i&&i.C)return void(i.C=!1);do{if(i===this._)break;if(i===a.L){if((o=a.R).C&&(o.C=!1,a.C=!0,tl(this,a),o=a.R),o.L&&o.L.C||o.R&&o.R.C){(!o.R||!o.R.C)&&(o.L.C=!1,o.C=!0,Da(this,o),o=a.R),o.C=a.C,a.C=o.R.C=!1,tl(this,a),i=this._;break}}else if((o=a.L).C&&(o.C=!1,a.C=!0,Da(this,a),o=a.L),o.L&&o.L.C||o.R&&o.R.C){(!o.L||!o.L.C)&&(o.R.C=!1,o.C=!0,tl(this,o),o=a.L),o.C=a.C,a.C=o.L.C=!1,Da(this,a),i=this._;break}o.C=!0,i=a,a=a.U}while(!i.C);i&&(i.C=!1)}}};const Uh=ba;function Sc(i,a,o,h){var m=[null,null],v=es.push(m)-1;return m.left=i,m.right=a,o&&$l(m,i,a,o),h&&$l(m,a,i,h),qa[i.index].halfedges.push(v),qa[a.index].halfedges.push(v),m}function Kl(i,a,o){var h=[a,o];return h.left=i,h}function $l(i,a,o,h){i[0]||i[1]?i.left===o?i[1]=h:i[0]=h:(i[0]=h,i.left=a,i.right=o)}function qh(i,a,o,h,m){var mt,v=i[0],b=i[1],I=v[0],M=v[1],R=0,N=1,B=b[0]-I,Lt=b[1]-M;if(mt=a-I,B||!(mt>0)){if(mt/=B,B<0){if(mt<R)return;mt<N&&(N=mt)}else if(B>0){if(mt>N)return;mt>R&&(R=mt)}if(mt=h-I,B||!(mt<0)){if(mt/=B,B<0){if(mt>N)return;mt>R&&(R=mt)}else if(B>0){if(mt<R)return;mt<N&&(N=mt)}if(mt=o-M,Lt||!(mt>0)){if(mt/=Lt,Lt<0){if(mt<R)return;mt<N&&(N=mt)}else if(Lt>0){if(mt>N)return;mt>R&&(R=mt)}if(mt=m-M,Lt||!(mt<0)){if(mt/=Lt,Lt<0){if(mt>N)return;mt>R&&(R=mt)}else if(Lt>0){if(mt<R)return;mt<N&&(N=mt)}return!(R>0)&&!(N<1)||(R>0&&(i[0]=[I+R*B,M+R*Lt]),N<1&&(i[1]=[I+N*B,M+N*Lt])),!0}}}}}function $f(i,a,o,h,m){var v=i[1];if(v)return!0;var mt,te,b=i[0],I=i.left,M=i.right,C=I[0],O=I[1],R=M[0],N=M[1],B=(C+R)/2;if(N===O){if(B<a||B>=h)return;if(C>R){if(b){if(b[1]>=m)return}else b=[B,o];v=[B,m]}else{if(b){if(b[1]<o)return}else b=[B,m];v=[B,o]}}else if(te=(O+N)/2-(mt=(C-R)/(N-O))*B,mt<-1||mt>1)if(C>R){if(b){if(b[1]>=m)return}else b=[(o-te)/mt,o];v=[(m-te)/mt,m]}else{if(b){if(b[1]<o)return}else b=[(m-te)/mt,m];v=[(o-te)/mt,o]}else if(O<N){if(b){if(b[0]>=h)return}else b=[a,mt*a+te];v=[h,mt*h+te]}else{if(b){if(b[0]<a)return}else b=[h,mt*h+te];v=[a,mt*a+te]}return i[0]=b,i[1]=v,!0}function Gh(i,a){var o=i.site,h=a.left,m=a.right;return o===m&&(m=h,h=o),m?Math.atan2(m[1]-h[1],m[0]-h[0]):(o===h?(h=a[1],m=a[0]):(h=a[0],m=a[1]),Math.atan2(h[0]-m[0],m[1]-h[1]))}function Vh(i,a){return a[+(a.left!==i.site)]}function Bp(i,a){return a[+(a.left===i.site)]}var uh,Zh=[];function qp(){Al(this),this.x=this.y=this.arc=this.site=this.cy=null}function tc(i){var a=i.P,o=i.N;if(a&&o){var h=a.site,m=i.site,v=o.site;if(h!==v){var b=m[0],I=m[1],M=h[0]-b,C=h[1]-I,O=v[0]-b,R=v[1]-I,N=2*(M*R-C*O);if(!(N>=-td)){var B=M*M+C*C,Lt=O*O+R*R,mt=(R*B-C*Lt)/N,te=(M*Lt-O*B)/N,Nt=Zh.pop()||new qp;Nt.arc=i,Nt.site=m,Nt.x=mt+b,Nt.y=(Nt.cy=te+I)+Math.sqrt(mt*mt+te*te),i.circle=Nt;for(var pt=null,At=Ll._;At;)if(Nt.y<At.y||Nt.y===At.y&&Nt.x<=At.x){if(!At.L){pt=At.P;break}At=At.L}else{if(!At.R){pt=At;break}At=At.R}Ll.insert(pt,Nt),pt||(uh=Nt)}}}}function ec(i){var a=i.circle;a&&(a.P||(uh=a.N),Ll.remove(a),Zh.push(a),Al(a),i.circle=null)}var jh=[];function Gp(){Al(this),this.edge=this.site=this.circle=null}function Cc(i){var a=jh.pop()||new Gp;return a.site=i,a}function lh(i){ec(i),nc.remove(i),jh.push(i),Al(i)}function ch(i){var a=i.circle,o=a.x,h=a.cy,m=[o,h],v=i.P,b=i.N,I=[i];lh(i);for(var M=v;M.circle&&Math.abs(o-M.circle.x)<Do&&Math.abs(h-M.circle.cy)<Do;)v=M.P,I.unshift(M),lh(M),M=v;I.unshift(M),ec(M);for(var C=b;C.circle&&Math.abs(o-C.circle.x)<Do&&Math.abs(h-C.circle.cy)<Do;)b=C.N,I.push(C),lh(C),C=b;I.push(C),ec(C);var R,O=I.length;for(R=1;R<O;++R)$l((C=I[R]).edge,(M=I[R-1]).site,C.site,m);(C=I[O-1]).edge=Sc((M=I[0]).site,C.site,null,m),tc(M),tc(C)}function hh(i){for(var h,m,v,b,a=i[0],o=i[1],I=nc._;I;)if((v=Ic(I,o)-a)>Do)I=I.L;else{if(!((b=a-rc(I,o))>Do)){v>-Do?(h=I.P,m=I):b>-Do?(h=I,m=I.N):h=m=I;break}if(!I.R){h=I;break}I=I.R}!function(i){qa[i.index]={site:i,halfedges:[]}}(i);var M=Cc(i);if(nc.insert(h,M),h||m){if(h===m)return ec(h),m=Cc(h.site),nc.insert(M,m),M.edge=m.edge=Sc(h.site,M.site),tc(h),void tc(m);if(!m)return void(M.edge=Sc(h.site,M.site));ec(h),ec(m);var C=h.site,O=C[0],R=C[1],N=i[0]-O,B=i[1]-R,Lt=m.site,mt=Lt[0]-O,te=Lt[1]-R,Nt=2*(N*te-B*mt),pt=N*N+B*B,At=mt*mt+te*te,se=[(te*pt-B*At)/Nt+O,(N*At-mt*pt)/Nt+R];$l(m.edge,C,Lt,se),M.edge=Sc(C,i,null,se),m.edge=Sc(i,Lt,null,se),tc(h),tc(m)}}function Ic(i,a){var o=i.site,h=o[0],m=o[1],v=m-a;if(!v)return h;var b=i.P;if(!b)return-1/0;var I=(o=b.site)[0],M=o[1],C=M-a;if(!C)return I;var O=I-h,R=1/v-1/C,N=O/C;return R?(-N+Math.sqrt(N*N-2*R*(O*O/(-2*C)-M+C/2+m-v/2)))/R+h:(h+I)/2}function rc(i,a){var o=i.N;if(o)return Ic(o,a);var h=i.site;return h[1]===a?h[0]:1/0}var nc,qa,Ll,es,Do=1e-6,td=1e-12;function Xh(i,a,o){return(i[0]-o[0])*(a[1]-i[1])-(i[0]-a[0])*(o[1]-i[1])}function Vp(i,a){return a[1]-i[1]||a[0]-i[0]}function Yh(i,a){var h,m,v,o=i.sort(Vp).pop();for(es=[],qa=new Array(i.length),nc=new Uh,Ll=new Uh;;)if(v=uh,o&&(!v||o[1]<v.y||o[1]===v.y&&o[0]<v.x))(o[0]!==h||o[1]!==m)&&(hh(o),h=o[0],m=o[1]),o=i.pop();else{if(!v)break;ch(v.arc)}if(function(){for(var o,h,m,v,i=0,a=qa.length;i<a;++i)if((o=qa[i])&&(v=(h=o.halfedges).length)){var b=new Array(v),I=new Array(v);for(m=0;m<v;++m)b[m]=m,I[m]=Gh(o,es[h[m]]);for(b.sort(function(M,C){return I[C]-I[M]}),m=0;m<v;++m)I[m]=h[b[m]];for(m=0;m<v;++m)h[m]=I[m]}}(),a){var b=+a[0][0],I=+a[0][1],M=+a[1][0],C=+a[1][1];(function(i,a,o,h){for(var v,m=es.length;m--;)$f(v=es[m],i,a,o,h)&&qh(v,i,a,o,h)&&(Math.abs(v[0][0]-v[1][0])>Do||Math.abs(v[0][1]-v[1][1])>Do)||delete es[m]})(b,I,M,C),function(i,a,o,h){var v,b,I,M,C,O,R,N,B,Lt,mt,te,m=qa.length,Nt=!0;for(v=0;v<m;++v)if(b=qa[v]){for(I=b.site,M=(C=b.halfedges).length;M--;)es[C[M]]||C.splice(M,1);for(M=0,O=C.length;M<O;)mt=(Lt=Bp(b,es[C[M]]))[0],te=Lt[1],N=(R=Vh(b,es[C[++M%O]]))[0],B=R[1],(Math.abs(mt-N)>Do||Math.abs(te-B)>Do)&&(C.splice(M,0,es.push(Kl(I,Lt,Math.abs(mt-i)<Do&&h-te>Do?[i,Math.abs(N-i)<Do?B:h]:Math.abs(te-h)<Do&&o-mt>Do?[Math.abs(B-h)<Do?N:o,h]:Math.abs(mt-o)<Do&&te-a>Do?[o,Math.abs(N-o)<Do?B:a]:Math.abs(te-a)<Do&&mt-i>Do?[Math.abs(B-a)<Do?N:i,a]:null))-1),++O);O&&(Nt=!1)}if(Nt){var pt,At,se,ae=1/0;for(v=0,Nt=null;v<m;++v)(b=qa[v])&&(se=(pt=(I=b.site)[0]-i)*pt+(At=I[1]-a)*At)<ae&&(ae=se,Nt=b);if(Nt){var xe=[i,a],me=[i,h],Ae=[o,h],Vt=[o,a];Nt.halfedges.push(es.push(Kl(I=Nt.site,xe,me))-1,es.push(Kl(I,me,Ae))-1,es.push(Kl(I,Ae,Vt))-1,es.push(Kl(I,Vt,xe))-1)}}for(v=0;v<m;++v)(b=qa[v])&&(b.halfedges.length||delete qa[v])}(b,I,M,C)}this.edges=es,this.cells=qa,nc=Ll=es=qa=null}function t(){return new r}function r(){this.reset()}Yh.prototype={constructor:Yh,polygons:function(){var i=this.edges;return this.cells.map(function(a){var o=a.halfedges.map(function(h){return Vh(a,i[h])});return o.data=a.site.data,o})},triangles:function(){var i=[],a=this.edges;return this.cells.forEach(function(o,h){if(I=(v=o.halfedges).length)for(var v,I,M,m=o.site,b=-1,C=a[v[I-1]],O=C.left===m?C.right:C.left;++b<I;)M=O,O=(C=a[v[b]]).left===m?C.right:C.left,M&&O&&h<M.index&&h<O.index&&Xh(m,M,O)<0&&i.push([m.data,M.data,O.data])}),i},links:function(){return this.edges.filter(function(i){return i.right}).map(function(i){return{source:i.left.data,target:i.right.data}})},find:function(i,a,o){for(var m,I,h=this,v=h._found||0,b=h.cells.length;!(I=h.cells[v]);)if(++v>=b)return null;var M=i-I.site[0],C=a-I.site[1],O=M*M+C*C;do{I=h.cells[m=v],v=null,I.halfedges.forEach(function(R){var N=h.edges[R],B=N.left;if(B!==I.site&&B||(B=N.right)){var Lt=i-B[0],mt=a-B[1],te=Lt*Lt+mt*mt;te<O&&(O=te,v=B.index)}})}while(null!==v);return h._found=m,null==o||O<=o*o?I.site:null}},Et(171),Et(7299),r.prototype={constructor:r,reset:function(){this.s=this.t=0},add:function(i){d(s,i,this.t),d(this,s.s,this.s),this.s?this.t+=s.t:this.s=s.t},valueOf:function(){return this.s}};var s=new r;function d(i,a,o){var h=i.s=a+o,m=h-a;i.t=a-(h-m)+(o-m)}var i,S=Math.PI,A=S/2,U=2*S,V=S/180,at=(Math,Math.atan),Ct=Math.atan2,_t=Math.cos,ue=(Math,Math,Math,Math,Math,Math.sin),Ke=(Math,Math.sqrt);Math;function hr(i){return i>1?A:i<-1?-A:Math.asin(i)}function Ou(i,a){return[i>S?i-U:i<-S?i+U:i,a]}function up(i,a){return i<a?-1:i>a?1:i>=a?0:NaN}t(),t(),t(),Ou.invert=Ou,1===(i=up).length&&(i=function(i){return function(a,o){return up(i(a),o)}}(i)),Math.sqrt(50),Math.sqrt(10),Math.sqrt(2);t();function Ad(){}function wg(i){return function(a,o){var h=_t(a),m=_t(o),v=i(h*m);return[v*m*ue(a),v*ue(o)]}}function yp(i){return function(a,o){var h=Ke(a*a+o*o),m=i(h),v=ue(m),b=_t(m);return[Ct(a*v,h*b),hr(h&&o*v/h)]}}function Od(i,a){return[i,a]}t(),t(),t(),t(),Ad.prototype={constructor:Ad,point:function(i,a){this.stream.point(i,a)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}},_t(30*V),wg(function(i){return Ke(2/(1+i))}).invert=yp(function(i){return 2*hr(i/2)}),wg(function(i){return(i=function(i){return i>1?0:i<-1?S:Math.acos(i)}(i))&&i/ue(i)}).invert=yp(function(i){return i}),Od.invert=Od,yp(at),yp(hr),yp(function(i){return 2*at(i)});const Am=JSON.parse('{"type":"Polygon","coordinates":[[[-80.5189298163933,40.64111135513909],[-80.5189298163933,39.72088328710156],[-79.47752051463135,39.720883287101685],[-78.54990271677599,39.71982392023972],[-78.23291948109767,39.72140005142455],[-77.5232987128656,39.72566335708859],[-76.66818294951588,39.720883287101685],[-75.78764238147852,39.72354462336466],[-75.71090287952501,39.80237702082593],[-75.62096004912104,39.847361355135945],[-75.40557267932849,39.795504055331094],[-75.200804816372,39.88704885513607],[-75.12881954618945,39.949499823560814],[-74.89175391305048,40.08179149022811],[-74.76318294950823,40.19077708593164],[-75.07802161324645,40.44954682063326],[-75.09548824736112,40.555380153966894],[-75.20395707874178,40.58661855728735],[-75.19920284697093,40.74746145279573],[-75.08225908069448,40.8697020533823],[-75.1357183499004,40.999874986325494],[-74.97590898303775,41.087724921221536],[-74.80126848010735,41.31156138769393],[-74.67902787952096,41.35548635514192],[-74.84043921578461,41.42638642024633],[-75.01081641305097,41.49571035416608],[-75.07538611519954,41.6412311874999],[-75.04892778186621,41.751301988281625],[-75.1679902818666,41.84178742122464],[-75.38547054716696,41.99896129004043],[-76.74383724639114,42.00053742122532],[-78.20064754913136,42.00002065690239],[-79.76008724640326,42.00002065690239],[-79.76008724640326,42.50006765397467],[-79.77303961320486,42.54612229847678],[-80.24744767934794,42.36619985612248],[-80.5162684801303,42.324910386721456],[-80.5162684801303,42.32439362239842],[-80.5189298163933,40.64111135513909]]]}');var Lm=Et.t(Am,2),fl=Et(8583),Ih=Et(4347);function hc(i,a,o,h){return new(o||(o=Promise))(function(v,b){function I(O){try{C(h.next(O))}catch(R){b(R)}}function M(O){try{C(h.throw(O))}catch(R){b(R)}}function C(O){O.done?v(O.value):function(v){return v instanceof o?v:new o(function(b){b(v)})}(O.value).then(I,M)}C((h=h.apply(i,a||[])).next())})}var zg=Et(9765),xf=Et(5319);class Fg extends zg.xQ{constructor(){super(...arguments),this.value=null,this.hasNext=!1,this.hasCompleted=!1}_subscribe(a){return this.hasError?(a.error(this.thrownError),xf.w.EMPTY):this.hasCompleted&&this.hasNext?(a.next(this.value),a.complete(),xf.w.EMPTY):super._subscribe(a)}next(a){this.hasCompleted||(this.value=a,this.hasNext=!0)}error(a){this.hasCompleted||super.error(a)}complete(){this.hasCompleted=!0,this.hasNext&&super.next(this.value),super.complete()}}var Bg=Et(2759),Ug=Et(8049),qg=Et(5435),Gg=Et(4395),Rm=Et(3190),Nm=Et(6736),km=Et(9761);const zm=["content"],Fm=["*"],Bm=["container"];let Jc=(()=>{class i{constructor(o){this.zone=o,this.mapCreated=new Fg,this.mapLoaded=new Fg,this.markersToRemove=[],this.popupsToRemove=[],this.imageIdsToRemove=[],this.subscription=new xf.w,this.mapCreated$=this.mapCreated.asObservable(),this.mapLoaded$=this.mapLoaded.asObservable()}setup(o){this.zone.onStable.pipe((0,Ug.P)()).subscribe(()=>{o.customMapboxApiUrl&&this.assign(Ih,"config.API_URL",o.customMapboxApiUrl),this.createMap(o.mapOptions),this.hookEvents(o.mapEvents),this.mapEvents=o.mapEvents,this.mapCreated.next(void 0),this.mapCreated.complete()})}destroyMap(){this.mapInstance&&(this.subscription.unsubscribe(),this.mapInstance.remove())}updateMinZoom(o){return this.zone.runOutsideAngular(()=>{this.mapInstance.setMinZoom(o)})}updateMaxZoom(o){return this.zone.runOutsideAngular(()=>{this.mapInstance.setMaxZoom(o)})}updateMinPitch(o){return this.zone.runOutsideAngular(()=>{this.mapInstance.setMinPitch(o)})}updateMaxPitch(o){return this.zone.runOutsideAngular(()=>{this.mapInstance.setMaxPitch(o)})}updateRenderWorldCopies(o){return this.zone.runOutsideAngular(()=>{this.mapInstance.setRenderWorldCopies(o)})}updateScrollZoom(o){return this.zone.runOutsideAngular(()=>{o?this.mapInstance.scrollZoom.enable():this.mapInstance.scrollZoom.disable()})}updateDragRotate(o){return this.zone.runOutsideAngular(()=>{o?this.mapInstance.dragRotate.enable():this.mapInstance.dragRotate.disable()})}updateTouchPitch(o){return this.zone.runOutsideAngular(()=>{o?this.mapInstance.touchPitch.enable():this.mapInstance.touchPitch.disable()})}updateTouchZoomRotate(o){return this.zone.runOutsideAngular(()=>{o?this.mapInstance.touchZoomRotate.enable():this.mapInstance.touchZoomRotate.disable()})}updateDoubleClickZoom(o){return this.zone.runOutsideAngular(()=>{o?this.mapInstance.doubleClickZoom.enable():this.mapInstance.doubleClickZoom.disable()})}updateKeyboard(o){return this.zone.runOutsideAngular(()=>{o?this.mapInstance.keyboard.enable():this.mapInstance.keyboard.disable()})}updateDragPan(o){return this.zone.runOutsideAngular(()=>{o?this.mapInstance.dragPan.enable():this.mapInstance.dragPan.disable()})}updateBoxZoom(o){return this.zone.runOutsideAngular(()=>{o?this.mapInstance.boxZoom.enable():this.mapInstance.boxZoom.disable()})}updateStyle(o){return this.zone.runOutsideAngular(()=>{this.mapInstance.setStyle(o)})}updateMaxBounds(o){return this.zone.runOutsideAngular(()=>{this.mapInstance.setMaxBounds(o)})}changeCanvasCursor(o){this.mapInstance.getCanvasContainer().style.cursor=o}queryRenderedFeatures(o,h){return this.mapInstance.queryRenderedFeatures(o,h)}panTo(o,h){return this.zone.runOutsideAngular(()=>{this.mapInstance.panTo(o,h)})}move(o,h,m,v,b,I){return this.zone.runOutsideAngular(()=>{this.mapInstance[o](Object.assign(Object.assign({},h),{zoom:m||this.mapInstance.getZoom(),center:v||this.mapInstance.getCenter(),bearing:b||this.mapInstance.getBearing(),pitch:I||this.mapInstance.getPitch()}))})}addLayer(o,h,m){this.zone.runOutsideAngular(()=>{Object.keys(o.layerOptions).forEach(v=>{void 0===o.layerOptions[v]&&delete o.layerOptions[v]}),this.mapInstance.addLayer(o.layerOptions,m),h&&((o.layerEvents.layerClick.observers.length||o.layerEvents.click.observers.length)&&this.mapInstance.on("click",o.layerOptions.id,v=>{this.zone.run(()=>{o.layerEvents.layerClick.emit(v),o.layerEvents.click.emit(v)})}),(o.layerEvents.layerDblClick.observers.length||o.layerEvents.dblClick.observers.length)&&this.mapInstance.on("dblclick",o.layerOptions.id,v=>{this.zone.run(()=>{o.layerEvents.layerDblClick.emit(v),o.layerEvents.dblClick.emit(v)})}),(o.layerEvents.layerMouseDown.observers.length||o.layerEvents.mouseDown.observers.length)&&this.mapInstance.on("mousedown",o.layerOptions.id,v=>{this.zone.run(()=>{o.layerEvents.layerMouseDown.emit(v),o.layerEvents.mouseDown.emit(v)})}),(o.layerEvents.layerMouseUp.observers.length||o.layerEvents.mouseUp.observers.length)&&this.mapInstance.on("mouseup",o.layerOptions.id,v=>{this.zone.run(()=>{o.layerEvents.layerMouseUp.emit(v),o.layerEvents.mouseUp.emit(v)})}),(o.layerEvents.layerMouseEnter.observers.length||o.layerEvents.mouseEnter.observers.length)&&this.mapInstance.on("mouseenter",o.layerOptions.id,v=>{this.zone.run(()=>{o.layerEvents.layerMouseEnter.emit(v),o.layerEvents.mouseEnter.emit(v)})}),(o.layerEvents.layerMouseLeave.observers.length||o.layerEvents.mouseLeave.observers.length)&&this.mapInstance.on("mouseleave",o.layerOptions.id,v=>{this.zone.run(()=>{o.layerEvents.layerMouseLeave.emit(v),o.layerEvents.mouseLeave.emit(v)})}),(o.layerEvents.layerMouseMove.observers.length||o.layerEvents.mouseMove.observers.length)&&this.mapInstance.on("mousemove",o.layerOptions.id,v=>{this.zone.run(()=>{o.layerEvents.layerMouseMove.emit(v),o.layerEvents.mouseMove.emit(v)})}),(o.layerEvents.layerMouseOver.observers.length||o.layerEvents.mouseOver.observers.length)&&this.mapInstance.on("mouseover",o.layerOptions.id,v=>{this.zone.run(()=>{o.layerEvents.layerMouseOver.emit(v),o.layerEvents.mouseOver.emit(v)})}),(o.layerEvents.layerMouseOut.observers.length||o.layerEvents.mouseOut.observers.length)&&this.mapInstance.on("mouseout",o.layerOptions.id,v=>{this.zone.run(()=>{o.layerEvents.layerMouseOut.emit(v),o.layerEvents.mouseOut.emit(v)})}),(o.layerEvents.layerContextMenu.observers.length||o.layerEvents.contextMenu.observers.length)&&this.mapInstance.on("contextmenu",o.layerOptions.id,v=>{this.zone.run(()=>{o.layerEvents.layerContextMenu.emit(v),o.layerEvents.contextMenu.emit(v)})}),(o.layerEvents.layerTouchStart.observers.length||o.layerEvents.touchStart.observers.length)&&this.mapInstance.on("touchstart",o.layerOptions.id,v=>{this.zone.run(()=>{o.layerEvents.layerTouchStart.emit(v),o.layerEvents.touchStart.emit(v)})}),(o.layerEvents.layerTouchEnd.observers.length||o.layerEvents.touchEnd.observers.length)&&this.mapInstance.on("touchend",o.layerOptions.id,v=>{this.zone.run(()=>{o.layerEvents.layerTouchEnd.emit(v),o.layerEvents.touchEnd.emit(v)})}),(o.layerEvents.layerTouchCancel.observers.length||o.layerEvents.touchCancel.observers.length)&&this.mapInstance.on("touchcancel",o.layerOptions.id,v=>{this.zone.run(()=>{o.layerEvents.layerTouchCancel.emit(v),o.layerEvents.touchCancel.emit(v)})}))})}removeLayer(o){this.zone.runOutsideAngular(()=>{null!=this.mapInstance.getLayer(o)&&this.mapInstance.removeLayer(o)})}addMarker(o){const h={offset:o.markersOptions.offset,anchor:o.markersOptions.anchor,draggable:!!o.markersOptions.draggable,rotationAlignment:o.markersOptions.rotationAlignment,pitchAlignment:o.markersOptions.pitchAlignment,clickTolerance:o.markersOptions.clickTolerance};o.markersOptions.element.childNodes.length>0&&(h.element=o.markersOptions.element);const m=new Ih.Marker(h);return(o.markersEvents.markerDragStart.observers.length||o.markersEvents.dragStart.observers.length)&&m.on("dragstart",b=>{if(b){const{target:I}=b;this.zone.run(()=>{o.markersEvents.markerDragStart.emit(I),o.markersEvents.dragStart.emit(I)})}}),(o.markersEvents.markerDrag.observers.length||o.markersEvents.drag.observers.length)&&m.on("drag",b=>{if(b){const{target:I}=b;this.zone.run(()=>{o.markersEvents.markerDrag.emit(I),o.markersEvents.drag.emit(I)})}}),(o.markersEvents.markerDragEnd.observers.length||o.markersEvents.dragEnd.observers.length)&&m.on("dragend",b=>{if(b){const{target:I}=b;this.zone.run(()=>{o.markersEvents.markerDragEnd.emit(I),o.markersEvents.dragEnd.emit(I)})}}),m.setLngLat(o.markersOptions.feature?o.markersOptions.feature.geometry.coordinates:o.markersOptions.lngLat),this.zone.runOutsideAngular(()=>(m.addTo(this.mapInstance),m))}removeMarker(o){this.markersToRemove.push(o)}createPopup(o,h){return this.zone.runOutsideAngular(()=>{Object.keys(o.popupOptions).forEach(v=>void 0===o.popupOptions[v]&&delete o.popupOptions[v]);const m=new Ih.Popup(o.popupOptions);return m.setDOMContent(h),(o.popupEvents.popupClose.observers.length||o.popupEvents.close.observers.length)&&m.on("close",()=>{this.zone.run(()=>{o.popupEvents.popupClose.emit(),o.popupEvents.close.emit()})}),(o.popupEvents.popupOpen.observers.length||o.popupEvents.open.observers.length)&&m.on("open",()=>{this.zone.run(()=>{o.popupEvents.popupOpen.emit(),o.popupEvents.open.emit()})}),m})}addPopupToMap(o,h,m=!1){return this.zone.runOutsideAngular(()=>{m&&o._listeners&&delete o._listeners.open,o.setLngLat(h),o.addTo(this.mapInstance)})}addPopupToMarker(o,h){return this.zone.runOutsideAngular(()=>{o.setPopup(h)})}removePopupFromMap(o,h=!1){h&&o._listeners&&delete o._listeners.close,this.popupsToRemove.push(o)}removePopupFromMarker(o){return this.zone.runOutsideAngular(()=>{o.setPopup(void 0)})}addControl(o,h){return this.zone.runOutsideAngular(()=>{this.mapInstance.addControl(o,h)})}removeControl(o){return this.zone.runOutsideAngular(()=>{this.mapInstance.removeControl(o)})}loadAndAddImage(o,h,m){return hc(this,void 0,void 0,function*(){return this.zone.runOutsideAngular(()=>new Promise((v,b)=>{this.mapInstance.loadImage(h,(I,M)=>{I?b(I):(this.addImage(o,M,m),v())})}))})}addImage(o,h,m){return this.zone.runOutsideAngular(()=>{this.mapInstance.addImage(o,h,m)})}removeImage(o){this.imageIdsToRemove.push(o)}addSource(o,h){return this.zone.runOutsideAngular(()=>{Object.keys(h).forEach(m=>void 0===h[m]&&delete h[m]),this.mapInstance.addSource(o,h)})}getSource(o){return this.mapInstance.getSource(o)}removeSource(o){this.zone.runOutsideAngular(()=>{this.findLayersBySourceId(o).forEach(h=>this.mapInstance.removeLayer(h.id)),this.mapInstance.removeSource(o)})}setAllLayerPaintProperty(o,h){return this.zone.runOutsideAngular(()=>{Object.keys(h).forEach(m=>{this.mapInstance.setPaintProperty(o,m,h[m])})})}setAllLayerLayoutProperty(o,h){return this.zone.runOutsideAngular(()=>{Object.keys(h).forEach(m=>{this.mapInstance.setLayoutProperty(o,m,h[m])})})}setLayerFilter(o,h){return this.zone.runOutsideAngular(()=>{this.mapInstance.setFilter(o,h)})}setLayerBefore(o,h){return this.zone.runOutsideAngular(()=>{this.mapInstance.moveLayer(o,h)})}setLayerZoomRange(o,h,m){return this.zone.runOutsideAngular(()=>{this.mapInstance.setLayerZoomRange(o,h||0,m||20)})}fitBounds(o,h){return this.zone.runOutsideAngular(()=>{this.mapInstance.fitBounds(o,h)})}fitScreenCoordinates(o,h,m){return this.zone.runOutsideAngular(()=>{this.mapInstance.fitScreenCoordinates(o[0],o[1],h,m)})}applyChanges(){this.zone.runOutsideAngular(()=>{this.removeMarkers(),this.removePopups(),this.removeImages()})}createMap(o){D.R0b.assertNotInAngularZone(),Object.keys(o).forEach(m=>{void 0===o[m]&&delete o[m]}),this.mapInstance=new Ih.Map(o),window&&/msie\s|trident\/|edge\//i.test(window.navigator.userAgent)&&this.mapInstance.setStyle(o.style),this.subscription.add(this.zone.onMicrotaskEmpty.subscribe(()=>this.applyChanges()))}removeMarkers(){for(const o of this.markersToRemove)o.remove();this.markersToRemove=[]}removePopups(){for(const o of this.popupsToRemove)o.remove();this.popupsToRemove=[]}removeImages(){for(const o of this.imageIdsToRemove)this.mapInstance.removeImage(o);this.imageIdsToRemove=[]}findLayersBySourceId(o){const h=this.mapInstance.getStyle().layers;return null==h?[]:h.filter(m=>"source"in m&&m.source===o)}hookEvents(o){this.mapInstance.on("load",h=>{this.mapLoaded.next(void 0),this.mapLoaded.complete(),this.zone.run(()=>{o.mapLoad.emit(h.target),o.load.emit(h.target)})}),(o.mapResize.observers.length||o.resize.observers.length)&&this.mapInstance.on("resize",h=>this.zone.run(()=>{o.mapResize.emit(h),o.resize.emit(h)})),(o.mapRemove.observers.length||o.remove.observers.length)&&this.mapInstance.on("remove",h=>this.zone.run(()=>{o.mapRemove.emit(h),o.remove.emit(h)})),(o.mapMouseDown.observers.length||o.mouseDown.observers.length)&&this.mapInstance.on("mousedown",h=>this.zone.run(()=>{o.mapMouseDown.emit(h),o.mouseDown.emit(h)})),(o.mapMouseUp.observers.length||o.mouseUp.observers.length)&&this.mapInstance.on("mouseup",h=>this.zone.run(()=>{o.mapMouseUp.emit(h),o.mouseUp.emit(h)})),(o.mapMouseMove.observers.length||o.mouseMove.observers.length)&&this.mapInstance.on("mousemove",h=>this.zone.run(()=>{o.mapMouseMove.emit(h),o.mouseMove.emit(h)})),(o.mapClick.observers.length||o.click.observers.length)&&this.mapInstance.on("click",h=>this.zone.run(()=>{o.mapClick.emit(h),o.click.emit(h)})),(o.mapDblClick.observers.length||o.dblClick.observers.length)&&this.mapInstance.on("dblclick",h=>this.zone.run(()=>{o.mapDblClick.emit(h),o.dblClick.emit(h)})),(o.mapMouseOver.observers.length||o.mouseOver.observers.length)&&this.mapInstance.on("mouseover",h=>this.zone.run(()=>{o.mapMouseOver.emit(h),o.mouseOver.emit(h)})),(o.mapMouseOut.observers.length||o.mouseOut.observers.length)&&this.mapInstance.on("mouseout",h=>this.zone.run(()=>{o.mapMouseOut.emit(h),o.mouseOut.emit(h)})),(o.mapContextMenu.observers.length||o.contextMenu.observers.length)&&this.mapInstance.on("contextmenu",h=>this.zone.run(()=>{o.mapContextMenu.emit(h),o.contextMenu.emit(h)})),(o.mapTouchStart.observers.length||o.touchStart.observers.length)&&this.mapInstance.on("touchstart",h=>this.zone.run(()=>{o.mapTouchStart.emit(h),o.touchStart.emit(h)})),(o.mapTouchEnd.observers.length||o.touchEnd.observers.length)&&this.mapInstance.on("touchend",h=>this.zone.run(()=>{o.mapTouchEnd.emit(h),o.touchEnd.emit(h)})),(o.mapTouchMove.observers.length||o.touchMove.observers.length)&&this.mapInstance.on("touchmove",h=>this.zone.run(()=>{o.mapTouchMove.emit(h),o.touchMove.emit(h)})),(o.mapTouchCancel.observers.length||o.touchCancel.observers.length)&&this.mapInstance.on("touchcancel",h=>this.zone.run(()=>{o.mapTouchCancel.emit(h),o.touchCancel.emit(h)})),(o.mapWheel.observers.length||o.wheel.observers.length)&&this.mapInstance.on("wheel",h=>this.zone.run(()=>{o.mapWheel.emit(h),o.wheel.emit(h)})),o.moveStart.observers.length&&this.mapInstance.on("movestart",h=>this.zone.run(()=>o.moveStart.emit(h))),o.move.observers.length&&this.mapInstance.on("move",h=>this.zone.run(()=>o.move.emit(h))),o.moveEnd.observers.length&&this.mapInstance.on("moveend",h=>this.zone.run(()=>o.moveEnd.emit(h))),(o.mapDragStart.observers.length||o.dragStart.observers.length)&&this.mapInstance.on("dragstart",h=>this.zone.run(()=>{o.mapDragStart.emit(h),o.dragStart.emit(h)})),(o.mapDrag.observers.length||o.drag.observers.length)&&this.mapInstance.on("drag",h=>this.zone.run(()=>{o.mapDrag.emit(h),o.drag.emit(h)})),(o.mapDragEnd.observers.length||o.dragEnd.observers.length)&&this.mapInstance.on("dragend",h=>this.zone.run(()=>{o.mapDragEnd.emit(h),o.dragEnd.emit(h)})),o.zoomStart.observers.length&&this.mapInstance.on("zoomstart",h=>this.zone.run(()=>o.zoomStart.emit(h))),o.zoomEvt.observers.length&&this.mapInstance.on("zoom",h=>this.zone.run(()=>o.zoomEvt.emit(h))),o.zoomEnd.observers.length&&this.mapInstance.on("zoomend",h=>this.zone.run(()=>o.zoomEnd.emit(h))),o.rotateStart.observers.length&&this.mapInstance.on("rotatestart",h=>this.zone.run(()=>o.rotateStart.emit(h))),o.rotate.observers.length&&this.mapInstance.on("rotate",h=>this.zone.run(()=>o.rotate.emit(h))),o.rotateEnd.observers.length&&this.mapInstance.on("rotateend",h=>this.zone.run(()=>o.rotateEnd.emit(h))),o.pitchStart.observers.length&&this.mapInstance.on("pitchstart",h=>this.zone.run(()=>o.pitchStart.emit(h))),o.pitchEvt.observers.length&&this.mapInstance.on("pitch",h=>this.zone.run(()=>o.pitchEvt.emit(h))),o.pitchEnd.observers.length&&this.mapInstance.on("pitchend",h=>this.zone.run(()=>o.pitchEnd.emit(h))),o.boxZoomStart.observers.length&&this.mapInstance.on("boxzoomstart",h=>this.zone.run(()=>o.boxZoomStart.emit(h))),o.boxZoomEnd.observers.length&&this.mapInstance.on("boxzoomend",h=>this.zone.run(()=>o.boxZoomEnd.emit(h))),o.boxZoomCancel.observers.length&&this.mapInstance.on("boxzoomcancel",h=>this.zone.run(()=>o.boxZoomCancel.emit(h))),o.webGlContextLost.observers.length&&this.mapInstance.on("webglcontextlost",h=>this.zone.run(()=>o.webGlContextLost.emit(h))),o.webGlContextRestored.observers.length&&this.mapInstance.on("webglcontextrestored",h=>this.zone.run(()=>o.webGlContextRestored.emit(h))),o.render.observers.length&&this.mapInstance.on("render",h=>this.zone.run(()=>o.render.emit(h))),(o.mapError.observers.length||o.error.observers.length)&&this.mapInstance.on("error",h=>this.zone.run(()=>{o.mapError.emit(h),o.error.emit(h)})),o.data.observers.length&&this.mapInstance.on("data",h=>this.zone.run(()=>o.data.emit(h))),o.styleData.observers.length&&this.mapInstance.on("styledata",h=>this.zone.run(()=>o.styleData.emit(h))),o.sourceData.observers.length&&this.mapInstance.on("sourcedata",h=>this.zone.run(()=>o.sourceData.emit(h))),o.dataLoading.observers.length&&this.mapInstance.on("dataloading",h=>this.zone.run(()=>o.dataLoading.emit(h))),o.styleDataLoading.observers.length&&this.mapInstance.on("styledataloading",h=>this.zone.run(()=>o.styleDataLoading.emit(h))),o.sourceDataLoading.observers.length&&this.mapInstance.on("sourcedataloading",h=>this.zone.run(()=>o.sourceDataLoading.emit(h))),o.styleImageMissing.observers.length&&this.mapInstance.on("styleimagemissing",h=>this.zone.run(()=>o.styleImageMissing.emit(h))),o.idle.observers.length&&this.mapInstance.on("idle",h=>this.zone.run(()=>o.idle.emit(h)))}assign(o,h,m){if("string"==typeof h&&(h=h.split(".")),h.length>1){const v=h.shift();this.assign(o[v]="[object Object]"===Object.prototype.toString.call(o[v])?o[v]:{},h,m)}else o[h[0]]=m}}return i.\u0275fac=function(o){return new(o||i)(D.LFG(D.R0b))},i.\u0275prov=D.Yz7({token:i,factory:i.\u0275fac}),i})();class Zm{constructor(a){this.container=a}onAdd(){return this.container}onRemove(){return this.container.parentNode.removeChild(this.container)}getDefaultPosition(){return"top-right"}}let Rd=(()=>{class i{constructor(o){this.MapService=o,this.controlAdded=!1}ngAfterContentInit(){this.content.nativeElement.childNodes.length&&(this.control=new Zm(this.content.nativeElement),this.MapService.mapCreated$.subscribe(()=>{this.MapService.addControl(this.control,this.position),this.controlAdded=!0}))}ngOnDestroy(){this.controlAdded&&this.MapService.removeControl(this.control)}}return i.\u0275fac=function(o){return new(o||i)(D.Y36(Jc))},i.\u0275cmp=D.Xpm({type:i,selectors:[["mgl-control"]],viewQuery:function(o,h){if(1&o&&D.Gf(zm,7),2&o){let m;D.iGM(m=D.CRH())&&(h.content=m.first)}},inputs:{position:"position"},ngContentSelectors:Fm,decls:3,vars:0,consts:[[1,"maplibregl-ctrl"],["content",""]],template:function(o,h){1&o&&(D.F$t(),D.TgZ(0,"div",0,1),D.Hsn(2),D.qZA())},encapsulation:2,changeDetection:0}),i})(),jm=(()=>{class i{constructor(o,h){this.MapService=o,this.ControlComponent=h}ngAfterContentInit(){this.MapService.mapCreated$.subscribe(()=>{if(this.ControlComponent.control)throw new Error("Another control is already set for this control");const o={};void 0!==this.showCompass&&(o.showCompass=this.showCompass),void 0!==this.showZoom&&(o.showZoom=this.showZoom),this.ControlComponent.control=new Ih.NavigationControl(o),this.MapService.addControl(this.ControlComponent.control,this.ControlComponent.position)})}}return i.\u0275fac=function(o){return new(o||i)(D.Y36(Jc),D.Y36(Rd,1))},i.\u0275dir=D.lG2({type:i,selectors:[["","mglNavigation",""]],inputs:{showCompass:"showCompass",showZoom:"showZoom"}}),i})(),Xm=(()=>{class i{constructor(o,h){this.MapService=o,this.ControlComponent=h}ngOnChanges(o){o.unit&&!o.unit.isFirstChange()&&this.ControlComponent.control.setUnit(o.unit.currentValue)}ngAfterContentInit(){this.MapService.mapCreated$.subscribe(()=>{if(this.ControlComponent.control)throw new Error("Another control is already set for this control");const o={};void 0!==this.maxWidth&&(o.maxWidth=this.maxWidth),void 0!==this.unit&&(o.unit=this.unit),this.ControlComponent.control=new Ih.ScaleControl(o),this.MapService.addControl(this.ControlComponent.control,this.ControlComponent.position)})}}return i.\u0275fac=function(o){return new(o||i)(D.Y36(Jc),D.Y36(Rd,1))},i.\u0275dir=D.lG2({type:i,selectors:[["","mglScale",""]],inputs:{maxWidth:"maxWidth",unit:"unit"},features:[D.TTD]}),i})();function Zg(i,a,o){console.warn(`[ngx-maplibre-gl]: ${i}: ${a} is deprecated, please use ${o} instead.`)}let jg=(()=>{class i{constructor(o,h){this.MapService=o,this.zone=h,this.updateFeatureData=new zg.xQ,this.sub=new xf.w,this.sourceAdded=!1,this.featureIdCounter=0}ngOnInit(){this.data||(this.data={type:"FeatureCollection",features:[]});const o=this.MapService.mapLoaded$.subscribe(()=>{this.init();const h=(0,Bg.R)(this.MapService.mapInstance,"styledata").pipe((0,qg.h)(()=>!this.MapService.mapInstance.getSource(this.id))).subscribe(()=>{this.init()});this.sub.add(h)});this.sub.add(o)}ngOnChanges(o){!this.sourceAdded||((o.maxzoom&&!o.maxzoom.isFirstChange()||o.attribution&&!o.attribution.isFirstChange()||o.buffer&&!o.buffer.isFirstChange()||o.tolerance&&!o.tolerance.isFirstChange()||o.cluster&&!o.cluster.isFirstChange()||o.clusterRadius&&!o.clusterRadius.isFirstChange()||o.clusterMaxZoom&&!o.clusterMaxZoom.isFirstChange()||o.clusterMinPoints&&!o.clusterMinPoints.isFirstChange()||o.clusterProperties&&!o.clusterProperties.isFirstChange()||o.lineMetrics&&!o.lineMetrics.isFirstChange()||o.generateId&&!o.generateId.isFirstChange()||o.promoteId&&!o.promoteId.isFirstChange()||o.filter&&!o.filter.isFirstChange())&&(this.ngOnDestroy(),this.ngOnInit()),o.data&&!o.data.isFirstChange()&&setTimeout(()=>{this.MapService.getSource(this.id).setData(this.data)},0))}ngOnDestroy(){this.sub.unsubscribe(),this.sourceAdded&&(this.MapService.removeSource(this.id),this.sourceAdded=!1)}getClusterExpansionZoom(o){return hc(this,void 0,void 0,function*(){const h=this.MapService.getSource(this.id);return this.zone.run(()=>hc(this,void 0,void 0,function*(){return new Promise((m,v)=>{h.getClusterExpansionZoom(o,(b,I)=>{b?v(b):m(I)})})}))})}getClusterChildren(o){return hc(this,void 0,void 0,function*(){const h=this.MapService.getSource(this.id);return this.zone.run(()=>hc(this,void 0,void 0,function*(){return new Promise((m,v)=>{h.getClusterChildren(o,(b,I)=>{b?v(b):m(I)})})}))})}getClusterLeaves(o,h,m){return hc(this,void 0,void 0,function*(){const v=this.MapService.getSource(this.id);return this.zone.run(()=>hc(this,void 0,void 0,function*(){return new Promise((b,I)=>{v.getClusterLeaves(o,h,m,(M,C)=>{M?I(M):b(C)})})}))})}_addFeature(o){this.data.features.push(o),this.updateFeatureData.next()}_removeFeature(o){const h=this.data,m=h.features.indexOf(o);m>-1&&h.features.splice(m,1),this.updateFeatureData.next()}_getNewFeatureId(){return++this.featureIdCounter}init(){this.MapService.addSource(this.id,{type:"geojson",data:this.data,maxzoom:this.maxzoom,attribution:this.attribution,buffer:this.buffer,tolerance:this.tolerance,cluster:this.cluster,clusterRadius:this.clusterRadius,clusterMaxZoom:this.clusterMaxZoom,clusterMinPoints:this.clusterMinPoints,clusterProperties:this.clusterProperties,lineMetrics:this.lineMetrics,generateId:this.generateId,promoteId:this.promoteId,filter:this.filter});const h=this.updateFeatureData.pipe((0,Gg.b)(0)).subscribe(()=>{this.MapService.getSource(this.id).setData(this.data)});this.sub.add(h),this.sourceAdded=!0}}return i.\u0275fac=function(o){return new(o||i)(D.Y36(Jc),D.Y36(D.R0b))},i.\u0275cmp=D.Xpm({type:i,selectors:[["mgl-geojson-source"]],inputs:{id:"id",data:"data",maxzoom:"maxzoom",attribution:"attribution",buffer:"buffer",tolerance:"tolerance",cluster:"cluster",clusterRadius:"clusterRadius",clusterMaxZoom:"clusterMaxZoom",clusterMinPoints:"clusterMinPoints",clusterProperties:"clusterProperties",lineMetrics:"lineMetrics",generateId:"generateId",promoteId:"promoteId",filter:"filter"},features:[D.TTD],decls:0,vars:0,template:function(o,h){},encapsulation:2,changeDetection:0}),i})(),Ym=(()=>{class i{constructor(o){this.GeoJSONSourceComponent=o,this.type="Feature"}ngOnInit(){this.id||(this.id=this.GeoJSONSourceComponent._getNewFeatureId()),this.feature={type:this.type,geometry:this.geometry,properties:this.properties?this.properties:{}},this.feature.id=this.id,this.GeoJSONSourceComponent._addFeature(this.feature)}ngOnDestroy(){this.GeoJSONSourceComponent._removeFeature(this.feature)}updateCoordinates(o){this.feature.geometry.coordinates=o,this.GeoJSONSourceComponent.updateFeatureData.next()}}return i.\u0275fac=function(o){return new(o||i)(D.Y36((0,D.Gpc)(()=>jg)))},i.\u0275cmp=D.Xpm({type:i,selectors:[["mgl-feature"]],inputs:{id:"id",geometry:"geometry",properties:"properties"},decls:0,vars:0,template:function(o,h){},encapsulation:2,changeDetection:0}),i})(),Wm=(()=>{class i{constructor(o){this.MapService=o,this.layerClick=new D.vpe,this.layerDblClick=new D.vpe,this.layerMouseDown=new D.vpe,this.layerMouseUp=new D.vpe,this.layerMouseEnter=new D.vpe,this.layerMouseLeave=new D.vpe,this.layerMouseMove=new D.vpe,this.layerMouseOver=new D.vpe,this.layerMouseOut=new D.vpe,this.layerContextMenu=new D.vpe,this.layerTouchStart=new D.vpe,this.layerTouchEnd=new D.vpe,this.layerTouchCancel=new D.vpe,this.click=new D.vpe,this.dblClick=new D.vpe,this.mouseDown=new D.vpe,this.mouseUp=new D.vpe,this.mouseEnter=new D.vpe,this.mouseLeave=new D.vpe,this.mouseMove=new D.vpe,this.mouseOver=new D.vpe,this.mouseOut=new D.vpe,this.contextMenu=new D.vpe,this.touchStart=new D.vpe,this.touchEnd=new D.vpe,this.touchCancel=new D.vpe,this.layerAdded=!1}ngOnInit(){this.warnDeprecatedOutputs(),this.sub=this.MapService.mapLoaded$.pipe((0,Rm.w)(()=>(0,Bg.R)(this.MapService.mapInstance,"styledata").pipe((0,Nm.h)(!1),(0,qg.h)(()=>!this.MapService.mapInstance.getLayer(this.id)),(0,km.O)(!0)))).subscribe(o=>this.init(o))}ngOnChanges(o){!this.layerAdded||(o.paint&&!o.paint.isFirstChange()&&this.MapService.setAllLayerPaintProperty(this.id,o.paint.currentValue),o.layout&&!o.layout.isFirstChange()&&this.MapService.setAllLayerLayoutProperty(this.id,o.layout.currentValue),o.filter&&!o.filter.isFirstChange()&&this.MapService.setLayerFilter(this.id,o.filter.currentValue),o.before&&!o.before.isFirstChange()&&this.MapService.setLayerBefore(this.id,o.before.currentValue),(o.minzoom&&!o.minzoom.isFirstChange()||o.maxzoom&&!o.maxzoom.isFirstChange())&&this.MapService.setLayerZoomRange(this.id,this.minzoom,this.maxzoom))}ngOnDestroy(){this.layerAdded&&this.MapService.removeLayer(this.id),this.sub&&this.sub.unsubscribe()}init(o){this.MapService.addLayer({layerOptions:{id:this.id,type:this.type,source:this.source,metadata:this.metadata,"source-layer":this.sourceLayer,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this.layout,paint:this.paint},layerEvents:{layerClick:this.layerClick,layerDblClick:this.layerDblClick,layerMouseDown:this.layerMouseDown,layerMouseUp:this.layerMouseUp,layerMouseEnter:this.layerMouseEnter,layerMouseLeave:this.layerMouseLeave,layerMouseMove:this.layerMouseMove,layerMouseOver:this.layerMouseOver,layerMouseOut:this.layerMouseOut,layerContextMenu:this.layerContextMenu,layerTouchStart:this.layerTouchStart,layerTouchEnd:this.layerTouchEnd,layerTouchCancel:this.layerTouchCancel,click:this.click,dblClick:this.dblClick,mouseDown:this.mouseDown,mouseUp:this.mouseUp,mouseEnter:this.mouseEnter,mouseLeave:this.mouseLeave,mouseMove:this.mouseMove,mouseOver:this.mouseOver,mouseOut:this.mouseOut,contextMenu:this.contextMenu,touchStart:this.touchStart,touchEnd:this.touchEnd,touchCancel:this.touchCancel}},o,this.before),this.layerAdded=!0}warnDeprecatedOutputs(){const o=Zg.bind(void 0,i.name);this.click.observers.length&&o("click","layerClick"),this.dblClick.observers.length&&o("dblClick","layerDblClick"),this.mouseDown.observers.length&&o("mouseDown","layerMouseDown"),this.mouseUp.observers.length&&o("mouseUp","layerMouseUp"),this.mouseEnter.observers.length&&o("mouseEnter","layerMouseEnter"),this.mouseLeave.observers.length&&o("mouseLeave","layerMouseLeave"),this.mouseMove.observers.length&&o("mouseMove","layerMouseMove"),this.mouseOver.observers.length&&o("mouseOver","layerMouseOver"),this.mouseOut.observers.length&&o("mouseOut","layerMouseOut"),this.contextMenu.observers.length&&o("contextMenu","layerContextMenu"),this.touchStart.observers.length&&o("touchStart","layerTouchStart"),this.touchEnd.observers.length&&o("touchEnd","layerTouchEnd"),this.touchCancel.observers.length&&o("touchCancel","layerTouchCancel")}}return i.\u0275fac=function(o){return new(o||i)(D.Y36(Jc))},i.\u0275cmp=D.Xpm({type:i,selectors:[["mgl-layer"]],inputs:{id:"id",source:"source",type:"type",metadata:"metadata",sourceLayer:"sourceLayer",filter:"filter",layout:"layout",paint:"paint",before:"before",minzoom:"minzoom",maxzoom:"maxzoom"},outputs:{layerClick:"layerClick",layerDblClick:"layerDblClick",layerMouseDown:"layerMouseDown",layerMouseUp:"layerMouseUp",layerMouseEnter:"layerMouseEnter",layerMouseLeave:"layerMouseLeave",layerMouseMove:"layerMouseMove",layerMouseOver:"layerMouseOver",layerMouseOut:"layerMouseOut",layerContextMenu:"layerContextMenu",layerTouchStart:"layerTouchStart",layerTouchEnd:"layerTouchEnd",layerTouchCancel:"layerTouchCancel",click:"click",dblClick:"dblClick",mouseDown:"mouseDown",mouseUp:"mouseUp",mouseEnter:"mouseEnter",mouseLeave:"mouseLeave",mouseMove:"mouseMove",mouseOver:"mouseOver",mouseOut:"mouseOut",contextMenu:"contextMenu",touchStart:"touchStart",touchEnd:"touchEnd",touchCancel:"touchCancel"},features:[D.TTD],decls:0,vars:0,template:function(o,h){},encapsulation:2}),i})(),Hm=(()=>{class i{constructor(o){this.MapService=o,this.movingMethod="flyTo",this.mapResize=new D.vpe,this.mapRemove=new D.vpe,this.mapMouseDown=new D.vpe,this.mapMouseUp=new D.vpe,this.mapMouseMove=new D.vpe,this.mapClick=new D.vpe,this.mapDblClick=new D.vpe,this.mapMouseOver=new D.vpe,this.mapMouseOut=new D.vpe,this.mapContextMenu=new D.vpe,this.mapTouchStart=new D.vpe,this.mapTouchEnd=new D.vpe,this.mapTouchMove=new D.vpe,this.mapTouchCancel=new D.vpe,this.mapWheel=new D.vpe,this.moveStart=new D.vpe,this.move=new D.vpe,this.moveEnd=new D.vpe,this.mapDragStart=new D.vpe,this.mapDrag=new D.vpe,this.mapDragEnd=new D.vpe,this.zoomStart=new D.vpe,this.zoomEvt=new D.vpe,this.zoomEnd=new D.vpe,this.rotateStart=new D.vpe,this.rotate=new D.vpe,this.rotateEnd=new D.vpe,this.pitchStart=new D.vpe,this.pitchEvt=new D.vpe,this.pitchEnd=new D.vpe,this.boxZoomStart=new D.vpe,this.boxZoomEnd=new D.vpe,this.boxZoomCancel=new D.vpe,this.webGlContextLost=new D.vpe,this.webGlContextRestored=new D.vpe,this.mapLoad=new D.vpe,this.idle=new D.vpe,this.render=new D.vpe,this.mapError=new D.vpe,this.data=new D.vpe,this.styleData=new D.vpe,this.sourceData=new D.vpe,this.dataLoading=new D.vpe,this.styleDataLoading=new D.vpe,this.sourceDataLoading=new D.vpe,this.styleImageMissing=new D.vpe,this.resize=new D.vpe,this.remove=new D.vpe,this.mouseDown=new D.vpe,this.mouseUp=new D.vpe,this.mouseMove=new D.vpe,this.click=new D.vpe,this.dblClick=new D.vpe,this.mouseOver=new D.vpe,this.mouseOut=new D.vpe,this.contextMenu=new D.vpe,this.touchStart=new D.vpe,this.touchEnd=new D.vpe,this.touchMove=new D.vpe,this.touchCancel=new D.vpe,this.wheel=new D.vpe,this.dragStart=new D.vpe,this.drag=new D.vpe,this.dragEnd=new D.vpe,this.load=new D.vpe,this.error=new D.vpe}get mapInstance(){return this.MapService.mapInstance}ngAfterViewInit(){this.warnDeprecatedOutputs(),this.MapService.setup({customMapboxApiUrl:this.customMapboxApiUrl,mapOptions:{collectResourceTiming:this.collectResourceTiming,container:this.mapContainer.nativeElement,crossSourceCollisions:this.crossSourceCollisions,fadeDuration:this.fadeDuration,minZoom:this.minZoom,maxZoom:this.maxZoom,minPitch:this.minPitch,maxPitch:this.maxPitch,style:this.style,hash:this.hash,interactive:this.interactive,bearingSnap:this.bearingSnap,pitchWithRotate:this.pitchWithRotate,clickTolerance:this.clickTolerance,attributionControl:this.attributionControl,logoPosition:this.logoPosition,failIfMajorPerformanceCaveat:this.failIfMajorPerformanceCaveat,preserveDrawingBuffer:this.preserveDrawingBuffer,refreshExpiredTiles:this.refreshExpiredTiles,maxBounds:this.maxBounds,scrollZoom:this.scrollZoom,boxZoom:this.boxZoom,dragRotate:this.dragRotate,dragPan:this.dragPan,keyboard:this.keyboard,doubleClickZoom:this.doubleClickZoom,touchPitch:this.touchPitch,touchZoomRotate:this.touchZoomRotate,trackResize:this.trackResize,center:this.center,zoom:this.zoom,bearing:this.bearing,pitch:this.pitch,renderWorldCopies:this.renderWorldCopies,maxTileCacheSize:this.maxTileCacheSize,localIdeographFontFamily:this.localIdeographFontFamily,transformRequest:this.transformRequest,bounds:this.bounds?this.bounds:this.fitBounds,fitBoundsOptions:this.fitBoundsOptions,antialias:this.antialias,locale:this.locale},mapEvents:this}),this.cursorStyle&&this.MapService.changeCanvasCursor(this.cursorStyle)}ngOnDestroy(){this.MapService.destroyMap()}ngOnChanges(o){return hc(this,void 0,void 0,function*(){yield this.MapService.mapCreated$.toPromise(),o.cursorStyle&&!o.cursorStyle.isFirstChange()&&this.MapService.changeCanvasCursor(o.cursorStyle.currentValue),o.minZoom&&!o.minZoom.isFirstChange()&&this.MapService.updateMinZoom(o.minZoom.currentValue),o.maxZoom&&!o.maxZoom.isFirstChange()&&this.MapService.updateMaxZoom(o.maxZoom.currentValue),o.minPitch&&!o.minPitch.isFirstChange()&&this.MapService.updateMinPitch(o.minPitch.currentValue),o.maxPitch&&!o.maxPitch.isFirstChange()&&this.MapService.updateMaxPitch(o.maxPitch.currentValue),o.renderWorldCopies&&!o.renderWorldCopies.isFirstChange()&&this.MapService.updateRenderWorldCopies(o.renderWorldCopies.currentValue),o.scrollZoom&&!o.scrollZoom.isFirstChange()&&this.MapService.updateScrollZoom(o.scrollZoom.currentValue),o.dragRotate&&!o.dragRotate.isFirstChange()&&this.MapService.updateDragRotate(o.dragRotate.currentValue),o.touchPitch&&!o.touchPitch.isFirstChange()&&this.MapService.updateTouchPitch(o.touchPitch.currentValue),o.touchZoomRotate&&!o.touchZoomRotate.isFirstChange()&&this.MapService.updateTouchZoomRotate(o.touchZoomRotate.currentValue),o.doubleClickZoom&&!o.doubleClickZoom.isFirstChange()&&this.MapService.updateDoubleClickZoom(o.doubleClickZoom.currentValue),o.keyboard&&!o.keyboard.isFirstChange()&&this.MapService.updateKeyboard(o.keyboard.currentValue),o.dragPan&&!o.dragPan.isFirstChange()&&this.MapService.updateDragPan(o.dragPan.currentValue),o.boxZoom&&!o.boxZoom.isFirstChange()&&this.MapService.updateBoxZoom(o.boxZoom.currentValue),o.style&&!o.style.isFirstChange()&&this.MapService.updateStyle(o.style.currentValue),o.maxBounds&&!o.maxBounds.isFirstChange()&&this.MapService.updateMaxBounds(o.maxBounds.currentValue),o.fitBounds&&o.fitBounds.currentValue&&!o.fitBounds.isFirstChange()&&this.MapService.fitBounds(o.fitBounds.currentValue,this.fitBoundsOptions),o.fitScreenCoordinates&&o.fitScreenCoordinates.currentValue&&((this.center||this.zoom||this.pitch||this.fitBounds)&&o.fitScreenCoordinates.isFirstChange()&&console.warn("[ngx-mapbox-gl] center / zoom / pitch / fitBounds inputs are being overridden by fitScreenCoordinates input"),this.MapService.fitScreenCoordinates(o.fitScreenCoordinates.currentValue,this.bearing?this.bearing[0]:0,this.movingOptions)),!this.centerWithPanTo||!o.center||o.center.isFirstChange()||o.zoom||o.bearing||o.pitch?(o.center&&!o.center.isFirstChange()||o.zoom&&!o.zoom.isFirstChange()||o.bearing&&!o.bearing.isFirstChange()&&!o.fitScreenCoordinates||o.pitch&&!o.pitch.isFirstChange())&&this.MapService.move(this.movingMethod,this.movingOptions,o.zoom&&this.zoom?this.zoom[0]:void 0,o.center?this.center:void 0,o.bearing&&this.bearing?this.bearing[0]:void 0,o.pitch&&this.pitch?this.pitch[0]:void 0):this.MapService.panTo(this.center,this.panToOptions)})}warnDeprecatedOutputs(){const o=Zg.bind(void 0,i.name);this.resize.observers.length&&o("resize","mapResize"),this.remove.observers.length&&o("remove","mapRemove"),this.mouseDown.observers.length&&o("mouseDown","mapMouseDown"),this.mouseUp.observers.length&&o("mouseUp","mapMouseUp"),this.mouseMove.observers.length&&o("mouseMove","mapMouseMove"),this.click.observers.length&&o("click","mapClick"),this.dblClick.observers.length&&o("dblClick","mapDblClick"),this.mouseOver.observers.length&&o("mouseOver","mapMouseOver"),this.mouseOut.observers.length&&o("mouseOut","mapMouseOut"),this.contextMenu.observers.length&&o("contextMenu","mapContextMenu"),this.touchStart.observers.length&&o("touchStart","mapTouchStart"),this.touchEnd.observers.length&&o("touchEnd","mapTouchEnd"),this.touchMove.observers.length&&o("touchMove","mapTouchMove"),this.touchCancel.observers.length&&o("touchCancel","mapTouchCancel"),this.wheel.observers.length&&o("wheel","mapWheel"),this.dragStart.observers.length&&o("dragStart","mapDragStart"),this.drag.observers.length&&o("drag","mapDrag"),this.dragEnd.observers.length&&o("dragEnd","mapDragEnd"),this.load.observers.length&&o("load","mapLoad"),this.error.observers.length&&o("error","mapError")}}return i.\u0275fac=function(o){return new(o||i)(D.Y36(Jc))},i.\u0275cmp=D.Xpm({type:i,selectors:[["mgl-map"]],viewQuery:function(o,h){if(1&o&&D.Gf(Bm,7),2&o){let m;D.iGM(m=D.CRH())&&(h.mapContainer=m.first)}},inputs:{collectResourceTiming:"collectResourceTiming",crossSourceCollisions:"crossSourceCollisions",customMapboxApiUrl:"customMapboxApiUrl",fadeDuration:"fadeDuration",hash:"hash",refreshExpiredTiles:"refreshExpiredTiles",failIfMajorPerformanceCaveat:"failIfMajorPerformanceCaveat",bearingSnap:"bearingSnap",interactive:"interactive",pitchWithRotate:"pitchWithRotate",clickTolerance:"clickTolerance",attributionControl:"attributionControl",logoPosition:"logoPosition",maxTileCacheSize:"maxTileCacheSize",localIdeographFontFamily:"localIdeographFontFamily",preserveDrawingBuffer:"preserveDrawingBuffer",trackResize:"trackResize",transformRequest:"transformRequest",bounds:"bounds",antialias:"antialias",locale:"locale",minZoom:"minZoom",maxZoom:"maxZoom",minPitch:"minPitch",maxPitch:"maxPitch",scrollZoom:"scrollZoom",dragRotate:"dragRotate",touchPitch:"touchPitch",touchZoomRotate:"touchZoomRotate",doubleClickZoom:"doubleClickZoom",keyboard:"keyboard",dragPan:"dragPan",boxZoom:"boxZoom",style:"style",center:"center",maxBounds:"maxBounds",zoom:"zoom",bearing:"bearing",pitch:"pitch",fitBoundsOptions:"fitBoundsOptions",renderWorldCopies:"renderWorldCopies",movingMethod:"movingMethod",movingOptions:"movingOptions",fitBounds:"fitBounds",fitScreenCoordinates:"fitScreenCoordinates",centerWithPanTo:"centerWithPanTo",panToOptions:"panToOptions",cursorStyle:"cursorStyle"},outputs:{mapResize:"mapResize",mapRemove:"mapRemove",mapMouseDown:"mapMouseDown",mapMouseUp:"mapMouseUp",mapMouseMove:"mapMouseMove",mapClick:"mapClick",mapDblClick:"mapDblClick",mapMouseOver:"mapMouseOver",mapMouseOut:"mapMouseOut",mapContextMenu:"mapContextMenu",mapTouchStart:"mapTouchStart",mapTouchEnd:"mapTouchEnd",mapTouchMove:"mapTouchMove",mapTouchCancel:"mapTouchCancel",mapWheel:"mapWheel",moveStart:"moveStart",move:"move",moveEnd:"moveEnd",mapDragStart:"mapDragStart",mapDrag:"mapDrag",mapDragEnd:"mapDragEnd",zoomStart:"zoomStart",zoomEvt:"zoomEvt",zoomEnd:"zoomEnd",rotateStart:"rotateStart",rotate:"rotate",rotateEnd:"rotateEnd",pitchStart:"pitchStart",pitchEvt:"pitchEvt",pitchEnd:"pitchEnd",boxZoomStart:"boxZoomStart",boxZoomEnd:"boxZoomEnd",boxZoomCancel:"boxZoomCancel",webGlContextLost:"webGlContextLost",webGlContextRestored:"webGlContextRestored",mapLoad:"mapLoad",idle:"idle",render:"render",mapError:"mapError",data:"data",styleData:"styleData",sourceData:"sourceData",dataLoading:"dataLoading",styleDataLoading:"styleDataLoading",sourceDataLoading:"sourceDataLoading",styleImageMissing:"styleImageMissing",resize:"resize",remove:"remove",mouseDown:"mouseDown",mouseUp:"mouseUp",mouseMove:"mouseMove",click:"click",dblClick:"dblClick",mouseOver:"mouseOver",mouseOut:"mouseOut",contextMenu:"contextMenu",touchStart:"touchStart",touchEnd:"touchEnd",touchMove:"touchMove",touchCancel:"touchCancel",wheel:"wheel",dragStart:"dragStart",drag:"drag",dragEnd:"dragEnd",load:"load",error:"error"},features:[D._Bn([Jc]),D.TTD],decls:2,vars:0,consts:[["container",""]],template:function(o,h){1&o&&D._UZ(0,"div",null,0)},styles:["[_nghost-%COMP%] {\n        display: block;\n      }\n      div[_ngcontent-%COMP%] {\n        height: 100%;\n        width: 100%;\n      }"],changeDetection:0}),i})(),Jm=(()=>{class i{}return i.\u0275fac=function(o){return new(o||i)},i.\u0275mod=D.oAB({type:i}),i.\u0275inj=D.cJS({imports:[[fl.ez]]}),i})();var Nd=Et(1095);const Km=function(i){return{type:"Point",coordinates:i}};function $m(i,a){if(1&i&&D._UZ(0,"mgl-feature",11),2&i){const o=D.oxw();D.Q6J("geometry",D.VKq(1,Km,o.coordinates))}}function Qm(i,a){if(1&i){const o=D.EpF();D.TgZ(0,"button",12),D.NdJ("click",function(){return D.CHM(o),D.oxw().startSelect()}),D._uU(1,"Select Location"),D.qZA()}if(2&i){const o=D.oxw();D.Q6J("disabled",o.isActive)}}function ty(i,a){if(1&i){const o=D.EpF();D.TgZ(0,"button",12),D.NdJ("click",function(){return D.CHM(o),D.oxw().saveLocation()}),D._uU(1,"Save Location"),D.qZA()}if(2&i){const o=D.oxw();D.Q6J("disabled",!o.isActive)}}function ey(i,a){if(1&i&&(D.TgZ(0,"div"),D._uU(1),D.ALo(2,"number"),D.ALo(3,"number"),D.qZA()),2&i){const o=D.oxw();D.xp6(1),D.AsE(" ",D.lcZ(2,2,o.coordinates[0]),", ",D.lcZ(3,4,o.coordinates[1]),"\n")}}const ry=function(i){return[i]};let ny=(()=>{class i{constructor(o){this.cd=o,this.zoom=6,this.center=[-77.1945,41.2033],this.styleEnum="ArcGIS:Streets",this.apiKey=_e.N.esriApiKey,this.basemapStyle=`https://basemaps-api.arcgis.com/arcgis/rest/services/styles/${this.styleEnum}?type=style&token=${this.apiKey}`,this.isActive=!1,this.showPoint=!0,this.coordinates=[],this.layerPaint=We.PointPaintStyle,this.inState=!0,this.newLocation=new D.vpe,this.newIntersectStatus=new D.vpe}ngOnInit(){}startSelect(){const o=this.map.getCenter();this.setCoordinates([o.lng,o.lat]),this.isActive=!0}endSelect(){this.isActive=!1}setCoordinates(o){this.coordinates=o,this.refreshPoint(),this.inState=this.checkIntersection(this.coordinates)}clearCoordinates(){this.coordinates=[]}mapClicked(o){!(null==o?void 0:o.lngLat)||!this.isActive||(console.log("Map Clicked",o),this.setCoordinates([o.lngLat.lng,o.lngLat.lat]),this.endSelect())}saveLocation(){this.endSelect(),this.newLocation.emit({lat:this.coordinates[0]||0,long:this.coordinates[1]||0}),this.newIntersectStatus.emit(this.inState)}mapMoved(o){if(!this.isActive)return;const h=this.map.getCenter();console.log("Map Moved",o,h),this.setCoordinates([h.lng,h.lat])}refreshPoint(){this.showPoint=!1,this.cd.detectChanges(),this.showPoint=!0}checkIntersection(o){return function(i,a){var o=!1;return Jr(i,function(h){Jr(a,function(m){if(!0===o)return!0;o=!function(i,a){var o=!0;return Jr(i,function(h){Jr(a,function(m){if(!1===o)return!1;o=function(i,a){switch(i.type){case"Point":switch(a.type){case"Point":return!function(i,a){return i[0]===a[0]&&i[1]===a[1]}(i.coordinates,a.coordinates);case"LineString":return!Ut(a,i);case"Polygon":return!ot(i,a)}break;case"LineString":switch(a.type){case"Point":return!Ut(i,a);case"LineString":return!function(i,a){return it(i,a).features.length>0}(i,a);case"Polygon":return!or(a,i)}break;case"Polygon":switch(a.type){case"Point":return!ot(a,i);case"LineString":return!or(i,a);case"Polygon":return!function(i,a){for(var o=0,h=i.coordinates[0];o<h.length;o++)if(ot(h[o],a))return!0;for(var v=0,b=a.coordinates[0];v<b.length;v++)if(ot(b[v],i))return!0;return it(ht(i),ht(a)).features.length>0}(a,i)}}return!1}(h.geometry,m.geometry)})}),o}(h.geometry,m.geometry)})}),o}(st(Lm.coordinates),Q(o))}}return i.\u0275fac=function(o){return new(o||i)(D.Y36(D.sBO))},i.\u0275cmp=D.Xpm({type:i,selectors:[["app-map"]],inputs:{zoom:"zoom",center:"center",styleEnum:"styleEnum"},outputs:{newLocation:"newLocation",newIntersectStatus:"newIntersectStatus"},decls:12,vars:12,consts:[["id","appMapContainer"],[3,"zoom","center","cursorStyle","mapLoad","moveEnd"],["mglNavigation","","position","top-right"],["mglScale","","position","bottom-left"],["id","point"],[3,"properties","geometry",4,"ngIf"],["id","point","type","circle","source","point",3,"paint"],["targetLayer",""],[1,"appSelectLocationContainer"],["mat-flat-button","","color","basic",3,"disabled","click",4,"ngIf"],[4,"ngIf"],[3,"properties","geometry"],["mat-flat-button","","color","basic",3,"disabled","click"]],template:function(o,h){1&o&&(D.TgZ(0,"div",0),D.TgZ(1,"mgl-map",1),D.NdJ("mapLoad",function(v){return h.map=v})("moveEnd",function(v){return h.mapMoved(v)}),D._UZ(2,"mgl-control",2),D._UZ(3,"mgl-control",3),D.TgZ(4,"mgl-geojson-source",4),D.YNc(5,$m,1,3,"mgl-feature",5),D.qZA(),D._UZ(6,"mgl-layer",6,7),D.qZA(),D.TgZ(8,"div",8),D.YNc(9,Qm,2,1,"button",9),D.YNc(10,ty,2,1,"button",9),D.qZA(),D.qZA(),D.YNc(11,ey,4,6,"div",10)),2&o&&(D.xp6(1),D.Akn(h.basemapStyle),D.Q6J("zoom",D.VKq(10,ry,h.zoom))("center",h.center)("cursorStyle",h.cursorStyle),D.xp6(4),D.Q6J("ngIf",h.showPoint),D.xp6(1),D.Q6J("paint",h.layerPaint),D.xp6(3),D.Q6J("ngIf",!h.isActive),D.xp6(1),D.Q6J("ngIf",h.isActive),D.xp6(1),D.Q6J("ngIf",(null==h.coordinates?null:h.coordinates.length)&&h.coordinates.length>0))},directives:[Hm,Rd,jm,Xm,jg,fl.O5,Wm,Ym,Nd.lW],pipes:[fl.JJ],styles:["mgl-map[_ngcontent-%COMP%]{height:100%;width:100%}#appMapContainer[_ngcontent-%COMP%]{width:100%;height:65vh;position:relative}.appSelectLocationContainer[_ngcontent-%COMP%]{position:absolute;top:.5rem;left:.5rem}@media only screen and (min-width: 1224px){#appMapContainer[_ngcontent-%COMP%]{height:50vh}}@media only screen and (min-width: 1824px){#appMapContainer[_ngcontent-%COMP%]{height:65vh}}"]}),i})(),iy=(()=>{class i{constructor(o){this.obsStore=o,this.header=Jt.y.LocationHeader,this.content=Ze.LocationHelperText,this.isValid=new D.vpe(!1)}updateLocation(o){this.obsStore.getObservation().pipe((0,he.q)(1)).subscribe(h=>{const m=Object.assign({},h);m.geometry=o,this.obsStore.updateObservation(m),this.checkValid(m)})}updateIntersectStatus(o){this.obsStore.getObservation().pipe((0,he.q)(1)).subscribe(h=>{const m=Object.assign({},h);m.inState=o,this.obsStore.updateObservation(m),this.checkValid(m)})}checkValid(o){var h,m;o&&(null==o?void 0:o.geometry)&&(null===(h=null==o?void 0:o.geometry)||void 0===h?void 0:h.lat)&&(null===(m=null==o?void 0:o.geometry)||void 0===m?void 0:m.long)?this.isValid.emit(!0):this.isValid.emit(!1)}}return i.\u0275fac=function(o){return new(o||i)(D.Y36(It))},i.\u0275cmp=D.Xpm({type:i,selectors:[["app-location"]],outputs:{isValid:"isValid"},decls:2,vars:2,consts:[[3,"header","content"],[3,"newLocation","newIntersectStatus"]],template:function(o,h){1&o&&(D._UZ(0,"app-intro-helper-text",0),D.TgZ(1,"app-map",1),D.NdJ("newLocation",function(v){return h.updateLocation(v)})("newIntersectStatus",function(v){return h.updateIntersectStatus(v)}),D.qZA()),2&o&&D.Q6J("header",h.header)("content",h.content)},directives:[ce,ny],styles:[""]}),i})();var fs=Et(3679),oy=Et(205),ay=Et(7393);function Xg(i=-1){return a=>a.lift(new sy(i,a))}class sy{constructor(a,o){this.count=a,this.source=o}call(a,o){return o.subscribe(new uy(a,this.count,this.source))}}class uy extends ay.L{constructor(a,o,h){super(a),this.count=o,this.source=h}error(a){if(!this.isStopped){const{source:o,count:h}=this;if(0===h)return super.error(a);h>-1&&(this.count=h-1),o.subscribe(this._unsubscribeAndRecycle())}}}var Yg=Et(5304),ly=Et(1841);let cy=(()=>{class i{constructor(o){this.http=o,this.apiEndpoint=_e.N.apiEndpoint}getAnimalCount(){return this.http.get(`${this.apiEndpoint}/${Jt.y.AnimalCount}`).pipe(Xg(1),(0,Yg.K)(this.handleError))}getAffiliation(){return this.http.get(`${this.apiEndpoint}/${Jt.y.Affiliation}`).pipe(Xg(1),(0,Yg.K)(this.handleError))}handleError(o){let h="";return h=o.error instanceof ErrorEvent?o.error.message:`Error Code: ${o.status}\nMessage: ${o.message}`,(0,oy._)(h)}}return i.\u0275fac=function(o){return new(o||i)(D.LFG(ly.eN))},i.\u0275prov=D.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();var vp=Et(5618),bf=Et(8295),hy=Et(9983),py=Et(7441),fy=Et(2458);function dy(i,a){1&i&&(D.TgZ(0,"mat-error"),D._uU(1,"This field is required."),D.qZA())}function gy(i,a){1&i&&(D.TgZ(0,"mat-error"),D._uU(1,"Please enter no more than 50 characters."),D.qZA())}function my(i,a){if(1&i&&(D.TgZ(0,"mat-option",16),D._uU(1),D.qZA()),2&i){const o=a.$implicit;D.Q6J("value",null==o?null:o.AffiliationId),D.xp6(1),D.hij(" ",null==o?null:o.Name," ")}}function yy(i,a){1&i&&(D.TgZ(0,"mat-error"),D._uU(1,"This field is required."),D.qZA())}function vy(i,a){1&i&&(D.TgZ(0,"mat-error"),D._uU(1,"Email must be in the following format: example@gmail.com"),D.qZA())}function _y(i,a){1&i&&(D.TgZ(0,"mat-error"),D._uU(1,"This field is required."),D.qZA())}function xy(i,a){1&i&&(D.TgZ(0,"mat-error"),D._uU(1,"Please enter no more than 50 characters."),D.qZA())}function by(i,a){1&i&&(D.TgZ(0,"mat-error"),D._uU(1,"This field is required."),D.qZA())}function wy(i,a){1&i&&(D.TgZ(0,"mat-error"),D._uU(1,"Please enter 10 digits, numbers only."),D.qZA())}function Ey(i,a){1&i&&(D.TgZ(0,"mat-error"),D._uU(1,"Please only enter 10 digits."),D.qZA())}let Sy=(()=>{class i{constructor(o,h){this.obsStore=o,this.api=h,this.header=Jt.y.ContactHeader,this.content=Ze.ContactHelperText,this.contactForm=new fs.cw({name:new fs.NI("",[fs.kI.maxLength(50)]),affiliation:new fs.NI("",[]),email:new fs.NI("",[fs.kI.maxLength(50),fs.kI.pattern("^[a-z0-9._%+-]+@[a-z0-9.-]+\\.[a-z]{2,4}$")]),phone:new fs.NI("",[fs.kI.maxLength(10),fs.kI.minLength(10),fs.kI.pattern("^((\\+91-?)|0)?[0-9]{10}$")])}),this.affiliations=[],this.isValid=new D.vpe(!1)}ngOnInit(){this.formChangeSub=this.contactForm.valueChanges.pipe((0,Gg.b)(200)).subscribe({next:o=>{this.obsStore.getObservation().pipe((0,Ug.P)()).subscribe(h=>{if(this.contactForm.valid){const m=Object.assign({},h);m.contact=Object.assign({},o),this.obsStore.updateObservation(m)}this.isValid.emit(this.contactForm.valid)})}}),this.initializeDropdowns()}ngOnDestroy(){this.formChangeSub.unsubscribe()}get name(){return this.contactForm.get("name")}get affiliation(){return this.contactForm.get("affiliation")}get email(){return this.contactForm.get("email")}get phone(){return this.contactForm.get("phone")}initializeDropdowns(){this.api.getAffiliation().subscribe(o=>{this.affiliations=o},o=>{console.error(o)})}}return i.\u0275fac=function(o){return new(o||i)(D.Y36(It),D.Y36(cy))},i.\u0275cmp=D.Xpm({type:i,selectors:[["app-contact"]],outputs:{isValid:"isValid"},decls:44,vars:13,consts:[[3,"header","content"],[1,"appContactContainer"],[3,"formGroup"],["fxLayout","row","fxLayout.xs","column","fxLayout.sm","column","fxLayoutAlign","start center","fxLayoutAlign.xs","start start","fxLayoutAlign.sm","start start","fxFlex",""],["fxFlex","50","fxFlex.xs","100","fxFlex.sm","100",1,"appFormRowContainer"],[1,"appFormContainer"],["for","contact-name"],["matInput","","id","contact-name","type","text","formControlName","name"],[4,"ngIf"],["for","contact-affiliation"],["id","contact-affiliation","formControlName","affiliation"],[3,"value",4,"ngFor","ngForOf"],["for","contact-email"],["matInput","","id","contact-email","type","email","formControlName","email"],["for","contact-phone"],["matInput","","id","contact-phone","type","number","formControlName","phone"],[3,"value"]],template:function(o,h){1&o&&(D._UZ(0,"app-intro-helper-text",0),D.TgZ(1,"div",1),D.TgZ(2,"form",2),D.TgZ(3,"div",3),D.TgZ(4,"div",4),D.TgZ(5,"div",5),D.TgZ(6,"mat-form-field"),D.TgZ(7,"mat-label",6),D._uU(8,"Name"),D.qZA(),D._UZ(9,"input",7),D.TgZ(10,"mat-hint"),D._uU(11,"First and last name"),D.qZA(),D.YNc(12,dy,2,0,"mat-error",8),D.YNc(13,gy,2,0,"mat-error",8),D.qZA(),D.qZA(),D.TgZ(14,"div",5),D.TgZ(15,"mat-form-field"),D.TgZ(16,"mat-label",9),D._uU(17,"Affiliation"),D.qZA(),D.TgZ(18,"mat-select",10),D.YNc(19,my,2,2,"mat-option",11),D.qZA(),D.TgZ(20,"mat-hint"),D._uU(21,"Affiliation"),D.qZA(),D.YNc(22,yy,2,0,"mat-error",8),D.qZA(),D.qZA(),D.qZA(),D.TgZ(23,"div",4),D.TgZ(24,"div",5),D.TgZ(25,"mat-form-field"),D.TgZ(26,"mat-label",12),D._uU(27,"Email"),D.qZA(),D._UZ(28,"input",13),D.TgZ(29,"mat-hint"),D._uU(30,"example@gmail.com"),D.qZA(),D.YNc(31,vy,2,0,"mat-error",8),D.YNc(32,_y,2,0,"mat-error",8),D.YNc(33,xy,2,0,"mat-error",8),D.qZA(),D.qZA(),D.TgZ(34,"div",5),D.TgZ(35,"mat-form-field"),D.TgZ(36,"mat-label",14),D._uU(37,"Phone"),D.qZA(),D._UZ(38,"input",15),D.TgZ(39,"mat-hint"),D._uU(40,"10 digit phone number, numbers only"),D.qZA(),D.YNc(41,by,2,0,"mat-error",8),D.YNc(42,wy,2,0,"mat-error",8),D.YNc(43,Ey,2,0,"mat-error",8),D.qZA(),D.qZA(),D.qZA(),D.qZA(),D.qZA(),D.qZA()),2&o&&(D.Q6J("header",h.header)("content",h.content),D.xp6(2),D.Q6J("formGroup",h.contactForm),D.xp6(10),D.Q6J("ngIf",(null==h.name?null:h.name.invalid)&&(null==h.name||null==h.name.errors?null:h.name.errors.required)),D.xp6(1),D.Q6J("ngIf",(null==h.name?null:h.name.invalid)&&(null==h.name||null==h.name.errors?null:h.name.errors.maxLength)),D.xp6(6),D.Q6J("ngForOf",h.affiliations),D.xp6(3),D.Q6J("ngIf",(null==h.affiliation?null:h.affiliation.invalid)&&(null==h.affiliation||null==h.affiliation.errors?null:h.affiliation.errors.required)),D.xp6(9),D.Q6J("ngIf",(null==h.email?null:h.email.invalid)&&(null==h.email||null==h.email.errors?null:h.email.errors.pattern)),D.xp6(1),D.Q6J("ngIf",(null==h.email?null:h.email.invalid)&&(null==h.email||null==h.email.errors?null:h.email.errors.required)),D.xp6(1),D.Q6J("ngIf",(null==h.name?null:h.name.invalid)&&(null==h.name||null==h.name.errors?null:h.name.errors.maxLength)),D.xp6(8),D.Q6J("ngIf",(null==h.phone?null:h.phone.invalid)&&(null==h.phone||null==h.phone.errors?null:h.phone.errors.required)),D.xp6(1),D.Q6J("ngIf",(null==h.phone?null:h.phone.invalid)&&(null==h.phone||null==h.phone.errors?null:h.phone.errors.pattern)),D.xp6(1),D.Q6J("ngIf",(null==h.phone?null:h.phone.invalid)&&(null==h.phone||null==h.phone.errors?null:h.phone.errors.maxLength)))},directives:[ce,fs._Y,fs.JL,fs.sg,vp.xw,vp.Wh,vp.yH,bf.KE,bf.hX,hy.Nt,fs.Fj,fs.JJ,fs.u,bf.bx,fl.O5,py.gD,fl.sg,fs.wV,bf.TO,fy.ey],styles:[".appContactContainer[_ngcontent-%COMP%]{min-height:20vh;margin-top:1rem;margin-left:5rem;margin-right:5rem}.mat-form-field[_ngcontent-%COMP%]{min-width:60%;font-size:1rem}.appFormContainer[_ngcontent-%COMP%]{margin-bottom:1.5rem}input[_ngcontent-%COMP%]::-webkit-outer-spin-button, input[_ngcontent-%COMP%]::-webkit-inner-spin-button{-webkit-appearance:none;margin:0}input[type=number][_ngcontent-%COMP%]{-moz-appearance:textfield}@media only screen and (max-width: 480px){.appContactContainer[_ngcontent-%COMP%]{margin-left:0;margin-right:0}.appFormRowContainer[_ngcontent-%COMP%]{width:100%}.mat-form-field[_ngcontent-%COMP%]{min-width:100%}}@media only screen and (min-width: 321px){.appContactContainer[_ngcontent-%COMP%]{margin-left:0;margin-right:0}.appFormRowContainer[_ngcontent-%COMP%]{width:100%}.mat-form-field[_ngcontent-%COMP%]{min-width:100%}}@media only screen and (min-width: 1224px){.appContactContainer[_ngcontent-%COMP%]{margin-left:5rem;margin-right:5rem}.mat-form-field[_ngcontent-%COMP%]{min-width:60%}}@media only screen and (min-width: 1824px){.appContactContainer[_ngcontent-%COMP%]{margin-left:5rem;margin-right:5rem}.mat-form-field[_ngcontent-%COMP%]{min-width:60%}}"]}),i})();const Cy=["stepper"],Iy=["location"],Py=["contact"];function My(i,a){1&i&&D._uU(0,"Location")}function Ty(i,a){1&i&&D._uU(0,"Contact")}function Ay(i,a){1&i&&D._uU(0,"Observation")}function Ly(i,a){if(1&i){const o=D.EpF();D.TgZ(0,"button",14),D.NdJ("click",function(){return D.CHM(o),D.oxw(3),D.MAs(2).previous()}),D._uU(1," Back "),D.qZA()}}function Oy(i,a){if(1&i){const o=D.EpF();D.TgZ(0,"button",15),D.NdJ("click",function(){return D.CHM(o),D.oxw(3),D.MAs(2).next()}),D._uU(1," Next "),D.qZA()}if(2&i){const o=D.oxw(3);D.Q6J("disabled",!o.isValid)}}function Dy(i,a){if(1&i&&(D.ynx(0),D.YNc(1,Ly,2,0,"button",12),D.YNc(2,Oy,2,1,"button",13),D.BQk()),2&i){const o=D.oxw(2),h=D.MAs(2);D.xp6(1),D.Q6J("ngIf",h.selectedIndex>0),D.xp6(1),D.Q6J("ngIf",h.selectedIndex<o.totalSteps-1)}}function Ry(i,a){if(1&i){const o=D.EpF();D.ynx(0),D.TgZ(1,"button",14),D.NdJ("click",function(){return D.CHM(o),D.oxw(2).routeOutOfState()}),D._uU(2," Next "),D.qZA(),D.BQk()}}function Ny(i,a){if(1&i&&(D.ynx(0),D.YNc(1,Dy,3,2,"ng-container",11),D.YNc(2,Ry,3,0,"ng-container",11),D.BQk()),2&i){const o=a.ngIf;D.xp6(1),D.Q6J("ngIf",o.inState),D.xp6(1),D.Q6J("ngIf",!o.inState)}}function zy(i,a){if(1&i){const o=D.EpF();D.TgZ(0,"div"),D.TgZ(1,"p"),D._uU(2,"Observations occurring outside of Pennsylvania should be directed to the appropriate state agency."),D.qZA(),D.TgZ(3,"p"),D._uU(4,"A list of agencies can be found on the Association of Fish & Wildlife Agencies website "),D.TgZ(5,"a",6),D._uU(6,"here"),D.qZA(),D._uU(7,"."),D.qZA(),D.TgZ(8,"button",7),D.NdJ("click",function(){return D.CHM(o),D.oxw(2).home()}),D._uU(9," Return Home "),D.qZA(),D.qZA()}}function Fy(i,a){if(1&i&&(D.TgZ(0,"div",4),D.YNc(1,zy,10,0,"div",5),D.qZA()),2&i){const o=a.ngIf;D.xp6(1),D.Q6J("ngIf",!o.inState)}}function By(i,a){if(1&i){const o=D.EpF();D.TgZ(0,"div"),D.TgZ(1,"p"),D._uU(2,"You may have arrived on this page in error. Please return home and start over."),D.qZA(),D.TgZ(3,"button",7),D.NdJ("click",function(){return D.CHM(o),D.oxw(2).homeNoReset()}),D._uU(4," Return Home "),D.qZA(),D.qZA()}}function Uy(i,a){if(1&i&&(D.TgZ(0,"div",4),D.YNc(1,By,5,0,"div",5),D.qZA()),2&i){const o=a.ngIf;D.xp6(1),D.Q6J("ngIf",o.inState)}}const qy=[{path:"",component:(()=>{class i{constructor(o,h,m){this.router=h,this.obsStore=m,this.isLinear=!0,this.totalSteps=3,this.locationIsValid=!1,this.contactIsValid=!1,this.observationIsValid=!1,this.isValid=!1,this.stepperOrientation=o.observe("(min-width: 800px)").pipe((0,yt.U)(({matches:v})=>v?"horizontal":"vertical"))}ngAfterViewInit(){this.stepper.selectionChange.subscribe(o=>{this.checkValid(o.selectedIndex)})}goBack(o){o.previous()}goForward(o){o.next()}routeOutOfState(){this.router.navigate(["/app/observation/outofstate"])}checkValid(o){let h;switch(h=void 0===o?this.stepper.selectedIndex:o,h){case 0:this.isValid=!!this.locationIsValid;break;case 1:this.isValid=!!this.contactIsValid}}}return i.\u0275fac=function(o){return new(o||i)(D.Y36(y.Yg),D.Y36(Bt.F0),D.Y36(It))},i.\u0275cmp=D.Xpm({type:i,selectors:[["app-observation"]],viewQuery:function(o,h){if(1&o&&(D.Gf(Cy,5),D.Gf(Iy,5),D.Gf(Py,5)),2&o){let m;D.iGM(m=D.CRH())&&(h.stepper=m.first),D.iGM(m=D.CRH())&&(h.location=m.first),D.iGM(m=D.CRH())&&(h.contact=m.first)}},decls:20,vars:10,consts:[[1,"appStepperContainer"],[3,"linear","orientation"],["stepper",""],[3,"completed"],["matStepLabel",""],[3,"isValid"],["location",""],["contact",""],[1,"appLastStep",3,"completed"],["id","appObservationFooter"],["fxFlex","","fxLayoutAlign","end center"],[4,"ngIf"],["mat-flat-button","","color","primary","class","appStepperButton","type","button",3,"click",4,"ngIf"],["mat-flat-button","","color","primary","class","appStepperButton","type","button",3,"disabled","click",4,"ngIf"],["mat-flat-button","","color","primary","type","button",1,"appStepperButton",3,"click"],["mat-flat-button","","color","primary","type","button",1,"appStepperButton",3,"disabled","click"]],template:function(o,h){1&o&&(D.TgZ(0,"div",0),D.TgZ(1,"mat-stepper",1,2),D.ALo(3,"async"),D.TgZ(4,"mat-step",3),D.YNc(5,My,1,0,"ng-template",4),D.TgZ(6,"app-location",5,6),D.NdJ("isValid",function(v){return h.locationIsValid=v,h.checkValid()}),D.qZA(),D.qZA(),D.TgZ(8,"mat-step",3),D.YNc(9,Ty,1,0,"ng-template",4),D.TgZ(10,"app-contact",5,7),D.NdJ("isValid",function(v){return h.contactIsValid=v,h.checkValid()}),D.qZA(),D.qZA(),D.TgZ(12,"mat-step",8),D.YNc(13,Ay,1,0,"ng-template",4),D.TgZ(14,"p"),D._uU(15,"WIP"),D.qZA(),D.qZA(),D.qZA(),D.qZA(),D.TgZ(16,"footer",9),D.TgZ(17,"div",10),D.YNc(18,Ny,3,2,"ng-container",11),D.ALo(19,"async"),D.qZA(),D.qZA()),2&o&&(D.xp6(1),D.Q6J("linear",h.isLinear)("orientation",D.lcZ(3,6,h.stepperOrientation)),D.xp6(3),D.Q6J("completed",h.locationIsValid),D.xp6(4),D.Q6J("completed",h.contactIsValid),D.xp6(4),D.Q6J("completed",h.observationIsValid),D.xp6(6),D.Q6J("ngIf",D.lcZ(19,8,h.obsStore.getObservation())))},directives:[Ft.Vq,Ft.C0,Ft.VY,iy,Sy,vp.yH,vp.Wh,fl.O5,Nd.lW],pipes:[fl.Ov],styles:[".appStepperContainer .mat-stepper-horizontal .mat-horizontal-stepper-header-container{background-color:#f2f2f2;padding-left:5rem;padding-right:5rem}.appStepperButton[_ngcontent-%COMP%]{min-width:9rem}.appStepperButton[_ngcontent-%COMP%]:first-of-type{margin-right:2rem}  .mat-horizontal-content-container{margin-left:5rem;margin-right:5rem}@media only screen and (max-width: 480px){  .mat-horizontal-content-container{margin-left:.5rem;margin-right:.5rem}  .mat-vertical-content-container{margin-left:0!important}}"]}),i})()},{path:"outofstate",component:(()=>{class i{constructor(o,h){this.router=o,this.obsStore=h,this.header=Jt.y.OutOfStateHeader}home(){this.obsStore.resetObservation(),this.router.navigate(["/"])}homeNoReset(){this.router.navigate(["/"])}}return i.\u0275fac=function(o){return new(o||i)(D.Y36(Bt.F0),D.Y36(It))},i.\u0275cmp=D.Xpm({type:i,selectors:[["app-out-of-state"]],decls:7,vars:7,consts:[[1,"appOutOfStateContainer"],[3,"header"],["class","appOutOfStateContent",4,"ngIf"],["id","appObservationFooter"],[1,"appOutOfStateContent"],[4,"ngIf"],["target","_blank","href","https://www.fishwildlife.org/landing/membership/member-list"],["mat-flat-button","","color","accent","type","button",1,"appBackToHomeButton",3,"click"]],template:function(o,h){1&o&&(D.TgZ(0,"div",0),D._UZ(1,"app-intro-helper-text",1),D.YNc(2,Fy,2,1,"div",2),D.ALo(3,"async"),D.YNc(4,Uy,2,1,"div",2),D.ALo(5,"async"),D.qZA(),D._UZ(6,"footer",3)),2&o&&(D.xp6(1),D.Q6J("header",h.header),D.xp6(1),D.Q6J("ngIf",D.lcZ(3,3,h.obsStore.getObservation())),D.xp6(2),D.Q6J("ngIf",D.lcZ(5,5,h.obsStore.getObservation())))},directives:[ce,fl.O5,Nd.lW],pipes:[fl.Ov],styles:[".appOutOfStateContainer[_ngcontent-%COMP%]{margin:5rem}.appOutOfStateContent[_ngcontent-%COMP%]{margin:10rem;text-align:center;font-weight:500;color:#434343;line-height:2.625rem;font-size:1.125rem}.appOutOfStateContent[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#434343}.appBackToHomeButton[_ngcontent-%COMP%]{font-size:1.125rem}@media only screen and (max-width: 480px){.appOutOfStateContent[_ngcontent-%COMP%]{margin:1rem}.appOutOfStateContainer[_ngcontent-%COMP%]{margin:.5rem}}@media only screen and (min-width: 321px){.appOutOfStateContent[_ngcontent-%COMP%]{margin:1rem}.appOutOfStateContainer[_ngcontent-%COMP%]{margin:.5rem}.appBackToHomeButton[_ngcontent-%COMP%]{z-index:5000}}@media only screen and (min-width: 1224px){.appOutOfStateContent[_ngcontent-%COMP%]{margin:10rem}.appOutOfStateContainer[_ngcontent-%COMP%]{margin:5rem}}@media only screen and (min-width: 1824px){.appOutOfStateContent[_ngcontent-%COMP%]{margin:10rem}.appOutOfStateContainer[_ngcontent-%COMP%]{margin:5rem}}"]}),i})()}];let Gy=(()=>{class i{}return i.\u0275fac=function(o){return new(o||i)},i.\u0275mod=D.oAB({type:i}),i.\u0275inj=D.cJS({imports:[[Bt.Bz.forChild(qy)],Bt.Bz]}),i})();var Vy=Et(1048);let Zy=(()=>{class i{}return i.\u0275fac=function(o){return new(o||i)},i.\u0275mod=D.oAB({type:i}),i.\u0275inj=D.cJS({imports:[[fl.ez,Vy.m,Gy,Jm]]}),i})()}}]);