(self.webpackChunkpgc_paww_frontend=self.webpackChunkpgc_paww_frontend||[]).push([[562],{185:(He,pe,wt)=>{"use strict";var b=wt(3033);function v(Bt){var ft=[1/0,1/0,-1/0,-1/0];return b.coordEach(Bt,function(St){ft[0]>St[0]&&(ft[0]=St[0]),ft[1]>St[1]&&(ft[1]=St[1]),ft[2]<St[0]&&(ft[2]=St[0]),ft[3]<St[1]&&(ft[3]=St[1])}),ft}v.default=v,pe.Z=v},483:function(He){He.exports=function(){"use strict";function wt(v,Bt,ft,St,Ft){for(;St>ft;){if(St-ft>600){var le=St-ft+1,kt=Bt-ft+1,Ze=Math.log(le),ye=.5*Math.exp(2*Ze/3),ue=.5*Math.sqrt(Ze*ye*(le-ye)/le)*(kt-le/2<0?-1:1);wt(v,Bt,Math.max(ft,Math.floor(Bt-kt*ye/le+ue)),Math.min(St,Math.floor(Bt+(le-kt)*ye/le+ue)),Ft)}var qt=v[Bt],Qt=ft,X=St;for(yt(v,ft,Bt),Ft(v[St],qt)>0&&yt(v,ft,St);Qt<X;){for(yt(v,Qt,X),Qt++,X--;Ft(v[Qt],qt)<0;)Qt++;for(;Ft(v[X],qt)>0;)X--}0===Ft(v[ft],qt)?yt(v,ft,X):yt(v,++X,St),X<=Bt&&(ft=X+1),Bt<=X&&(St=X-1)}}function yt(v,Bt,ft){var St=v[Bt];v[Bt]=v[ft],v[ft]=St}function b(v,Bt){return v<Bt?-1:v>Bt?1:0}return function(v,Bt,ft,St,Ft){wt(v,Bt,ft||0,St||v.length-1,Ft||b)}}()},5454:(He,pe,wt)=>{"use strict";He.exports=b,He.exports.default=b;var yt=wt(483);function b(X,J){if(!(this instanceof b))return new b(X,J);this._maxEntries=Math.max(4,X||9),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),J&&this._initFormat(J),this.clear()}function v(X,J,Q){if(!Q)return J.indexOf(X);for(var bt=0;bt<J.length;bt++)if(Q(X,J[bt]))return bt;return-1}function Bt(X,J){ft(X,0,X.children.length,J,X)}function ft(X,J,Q,bt,et){et||(et=qt(null)),et.minX=1/0,et.minY=1/0,et.maxX=-1/0,et.maxY=-1/0;for(var lt,tt=J;tt<Q;tt++)lt=X.children[tt],St(et,X.leaf?bt(lt):lt);return et}function St(X,J){return X.minX=Math.min(X.minX,J.minX),X.minY=Math.min(X.minY,J.minY),X.maxX=Math.max(X.maxX,J.maxX),X.maxY=Math.max(X.maxY,J.maxY),X}function Ft(X,J){return X.minX-J.minX}function le(X,J){return X.minY-J.minY}function kt(X){return(X.maxX-X.minX)*(X.maxY-X.minY)}function Ze(X){return X.maxX-X.minX+(X.maxY-X.minY)}function ye(X,J){return(Math.max(J.maxX,X.maxX)-Math.min(J.minX,X.minX))*(Math.max(J.maxY,X.maxY)-Math.min(J.minY,X.minY))}function ue(X,J){var Q=Math.max(X.minX,J.minX),bt=Math.max(X.minY,J.minY),et=Math.min(X.maxX,J.maxX),tt=Math.min(X.maxY,J.maxY);return Math.max(0,et-Q)*Math.max(0,tt-bt)}function de(X,J){return X.minX<=J.minX&&X.minY<=J.minY&&J.maxX<=X.maxX&&J.maxY<=X.maxY}function Ye(X,J){return J.minX<=X.maxX&&J.minY<=X.maxY&&J.maxX>=X.minX&&J.maxY>=X.minY}function qt(X){return{children:X,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function Qt(X,J,Q,bt,et){for(var lt,tt=[J,Q];tt.length;)!((Q=tt.pop())-(J=tt.pop())<=bt)&&(lt=J+Math.ceil((Q-J)/bt/2)*bt,yt(X,lt,J,Q,et),tt.push(J,lt,lt,Q))}b.prototype={all:function(){return this._all(this.data,[])},search:function(X){var J=this.data,Q=[],bt=this.toBBox;if(!Ye(X,J))return Q;for(var tt,lt,j,re,et=[];J;){for(tt=0,lt=J.children.length;tt<lt;tt++)j=J.children[tt],Ye(X,re=J.leaf?bt(j):j)&&(J.leaf?Q.push(j):de(X,re)?this._all(j,Q):et.push(j));J=et.pop()}return Q},collides:function(X){var J=this.data,Q=this.toBBox;if(!Ye(X,J))return!1;for(var et,tt,lt,j,bt=[];J;){for(et=0,tt=J.children.length;et<tt;et++)if(lt=J.children[et],Ye(X,j=J.leaf?Q(lt):lt)){if(J.leaf||de(X,j))return!0;bt.push(lt)}J=bt.pop()}return!1},load:function(X){if(!X||!X.length)return this;if(X.length<this._minEntries){for(var J=0,Q=X.length;J<Q;J++)this.insert(X[J]);return this}var bt=this._build(X.slice(),0,X.length-1,0);if(this.data.children.length)if(this.data.height===bt.height)this._splitRoot(this.data,bt);else{if(this.data.height<bt.height){var et=this.data;this.data=bt,bt=et}this._insert(bt,this.data.height-bt.height-1,!0)}else this.data=bt;return this},insert:function(X){return X&&this._insert(X,this.data.height-1),this},clear:function(){return this.data=qt([]),this},remove:function(X,J){if(!X)return this;for(var lt,j,re,xt,Q=this.data,bt=this.toBBox(X),et=[],tt=[];Q||et.length;){if(Q||(Q=et.pop(),j=et[et.length-1],lt=tt.pop(),xt=!0),Q.leaf&&-1!==(re=v(X,Q.children,J)))return Q.children.splice(re,1),et.push(Q),this._condense(et),this;xt||Q.leaf||!de(Q,bt)?j?(lt++,Q=j.children[lt],xt=!1):Q=null:(et.push(Q),tt.push(lt),lt=0,j=Q,Q=Q.children[0])}return this},toBBox:function(X){return X},compareMinX:Ft,compareMinY:le,toJSON:function(){return this.data},fromJSON:function(X){return this.data=X,this},_all:function(X,J){for(var Q=[];X;)X.leaf?J.push.apply(J,X.children):Q.push.apply(Q,X.children),X=Q.pop();return J},_build:function(X,J,Q,bt){var lt,et=Q-J+1,tt=this._maxEntries;if(et<=tt)return Bt(lt=qt(X.slice(J,Q+1)),this.toBBox),lt;bt||(bt=Math.ceil(Math.log(et)/Math.log(tt)),tt=Math.ceil(et/Math.pow(tt,bt-1))),(lt=qt([])).leaf=!1,lt.height=bt;var xt,Ot,at,ke,j=Math.ceil(et/tt),re=j*Math.ceil(Math.sqrt(tt));for(Qt(X,J,Q,re,this.compareMinX),xt=J;xt<=Q;xt+=re)for(Qt(X,xt,at=Math.min(xt+re-1,Q),j,this.compareMinY),Ot=xt;Ot<=at;Ot+=j)ke=Math.min(Ot+j-1,at),lt.children.push(this._build(X,Ot,ke,bt-1));return Bt(lt,this.toBBox),lt},_chooseSubtree:function(X,J,Q,bt){for(var et,tt,lt,j,re,xt,Ot,at;bt.push(J),!J.leaf&&bt.length-1!==Q;){for(Ot=at=1/0,et=0,tt=J.children.length;et<tt;et++)re=kt(lt=J.children[et]),(xt=ye(X,lt)-re)<at?(at=xt,Ot=re<Ot?re:Ot,j=lt):xt===at&&re<Ot&&(Ot=re,j=lt);J=j||J.children[0]}return J},_insert:function(X,J,Q){var et=Q?X:(0,this.toBBox)(X),tt=[],lt=this._chooseSubtree(et,this.data,J,tt);for(lt.children.push(X),St(lt,et);J>=0&&tt[J].children.length>this._maxEntries;)this._split(tt,J),J--;this._adjustParentBBoxes(et,tt,J)},_split:function(X,J){var Q=X[J],bt=Q.children.length,et=this._minEntries;this._chooseSplitAxis(Q,et,bt);var tt=this._chooseSplitIndex(Q,et,bt),lt=qt(Q.children.splice(tt,Q.children.length-tt));lt.height=Q.height,lt.leaf=Q.leaf,Bt(Q,this.toBBox),Bt(lt,this.toBBox),J?X[J-1].children.push(lt):this._splitRoot(Q,lt)},_splitRoot:function(X,J){this.data=qt([X,J]),this.data.height=X.height+1,this.data.leaf=!1,Bt(this.data,this.toBBox)},_chooseSplitIndex:function(X,J,Q){var bt,et,tt,lt,j,re,xt,Ot;for(re=xt=1/0,bt=J;bt<=Q-J;bt++)lt=ue(et=ft(X,0,bt,this.toBBox),tt=ft(X,bt,Q,this.toBBox)),j=kt(et)+kt(tt),lt<re?(re=lt,Ot=bt,xt=j<xt?j:xt):lt===re&&j<xt&&(xt=j,Ot=bt);return Ot},_chooseSplitAxis:function(X,J,Q){var bt=X.leaf?this.compareMinX:Ft,et=X.leaf?this.compareMinY:le;this._allDistMargin(X,J,Q,bt)<this._allDistMargin(X,J,Q,et)&&X.children.sort(bt)},_allDistMargin:function(X,J,Q,bt){X.children.sort(bt);var re,xt,et=this.toBBox,tt=ft(X,0,J,et),lt=ft(X,Q-J,Q,et),j=Ze(tt)+Ze(lt);for(re=J;re<Q-J;re++)xt=X.children[re],St(tt,X.leaf?et(xt):xt),j+=Ze(tt);for(re=Q-J-1;re>=J;re--)xt=X.children[re],St(lt,X.leaf?et(xt):xt),j+=Ze(lt);return j},_adjustParentBBoxes:function(X,J,Q){for(var bt=Q;bt>=0;bt--)St(J[bt],X)},_condense:function(X){for(var Q,J=X.length-1;J>=0;J--)0===X[J].children.length?J>0?(Q=X[J-1].children).splice(Q.indexOf(X[J]),1):this.clear():Bt(X[J],this.toBBox)},_initFormat:function(X){var J=["return a"," - b",";"];this.compareMinX=new Function("a","b",J.join(X[0])),this.compareMinY=new Function("a","b",J.join(X[1])),this.toBBox=new Function("a","return {minX: a"+X[0]+", minY: a"+X[1]+", maxX: a"+X[2]+", maxY: a"+X[3]+"};")}}},8410:(He,pe)=>{"use strict";function wt(xt,Ot,at){void 0===at&&(at={});var ke={type:"Feature"};return(0===at.id||at.id)&&(ke.id=at.id),at.bbox&&(ke.bbox=at.bbox),ke.properties=Ot||{},ke.geometry=xt,ke}function b(xt,Ot,at){if(void 0===at&&(at={}),!xt)throw new Error("coordinates is required");if(!Array.isArray(xt))throw new Error("coordinates must be an Array");if(xt.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!tt(xt[0])||!tt(xt[1]))throw new Error("coordinates must contain numbers");return wt({type:"Point",coordinates:xt},Ot,at)}function Bt(xt,Ot,at){void 0===at&&(at={});for(var ke=0,Te=xt;ke<Te.length;ke++){var Et=Te[ke];if(Et.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var ne=0;ne<Et[Et.length-1].length;ne++)if(Et[Et.length-1][ne]!==Et[0][ne])throw new Error("First and last Position are not equivalent.")}return wt({type:"Polygon",coordinates:xt},Ot,at)}function St(xt,Ot,at){if(void 0===at&&(at={}),xt.length<2)throw new Error("coordinates must be an array of two or more positions");return wt({type:"LineString",coordinates:xt},Ot,at)}function le(xt,Ot){void 0===Ot&&(Ot={});var at={type:"FeatureCollection"};return Ot.id&&(at.id=Ot.id),Ot.bbox&&(at.bbox=Ot.bbox),at.features=xt,at}function kt(xt,Ot,at){return void 0===at&&(at={}),wt({type:"MultiLineString",coordinates:xt},Ot,at)}function Ze(xt,Ot,at){return void 0===at&&(at={}),wt({type:"MultiPoint",coordinates:xt},Ot,at)}function ye(xt,Ot,at){return void 0===at&&(at={}),wt({type:"MultiPolygon",coordinates:xt},Ot,at)}function Ye(xt,Ot){void 0===Ot&&(Ot="kilometers");var at=pe.factors[Ot];if(!at)throw new Error(Ot+" units is invalid");return xt*at}function qt(xt,Ot){void 0===Ot&&(Ot="kilometers");var at=pe.factors[Ot];if(!at)throw new Error(Ot+" units is invalid");return xt/at}function J(xt){return xt%(2*Math.PI)*180/Math.PI}function tt(xt){return!isNaN(xt)&&null!==xt&&!Array.isArray(xt)}Object.defineProperty(pe,"__esModule",{value:!0}),pe.earthRadius=6371008.8,pe.factors={centimeters:100*pe.earthRadius,centimetres:100*pe.earthRadius,degrees:pe.earthRadius/111325,feet:3.28084*pe.earthRadius,inches:39.37*pe.earthRadius,kilometers:pe.earthRadius/1e3,kilometres:pe.earthRadius/1e3,meters:pe.earthRadius,metres:pe.earthRadius,miles:pe.earthRadius/1609.344,millimeters:1e3*pe.earthRadius,millimetres:1e3*pe.earthRadius,nauticalmiles:pe.earthRadius/1852,radians:1,yards:1.0936*pe.earthRadius},pe.unitsFactors={centimeters:100,centimetres:100,degrees:1/111325,feet:3.28084,inches:39.37,kilometers:.001,kilometres:.001,meters:1,metres:1,miles:1/1609.344,millimeters:1e3,millimetres:1e3,nauticalmiles:1/1852,radians:1/pe.earthRadius,yards:1.0936133},pe.areaFactors={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,hectares:1e-4,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:386e-9,millimeters:1e6,millimetres:1e6,yards:1.195990046},pe.feature=wt,pe.geometry=function(xt,Ot,at){switch(void 0===at&&(at={}),xt){case"Point":return b(Ot).geometry;case"LineString":return St(Ot).geometry;case"Polygon":return Bt(Ot).geometry;case"MultiPoint":return Ze(Ot).geometry;case"MultiLineString":return kt(Ot).geometry;case"MultiPolygon":return ye(Ot).geometry;default:throw new Error(xt+" is invalid")}},pe.point=b,pe.points=function(xt,Ot,at){return void 0===at&&(at={}),le(xt.map(function(ke){return b(ke,Ot)}),at)},pe.polygon=Bt,pe.polygons=function(xt,Ot,at){return void 0===at&&(at={}),le(xt.map(function(ke){return Bt(ke,Ot)}),at)},pe.lineString=St,pe.lineStrings=function(xt,Ot,at){return void 0===at&&(at={}),le(xt.map(function(ke){return St(ke,Ot)}),at)},pe.featureCollection=le,pe.multiLineString=kt,pe.multiPoint=Ze,pe.multiPolygon=ye,pe.geometryCollection=function(xt,Ot,at){return void 0===at&&(at={}),wt({type:"GeometryCollection",geometries:xt},Ot,at)},pe.round=function(xt,Ot){if(void 0===Ot&&(Ot=0),Ot&&!(Ot>=0))throw new Error("precision must be a positive number");var at=Math.pow(10,Ot||0);return Math.round(xt*at)/at},pe.radiansToLength=Ye,pe.lengthToRadians=qt,pe.lengthToDegrees=function(xt,Ot){return J(qt(xt,Ot))},pe.bearingToAzimuth=function(xt){var Ot=xt%360;return Ot<0&&(Ot+=360),Ot},pe.radiansToDegrees=J,pe.degreesToRadians=function(xt){return xt%360*Math.PI/180},pe.convertLength=function(xt,Ot,at){if(void 0===Ot&&(Ot="kilometers"),void 0===at&&(at="kilometers"),!(xt>=0))throw new Error("length must be a positive number");return Ye(qt(xt,Ot),at)},pe.convertArea=function(xt,Ot,at){if(void 0===Ot&&(Ot="meters"),void 0===at&&(at="kilometers"),!(xt>=0))throw new Error("area must be a positive number");var ke=pe.areaFactors[Ot];if(!ke)throw new Error("invalid original units");var Te=pe.areaFactors[at];if(!Te)throw new Error("invalid final units");return xt/ke*Te},pe.isNumber=tt,pe.isObject=function(xt){return!!xt&&xt.constructor===Object},pe.validateBBox=function(xt){if(!xt)throw new Error("bbox is required");if(!Array.isArray(xt))throw new Error("bbox must be an Array");if(4!==xt.length&&6!==xt.length)throw new Error("bbox must be an Array of 4 or 6 numbers");xt.forEach(function(Ot){if(!tt(Ot))throw new Error("bbox must only contain numbers")})},pe.validateId=function(xt){if(!xt)throw new Error("id is required");if(-1===["string","number"].indexOf(typeof xt))throw new Error("id must be a number or a string")}},3033:(He,pe,wt)=>{"use strict";Object.defineProperty(pe,"__esModule",{value:!0});var yt=wt(8410);function b(Q,bt,et){if(null!==Q)for(var tt,lt,j,re,xt,Ot,at,Et,ke=0,Te=0,ne=Q.type,Pt="FeatureCollection"===ne,Kt="Feature"===ne,te=Pt?Q.features.length:1,vt=0;vt<te;vt++){xt=(Et=!!(at=Pt?Q.features[vt].geometry:Kt?Q.geometry:Q)&&"GeometryCollection"===at.type)?at.geometries.length:1;for(var Se=0;Se<xt;Se++){var Fe=0,wr=0;if(null!==(re=Et?at.geometries[Se]:at)){Ot=re.coordinates;var De=re.type;switch(ke=!et||"Polygon"!==De&&"MultiPolygon"!==De?0:1,De){case null:break;case"Point":if(!1===bt(Ot,Te,vt,Fe,wr))return!1;Te++,Fe++;break;case"LineString":case"MultiPoint":for(tt=0;tt<Ot.length;tt++){if(!1===bt(Ot[tt],Te,vt,Fe,wr))return!1;Te++,"MultiPoint"===De&&Fe++}"LineString"===De&&Fe++;break;case"Polygon":case"MultiLineString":for(tt=0;tt<Ot.length;tt++){for(lt=0;lt<Ot[tt].length-ke;lt++){if(!1===bt(Ot[tt][lt],Te,vt,Fe,wr))return!1;Te++}"MultiLineString"===De&&Fe++,"Polygon"===De&&wr++}"Polygon"===De&&Fe++;break;case"MultiPolygon":for(tt=0;tt<Ot.length;tt++){for(wr=0,lt=0;lt<Ot[tt].length;lt++){for(j=0;j<Ot[tt][lt].length-ke;j++){if(!1===bt(Ot[tt][lt][j],Te,vt,Fe,wr))return!1;Te++}wr++}Fe++}break;case"GeometryCollection":for(tt=0;tt<re.geometries.length;tt++)if(!1===b(re.geometries[tt],bt,et))return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function Bt(Q,bt){var et;switch(Q.type){case"FeatureCollection":for(et=0;et<Q.features.length&&!1!==bt(Q.features[et].properties,et);et++);break;case"Feature":bt(Q.properties,0)}}function St(Q,bt){if("Feature"===Q.type)bt(Q,0);else if("FeatureCollection"===Q.type)for(var et=0;et<Q.features.length&&!1!==bt(Q.features[et],et);et++);}function kt(Q,bt){var et,tt,lt,j,re,xt,Ot,at,ke,Te,Et=0,ne="FeatureCollection"===Q.type,Pt="Feature"===Q.type,Kt=ne?Q.features.length:1;for(et=0;et<Kt;et++){for(at=ne?Q.features[et].properties:Pt?Q.properties:{},ke=ne?Q.features[et].bbox:Pt?Q.bbox:void 0,Te=ne?Q.features[et].id:Pt?Q.id:void 0,re=(Ot=!!(xt=ne?Q.features[et].geometry:Pt?Q.geometry:Q)&&"GeometryCollection"===xt.type)?xt.geometries.length:1,lt=0;lt<re;lt++)if(null!==(j=Ot?xt.geometries[lt]:xt))switch(j.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":if(!1===bt(j,Et,at,ke,Te))return!1;break;case"GeometryCollection":for(tt=0;tt<j.geometries.length;tt++)if(!1===bt(j.geometries[tt],Et,at,ke,Te))return!1;break;default:throw new Error("Unknown Geometry Type")}else if(!1===bt(null,Et,at,ke,Te))return!1;Et++}}function ye(Q,bt){kt(Q,function(et,tt,lt,j,re){var Ot,xt=null===et?null:et.type;switch(xt){case null:case"Point":case"LineString":case"Polygon":return!1!==bt(yt.feature(et,lt,{bbox:j,id:re}),tt,0)&&void 0}switch(xt){case"MultiPoint":Ot="Point";break;case"MultiLineString":Ot="LineString";break;case"MultiPolygon":Ot="Polygon"}for(var at=0;at<et.coordinates.length;at++)if(!1===bt(yt.feature({type:Ot,coordinates:et.coordinates[at]},lt),tt,at))return!1})}function de(Q,bt){ye(Q,function(et,tt,lt){var j=0;if(et.geometry){var re=et.geometry.type;if("Point"!==re&&"MultiPoint"!==re){var xt,Ot=0,at=0,ke=0;if(!1===b(et,function(Te,Et,ne,Pt,Kt){if(void 0===xt||tt>Ot||Pt>at||Kt>ke)return xt=Te,Ot=tt,at=Pt,ke=Kt,void(j=0);var te=yt.lineString([xt,Te],et.properties);if(!1===bt(te,tt,lt,Kt,j))return!1;j++,xt=Te}))return!1}}})}function qt(Q,bt){if(!Q)throw new Error("geojson is required");ye(Q,function(et,tt,lt){if(null!==et.geometry){var re=et.geometry.coordinates;switch(et.geometry.type){case"LineString":if(!1===bt(et,tt,lt,0,0))return!1;break;case"Polygon":for(var xt=0;xt<re.length;xt++)if(!1===bt(yt.lineString(re[xt],et.properties),tt,lt,xt))return!1}}})}pe.coordAll=function(Q){var bt=[];return b(Q,function(et){bt.push(et)}),bt},pe.coordEach=b,pe.coordReduce=function(Q,bt,et,tt){var lt=et;return b(Q,function(j,re,xt,Ot,at){lt=0===re&&void 0===et?j:bt(lt,j,re,xt,Ot,at)},tt),lt},pe.featureEach=St,pe.featureReduce=function(Q,bt,et){var tt=et;return St(Q,function(lt,j){tt=0===j&&void 0===et?lt:bt(tt,lt,j)}),tt},pe.findPoint=function(Q,bt){if(!yt.isObject(bt=bt||{}))throw new Error("options is invalid");var xt,et=bt.featureIndex||0,tt=bt.multiFeatureIndex||0,lt=bt.geometryIndex||0,j=bt.coordIndex||0,re=bt.properties;switch(Q.type){case"FeatureCollection":et<0&&(et=Q.features.length+et),re=re||Q.features[et].properties,xt=Q.features[et].geometry;break;case"Feature":re=re||Q.properties,xt=Q.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":xt=Q;break;default:throw new Error("geojson is invalid")}if(null===xt)return null;var Ot=xt.coordinates;switch(xt.type){case"Point":return yt.point(Ot,re,bt);case"MultiPoint":return tt<0&&(tt=Ot.length+tt),yt.point(Ot[tt],re,bt);case"LineString":return j<0&&(j=Ot.length+j),yt.point(Ot[j],re,bt);case"Polygon":return lt<0&&(lt=Ot.length+lt),j<0&&(j=Ot[lt].length+j),yt.point(Ot[lt][j],re,bt);case"MultiLineString":return tt<0&&(tt=Ot.length+tt),j<0&&(j=Ot[tt].length+j),yt.point(Ot[tt][j],re,bt);case"MultiPolygon":return tt<0&&(tt=Ot.length+tt),lt<0&&(lt=Ot[tt].length+lt),j<0&&(j=Ot[tt][lt].length-j),yt.point(Ot[tt][lt][j],re,bt)}throw new Error("geojson is invalid")},pe.findSegment=function(Q,bt){if(!yt.isObject(bt=bt||{}))throw new Error("options is invalid");var xt,et=bt.featureIndex||0,tt=bt.multiFeatureIndex||0,lt=bt.geometryIndex||0,j=bt.segmentIndex||0,re=bt.properties;switch(Q.type){case"FeatureCollection":et<0&&(et=Q.features.length+et),re=re||Q.features[et].properties,xt=Q.features[et].geometry;break;case"Feature":re=re||Q.properties,xt=Q.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":xt=Q;break;default:throw new Error("geojson is invalid")}if(null===xt)return null;var Ot=xt.coordinates;switch(xt.type){case"Point":case"MultiPoint":return null;case"LineString":return j<0&&(j=Ot.length+j-1),yt.lineString([Ot[j],Ot[j+1]],re,bt);case"Polygon":return lt<0&&(lt=Ot.length+lt),j<0&&(j=Ot[lt].length+j-1),yt.lineString([Ot[lt][j],Ot[lt][j+1]],re,bt);case"MultiLineString":return tt<0&&(tt=Ot.length+tt),j<0&&(j=Ot[tt].length+j-1),yt.lineString([Ot[tt][j],Ot[tt][j+1]],re,bt);case"MultiPolygon":return tt<0&&(tt=Ot.length+tt),lt<0&&(lt=Ot[tt].length+lt),j<0&&(j=Ot[tt][lt].length-j-1),yt.lineString([Ot[tt][lt][j],Ot[tt][lt][j+1]],re,bt)}throw new Error("geojson is invalid")},pe.flattenEach=ye,pe.flattenReduce=function(Q,bt,et){var tt=et;return ye(Q,function(lt,j,re){tt=0===j&&0===re&&void 0===et?lt:bt(tt,lt,j,re)}),tt},pe.geomEach=kt,pe.geomReduce=function(Q,bt,et){var tt=et;return kt(Q,function(lt,j,re,xt,Ot){tt=0===j&&void 0===et?lt:bt(tt,lt,j,re,xt,Ot)}),tt},pe.lineEach=qt,pe.lineReduce=function(Q,bt,et){var tt=et;return qt(Q,function(lt,j,re,xt){tt=0===j&&void 0===et?lt:bt(tt,lt,j,re,xt)}),tt},pe.propEach=Bt,pe.propReduce=function(Q,bt,et){var tt=et;return Bt(Q,function(lt,j){tt=0===j&&void 0===et?lt:bt(tt,lt,j)}),tt},pe.segmentEach=de,pe.segmentReduce=function(Q,bt,et){var tt=et,lt=!1;return de(Q,function(j,re,xt,Ot,at){tt=!1===lt&&void 0===et?j:bt(tt,j,re,xt,Ot,at),lt=!0}),tt}},9336:function(He){He.exports=function(){"use strict";function wt(v,Bt,ft,St,Ft){for(;St>ft;){if(St-ft>600){var le=St-ft+1,kt=Bt-ft+1,Ze=Math.log(le),ye=.5*Math.exp(2*Ze/3),ue=.5*Math.sqrt(Ze*ye*(le-ye)/le)*(kt-le/2<0?-1:1);wt(v,Bt,Math.max(ft,Math.floor(Bt-kt*ye/le+ue)),Math.min(St,Math.floor(Bt+(le-kt)*ye/le+ue)),Ft)}var qt=v[Bt],Qt=ft,X=St;for(yt(v,ft,Bt),Ft(v[St],qt)>0&&yt(v,ft,St);Qt<X;){for(yt(v,Qt,X),Qt++,X--;Ft(v[Qt],qt)<0;)Qt++;for(;Ft(v[X],qt)>0;)X--}0===Ft(v[ft],qt)?yt(v,ft,X):yt(v,++X,St),X<=Bt&&(ft=X+1),Bt<=X&&(St=X-1)}}function yt(v,Bt,ft){var St=v[Bt];v[Bt]=v[ft],v[ft]=St}function b(v,Bt){return v<Bt?-1:v>Bt?1:0}return function(v,Bt,ft,St,Ft){wt(v,Bt,ft||0,St||v.length-1,Ft||b)}}()},8309:(He,pe,wt)=>{"use strict";He.exports=b,He.exports.default=b;var yt=wt(9336);function b(X,J){if(!(this instanceof b))return new b(X,J);this._maxEntries=Math.max(4,X||9),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),J&&this._initFormat(J),this.clear()}function v(X,J,Q){if(!Q)return J.indexOf(X);for(var bt=0;bt<J.length;bt++)if(Q(X,J[bt]))return bt;return-1}function Bt(X,J){ft(X,0,X.children.length,J,X)}function ft(X,J,Q,bt,et){et||(et=qt(null)),et.minX=1/0,et.minY=1/0,et.maxX=-1/0,et.maxY=-1/0;for(var lt,tt=J;tt<Q;tt++)lt=X.children[tt],St(et,X.leaf?bt(lt):lt);return et}function St(X,J){return X.minX=Math.min(X.minX,J.minX),X.minY=Math.min(X.minY,J.minY),X.maxX=Math.max(X.maxX,J.maxX),X.maxY=Math.max(X.maxY,J.maxY),X}function Ft(X,J){return X.minX-J.minX}function le(X,J){return X.minY-J.minY}function kt(X){return(X.maxX-X.minX)*(X.maxY-X.minY)}function Ze(X){return X.maxX-X.minX+(X.maxY-X.minY)}function ye(X,J){return(Math.max(J.maxX,X.maxX)-Math.min(J.minX,X.minX))*(Math.max(J.maxY,X.maxY)-Math.min(J.minY,X.minY))}function ue(X,J){var Q=Math.max(X.minX,J.minX),bt=Math.max(X.minY,J.minY),et=Math.min(X.maxX,J.maxX),tt=Math.min(X.maxY,J.maxY);return Math.max(0,et-Q)*Math.max(0,tt-bt)}function de(X,J){return X.minX<=J.minX&&X.minY<=J.minY&&J.maxX<=X.maxX&&J.maxY<=X.maxY}function Ye(X,J){return J.minX<=X.maxX&&J.minY<=X.maxY&&J.maxX>=X.minX&&J.maxY>=X.minY}function qt(X){return{children:X,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function Qt(X,J,Q,bt,et){for(var lt,tt=[J,Q];tt.length;)!((Q=tt.pop())-(J=tt.pop())<=bt)&&(lt=J+Math.ceil((Q-J)/bt/2)*bt,yt(X,lt,J,Q,et),tt.push(J,lt,lt,Q))}b.prototype={all:function(){return this._all(this.data,[])},search:function(X){var J=this.data,Q=[],bt=this.toBBox;if(!Ye(X,J))return Q;for(var tt,lt,j,re,et=[];J;){for(tt=0,lt=J.children.length;tt<lt;tt++)j=J.children[tt],Ye(X,re=J.leaf?bt(j):j)&&(J.leaf?Q.push(j):de(X,re)?this._all(j,Q):et.push(j));J=et.pop()}return Q},collides:function(X){var J=this.data,Q=this.toBBox;if(!Ye(X,J))return!1;for(var et,tt,lt,j,bt=[];J;){for(et=0,tt=J.children.length;et<tt;et++)if(lt=J.children[et],Ye(X,j=J.leaf?Q(lt):lt)){if(J.leaf||de(X,j))return!0;bt.push(lt)}J=bt.pop()}return!1},load:function(X){if(!X||!X.length)return this;if(X.length<this._minEntries){for(var J=0,Q=X.length;J<Q;J++)this.insert(X[J]);return this}var bt=this._build(X.slice(),0,X.length-1,0);if(this.data.children.length)if(this.data.height===bt.height)this._splitRoot(this.data,bt);else{if(this.data.height<bt.height){var et=this.data;this.data=bt,bt=et}this._insert(bt,this.data.height-bt.height-1,!0)}else this.data=bt;return this},insert:function(X){return X&&this._insert(X,this.data.height-1),this},clear:function(){return this.data=qt([]),this},remove:function(X,J){if(!X)return this;for(var lt,j,re,xt,Q=this.data,bt=this.toBBox(X),et=[],tt=[];Q||et.length;){if(Q||(Q=et.pop(),j=et[et.length-1],lt=tt.pop(),xt=!0),Q.leaf&&-1!==(re=v(X,Q.children,J)))return Q.children.splice(re,1),et.push(Q),this._condense(et),this;xt||Q.leaf||!de(Q,bt)?j?(lt++,Q=j.children[lt],xt=!1):Q=null:(et.push(Q),tt.push(lt),lt=0,j=Q,Q=Q.children[0])}return this},toBBox:function(X){return X},compareMinX:Ft,compareMinY:le,toJSON:function(){return this.data},fromJSON:function(X){return this.data=X,this},_all:function(X,J){for(var Q=[];X;)X.leaf?J.push.apply(J,X.children):Q.push.apply(Q,X.children),X=Q.pop();return J},_build:function(X,J,Q,bt){var lt,et=Q-J+1,tt=this._maxEntries;if(et<=tt)return Bt(lt=qt(X.slice(J,Q+1)),this.toBBox),lt;bt||(bt=Math.ceil(Math.log(et)/Math.log(tt)),tt=Math.ceil(et/Math.pow(tt,bt-1))),(lt=qt([])).leaf=!1,lt.height=bt;var xt,Ot,at,ke,j=Math.ceil(et/tt),re=j*Math.ceil(Math.sqrt(tt));for(Qt(X,J,Q,re,this.compareMinX),xt=J;xt<=Q;xt+=re)for(Qt(X,xt,at=Math.min(xt+re-1,Q),j,this.compareMinY),Ot=xt;Ot<=at;Ot+=j)ke=Math.min(Ot+j-1,at),lt.children.push(this._build(X,Ot,ke,bt-1));return Bt(lt,this.toBBox),lt},_chooseSubtree:function(X,J,Q,bt){for(var et,tt,lt,j,re,xt,Ot,at;bt.push(J),!J.leaf&&bt.length-1!==Q;){for(Ot=at=1/0,et=0,tt=J.children.length;et<tt;et++)re=kt(lt=J.children[et]),(xt=ye(X,lt)-re)<at?(at=xt,Ot=re<Ot?re:Ot,j=lt):xt===at&&re<Ot&&(Ot=re,j=lt);J=j||J.children[0]}return J},_insert:function(X,J,Q){var et=Q?X:(0,this.toBBox)(X),tt=[],lt=this._chooseSubtree(et,this.data,J,tt);for(lt.children.push(X),St(lt,et);J>=0&&tt[J].children.length>this._maxEntries;)this._split(tt,J),J--;this._adjustParentBBoxes(et,tt,J)},_split:function(X,J){var Q=X[J],bt=Q.children.length,et=this._minEntries;this._chooseSplitAxis(Q,et,bt);var tt=this._chooseSplitIndex(Q,et,bt),lt=qt(Q.children.splice(tt,Q.children.length-tt));lt.height=Q.height,lt.leaf=Q.leaf,Bt(Q,this.toBBox),Bt(lt,this.toBBox),J?X[J-1].children.push(lt):this._splitRoot(Q,lt)},_splitRoot:function(X,J){this.data=qt([X,J]),this.data.height=X.height+1,this.data.leaf=!1,Bt(this.data,this.toBBox)},_chooseSplitIndex:function(X,J,Q){var bt,et,tt,lt,j,re,xt,Ot;for(re=xt=1/0,bt=J;bt<=Q-J;bt++)lt=ue(et=ft(X,0,bt,this.toBBox),tt=ft(X,bt,Q,this.toBBox)),j=kt(et)+kt(tt),lt<re?(re=lt,Ot=bt,xt=j<xt?j:xt):lt===re&&j<xt&&(xt=j,Ot=bt);return Ot},_chooseSplitAxis:function(X,J,Q){var bt=X.leaf?this.compareMinX:Ft,et=X.leaf?this.compareMinY:le;this._allDistMargin(X,J,Q,bt)<this._allDistMargin(X,J,Q,et)&&X.children.sort(bt)},_allDistMargin:function(X,J,Q,bt){X.children.sort(bt);var re,xt,et=this.toBBox,tt=ft(X,0,J,et),lt=ft(X,Q-J,Q,et),j=Ze(tt)+Ze(lt);for(re=J;re<Q-J;re++)xt=X.children[re],St(tt,X.leaf?et(xt):xt),j+=Ze(tt);for(re=Q-J-1;re>=J;re--)xt=X.children[re],St(lt,X.leaf?et(xt):xt),j+=Ze(lt);return j},_adjustParentBBoxes:function(X,J,Q){for(var bt=Q;bt>=0;bt--)St(J[bt],X)},_condense:function(X){for(var Q,J=X.length-1;J>=0;J--)0===X[J].children.length?J>0?(Q=X[J-1].children).splice(Q.indexOf(X[J]),1):this.clear():Bt(X[J],this.toBBox)},_initFormat:function(X){var J=["return a"," - b",";"];this.compareMinX=new Function("a","b",J.join(X[0])),this.compareMinY=new Function("a","b",J.join(X[1])),this.toBBox=new Function("a","return {minX: a"+X[0]+", minY: a"+X[1]+", maxX: a"+X[2]+", maxY: a"+X[3]+"};")}}},9568:(He,pe,wt)=>{"use strict";var yt=wt(8540),b=wt(44),v=b(yt("String.prototype.indexOf"));He.exports=function(ft,St){var Ft=yt(ft,!!St);return"function"==typeof Ft&&v(ft,".prototype.")>-1?b(Ft):Ft}},44:(He,pe,wt)=>{"use strict";var yt=wt(5396),b=wt(8540),v=b("%Function.prototype.apply%"),Bt=b("%Function.prototype.call%"),ft=b("%Reflect.apply%",!0)||yt.call(Bt,v),St=b("%Object.getOwnPropertyDescriptor%",!0),Ft=b("%Object.defineProperty%",!0),le=b("%Math.max%");if(Ft)try{Ft({},"a",{value:1})}catch(Ze){Ft=null}He.exports=function(ye){var ue=ft(yt,Bt,arguments);if(St&&Ft){var de=St(ue,"length");de.configurable&&Ft(ue,"length",{value:1+le(0,ye.length-(arguments.length-1))})}return ue};var kt=function(){return ft(yt,v,arguments)};Ft?Ft(He.exports,"apply",{value:kt}):He.exports.apply=kt},6896:(He,pe,wt)=>{"use strict";var yt=wt(3036),b=wt(54),v=wt(5503),Bt=wt(5322).orient2d;function ft(et,tt,lt){tt=Math.max(0,void 0===tt?2:tt),lt=lt||0;var j=function(et){for(var tt=et[0],lt=et[0],j=et[0],re=et[0],xt=0;xt<et.length;xt++){var Ot=et[xt];Ot[0]<tt[0]&&(tt=Ot),Ot[0]>j[0]&&(j=Ot),Ot[1]<lt[1]&&(lt=Ot),Ot[1]>re[1]&&(re=Ot)}var at=[tt,lt,j,re],ke=at.slice();for(xt=0;xt<et.length;xt++)v(et[xt],at)||ke.push(et[xt]);return function(et){et.sort(Q);for(var tt=[],lt=0;lt<et.length;lt++){for(;tt.length>=2&&ye(tt[tt.length-2],tt[tt.length-1],et[lt])<=0;)tt.pop();tt.push(et[lt])}for(var j=[],re=et.length-1;re>=0;re--){for(;j.length>=2&&ye(j[j.length-2],j[j.length-1],et[re])<=0;)j.pop();j.push(et[re])}return j.pop(),tt.pop(),tt.concat(j)}(ke)}(et),re=new yt(16);re.toBBox=function(wr){return{minX:wr[0],minY:wr[1],maxX:wr[0],maxY:wr[1]}},re.compareMinX=function(wr,De){return wr[0]-De[0]},re.compareMinY=function(wr,De){return wr[1]-De[1]},re.load(et);for(var at,xt=[],Ot=0;Ot<j.length;Ot++){var ke=j[Ot];re.remove(ke),at=qt(ke,at),xt.push(at)}var Te=new yt(16);for(Ot=0;Ot<xt.length;Ot++)Te.insert(de(xt[Ot]));for(var Et=tt*tt,ne=lt*lt;xt.length;){var Pt=xt.shift(),Kt=Pt.p,te=Pt.next.p,vt=Qt(Kt,te);if(!(vt<ne)){var Se=vt/Et;(ke=St(re,Pt.prev.p,Kt,te,Pt.next.next.p,Se,Te))&&Math.min(Qt(ke,Kt),Qt(ke,te))<=Se&&(xt.push(Pt),xt.push(qt(ke,Pt)),re.remove(ke),Te.remove(Pt),Te.insert(de(Pt)),Te.insert(de(Pt.next)))}}Pt=at;var Fe=[];do{Fe.push(Pt.p),Pt=Pt.next}while(Pt!==at);return Fe.push(Pt.p),Fe}function St(et,tt,lt,j,re,xt,Ot){for(var at=new b([],Ft),ke=et.data;ke;){for(var Te=0;Te<ke.children.length;Te++){var Et=ke.children[Te],ne=ke.leaf?X(Et,lt,j):le(lt,j,Et);ne>xt||at.push({node:Et,dist:ne})}for(;at.length&&!at.peek().node.children;){var Pt=at.pop(),Kt=Pt.node,te=X(Kt,tt,lt),vt=X(Kt,j,re);if(Pt.dist<te&&Pt.dist<vt&&Ze(lt,Kt,Ot)&&Ze(j,Kt,Ot))return Kt}(ke=at.pop())&&(ke=ke.node)}return null}function Ft(et,tt){return et.dist-tt.dist}function le(et,tt,lt){if(kt(et,lt)||kt(tt,lt))return 0;var j=J(et[0],et[1],tt[0],tt[1],lt.minX,lt.minY,lt.maxX,lt.minY);if(0===j)return 0;var re=J(et[0],et[1],tt[0],tt[1],lt.minX,lt.minY,lt.minX,lt.maxY);if(0===re)return 0;var xt=J(et[0],et[1],tt[0],tt[1],lt.maxX,lt.minY,lt.maxX,lt.maxY);if(0===xt)return 0;var Ot=J(et[0],et[1],tt[0],tt[1],lt.minX,lt.maxY,lt.maxX,lt.maxY);return 0===Ot?0:Math.min(j,re,xt,Ot)}function kt(et,tt){return et[0]>=tt.minX&&et[0]<=tt.maxX&&et[1]>=tt.minY&&et[1]<=tt.maxY}function Ze(et,tt,lt){for(var j=Math.min(et[0],tt[0]),re=Math.min(et[1],tt[1]),xt=Math.max(et[0],tt[0]),Ot=Math.max(et[1],tt[1]),at=lt.search({minX:j,minY:re,maxX:xt,maxY:Ot}),ke=0;ke<at.length;ke++)if(ue(at[ke].p,at[ke].next.p,et,tt))return!1;return!0}function ye(et,tt,lt){return Bt(et[0],et[1],tt[0],tt[1],lt[0],lt[1])}function ue(et,tt,lt,j){return et!==j&&tt!==lt&&ye(et,tt,lt)>0!=ye(et,tt,j)>0&&ye(lt,j,et)>0!=ye(lt,j,tt)>0}function de(et){var tt=et.p,lt=et.next.p;return et.minX=Math.min(tt[0],lt[0]),et.minY=Math.min(tt[1],lt[1]),et.maxX=Math.max(tt[0],lt[0]),et.maxY=Math.max(tt[1],lt[1]),et}function qt(et,tt){var lt={p:et,prev:null,next:null,minX:0,minY:0,maxX:0,maxY:0};return tt?(lt.next=tt.next,lt.prev=tt,tt.next.prev=lt,tt.next=lt):(lt.prev=lt,lt.next=lt),lt}function Qt(et,tt){var lt=et[0]-tt[0],j=et[1]-tt[1];return lt*lt+j*j}function X(et,tt,lt){var j=tt[0],re=tt[1],xt=lt[0]-j,Ot=lt[1]-re;if(0!==xt||0!==Ot){var at=((et[0]-j)*xt+(et[1]-re)*Ot)/(xt*xt+Ot*Ot);at>1?(j=lt[0],re=lt[1]):at>0&&(j+=xt*at,re+=Ot*at)}return(xt=et[0]-j)*xt+(Ot=et[1]-re)*Ot}function J(et,tt,lt,j,re,xt,Ot,at){var Xr,Er,Yr,Cr,ke=lt-et,Te=j-tt,Et=Ot-re,ne=at-xt,Pt=et-re,Kt=tt-xt,te=ke*ke+Te*Te,vt=ke*Et+Te*ne,Se=Et*Et+ne*ne,Fe=ke*Pt+Te*Kt,wr=Et*Pt+ne*Kt,De=te*Se-vt*vt,Mr=De,Be=De;0===De?(Er=0,Mr=1,Cr=wr,Be=Se):(Cr=te*wr-vt*Fe,(Er=vt*wr-Se*Fe)<0?(Er=0,Cr=wr,Be=Se):Er>Mr&&(Er=Mr,Cr=wr+vt,Be=Se)),Cr<0?(Cr=0,-Fe<0?Er=0:-Fe>te?Er=Mr:(Er=-Fe,Mr=te)):Cr>Be&&(Cr=Be,-Fe+vt<0?Er=0:-Fe+vt>te?Er=Mr:(Er=-Fe+vt,Mr=te));var fi=(1-(Yr=0===Cr?0:Cr/Be))*re+Yr*Ot-((1-(Xr=0===Er?0:Er/Mr))*et+Xr*lt),ae=(1-Yr)*xt+Yr*at-((1-Xr)*tt+Xr*j);return fi*fi+ae*ae}function Q(et,tt){return et[0]===tt[0]?et[1]-tt[1]:et[0]-tt[0]}b.default&&(b=b.default),He.exports=ft,He.exports.default=ft},2978:(He,pe,wt)=>{var yt=wt(8507),b=wt(7316),v=wt(4269),Bt=wt(5544),ft=wt(437),St=wt(3105),Ft=Date.prototype.getTime;function kt(ue){return null==ue}function Ze(ue){return!(!ue||"object"!=typeof ue||"number"!=typeof ue.length||"function"!=typeof ue.copy||"function"!=typeof ue.slice||ue.length>0&&"number"!=typeof ue[0])}He.exports=function le(ue,de,Ye){var qt=Ye||{};return!!(qt.strict?v(ue,de):ue===de)||(!ue||!de||"object"!=typeof ue&&"object"!=typeof de?qt.strict?v(ue,de):ue==de:function(ue,de,Ye){var qt,Qt;if(typeof ue!=typeof de||kt(ue)||kt(de)||ue.prototype!==de.prototype||b(ue)!==b(de))return!1;var X=Bt(ue),J=Bt(de);if(X!==J)return!1;if(X||J)return ue.source===de.source&&ft(ue)===ft(de);if(St(ue)&&St(de))return Ft.call(ue)===Ft.call(de);var Q=Ze(ue),bt=Ze(de);if(Q!==bt)return!1;if(Q||bt){if(ue.length!==de.length)return!1;for(qt=0;qt<ue.length;qt++)if(ue[qt]!==de[qt])return!1;return!0}if(typeof ue!=typeof de)return!1;try{var et=yt(ue),tt=yt(de)}catch(lt){return!1}if(et.length!==tt.length)return!1;for(et.sort(),tt.sort(),qt=et.length-1;qt>=0;qt--)if(et[qt]!=tt[qt])return!1;for(qt=et.length-1;qt>=0;qt--)if(!le(ue[Qt=et[qt]],de[Qt],Ye))return!1;return!0}(ue,de,qt))}},6886:(He,pe,wt)=>{"use strict";var yt=wt(8507),b="function"==typeof Symbol&&"symbol"==typeof Symbol("foo"),v=Object.prototype.toString,Bt=Array.prototype.concat,ft=Object.defineProperty,le=ft&&function(){var ye={};try{for(var ue in ft(ye,"x",{enumerable:!1,value:ye}),ye)return!1;return ye.x===ye}catch(de){return!1}}(),kt=function(ye,ue,de,Ye){ue in ye&&(!function(ye){return"function"==typeof ye&&"[object Function]"===v.call(ye)}(Ye)||!Ye())||(le?ft(ye,ue,{configurable:!0,enumerable:!1,value:de,writable:!0}):ye[ue]=de)},Ze=function(ye,ue){var de=arguments.length>2?arguments[2]:{},Ye=yt(ue);b&&(Ye=Bt.call(Ye,Object.getOwnPropertySymbols(ue)));for(var qt=0;qt<Ye.length;qt+=1)kt(ye,Ye[qt],ue[Ye[qt]],de[Ye[qt]])};Ze.supportsDescriptors=!!le,He.exports=Ze},5810:He=>{function pe(wt,yt,b,v){this.dataset=[],this.epsilon=1,this.minPts=2,this.distance=this._euclideanDistance,this.clusters=[],this.noise=[],this._visited=[],this._assigned=[],this._datasetLength=0,this._init(wt,yt,b,v)}pe.prototype.run=function(wt,yt,b,v){this._init(wt,yt,b,v);for(var Bt=0;Bt<this._datasetLength;Bt++)if(1!==this._visited[Bt]){this._visited[Bt]=1;var ft=this._regionQuery(Bt);if(ft.length<this.minPts)this.noise.push(Bt);else{var St=this.clusters.length;this.clusters.push([]),this._addToCluster(Bt,St),this._expandCluster(St,ft)}}return this.clusters},pe.prototype._init=function(wt,yt,b,v){if(wt){if(!(wt instanceof Array))throw Error("Dataset must be of type array, "+typeof wt+" given");this.dataset=wt,this.clusters=[],this.noise=[],this._datasetLength=wt.length,this._visited=new Array(this._datasetLength),this._assigned=new Array(this._datasetLength)}yt&&(this.epsilon=yt),b&&(this.minPts=b),v&&(this.distance=v)},pe.prototype._expandCluster=function(wt,yt){for(var b=0;b<yt.length;b++){var v=yt[b];if(1!==this._visited[v]){this._visited[v]=1;var Bt=this._regionQuery(v);Bt.length>=this.minPts&&(yt=this._mergeArrays(yt,Bt))}1!==this._assigned[v]&&this._addToCluster(v,wt)}},pe.prototype._addToCluster=function(wt,yt){this.clusters[yt].push(wt),this._assigned[wt]=1},pe.prototype._regionQuery=function(wt){for(var yt=[],b=0;b<this._datasetLength;b++)this.distance(this.dataset[wt],this.dataset[b])<this.epsilon&&yt.push(b);return yt},pe.prototype._mergeArrays=function(wt,yt){for(var b=yt.length,v=0;v<b;v++){var Bt=yt[v];wt.indexOf(Bt)<0&&wt.push(Bt)}return wt},pe.prototype._euclideanDistance=function(wt,yt){for(var b=0,v=Math.min(wt.length,yt.length);v--;)b+=(wt[v]-yt[v])*(wt[v]-yt[v]);return Math.sqrt(b)},He.exports&&(He.exports=pe)},1955:He=>{function pe(wt,yt,b){this.k=3,this.dataset=[],this.assignments=[],this.centroids=[],this.init(wt,yt,b)}pe.prototype.init=function(wt,yt,b){this.assignments=[],this.centroids=[],void 0!==wt&&(this.dataset=wt),void 0!==yt&&(this.k=yt),void 0!==b&&(this.distance=b)},pe.prototype.run=function(wt,yt){this.init(wt,yt);for(var b=this.dataset.length,v=0;v<this.k;v++)this.centroids[v]=this.randomCentroid();for(var Bt=!0;Bt;){Bt=this.assign();for(var ft=0;ft<this.k;ft++){for(var St=new Array(Ze),Ft=0,le=0;le<Ze;le++)St[le]=0;for(var kt=0;kt<b;kt++){var Ze=this.dataset[kt].length;if(ft===this.assignments[kt]){for(le=0;le<Ze;le++)St[le]+=this.dataset[kt][le];Ft++}}if(Ft>0){for(le=0;le<Ze;le++)St[le]/=Ft;this.centroids[ft]=St}else this.centroids[ft]=this.randomCentroid(),Bt=!0}}return this.getClusters()},pe.prototype.randomCentroid=function(){var yt,b,wt=this.dataset.length-1;do{b=Math.round(Math.random()*wt),yt=this.dataset[b]}while(this.centroids.indexOf(yt)>=0);return yt},pe.prototype.assign=function(){for(var b,wt=!1,yt=this.dataset.length,v=0;v<yt;v++)(b=this.argmin(this.dataset[v],this.centroids,this.distance))!=this.assignments[v]&&(this.assignments[v]=b,wt=!0);return wt},pe.prototype.getClusters=function(){for(var yt,wt=new Array(this.k),b=0;b<this.assignments.length;b++)void 0===wt[yt=this.assignments[b]]&&(wt[yt]=[]),wt[yt].push(b);return wt},pe.prototype.argmin=function(wt,yt,b){for(var St,v=Number.MAX_VALUE,Bt=0,ft=yt.length,Ft=0;Ft<ft;Ft++)(St=b(wt,yt[Ft]))<v&&(v=St,Bt=Ft);return Bt},pe.prototype.distance=function(wt,yt){for(var b=0,v=Math.min(wt.length,yt.length);v--;){var Bt=wt[v]-yt[v];b+=Bt*Bt}return Math.sqrt(b)},He.exports&&(He.exports=pe)},5e3:(He,pe,wt)=>{if(He.exports)var yt=wt(571);function b(v,Bt,ft,St){this.epsilon=1,this.minPts=1,this.distance=this._euclideanDistance,this._reachability=[],this._processed=[],this._coreDistance=0,this._orderedList=[],this._init(v,Bt,ft,St)}b.prototype.run=function(v,Bt,ft,St){this._init(v,Bt,ft,St);for(var Ft=0,le=this.dataset.length;Ft<le;Ft++)if(1!==this._processed[Ft]){this._processed[Ft]=1,this.clusters.push([Ft]);var kt=this.clusters.length-1;this._orderedList.push(Ft);var Ze=new yt(null,null,"asc"),ye=this._regionQuery(Ft);void 0!==this._distanceToCore(Ft)&&(this._updateQueue(Ft,ye,Ze),this._expandCluster(kt,Ze))}return this.clusters},b.prototype.getReachabilityPlot=function(){for(var v=[],Bt=0,ft=this._orderedList.length;Bt<ft;Bt++){var St=this._orderedList[Bt];v.push([St,this._reachability[St]])}return v},b.prototype._init=function(v,Bt,ft,St){if(v){if(!(v instanceof Array))throw Error("Dataset must be of type array, "+typeof v+" given");this.dataset=v,this.clusters=[],this._reachability=new Array(this.dataset.length),this._processed=new Array(this.dataset.length),this._coreDistance=0,this._orderedList=[]}Bt&&(this.epsilon=Bt),ft&&(this.minPts=ft),St&&(this.distance=St)},b.prototype._updateQueue=function(v,Bt,ft){var St=this;this._coreDistance=this._distanceToCore(v),Bt.forEach(function(Ft){if(void 0===St._processed[Ft]){var le=St.distance(St.dataset[v],St.dataset[Ft]),kt=Math.max(St._coreDistance,le);void 0===St._reachability[Ft]?(St._reachability[Ft]=kt,ft.insert(Ft,kt)):kt<St._reachability[Ft]&&(St._reachability[Ft]=kt,ft.remove(Ft),ft.insert(Ft,kt))}})},b.prototype._expandCluster=function(v,Bt){for(var ft=Bt.getElements(),St=0,Ft=ft.length;St<Ft;St++){var le=ft[St];if(void 0===this._processed[le]){var kt=this._regionQuery(le);this._processed[le]=1,this.clusters[v].push(le),this._orderedList.push(le),void 0!==this._distanceToCore(le)&&(this._updateQueue(le,kt,Bt),this._expandCluster(v,Bt))}}},b.prototype._distanceToCore=function(v){for(var Bt=this.epsilon,ft=0;ft<Bt;ft++)if(this._regionQuery(v,ft).length>=this.minPts)return ft},b.prototype._regionQuery=function(v,Bt){Bt=Bt||this.epsilon;for(var ft=[],St=0,Ft=this.dataset.length;St<Ft;St++)this.distance(this.dataset[v],this.dataset[St])<Bt&&ft.push(St);return ft},b.prototype._euclideanDistance=function(v,Bt){for(var ft=0,St=Math.min(v.length,Bt.length);St--;)ft+=(v[St]-Bt[St])*(v[St]-Bt[St]);return Math.sqrt(ft)},He.exports&&(He.exports=b)},571:He=>{function pe(wt,yt,b){this._queue=[],this._priorities=[],this._sorting="desc",this._init(wt,yt,b)}pe.prototype.insert=function(wt,yt){for(var b=this._queue.length,v=b;v--;){var Bt=this._priorities[v];"desc"===this._sorting?yt>Bt&&(b=v):yt<Bt&&(b=v)}this._insertAt(wt,yt,b)},pe.prototype.remove=function(wt){for(var yt=this._queue.length;yt--;)if(wt===this._queue[yt]){this._queue.splice(yt,1),this._priorities.splice(yt,1);break}},pe.prototype.forEach=function(wt){this._queue.forEach(wt)},pe.prototype.getElements=function(){return this._queue},pe.prototype.getElementPriority=function(wt){return this._priorities[wt]},pe.prototype.getPriorities=function(){return this._priorities},pe.prototype.getElementsWithPriorities=function(){for(var wt=[],yt=0,b=this._queue.length;yt<b;yt++)wt.push([this._queue[yt],this._priorities[yt]]);return wt},pe.prototype._init=function(wt,yt,b){if(wt&&yt){if(this._queue=[],this._priorities=[],wt.length!==yt.length)throw new Error("Arrays must have the same length");for(var v=0;v<wt.length;v++)this.insert(wt[v],yt[v])}b&&(this._sorting=b)},pe.prototype._insertAt=function(wt,yt,b){this._queue.length===b?(this._queue.push(wt),this._priorities.push(yt)):(this._queue.splice(b,0,wt),this._priorities.splice(b,0,yt))},He.exports&&(He.exports=pe)},6882:(He,pe,wt)=>{He.exports&&(He.exports={DBSCAN:wt(5810),KMEANS:wt(1955),OPTICS:wt(5e3),PriorityQueue:wt(571)})},1604:He=>{"use strict";function pe(Et,ne,Pt){Pt=Pt||2;var Fe,wr,De,Xr,Er,Yr,Cr,Kt=ne&&ne.length,te=Kt?ne[0]*Pt:Et.length,vt=wt(Et,0,te,Pt,!0),Se=[];if(!vt||vt.next===vt.prev)return Se;if(Kt&&(vt=function(Et,ne,Pt,Kt){var vt,Se,De,te=[];for(vt=0,Se=ne.length;vt<Se;vt++)(De=wt(Et,ne[vt]*Kt,vt<Se-1?ne[vt+1]*Kt:Et.length,Kt,!1))===De.next&&(De.steiner=!0),te.push(qt(De));for(te.sort(le),vt=0;vt<te.length;vt++)Pt=yt(Pt=kt(te[vt],Pt),Pt.next);return Pt}(Et,ne,vt,Pt)),Et.length>80*Pt){Fe=De=Et[0],wr=Xr=Et[1];for(var Mr=Pt;Mr<te;Mr+=Pt)(Er=Et[Mr])<Fe&&(Fe=Er),(Yr=Et[Mr+1])<wr&&(wr=Yr),Er>De&&(De=Er),Yr>Xr&&(Xr=Yr);Cr=0!==(Cr=Math.max(De-Fe,Xr-wr))?1/Cr:0}return b(vt,Se,Pt,Fe,wr,Cr),Se}function wt(Et,ne,Pt,Kt,te){var vt,Se;if(te===Te(Et,ne,Pt,Kt)>0)for(vt=ne;vt<Pt;vt+=Kt)Se=Ot(vt,Et[vt],Et[vt+1],Se);else for(vt=Pt-Kt;vt>=ne;vt-=Kt)Se=Ot(vt,Et[vt],Et[vt+1],Se);return Se&&Q(Se,Se.next)&&(at(Se),Se=Se.next),Se}function yt(Et,ne){if(!Et)return Et;ne||(ne=Et);var Kt,Pt=Et;do{if(Kt=!1,Pt.steiner||!Q(Pt,Pt.next)&&0!==J(Pt.prev,Pt,Pt.next))Pt=Pt.next;else{if(at(Pt),(Pt=ne=Pt.prev)===Pt.next)break;Kt=!0}}while(Kt||Pt!==ne);return ne}function b(Et,ne,Pt,Kt,te,vt,Se){if(Et){!Se&&vt&&function(Et,ne,Pt,Kt){var te=Et;do{null===te.z&&(te.z=Ye(te.x,te.y,ne,Pt,Kt)),te.prevZ=te.prev,te.nextZ=te.next,te=te.next}while(te!==Et);te.prevZ.nextZ=null,te.prevZ=null,function(Et){var ne,Pt,Kt,te,vt,Se,Fe,wr,De=1;do{for(Pt=Et,Et=null,vt=null,Se=0;Pt;){for(Se++,Kt=Pt,Fe=0,ne=0;ne<De&&(Fe++,Kt=Kt.nextZ);ne++);for(wr=De;Fe>0||wr>0&&Kt;)0!==Fe&&(0===wr||!Kt||Pt.z<=Kt.z)?(te=Pt,Pt=Pt.nextZ,Fe--):(te=Kt,Kt=Kt.nextZ,wr--),vt?vt.nextZ=te:Et=te,te.prevZ=vt,vt=te;Pt=Kt}vt.nextZ=null,De*=2}while(Se>1)}(te)}(Et,Kt,te,vt);for(var wr,De,Fe=Et;Et.prev!==Et.next;)if(wr=Et.prev,De=Et.next,vt?Bt(Et,Kt,te,vt):v(Et))ne.push(wr.i/Pt),ne.push(Et.i/Pt),ne.push(De.i/Pt),at(Et),Et=De.next,Fe=De.next;else if((Et=De)===Fe){Se?1===Se?b(Et=ft(yt(Et),ne,Pt),ne,Pt,Kt,te,vt,2):2===Se&&St(Et,ne,Pt,Kt,te,vt):b(yt(Et),ne,Pt,Kt,te,vt,1);break}}}function v(Et){var ne=Et.prev,Pt=Et,Kt=Et.next;if(J(ne,Pt,Kt)>=0)return!1;for(var te=Et.next.next;te!==Et.prev;){if(Qt(ne.x,ne.y,Pt.x,Pt.y,Kt.x,Kt.y,te.x,te.y)&&J(te.prev,te,te.next)>=0)return!1;te=te.next}return!0}function Bt(Et,ne,Pt,Kt){var te=Et.prev,vt=Et,Se=Et.next;if(J(te,vt,Se)>=0)return!1;for(var De=te.x>vt.x?te.x>Se.x?te.x:Se.x:vt.x>Se.x?vt.x:Se.x,Xr=te.y>vt.y?te.y>Se.y?te.y:Se.y:vt.y>Se.y?vt.y:Se.y,Er=Ye(te.x<vt.x?te.x<Se.x?te.x:Se.x:vt.x<Se.x?vt.x:Se.x,te.y<vt.y?te.y<Se.y?te.y:Se.y:vt.y<Se.y?vt.y:Se.y,ne,Pt,Kt),Yr=Ye(De,Xr,ne,Pt,Kt),Cr=Et.prevZ,Mr=Et.nextZ;Cr&&Cr.z>=Er&&Mr&&Mr.z<=Yr;){if(Cr!==Et.prev&&Cr!==Et.next&&Qt(te.x,te.y,vt.x,vt.y,Se.x,Se.y,Cr.x,Cr.y)&&J(Cr.prev,Cr,Cr.next)>=0||(Cr=Cr.prevZ,Mr!==Et.prev&&Mr!==Et.next&&Qt(te.x,te.y,vt.x,vt.y,Se.x,Se.y,Mr.x,Mr.y)&&J(Mr.prev,Mr,Mr.next)>=0))return!1;Mr=Mr.nextZ}for(;Cr&&Cr.z>=Er;){if(Cr!==Et.prev&&Cr!==Et.next&&Qt(te.x,te.y,vt.x,vt.y,Se.x,Se.y,Cr.x,Cr.y)&&J(Cr.prev,Cr,Cr.next)>=0)return!1;Cr=Cr.prevZ}for(;Mr&&Mr.z<=Yr;){if(Mr!==Et.prev&&Mr!==Et.next&&Qt(te.x,te.y,vt.x,vt.y,Se.x,Se.y,Mr.x,Mr.y)&&J(Mr.prev,Mr,Mr.next)>=0)return!1;Mr=Mr.nextZ}return!0}function ft(Et,ne,Pt){var Kt=Et;do{var te=Kt.prev,vt=Kt.next.next;!Q(te,vt)&&bt(te,Kt,Kt.next,vt)&&j(te,vt)&&j(vt,te)&&(ne.push(te.i/Pt),ne.push(Kt.i/Pt),ne.push(vt.i/Pt),at(Kt),at(Kt.next),Kt=Et=vt),Kt=Kt.next}while(Kt!==Et);return yt(Kt)}function St(Et,ne,Pt,Kt,te,vt){var Se=Et;do{for(var Fe=Se.next.next;Fe!==Se.prev;){if(Se.i!==Fe.i&&X(Se,Fe)){var wr=xt(Se,Fe);return Se=yt(Se,Se.next),wr=yt(wr,wr.next),b(Se,ne,Pt,Kt,te,vt),void b(wr,ne,Pt,Kt,te,vt)}Fe=Fe.next}Se=Se.next}while(Se!==Et)}function le(Et,ne){return Et.x-ne.x}function kt(Et,ne){var Pt=function(Et,ne){var Se,Pt=ne,Kt=Et.x,te=Et.y,vt=-1/0;do{if(te<=Pt.y&&te>=Pt.next.y&&Pt.next.y!==Pt.y){var Fe=Pt.x+(te-Pt.y)*(Pt.next.x-Pt.x)/(Pt.next.y-Pt.y);if(Fe<=Kt&&Fe>vt){if(vt=Fe,Fe===Kt){if(te===Pt.y)return Pt;if(te===Pt.next.y)return Pt.next}Se=Pt.x<Pt.next.x?Pt:Pt.next}}Pt=Pt.next}while(Pt!==ne);if(!Se)return null;if(Kt===vt)return Se;var Yr,wr=Se,De=Se.x,Xr=Se.y,Er=1/0;Pt=Se;do{Kt>=Pt.x&&Pt.x>=De&&Kt!==Pt.x&&Qt(te<Xr?Kt:vt,te,De,Xr,te<Xr?vt:Kt,te,Pt.x,Pt.y)&&(Yr=Math.abs(te-Pt.y)/(Kt-Pt.x),j(Pt,Et)&&(Yr<Er||Yr===Er&&(Pt.x>Se.x||Pt.x===Se.x&&ye(Se,Pt)))&&(Se=Pt,Er=Yr)),Pt=Pt.next}while(Pt!==wr);return Se}(Et,ne);if(!Pt)return ne;var Kt=xt(Pt,Et),te=yt(Pt,Pt.next);return yt(Kt,Kt.next),ne===Pt?te:ne}function ye(Et,ne){return J(Et.prev,Et,ne.prev)<0&&J(ne.next,Et,Et.next)<0}function Ye(Et,ne,Pt,Kt,te){return(Et=1431655765&((Et=858993459&((Et=252645135&((Et=16711935&((Et=32767*(Et-Pt)*te)|Et<<8))|Et<<4))|Et<<2))|Et<<1))|(ne=1431655765&((ne=858993459&((ne=252645135&((ne=16711935&((ne=32767*(ne-Kt)*te)|ne<<8))|ne<<4))|ne<<2))|ne<<1))<<1}function qt(Et){var ne=Et,Pt=Et;do{(ne.x<Pt.x||ne.x===Pt.x&&ne.y<Pt.y)&&(Pt=ne),ne=ne.next}while(ne!==Et);return Pt}function Qt(Et,ne,Pt,Kt,te,vt,Se,Fe){return(te-Se)*(ne-Fe)-(Et-Se)*(vt-Fe)>=0&&(Et-Se)*(Kt-Fe)-(Pt-Se)*(ne-Fe)>=0&&(Pt-Se)*(vt-Fe)-(te-Se)*(Kt-Fe)>=0}function X(Et,ne){return Et.next.i!==ne.i&&Et.prev.i!==ne.i&&!function(Et,ne){var Pt=Et;do{if(Pt.i!==Et.i&&Pt.next.i!==Et.i&&Pt.i!==ne.i&&Pt.next.i!==ne.i&&bt(Pt,Pt.next,Et,ne))return!0;Pt=Pt.next}while(Pt!==Et);return!1}(Et,ne)&&(j(Et,ne)&&j(ne,Et)&&function(Et,ne){var Pt=Et,Kt=!1,te=(Et.x+ne.x)/2,vt=(Et.y+ne.y)/2;do{Pt.y>vt!=Pt.next.y>vt&&Pt.next.y!==Pt.y&&te<(Pt.next.x-Pt.x)*(vt-Pt.y)/(Pt.next.y-Pt.y)+Pt.x&&(Kt=!Kt),Pt=Pt.next}while(Pt!==Et);return Kt}(Et,ne)&&(J(Et.prev,Et,ne.prev)||J(Et,ne.prev,ne))||Q(Et,ne)&&J(Et.prev,Et,Et.next)>0&&J(ne.prev,ne,ne.next)>0)}function J(Et,ne,Pt){return(ne.y-Et.y)*(Pt.x-ne.x)-(ne.x-Et.x)*(Pt.y-ne.y)}function Q(Et,ne){return Et.x===ne.x&&Et.y===ne.y}function bt(Et,ne,Pt,Kt){var te=tt(J(Et,ne,Pt)),vt=tt(J(Et,ne,Kt)),Se=tt(J(Pt,Kt,Et)),Fe=tt(J(Pt,Kt,ne));return!!(te!==vt&&Se!==Fe||0===te&&et(Et,Pt,ne)||0===vt&&et(Et,Kt,ne)||0===Se&&et(Pt,Et,Kt)||0===Fe&&et(Pt,ne,Kt))}function et(Et,ne,Pt){return ne.x<=Math.max(Et.x,Pt.x)&&ne.x>=Math.min(Et.x,Pt.x)&&ne.y<=Math.max(Et.y,Pt.y)&&ne.y>=Math.min(Et.y,Pt.y)}function tt(Et){return Et>0?1:Et<0?-1:0}function j(Et,ne){return J(Et.prev,Et,Et.next)<0?J(Et,ne,Et.next)>=0&&J(Et,Et.prev,ne)>=0:J(Et,ne,Et.prev)<0||J(Et,Et.next,ne)<0}function xt(Et,ne){var Pt=new ke(Et.i,Et.x,Et.y),Kt=new ke(ne.i,ne.x,ne.y),te=Et.next,vt=ne.prev;return Et.next=ne,ne.prev=Et,Pt.next=te,te.prev=Pt,Kt.next=Pt,Pt.prev=Kt,vt.next=Kt,Kt.prev=vt,Kt}function Ot(Et,ne,Pt,Kt){var te=new ke(Et,ne,Pt);return Kt?(te.next=Kt.next,te.prev=Kt,Kt.next.prev=te,Kt.next=te):(te.prev=te,te.next=te),te}function at(Et){Et.next.prev=Et.prev,Et.prev.next=Et.next,Et.prevZ&&(Et.prevZ.nextZ=Et.nextZ),Et.nextZ&&(Et.nextZ.prevZ=Et.prevZ)}function ke(Et,ne,Pt){this.i=Et,this.x=ne,this.y=Pt,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Te(Et,ne,Pt,Kt){for(var te=0,vt=ne,Se=Pt-Kt;vt<Pt;vt+=Kt)te+=(Et[Se]-Et[vt])*(Et[vt+1]+Et[Se+1]),Se=vt;return te}He.exports=pe,He.exports.default=pe,pe.deviation=function(Et,ne,Pt,Kt){var te=ne&&ne.length,Se=Math.abs(Te(Et,0,te?ne[0]*Pt:Et.length,Pt));if(te)for(var Fe=0,wr=ne.length;Fe<wr;Fe++)Se-=Math.abs(Te(Et,ne[Fe]*Pt,Fe<wr-1?ne[Fe+1]*Pt:Et.length,Pt));var Er=0;for(Fe=0;Fe<Kt.length;Fe+=3){var Yr=Kt[Fe]*Pt,Cr=Kt[Fe+1]*Pt,Mr=Kt[Fe+2]*Pt;Er+=Math.abs((Et[Yr]-Et[Mr])*(Et[Cr+1]-Et[Yr+1])-(Et[Yr]-Et[Cr])*(Et[Mr+1]-Et[Yr+1]))}return 0===Se&&0===Er?0:Math.abs((Er-Se)/Se)},pe.flatten=function(Et){for(var ne=Et[0][0].length,Pt={vertices:[],holes:[],dimensions:ne},Kt=0,te=0;te<Et.length;te++){for(var vt=0;vt<Et[te].length;vt++)for(var Se=0;Se<ne;Se++)Pt.vertices.push(Et[te][vt][Se]);te>0&&Pt.holes.push(Kt+=Et[te-1].length)}return Pt}},1609:He=>{"use strict";var pe="Function.prototype.bind called on incompatible ",wt=Array.prototype.slice,yt=Object.prototype.toString,b="[object Function]";He.exports=function(Bt){var ft=this;if("function"!=typeof ft||yt.call(ft)!==b)throw new TypeError(pe+ft);for(var Ft,St=wt.call(arguments,1),le=function(){if(this instanceof Ft){var de=ft.apply(this,St.concat(wt.call(arguments)));return Object(de)===de?de:this}return ft.apply(Bt,St.concat(wt.call(arguments)))},kt=Math.max(0,ft.length-St.length),Ze=[],ye=0;ye<kt;ye++)Ze.push("$"+ye);if(Ft=Function("binder","return function ("+Ze.join(",")+"){ return binder.apply(this,arguments); }")(le),ft.prototype){var ue=function(){};ue.prototype=ft.prototype,Ft.prototype=new ue,ue.prototype=null}return Ft}},5396:(He,pe,wt)=>{"use strict";var yt=wt(1609);He.exports=Function.prototype.bind||yt},9331:(He,pe,wt)=>{var yt=wt(2978),b=function(St){this.precision=St&&St.precision?St.precision:17,this.direction=!(!St||!St.direction)&&St.direction,this.pseudoNode=!(!St||!St.pseudoNode)&&St.pseudoNode,this.objectComparator=St&&St.objectComparator?St.objectComparator:ft};function v(St){return St.coordinates.map(function(Ft){return{type:St.type.replace("Multi",""),coordinates:Ft}})}function Bt(St,Ft){return St.hasOwnProperty("coordinates")?St.coordinates.length===Ft.coordinates.length:St.length===Ft.length}function ft(St,Ft){return yt(St,Ft,{strict:!0})}b.prototype.compare=function(St,Ft){if(St.type!==Ft.type||!Bt(St,Ft))return!1;switch(St.type){case"Point":return this.compareCoord(St.coordinates,Ft.coordinates);case"LineString":return this.compareLine(St.coordinates,Ft.coordinates,0,!1);case"Polygon":return this.comparePolygon(St,Ft);case"Feature":return this.compareFeature(St,Ft);default:if(0===St.type.indexOf("Multi")){var le=this,kt=v(St),Ze=v(Ft);return kt.every(function(ye){return this.some(function(ue){return le.compare(ye,ue)})},Ze)}}return!1},b.prototype.compareCoord=function(St,Ft){if(St.length!==Ft.length)return!1;for(var le=0;le<St.length;le++)if(St[le].toFixed(this.precision)!==Ft[le].toFixed(this.precision))return!1;return!0},b.prototype.compareLine=function(St,Ft,le,kt){if(!Bt(St,Ft))return!1;var Ze=this.pseudoNode?St:this.removePseudo(St),ye=this.pseudoNode?Ft:this.removePseudo(Ft);if(!kt||this.compareCoord(Ze[0],ye[0])||(ye=this.fixStartIndex(ye,Ze))){var ue=this.compareCoord(Ze[le],ye[le]);return this.direction||ue?this.comparePath(Ze,ye):!!this.compareCoord(Ze[le],ye[ye.length-(1+le)])&&this.comparePath(Ze.slice().reverse(),ye)}},b.prototype.fixStartIndex=function(St,Ft){for(var le,kt=-1,Ze=0;Ze<St.length;Ze++)if(this.compareCoord(St[Ze],Ft[0])){kt=Ze;break}return kt>=0&&(le=[].concat(St.slice(kt,St.length),St.slice(1,kt+1))),le},b.prototype.comparePath=function(St,Ft){var le=this;return St.every(function(kt,Ze){return le.compareCoord(kt,this[Ze])},Ft)},b.prototype.comparePolygon=function(St,Ft){if(this.compareLine(St.coordinates[0],Ft.coordinates[0],1,!0)){var le=St.coordinates.slice(1,St.coordinates.length),kt=Ft.coordinates.slice(1,Ft.coordinates.length),Ze=this;return le.every(function(ye){return this.some(function(ue){return Ze.compareLine(ye,ue,1,!0)})},kt)}return!1},b.prototype.compareFeature=function(St,Ft){return!(St.id!==Ft.id||!this.objectComparator(St.properties,Ft.properties)||!this.compareBBox(St,Ft))&&this.compare(St.geometry,Ft.geometry)},b.prototype.compareBBox=function(St,Ft){return!!(!St.bbox&&!Ft.bbox||St.bbox&&Ft.bbox&&this.compareCoord(St.bbox,Ft.bbox))},b.prototype.removePseudo=function(St){return St},He.exports=b},2689:(He,pe,wt)=>{var yt=wt(3036),b=wt(8410),v=wt(3033),Bt=wt(185).Z,ft=v.featureEach,le=b.featureCollection;function kt(Ze){var ye=new yt(Ze);return ye.insert=function(ue){if("Feature"!==ue.type)throw new Error("invalid feature");return ue.bbox=ue.bbox?ue.bbox:Bt(ue),yt.prototype.insert.call(this,ue)},ye.load=function(ue){var de=[];return Array.isArray(ue)?ue.forEach(function(Ye){if("Feature"!==Ye.type)throw new Error("invalid features");Ye.bbox=Ye.bbox?Ye.bbox:Bt(Ye),de.push(Ye)}):ft(ue,function(Ye){if("Feature"!==Ye.type)throw new Error("invalid features");Ye.bbox=Ye.bbox?Ye.bbox:Bt(Ye),de.push(Ye)}),yt.prototype.load.call(this,de)},ye.remove=function(ue,de){if("Feature"!==ue.type)throw new Error("invalid feature");return ue.bbox=ue.bbox?ue.bbox:Bt(ue),yt.prototype.remove.call(this,ue,de)},ye.clear=function(){return yt.prototype.clear.call(this)},ye.search=function(ue){var de=yt.prototype.search.call(this,this.toBBox(ue));return le(de)},ye.collides=function(ue){return yt.prototype.collides.call(this,this.toBBox(ue))},ye.all=function(){var ue=yt.prototype.all.call(this);return le(ue)},ye.toJSON=function(){return yt.prototype.toJSON.call(this)},ye.fromJSON=function(ue){return yt.prototype.fromJSON.call(this,ue)},ye.toBBox=function(ue){var de;if(ue.bbox)de=ue.bbox;else if(Array.isArray(ue)&&4===ue.length)de=ue;else if(Array.isArray(ue)&&6===ue.length)de=[ue[0],ue[1],ue[3],ue[4]];else if("Feature"===ue.type)de=Bt(ue);else{if("FeatureCollection"!==ue.type)throw new Error("invalid geojson");de=Bt(ue)}return{minX:de[0],minY:de[1],maxX:de[2],maxY:de[3]}},ye}He.exports=kt,He.exports.default=kt},8540:(He,pe,wt)=>{"use strict";var yt,b=SyntaxError,v=Function,Bt=TypeError,ft=function(xt){try{return v('"use strict"; return ('+xt+").constructor;")()}catch(Ot){}},St=Object.getOwnPropertyDescriptor;if(St)try{St({},"")}catch(xt){St=null}var Ft=function(){throw new Bt},le=St?function(){try{return Ft}catch(xt){try{return St(arguments,"callee").get}catch(Ot){return Ft}}}():Ft,kt=wt(9326)(),Ze=Object.getPrototypeOf||function(xt){return xt.__proto__},ye={},ue="undefined"==typeof Uint8Array?yt:Ze(Uint8Array),de={"%AggregateError%":"undefined"==typeof AggregateError?yt:AggregateError,"%Array%":Array,"%ArrayBuffer%":"undefined"==typeof ArrayBuffer?yt:ArrayBuffer,"%ArrayIteratorPrototype%":kt?Ze([][Symbol.iterator]()):yt,"%AsyncFromSyncIteratorPrototype%":yt,"%AsyncFunction%":ye,"%AsyncGenerator%":ye,"%AsyncGeneratorFunction%":ye,"%AsyncIteratorPrototype%":ye,"%Atomics%":"undefined"==typeof Atomics?yt:Atomics,"%BigInt%":"undefined"==typeof BigInt?yt:BigInt,"%Boolean%":Boolean,"%DataView%":"undefined"==typeof DataView?yt:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":Error,"%eval%":eval,"%EvalError%":EvalError,"%Float32Array%":"undefined"==typeof Float32Array?yt:Float32Array,"%Float64Array%":"undefined"==typeof Float64Array?yt:Float64Array,"%FinalizationRegistry%":"undefined"==typeof FinalizationRegistry?yt:FinalizationRegistry,"%Function%":v,"%GeneratorFunction%":ye,"%Int8Array%":"undefined"==typeof Int8Array?yt:Int8Array,"%Int16Array%":"undefined"==typeof Int16Array?yt:Int16Array,"%Int32Array%":"undefined"==typeof Int32Array?yt:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":kt?Ze(Ze([][Symbol.iterator]())):yt,"%JSON%":"object"==typeof JSON?JSON:yt,"%Map%":"undefined"==typeof Map?yt:Map,"%MapIteratorPrototype%":"undefined"!=typeof Map&&kt?Ze((new Map)[Symbol.iterator]()):yt,"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":"undefined"==typeof Promise?yt:Promise,"%Proxy%":"undefined"==typeof Proxy?yt:Proxy,"%RangeError%":RangeError,"%ReferenceError%":ReferenceError,"%Reflect%":"undefined"==typeof Reflect?yt:Reflect,"%RegExp%":RegExp,"%Set%":"undefined"==typeof Set?yt:Set,"%SetIteratorPrototype%":"undefined"!=typeof Set&&kt?Ze((new Set)[Symbol.iterator]()):yt,"%SharedArrayBuffer%":"undefined"==typeof SharedArrayBuffer?yt:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":kt?Ze(""[Symbol.iterator]()):yt,"%Symbol%":kt?Symbol:yt,"%SyntaxError%":b,"%ThrowTypeError%":le,"%TypedArray%":ue,"%TypeError%":Bt,"%Uint8Array%":"undefined"==typeof Uint8Array?yt:Uint8Array,"%Uint8ClampedArray%":"undefined"==typeof Uint8ClampedArray?yt:Uint8ClampedArray,"%Uint16Array%":"undefined"==typeof Uint16Array?yt:Uint16Array,"%Uint32Array%":"undefined"==typeof Uint32Array?yt:Uint32Array,"%URIError%":URIError,"%WeakMap%":"undefined"==typeof WeakMap?yt:WeakMap,"%WeakRef%":"undefined"==typeof WeakRef?yt:WeakRef,"%WeakSet%":"undefined"==typeof WeakSet?yt:WeakSet},Ye=function xt(Ot){var at;if("%AsyncFunction%"===Ot)at=ft("async function () {}");else if("%GeneratorFunction%"===Ot)at=ft("function* () {}");else if("%AsyncGeneratorFunction%"===Ot)at=ft("async function* () {}");else if("%AsyncGenerator%"===Ot){var ke=xt("%AsyncGeneratorFunction%");ke&&(at=ke.prototype)}else if("%AsyncIteratorPrototype%"===Ot){var Te=xt("%AsyncGenerator%");Te&&(at=Ze(Te.prototype))}return de[Ot]=at,at},qt={"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},Qt=wt(5396),X=wt(7709),J=Qt.call(Function.call,Array.prototype.concat),Q=Qt.call(Function.apply,Array.prototype.splice),bt=Qt.call(Function.call,String.prototype.replace),et=Qt.call(Function.call,String.prototype.slice),tt=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,lt=/\\(\\)?/g,j=function(Ot){var at=et(Ot,0,1),ke=et(Ot,-1);if("%"===at&&"%"!==ke)throw new b("invalid intrinsic syntax, expected closing `%`");if("%"===ke&&"%"!==at)throw new b("invalid intrinsic syntax, expected opening `%`");var Te=[];return bt(Ot,tt,function(Et,ne,Pt,Kt){Te[Te.length]=Pt?bt(Kt,lt,"$1"):ne||Et}),Te},re=function(Ot,at){var Te,ke=Ot;if(X(qt,ke)&&(ke="%"+(Te=qt[ke])[0]+"%"),X(de,ke)){var Et=de[ke];if(Et===ye&&(Et=Ye(ke)),void 0===Et&&!at)throw new Bt("intrinsic "+Ot+" exists, but is not available. Please file an issue!");return{alias:Te,name:ke,value:Et}}throw new b("intrinsic "+Ot+" does not exist!")};He.exports=function(Ot,at){if("string"!=typeof Ot||0===Ot.length)throw new Bt("intrinsic name must be a non-empty string");if(arguments.length>1&&"boolean"!=typeof at)throw new Bt('"allowMissing" argument must be a boolean');var ke=j(Ot),Te=ke.length>0?ke[0]:"",Et=re("%"+Te+"%",at),ne=Et.name,Pt=Et.value,Kt=!1,te=Et.alias;te&&(Te=te[0],Q(ke,J([0,1],te)));for(var vt=1,Se=!0;vt<ke.length;vt+=1){var Fe=ke[vt],wr=et(Fe,0,1),De=et(Fe,-1);if(('"'===wr||"'"===wr||"`"===wr||'"'===De||"'"===De||"`"===De)&&wr!==De)throw new b("property names with quotes must have matching quotes");if(("constructor"===Fe||!Se)&&(Kt=!0),X(de,ne="%"+(Te+="."+Fe)+"%"))Pt=de[ne];else if(null!=Pt){if(!(Fe in Pt)){if(!at)throw new Bt("base intrinsic for "+Ot+" exists, but the property is not available.");return}if(St&&vt+1>=ke.length){var Xr=St(Pt,Fe);Pt=(Se=!!Xr)&&"get"in Xr&&!("originalValue"in Xr.get)?Xr.get:Pt[Fe]}else Se=X(Pt,Fe),Pt=Pt[Fe];Se&&!Kt&&(de[ne]=Pt)}}return Pt}},9326:(He,pe,wt)=>{"use strict";var yt="undefined"!=typeof Symbol&&Symbol,b=wt(9045);He.exports=function(){return"function"==typeof yt&&"function"==typeof Symbol&&"symbol"==typeof yt("foo")&&"symbol"==typeof Symbol("bar")&&b()}},9045:He=>{"use strict";He.exports=function(){if("function"!=typeof Symbol||"function"!=typeof Object.getOwnPropertySymbols)return!1;if("symbol"==typeof Symbol.iterator)return!0;var wt={},yt=Symbol("test"),b=Object(yt);if("string"==typeof yt||"[object Symbol]"!==Object.prototype.toString.call(yt)||"[object Symbol]"!==Object.prototype.toString.call(b))return!1;for(yt in wt[yt]=42,wt)return!1;if("function"==typeof Object.keys&&0!==Object.keys(wt).length||"function"==typeof Object.getOwnPropertyNames&&0!==Object.getOwnPropertyNames(wt).length)return!1;var Bt=Object.getOwnPropertySymbols(wt);if(1!==Bt.length||Bt[0]!==yt||!Object.prototype.propertyIsEnumerable.call(wt,yt))return!1;if("function"==typeof Object.getOwnPropertyDescriptor){var ft=Object.getOwnPropertyDescriptor(wt,yt);if(42!==ft.value||!0!==ft.enumerable)return!1}return!0}},1407:(He,pe,wt)=>{"use strict";var yt=wt(9045);He.exports=function(){return yt()&&!!Symbol.toStringTag}},7709:(He,pe,wt)=>{"use strict";var yt=wt(5396);He.exports=yt.call(Function.call,Object.prototype.hasOwnProperty)},7316:(He,pe,wt)=>{"use strict";var yt=wt(1407)(),v=wt(9568)("Object.prototype.toString"),Bt=function(le){return!(yt&&le&&"object"==typeof le&&Symbol.toStringTag in le)&&"[object Arguments]"===v(le)},ft=function(le){return!!Bt(le)||null!==le&&"object"==typeof le&&"number"==typeof le.length&&le.length>=0&&"[object Array]"!==v(le)&&"[object Function]"===v(le.callee)},St=function(){return Bt(arguments)}();Bt.isLegacyArguments=ft,He.exports=St?Bt:ft},3105:(He,pe,wt)=>{"use strict";var yt=Date.prototype.getDay,v=Object.prototype.toString,ft=wt(1407)();He.exports=function(Ft){return"object"==typeof Ft&&null!==Ft&&(ft?function(Ft){try{return yt.call(Ft),!0}catch(le){return!1}}(Ft):"[object Date]"===v.call(Ft))}},5544:(He,pe,wt)=>{"use strict";var v,Bt,ft,St,yt=wt(9568),b=wt(1407)();if(b){v=yt("Object.prototype.hasOwnProperty"),Bt=yt("RegExp.prototype.exec"),ft={};var Ft=function(){throw ft};St={toString:Ft,valueOf:Ft},"symbol"==typeof Symbol.toPrimitive&&(St[Symbol.toPrimitive]=Ft)}var le=yt("Object.prototype.toString"),kt=Object.getOwnPropertyDescriptor;He.exports=b?function(ue){if(!ue||"object"!=typeof ue)return!1;var de=kt(ue,"lastIndex");if(!de||!v(de,"value"))return!1;try{Bt(ue,St)}catch(qt){return qt===ft}}:function(ue){return!(!ue||"object"!=typeof ue&&"function"!=typeof ue)&&"[object RegExp]"===le(ue)}},4347:function(He){He.exports=function(){"use strict";var pe,wt,yt;function b(v,Bt){if(pe)if(wt){var ft="var sharedChunk = {}; ("+pe+")(sharedChunk); ("+wt+")(sharedChunk);",St={};pe(St),yt=Bt(St),"undefined"!=typeof window&&(yt.workerUrl=window.URL.createObjectURL(new Blob([ft],{type:"text/javascript"})))}else wt=Bt;else pe=Bt}return b(0,function(v){function Bt(t,i){return t(i={exports:{}},i.exports),i.exports}var ft=St;function St(t,i,u,g){this.cx=3*t,this.bx=3*(u-t)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*i,this.by=3*(g-i)-this.cy,this.ay=1-this.cy-this.by,this.p1x=t,this.p1y=g,this.p2x=u,this.p2y=g}St.prototype.sampleCurveX=function(t){return((this.ax*t+this.bx)*t+this.cx)*t},St.prototype.sampleCurveY=function(t){return((this.ay*t+this.by)*t+this.cy)*t},St.prototype.sampleCurveDerivativeX=function(t){return(3*this.ax*t+2*this.bx)*t+this.cx},St.prototype.solveCurveX=function(t,i){var u,g,_,E,P;for(void 0===i&&(i=1e-6),_=t,P=0;P<8;P++){if(E=this.sampleCurveX(_)-t,Math.abs(E)<i)return _;var A=this.sampleCurveDerivativeX(_);if(Math.abs(A)<1e-6)break;_-=E/A}if((_=t)<(u=0))return u;if(_>(g=1))return g;for(;u<g;){if(E=this.sampleCurveX(_),Math.abs(E-t)<i)return _;t>E?u=_:g=_,_=.5*(g-u)+u}return _},St.prototype.solve=function(t,i){return this.sampleCurveY(this.solveCurveX(t,i))};var Ft=le;function le(t,i){this.x=t,this.y=i}le.prototype={clone:function(){return new le(this.x,this.y)},add:function(t){return this.clone()._add(t)},sub:function(t){return this.clone()._sub(t)},multByPoint:function(t){return this.clone()._multByPoint(t)},divByPoint:function(t){return this.clone()._divByPoint(t)},mult:function(t){return this.clone()._mult(t)},div:function(t){return this.clone()._div(t)},rotate:function(t){return this.clone()._rotate(t)},rotateAround:function(t,i){return this.clone()._rotateAround(t,i)},matMult:function(t){return this.clone()._matMult(t)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(t){return this.x===t.x&&this.y===t.y},dist:function(t){return Math.sqrt(this.distSqr(t))},distSqr:function(t){var i=t.x-this.x,u=t.y-this.y;return i*i+u*u},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(t){return Math.atan2(this.y-t.y,this.x-t.x)},angleWith:function(t){return this.angleWithSep(t.x,t.y)},angleWithSep:function(t,i){return Math.atan2(this.x*i-this.y*t,this.x*t+this.y*i)},_matMult:function(t){var i=t[2]*this.x+t[3]*this.y;return this.x=t[0]*this.x+t[1]*this.y,this.y=i,this},_add:function(t){return this.x+=t.x,this.y+=t.y,this},_sub:function(t){return this.x-=t.x,this.y-=t.y,this},_mult:function(t){return this.x*=t,this.y*=t,this},_div:function(t){return this.x/=t,this.y/=t,this},_multByPoint:function(t){return this.x*=t.x,this.y*=t.y,this},_divByPoint:function(t){return this.x/=t.x,this.y/=t.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var t=this.y;return this.y=this.x,this.x=-t,this},_rotate:function(t){var i=Math.cos(t),u=Math.sin(t),g=u*this.x+i*this.y;return this.x=i*this.x-u*this.y,this.y=g,this},_rotateAround:function(t,i){var u=Math.cos(t),g=Math.sin(t),_=i.y+g*(this.x-i.x)+u*(this.y-i.y);return this.x=i.x+u*(this.x-i.x)-g*(this.y-i.y),this.y=_,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},le.convert=function(t){return t instanceof le?t:Array.isArray(t)?new le(t[0],t[1]):t};var kt="undefined"!=typeof self?self:{},Ze=Math.pow(2,53)-1;function ye(t,i,u,g){var _=new ft(t,i,u,g);return function(E){return _.solve(E)}}var ue=ye(.25,.1,.25,1);function de(t,i,u){return Math.min(u,Math.max(i,t))}function Ye(t,i,u){var g=u-i,_=((t-i)%g+g)%g+i;return _===i?u:_}function qt(t){for(var i=[],u=arguments.length-1;u-- >0;)i[u]=arguments[u+1];for(var g=0,_=i;g<_.length;g+=1){var E=_[g];for(var P in E)t[P]=E[P]}return t}var Qt=1;function X(){return Qt++}function J(){return function t(i){return i?(i^16*Math.random()>>i/4).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,t)}()}function Q(t){return!!t&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(t)}function bt(t,i){t.forEach(function(u){i[u]&&(i[u]=i[u].bind(i))})}function et(t,i){return-1!==t.indexOf(i,t.length-i.length)}function tt(t,i,u){var g={};for(var _ in t)g[_]=i.call(u||this,t[_],_,t);return g}function lt(t,i,u){var g={};for(var _ in t)i.call(u||this,t[_],_,t)&&(g[_]=t[_]);return g}function j(t){return Array.isArray(t)?t.map(j):"object"==typeof t&&t?tt(t,j):t}var re={};function xt(t){re[t]||("undefined"!=typeof console&&console.warn(t),re[t]=!0)}function Ot(t,i,u){return(u.y-t.y)*(i.x-t.x)>(i.y-t.y)*(u.x-t.x)}function at(t){for(var i=0,u=0,g=t.length,_=g-1,E=void 0,P=void 0;u<g;_=u++)i+=((P=t[_]).x-(E=t[u]).x)*(E.y+P.y);return i}function ke(){return"undefined"!=typeof WorkerGlobalScope&&"undefined"!=typeof self&&self instanceof WorkerGlobalScope}function Te(t){var i={};if(t.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,function(g,_,E,P){var A=E||P;return i[_]=!A||A.toLowerCase(),""}),i["max-age"]){var u=parseInt(i["max-age"],10);isNaN(u)?delete i["max-age"]:i["max-age"]=u}return i}var Et=null;function ne(t){if(null==Et){var i=t.navigator?t.navigator.userAgent:null;Et=!!t.safari||!(!i||!(/\b(iPad|iPhone|iPod)\b/.test(i)||i.match("Safari")&&!i.match("Chrome")))}return Et}function Pt(t){try{var i=kt[t];return i.setItem("_mapbox_test_",1),i.removeItem("_mapbox_test_"),!0}catch(u){return!1}}var Kt,te,vt,Se,Fe=kt.performance&&kt.performance.now?kt.performance.now.bind(kt.performance):Date.now.bind(Date),wr=kt.requestAnimationFrame||kt.mozRequestAnimationFrame||kt.webkitRequestAnimationFrame||kt.msRequestAnimationFrame,De=kt.cancelAnimationFrame||kt.mozCancelAnimationFrame||kt.webkitCancelAnimationFrame||kt.msCancelAnimationFrame,Xr={now:Fe,frame:function(t){var i=wr(t);return{cancel:function(){return De(i)}}},getImageData:function(t,i){void 0===i&&(i=0);var u=kt.document.createElement("canvas"),g=u.getContext("2d");if(!g)throw new Error("failed to create canvas 2d context");return u.width=t.width,u.height=t.height,g.drawImage(t,0,0,t.width,t.height),g.getImageData(-i,-i,t.width+2*i,t.height+2*i)},resolveURL:function(t){return Kt||(Kt=kt.document.createElement("a")),Kt.href=t,Kt.href},hardwareConcurrency:kt.navigator&&kt.navigator.hardwareConcurrency||4,get devicePixelRatio(){return kt.devicePixelRatio},get prefersReducedMotion(){return!!kt.matchMedia&&(null==te&&(te=kt.matchMedia("(prefers-reduced-motion: reduce)")),te.matches)}},Er={API_URL:"https://api.mapbox.com",get EVENTS_URL(){return this.API_URL?0===this.API_URL.indexOf("https://api.mapbox.cn")?"https://events.mapbox.cn/events/v2":0===this.API_URL.indexOf("https://api.mapbox.com")?"https://events.mapbox.com/events/v2":null:null},FEEDBACK_URL:"https://apps.mapbox.com/feedback",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16,REGISTERED_PROTOCOLS:{}},Yr={supported:!1,testSupport:function(t){!Cr&&Se&&(Mr?Be(t):vt=t)}},Cr=!1,Mr=!1;function Be(t){var i=t.createTexture();t.bindTexture(t.TEXTURE_2D,i);try{if(t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,Se),t.isContextLost())return;Yr.supported=!0}catch(u){}t.deleteTexture(i),Cr=!0}kt.document&&((Se=kt.document.createElement("img")).onload=function(){vt&&Be(vt),vt=null,Mr=!0},Se.onerror=function(){Cr=!0,vt=null},Se.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");var ti="01",In=function(t,i){this._transformRequestFn=t,this._customAccessToken=i,this._createSkuToken()};function $n(t){return 0===t.indexOf("mapbox:")}In.prototype._createSkuToken=function(){var t=function(){for(var i="",u=0;u<10;u++)i+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",ti,i].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=t.token,this._skuTokenExpiresAt=t.tokenExpiresAt},In.prototype._isSkuTokenExpired=function(){return Date.now()>this._skuTokenExpiresAt},In.prototype.transformRequest=function(t,i){return this._transformRequestFn&&this._transformRequestFn(t,i)||{url:t}},In.prototype.normalizeStyleURL=function(t,i){if(!$n(t))return t;var u=st(t);return u.path="/styles/v1"+u.path,this._makeAPIURL(u,this._customAccessToken||i)},In.prototype.normalizeGlyphsURL=function(t,i){if(!$n(t))return t;var u=st(t);return u.path="/fonts/v1"+u.path,this._makeAPIURL(u,this._customAccessToken||i)},In.prototype.normalizeSourceURL=function(t,i){if(!$n(t))return t;var u=st(t);return u.path="/v4/"+u.authority+".json",u.params.push("secure"),this._makeAPIURL(u,this._customAccessToken||i)},In.prototype.normalizeSpriteURL=function(t,i,u,g){var _=st(t);return $n(t)?(_.path="/styles/v1"+_.path+"/sprite"+i+u,this._makeAPIURL(_,this._customAccessToken||g)):(_.path+=""+i+u,rt(_))},In.prototype.normalizeTileURL=function(t,i){if(this._isSkuTokenExpired()&&this._createSkuToken(),t&&!$n(t))return t;var u=st(t);u.path=u.path.replace(/(\.(png|jpg)\d*)(?=$)/,(Xr.devicePixelRatio>=2||512===i?"@2x":"")+(Yr.supported?".webp":"$1")),u.path=u.path.replace(/^.+\/v4\//,"/"),u.path="/v4"+u.path;var g=this._customAccessToken||function(_){for(var E=0,P=_;E<P.length;E+=1){var A=P[E].match(/^access_token=(.*)$/);if(A)return A[1]}return null}(u.params)||Er.ACCESS_TOKEN;return Er.REQUIRE_ACCESS_TOKEN&&g&&this._skuToken&&u.params.push("sku="+this._skuToken),this._makeAPIURL(u,g)},In.prototype.canonicalizeTileURL=function(t,i){var u=st(t);if(!u.path.match(/(^\/v4\/)/)||!u.path.match(/\.[\w]+$/))return t;var g="mapbox://tiles/";g+=u.path.replace("/v4/","");var _=u.params;return i&&(_=_.filter(function(E){return!E.match(/^access_token=/)})),_.length&&(g+="?"+_.join("&")),g},In.prototype.canonicalizeTileset=function(t,i){for(var u=!!i&&$n(i),g=[],_=0,E=t.tiles||[];_<E.length;_+=1){var P=E[_];fi(P)?g.push(this.canonicalizeTileURL(P,u)):g.push(P)}return g},In.prototype._makeAPIURL=function(t,i){var u="See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes",g=st(Er.API_URL);if(t.protocol=g.protocol,t.authority=g.authority,"http"===t.protocol){var _=t.params.indexOf("secure");_>=0&&t.params.splice(_,1)}if("/"!==g.path&&(t.path=""+g.path+t.path),!Er.REQUIRE_ACCESS_TOKEN)return rt(t);if(!(i=i||Er.ACCESS_TOKEN))throw new Error("An API access token is required to use Mapbox GL. "+u);if("s"===i[0])throw new Error("Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). "+u);return t.params=t.params.filter(function(E){return-1===E.indexOf("access_token")}),t.params.push("access_token="+i),rt(t)},In.prototype.setTransformRequest=function(t){this._transformRequestFn=t};var li=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;function fi(t){return li.test(t)}var ae=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function st(t){var i=t.match(ae);if(!i)throw new Error("Unable to parse URL object");return{protocol:i[1],authority:i[2],path:i[3]||"/",params:i[4]?i[4].split("&"):[]}}function rt(t){var i=t.params.length?"?"+t.params.join("&"):"";return t.protocol+"://"+t.authority+t.path+i}function $(t){if(!t)return null;var i=t.split(".");if(!i||3!==i.length)return null;try{return JSON.parse(decodeURIComponent(kt.atob(i[1]).split("").map(function(u){return"%"+("00"+u.charCodeAt(0).toString(16)).slice(-2)}).join("")))}catch(u){return null}}var Tt=function(t){this.type=t,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null};Tt.prototype.getStorageKey=function(t){var i,u=$(Er.ACCESS_TOKEN);return i=u&&u.u?kt.btoa(encodeURIComponent(u.u).replace(/%([0-9A-F]{2})/g,function(g,_){return String.fromCharCode(Number("0x"+_))})):Er.ACCESS_TOKEN||"",t?"mapbox.eventData."+t+":"+i:"mapbox.eventData:"+i},Tt.prototype.fetchEventData=function(){var t=Pt("localStorage"),i=this.getStorageKey(),u=this.getStorageKey("uuid");if(t)try{var g=kt.localStorage.getItem(i);g&&(this.eventData=JSON.parse(g));var _=kt.localStorage.getItem(u);_&&(this.anonId=_)}catch(E){xt("Unable to read from LocalStorage")}},Tt.prototype.saveEventData=function(){var t=Pt("localStorage"),i=this.getStorageKey(),u=this.getStorageKey("uuid");if(t)try{kt.localStorage.setItem(u,this.anonId),Object.keys(this.eventData).length>=1&&kt.localStorage.setItem(i,JSON.stringify(this.eventData))}catch(g){xt("Unable to write to LocalStorage")}},Tt.prototype.processRequests=function(t){},Tt.prototype.postEvent=function(t,i,u,g){var _=this;if(Er.EVENTS_URL){var E=st(Er.EVENTS_URL);E.params.push("access_token="+(g||Er.ACCESS_TOKEN||""));var P={event:this.type,created:new Date(t).toISOString(),sdkIdentifier:"mapbox-gl-js",sdkVersion:"1.15.2",skuId:ti,userId:this.anonId},A=i?qt(P,i):P,F={url:rt(E),headers:{"Content-Type":"text/plain"},body:JSON.stringify([A])};this.pendingRequest=V(F,function(U){_.pendingRequest=null,u(U),_.saveEventData(),_.processRequests(g)})}},Tt.prototype.queueRequest=function(t,i){this.queue.push(t),this.processRequests(i)};var Jt,Ee,Ge=function(t){function i(){t.call(this,"map.load"),this.success={},this.skuToken=""}return t&&(i.__proto__=t),(i.prototype=Object.create(t&&t.prototype)).constructor=i,i.prototype.postMapLoadEvent=function(u,g,_,E){this.skuToken=_,(Er.EVENTS_URL&&E||Er.ACCESS_TOKEN&&Array.isArray(u)&&u.some(function(P){return $n(P)||fi(P)}))&&this.queueRequest({id:g,timestamp:Date.now()},E)},i.prototype.processRequests=function(u){var g=this;if(!this.pendingRequest&&0!==this.queue.length){var _=this.queue.shift(),E=_.id,P=_.timestamp;E&&this.success[E]||(this.anonId||this.fetchEventData(),Q(this.anonId)||(this.anonId=J()),this.postEvent(P,{skuToken:this.skuToken},function(A){A||E&&(g.success[E]=!0)},u))}},i}(Tt),We=new(function(t){function i(u){t.call(this,"appUserTurnstile"),this._customAccessToken=u}return t&&(i.__proto__=t),(i.prototype=Object.create(t&&t.prototype)).constructor=i,i.prototype.postTurnstileEvent=function(u,g){Er.EVENTS_URL&&Er.ACCESS_TOKEN&&Array.isArray(u)&&u.some(function(_){return $n(_)||fi(_)})&&this.queueRequest(Date.now(),g)},i.prototype.processRequests=function(u){var g=this;if(!this.pendingRequest&&0!==this.queue.length){this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();var _=$(Er.ACCESS_TOKEN),E=_?_.u:Er.ACCESS_TOKEN,P=E!==this.eventData.tokenU;Q(this.anonId)||(this.anonId=J(),P=!0);var A=this.queue.shift();if(this.eventData.lastSuccess){var F=new Date(this.eventData.lastSuccess),U=new Date(A),q=(A-this.eventData.lastSuccess)/864e5;P=P||q>=1||q<-1||F.getDate()!==U.getDate()}else P=!0;if(!P)return this.processRequests();this.postEvent(A,{"enabled.telemetry":!1},function(G){G||(g.eventData.lastSuccess=A,g.eventData.tokenU=E)},u)}},i}(Tt)),Le=We.postTurnstileEvent.bind(We),tn=new Ge,gn=tn.postMapLoadEvent.bind(tn),sr=500,vn=50;function Bn(){kt.caches&&!Jt&&(Jt=kt.caches.open("mapbox-tiles"))}function Dn(t){var i=t.indexOf("?");return i<0?t:t.slice(0,i)}var Rn,Ii=1/0;function Gi(){return null==Rn&&(Rn=kt.OffscreenCanvas&&new kt.OffscreenCanvas(1,1).getContext("2d")&&"function"==typeof kt.createImageBitmap),Rn}var vo={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};"function"==typeof Object.freeze&&Object.freeze(vo);var Yi=function(t){function i(u,g,_){401===g&&fi(_)&&(u+=": you may have provided an invalid Mapbox access token. See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes"),t.call(this,u),this.status=g,this.url=_,this.name=this.constructor.name,this.message=u}return t&&(i.__proto__=t),(i.prototype=Object.create(t&&t.prototype)).constructor=i,i.prototype.toString=function(){return this.name+": "+this.message+" ("+this.status+"): "+this.url},i}(Error),lo=ke()?function(){return self.worker&&self.worker.referrer}:function(){return("blob:"===kt.location.protocol?kt.parent:kt).location.href};function ei(t,i){var u,g=new kt.AbortController,_=new kt.Request(t.url,{method:t.method||"GET",body:t.body,credentials:t.credentials,headers:t.headers,referrer:lo(),signal:g.signal}),E=!1,P=!1,A=(u=_.url).indexOf("sku=")>0&&fi(u);"json"===t.type&&_.headers.set("Accept","application/json");var F=function(q,G,K){if(!P){if(q&&"SecurityError"!==q.message&&xt(q),G&&K)return U(G);var ot=Date.now();kt.fetch(_).then(function(It){if(It.ok){var Mt=A?It.clone():null;return U(It,Mt,ot)}return i(new Yi(It.statusText,It.status,t.url))}).catch(function(It){20!==It.code&&i(new Error(It.message))})}},U=function(q,G,K){("arrayBuffer"===t.type?q.arrayBuffer():"json"===t.type?q.json():q.text()).then(function(ot){P||(G&&K&&function(It,Mt,Zt){if(Bn(),Jt){var Xt={status:Mt.status,statusText:Mt.statusText,headers:new kt.Headers};Mt.headers.forEach(function(fe,Ce){return Xt.headers.set(Ce,fe)});var ce=Te(Mt.headers.get("Cache-Control")||"");ce["no-store"]||(ce["max-age"]&&Xt.headers.set("Expires",new Date(Zt+1e3*ce["max-age"]).toUTCString()),new Date(Xt.headers.get("Expires")).getTime()-Zt<42e4||function(fe,Ce){if(void 0===Ee)try{new Response(new ReadableStream),Ee=!0}catch(Pe){Ee=!1}Ee?Ce(fe.body):fe.blob().then(Ce)}(Mt,function(fe){var Ce=new kt.Response(fe,Xt);Bn(),Jt&&Jt.then(function(Pe){return Pe.put(Dn(It.url),Ce)}).catch(function(Pe){return xt(Pe.message)})}))}}(_,G,K),E=!0,i(null,ot,q.headers.get("Cache-Control"),q.headers.get("Expires")))}).catch(function(ot){P||i(new Error(ot.message))})};return A?function(q,G){if(Bn(),!Jt)return G(null);var K=Dn(q.url);Jt.then(function(ot){ot.match(K).then(function(It){var Mt=function(Zt){if(!Zt)return!1;var Xt=new Date(Zt.headers.get("Expires")||0),ce=Te(Zt.headers.get("Cache-Control")||"");return Xt>Date.now()&&!ce["no-cache"]}(It);ot.delete(K),Mt&&ot.put(K,It.clone()),G(null,It,Mt)}).catch(G)}).catch(G)}(_,F):F(null,null),{cancel:function(){P=!0,E||g.abort()}}}var _o,ki,Je=function(t,i){if(/:\/\//.test(t.url)&&!/^https?:|^file:/.test(t.url)){if(ke()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",t,i);if(!ke()){var u=t.url.substring(0,t.url.indexOf("://"));return(Er.REGISTERED_PROTOCOLS[u]||ei)(t,i)}}if(!(/^file:/.test(g=t.url)||/^file:/.test(lo())&&!/^\w+:/.test(g))){if(kt.fetch&&kt.Request&&kt.AbortController&&kt.Request.prototype.hasOwnProperty("signal"))return ei(t,i);if(ke()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",t,i,void 0,!0)}var g;return function(_,E){var P=new kt.XMLHttpRequest;for(var A in P.open(_.method||"GET",_.url,!0),"arrayBuffer"===_.type&&(P.responseType="arraybuffer"),_.headers)P.setRequestHeader(A,_.headers[A]);return"json"===_.type&&(P.responseType="text",P.setRequestHeader("Accept","application/json")),P.withCredentials="include"===_.credentials,P.onerror=function(){E(new Error(P.statusText))},P.onload=function(){if((P.status>=200&&P.status<300||0===P.status)&&null!==P.response){var F=P.response;if("json"===_.type)try{F=JSON.parse(P.response)}catch(U){return E(U)}E(null,F,P.getResponseHeader("Cache-Control"),P.getResponseHeader("Expires"))}else E(new Yi(P.statusText,P.status,_.url))},P.send(_.body),{cancel:function(){return P.abort()}}}(t,i)},di=function(t,i){return Je(qt(t,{type:"arrayBuffer"}),i)},V=function(t,i){return Je(qt(t,{method:"POST"}),i)},Y="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";_o=[],ki=0;var it=function(t,i){if(Yr.supported&&(t.headers||(t.headers={}),t.headers.accept="image/webp,*/*"),ki>=Er.MAX_PARALLEL_IMAGE_REQUESTS){var u={requestParameters:t,callback:i,cancelled:!1,cancel:function(){this.cancelled=!0}};return _o.push(u),u}ki++;var g=!1,_=function(){if(!g)for(g=!0,ki--;_o.length&&ki<Er.MAX_PARALLEL_IMAGE_REQUESTS;){var P=_o.shift();P.cancelled||(P.cancel=it(P.requestParameters,P.callback).cancel)}},E=di(t,function(P,A,F,U){var G,K;_(),P?i(P):A&&(Gi()?(G=i,K=new kt.Blob([new Uint8Array(A)],{type:"image/png"}),kt.createImageBitmap(K).then(function(ot){G(null,ot)}).catch(function(ot){G(new Error("Could not load image because of "+ot.message+". Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))})):function(q,G,K,ot){var It=new kt.Image,Mt=kt.URL;It.onload=function(){G(null,It),Mt.revokeObjectURL(It.src),It.onload=null,kt.requestAnimationFrame(function(){It.src=Y})},It.onerror=function(){return G(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))};var Zt=new kt.Blob([new Uint8Array(q)],{type:"image/png"});It.cacheControl=K,It.expires=ot,It.src=q.byteLength?Mt.createObjectURL(Zt):Y}(A,i,F,U))});return{cancel:function(){E.cancel(),_()}}};function ht(t,i,u){u[t]&&-1!==u[t].indexOf(i)||(u[t]=u[t]||[],u[t].push(i))}function Lt(t,i,u){if(u&&u[t]){var g=u[t].indexOf(i);-1!==g&&u[t].splice(g,1)}}var Wt=function(t,i){void 0===i&&(i={}),qt(this,i),this.type=t},ie=function(t){function i(u,g){void 0===g&&(g={}),t.call(this,"error",qt({error:u},g))}return t&&(i.__proto__=t),(i.prototype=Object.create(t&&t.prototype)).constructor=i,i}(Wt),Ht=function(){};Ht.prototype.on=function(t,i){return this._listeners=this._listeners||{},ht(t,i,this._listeners),this},Ht.prototype.off=function(t,i){return Lt(t,i,this._listeners),Lt(t,i,this._oneTimeListeners),this},Ht.prototype.once=function(t,i){return this._oneTimeListeners=this._oneTimeListeners||{},ht(t,i,this._oneTimeListeners),this},Ht.prototype.fire=function(t,i){"string"==typeof t&&(t=new Wt(t,i||{}));var u=t.type;if(this.listens(u)){t.target=this;for(var g=0,_=this._listeners&&this._listeners[u]?this._listeners[u].slice():[];g<_.length;g+=1)_[g].call(this,t);for(var E=0,P=this._oneTimeListeners&&this._oneTimeListeners[u]?this._oneTimeListeners[u].slice():[];E<P.length;E+=1){var A=P[E];Lt(u,A,this._oneTimeListeners),A.call(this,t)}var F=this._eventedParent;F&&(qt(t,"function"==typeof this._eventedParentData?this._eventedParentData():this._eventedParentData),F.fire(t))}else t instanceof ie&&console.error(t.error);return this},Ht.prototype.listens=function(t){return this._listeners&&this._listeners[t]&&this._listeners[t].length>0||this._oneTimeListeners&&this._oneTimeListeners[t]&&this._oneTimeListeners[t].length>0||this._eventedParent&&this._eventedParent.listens(t)},Ht.prototype.setEventedParent=function(t,i){return this._eventedParent=t,this._eventedParentData=i,this};var _t={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},sources:{required:!0,type:"sources"},sprite:{type:"string"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{}},default:"mapbox"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}},Ut=function(t,i,u,g){this.message=(t?t+": ":"")+u,g&&(this.identifier=g),null!=i&&i.__line__&&(this.line=i.__line__)};function je(t){var i=t.value;return i?[new Ut(t.key,i,"constants have been deprecated as of v8")]:[]}function ur(t){for(var i=[],u=arguments.length-1;u-- >0;)i[u]=arguments[u+1];for(var g=0,_=i;g<_.length;g+=1){var E=_[g];for(var P in E)t[P]=E[P]}return t}function ge(t){return t instanceof Number||t instanceof String||t instanceof Boolean?t.valueOf():t}function Oe(t){if(Array.isArray(t))return t.map(Oe);if(t instanceof Object&&!(t instanceof Number||t instanceof String||t instanceof Boolean)){var i={};for(var u in t)i[u]=Oe(t[u]);return i}return ge(t)}var cr=function(t){function i(u,g){t.call(this,g),this.message=g,this.key=u}return t&&(i.__proto__=t),(i.prototype=Object.create(t&&t.prototype)).constructor=i,i}(Error),pr=function(t,i){void 0===i&&(i=[]),this.parent=t,this.bindings={};for(var u=0,g=i;u<g.length;u+=1){var _=g[u];this.bindings[_[0]]=_[1]}};pr.prototype.concat=function(t){return new pr(this,t)},pr.prototype.get=function(t){if(this.bindings[t])return this.bindings[t];if(this.parent)return this.parent.get(t);throw new Error(t+" not found in scope.")},pr.prototype.has=function(t){return!!this.bindings[t]||!!this.parent&&this.parent.has(t)};var Tr={kind:"null"},Re={kind:"number"},nr={kind:"string"},Ue={kind:"boolean"},ln={kind:"color"},Gr={kind:"object"},Sr={kind:"value"},un={kind:"collator"},ir={kind:"formatted"},ci={kind:"resolvedImage"};function On(t,i){return{kind:"array",itemType:t,N:i}}function wn(t){if("array"===t.kind){var i=wn(t.itemType);return"number"==typeof t.N?"array<"+i+", "+t.N+">":"value"===t.itemType.kind?"array":"array<"+i+">"}return t.kind}var cn=[Tr,Re,nr,Ue,ln,ir,Gr,On(Sr),ci];function gi(t,i){if("error"===i.kind)return null;if("array"===t.kind){if("array"===i.kind&&(0===i.N&&"value"===i.itemType.kind||!gi(t.itemType,i.itemType))&&("number"!=typeof t.N||t.N===i.N))return null}else{if(t.kind===i.kind)return null;if("value"===t.kind)for(var u=0,g=cn;u<g.length;u+=1)if(!gi(g[u],i))return null}return"Expected "+wn(t)+" but found "+wn(i)+" instead."}function Un(t,i){return i.some(function(u){return u.kind===t.kind})}function on(t,i){return i.some(function(u){return"null"===u?null===t:"array"===u?Array.isArray(t):"object"===u?t&&!Array.isArray(t)&&"object"==typeof t:u===typeof t})}var Zo=Bt(function(t,i){var u={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function g(A){return(A=Math.round(A))<0?0:A>255?255:A}function _(A){return g("%"===A[A.length-1]?parseFloat(A)/100*255:parseInt(A))}function E(A){return(F="%"===A[A.length-1]?parseFloat(A)/100:parseFloat(A))<0?0:F>1?1:F;var F}function P(A,F,U){return U<0?U+=1:U>1&&(U-=1),6*U<1?A+(F-A)*U*6:2*U<1?F:3*U<2?A+(F-A)*(2/3-U)*6:A}try{i.parseCSSColor=function(A){var F,U=A.replace(/ /g,"").toLowerCase();if(U in u)return u[U].slice();if("#"===U[0])return 4===U.length?(F=parseInt(U.substr(1),16))>=0&&F<=4095?[(3840&F)>>4|(3840&F)>>8,240&F|(240&F)>>4,15&F|(15&F)<<4,1]:null:7===U.length&&(F=parseInt(U.substr(1),16))>=0&&F<=16777215?[(16711680&F)>>16,(65280&F)>>8,255&F,1]:null;var q=U.indexOf("("),G=U.indexOf(")");if(-1!==q&&G+1===U.length){var K=U.substr(0,q),ot=U.substr(q+1,G-(q+1)).split(","),It=1;switch(K){case"rgba":if(4!==ot.length)return null;It=E(ot.pop());case"rgb":return 3!==ot.length?null:[_(ot[0]),_(ot[1]),_(ot[2]),It];case"hsla":if(4!==ot.length)return null;It=E(ot.pop());case"hsl":if(3!==ot.length)return null;var Mt=(parseFloat(ot[0])%360+360)%360/360,Zt=E(ot[1]),Xt=E(ot[2]),ce=Xt<=.5?Xt*(Zt+1):Xt+Zt-Xt*Zt,fe=2*Xt-ce;return[g(255*P(fe,ce,Mt+1/3)),g(255*P(fe,ce,Mt)),g(255*P(fe,ce,Mt-1/3)),It];default:return null}}return null}}catch(A){}}).parseCSSColor,Pn=function(t,i,u,g){void 0===g&&(g=1),this.r=t,this.g=i,this.b=u,this.a=g};Pn.parse=function(t){if(t){if(t instanceof Pn)return t;if("string"==typeof t){var i=Zo(t);if(i)return new Pn(i[0]/255*i[3],i[1]/255*i[3],i[2]/255*i[3],i[3])}}},Pn.prototype.toString=function(){var t=this.toArray(),i=t[1],u=t[2],g=t[3];return"rgba("+Math.round(t[0])+","+Math.round(i)+","+Math.round(u)+","+g+")"},Pn.prototype.toArray=function(){var t=this.a;return 0===t?[0,0,0,0]:[255*this.r/t,255*this.g/t,255*this.b/t,t]},Pn.black=new Pn(0,0,0,1),Pn.white=new Pn(1,1,1,1),Pn.transparent=new Pn(0,0,0,0),Pn.red=new Pn(1,0,0,1);var Ds=function(t,i,u){this.sensitivity=t?i?"variant":"case":i?"accent":"base",this.locale=u,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})};Ds.prototype.compare=function(t,i){return this.collator.compare(t,i)},Ds.prototype.resolvedLocale=function(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale};var $s=function(t,i,u,g,_){this.text=t,this.image=i,this.scale=u,this.fontStack=g,this.textColor=_},no=function(t){this.sections=t};no.fromString=function(t){return new no([new $s(t,null,null,null,null)])},no.prototype.isEmpty=function(){return 0===this.sections.length||!this.sections.some(function(t){return 0!==t.text.length||t.image&&0!==t.image.name.length})},no.factory=function(t){return t instanceof no?t:no.fromString(t)},no.prototype.toString=function(){return 0===this.sections.length?"":this.sections.map(function(t){return t.text}).join("")},no.prototype.serialize=function(){for(var t=["format"],i=0,u=this.sections;i<u.length;i+=1){var g=u[i];if(g.image)t.push(["image",g.image.name]);else{t.push(g.text);var _={};g.fontStack&&(_["text-font"]=["literal",g.fontStack.split(",")]),g.scale&&(_["font-scale"]=g.scale),g.textColor&&(_["text-color"]=["rgba"].concat(g.textColor.toArray())),t.push(_)}}return t};var jn=function(t){this.name=t.name,this.available=t.available};function _l(t,i,u,g){return"number"==typeof t&&t>=0&&t<=255&&"number"==typeof i&&i>=0&&i<=255&&"number"==typeof u&&u>=0&&u<=255?void 0===g||"number"==typeof g&&g>=0&&g<=1?null:"Invalid rgba value ["+[t,i,u,g].join(", ")+"]: 'a' must be between 0 and 1.":"Invalid rgba value ["+("number"==typeof g?[t,i,u,g]:[t,i,u]).join(", ")+"]: 'r', 'g', and 'b' must be between 0 and 255."}function ma(t){if(null===t||"string"==typeof t||"boolean"==typeof t||"number"==typeof t||t instanceof Pn||t instanceof Ds||t instanceof no||t instanceof jn)return!0;if(Array.isArray(t)){for(var i=0,u=t;i<u.length;i+=1)if(!ma(u[i]))return!1;return!0}if("object"==typeof t){for(var g in t)if(!ma(t[g]))return!1;return!0}return!1}function xo(t){if(null===t)return Tr;if("string"==typeof t)return nr;if("boolean"==typeof t)return Ue;if("number"==typeof t)return Re;if(t instanceof Pn)return ln;if(t instanceof Ds)return un;if(t instanceof no)return ir;if(t instanceof jn)return ci;if(Array.isArray(t)){for(var i,u=t.length,g=0,_=t;g<_.length;g+=1){var E=xo(_[g]);if(i){if(i===E)continue;i=Sr;break}i=E}return On(i||Sr,u)}return Gr}function Rs(t){var i=typeof t;return null===t?"":"string"===i||"number"===i||"boolean"===i?String(t):t instanceof Pn||t instanceof no||t instanceof jn?t.toString():JSON.stringify(t)}jn.prototype.toString=function(){return this.name},jn.fromString=function(t){return t?new jn({name:t,available:!1}):null},jn.prototype.serialize=function(){return["image",this.name]};var En=function(t,i){this.type=t,this.value=i};En.parse=function(t,i){if(2!==t.length)return i.error("'literal' expression requires exactly one argument, but found "+(t.length-1)+" instead.");if(!ma(t[1]))return i.error("invalid value");var u=t[1],g=xo(u),_=i.expectedType;return"array"!==g.kind||0!==g.N||!_||"array"!==_.kind||"number"==typeof _.N&&0!==_.N||(g=_),new En(g,u)},En.prototype.evaluate=function(){return this.value},En.prototype.eachChild=function(){},En.prototype.outputDefined=function(){return!0},En.prototype.serialize=function(){return"array"===this.type.kind||"object"===this.type.kind?["literal",this.value]:this.value instanceof Pn?["rgba"].concat(this.value.toArray()):this.value instanceof no?this.value.serialize():this.value};var Ai=function(t){this.name="ExpressionEvaluationError",this.message=t};Ai.prototype.toJSON=function(){return this.message};var Wi={string:nr,number:Re,boolean:Ue,object:Gr},Ao=function(t,i){this.type=t,this.args=i};Ao.parse=function(t,i){if(t.length<2)return i.error("Expected at least one argument.");var u,g=1,_=t[0];if("array"===_){var E,P;if(t.length>2){var A=t[1];if("string"!=typeof A||!(A in Wi)||"object"===A)return i.error('The item type argument of "array" must be one of string, number, boolean',1);E=Wi[A],g++}else E=Sr;if(t.length>3){if(null!==t[2]&&("number"!=typeof t[2]||t[2]<0||t[2]!==Math.floor(t[2])))return i.error('The length argument to "array" must be a positive integer literal',2);P=t[2],g++}u=On(E,P)}else u=Wi[_];for(var F=[];g<t.length;g++){var U=i.parse(t[g],g,Sr);if(!U)return null;F.push(U)}return new Ao(u,F)},Ao.prototype.evaluate=function(t){for(var i=0;i<this.args.length;i++){var u=this.args[i].evaluate(t);if(!gi(this.type,xo(u)))return u;if(i===this.args.length-1)throw new Ai("Expected value to be of type "+wn(this.type)+", but found "+wn(xo(u))+" instead.")}return null},Ao.prototype.eachChild=function(t){this.args.forEach(t)},Ao.prototype.outputDefined=function(){return this.args.every(function(t){return t.outputDefined()})},Ao.prototype.serialize=function(){var t=this.type,i=[t.kind];if("array"===t.kind){var u=t.itemType;if("string"===u.kind||"number"===u.kind||"boolean"===u.kind){i.push(u.kind);var g=t.N;("number"==typeof g||this.args.length>1)&&i.push(g)}}return i.concat(this.args.map(function(_){return _.serialize()}))};var en=function(t){this.type=ir,this.sections=t};en.parse=function(t,i){if(t.length<2)return i.error("Expected at least one argument.");var u=t[1];if(!Array.isArray(u)&&"object"==typeof u)return i.error("First argument must be an image or text section.");for(var g=[],_=!1,E=1;E<=t.length-1;++E){var P=t[E];if(_&&"object"==typeof P&&!Array.isArray(P)){_=!1;var A=null;if(P["font-scale"]&&!(A=i.parse(P["font-scale"],1,Re)))return null;var F=null;if(P["text-font"]&&!(F=i.parse(P["text-font"],1,On(nr))))return null;var U=null;if(P["text-color"]&&!(U=i.parse(P["text-color"],1,ln)))return null;var q=g[g.length-1];q.scale=A,q.font=F,q.textColor=U}else{var G=i.parse(t[E],1,Sr);if(!G)return null;var K=G.type.kind;if("string"!==K&&"value"!==K&&"null"!==K&&"resolvedImage"!==K)return i.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");_=!0,g.push({content:G,scale:null,font:null,textColor:null})}}return new en(g)},en.prototype.evaluate=function(t){return new no(this.sections.map(function(i){var u=i.content.evaluate(t);return xo(u)===ci?new $s("",u,null,null,null):new $s(Rs(u),null,i.scale?i.scale.evaluate(t):null,i.font?i.font.evaluate(t).join(","):null,i.textColor?i.textColor.evaluate(t):null)}))},en.prototype.eachChild=function(t){for(var i=0,u=this.sections;i<u.length;i+=1){var g=u[i];t(g.content),g.scale&&t(g.scale),g.font&&t(g.font),g.textColor&&t(g.textColor)}},en.prototype.outputDefined=function(){return!1},en.prototype.serialize=function(){for(var t=["format"],i=0,u=this.sections;i<u.length;i+=1){var g=u[i];t.push(g.content.serialize());var _={};g.scale&&(_["font-scale"]=g.scale.serialize()),g.font&&(_["text-font"]=g.font.serialize()),g.textColor&&(_["text-color"]=g.textColor.serialize()),t.push(_)}return t};var Ns=function(t){this.type=ci,this.input=t};Ns.parse=function(t,i){if(2!==t.length)return i.error("Expected two arguments.");var u=i.parse(t[1],1,nr);return u?new Ns(u):i.error("No image name provided.")},Ns.prototype.evaluate=function(t){var i=this.input.evaluate(t),u=jn.fromString(i);return u&&t.availableImages&&(u.available=t.availableImages.indexOf(i)>-1),u},Ns.prototype.eachChild=function(t){t(this.input)},Ns.prototype.outputDefined=function(){return!1},Ns.prototype.serialize=function(){return["image",this.input.serialize()]};var Ic={"to-boolean":Ue,"to-color":ln,"to-number":Re,"to-string":nr},Ra=function(t,i){this.type=t,this.args=i};Ra.parse=function(t,i){if(t.length<2)return i.error("Expected at least one argument.");var u=t[0];if(("to-boolean"===u||"to-string"===u)&&2!==t.length)return i.error("Expected one argument.");for(var g=Ic[u],_=[],E=1;E<t.length;E++){var P=i.parse(t[E],E,Sr);if(!P)return null;_.push(P)}return new Ra(g,_)},Ra.prototype.evaluate=function(t){if("boolean"===this.type.kind)return Boolean(this.args[0].evaluate(t));if("color"===this.type.kind){for(var i,u,g=0,_=this.args;g<_.length;g+=1){if(u=null,(i=_[g].evaluate(t))instanceof Pn)return i;if("string"==typeof i){var E=t.parseColor(i);if(E)return E}else if(Array.isArray(i)&&!(u=i.length<3||i.length>4?"Invalid rbga value "+JSON.stringify(i)+": expected an array containing either three or four numeric values.":_l(i[0],i[1],i[2],i[3])))return new Pn(i[0]/255,i[1]/255,i[2]/255,i[3])}throw new Ai(u||"Could not parse color from value '"+("string"==typeof i?i:String(JSON.stringify(i)))+"'")}if("number"===this.type.kind){for(var P=null,A=0,F=this.args;A<F.length;A+=1){if(null===(P=F[A].evaluate(t)))return 0;var U=Number(P);if(!isNaN(U))return U}throw new Ai("Could not convert "+JSON.stringify(P)+" to number.")}return"formatted"===this.type.kind?no.fromString(Rs(this.args[0].evaluate(t))):"resolvedImage"===this.type.kind?jn.fromString(Rs(this.args[0].evaluate(t))):Rs(this.args[0].evaluate(t))},Ra.prototype.eachChild=function(t){this.args.forEach(t)},Ra.prototype.outputDefined=function(){return this.args.every(function(t){return t.outputDefined()})},Ra.prototype.serialize=function(){if("formatted"===this.type.kind)return new en([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if("resolvedImage"===this.type.kind)return new Ns(this.args[0]).serialize();var t=["to-"+this.type.kind];return this.eachChild(function(i){t.push(i.serialize())}),t};var ya=["Unknown","Point","LineString","Polygon"],Wo=function(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null};Wo.prototype.id=function(){return this.feature&&"id"in this.feature?this.feature.id:null},Wo.prototype.geometryType=function(){return this.feature?"number"==typeof this.feature.type?ya[this.feature.type]:this.feature.type:null},Wo.prototype.geometry=function(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null},Wo.prototype.canonicalID=function(){return this.canonical},Wo.prototype.properties=function(){return this.feature&&this.feature.properties||{}},Wo.prototype.parseColor=function(t){var i=this._parseColorCache[t];return i||(i=this._parseColorCache[t]=Pn.parse(t)),i};var Lo=function(t,i,u,g){this.name=t,this.type=i,this._evaluate=u,this.args=g};Lo.prototype.evaluate=function(t){return this._evaluate(t,this.args)},Lo.prototype.eachChild=function(t){this.args.forEach(t)},Lo.prototype.outputDefined=function(){return!1},Lo.prototype.serialize=function(){return[this.name].concat(this.args.map(function(t){return t.serialize()}))},Lo.parse=function(t,i){var u,g=t[0],_=Lo.definitions[g];if(!_)return i.error('Unknown expression "'+g+'". If you wanted a literal array, use ["literal", [...]].',0);for(var E=Array.isArray(_)?_[0]:_.type,P=Array.isArray(_)?[[_[1],_[2]]]:_.overloads,A=P.filter(function(kr){var Ir=kr[0];return!Array.isArray(Ir)||Ir.length===t.length-1}),F=null,U=0,q=A;U<q.length;U+=1){var G=q[U],K=G[0],ot=G[1];F=new io(i.registry,i.path,null,i.scope);for(var It=[],Mt=!1,Zt=1;Zt<t.length;Zt++){var Xt=t[Zt],ce=Array.isArray(K)?K[Zt-1]:K.type,fe=F.parse(Xt,1+It.length,ce);if(!fe){Mt=!0;break}It.push(fe)}if(!Mt)if(Array.isArray(K)&&K.length!==It.length)F.error("Expected "+K.length+" arguments, but found "+It.length+" instead.");else{for(var Ce=0;Ce<It.length;Ce++){var Pe=Array.isArray(K)?K[Ce]:K.type,be=It[Ce];F.concat(Ce+1).checkSubtype(Pe,be.type)}if(0===F.errors.length)return new Lo(g,E,ot,It)}}if(1===A.length)(u=i.errors).push.apply(u,F.errors);else{for(var ar=(A.length?A:P).map(function(kr){var Ir;return Ir=kr[0],Array.isArray(Ir)?"("+Ir.map(wn).join(", ")+")":"("+wn(Ir.type)+"...)"}).join(" | "),lr=[],zr=1;zr<t.length;zr++){var xr=i.parse(t[zr],1+lr.length);if(!xr)return null;lr.push(wn(xr.type))}i.error("Expected arguments of type "+ar+", but found ("+lr.join(", ")+") instead.")}return null},Lo.register=function(t,i){for(var u in Lo.definitions=i,i)t[u]=Lo};var bo=function(t,i,u){this.type=un,this.locale=u,this.caseSensitive=t,this.diacriticSensitive=i};function Qe(t,i){t[0]=Math.min(t[0],i[0]),t[1]=Math.min(t[1],i[1]),t[2]=Math.max(t[2],i[0]),t[3]=Math.max(t[3],i[1])}function tu(t,i){return!(t[0]<=i[0]||t[2]>=i[2]||t[1]<=i[1]||t[3]>=i[3])}function Ha(t,i){var u=(180+t[0])/360,g=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+t[1]*Math.PI/360)))/360,_=Math.pow(2,i.z);return[Math.round(u*_*8192),Math.round(g*_*8192)]}function Ja(t,i,u){return i[1]>t[1]!=u[1]>t[1]&&t[0]<(u[0]-i[0])*(t[1]-i[1])/(u[1]-i[1])+i[0]}function ku(t,i){for(var u,g,_,E,P,A,F,U=!1,q=0,G=i.length;q<G;q++)for(var K=i[q],ot=0,It=K.length;ot<It-1;ot++){if((E=(u=t)[0]-(g=K[ot])[0])*(F=u[1]-(_=K[ot+1])[1])-(A=u[0]-_[0])*(P=u[1]-g[1])==0&&E*A<=0&&P*F<=0)return!1;Ja(t,K[ot],K[ot+1])&&(U=!U)}return U}function ia(t,i){for(var u=0;u<i.length;u++)if(ku(t,i[u]))return!0;return!1}function yi(t,i,u,g){var _=g[0]-u[0],E=g[1]-u[1],P=(t[0]-u[0])*E-_*(t[1]-u[1]),A=(i[0]-u[0])*E-_*(i[1]-u[1]);return P>0&&A<0||P<0&&A>0}function ri(t,i,u){for(var g=0,_=u;g<_.length;g+=1)for(var E=_[g],P=0;P<E.length-1;++P)if((G=[(q=E[P+1])[0]-(U=E[P])[0],q[1]-U[1]])[0]*(K=[(F=i)[0]-(A=t)[0],F[1]-A[1]])[1]-G[1]*K[0]!=0&&yi(A,F,U,q)&&yi(U,q,A,F))return!0;var A,F,U,q,G,K;return!1}function Li(t,i){for(var u=0;u<t.length;++u)if(!ku(t[u],i))return!1;for(var g=0;g<t.length-1;++g)if(ri(t[g],t[g+1],i))return!1;return!0}function xl(t,i){for(var u=0;u<i.length;u++)if(Li(t,i[u]))return!0;return!1}function bl(t,i,u){for(var g=[],_=0;_<t.length;_++){for(var E=[],P=0;P<t[_].length;P++){var A=Ha(t[_][P],u);Qe(i,A),E.push(A)}g.push(E)}return g}function Ho(t,i,u){for(var g=[],_=0;_<t.length;_++){var E=bl(t[_],i,u);g.push(E)}return g}function Hu(t,i,u,g){if(t[0]<u[0]||t[0]>u[2]){var _=.5*g,E=t[0]-u[0]>_?-g:u[0]-t[0]>_?g:0;0===E&&(E=t[0]-u[2]>_?-g:u[2]-t[0]>_?g:0),t[0]+=E}Qe(i,t)}function Sa(t,i,u,g){for(var _=8192*Math.pow(2,g.z),E=[8192*g.x,8192*g.y],P=[],A=0,F=t;A<F.length;A+=1)for(var U=0,q=F[A];U<q.length;U+=1){var G=q[U],K=[G.x+E[0],G.y+E[1]];Hu(K,i,u,_),P.push(K)}return P}function ni(t,i,u,g){for(var _,E=8192*Math.pow(2,g.z),P=[8192*g.x,8192*g.y],A=[],F=0,U=t;F<U.length;F+=1){for(var q=[],G=0,K=U[F];G<K.length;G+=1){var ot=K[G],It=[ot.x+P[0],ot.y+P[1]];Qe(i,It),q.push(It)}A.push(q)}if(i[2]-i[0]<=E/2){(_=i)[0]=_[1]=1/0,_[2]=_[3]=-1/0;for(var Mt=0,Zt=A;Mt<Zt.length;Mt+=1)for(var Xt=0,ce=Zt[Mt];Xt<ce.length;Xt+=1)Hu(ce[Xt],i,u,E)}return A}bo.parse=function(t,i){if(2!==t.length)return i.error("Expected one argument.");var u=t[1];if("object"!=typeof u||Array.isArray(u))return i.error("Collator options argument must be an object.");var g=i.parse(void 0!==u["case-sensitive"]&&u["case-sensitive"],1,Ue);if(!g)return null;var _=i.parse(void 0!==u["diacritic-sensitive"]&&u["diacritic-sensitive"],1,Ue);if(!_)return null;var E=null;return u.locale&&!(E=i.parse(u.locale,1,nr))?null:new bo(g,_,E)},bo.prototype.evaluate=function(t){return new Ds(this.caseSensitive.evaluate(t),this.diacriticSensitive.evaluate(t),this.locale?this.locale.evaluate(t):null)},bo.prototype.eachChild=function(t){t(this.caseSensitive),t(this.diacriticSensitive),this.locale&&t(this.locale)},bo.prototype.outputDefined=function(){return!1},bo.prototype.serialize=function(){var t={};return t["case-sensitive"]=this.caseSensitive.serialize(),t["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(t.locale=this.locale.serialize()),["collator",t]};var Jo=function(t,i){this.type=Ue,this.geojson=t,this.geometries=i};function $i(t){if(t instanceof Lo&&("get"===t.name&&1===t.args.length||"feature-state"===t.name||"has"===t.name&&1===t.args.length||"properties"===t.name||"geometry-type"===t.name||"id"===t.name||/^filter-/.test(t.name))||t instanceof Jo)return!1;var i=!0;return t.eachChild(function(u){i&&!$i(u)&&(i=!1)}),i}function zs(t){if(t instanceof Lo&&"feature-state"===t.name)return!1;var i=!0;return t.eachChild(function(u){i&&!zs(u)&&(i=!1)}),i}function eu(t,i){if(t instanceof Lo&&i.indexOf(t.name)>=0)return!1;var u=!0;return t.eachChild(function(g){u&&!eu(g,i)&&(u=!1)}),u}Jo.parse=function(t,i){if(2!==t.length)return i.error("'within' expression requires exactly one argument, but found "+(t.length-1)+" instead.");if(ma(t[1])){var u=t[1];if("FeatureCollection"===u.type)for(var g=0;g<u.features.length;++g){var _=u.features[g].geometry.type;if("Polygon"===_||"MultiPolygon"===_)return new Jo(u,u.features[g].geometry)}else if("Feature"===u.type){var E=u.geometry.type;if("Polygon"===E||"MultiPolygon"===E)return new Jo(u,u.geometry)}else if("Polygon"===u.type||"MultiPolygon"===u.type)return new Jo(u,u)}return i.error("'within' expression requires valid geojson object that contains polygon geometry type.")},Jo.prototype.evaluate=function(t){if(null!=t.geometry()&&null!=t.canonicalID()){if("Point"===t.geometryType())return function(i,u){var g=[1/0,1/0,-1/0,-1/0],_=[1/0,1/0,-1/0,-1/0],E=i.canonicalID();if("Polygon"===u.type){var P=bl(u.coordinates,_,E),A=Sa(i.geometry(),g,_,E);if(!tu(g,_))return!1;for(var F=0,U=A;F<U.length;F+=1)if(!ku(U[F],P))return!1}if("MultiPolygon"===u.type){var q=Ho(u.coordinates,_,E),G=Sa(i.geometry(),g,_,E);if(!tu(g,_))return!1;for(var K=0,ot=G;K<ot.length;K+=1)if(!ia(ot[K],q))return!1}return!0}(t,this.geometries);if("LineString"===t.geometryType())return function(i,u){var g=[1/0,1/0,-1/0,-1/0],_=[1/0,1/0,-1/0,-1/0],E=i.canonicalID();if("Polygon"===u.type){var P=bl(u.coordinates,_,E),A=ni(i.geometry(),g,_,E);if(!tu(g,_))return!1;for(var F=0,U=A;F<U.length;F+=1)if(!Li(U[F],P))return!1}if("MultiPolygon"===u.type){var q=Ho(u.coordinates,_,E),G=ni(i.geometry(),g,_,E);if(!tu(g,_))return!1;for(var K=0,ot=G;K<ot.length;K+=1)if(!xl(ot[K],q))return!1}return!0}(t,this.geometries)}return!1},Jo.prototype.eachChild=function(){},Jo.prototype.outputDefined=function(){return!0},Jo.prototype.serialize=function(){return["within",this.geojson]};var hi=function(t,i){this.type=i.type,this.name=t,this.boundExpression=i};hi.parse=function(t,i){if(2!==t.length||"string"!=typeof t[1])return i.error("'var' expression requires exactly one string literal argument.");var u=t[1];return i.scope.has(u)?new hi(u,i.scope.get(u)):i.error('Unknown variable "'+u+'". Make sure "'+u+'" has been bound in an enclosing "let" expression before using it.',1)},hi.prototype.evaluate=function(t){return this.boundExpression.evaluate(t)},hi.prototype.eachChild=function(){},hi.prototype.outputDefined=function(){return!1},hi.prototype.serialize=function(){return["var",this.name]};var io=function(t,i,u,g,_){void 0===i&&(i=[]),void 0===g&&(g=new pr),void 0===_&&(_=[]),this.registry=t,this.path=i,this.key=i.map(function(E){return"["+E+"]"}).join(""),this.scope=g,this.errors=_,this.expectedType=u};function Ka(t,i){for(var u,g=t.length-1,_=0,E=g,P=0;_<=E;)if((u=t[P=Math.floor((_+E)/2)])<=i){if(P===g||i<t[P+1])return P;_=P+1}else{if(!(u>i))throw new Ai("Input is not a number.");E=P-1}return 0}io.prototype.parse=function(t,i,u,g,_){return void 0===_&&(_={}),i?this.concat(i,u,g)._parse(t,_):this._parse(t,_)},io.prototype._parse=function(t,i){function u(U,q,G){return"assert"===G?new Ao(q,[U]):"coerce"===G?new Ra(q,[U]):U}if(null!==t&&"string"!=typeof t&&"boolean"!=typeof t&&"number"!=typeof t||(t=["literal",t]),Array.isArray(t)){if(0===t.length)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');var g=t[0];if("string"!=typeof g)return this.error("Expression name must be a string, but found "+typeof g+' instead. If you wanted a literal array, use ["literal", [...]].',0),null;var _=this.registry[g];if(_){var E=_.parse(t,this);if(!E)return null;if(this.expectedType){var P=this.expectedType,A=E.type;if("string"!==P.kind&&"number"!==P.kind&&"boolean"!==P.kind&&"object"!==P.kind&&"array"!==P.kind||"value"!==A.kind)if("color"!==P.kind&&"formatted"!==P.kind&&"resolvedImage"!==P.kind||"value"!==A.kind&&"string"!==A.kind){if(this.checkSubtype(P,A))return null}else E=u(E,P,i.typeAnnotation||"coerce");else E=u(E,P,i.typeAnnotation||"assert")}if(!(E instanceof En)&&"resolvedImage"!==E.type.kind&&function U(q){if(q instanceof hi)return U(q.boundExpression);if(q instanceof Lo&&"error"===q.name||q instanceof bo||q instanceof Jo)return!1;var G=q instanceof Ra||q instanceof Ao,K=!0;return q.eachChild(function(ot){K=G?K&&U(ot):K&&ot instanceof En}),!!K&&$i(q)&&eu(q,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}(E)){var F=new Wo;try{E=new En(E.type,E.evaluate(F))}catch(U){return this.error(U.message),null}}return E}return this.error('Unknown expression "'+g+'". If you wanted a literal array, use ["literal", [...]].',0)}return this.error(void 0===t?"'undefined' value invalid. Use null instead.":"object"==typeof t?'Bare objects invalid. Use ["literal", {...}] instead.':"Expected an array, but found "+typeof t+" instead.")},io.prototype.concat=function(t,i,u){var g="number"==typeof t?this.path.concat(t):this.path,_=u?this.scope.concat(u):this.scope;return new io(this.registry,g,i||null,_,this.errors)},io.prototype.error=function(t){for(var i=[],u=arguments.length-1;u-- >0;)i[u]=arguments[u+1];var g=""+this.key+i.map(function(_){return"["+_+"]"}).join("");this.errors.push(new cr(g,t))},io.prototype.checkSubtype=function(t,i){var u=gi(t,i);return u&&this.error(u),u};var co=function(t,i,u){this.type=t,this.input=i,this.labels=[],this.outputs=[];for(var g=0,_=u;g<_.length;g+=1){var E=_[g],P=E[1];this.labels.push(E[0]),this.outputs.push(P)}};function Ei(t,i,u){return t*(1-u)+i*u}co.parse=function(t,i){if(t.length-1<4)return i.error("Expected at least 4 arguments, but found only "+(t.length-1)+".");if((t.length-1)%2!=0)return i.error("Expected an even number of arguments.");var u=i.parse(t[1],1,Re);if(!u)return null;var g=[],_=null;i.expectedType&&"value"!==i.expectedType.kind&&(_=i.expectedType);for(var E=1;E<t.length;E+=2){var P=1===E?-1/0:t[E],A=t[E+1],F=E,U=E+1;if("number"!=typeof P)return i.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',F);if(g.length&&g[g.length-1][0]>=P)return i.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',F);var q=i.parse(A,U,_);if(!q)return null;_=_||q.type,g.push([P,q])}return new co(_,u,g)},co.prototype.evaluate=function(t){var i=this.labels,u=this.outputs;if(1===i.length)return u[0].evaluate(t);var g=this.input.evaluate(t);if(g<=i[0])return u[0].evaluate(t);var _=i.length;return g>=i[_-1]?u[_-1].evaluate(t):u[Ka(i,g)].evaluate(t)},co.prototype.eachChild=function(t){t(this.input);for(var i=0,u=this.outputs;i<u.length;i+=1)t(u[i])},co.prototype.outputDefined=function(){return this.outputs.every(function(t){return t.outputDefined()})},co.prototype.serialize=function(){for(var t=["step",this.input.serialize()],i=0;i<this.labels.length;i++)i>0&&t.push(this.labels[i]),t.push(this.outputs[i].serialize());return t};var xs=Object.freeze({__proto__:null,number:Ei,color:function(t,i,u){return new Pn(Ei(t.r,i.r,u),Ei(t.g,i.g,u),Ei(t.b,i.b,u),Ei(t.a,i.a,u))},array:function(t,i,u){return t.map(function(g,_){return Ei(g,i[_],u)})}}),fu=6/29*3*(6/29),ho=Math.PI/180,Pc=180/Math.PI;function oa(t){return t>.008856451679035631?Math.pow(t,1/3):t/fu+4/29}function Fi(t){return t>6/29?t*t*t:fu*(t-4/29)}function to(t){return 255*(t<=.0031308?12.92*t:1.055*Math.pow(t,1/2.4)-.055)}function Fu(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function Hl(t){var i=Fu(t.r),u=Fu(t.g),g=Fu(t.b),_=oa((.4124564*i+.3575761*u+.1804375*g)/.95047),E=oa((.2126729*i+.7151522*u+.072175*g)/1);return{l:116*E-16,a:500*(_-E),b:200*(E-oa((.0193339*i+.119192*u+.9503041*g)/1.08883)),alpha:t.a}}function du(t){var i=(t.l+16)/116,u=isNaN(t.a)?i:i+t.a/500,g=isNaN(t.b)?i:i-t.b/200;return i=1*Fi(i),u=.95047*Fi(u),g=1.08883*Fi(g),new Pn(to(3.2404542*u-1.5371385*i-.4985314*g),to(-.969266*u+1.8760108*i+.041556*g),to(.0556434*u-.2040259*i+1.0572252*g),t.alpha)}function Jl(t,i,u){var g=i-t;return t+u*(g>180||g<-180?g-360*Math.round(g/360):g)}var ru={forward:Hl,reverse:du,interpolate:function(t,i,u){return{l:Ei(t.l,i.l,u),a:Ei(t.a,i.a,u),b:Ei(t.b,i.b,u),alpha:Ei(t.alpha,i.alpha,u)}}},wo={forward:function(t){var i=Hl(t),u=i.l,g=i.a,_=i.b,E=Math.atan2(_,g)*Pc;return{h:E<0?E+360:E,c:Math.sqrt(g*g+_*_),l:u,alpha:t.a}},reverse:function(t){var i=t.h*ho,u=t.c;return du({l:t.l,a:Math.cos(i)*u,b:Math.sin(i)*u,alpha:t.alpha})},interpolate:function(t,i,u){return{h:Jl(t.h,i.h,u),c:Ei(t.c,i.c,u),l:Ei(t.l,i.l,u),alpha:Ei(t.alpha,i.alpha,u)}}},cs=Object.freeze({__proto__:null,lab:ru,hcl:wo}),si=function(t,i,u,g,_){this.type=t,this.operator=i,this.interpolation=u,this.input=g,this.labels=[],this.outputs=[];for(var E=0,P=_;E<P.length;E+=1){var A=P[E],F=A[1];this.labels.push(A[0]),this.outputs.push(F)}};function Gs(t,i,u,g){var _=g-u,E=t-u;return 0===_?0:1===i?E/_:(Math.pow(i,E)-1)/(Math.pow(i,_)-1)}si.interpolationFactor=function(t,i,u,g){var _=0;if("exponential"===t.name)_=Gs(i,t.base,u,g);else if("linear"===t.name)_=Gs(i,1,u,g);else if("cubic-bezier"===t.name){var E=t.controlPoints;_=new ft(E[0],E[1],E[2],E[3]).solve(Gs(i,1,u,g))}return _},si.parse=function(t,i){var u=t[0],g=t[1],_=t[2],E=t.slice(3);if(!Array.isArray(g)||0===g.length)return i.error("Expected an interpolation type expression.",1);if("linear"===g[0])g={name:"linear"};else if("exponential"===g[0]){var P=g[1];if("number"!=typeof P)return i.error("Exponential interpolation requires a numeric base.",1,1);g={name:"exponential",base:P}}else{if("cubic-bezier"!==g[0])return i.error("Unknown interpolation type "+String(g[0]),1,0);var A=g.slice(1);if(4!==A.length||A.some(function(Zt){return"number"!=typeof Zt||Zt<0||Zt>1}))return i.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);g={name:"cubic-bezier",controlPoints:A}}if(t.length-1<4)return i.error("Expected at least 4 arguments, but found only "+(t.length-1)+".");if((t.length-1)%2!=0)return i.error("Expected an even number of arguments.");if(!(_=i.parse(_,2,Re)))return null;var F=[],U=null;"interpolate-hcl"===u||"interpolate-lab"===u?U=ln:i.expectedType&&"value"!==i.expectedType.kind&&(U=i.expectedType);for(var q=0;q<E.length;q+=2){var G=E[q],K=E[q+1],ot=q+3,It=q+4;if("number"!=typeof G)return i.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',ot);if(F.length&&F[F.length-1][0]>=G)return i.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',ot);var Mt=i.parse(K,It,U);if(!Mt)return null;U=U||Mt.type,F.push([G,Mt])}return"number"===U.kind||"color"===U.kind||"array"===U.kind&&"number"===U.itemType.kind&&"number"==typeof U.N?new si(U,u,g,_,F):i.error("Type "+wn(U)+" is not interpolatable.")},si.prototype.evaluate=function(t){var i=this.labels,u=this.outputs;if(1===i.length)return u[0].evaluate(t);var g=this.input.evaluate(t);if(g<=i[0])return u[0].evaluate(t);var _=i.length;if(g>=i[_-1])return u[_-1].evaluate(t);var E=Ka(i,g),P=si.interpolationFactor(this.interpolation,g,i[E],i[E+1]),A=u[E].evaluate(t),F=u[E+1].evaluate(t);return"interpolate"===this.operator?xs[this.type.kind.toLowerCase()](A,F,P):"interpolate-hcl"===this.operator?wo.reverse(wo.interpolate(wo.forward(A),wo.forward(F),P)):ru.reverse(ru.interpolate(ru.forward(A),ru.forward(F),P))},si.prototype.eachChild=function(t){t(this.input);for(var i=0,u=this.outputs;i<u.length;i+=1)t(u[i])},si.prototype.outputDefined=function(){return this.outputs.every(function(t){return t.outputDefined()})},si.prototype.serialize=function(){var t;t="linear"===this.interpolation.name?["linear"]:"exponential"===this.interpolation.name?1===this.interpolation.base?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);for(var i=[this.operator,t,this.input.serialize()],u=0;u<this.labels.length;u++)i.push(this.labels[u],this.outputs[u].serialize());return i};var Go=function(t,i){this.type=t,this.args=i};Go.parse=function(t,i){if(t.length<2)return i.error("Expectected at least one argument.");var u=null,g=i.expectedType;g&&"value"!==g.kind&&(u=g);for(var _=[],E=0,P=t.slice(1);E<P.length;E+=1){var A=i.parse(P[E],1+_.length,u,void 0,{typeAnnotation:"omit"});if(!A)return null;u=u||A.type,_.push(A)}var F=g&&_.some(function(U){return gi(g,U.type)});return new Go(F?Sr:u,_)},Go.prototype.evaluate=function(t){for(var i,u=null,g=0,_=0,E=this.args;_<E.length&&(g++,(u=E[_].evaluate(t))&&u instanceof jn&&!u.available&&(i||(i=u.name),u=null,g===this.args.length&&(u=i)),null===u);_+=1);return u},Go.prototype.eachChild=function(t){this.args.forEach(t)},Go.prototype.outputDefined=function(){return this.args.every(function(t){return t.outputDefined()})},Go.prototype.serialize=function(){var t=["coalesce"];return this.eachChild(function(i){t.push(i.serialize())}),t};var Qa=function(t,i){this.type=i.type,this.bindings=[].concat(t),this.result=i};Qa.prototype.evaluate=function(t){return this.result.evaluate(t)},Qa.prototype.eachChild=function(t){for(var i=0,u=this.bindings;i<u.length;i+=1)t(u[i][1]);t(this.result)},Qa.parse=function(t,i){if(t.length<4)return i.error("Expected at least 3 arguments, but found "+(t.length-1)+" instead.");for(var u=[],g=1;g<t.length-1;g+=2){var _=t[g];if("string"!=typeof _)return i.error("Expected string, but found "+typeof _+" instead.",g);if(/[^a-zA-Z0-9_]/.test(_))return i.error("Variable names must contain only alphanumeric characters or '_'.",g);var E=i.parse(t[g+1],g+1);if(!E)return null;u.push([_,E])}var P=i.parse(t[t.length-1],t.length-1,i.expectedType,u);return P?new Qa(u,P):null},Qa.prototype.outputDefined=function(){return this.result.outputDefined()},Qa.prototype.serialize=function(){for(var t=["let"],i=0,u=this.bindings;i<u.length;i+=1){var g=u[i];t.push(g[0],g[1].serialize())}return t.push(this.result.serialize()),t};var vi=function(t,i,u){this.type=t,this.index=i,this.input=u};vi.parse=function(t,i){if(3!==t.length)return i.error("Expected 2 arguments, but found "+(t.length-1)+" instead.");var u=i.parse(t[1],1,Re),g=i.parse(t[2],2,On(i.expectedType||Sr));return u&&g?new vi(g.type.itemType,u,g):null},vi.prototype.evaluate=function(t){var i=this.index.evaluate(t),u=this.input.evaluate(t);if(i<0)throw new Ai("Array index out of bounds: "+i+" < 0.");if(i>=u.length)throw new Ai("Array index out of bounds: "+i+" > "+(u.length-1)+".");if(i!==Math.floor(i))throw new Ai("Array index must be an integer, but found "+i+" instead.");return u[i]},vi.prototype.eachChild=function(t){t(this.index),t(this.input)},vi.prototype.outputDefined=function(){return!1},vi.prototype.serialize=function(){return["at",this.index.serialize(),this.input.serialize()]};var Fr=function(t,i){this.type=Ue,this.needle=t,this.haystack=i};Fr.parse=function(t,i){if(3!==t.length)return i.error("Expected 2 arguments, but found "+(t.length-1)+" instead.");var u=i.parse(t[1],1,Sr),g=i.parse(t[2],2,Sr);return u&&g?Un(u.type,[Ue,nr,Re,Tr,Sr])?new Fr(u,g):i.error("Expected first argument to be of type boolean, string, number or null, but found "+wn(u.type)+" instead"):null},Fr.prototype.evaluate=function(t){var i=this.needle.evaluate(t),u=this.haystack.evaluate(t);if(!u)return!1;if(!on(i,["boolean","string","number","null"]))throw new Ai("Expected first argument to be of type boolean, string, number or null, but found "+wn(xo(i))+" instead.");if(!on(u,["string","array"]))throw new Ai("Expected second argument to be of type array or string, but found "+wn(xo(u))+" instead.");return u.indexOf(i)>=0},Fr.prototype.eachChild=function(t){t(this.needle),t(this.haystack)},Fr.prototype.outputDefined=function(){return!0},Fr.prototype.serialize=function(){return["in",this.needle.serialize(),this.haystack.serialize()]};var nu=function(t,i,u){this.type=Re,this.needle=t,this.haystack=i,this.fromIndex=u};nu.parse=function(t,i){if(t.length<=2||t.length>=5)return i.error("Expected 3 or 4 arguments, but found "+(t.length-1)+" instead.");var u=i.parse(t[1],1,Sr),g=i.parse(t[2],2,Sr);if(!u||!g)return null;if(!Un(u.type,[Ue,nr,Re,Tr,Sr]))return i.error("Expected first argument to be of type boolean, string, number or null, but found "+wn(u.type)+" instead");if(4===t.length){var _=i.parse(t[3],3,Re);return _?new nu(u,g,_):null}return new nu(u,g)},nu.prototype.evaluate=function(t){var i=this.needle.evaluate(t),u=this.haystack.evaluate(t);if(!on(i,["boolean","string","number","null"]))throw new Ai("Expected first argument to be of type boolean, string, number or null, but found "+wn(xo(i))+" instead.");if(!on(u,["string","array"]))throw new Ai("Expected second argument to be of type array or string, but found "+wn(xo(u))+" instead.");if(this.fromIndex){var g=this.fromIndex.evaluate(t);return u.indexOf(i,g)}return u.indexOf(i)},nu.prototype.eachChild=function(t){t(this.needle),t(this.haystack),this.fromIndex&&t(this.fromIndex)},nu.prototype.outputDefined=function(){return!1},nu.prototype.serialize=function(){if(null!=this.fromIndex&&void 0!==this.fromIndex){var t=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),t]}return["index-of",this.needle.serialize(),this.haystack.serialize()]};var ks=function(t,i,u,g,_,E){this.inputType=t,this.type=i,this.input=u,this.cases=g,this.outputs=_,this.otherwise=E};ks.parse=function(t,i){if(t.length<5)return i.error("Expected at least 4 arguments, but found only "+(t.length-1)+".");if(t.length%2!=1)return i.error("Expected an even number of arguments.");var u,g;i.expectedType&&"value"!==i.expectedType.kind&&(g=i.expectedType);for(var _={},E=[],P=2;P<t.length-1;P+=2){var A=t[P],F=t[P+1];Array.isArray(A)||(A=[A]);var U=i.concat(P);if(0===A.length)return U.error("Expected at least one branch label.");for(var q=0,G=A;q<G.length;q+=1){var K=G[q];if("number"!=typeof K&&"string"!=typeof K)return U.error("Branch labels must be numbers or strings.");if("number"==typeof K&&Math.abs(K)>Number.MAX_SAFE_INTEGER)return U.error("Branch labels must be integers no larger than "+Number.MAX_SAFE_INTEGER+".");if("number"==typeof K&&Math.floor(K)!==K)return U.error("Numeric branch labels must be integer values.");if(u){if(U.checkSubtype(u,xo(K)))return null}else u=xo(K);if(void 0!==_[String(K)])return U.error("Branch labels must be unique.");_[String(K)]=E.length}var ot=i.parse(F,P,g);if(!ot)return null;g=g||ot.type,E.push(ot)}var It=i.parse(t[1],1,Sr);if(!It)return null;var Mt=i.parse(t[t.length-1],t.length-1,g);return Mt?"value"!==It.type.kind&&i.concat(1).checkSubtype(u,It.type)?null:new ks(u,g,It,_,E,Mt):null},ks.prototype.evaluate=function(t){var i=this.input.evaluate(t);return(xo(i)===this.inputType&&this.outputs[this.cases[i]]||this.otherwise).evaluate(t)},ks.prototype.eachChild=function(t){t(this.input),this.outputs.forEach(t),t(this.otherwise)},ks.prototype.outputDefined=function(){return this.outputs.every(function(t){return t.outputDefined()})&&this.otherwise.outputDefined()},ks.prototype.serialize=function(){for(var t=this,i=["match",this.input.serialize()],u=[],g={},_=0,E=Object.keys(this.cases).sort();_<E.length;_+=1){var P=E[_];void 0===(G=g[this.cases[P]])?(g[this.cases[P]]=u.length,u.push([this.cases[P],[P]])):u[G][1].push(P)}for(var A=function(ot){return"number"===t.inputType.kind?Number(ot):ot},F=0,U=u;F<U.length;F+=1){var q=U[F],G=q[0],K=q[1];i.push(1===K.length?A(K[0]):K.map(A)),i.push(this.outputs[outputIndex$1].serialize())}return i.push(this.otherwise.serialize()),i};var po=function(t,i,u){this.type=t,this.branches=i,this.otherwise=u};po.parse=function(t,i){if(t.length<4)return i.error("Expected at least 3 arguments, but found only "+(t.length-1)+".");if(t.length%2!=0)return i.error("Expected an odd number of arguments.");var u;i.expectedType&&"value"!==i.expectedType.kind&&(u=i.expectedType);for(var g=[],_=1;_<t.length-1;_+=2){var E=i.parse(t[_],_,Ue);if(!E)return null;var P=i.parse(t[_+1],_+1,u);if(!P)return null;g.push([E,P]),u=u||P.type}var A=i.parse(t[t.length-1],t.length-1,u);return A?new po(u,g,A):null},po.prototype.evaluate=function(t){for(var i=0,u=this.branches;i<u.length;i+=1){var g=u[i],_=g[1];if(g[0].evaluate(t))return _.evaluate(t)}return this.otherwise.evaluate(t)},po.prototype.eachChild=function(t){for(var i=0,u=this.branches;i<u.length;i+=1){var g=u[i],_=g[1];t(g[0]),t(_)}t(this.otherwise)},po.prototype.outputDefined=function(){return this.branches.every(function(t){return t[1].outputDefined()})&&this.otherwise.outputDefined()},po.prototype.serialize=function(){var t=["case"];return this.eachChild(function(i){t.push(i.serialize())}),t};var Vo=function(t,i,u,g){this.type=t,this.input=i,this.beginIndex=u,this.endIndex=g};function iu(t,i){return"=="===t||"!="===t?"boolean"===i.kind||"string"===i.kind||"number"===i.kind||"null"===i.kind||"value"===i.kind:"string"===i.kind||"number"===i.kind||"value"===i.kind}function Ci(t,i,u,g){return 0===g.compare(i,u)}function gu(t,i,u){var g="=="!==t&&"!="!==t;return function(){function _(E,P,A){this.type=Ue,this.lhs=E,this.rhs=P,this.collator=A,this.hasUntypedArgument="value"===E.type.kind||"value"===P.type.kind}return _.parse=function(E,P){if(3!==E.length&&4!==E.length)return P.error("Expected two or three arguments.");var A=E[0],F=P.parse(E[1],1,Sr);if(!F)return null;if(!iu(A,F.type))return P.concat(1).error('"'+A+"\" comparisons are not supported for type '"+wn(F.type)+"'.");var U=P.parse(E[2],2,Sr);if(!U)return null;if(!iu(A,U.type))return P.concat(2).error('"'+A+"\" comparisons are not supported for type '"+wn(U.type)+"'.");if(F.type.kind!==U.type.kind&&"value"!==F.type.kind&&"value"!==U.type.kind)return P.error("Cannot compare types '"+wn(F.type)+"' and '"+wn(U.type)+"'.");g&&("value"===F.type.kind&&"value"!==U.type.kind?F=new Ao(U.type,[F]):"value"!==F.type.kind&&"value"===U.type.kind&&(U=new Ao(F.type,[U])));var q=null;if(4===E.length){if("string"!==F.type.kind&&"string"!==U.type.kind&&"value"!==F.type.kind&&"value"!==U.type.kind)return P.error("Cannot use collator to compare non-string types.");if(!(q=P.parse(E[3],3,un)))return null}return new _(F,U,q)},_.prototype.evaluate=function(E){var P=this.lhs.evaluate(E),A=this.rhs.evaluate(E);if(g&&this.hasUntypedArgument){var F=xo(P),U=xo(A);if(F.kind!==U.kind||"string"!==F.kind&&"number"!==F.kind)throw new Ai('Expected arguments for "'+t+'" to be (string, string) or (number, number), but found ('+F.kind+", "+U.kind+") instead.")}if(this.collator&&!g&&this.hasUntypedArgument){var q=xo(P),G=xo(A);if("string"!==q.kind||"string"!==G.kind)return i(E,P,A)}return this.collator?u(E,P,A,this.collator.evaluate(E)):i(E,P,A)},_.prototype.eachChild=function(E){E(this.lhs),E(this.rhs),this.collator&&E(this.collator)},_.prototype.outputDefined=function(){return!0},_.prototype.serialize=function(){var E=[t];return this.eachChild(function(P){E.push(P.serialize())}),E},_}()}Vo.parse=function(t,i){if(t.length<=2||t.length>=5)return i.error("Expected 3 or 4 arguments, but found "+(t.length-1)+" instead.");var u=i.parse(t[1],1,Sr),g=i.parse(t[2],2,Re);if(!u||!g)return null;if(!Un(u.type,[On(Sr),nr,Sr]))return i.error("Expected first argument to be of type array or string, but found "+wn(u.type)+" instead");if(4===t.length){var _=i.parse(t[3],3,Re);return _?new Vo(u.type,u,g,_):null}return new Vo(u.type,u,g)},Vo.prototype.evaluate=function(t){var i=this.input.evaluate(t),u=this.beginIndex.evaluate(t);if(!on(i,["string","array"]))throw new Ai("Expected first argument to be of type array or string, but found "+wn(xo(i))+" instead.");if(this.endIndex){var g=this.endIndex.evaluate(t);return i.slice(u,g)}return i.slice(u)},Vo.prototype.eachChild=function(t){t(this.input),t(this.beginIndex),this.endIndex&&t(this.endIndex)},Vo.prototype.outputDefined=function(){return!1},Vo.prototype.serialize=function(){if(null!=this.endIndex&&void 0!==this.endIndex){var t=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),t]}return["slice",this.input.serialize(),this.beginIndex.serialize()]};var Ju=gu("==",function(t,i,u){return i===u},Ci),Hn=gu("!=",function(t,i,u){return i!==u},function(t,i,u,g){return!Ci(0,i,u,g)}),bs=gu("<",function(t,i,u){return i<u},function(t,i,u,g){return g.compare(i,u)<0}),Vi=gu(">",function(t,i,u){return i>u},function(t,i,u,g){return g.compare(i,u)>0}),Pu=gu("<=",function(t,i,u){return i<=u},function(t,i,u,g){return g.compare(i,u)<=0}),Ia=gu(">=",function(t,i,u){return i>=u},function(t,i,u,g){return g.compare(i,u)>=0}),Vs=function(t,i,u,g,_){this.type=nr,this.number=t,this.locale=i,this.currency=u,this.minFractionDigits=g,this.maxFractionDigits=_};Vs.parse=function(t,i){if(3!==t.length)return i.error("Expected two arguments.");var u=i.parse(t[1],1,Re);if(!u)return null;var g=t[2];if("object"!=typeof g||Array.isArray(g))return i.error("NumberFormat options argument must be an object.");var _=null;if(g.locale&&!(_=i.parse(g.locale,1,nr)))return null;var E=null;if(g.currency&&!(E=i.parse(g.currency,1,nr)))return null;var P=null;if(g["min-fraction-digits"]&&!(P=i.parse(g["min-fraction-digits"],1,Re)))return null;var A=null;return g["max-fraction-digits"]&&!(A=i.parse(g["max-fraction-digits"],1,Re))?null:new Vs(u,_,E,P,A)},Vs.prototype.evaluate=function(t){return new Intl.NumberFormat(this.locale?this.locale.evaluate(t):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(t):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(t):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(t):void 0}).format(this.number.evaluate(t))},Vs.prototype.eachChild=function(t){t(this.number),this.locale&&t(this.locale),this.currency&&t(this.currency),this.minFractionDigits&&t(this.minFractionDigits),this.maxFractionDigits&&t(this.maxFractionDigits)},Vs.prototype.outputDefined=function(){return!1},Vs.prototype.serialize=function(){var t={};return this.locale&&(t.locale=this.locale.serialize()),this.currency&&(t.currency=this.currency.serialize()),this.minFractionDigits&&(t["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(t["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),t]};var Cn=function(t){this.type=Re,this.input=t};Cn.parse=function(t,i){if(2!==t.length)return i.error("Expected 1 argument, but found "+(t.length-1)+" instead.");var u=i.parse(t[1],1);return u?"array"!==u.type.kind&&"string"!==u.type.kind&&"value"!==u.type.kind?i.error("Expected argument of type string or array, but found "+wn(u.type)+" instead."):new Cn(u):null},Cn.prototype.evaluate=function(t){var i=this.input.evaluate(t);if("string"==typeof i||Array.isArray(i))return i.length;throw new Ai("Expected value to be of type string or array, but found "+wn(xo(i))+" instead.")},Cn.prototype.eachChild=function(t){t(this.input)},Cn.prototype.outputDefined=function(){return!1},Cn.prototype.serialize=function(){var t=["length"];return this.eachChild(function(i){t.push(i.serialize())}),t};var ws={"==":Ju,"!=":Hn,">":Vi,"<":bs,">=":Ia,"<=":Pu,array:Ao,at:vi,boolean:Ao,case:po,coalesce:Go,collator:bo,format:en,image:Ns,in:Fr,"index-of":nu,interpolate:si,"interpolate-hcl":si,"interpolate-lab":si,length:Cn,let:Qa,literal:En,match:ks,number:Ao,"number-format":Vs,object:Ao,slice:Vo,step:co,string:Ao,"to-boolean":Ra,"to-color":Ra,"to-number":Ra,"to-string":Ra,var:hi,within:Jo};function Pi(t,i){var u=i[0],g=i[1],_=i[2],E=i[3];u=u.evaluate(t),g=g.evaluate(t),_=_.evaluate(t);var P=E?E.evaluate(t):1,A=_l(u,g,_,P);if(A)throw new Ai(A);return new Pn(u/255*P,g/255*P,_/255*P,P)}function Bu(t,i){return t in i}function Ko(t,i){var u=i[t];return void 0===u?null:u}function $a(t){return{type:t}}function Ku(t){return{result:"success",value:t}}function ts(t){return{result:"error",value:t}}function Nn(t){return"data-driven"===t["property-type"]||"cross-faded-data-driven"===t["property-type"]}function va(t){return!!t.expression&&t.expression.parameters.indexOf("zoom")>-1}function mu(t){return!!t.expression&&t.expression.interpolated}function Xn(t){return t instanceof Number?"number":t instanceof String?"string":t instanceof Boolean?"boolean":Array.isArray(t)?"array":null===t?"null":typeof t}function aa(t){return"object"==typeof t&&null!==t&&!Array.isArray(t)}function Oo(t){return t}function Uu(t,i,u){return void 0!==t?t:void 0!==i?i:void 0!==u?u:void 0}function Mc(t,i,u,g,_){return Uu(typeof u===_?g[u]:void 0,t.default,i.default)}function ou(t,i,u){if("number"!==Xn(u))return Uu(t.default,i.default);var g=t.stops.length;if(1===g||u<=t.stops[0][0])return t.stops[0][1];if(u>=t.stops[g-1][0])return t.stops[g-1][1];var _=Ka(t.stops.map(function(E){return E[0]}),u);return t.stops[_][1]}function _a(t,i,u){var g=void 0!==t.base?t.base:1;if("number"!==Xn(u))return Uu(t.default,i.default);var _=t.stops.length;if(1===_||u<=t.stops[0][0])return t.stops[0][1];if(u>=t.stops[_-1][0])return t.stops[_-1][1];var K,ot,Mt,Zt,E=Ka(t.stops.map(function(G){return G[0]}),u),P=(K=g,Zt=u-(ot=t.stops[E][0]),0==(Mt=t.stops[E+1][0]-ot)?0:1===K?Zt/Mt:(Math.pow(K,Zt)-1)/(Math.pow(K,Mt)-1)),A=t.stops[E][1],F=t.stops[E+1][1],U=xs[i.type]||Oo;if(t.colorSpace&&"rgb"!==t.colorSpace){var q=cs[t.colorSpace];U=function(G,K){return q.reverse(q.interpolate(q.forward(G),q.forward(K),P))}}return"function"==typeof A.evaluate?{evaluate:function(){for(var G=[],K=arguments.length;K--;)G[K]=arguments[K];var ot=A.evaluate.apply(void 0,G),It=F.evaluate.apply(void 0,G);if(void 0!==ot&&void 0!==It)return U(ot,It,P)}}:U(A,F,P)}function au(t,i,u){return"color"===i.type?u=Pn.parse(u):"formatted"===i.type?u=no.fromString(u.toString()):"resolvedImage"===i.type?u=jn.fromString(u.toString()):Xn(u)===i.type||"enum"===i.type&&i.values[u]||(u=void 0),Uu(u,t.default,i.default)}Lo.register(ws,{error:[{kind:"error"},[nr],function(t,i){throw new Ai(i[0].evaluate(t))}],typeof:[nr,[Sr],function(t,i){return wn(xo(i[0].evaluate(t)))}],"to-rgba":[On(Re,4),[ln],function(t,i){return i[0].evaluate(t).toArray()}],rgb:[ln,[Re,Re,Re],Pi],rgba:[ln,[Re,Re,Re,Re],Pi],has:{type:Ue,overloads:[[[nr],function(t,i){return Bu(i[0].evaluate(t),t.properties())}],[[nr,Gr],function(t,i){var u=i[1];return Bu(i[0].evaluate(t),u.evaluate(t))}]]},get:{type:Sr,overloads:[[[nr],function(t,i){return Ko(i[0].evaluate(t),t.properties())}],[[nr,Gr],function(t,i){var u=i[1];return Ko(i[0].evaluate(t),u.evaluate(t))}]]},"feature-state":[Sr,[nr],function(t,i){return Ko(i[0].evaluate(t),t.featureState||{})}],properties:[Gr,[],function(t){return t.properties()}],"geometry-type":[nr,[],function(t){return t.geometryType()}],id:[Sr,[],function(t){return t.id()}],zoom:[Re,[],function(t){return t.globals.zoom}],"heatmap-density":[Re,[],function(t){return t.globals.heatmapDensity||0}],"line-progress":[Re,[],function(t){return t.globals.lineProgress||0}],accumulated:[Sr,[],function(t){return void 0===t.globals.accumulated?null:t.globals.accumulated}],"+":[Re,$a(Re),function(t,i){for(var u=0,g=0,_=i;g<_.length;g+=1)u+=_[g].evaluate(t);return u}],"*":[Re,$a(Re),function(t,i){for(var u=1,g=0,_=i;g<_.length;g+=1)u*=_[g].evaluate(t);return u}],"-":{type:Re,overloads:[[[Re,Re],function(t,i){var u=i[1];return i[0].evaluate(t)-u.evaluate(t)}],[[Re],function(t,i){return-i[0].evaluate(t)}]]},"/":[Re,[Re,Re],function(t,i){var u=i[1];return i[0].evaluate(t)/u.evaluate(t)}],"%":[Re,[Re,Re],function(t,i){var u=i[1];return i[0].evaluate(t)%u.evaluate(t)}],ln2:[Re,[],function(){return Math.LN2}],pi:[Re,[],function(){return Math.PI}],e:[Re,[],function(){return Math.E}],"^":[Re,[Re,Re],function(t,i){var u=i[1];return Math.pow(i[0].evaluate(t),u.evaluate(t))}],sqrt:[Re,[Re],function(t,i){return Math.sqrt(i[0].evaluate(t))}],log10:[Re,[Re],function(t,i){return Math.log(i[0].evaluate(t))/Math.LN10}],ln:[Re,[Re],function(t,i){return Math.log(i[0].evaluate(t))}],log2:[Re,[Re],function(t,i){return Math.log(i[0].evaluate(t))/Math.LN2}],sin:[Re,[Re],function(t,i){return Math.sin(i[0].evaluate(t))}],cos:[Re,[Re],function(t,i){return Math.cos(i[0].evaluate(t))}],tan:[Re,[Re],function(t,i){return Math.tan(i[0].evaluate(t))}],asin:[Re,[Re],function(t,i){return Math.asin(i[0].evaluate(t))}],acos:[Re,[Re],function(t,i){return Math.acos(i[0].evaluate(t))}],atan:[Re,[Re],function(t,i){return Math.atan(i[0].evaluate(t))}],min:[Re,$a(Re),function(t,i){return Math.min.apply(Math,i.map(function(u){return u.evaluate(t)}))}],max:[Re,$a(Re),function(t,i){return Math.max.apply(Math,i.map(function(u){return u.evaluate(t)}))}],abs:[Re,[Re],function(t,i){return Math.abs(i[0].evaluate(t))}],round:[Re,[Re],function(t,i){var u=i[0].evaluate(t);return u<0?-Math.round(-u):Math.round(u)}],floor:[Re,[Re],function(t,i){return Math.floor(i[0].evaluate(t))}],ceil:[Re,[Re],function(t,i){return Math.ceil(i[0].evaluate(t))}],"filter-==":[Ue,[nr,Sr],function(t,i){var u=i[0],g=i[1];return t.properties()[u.value]===g.value}],"filter-id-==":[Ue,[Sr],function(t,i){var u=i[0];return t.id()===u.value}],"filter-type-==":[Ue,[nr],function(t,i){var u=i[0];return t.geometryType()===u.value}],"filter-<":[Ue,[nr,Sr],function(t,i){var u=i[0],g=i[1],_=t.properties()[u.value],E=g.value;return typeof _==typeof E&&_<E}],"filter-id-<":[Ue,[Sr],function(t,i){var u=i[0],g=t.id(),_=u.value;return typeof g==typeof _&&g<_}],"filter->":[Ue,[nr,Sr],function(t,i){var u=i[0],g=i[1],_=t.properties()[u.value],E=g.value;return typeof _==typeof E&&_>E}],"filter-id->":[Ue,[Sr],function(t,i){var u=i[0],g=t.id(),_=u.value;return typeof g==typeof _&&g>_}],"filter-<=":[Ue,[nr,Sr],function(t,i){var u=i[0],g=i[1],_=t.properties()[u.value],E=g.value;return typeof _==typeof E&&_<=E}],"filter-id-<=":[Ue,[Sr],function(t,i){var u=i[0],g=t.id(),_=u.value;return typeof g==typeof _&&g<=_}],"filter->=":[Ue,[nr,Sr],function(t,i){var u=i[0],g=i[1],_=t.properties()[u.value],E=g.value;return typeof _==typeof E&&_>=E}],"filter-id->=":[Ue,[Sr],function(t,i){var u=i[0],g=t.id(),_=u.value;return typeof g==typeof _&&g>=_}],"filter-has":[Ue,[Sr],function(t,i){return i[0].value in t.properties()}],"filter-has-id":[Ue,[],function(t){return null!==t.id()&&void 0!==t.id()}],"filter-type-in":[Ue,[On(nr)],function(t,i){return i[0].value.indexOf(t.geometryType())>=0}],"filter-id-in":[Ue,[On(Sr)],function(t,i){return i[0].value.indexOf(t.id())>=0}],"filter-in-small":[Ue,[nr,On(Sr)],function(t,i){var u=i[0];return i[1].value.indexOf(t.properties()[u.value])>=0}],"filter-in-large":[Ue,[nr,On(Sr)],function(t,i){var u=i[0],g=i[1];return function(_,E,P,A){for(;P<=A;){var F=P+A>>1;if(E[F]===_)return!0;E[F]>_?A=F-1:P=F+1}return!1}(t.properties()[u.value],g.value,0,g.value.length-1)}],all:{type:Ue,overloads:[[[Ue,Ue],function(t,i){var u=i[1];return i[0].evaluate(t)&&u.evaluate(t)}],[$a(Ue),function(t,i){for(var u=0,g=i;u<g.length;u+=1)if(!g[u].evaluate(t))return!1;return!0}]]},any:{type:Ue,overloads:[[[Ue,Ue],function(t,i){var u=i[1];return i[0].evaluate(t)||u.evaluate(t)}],[$a(Ue),function(t,i){for(var u=0,g=i;u<g.length;u+=1)if(g[u].evaluate(t))return!0;return!1}]]},"!":[Ue,[Ue],function(t,i){return!i[0].evaluate(t)}],"is-supported-script":[Ue,[nr],function(t,i){var u=t.globals&&t.globals.isSupportedScript;return!u||u(i[0].evaluate(t))}],upcase:[nr,[nr],function(t,i){return i[0].evaluate(t).toUpperCase()}],downcase:[nr,[nr],function(t,i){return i[0].evaluate(t).toLowerCase()}],concat:[nr,$a(Sr),function(t,i){return i.map(function(u){return Rs(u.evaluate(t))}).join("")}],"resolved-locale":[nr,[un],function(t,i){return i[0].evaluate(t).resolvedLocale()}]});var jo=function(t,i){var u;this.expression=t,this._warningHistory={},this._evaluator=new Wo,this._defaultValue=i?"color"===(u=i).type&&aa(u.default)?new Pn(0,0,0,0):"color"===u.type?Pn.parse(u.default)||null:void 0===u.default?null:u.default:null,this._enumValues=i&&"enum"===i.type?i.values:null};function Na(t){return Array.isArray(t)&&t.length>0&&"string"==typeof t[0]&&t[0]in ws}function Pa(t,i){var _,E,u=new io(ws,[],i?(E={color:ln,string:nr,number:Re,enum:nr,boolean:Ue,formatted:ir,resolvedImage:ci},"array"===(_=i).type?On(E[_.value]||Sr,_.length):E[_.type]):void 0),g=u.parse(t,void 0,void 0,void 0,i&&"string"===i.type?{typeAnnotation:"coerce"}:void 0);return g?Ku(new jo(g,i)):ts(u.errors)}jo.prototype.evaluateWithoutErrorHandling=function(t,i,u,g,_,E){return this._evaluator.globals=t,this._evaluator.feature=i,this._evaluator.featureState=u,this._evaluator.canonical=g,this._evaluator.availableImages=_||null,this._evaluator.formattedSection=E,this.expression.evaluate(this._evaluator)},jo.prototype.evaluate=function(t,i,u,g,_,E){this._evaluator.globals=t,this._evaluator.feature=i||null,this._evaluator.featureState=u||null,this._evaluator.canonical=g,this._evaluator.availableImages=_||null,this._evaluator.formattedSection=E||null;try{var P=this.expression.evaluate(this._evaluator);if(null==P||"number"==typeof P&&P!=P)return this._defaultValue;if(this._enumValues&&!(P in this._enumValues))throw new Ai("Expected value to be one of "+Object.keys(this._enumValues).map(function(A){return JSON.stringify(A)}).join(", ")+", but found "+JSON.stringify(P)+" instead.");return P}catch(A){return this._warningHistory[A.message]||(this._warningHistory[A.message]=!0,"undefined"!=typeof console&&console.warn(A.message)),this._defaultValue}};var hs=function(t,i){this.kind=t,this._styleExpression=i,this.isStateDependent="constant"!==t&&!zs(i.expression)};hs.prototype.evaluateWithoutErrorHandling=function(t,i,u,g,_,E){return this._styleExpression.evaluateWithoutErrorHandling(t,i,u,g,_,E)},hs.prototype.evaluate=function(t,i,u,g,_,E){return this._styleExpression.evaluate(t,i,u,g,_,E)};var za=function(t,i,u,g){this.kind=t,this.zoomStops=u,this._styleExpression=i,this.isStateDependent="camera"!==t&&!zs(i.expression),this.interpolationType=g};function Eo(t,i){if("error"===(t=Pa(t,i)).result)return t;var u=t.value.expression,g=$i(u);if(!g&&!Nn(i))return ts([new cr("","data expressions not supported")]);var _=eu(u,["zoom"]);if(!_&&!va(i))return ts([new cr("","zoom expressions not supported")]);var E=function P(A){var F=null;if(A instanceof Qa)F=P(A.result);else if(A instanceof Go)for(var U=0,q=A.args;U<q.length&&!(F=P(q[U]));U+=1);else(A instanceof co||A instanceof si)&&A.input instanceof Lo&&"zoom"===A.input.name&&(F=A);return F instanceof cr||A.eachChild(function(G){var K=P(G);K instanceof cr?F=K:!F&&K?F=new cr("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):F&&K&&F!==K&&(F=new cr("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),F}(u);return E||_?E instanceof cr?ts([E]):E instanceof si&&!mu(i)?ts([new cr("",'"interpolate" expressions cannot be used with this property')]):Ku(E?new za(g?"camera":"composite",t.value,E.labels,E instanceof si?E.interpolation:void 0):new hs(g?"constant":"source",t.value)):ts([new cr("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}za.prototype.evaluateWithoutErrorHandling=function(t,i,u,g,_,E){return this._styleExpression.evaluateWithoutErrorHandling(t,i,u,g,_,E)},za.prototype.evaluate=function(t,i,u,g,_,E){return this._styleExpression.evaluate(t,i,u,g,_,E)},za.prototype.interpolationFactor=function(t,i,u){return this.interpolationType?si.interpolationFactor(this.interpolationType,t,i,u):0};var qu=function(t,i){this._parameters=t,this._specification=i,ur(this,function u(g,_){var E,P,A,F="color"===_.type,U=g.stops&&"object"==typeof g.stops[0][0],q=U||!(U||void 0!==g.property),G=g.type||(mu(_)?"exponential":"interval");if(F&&((g=ur({},g)).stops&&(g.stops=g.stops.map(function(xr){return[xr[0],Pn.parse(xr[1])]})),g.default=Pn.parse(g.default?g.default:_.default)),g.colorSpace&&"rgb"!==g.colorSpace&&!cs[g.colorSpace])throw new Error("Unknown color space: "+g.colorSpace);if("exponential"===G)E=_a;else if("interval"===G)E=ou;else if("categorical"===G){E=Mc,P=Object.create(null);for(var K=0,ot=g.stops;K<ot.length;K+=1){var It=ot[K];P[It[0]]=It[1]}A=typeof g.stops[0][0]}else{if("identity"!==G)throw new Error('Unknown function type "'+G+'"');E=au}if(U){for(var Mt={},Zt=[],Xt=0;Xt<g.stops.length;Xt++){var ce=g.stops[Xt],fe=ce[0].zoom;void 0===Mt[fe]&&(Mt[fe]={zoom:fe,type:g.type,property:g.property,default:g.default,stops:[]},Zt.push(fe)),Mt[fe].stops.push([ce[0].value,ce[1]])}for(var Ce=[],Pe=0,be=Zt;Pe<be.length;Pe+=1){var ar=be[Pe];Ce.push([Mt[ar].zoom,u(Mt[ar],_)])}var lr={name:"linear"};return{kind:"composite",interpolationType:lr,interpolationFactor:si.interpolationFactor.bind(void 0,lr),zoomStops:Ce.map(function(xr){return xr[0]}),evaluate:function(xr,kr){var Ir=xr.zoom;return _a({stops:Ce,base:g.base},_,Ir).evaluate(Ir,kr)}}}if(q){var zr="exponential"===G?{name:"exponential",base:void 0!==g.base?g.base:1}:null;return{kind:"camera",interpolationType:zr,interpolationFactor:si.interpolationFactor.bind(void 0,zr),zoomStops:g.stops.map(function(xr){return xr[0]}),evaluate:function(xr){return E(g,_,xr.zoom,P,A)}}}return{kind:"source",evaluate:function(xr,kr){var Ir=kr&&kr.properties?kr.properties[g.property]:void 0;return void 0===Ir?Uu(g.default,_.default):E(g,_,Ir,P,A)}}}(this._parameters,this._specification))};function es(t){var i=t.key,u=t.value,g=t.valueSpec||{},_=t.objectElementValidators||{},E=t.style,P=t.styleSpec,A=[],F=Xn(u);if("object"!==F)return[new Ut(i,u,"object expected, "+F+" found")];for(var U in u){var q=U.split(".")[0],G=g[q]||g["*"],K=void 0;if(_[q])K=_[q];else if(g[q])K=zn;else if(_["*"])K=_["*"];else{if(!g["*"]){A.push(new Ut(i,u[U],'unknown property "'+U+'"'));continue}K=zn}A=A.concat(K({key:(i&&i+".")+U,value:u[U],valueSpec:G,style:E,styleSpec:P,object:u,objectKey:U},u))}for(var ot in g)_[ot]||g[ot].required&&void 0===g[ot].default&&void 0===u[ot]&&A.push(new Ut(i,u,'missing required property "'+ot+'"'));return A}function Qo(t){var i=t.value,u=t.valueSpec,g=t.style,_=t.styleSpec,E=t.key,P=t.arrayElementValidator||zn;if("array"!==Xn(i))return[new Ut(E,i,"array expected, "+Xn(i)+" found")];if(u.length&&i.length!==u.length)return[new Ut(E,i,"array length "+u.length+" expected, length "+i.length+" found")];if(u["min-length"]&&i.length<u["min-length"])return[new Ut(E,i,"array length at least "+u["min-length"]+" expected, length "+i.length+" found")];var A={type:u.value,values:u.values};_.$version<7&&(A.function=u.function),"object"===Xn(u.value)&&(A=u.value);for(var F=[],U=0;U<i.length;U++)F=F.concat(P({array:i,arrayIndex:U,value:i[U],valueSpec:A,style:g,styleSpec:_,key:E+"["+U+"]"}));return F}function js(t){var i=t.key,u=t.value,g=t.valueSpec,_=Xn(u);return"number"===_&&u!=u&&(_="NaN"),"number"!==_?[new Ut(i,u,"number expected, "+_+" found")]:"minimum"in g&&u<g.minimum?[new Ut(i,u,u+" is less than the minimum value "+g.minimum)]:"maximum"in g&&u>g.maximum?[new Ut(i,u,u+" is greater than the maximum value "+g.maximum)]:[]}function ka(t){var i,u,g,_=t.valueSpec,E=ge(t.value.type),P={},A="categorical"!==E&&void 0===t.value.property,F=!A,U="array"===Xn(t.value.stops)&&"array"===Xn(t.value.stops[0])&&"object"===Xn(t.value.stops[0][0]),q=es({key:t.key,value:t.value,valueSpec:t.styleSpec.function,style:t.style,styleSpec:t.styleSpec,objectElementValidators:{stops:function(ot){if("identity"===E)return[new Ut(ot.key,ot.value,'identity function may not have a "stops" property')];var It=[],Mt=ot.value;return It=It.concat(Qo({key:ot.key,value:Mt,valueSpec:ot.valueSpec,style:ot.style,styleSpec:ot.styleSpec,arrayElementValidator:G})),"array"===Xn(Mt)&&0===Mt.length&&It.push(new Ut(ot.key,Mt,"array must have at least one stop")),It},default:function(ot){return zn({key:ot.key,value:ot.value,valueSpec:_,style:ot.style,styleSpec:ot.styleSpec})}}});return"identity"===E&&A&&q.push(new Ut(t.key,t.value,'missing required property "property"')),"identity"===E||t.value.stops||q.push(new Ut(t.key,t.value,'missing required property "stops"')),"exponential"===E&&t.valueSpec.expression&&!mu(t.valueSpec)&&q.push(new Ut(t.key,t.value,"exponential functions not supported")),t.styleSpec.$version>=8&&(F&&!Nn(t.valueSpec)?q.push(new Ut(t.key,t.value,"property functions not supported")):A&&!va(t.valueSpec)&&q.push(new Ut(t.key,t.value,"zoom functions not supported"))),"categorical"!==E&&!U||void 0!==t.value.property||q.push(new Ut(t.key,t.value,'"property" property is required')),q;function G(ot){var It=[],Mt=ot.value,Zt=ot.key;if("array"!==Xn(Mt))return[new Ut(Zt,Mt,"array expected, "+Xn(Mt)+" found")];if(2!==Mt.length)return[new Ut(Zt,Mt,"array length 2 expected, length "+Mt.length+" found")];if(U){if("object"!==Xn(Mt[0]))return[new Ut(Zt,Mt,"object expected, "+Xn(Mt[0])+" found")];if(void 0===Mt[0].zoom)return[new Ut(Zt,Mt,"object stop key must have zoom")];if(void 0===Mt[0].value)return[new Ut(Zt,Mt,"object stop key must have value")];if(g&&g>ge(Mt[0].zoom))return[new Ut(Zt,Mt[0].zoom,"stop zoom values must appear in ascending order")];ge(Mt[0].zoom)!==g&&(g=ge(Mt[0].zoom),u=void 0,P={}),It=It.concat(es({key:Zt+"[0]",value:Mt[0],valueSpec:{zoom:{}},style:ot.style,styleSpec:ot.styleSpec,objectElementValidators:{zoom:js,value:K}}))}else It=It.concat(K({key:Zt+"[0]",value:Mt[0],valueSpec:{},style:ot.style,styleSpec:ot.styleSpec},Mt));return Na(Oe(Mt[1]))?It.concat([new Ut(Zt+"[1]",Mt[1],"expressions are not allowed in function stops.")]):It.concat(zn({key:Zt+"[1]",value:Mt[1],valueSpec:_,style:ot.style,styleSpec:ot.styleSpec}))}function K(ot,It){var Mt=Xn(ot.value),Zt=ge(ot.value),Xt=null!==ot.value?ot.value:It;if(i){if(Mt!==i)return[new Ut(ot.key,Xt,Mt+" stop domain type must match previous stop domain type "+i)]}else i=Mt;if("number"!==Mt&&"string"!==Mt&&"boolean"!==Mt)return[new Ut(ot.key,Xt,"stop domain value must be a number, string, or boolean")];if("number"!==Mt&&"categorical"!==E){var ce="number expected, "+Mt+" found";return Nn(_)&&void 0===E&&(ce+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Ut(ot.key,Xt,ce)]}return"categorical"!==E||"number"!==Mt||isFinite(Zt)&&Math.floor(Zt)===Zt?"categorical"!==E&&"number"===Mt&&void 0!==u&&Zt<u?[new Ut(ot.key,Xt,"stop domain values must appear in ascending order")]:(u=Zt,"categorical"===E&&Zt in P?[new Ut(ot.key,Xt,"stop domain values must be unique")]:(P[Zt]=!0,[])):[new Ut(ot.key,Xt,"integer expected, found "+Zt)]}}function yu(t){var i=("property"===t.expressionContext?Eo:Pa)(Oe(t.value),t.valueSpec);if("error"===i.result)return i.value.map(function(g){return new Ut(""+t.key+g.key,t.value,g.message)});var u=i.value.expression||i.value._styleExpression.expression;if("property"===t.expressionContext&&"text-font"===t.propertyKey&&!u.outputDefined())return[new Ut(t.key,t.value,'Invalid data expression for "'+t.propertyKey+'". Output values must be contained as literals within the expression.')];if("property"===t.expressionContext&&"layout"===t.propertyType&&!zs(u))return[new Ut(t.key,t.value,'"feature-state" data expressions are not supported with layout properties.')];if("filter"===t.expressionContext&&!zs(u))return[new Ut(t.key,t.value,'"feature-state" data expressions are not supported with filters.')];if(t.expressionContext&&0===t.expressionContext.indexOf("cluster")){if(!eu(u,["zoom","feature-state"]))return[new Ut(t.key,t.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if("cluster-initial"===t.expressionContext&&!$i(u))return[new Ut(t.key,t.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Do(t){var i=t.key,u=t.value,g=t.valueSpec,_=[];return Array.isArray(g.values)?-1===g.values.indexOf(ge(u))&&_.push(new Ut(i,u,"expected one of ["+g.values.join(", ")+"], "+JSON.stringify(u)+" found")):-1===Object.keys(g.values).indexOf(ge(u))&&_.push(new Ut(i,u,"expected one of ["+Object.keys(g.values).join(", ")+"], "+JSON.stringify(u)+" found")),_}function Mu(t){if(!0===t||!1===t)return!0;if(!Array.isArray(t)||0===t.length)return!1;switch(t[0]){case"has":return t.length>=2&&"$id"!==t[1]&&"$type"!==t[1];case"in":return t.length>=3&&("string"!=typeof t[1]||Array.isArray(t[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return 3!==t.length||Array.isArray(t[1])||Array.isArray(t[2]);case"any":case"all":for(var i=0,u=t.slice(1);i<u.length;i+=1){var g=u[i];if(!Mu(g)&&"boolean"!=typeof g)return!1}return!0;default:return!0}}qu.deserialize=function(t){return new qu(t._parameters,t._specification)},qu.serialize=function(t){return{_parameters:t._parameters,_specification:t._specification}};var Tu={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function Es(t){if(null==t)return{filter:function(){return!0},needGeometry:!1};Mu(t)||(t=Qu(t));var i=Pa(t,Tu);if("error"===i.result)throw new Error(i.value.map(function(u){return u.key+": "+u.message}).join(", "));return{filter:function(u,g,_){return i.value.evaluate(u,g,{},_)},needGeometry:function u(g){if(!Array.isArray(g))return!1;if("within"===g[0])return!0;for(var _=1;_<g.length;_++)if(u(g[_]))return!0;return!1}(t)}}function Tc(t,i){return t<i?-1:t>i?1:0}function Qu(t){if(!t)return!0;var i,u=t[0];return t.length<=1?"any"!==u:"=="===u?Xs(t[1],t[2],"=="):"!="===u?su(Xs(t[1],t[2],"==")):"<"===u||">"===u||"<="===u||">="===u?Xs(t[1],t[2],u):"any"===u?(i=t.slice(1),["any"].concat(i.map(Qu))):"all"===u?["all"].concat(t.slice(1).map(Qu)):"none"===u?["all"].concat(t.slice(1).map(Qu).map(su)):"in"===u?Cs(t[1],t.slice(2)):"!in"===u?su(Cs(t[1],t.slice(2))):"has"===u?Ro(t[1]):"!has"===u?su(Ro(t[1])):"within"!==u||t}function Xs(t,i,u){switch(t){case"$type":return["filter-type-"+u,i];case"$id":return["filter-id-"+u,i];default:return["filter-"+u,t,i]}}function Cs(t,i){if(0===i.length)return!1;switch(t){case"$type":return["filter-type-in",["literal",i]];case"$id":return["filter-id-in",["literal",i]];default:return i.length>200&&!i.some(function(u){return typeof u!=typeof i[0]})?["filter-in-large",t,["literal",i.sort(Tc)]]:["filter-in-small",t,["literal",i]]}}function Ro(t){switch(t){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",t]}}function su(t){return["!",t]}function No(t){return Mu(Oe(t.value))?yu(ur({},t,{expressionContext:"filter",valueSpec:{value:"boolean"}})):function i(u){var g=u.value,_=u.key;if("array"!==Xn(g))return[new Ut(_,g,"array expected, "+Xn(g)+" found")];var E,P=u.styleSpec,A=[];if(g.length<1)return[new Ut(_,g,"filter array must have at least 1 element")];switch(A=A.concat(Do({key:_+"[0]",value:g[0],valueSpec:P.filter_operator,style:u.style,styleSpec:u.styleSpec})),ge(g[0])){case"<":case"<=":case">":case">=":g.length>=2&&"$type"===ge(g[1])&&A.push(new Ut(_,g,'"$type" cannot be use with operator "'+g[0]+'"'));case"==":case"!=":3!==g.length&&A.push(new Ut(_,g,'filter array for operator "'+g[0]+'" must have 3 elements'));case"in":case"!in":g.length>=2&&"string"!==(E=Xn(g[1]))&&A.push(new Ut(_+"[1]",g[1],"string expected, "+E+" found"));for(var F=2;F<g.length;F++)E=Xn(g[F]),"$type"===ge(g[1])?A=A.concat(Do({key:_+"["+F+"]",value:g[F],valueSpec:P.geometry_type,style:u.style,styleSpec:u.styleSpec})):"string"!==E&&"number"!==E&&"boolean"!==E&&A.push(new Ut(_+"["+F+"]",g[F],"string, number, or boolean expected, "+E+" found"));break;case"any":case"all":case"none":for(var U=1;U<g.length;U++)A=A.concat(i({key:_+"["+U+"]",value:g[U],style:u.style,styleSpec:u.styleSpec}));break;case"has":case"!has":E=Xn(g[1]),2!==g.length?A.push(new Ut(_,g,'filter array for "'+g[0]+'" operator must have 2 elements')):"string"!==E&&A.push(new Ut(_+"[1]",g[1],"string expected, "+E+" found"));break;case"within":E=Xn(g[1]),2!==g.length?A.push(new Ut(_,g,'filter array for "'+g[0]+'" operator must have 2 elements')):"object"!==E&&A.push(new Ut(_+"[1]",g[1],"object expected, "+E+" found"))}return A}(t)}function rs(t,i){var u=t.key,g=t.style,_=t.styleSpec,E=t.value,P=t.objectKey,A=_[i+"_"+t.layerType];if(!A)return[];var F=P.match(/^(.*)-transition$/);if("paint"===i&&F&&A[F[1]]&&A[F[1]].transition)return zn({key:u,value:E,valueSpec:_.transition,style:g,styleSpec:_});var U,q=t.valueSpec||A[P];if(!q)return[new Ut(u,E,'unknown property "'+P+'"')];if("string"===Xn(E)&&Nn(q)&&!q.tokens&&(U=/^{([^}]+)}$/.exec(E)))return[new Ut(u,E,'"'+P+'" does not support interpolation syntax\nUse an identity property function instead: `{ "type": "identity", "property": '+JSON.stringify(U[1])+" }`.")];var G=[];return"symbol"===t.layerType&&("text-field"===P&&g&&!g.glyphs&&G.push(new Ut(u,E,'use of "text-field" requires a style "glyphs" property')),"text-font"===P&&aa(Oe(E))&&"identity"===ge(E.type)&&G.push(new Ut(u,E,'"text-font" does not support identity functions'))),G.concat(zn({key:t.key,value:E,valueSpec:q,style:g,styleSpec:_,expressionContext:"property",propertyType:i,propertyKey:P}))}function Ss(t){return rs(t,"paint")}function $u(t){return rs(t,"layout")}function Fs(t){var i=[],u=t.value,g=t.key,_=t.style,E=t.styleSpec;u.type||u.ref||i.push(new Ut(g,u,'either "type" or "ref" is required'));var P,A=ge(u.type),F=ge(u.ref);if(u.id)for(var U=ge(u.id),q=0;q<t.arrayIndex;q++){var G=_.layers[q];ge(G.id)===U&&i.push(new Ut(g,u.id,'duplicate layer id "'+u.id+'", previously used at line '+G.id.__line__))}if("ref"in u)["type","source","source-layer","filter","layout"].forEach(function(It){It in u&&i.push(new Ut(g,u[It],'"'+It+'" is prohibited for ref layers'))}),_.layers.forEach(function(It){ge(It.id)===F&&(P=It)}),P?P.ref?i.push(new Ut(g,u.ref,"ref cannot reference another ref layer")):A=ge(P.type):i.push(new Ut(g,u.ref,'ref layer "'+F+'" not found'));else if("background"!==A)if(u.source){var K=_.sources&&_.sources[u.source],ot=K&&ge(K.type);K?"vector"===ot&&"raster"===A?i.push(new Ut(g,u.source,'layer "'+u.id+'" requires a raster source')):"raster"===ot&&"raster"!==A?i.push(new Ut(g,u.source,'layer "'+u.id+'" requires a vector source')):"vector"!==ot||u["source-layer"]?"raster-dem"===ot&&"hillshade"!==A?i.push(new Ut(g,u.source,"raster-dem source can only be used with layer type 'hillshade'.")):"line"!==A||!u.paint||!u.paint["line-gradient"]||"geojson"===ot&&K.lineMetrics||i.push(new Ut(g,u,'layer "'+u.id+'" specifies a line-gradient, which requires a GeoJSON source with `lineMetrics` enabled.')):i.push(new Ut(g,u,'layer "'+u.id+'" must specify a "source-layer"')):i.push(new Ut(g,u.source,'source "'+u.source+'" not found'))}else i.push(new Ut(g,u,'missing required property "source"'));return i=i.concat(es({key:g,value:u,valueSpec:E.layer,style:t.style,styleSpec:t.styleSpec,objectElementValidators:{"*":function(){return[]},type:function(){return zn({key:g+".type",value:u.type,valueSpec:E.layer.type,style:t.style,styleSpec:t.styleSpec,object:u,objectKey:"type"})},filter:No,layout:function(It){return es({layer:u,key:It.key,value:It.value,style:It.style,styleSpec:It.styleSpec,objectElementValidators:{"*":function(Mt){return $u(ur({layerType:A},Mt))}}})},paint:function(It){return es({layer:u,key:It.key,value:It.value,style:It.style,styleSpec:It.styleSpec,objectElementValidators:{"*":function(Mt){return Ss(ur({layerType:A},Mt))}}})}}}))}function Yn(t){var i=t.value,u=t.key,g=Xn(i);return"string"!==g?[new Ut(u,i,"string expected, "+g+" found")]:[]}var Fa={promoteId:function(t){var i=t.key,u=t.value;if("string"===Xn(u))return Yn({key:i,value:u});var g=[];for(var _ in u)g.push.apply(g,Yn({key:i+"."+_,value:u[_]}));return g}};function Hi(t){var i=t.value,u=t.key,g=t.styleSpec,_=t.style;if(!i.type)return[new Ut(u,i,'"type" is required')];var E,P=ge(i.type);switch(P){case"vector":case"raster":case"raster-dem":return es({key:u,value:i,valueSpec:g["source_"+P.replace("-","_")],style:t.style,styleSpec:g,objectElementValidators:Fa});case"geojson":if(E=es({key:u,value:i,valueSpec:g.source_geojson,style:_,styleSpec:g,objectElementValidators:Fa}),i.cluster)for(var A in i.clusterProperties){var F=i.clusterProperties[A],U=F[0],q="string"==typeof U?[U,["accumulated"],["get",A]]:U;E.push.apply(E,yu({key:u+"."+A+".map",value:F[1],expressionContext:"cluster-map"})),E.push.apply(E,yu({key:u+"."+A+".reduce",value:q,expressionContext:"cluster-reduce"}))}return E;case"video":return es({key:u,value:i,valueSpec:g.source_video,style:_,styleSpec:g});case"image":return es({key:u,value:i,valueSpec:g.source_image,style:_,styleSpec:g});case"canvas":return[new Ut(u,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Do({key:u+".type",value:i.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:_,styleSpec:g})}}function zo(t){var i=t.value,u=t.styleSpec,g=u.light,_=t.style,E=[],P=Xn(i);if(void 0===i)return E;if("object"!==P)return E.concat([new Ut("light",i,"object expected, "+P+" found")]);for(var A in i){var F=A.match(/^(.*)-transition$/);E=E.concat(F&&g[F[1]]&&g[F[1]].transition?zn({key:A,value:i[A],valueSpec:u.transition,style:_,styleSpec:u}):g[A]?zn({key:A,value:i[A],valueSpec:g[A],style:_,styleSpec:u}):[new Ut(A,i[A],'unknown property "'+A+'"')])}return E}var _n={"*":function(){return[]},array:Qo,boolean:function(t){var i=t.value,u=t.key,g=Xn(i);return"boolean"!==g?[new Ut(u,i,"boolean expected, "+g+" found")]:[]},number:js,color:function(t){var i=t.key,u=t.value,g=Xn(u);return"string"!==g?[new Ut(i,u,"color expected, "+g+" found")]:null===Zo(u)?[new Ut(i,u,'color expected, "'+u+'" found')]:[]},constants:je,enum:Do,filter:No,function:ka,layer:Fs,object:es,source:Hi,light:zo,string:Yn,formatted:function(t){return 0===Yn(t).length?[]:yu(t)},resolvedImage:function(t){return 0===Yn(t).length?[]:yu(t)}};function zn(t){var i=t.value,u=t.valueSpec,g=t.styleSpec;return u.expression&&aa(ge(i))?ka(t):u.expression&&Na(Oe(i))?yu(t):u.type&&_n[u.type]?_n[u.type](t):es(ur({},t,{valueSpec:u.type?g[u.type]:u}))}function sa(t){var i=t.value,u=t.key,g=Yn(t);return g.length||(-1===i.indexOf("{fontstack}")&&g.push(new Ut(u,i,'"glyphs" url must include a "{fontstack}" token')),-1===i.indexOf("{range}")&&g.push(new Ut(u,i,'"glyphs" url must include a "{range}" token'))),g}function Ma(t,i){void 0===i&&(i=_t);var u=[];return u=u.concat(zn({key:"",value:t,valueSpec:i.$root,styleSpec:i,style:t,objectElementValidators:{glyphs:sa,"*":function(){return[]}}})),t.constants&&(u=u.concat(je({key:"constants",value:t.constants,style:t,styleSpec:i}))),ko(u)}function ko(t){return[].concat(t).sort(function(i,u){return i.line-u.line})}function oo(t){return function(){for(var i=[],u=arguments.length;u--;)i[u]=arguments[u];return ko(t.apply(this,i))}}Ma.source=oo(Hi),Ma.light=oo(zo),Ma.layer=oo(Fs),Ma.filter=oo(No),Ma.paintProperty=oo(Ss),Ma.layoutProperty=oo($u);var Ta=Ma,ns=Ta.light,Au=Ta.paintProperty,Ys=Ta.layoutProperty;function is(t,i){var u=!1;if(i&&i.length)for(var g=0,_=i;g<_.length;g+=1)t.fire(new ie(new Error(_[g].message))),u=!0;return u}var _i=Ba;function Ba(t,i,u){var g=this.cells=[];if(t instanceof ArrayBuffer){this.arrayBuffer=t;var _=new Int32Array(this.arrayBuffer);t=_[0],this.d=(i=_[1])+2*(u=_[2]);for(var E=0;E<this.d*this.d;E++){var P=_[3+E],A=_[3+E+1];g.push(P===A?null:_.subarray(P,A))}var F=_[3+g.length+1];this.keys=_.subarray(_[3+g.length],F),this.bboxes=_.subarray(F),this.insert=this._insertReadonly}else{this.d=i+2*u;for(var U=0;U<this.d*this.d;U++)g.push([]);this.keys=[],this.bboxes=[]}this.n=i,this.extent=t,this.padding=u,this.scale=i/t,this.uid=0;var q=u/i*t;this.min=-q,this.max=t+q}Ba.prototype.insert=function(t,i,u,g,_){this._forEachCell(i,u,g,_,this._insertCell,this.uid++),this.keys.push(t),this.bboxes.push(i),this.bboxes.push(u),this.bboxes.push(g),this.bboxes.push(_)},Ba.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},Ba.prototype._insertCell=function(t,i,u,g,_,E){this.cells[_].push(E)},Ba.prototype.query=function(t,i,u,g,_){var E=this.min,P=this.max;if(t<=E&&i<=E&&P<=u&&P<=g&&!_)return Array.prototype.slice.call(this.keys);var A=[];return this._forEachCell(t,i,u,g,this._queryCell,A,{},_),A},Ba.prototype._queryCell=function(t,i,u,g,_,E,P,A){var F=this.cells[_];if(null!==F)for(var U=this.keys,q=this.bboxes,G=0;G<F.length;G++){var K=F[G];if(void 0===P[K]){var ot=4*K;(A?A(q[ot+0],q[ot+1],q[ot+2],q[ot+3]):t<=q[ot+2]&&i<=q[ot+3]&&u>=q[ot+0]&&g>=q[ot+1])?(P[K]=!0,E.push(U[K])):P[K]=!1}}},Ba.prototype._forEachCell=function(t,i,u,g,_,E,P,A){for(var F=this._convertToCellCoord(t),U=this._convertToCellCoord(i),q=this._convertToCellCoord(u),G=this._convertToCellCoord(g),K=F;K<=q;K++)for(var ot=U;ot<=G;ot++){var It=this.d*ot+K;if((!A||A(this._convertFromCellCoord(K),this._convertFromCellCoord(ot),this._convertFromCellCoord(K+1),this._convertFromCellCoord(ot+1)))&&_.call(this,t,i,u,g,It,E,P,A))return}},Ba.prototype._convertFromCellCoord=function(t){return(t-this.padding)/this.scale},Ba.prototype._convertToCellCoord=function(t){return Math.max(0,Math.min(this.d-1,Math.floor(t*this.scale)+this.padding))},Ba.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var t=this.cells,i=3+this.cells.length+1+1,u=0,g=0;g<this.cells.length;g++)u+=this.cells[g].length;var _=new Int32Array(i+u+this.keys.length+this.bboxes.length);_[0]=this.extent,_[1]=this.n,_[2]=this.padding;for(var E=i,P=0;P<t.length;P++){var A=t[P];_[3+P]=E,_.set(A,E),E+=A.length}return _[3+t.length]=E,_.set(this.keys,E),_[3+t.length+1]=E+=this.keys.length,_.set(this.bboxes,E),E+=this.bboxes.length,_.buffer};var Co=kt.ImageData,So=kt.ImageBitmap,Ji={};function er(t,i,u){void 0===u&&(u={}),Object.defineProperty(i,"_classRegistryKey",{value:t,writeable:!1}),Ji[t]={klass:i,omit:u.omit||[],shallow:u.shallow||[]}}for(var ua in er("Object",Object),_i.serialize=function(t,i){var u=t.toArrayBuffer();return i&&i.push(u),{buffer:u}},_i.deserialize=function(t){return new _i(t.buffer)},er("Grid",_i),er("Color",Pn),er("Error",Error),er("ResolvedImage",jn),er("StylePropertyFunction",qu),er("StyleExpression",jo,{omit:["_evaluator"]}),er("ZoomDependentExpression",za),er("ZoomConstantExpression",hs),er("CompoundExpression",Lo,{omit:["_evaluate"]}),ws)ws[ua]._classRegistryKey||er("Expression_"+ua,ws[ua]);function os(t){return t&&"undefined"!=typeof ArrayBuffer&&(t instanceof ArrayBuffer||t.constructor&&"ArrayBuffer"===t.constructor.name)}function Ua(t){return So&&t instanceof So}function ji(t,i){if(null==t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||t instanceof Boolean||t instanceof Number||t instanceof String||t instanceof Date||t instanceof RegExp)return t;if(os(t)||Ua(t))return i&&i.push(t),t;if(ArrayBuffer.isView(t)){var u=t;return i&&i.push(u.buffer),u}if(t instanceof Co)return i&&i.push(t.data.buffer),t;if(Array.isArray(t)){for(var g=[],_=0,E=t;_<E.length;_+=1)g.push(ji(E[_],i));return g}if("object"==typeof t){var P=t.constructor,A=P._classRegistryKey;if(!A)throw new Error("can't serialize object of unregistered class");var F=P.serialize?P.serialize(t,i):{};if(!P.serialize){for(var U in t)if(t.hasOwnProperty(U)&&!(Ji[A].omit.indexOf(U)>=0)){var q=t[U];F[U]=Ji[A].shallow.indexOf(U)>=0?q:ji(q,i)}t instanceof Error&&(F.message=t.message)}if(F.$name)throw new Error("$name property is reserved for worker serialization logic.");return"Object"!==A&&(F.$name=A),F}throw new Error("can't serialize object of type "+typeof t)}function ps(t){if(null==t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||t instanceof Boolean||t instanceof Number||t instanceof String||t instanceof Date||t instanceof RegExp||os(t)||Ua(t)||ArrayBuffer.isView(t)||t instanceof Co)return t;if(Array.isArray(t))return t.map(ps);if("object"==typeof t){var i=t.$name||"Object",u=Ji[i].klass;if(!u)throw new Error("can't deserialize unregistered class "+i);if(u.deserialize)return u.deserialize(t);for(var g=Object.create(u.prototype),_=0,E=Object.keys(t);_<E.length;_+=1){var P=E[_];if("$name"!==P){var A=t[P];g[P]=Ji[i].shallow.indexOf(P)>=0?A:ps(A)}}return g}throw new Error("can't deserialize object of type "+typeof t)}var xi=function(){this.first=!0};xi.prototype.update=function(t,i){var u=Math.floor(t);return this.first?(this.first=!1,this.lastIntegerZoom=u,this.lastIntegerZoomTime=0,this.lastZoom=t,this.lastFloorZoom=u,!0):(this.lastFloorZoom>u?(this.lastIntegerZoom=u+1,this.lastIntegerZoomTime=i):this.lastFloorZoom<u&&(this.lastIntegerZoom=u,this.lastIntegerZoomTime=i),t!==this.lastZoom&&(this.lastZoom=t,this.lastFloorZoom=u,!0))};var dr={"Latin-1 Supplement":function(t){return t>=128&&t<=255},Arabic:function(t){return t>=1536&&t<=1791},"Arabic Supplement":function(t){return t>=1872&&t<=1919},"Arabic Extended-A":function(t){return t>=2208&&t<=2303},"Hangul Jamo":function(t){return t>=4352&&t<=4607},"Unified Canadian Aboriginal Syllabics":function(t){return t>=5120&&t<=5759},Khmer:function(t){return t>=6016&&t<=6143},"Unified Canadian Aboriginal Syllabics Extended":function(t){return t>=6320&&t<=6399},"General Punctuation":function(t){return t>=8192&&t<=8303},"Letterlike Symbols":function(t){return t>=8448&&t<=8527},"Number Forms":function(t){return t>=8528&&t<=8591},"Miscellaneous Technical":function(t){return t>=8960&&t<=9215},"Control Pictures":function(t){return t>=9216&&t<=9279},"Optical Character Recognition":function(t){return t>=9280&&t<=9311},"Enclosed Alphanumerics":function(t){return t>=9312&&t<=9471},"Geometric Shapes":function(t){return t>=9632&&t<=9727},"Miscellaneous Symbols":function(t){return t>=9728&&t<=9983},"Miscellaneous Symbols and Arrows":function(t){return t>=11008&&t<=11263},"CJK Radicals Supplement":function(t){return t>=11904&&t<=12031},"Kangxi Radicals":function(t){return t>=12032&&t<=12255},"Ideographic Description Characters":function(t){return t>=12272&&t<=12287},"CJK Symbols and Punctuation":function(t){return t>=12288&&t<=12351},Hiragana:function(t){return t>=12352&&t<=12447},Katakana:function(t){return t>=12448&&t<=12543},Bopomofo:function(t){return t>=12544&&t<=12591},"Hangul Compatibility Jamo":function(t){return t>=12592&&t<=12687},Kanbun:function(t){return t>=12688&&t<=12703},"Bopomofo Extended":function(t){return t>=12704&&t<=12735},"CJK Strokes":function(t){return t>=12736&&t<=12783},"Katakana Phonetic Extensions":function(t){return t>=12784&&t<=12799},"Enclosed CJK Letters and Months":function(t){return t>=12800&&t<=13055},"CJK Compatibility":function(t){return t>=13056&&t<=13311},"CJK Unified Ideographs Extension A":function(t){return t>=13312&&t<=19903},"Yijing Hexagram Symbols":function(t){return t>=19904&&t<=19967},"CJK Unified Ideographs":function(t){return t>=19968&&t<=40959},"Yi Syllables":function(t){return t>=40960&&t<=42127},"Yi Radicals":function(t){return t>=42128&&t<=42191},"Hangul Jamo Extended-A":function(t){return t>=43360&&t<=43391},"Hangul Syllables":function(t){return t>=44032&&t<=55215},"Hangul Jamo Extended-B":function(t){return t>=55216&&t<=55295},"Private Use Area":function(t){return t>=57344&&t<=63743},"CJK Compatibility Ideographs":function(t){return t>=63744&&t<=64255},"Arabic Presentation Forms-A":function(t){return t>=64336&&t<=65023},"Vertical Forms":function(t){return t>=65040&&t<=65055},"CJK Compatibility Forms":function(t){return t>=65072&&t<=65103},"Small Form Variants":function(t){return t>=65104&&t<=65135},"Arabic Presentation Forms-B":function(t){return t>=65136&&t<=65279},"Halfwidth and Fullwidth Forms":function(t){return t>=65280&&t<=65519}};function Bi(t){for(var i=0,u=t;i<u.length;i+=1)if(tl(u[i].charCodeAt(0)))return!0;return!1}function tl(t){return!(746!==t&&747!==t&&(t<4352||!(dr["Bopomofo Extended"](t)||dr.Bopomofo(t)||dr["CJK Compatibility Forms"](t)&&!(t>=65097&&t<=65103)||dr["CJK Compatibility Ideographs"](t)||dr["CJK Compatibility"](t)||dr["CJK Radicals Supplement"](t)||dr["CJK Strokes"](t)||!(!dr["CJK Symbols and Punctuation"](t)||t>=12296&&t<=12305||t>=12308&&t<=12319||12336===t)||dr["CJK Unified Ideographs Extension A"](t)||dr["CJK Unified Ideographs"](t)||dr["Enclosed CJK Letters and Months"](t)||dr["Hangul Compatibility Jamo"](t)||dr["Hangul Jamo Extended-A"](t)||dr["Hangul Jamo Extended-B"](t)||dr["Hangul Jamo"](t)||dr["Hangul Syllables"](t)||dr.Hiragana(t)||dr["Ideographic Description Characters"](t)||dr.Kanbun(t)||dr["Kangxi Radicals"](t)||dr["Katakana Phonetic Extensions"](t)||dr.Katakana(t)&&12540!==t||!(!dr["Halfwidth and Fullwidth Forms"](t)||65288===t||65289===t||65293===t||t>=65306&&t<=65310||65339===t||65341===t||65343===t||t>=65371&&t<=65503||65507===t||t>=65512&&t<=65519)||!(!dr["Small Form Variants"](t)||t>=65112&&t<=65118||t>=65123&&t<=65126)||dr["Unified Canadian Aboriginal Syllabics"](t)||dr["Unified Canadian Aboriginal Syllabics Extended"](t)||dr["Vertical Forms"](t)||dr["Yijing Hexagram Symbols"](t)||dr["Yi Syllables"](t)||dr["Yi Radicals"](t))))}function fs(t){return!(tl(t)||(i=t,dr["Latin-1 Supplement"](i)&&(167===i||169===i||174===i||177===i||188===i||189===i||190===i||215===i||247===i)||dr["General Punctuation"](i)&&(8214===i||8224===i||8225===i||8240===i||8241===i||8251===i||8252===i||8258===i||8263===i||8264===i||8265===i||8273===i)||dr["Letterlike Symbols"](i)||dr["Number Forms"](i)||dr["Miscellaneous Technical"](i)&&(i>=8960&&i<=8967||i>=8972&&i<=8991||i>=8996&&i<=9e3||9003===i||i>=9085&&i<=9114||i>=9150&&i<=9165||9167===i||i>=9169&&i<=9179||i>=9186&&i<=9215)||dr["Control Pictures"](i)&&9251!==i||dr["Optical Character Recognition"](i)||dr["Enclosed Alphanumerics"](i)||dr["Geometric Shapes"](i)||dr["Miscellaneous Symbols"](i)&&!(i>=9754&&i<=9759)||dr["Miscellaneous Symbols and Arrows"](i)&&(i>=11026&&i<=11055||i>=11088&&i<=11097||i>=11192&&i<=11243)||dr["CJK Symbols and Punctuation"](i)||dr.Katakana(i)||dr["Private Use Area"](i)||dr["CJK Compatibility Forms"](i)||dr["Small Form Variants"](i)||dr["Halfwidth and Fullwidth Forms"](i)||8734===i||8756===i||8757===i||i>=9984&&i<=10087||i>=10102&&i<=10131||65532===i||65533===i));var i}function mi(t){return t>=1424&&t<=2303||dr["Arabic Presentation Forms-A"](t)||dr["Arabic Presentation Forms-B"](t)}function Is(t,i){return!(!i&&mi(t)||t>=2304&&t<=3583||t>=3840&&t<=4255||dr.Khmer(t))}function wl(t){for(var i=0,u=t;i<u.length;i+=1)if(mi(u[i].charCodeAt(0)))return!0;return!1}var uu=null,fo="unavailable",Oi=null,Fo=function(t){t&&"string"==typeof t&&t.indexOf("NetworkError")>-1&&(fo="error"),uu&&uu(t)};function Lu(){$o.fire(new Wt("pluginStateChange",{pluginStatus:fo,pluginURL:Oi}))}var $o=new Ht,as=function(){return fo},Ws=function(){if("deferred"!==fo||!Oi)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");fo="loading",Lu(),Oi&&di({url:Oi},function(t){t?Fo(t):(fo="loaded",Lu())})},Mn={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:function(){return"loaded"===fo||null!=Mn.applyArabicShaping},isLoading:function(){return"loading"===fo},setState:function(t){fo=t.pluginStatus,Oi=t.pluginURL},isParsed:function(){return null!=Mn.applyArabicShaping&&null!=Mn.processBidirectionalText&&null!=Mn.processStyledBidirectionalText},getPluginURL:function(){return Oi}},ii=function(t,i){this.zoom=t,i?(this.now=i.now,this.fadeDuration=i.fadeDuration,this.zoomHistory=i.zoomHistory,this.transition=i.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new xi,this.transition={})};ii.prototype.isSupportedScript=function(t){return function(i,u){for(var g=0,_=i;g<_.length;g+=1)if(!Is(_[g].charCodeAt(0),u))return!1;return!0}(t,Mn.isLoaded())},ii.prototype.crossFadingFactor=function(){return 0===this.fadeDuration?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)},ii.prototype.getCrossfadeParameters=function(){var t=this.zoom,i=t-Math.floor(t),u=this.crossFadingFactor();return t>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:i+(1-i)*u}:{fromScale:.5,toScale:1,t:1-(1-u)*i}};var ao=function(t,i){this.property=t,this.value=i,this.expression=function(u,g){if(aa(u))return new qu(u,g);if(Na(u)){var _=Eo(u,g);if("error"===_.result)throw new Error(_.value.map(function(P){return P.key+": "+P.message}).join(", "));return _.value}var E=u;return"string"==typeof u&&"color"===g.type&&(E=Pn.parse(u)),{kind:"constant",evaluate:function(){return E}}}(void 0===i?t.specification.default:i,t.specification)};ao.prototype.isDataDriven=function(){return"source"===this.expression.kind||"composite"===this.expression.kind},ao.prototype.possiblyEvaluate=function(t,i,u){return this.property.possiblyEvaluate(this,t,i,u)};var ta=function(t){this.property=t,this.value=new ao(t,void 0)};ta.prototype.transitioned=function(t,i){return new Ps(this.property,this.value,i,qt({},t.transition,this.transition),t.now)},ta.prototype.untransitioned=function(){return new Ps(this.property,this.value,null,{},0)};var la=function(t){this._properties=t,this._values=Object.create(t.defaultTransitionablePropertyValues)};la.prototype.getValue=function(t){return j(this._values[t].value.value)},la.prototype.setValue=function(t,i){this._values.hasOwnProperty(t)||(this._values[t]=new ta(this._values[t].property)),this._values[t].value=new ao(this._values[t].property,null===i?void 0:j(i))},la.prototype.getTransition=function(t){return j(this._values[t].transition)},la.prototype.setTransition=function(t,i){this._values.hasOwnProperty(t)||(this._values[t]=new ta(this._values[t].property)),this._values[t].transition=j(i)||void 0},la.prototype.serialize=function(){for(var t={},i=0,u=Object.keys(this._values);i<u.length;i+=1){var g=u[i],_=this.getValue(g);void 0!==_&&(t[g]=_);var E=this.getTransition(g);void 0!==E&&(t[g+"-transition"]=E)}return t},la.prototype.transitioned=function(t,i){for(var u=new Aa(this._properties),g=0,_=Object.keys(this._values);g<_.length;g+=1){var E=_[g];u._values[E]=this._values[E].transitioned(t,i._values[E])}return u},la.prototype.untransitioned=function(){for(var t=new Aa(this._properties),i=0,u=Object.keys(this._values);i<u.length;i+=1){var g=u[i];t._values[g]=this._values[g].untransitioned()}return t};var Ps=function(t,i,u,g,_){this.property=t,this.value=i,this.begin=_+g.delay||0,this.end=this.begin+g.duration||0,t.specification.transition&&(g.delay||g.duration)&&(this.prior=u)};Ps.prototype.possiblyEvaluate=function(t,i,u){var g=t.now||0,_=this.value.possiblyEvaluate(t,i,u),E=this.prior;if(E){if(g>this.end)return this.prior=null,_;if(this.value.isDataDriven())return this.prior=null,_;if(g<this.begin)return E.possiblyEvaluate(t,i,u);var P=(g-this.begin)/(this.end-this.begin);return this.property.interpolate(E.possiblyEvaluate(t,i,u),_,function(A){if(A<=0)return 0;if(A>=1)return 1;var F=A*A,U=F*A;return 4*(A<.5?U:3*(A-F)+U-.75)}(P))}return _};var Aa=function(t){this._properties=t,this._values=Object.create(t.defaultTransitioningPropertyValues)};Aa.prototype.possiblyEvaluate=function(t,i,u){for(var g=new Ms(this._properties),_=0,E=Object.keys(this._values);_<E.length;_+=1){var P=E[_];g._values[P]=this._values[P].possiblyEvaluate(t,i,u)}return g},Aa.prototype.hasTransition=function(){for(var t=0,i=Object.keys(this._values);t<i.length;t+=1)if(this._values[i[t]].prior)return!0;return!1};var ea=function(t){this._properties=t,this._values=Object.create(t.defaultPropertyValues)};ea.prototype.getValue=function(t){return j(this._values[t].value)},ea.prototype.setValue=function(t,i){this._values[t]=new ao(this._values[t].property,null===i?void 0:j(i))},ea.prototype.serialize=function(){for(var t={},i=0,u=Object.keys(this._values);i<u.length;i+=1){var g=u[i],_=this.getValue(g);void 0!==_&&(t[g]=_)}return t},ea.prototype.possiblyEvaluate=function(t,i,u){for(var g=new Ms(this._properties),_=0,E=Object.keys(this._values);_<E.length;_+=1){var P=E[_];g._values[P]=this._values[P].possiblyEvaluate(t,i,u)}return g};var ca=function(t,i,u){this.property=t,this.value=i,this.parameters=u};ca.prototype.isConstant=function(){return"constant"===this.value.kind},ca.prototype.constantOr=function(t){return"constant"===this.value.kind?this.value.value:t},ca.prototype.evaluate=function(t,i,u,g){return this.property.evaluate(this.value,this.parameters,t,i,u,g)};var Ms=function(t){this._properties=t,this._values=Object.create(t.defaultPossiblyEvaluatedValues)};Ms.prototype.get=function(t){return this._values[t]};var yr=function(t){this.specification=t};yr.prototype.possiblyEvaluate=function(t,i){return t.expression.evaluate(i)},yr.prototype.interpolate=function(t,i,u){var g=xs[this.specification.type];return g?g(t,i,u):t};var jr=function(t,i){this.specification=t,this.overrides=i};jr.prototype.possiblyEvaluate=function(t,i,u,g){return new ca(this,"constant"===t.expression.kind||"camera"===t.expression.kind?{kind:"constant",value:t.expression.evaluate(i,null,{},u,g)}:t.expression,i)},jr.prototype.interpolate=function(t,i,u){if("constant"!==t.value.kind||"constant"!==i.value.kind)return t;if(void 0===t.value.value||void 0===i.value.value)return new ca(this,{kind:"constant",value:void 0},t.parameters);var g=xs[this.specification.type];return g?new ca(this,{kind:"constant",value:g(t.value.value,i.value.value,u)},t.parameters):t},jr.prototype.evaluate=function(t,i,u,g,_,E){return"constant"===t.kind?t.value:t.evaluate(i,u,g,_,E)};var Ki=function(t){function i(){t.apply(this,arguments)}return t&&(i.__proto__=t),(i.prototype=Object.create(t&&t.prototype)).constructor=i,i.prototype.possiblyEvaluate=function(u,g,_,E){if(void 0===u.value)return new ca(this,{kind:"constant",value:void 0},g);if("constant"===u.expression.kind){var P=u.expression.evaluate(g,null,{},_,E),A="resolvedImage"===u.property.specification.type&&"string"!=typeof P?P.name:P,F=this._calculate(A,A,A,g);return new ca(this,{kind:"constant",value:F},g)}if("camera"===u.expression.kind){var U=this._calculate(u.expression.evaluate({zoom:g.zoom-1}),u.expression.evaluate({zoom:g.zoom}),u.expression.evaluate({zoom:g.zoom+1}),g);return new ca(this,{kind:"constant",value:U},g)}return new ca(this,u.expression,g)},i.prototype.evaluate=function(u,g,_,E,P,A){if("source"===u.kind){var F=u.evaluate(g,_,E,P,A);return this._calculate(F,F,F,g)}return"composite"===u.kind?this._calculate(u.evaluate({zoom:Math.floor(g.zoom)-1},_,E),u.evaluate({zoom:Math.floor(g.zoom)},_,E),u.evaluate({zoom:Math.floor(g.zoom)+1},_,E),g):u.value},i.prototype._calculate=function(u,g,_,E){return E.zoom>E.zoomHistory.lastIntegerZoom?{from:u,to:g}:{from:_,to:g}},i.prototype.interpolate=function(u){return u},i}(jr),ha=function(t){this.specification=t};ha.prototype.possiblyEvaluate=function(t,i,u,g){if(void 0!==t.value){if("constant"===t.expression.kind){var _=t.expression.evaluate(i,null,{},u,g);return this._calculate(_,_,_,i)}return this._calculate(t.expression.evaluate(new ii(Math.floor(i.zoom-1),i)),t.expression.evaluate(new ii(Math.floor(i.zoom),i)),t.expression.evaluate(new ii(Math.floor(i.zoom+1),i)),i)}},ha.prototype._calculate=function(t,i,u,g){return g.zoom>g.zoomHistory.lastIntegerZoom?{from:t,to:i}:{from:u,to:i}},ha.prototype.interpolate=function(t){return t};var xa=function(t){this.specification=t};xa.prototype.possiblyEvaluate=function(t,i,u,g){return!!t.expression.evaluate(i,null,{},u,g)},xa.prototype.interpolate=function(){return!1};var so=function(t){for(var i in this.properties=t,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[],t){var u=t[i];u.specification.overridable&&this.overridableProperties.push(i);var g=this.defaultPropertyValues[i]=new ao(u,void 0),_=this.defaultTransitionablePropertyValues[i]=new ta(u);this.defaultTransitioningPropertyValues[i]=_.untransitioned(),this.defaultPossiblyEvaluatedValues[i]=g.possiblyEvaluate({})}};er("DataDrivenProperty",jr),er("DataConstantProperty",yr),er("CrossFadedDataDrivenProperty",Ki),er("CrossFadedProperty",ha),er("ColorRampProperty",xa);var Wr=function(t){function i(u,g){if(t.call(this),this.id=u.id,this.type=u.type,this._featureFilter={filter:function(){return!0},needGeometry:!1},"custom"!==u.type&&(this.metadata=(u=u).metadata,this.minzoom=u.minzoom,this.maxzoom=u.maxzoom,"background"!==u.type&&(this.source=u.source,this.sourceLayer=u["source-layer"],this.filter=u.filter),g.layout&&(this._unevaluatedLayout=new ea(g.layout)),g.paint)){for(var _ in this._transitionablePaint=new la(g.paint),u.paint)this.setPaintProperty(_,u.paint[_],{validate:!1});for(var E in u.layout)this.setLayoutProperty(E,u.layout[E],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Ms(g.paint)}}return t&&(i.__proto__=t),(i.prototype=Object.create(t&&t.prototype)).constructor=i,i.prototype.getCrossfadeParameters=function(){return this._crossfadeParameters},i.prototype.getLayoutProperty=function(u){return"visibility"===u?this.visibility:this._unevaluatedLayout.getValue(u)},i.prototype.setLayoutProperty=function(u,g,_){void 0===_&&(_={}),null!=g&&this._validate(Ys,"layers."+this.id+".layout."+u,u,g,_)||("visibility"!==u?this._unevaluatedLayout.setValue(u,g):this.visibility=g)},i.prototype.getPaintProperty=function(u){return et(u,"-transition")?this._transitionablePaint.getTransition(u.slice(0,-"-transition".length)):this._transitionablePaint.getValue(u)},i.prototype.setPaintProperty=function(u,g,_){if(void 0===_&&(_={}),null!=g&&this._validate(Au,"layers."+this.id+".paint."+u,u,g,_))return!1;if(et(u,"-transition"))return this._transitionablePaint.setTransition(u.slice(0,-"-transition".length),g||void 0),!1;var E=this._transitionablePaint._values[u],P="cross-faded-data-driven"===E.property.specification["property-type"],A=E.value.isDataDriven(),F=E.value;this._transitionablePaint.setValue(u,g),this._handleSpecialPaintPropertyUpdate(u);var U=this._transitionablePaint._values[u].value;return U.isDataDriven()||A||P||this._handleOverridablePaintPropertyUpdate(u,F,U)},i.prototype._handleSpecialPaintPropertyUpdate=function(u){},i.prototype._handleOverridablePaintPropertyUpdate=function(u,g,_){return!1},i.prototype.isHidden=function(u){return!!(this.minzoom&&u<this.minzoom)||!!(this.maxzoom&&u>=this.maxzoom)||"none"===this.visibility},i.prototype.updateTransitions=function(u){this._transitioningPaint=this._transitionablePaint.transitioned(u,this._transitioningPaint)},i.prototype.hasTransition=function(){return this._transitioningPaint.hasTransition()},i.prototype.recalculate=function(u,g){u.getCrossfadeParameters&&(this._crossfadeParameters=u.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(u,void 0,g)),this.paint=this._transitioningPaint.possiblyEvaluate(u,void 0,g)},i.prototype.serialize=function(){var u={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(u.layout=u.layout||{},u.layout.visibility=this.visibility),lt(u,function(g,_){return!(void 0===g||"layout"===_&&!Object.keys(g).length||"paint"===_&&!Object.keys(g).length)})},i.prototype._validate=function(u,g,_,E,P){return void 0===P&&(P={}),(!P||!1!==P.validate)&&is(this,u.call(Ta,{key:g,layerType:this.type,objectKey:_,value:E,styleSpec:_t,style:{glyphs:!0,sprite:!0}}))},i.prototype.is3D=function(){return!1},i.prototype.isTileClipped=function(){return!1},i.prototype.hasOffscreenPass=function(){return!1},i.prototype.resize=function(){},i.prototype.isStateDependent=function(){for(var u in this.paint._values){var g=this.paint.get(u);if(g instanceof ca&&Nn(g.property.specification)&&("source"===g.value.kind||"composite"===g.value.kind)&&g.value.isStateDependent)return!0}return!1},i}(Ht),lu={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array},ss=function(t,i){this._structArray=t,this._pos1=i*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8},Jn=function(){this.isTransferred=!1,this.capacity=-1,this.resize(0)};function oi(t,i){void 0===i&&(i=1);var u=0,g=0;return{members:t.map(function(_){var E=lu[_.type].BYTES_PER_ELEMENT,P=u=Zu(u,Math.max(i,E)),A=_.components||1;return g=Math.max(g,E),u+=E*A,{name:_.name,type:_.type,components:A,offset:P}}),size:Zu(u,Math.max(g,i)),alignment:i}}function Zu(t,i){return Math.ceil(t/i)*i}Jn.serialize=function(t,i){return t._trim(),i&&(t.isTransferred=!0,i.push(t.arrayBuffer)),{length:t.length,arrayBuffer:t.arrayBuffer}},Jn.deserialize=function(t){var i=Object.create(this.prototype);return i.arrayBuffer=t.arrayBuffer,i.length=t.length,i.capacity=t.arrayBuffer.byteLength/i.bytesPerElement,i._refreshViews(),i},Jn.prototype._trim=function(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())},Jn.prototype.clear=function(){this.length=0},Jn.prototype.resize=function(t){this.reserve(t),this.length=t},Jn.prototype.reserve=function(t){if(t>this.capacity){this.capacity=Math.max(t,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);var i=this.uint8;this._refreshViews(),i&&this.uint8.set(i)}},Jn.prototype._refreshViews=function(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")};var Io=function(t){function i(){t.apply(this,arguments)}return t&&(i.__proto__=t),(i.prototype=Object.create(t&&t.prototype)).constructor=i,i.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},i.prototype.emplaceBack=function(u,g){var _=this.length;return this.resize(_+1),this.emplace(_,u,g)},i.prototype.emplace=function(u,g,_){var E=2*u;return this.int16[E+0]=g,this.int16[E+1]=_,u},i}(Jn);Io.prototype.bytesPerElement=4,er("StructArrayLayout2i4",Io);var bi=function(t){function i(){t.apply(this,arguments)}return t&&(i.__proto__=t),(i.prototype=Object.create(t&&t.prototype)).constructor=i,i.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},i.prototype.emplaceBack=function(u,g,_,E){var P=this.length;return this.resize(P+1),this.emplace(P,u,g,_,E)},i.prototype.emplace=function(u,g,_,E,P){var A=4*u;return this.int16[A+0]=g,this.int16[A+1]=_,this.int16[A+2]=E,this.int16[A+3]=P,u},i}(Jn);bi.prototype.bytesPerElement=8,er("StructArrayLayout4i8",bi);var qa=function(t){function i(){t.apply(this,arguments)}return t&&(i.__proto__=t),(i.prototype=Object.create(t&&t.prototype)).constructor=i,i.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},i.prototype.emplaceBack=function(u,g,_,E,P,A){var F=this.length;return this.resize(F+1),this.emplace(F,u,g,_,E,P,A)},i.prototype.emplace=function(u,g,_,E,P,A,F){var U=6*u;return this.int16[U+0]=g,this.int16[U+1]=_,this.int16[U+2]=E,this.int16[U+3]=P,this.int16[U+4]=A,this.int16[U+5]=F,u},i}(Jn);qa.prototype.bytesPerElement=12,er("StructArrayLayout2i4i12",qa);var Hs=function(t){function i(){t.apply(this,arguments)}return t&&(i.__proto__=t),(i.prototype=Object.create(t&&t.prototype)).constructor=i,i.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},i.prototype.emplaceBack=function(u,g,_,E,P,A){var F=this.length;return this.resize(F+1),this.emplace(F,u,g,_,E,P,A)},i.prototype.emplace=function(u,g,_,E,P,A,F){var U=4*u,q=8*u;return this.int16[U+0]=g,this.int16[U+1]=_,this.uint8[q+4]=E,this.uint8[q+5]=P,this.uint8[q+6]=A,this.uint8[q+7]=F,u},i}(Jn);Hs.prototype.bytesPerElement=8,er("StructArrayLayout2i4ub8",Hs);var n=function(t){function i(){t.apply(this,arguments)}return t&&(i.__proto__=t),(i.prototype=Object.create(t&&t.prototype)).constructor=i,i.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},i.prototype.emplaceBack=function(u,g){var _=this.length;return this.resize(_+1),this.emplace(_,u,g)},i.prototype.emplace=function(u,g,_){var E=2*u;return this.float32[E+0]=g,this.float32[E+1]=_,u},i}(Jn);n.prototype.bytesPerElement=8,er("StructArrayLayout2f8",n);var a=function(t){function i(){t.apply(this,arguments)}return t&&(i.__proto__=t),(i.prototype=Object.create(t&&t.prototype)).constructor=i,i.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},i.prototype.emplaceBack=function(u,g,_,E,P,A,F,U,q,G){var K=this.length;return this.resize(K+1),this.emplace(K,u,g,_,E,P,A,F,U,q,G)},i.prototype.emplace=function(u,g,_,E,P,A,F,U,q,G,K){var ot=10*u;return this.uint16[ot+0]=g,this.uint16[ot+1]=_,this.uint16[ot+2]=E,this.uint16[ot+3]=P,this.uint16[ot+4]=A,this.uint16[ot+5]=F,this.uint16[ot+6]=U,this.uint16[ot+7]=q,this.uint16[ot+8]=G,this.uint16[ot+9]=K,u},i}(Jn);a.prototype.bytesPerElement=20,er("StructArrayLayout10ui20",a);var h=function(t){function i(){t.apply(this,arguments)}return t&&(i.__proto__=t),(i.prototype=Object.create(t&&t.prototype)).constructor=i,i.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},i.prototype.emplaceBack=function(u,g,_,E,P,A,F,U,q,G,K,ot){var It=this.length;return this.resize(It+1),this.emplace(It,u,g,_,E,P,A,F,U,q,G,K,ot)},i.prototype.emplace=function(u,g,_,E,P,A,F,U,q,G,K,ot,It){var Mt=12*u;return this.int16[Mt+0]=g,this.int16[Mt+1]=_,this.int16[Mt+2]=E,this.int16[Mt+3]=P,this.uint16[Mt+4]=A,this.uint16[Mt+5]=F,this.uint16[Mt+6]=U,this.uint16[Mt+7]=q,this.int16[Mt+8]=G,this.int16[Mt+9]=K,this.int16[Mt+10]=ot,this.int16[Mt+11]=It,u},i}(Jn);h.prototype.bytesPerElement=24,er("StructArrayLayout4i4ui4i24",h);var d=function(t){function i(){t.apply(this,arguments)}return t&&(i.__proto__=t),(i.prototype=Object.create(t&&t.prototype)).constructor=i,i.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},i.prototype.emplaceBack=function(u,g,_){var E=this.length;return this.resize(E+1),this.emplace(E,u,g,_)},i.prototype.emplace=function(u,g,_,E){var P=3*u;return this.float32[P+0]=g,this.float32[P+1]=_,this.float32[P+2]=E,u},i}(Jn);d.prototype.bytesPerElement=12,er("StructArrayLayout3f12",d);var w=function(t){function i(){t.apply(this,arguments)}return t&&(i.__proto__=t),(i.prototype=Object.create(t&&t.prototype)).constructor=i,i.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)},i.prototype.emplaceBack=function(u){var g=this.length;return this.resize(g+1),this.emplace(g,u)},i.prototype.emplace=function(u,g){return this.uint32[1*u+0]=g,u},i}(Jn);w.prototype.bytesPerElement=4,er("StructArrayLayout1ul4",w);var O=function(t){function i(){t.apply(this,arguments)}return t&&(i.__proto__=t),(i.prototype=Object.create(t&&t.prototype)).constructor=i,i.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},i.prototype.emplaceBack=function(u,g,_,E,P,A,F,U,q){var G=this.length;return this.resize(G+1),this.emplace(G,u,g,_,E,P,A,F,U,q)},i.prototype.emplace=function(u,g,_,E,P,A,F,U,q,G){var K=10*u,ot=5*u;return this.int16[K+0]=g,this.int16[K+1]=_,this.int16[K+2]=E,this.int16[K+3]=P,this.int16[K+4]=A,this.int16[K+5]=F,this.uint32[ot+3]=U,this.uint16[K+8]=q,this.uint16[K+9]=G,u},i}(Jn);O.prototype.bytesPerElement=20,er("StructArrayLayout6i1ul2ui20",O);var k=function(t){function i(){t.apply(this,arguments)}return t&&(i.__proto__=t),(i.prototype=Object.create(t&&t.prototype)).constructor=i,i.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},i.prototype.emplaceBack=function(u,g,_,E,P,A){var F=this.length;return this.resize(F+1),this.emplace(F,u,g,_,E,P,A)},i.prototype.emplace=function(u,g,_,E,P,A,F){var U=6*u;return this.int16[U+0]=g,this.int16[U+1]=_,this.int16[U+2]=E,this.int16[U+3]=P,this.int16[U+4]=A,this.int16[U+5]=F,u},i}(Jn);k.prototype.bytesPerElement=12,er("StructArrayLayout2i2i2i12",k);var W=function(t){function i(){t.apply(this,arguments)}return t&&(i.__proto__=t),(i.prototype=Object.create(t&&t.prototype)).constructor=i,i.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},i.prototype.emplaceBack=function(u,g,_,E,P){var A=this.length;return this.resize(A+1),this.emplace(A,u,g,_,E,P)},i.prototype.emplace=function(u,g,_,E,P,A){var F=4*u,U=8*u;return this.float32[F+0]=g,this.float32[F+1]=_,this.float32[F+2]=E,this.int16[U+6]=P,this.int16[U+7]=A,u},i}(Jn);W.prototype.bytesPerElement=16,er("StructArrayLayout2f1f2i16",W);var mt=function(t){function i(){t.apply(this,arguments)}return t&&(i.__proto__=t),(i.prototype=Object.create(t&&t.prototype)).constructor=i,i.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},i.prototype.emplaceBack=function(u,g,_,E){var P=this.length;return this.resize(P+1),this.emplace(P,u,g,_,E)},i.prototype.emplace=function(u,g,_,E,P){var A=12*u,F=3*u;return this.uint8[A+0]=g,this.uint8[A+1]=_,this.float32[F+1]=E,this.float32[F+2]=P,u},i}(Jn);mt.prototype.bytesPerElement=12,er("StructArrayLayout2ub2f12",mt);var Gt=function(t){function i(){t.apply(this,arguments)}return t&&(i.__proto__=t),(i.prototype=Object.create(t&&t.prototype)).constructor=i,i.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},i.prototype.emplaceBack=function(u,g,_){var E=this.length;return this.resize(E+1),this.emplace(E,u,g,_)},i.prototype.emplace=function(u,g,_,E){var P=3*u;return this.uint16[P+0]=g,this.uint16[P+1]=_,this.uint16[P+2]=E,u},i}(Jn);Gt.prototype.bytesPerElement=6,er("StructArrayLayout3ui6",Gt);var Ie=function(t){function i(){t.apply(this,arguments)}return t&&(i.__proto__=t),(i.prototype=Object.create(t&&t.prototype)).constructor=i,i.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},i.prototype.emplaceBack=function(u,g,_,E,P,A,F,U,q,G,K,ot,It,Mt,Zt,Xt,ce){var fe=this.length;return this.resize(fe+1),this.emplace(fe,u,g,_,E,P,A,F,U,q,G,K,ot,It,Mt,Zt,Xt,ce)},i.prototype.emplace=function(u,g,_,E,P,A,F,U,q,G,K,ot,It,Mt,Zt,Xt,ce,fe){var Ce=24*u,Pe=12*u,be=48*u;return this.int16[Ce+0]=g,this.int16[Ce+1]=_,this.uint16[Ce+2]=E,this.uint16[Ce+3]=P,this.uint32[Pe+2]=A,this.uint32[Pe+3]=F,this.uint32[Pe+4]=U,this.uint16[Ce+10]=q,this.uint16[Ce+11]=G,this.uint16[Ce+12]=K,this.float32[Pe+7]=ot,this.float32[Pe+8]=It,this.uint8[be+36]=Mt,this.uint8[be+37]=Zt,this.uint8[be+38]=Xt,this.uint32[Pe+10]=ce,this.int16[Ce+22]=fe,u},i}(Jn);Ie.prototype.bytesPerElement=48,er("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",Ie);var Me=function(t){function i(){t.apply(this,arguments)}return t&&(i.__proto__=t),(i.prototype=Object.create(t&&t.prototype)).constructor=i,i.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},i.prototype.emplaceBack=function(u,g,_,E,P,A,F,U,q,G,K,ot,It,Mt,Zt,Xt,ce,fe,Ce,Pe,be,ar,lr,zr,xr,kr,Ir,Ur){var Hr=this.length;return this.resize(Hr+1),this.emplace(Hr,u,g,_,E,P,A,F,U,q,G,K,ot,It,Mt,Zt,Xt,ce,fe,Ce,Pe,be,ar,lr,zr,xr,kr,Ir,Ur)},i.prototype.emplace=function(u,g,_,E,P,A,F,U,q,G,K,ot,It,Mt,Zt,Xt,ce,fe,Ce,Pe,be,ar,lr,zr,xr,kr,Ir,Ur,Hr){var Lr=34*u,An=17*u;return this.int16[Lr+0]=g,this.int16[Lr+1]=_,this.int16[Lr+2]=E,this.int16[Lr+3]=P,this.int16[Lr+4]=A,this.int16[Lr+5]=F,this.int16[Lr+6]=U,this.int16[Lr+7]=q,this.uint16[Lr+8]=G,this.uint16[Lr+9]=K,this.uint16[Lr+10]=ot,this.uint16[Lr+11]=It,this.uint16[Lr+12]=Mt,this.uint16[Lr+13]=Zt,this.uint16[Lr+14]=Xt,this.uint16[Lr+15]=ce,this.uint16[Lr+16]=fe,this.uint16[Lr+17]=Ce,this.uint16[Lr+18]=Pe,this.uint16[Lr+19]=be,this.uint16[Lr+20]=ar,this.uint16[Lr+21]=lr,this.uint16[Lr+22]=zr,this.uint32[An+12]=xr,this.float32[An+13]=kr,this.float32[An+14]=Ir,this.float32[An+15]=Ur,this.float32[An+16]=Hr,u},i}(Jn);Me.prototype.bytesPerElement=68,er("StructArrayLayout8i15ui1ul4f68",Me);var Ke=function(t){function i(){t.apply(this,arguments)}return t&&(i.__proto__=t),(i.prototype=Object.create(t&&t.prototype)).constructor=i,i.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},i.prototype.emplaceBack=function(u){var g=this.length;return this.resize(g+1),this.emplace(g,u)},i.prototype.emplace=function(u,g){return this.float32[1*u+0]=g,u},i}(Jn);Ke.prototype.bytesPerElement=4,er("StructArrayLayout1f4",Ke);var gr=function(t){function i(){t.apply(this,arguments)}return t&&(i.__proto__=t),(i.prototype=Object.create(t&&t.prototype)).constructor=i,i.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},i.prototype.emplaceBack=function(u,g,_){var E=this.length;return this.resize(E+1),this.emplace(E,u,g,_)},i.prototype.emplace=function(u,g,_,E){var P=3*u;return this.int16[P+0]=g,this.int16[P+1]=_,this.int16[P+2]=E,u},i}(Jn);gr.prototype.bytesPerElement=6,er("StructArrayLayout3i6",gr);var Or=function(t){function i(){t.apply(this,arguments)}return t&&(i.__proto__=t),(i.prototype=Object.create(t&&t.prototype)).constructor=i,i.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},i.prototype.emplaceBack=function(u,g,_){var E=this.length;return this.resize(E+1),this.emplace(E,u,g,_)},i.prototype.emplace=function(u,g,_,E){var P=4*u;return this.uint32[2*u+0]=g,this.uint16[P+2]=_,this.uint16[P+3]=E,u},i}(Jn);Or.prototype.bytesPerElement=8,er("StructArrayLayout1ul2ui8",Or);var Zr=function(t){function i(){t.apply(this,arguments)}return t&&(i.__proto__=t),(i.prototype=Object.create(t&&t.prototype)).constructor=i,i.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},i.prototype.emplaceBack=function(u,g){var _=this.length;return this.resize(_+1),this.emplace(_,u,g)},i.prototype.emplace=function(u,g,_){var E=2*u;return this.uint16[E+0]=g,this.uint16[E+1]=_,u},i}(Jn);Zr.prototype.bytesPerElement=4,er("StructArrayLayout2ui4",Zr);var Kn=function(t){function i(){t.apply(this,arguments)}return t&&(i.__proto__=t),(i.prototype=Object.create(t&&t.prototype)).constructor=i,i.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},i.prototype.emplaceBack=function(u){var g=this.length;return this.resize(g+1),this.emplace(g,u)},i.prototype.emplace=function(u,g){return this.uint16[1*u+0]=g,u},i}(Jn);Kn.prototype.bytesPerElement=2,er("StructArrayLayout1ui2",Kn);var l=function(t){function i(){t.apply(this,arguments)}return t&&(i.__proto__=t),(i.prototype=Object.create(t&&t.prototype)).constructor=i,i.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},i.prototype.emplaceBack=function(u,g,_,E){var P=this.length;return this.resize(P+1),this.emplace(P,u,g,_,E)},i.prototype.emplace=function(u,g,_,E,P){var A=4*u;return this.float32[A+0]=g,this.float32[A+1]=_,this.float32[A+2]=E,this.float32[A+3]=P,u},i}(Jn);l.prototype.bytesPerElement=16,er("StructArrayLayout4f16",l);var p=function(t){function i(){t.apply(this,arguments)}t&&(i.__proto__=t),(i.prototype=Object.create(t&&t.prototype)).constructor=i;var u={anchorPointX:{configurable:!0},anchorPointY:{configurable:!0},x1:{configurable:!0},y1:{configurable:!0},x2:{configurable:!0},y2:{configurable:!0},featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0},anchorPoint:{configurable:!0}};return u.anchorPointX.get=function(){return this._structArray.int16[this._pos2+0]},u.anchorPointY.get=function(){return this._structArray.int16[this._pos2+1]},u.x1.get=function(){return this._structArray.int16[this._pos2+2]},u.y1.get=function(){return this._structArray.int16[this._pos2+3]},u.x2.get=function(){return this._structArray.int16[this._pos2+4]},u.y2.get=function(){return this._structArray.int16[this._pos2+5]},u.featureIndex.get=function(){return this._structArray.uint32[this._pos4+3]},u.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+8]},u.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+9]},u.anchorPoint.get=function(){return new Ft(this.anchorPointX,this.anchorPointY)},Object.defineProperties(i.prototype,u),i}(ss);p.prototype.size=20;var c=function(t){function i(){t.apply(this,arguments)}return t&&(i.__proto__=t),(i.prototype=Object.create(t&&t.prototype)).constructor=i,i.prototype.get=function(u){return new p(this,u)},i}(O);er("CollisionBoxArray",c);var y=function(t){function i(){t.apply(this,arguments)}t&&(i.__proto__=t),(i.prototype=Object.create(t&&t.prototype)).constructor=i;var u={anchorX:{configurable:!0},anchorY:{configurable:!0},glyphStartIndex:{configurable:!0},numGlyphs:{configurable:!0},vertexStartIndex:{configurable:!0},lineStartIndex:{configurable:!0},lineLength:{configurable:!0},segment:{configurable:!0},lowerSize:{configurable:!0},upperSize:{configurable:!0},lineOffsetX:{configurable:!0},lineOffsetY:{configurable:!0},writingMode:{configurable:!0},placedOrientation:{configurable:!0},hidden:{configurable:!0},crossTileID:{configurable:!0},associatedIconIndex:{configurable:!0}};return u.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},u.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},u.glyphStartIndex.get=function(){return this._structArray.uint16[this._pos2+2]},u.numGlyphs.get=function(){return this._structArray.uint16[this._pos2+3]},u.vertexStartIndex.get=function(){return this._structArray.uint32[this._pos4+2]},u.lineStartIndex.get=function(){return this._structArray.uint32[this._pos4+3]},u.lineLength.get=function(){return this._structArray.uint32[this._pos4+4]},u.segment.get=function(){return this._structArray.uint16[this._pos2+10]},u.lowerSize.get=function(){return this._structArray.uint16[this._pos2+11]},u.upperSize.get=function(){return this._structArray.uint16[this._pos2+12]},u.lineOffsetX.get=function(){return this._structArray.float32[this._pos4+7]},u.lineOffsetY.get=function(){return this._structArray.float32[this._pos4+8]},u.writingMode.get=function(){return this._structArray.uint8[this._pos1+36]},u.placedOrientation.get=function(){return this._structArray.uint8[this._pos1+37]},u.placedOrientation.set=function(g){this._structArray.uint8[this._pos1+37]=g},u.hidden.get=function(){return this._structArray.uint8[this._pos1+38]},u.hidden.set=function(g){this._structArray.uint8[this._pos1+38]=g},u.crossTileID.get=function(){return this._structArray.uint32[this._pos4+10]},u.crossTileID.set=function(g){this._structArray.uint32[this._pos4+10]=g},u.associatedIconIndex.get=function(){return this._structArray.int16[this._pos2+22]},Object.defineProperties(i.prototype,u),i}(ss);y.prototype.size=48;var C=function(t){function i(){t.apply(this,arguments)}return t&&(i.__proto__=t),(i.prototype=Object.create(t&&t.prototype)).constructor=i,i.prototype.get=function(u){return new y(this,u)},i}(Ie);er("PlacedSymbolArray",C);var T=function(t){function i(){t.apply(this,arguments)}t&&(i.__proto__=t),(i.prototype=Object.create(t&&t.prototype)).constructor=i;var u={anchorX:{configurable:!0},anchorY:{configurable:!0},rightJustifiedTextSymbolIndex:{configurable:!0},centerJustifiedTextSymbolIndex:{configurable:!0},leftJustifiedTextSymbolIndex:{configurable:!0},verticalPlacedTextSymbolIndex:{configurable:!0},placedIconSymbolIndex:{configurable:!0},verticalPlacedIconSymbolIndex:{configurable:!0},key:{configurable:!0},textBoxStartIndex:{configurable:!0},textBoxEndIndex:{configurable:!0},verticalTextBoxStartIndex:{configurable:!0},verticalTextBoxEndIndex:{configurable:!0},iconBoxStartIndex:{configurable:!0},iconBoxEndIndex:{configurable:!0},verticalIconBoxStartIndex:{configurable:!0},verticalIconBoxEndIndex:{configurable:!0},featureIndex:{configurable:!0},numHorizontalGlyphVertices:{configurable:!0},numVerticalGlyphVertices:{configurable:!0},numIconVertices:{configurable:!0},numVerticalIconVertices:{configurable:!0},useRuntimeCollisionCircles:{configurable:!0},crossTileID:{configurable:!0},textBoxScale:{configurable:!0},textOffset0:{configurable:!0},textOffset1:{configurable:!0},collisionCircleDiameter:{configurable:!0}};return u.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},u.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},u.rightJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+2]},u.centerJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+3]},u.leftJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+4]},u.verticalPlacedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+5]},u.placedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+6]},u.verticalPlacedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+7]},u.key.get=function(){return this._structArray.uint16[this._pos2+8]},u.textBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+9]},u.textBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+10]},u.verticalTextBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+11]},u.verticalTextBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+12]},u.iconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+13]},u.iconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+14]},u.verticalIconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+15]},u.verticalIconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+16]},u.featureIndex.get=function(){return this._structArray.uint16[this._pos2+17]},u.numHorizontalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+18]},u.numVerticalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+19]},u.numIconVertices.get=function(){return this._structArray.uint16[this._pos2+20]},u.numVerticalIconVertices.get=function(){return this._structArray.uint16[this._pos2+21]},u.useRuntimeCollisionCircles.get=function(){return this._structArray.uint16[this._pos2+22]},u.crossTileID.get=function(){return this._structArray.uint32[this._pos4+12]},u.crossTileID.set=function(g){this._structArray.uint32[this._pos4+12]=g},u.textBoxScale.get=function(){return this._structArray.float32[this._pos4+13]},u.textOffset0.get=function(){return this._structArray.float32[this._pos4+14]},u.textOffset1.get=function(){return this._structArray.float32[this._pos4+15]},u.collisionCircleDiameter.get=function(){return this._structArray.float32[this._pos4+16]},Object.defineProperties(i.prototype,u),i}(ss);T.prototype.size=68;var L=function(t){function i(){t.apply(this,arguments)}return t&&(i.__proto__=t),(i.prototype=Object.create(t&&t.prototype)).constructor=i,i.prototype.get=function(u){return new T(this,u)},i}(Me);er("SymbolInstanceArray",L);var z=function(t){function i(){t.apply(this,arguments)}return t&&(i.__proto__=t),(i.prototype=Object.create(t&&t.prototype)).constructor=i,i.prototype.getoffsetX=function(u){return this.float32[1*u+0]},i}(Ke);er("GlyphOffsetArray",z);var Z=function(t){function i(){t.apply(this,arguments)}return t&&(i.__proto__=t),(i.prototype=Object.create(t&&t.prototype)).constructor=i,i.prototype.getx=function(u){return this.int16[3*u+0]},i.prototype.gety=function(u){return this.int16[3*u+1]},i.prototype.gettileUnitDistanceFromAnchor=function(u){return this.int16[3*u+2]},i}(gr);er("SymbolLineVertexArray",Z);var H=function(t){function i(){t.apply(this,arguments)}t&&(i.__proto__=t),(i.prototype=Object.create(t&&t.prototype)).constructor=i;var u={featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0}};return u.featureIndex.get=function(){return this._structArray.uint32[this._pos4+0]},u.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+2]},u.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+3]},Object.defineProperties(i.prototype,u),i}(ss);H.prototype.size=8;var ut=function(t){function i(){t.apply(this,arguments)}return t&&(i.__proto__=t),(i.prototype=Object.create(t&&t.prototype)).constructor=i,i.prototype.get=function(u){return new H(this,u)},i}(Or);er("FeatureIndexArray",ut);var gt=oi([{name:"a_pos",components:2,type:"Int16"}],4).members,ct=function(t){void 0===t&&(t=[]),this.segments=t};function zt(t,i){return 256*(t=de(Math.floor(t),0,255))+de(Math.floor(i),0,255)}ct.prototype.prepareSegment=function(t,i,u,g){var _=this.segments[this.segments.length-1];return t>ct.MAX_VERTEX_ARRAY_LENGTH&&xt("Max vertices per segment is "+ct.MAX_VERTEX_ARRAY_LENGTH+": bucket requested "+t),(!_||_.vertexLength+t>ct.MAX_VERTEX_ARRAY_LENGTH||_.sortKey!==g)&&(_={vertexOffset:i.length,primitiveOffset:u.length,vertexLength:0,primitiveLength:0},void 0!==g&&(_.sortKey=g),this.segments.push(_)),_},ct.prototype.get=function(){return this.segments},ct.prototype.destroy=function(){for(var t=0,i=this.segments;t<i.length;t+=1){var u=i[t];for(var g in u.vaos)u.vaos[g].destroy()}},ct.simpleSegment=function(t,i,u,g){return new ct([{vertexOffset:t,primitiveOffset:i,vertexLength:u,primitiveLength:g,vaos:{},sortKey:0}])},ct.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,er("SegmentVector",ct);var Rt=oi([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]),Yt=Bt(function(t){t.exports=function(i,u){var g,_,E,P,A,F,U,q;for(_=i.length-(g=3&i.length),E=u,A=3432918353,F=461845907,q=0;q<_;)U=255&i.charCodeAt(q)|(255&i.charCodeAt(++q))<<8|(255&i.charCodeAt(++q))<<16|(255&i.charCodeAt(++q))<<24,++q,E=27492+(65535&(P=5*(65535&(E=(E^=U=(65535&(U=(U=(65535&U)*A+(((U>>>16)*A&65535)<<16)&4294967295)<<15|U>>>17))*F+(((U>>>16)*F&65535)<<16)&4294967295)<<13|E>>>19))+((5*(E>>>16)&65535)<<16)&4294967295))+((58964+(P>>>16)&65535)<<16);switch(U=0,g){case 3:U^=(255&i.charCodeAt(q+2))<<16;case 2:U^=(255&i.charCodeAt(q+1))<<8;case 1:E^=U=(65535&(U=(U=(65535&(U^=255&i.charCodeAt(q)))*A+(((U>>>16)*A&65535)<<16)&4294967295)<<15|U>>>17))*F+(((U>>>16)*F&65535)<<16)&4294967295}return E^=i.length,E=2246822507*(65535&(E^=E>>>16))+((2246822507*(E>>>16)&65535)<<16)&4294967295,E=3266489909*(65535&(E^=E>>>13))+((3266489909*(E>>>16)&65535)<<16)&4294967295,(E^=E>>>16)>>>0}}),Dt=Bt(function(t){t.exports=function(i,u){for(var g,_=i.length,E=u^_,P=0;_>=4;)g=1540483477*(65535&(g=255&i.charCodeAt(P)|(255&i.charCodeAt(++P))<<8|(255&i.charCodeAt(++P))<<16|(255&i.charCodeAt(++P))<<24))+((1540483477*(g>>>16)&65535)<<16),E=1540483477*(65535&E)+((1540483477*(E>>>16)&65535)<<16)^(g=1540483477*(65535&(g^=g>>>24))+((1540483477*(g>>>16)&65535)<<16)),_-=4,++P;switch(_){case 3:E^=(255&i.charCodeAt(P+2))<<16;case 2:E^=(255&i.charCodeAt(P+1))<<8;case 1:E=1540483477*(65535&(E^=255&i.charCodeAt(P)))+((1540483477*(E>>>16)&65535)<<16)}return E=1540483477*(65535&(E^=E>>>13))+((1540483477*(E>>>16)&65535)<<16),(E^=E>>>15)>>>0}}),Vt=Yt,ee=Dt;Vt.murmur3=Yt,Vt.murmur2=ee;var he=function(){this.ids=[],this.positions=[],this.indexed=!1};he.prototype.add=function(t,i,u,g){this.ids.push(ve(t)),this.positions.push(i,u,g)},he.prototype.getPositions=function(t){for(var i=ve(t),u=0,g=this.ids.length-1;u<g;){var _=u+g>>1;this.ids[_]>=i?g=_:u=_+1}for(var E=[];this.ids[u]===i;)E.push({index:this.positions[3*u],start:this.positions[3*u+1],end:this.positions[3*u+2]}),u++;return E},he.serialize=function(t,i){var u=new Float64Array(t.ids),g=new Uint32Array(t.positions);return function _(E,P,A,F){for(;A<F;){for(var U=E[A+F>>1],q=A-1,G=F+1;;){do{q++}while(E[q]<U);do{G--}while(E[G]>U);if(q>=G)break;we(E,q,G),we(P,3*q,3*G),we(P,3*q+1,3*G+1),we(P,3*q+2,3*G+2)}G-A<F-G?(_(E,P,A,G),A=G+1):(_(E,P,G+1,F),F=G)}}(u,g,0,u.length-1),i&&i.push(u.buffer,g.buffer),{ids:u,positions:g}},he.deserialize=function(t){var i=new he;return i.ids=t.ids,i.positions=t.positions,i.indexed=!0,i};var _e=Math.pow(2,53)-1;function ve(t){var i=+t;return!isNaN(i)&&i<=_e?i:Vt(String(t))}function we(t,i,u){var g=t[i];t[i]=t[u],t[u]=g}er("FeaturePositionMap",he);var Ne=function(t,i){this.gl=t.gl,this.location=i},qe=function(t){function i(u,g){t.call(this,u,g),this.current=0}return t&&(i.__proto__=t),(i.prototype=Object.create(t&&t.prototype)).constructor=i,i.prototype.set=function(u){this.current!==u&&(this.current=u,this.gl.uniform1i(this.location,u))},i}(Ne),ze=function(t){function i(u,g){t.call(this,u,g),this.current=0}return t&&(i.__proto__=t),(i.prototype=Object.create(t&&t.prototype)).constructor=i,i.prototype.set=function(u){this.current!==u&&(this.current=u,this.gl.uniform1f(this.location,u))},i}(Ne),Ve=function(t){function i(u,g){t.call(this,u,g),this.current=[0,0]}return t&&(i.__proto__=t),(i.prototype=Object.create(t&&t.prototype)).constructor=i,i.prototype.set=function(u){u[0]===this.current[0]&&u[1]===this.current[1]||(this.current=u,this.gl.uniform2f(this.location,u[0],u[1]))},i}(Ne),$e=function(t){function i(u,g){t.call(this,u,g),this.current=[0,0,0]}return t&&(i.__proto__=t),(i.prototype=Object.create(t&&t.prototype)).constructor=i,i.prototype.set=function(u){u[0]===this.current[0]&&u[1]===this.current[1]&&u[2]===this.current[2]||(this.current=u,this.gl.uniform3f(this.location,u[0],u[1],u[2]))},i}(Ne),rr=function(t){function i(u,g){t.call(this,u,g),this.current=[0,0,0,0]}return t&&(i.__proto__=t),(i.prototype=Object.create(t&&t.prototype)).constructor=i,i.prototype.set=function(u){u[0]===this.current[0]&&u[1]===this.current[1]&&u[2]===this.current[2]&&u[3]===this.current[3]||(this.current=u,this.gl.uniform4f(this.location,u[0],u[1],u[2],u[3]))},i}(Ne),tr=function(t){function i(u,g){t.call(this,u,g),this.current=Pn.transparent}return t&&(i.__proto__=t),(i.prototype=Object.create(t&&t.prototype)).constructor=i,i.prototype.set=function(u){u.r===this.current.r&&u.g===this.current.g&&u.b===this.current.b&&u.a===this.current.a||(this.current=u,this.gl.uniform4f(this.location,u.r,u.g,u.b,u.a))},i}(Ne),Dr=new Float32Array(16),Xe=function(t){function i(u,g){t.call(this,u,g),this.current=Dr}return t&&(i.__proto__=t),(i.prototype=Object.create(t&&t.prototype)).constructor=i,i.prototype.set=function(u){if(u[12]!==this.current[12]||u[0]!==this.current[0])return this.current=u,void this.gl.uniformMatrix4fv(this.location,!1,u);for(var g=1;g<16;g++)if(u[g]!==this.current[g]){this.current=u,this.gl.uniformMatrix4fv(this.location,!1,u);break}},i}(Ne);function vr(t){return[zt(255*t.r,255*t.g),zt(255*t.b,255*t.a)]}var Pr=function(t,i,u){this.value=t,this.uniformNames=i.map(function(g){return"u_"+g}),this.type=u};Pr.prototype.setUniform=function(t,i,u){t.set(u.constantOr(this.value))},Pr.prototype.getBinding=function(t,i,u){return"color"===this.type?new tr(t,i):new ze(t,i)};var _r=function(t,i){this.uniformNames=i.map(function(u){return"u_"+u}),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1};_r.prototype.setConstantPatternPositions=function(t,i){this.pixelRatioFrom=i.pixelRatio,this.pixelRatioTo=t.pixelRatio,this.patternFrom=i.tlbr,this.patternTo=t.tlbr},_r.prototype.setUniform=function(t,i,u,g){var _="u_pattern_to"===g?this.patternTo:"u_pattern_from"===g?this.patternFrom:"u_pixel_ratio_to"===g?this.pixelRatioTo:"u_pixel_ratio_from"===g?this.pixelRatioFrom:null;_&&t.set(_)},_r.prototype.getBinding=function(t,i,u){return"u_pattern"===u.substr(0,9)?new rr(t,i):new ze(t,i)};var mr=function(t,i,u,g){this.expression=t,this.type=u,this.maxValue=0,this.paintVertexAttributes=i.map(function(_){return{name:"a_"+_,type:"Float32",components:"color"===u?2:1,offset:0}}),this.paintVertexArray=new g};mr.prototype.populatePaintArray=function(t,i,u,g,_){var E=this.paintVertexArray.length,P=this.expression.evaluate(new ii(0),i,{},g,[],_);this.paintVertexArray.resize(t),this._setPaintValue(E,t,P)},mr.prototype.updatePaintArray=function(t,i,u,g){var _=this.expression.evaluate({zoom:0},u,g);this._setPaintValue(t,i,_)},mr.prototype._setPaintValue=function(t,i,u){if("color"===this.type)for(var g=vr(u),_=t;_<i;_++)this.paintVertexArray.emplace(_,g[0],g[1]);else{for(var E=t;E<i;E++)this.paintVertexArray.emplace(E,u);this.maxValue=Math.max(this.maxValue,Math.abs(u))}},mr.prototype.upload=function(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},mr.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()};var fr=function(t,i,u,g,_,E){this.expression=t,this.uniformNames=i.map(function(P){return"u_"+P+"_t"}),this.type=u,this.useIntegerZoom=g,this.zoom=_,this.maxValue=0,this.paintVertexAttributes=i.map(function(P){return{name:"a_"+P,type:"Float32",components:"color"===u?4:2,offset:0}}),this.paintVertexArray=new E};fr.prototype.populatePaintArray=function(t,i,u,g,_){var E=this.expression.evaluate(new ii(this.zoom),i,{},g,[],_),P=this.expression.evaluate(new ii(this.zoom+1),i,{},g,[],_),A=this.paintVertexArray.length;this.paintVertexArray.resize(t),this._setPaintValue(A,t,E,P)},fr.prototype.updatePaintArray=function(t,i,u,g){var _=this.expression.evaluate({zoom:this.zoom},u,g),E=this.expression.evaluate({zoom:this.zoom+1},u,g);this._setPaintValue(t,i,_,E)},fr.prototype._setPaintValue=function(t,i,u,g){if("color"===this.type)for(var _=vr(u),E=vr(g),P=t;P<i;P++)this.paintVertexArray.emplace(P,_[0],_[1],E[0],E[1]);else{for(var A=t;A<i;A++)this.paintVertexArray.emplace(A,u,g);this.maxValue=Math.max(this.maxValue,Math.abs(u),Math.abs(g))}},fr.prototype.upload=function(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},fr.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()},fr.prototype.setUniform=function(t,i){var u=this.useIntegerZoom?Math.floor(i.zoom):i.zoom,g=de(this.expression.interpolationFactor(u,this.zoom,this.zoom+1),0,1);t.set(g)},fr.prototype.getBinding=function(t,i,u){return new ze(t,i)};var hr=function(t,i,u,g,_,E){this.expression=t,this.type=i,this.useIntegerZoom=u,this.zoom=g,this.layerId=E,this.zoomInPaintVertexArray=new _,this.zoomOutPaintVertexArray=new _};hr.prototype.populatePaintArray=function(t,i,u){var g=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(t),this.zoomOutPaintVertexArray.resize(t),this._setPaintValues(g,t,i.patterns&&i.patterns[this.layerId],u)},hr.prototype.updatePaintArray=function(t,i,u,g,_){this._setPaintValues(t,i,u.patterns&&u.patterns[this.layerId],_)},hr.prototype._setPaintValues=function(t,i,u,g){if(g&&u){var _=g[u.min],E=g[u.mid],P=g[u.max];if(_&&E&&P)for(var A=t;A<i;A++)this.zoomInPaintVertexArray.emplace(A,E.tl[0],E.tl[1],E.br[0],E.br[1],_.tl[0],_.tl[1],_.br[0],_.br[1],E.pixelRatio,_.pixelRatio),this.zoomOutPaintVertexArray.emplace(A,E.tl[0],E.tl[1],E.br[0],E.br[1],P.tl[0],P.tl[1],P.br[0],P.br[1],E.pixelRatio,P.pixelRatio)}},hr.prototype.upload=function(t){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=t.createVertexBuffer(this.zoomInPaintVertexArray,Rt.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=t.createVertexBuffer(this.zoomOutPaintVertexArray,Rt.members,this.expression.isStateDependent))},hr.prototype.destroy=function(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()};var or=function(t,i,u){this.binders={},this._buffers=[];var g=[];for(var _ in t.paint._values)if(u(_)){var E=t.paint.get(_);if(E instanceof ca&&Nn(E.property.specification)){var P=Kr(_,t.type),A=E.value,F=E.property.specification.type,U=E.property.useIntegerZoom,q=E.property.specification["property-type"],G="cross-faded"===q||"cross-faded-data-driven"===q;if("constant"===A.kind)this.binders[_]=G?new _r(A.value,P):new Pr(A.value,P,F),g.push("/u_"+_);else if("source"===A.kind||G){var K=pn(_,F,"source");this.binders[_]=G?new hr(A,F,U,i,K,t.id):new mr(A,P,F,K),g.push("/a_"+_)}else{var ot=pn(_,F,"composite");this.binders[_]=new fr(A,P,F,U,i,ot),g.push("/z_"+_)}}}this.cacheKey=g.sort().join("")};or.prototype.getMaxValue=function(t){var i=this.binders[t];return i instanceof mr||i instanceof fr?i.maxValue:0},or.prototype.populatePaintArrays=function(t,i,u,g,_){for(var E in this.binders){var P=this.binders[E];(P instanceof mr||P instanceof fr||P instanceof hr)&&P.populatePaintArray(t,i,u,g,_)}},or.prototype.setConstantPatternPositions=function(t,i){for(var u in this.binders){var g=this.binders[u];g instanceof _r&&g.setConstantPatternPositions(t,i)}},or.prototype.updatePaintArrays=function(t,i,u,g,_){var E=!1;for(var P in t)for(var A=0,F=i.getPositions(P);A<F.length;A+=1){var U=F[A],q=u.feature(U.index);for(var G in this.binders){var K=this.binders[G];if((K instanceof mr||K instanceof fr||K instanceof hr)&&!0===K.expression.isStateDependent){var ot=g.paint.get(G);K.expression=ot.value,K.updatePaintArray(U.start,U.end,q,t[P],_),E=!0}}}return E},or.prototype.defines=function(){var t=[];for(var i in this.binders){var u=this.binders[i];(u instanceof Pr||u instanceof _r)&&t.push.apply(t,u.uniformNames.map(function(g){return"#define HAS_UNIFORM_"+g}))}return t},or.prototype.getBinderAttributes=function(){var t=[];for(var i in this.binders){var u=this.binders[i];if(u instanceof mr||u instanceof fr)for(var g=0;g<u.paintVertexAttributes.length;g++)t.push(u.paintVertexAttributes[g].name);else if(u instanceof hr)for(var _=0;_<Rt.members.length;_++)t.push(Rt.members[_].name)}return t},or.prototype.getBinderUniforms=function(){var t=[];for(var i in this.binders){var u=this.binders[i];if(u instanceof Pr||u instanceof _r||u instanceof fr)for(var g=0,_=u.uniformNames;g<_.length;g+=1)t.push(_[g])}return t},or.prototype.getPaintVertexBuffers=function(){return this._buffers},or.prototype.getUniforms=function(t,i){var u=[];for(var g in this.binders){var _=this.binders[g];if(_ instanceof Pr||_ instanceof _r||_ instanceof fr)for(var E=0,P=_.uniformNames;E<P.length;E+=1){var A=P[E];if(i[A]){var F=_.getBinding(t,i[A],A);u.push({name:A,property:g,binding:F})}}}return u},or.prototype.setUniforms=function(t,i,u,g){for(var _=0,E=i;_<E.length;_+=1){var P=E[_],A=P.name,F=P.property;this.binders[F].setUniform(P.binding,g,u.get(F),A)}},or.prototype.updatePaintBuffers=function(t){for(var i in this._buffers=[],this.binders){var u=this.binders[i];if(t&&u instanceof hr){var g=2===t.fromScale?u.zoomInPaintVertexBuffer:u.zoomOutPaintVertexBuffer;g&&this._buffers.push(g)}else(u instanceof mr||u instanceof fr)&&u.paintVertexBuffer&&this._buffers.push(u.paintVertexBuffer)}},or.prototype.upload=function(t){for(var i in this.binders){var u=this.binders[i];(u instanceof mr||u instanceof fr||u instanceof hr)&&u.upload(t)}this.updatePaintBuffers()},or.prototype.destroy=function(){for(var t in this.binders){var i=this.binders[t];(i instanceof mr||i instanceof fr||i instanceof hr)&&i.destroy()}};var qr=function(t,i,u){void 0===u&&(u=function(){return!0}),this.programConfigurations={};for(var g=0,_=t;g<_.length;g+=1){var E=_[g];this.programConfigurations[E.id]=new or(E,i,u)}this.needsUpload=!1,this._featureMap=new he,this._bufferOffset=0};function Kr(t,i){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[t]||[t.replace(i+"-","").replace(/-/g,"_")]}function pn(t,i,u){var _={"line-pattern":{source:a,composite:a},"fill-pattern":{source:a,composite:a},"fill-extrusion-pattern":{source:a,composite:a}}[t];return _&&_[u]||{color:{source:n,composite:l},number:{source:Ke,composite:n}}[i][u]}qr.prototype.populatePaintArrays=function(t,i,u,g,_,E){for(var P in this.programConfigurations)this.programConfigurations[P].populatePaintArrays(t,i,g,_,E);void 0!==i.id&&this._featureMap.add(i.id,u,this._bufferOffset,t),this._bufferOffset=t,this.needsUpload=!0},qr.prototype.updatePaintArrays=function(t,i,u,g){for(var _=0,E=u;_<E.length;_+=1){var P=E[_];this.needsUpload=this.programConfigurations[P.id].updatePaintArrays(t,this._featureMap,i,P,g)||this.needsUpload}},qr.prototype.get=function(t){return this.programConfigurations[t]},qr.prototype.upload=function(t){if(this.needsUpload){for(var i in this.programConfigurations)this.programConfigurations[i].upload(t);this.needsUpload=!1}},qr.prototype.destroy=function(){for(var t in this.programConfigurations)this.programConfigurations[t].destroy()},er("ConstantBinder",Pr),er("CrossFadedConstantBinder",_r),er("SourceExpressionBinder",mr),er("CrossFadedCompositeBinder",hr),er("CompositeExpressionBinder",fr),er("ProgramConfiguration",or,{omit:["_buffers"]}),er("ProgramConfigurationSet",qr);var rn=Math.pow(2,14)-1,nn=-rn-1;function Qr(t){for(var i=8192/t.extent,u=t.loadGeometry(),g=0;g<u.length;g++)for(var _=u[g],E=0;E<_.length;E++){var P=_[E],A=Math.round(P.x*i),F=Math.round(P.y*i);P.x=de(A,nn,rn),P.y=de(F,nn,rn),(A<P.x||A>P.x+1||F<P.y||F>P.y+1)&&xt("Geometry exceeds allowed extent, reduce your vector tile buffer size")}return u}function hn(t,i){return{type:t.type,id:t.id,properties:t.properties,geometry:i?Qr(t):[]}}function Sn(t,i,u,g,_){t.emplaceBack(2*i+(g+1)/2,2*u+(_+1)/2)}var fn=function(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(function(i){return i.id}),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new Io,this.indexArray=new Gt,this.segments=new ct,this.programConfigurations=new qr(t.layers,t.zoom),this.stateDependentLayerIds=this.layers.filter(function(i){return i.isStateDependent()}).map(function(i){return i.id})};function ba(t,i){for(var u=0;u<t.length;u++)if(hu(i,t[u]))return!0;for(var g=0;g<i.length;g++)if(hu(t,i[g]))return!0;return!!cu(t,i)}function Bs(t,i,u){return!!hu(t,i)||!!vu(i,t,u)}function us(t,i){if(1===t.length)return el(i,t[0]);for(var u=0;u<i.length;u++)for(var g=i[u],_=0;_<g.length;_++)if(hu(t,g[_]))return!0;for(var E=0;E<t.length;E++)if(el(i,t[E]))return!0;for(var P=0;P<i.length;P++)if(cu(t,i[P]))return!0;return!1}function El(t,i,u){if(t.length>1){if(cu(t,i))return!0;for(var g=0;g<i.length;g++)if(vu(i[g],t,u))return!0}for(var _=0;_<t.length;_++)if(vu(t[_],i,u))return!0;return!1}function cu(t,i){if(0===t.length||0===i.length)return!1;for(var u=0;u<t.length-1;u++)for(var g=t[u],_=t[u+1],E=0;E<i.length-1;E++)if(Ou(g,_,i[E],i[E+1]))return!0;return!1}function Ou(t,i,u,g){return Ot(t,u,g)!==Ot(i,u,g)&&Ot(t,i,u)!==Ot(t,i,g)}function vu(t,i,u){var g=u*u;if(1===i.length)return t.distSqr(i[0])<g;for(var _=1;_<i.length;_++)if(Gu(t,i[_-1],i[_])<g)return!0;return!1}function Gu(t,i,u){var g=i.distSqr(u);if(0===g)return t.distSqr(i);var _=((t.x-i.x)*(u.x-i.x)+(t.y-i.y)*(u.y-i.y))/g;return t.distSqr(_<0?i:_>1?u:u.sub(i)._mult(_)._add(i))}function el(t,i){for(var u,g,_,E=!1,P=0;P<t.length;P++)for(var A=0,F=(u=t[P]).length-1;A<u.length;F=A++)(g=u[A]).y>i.y!=(_=u[F]).y>i.y&&i.x<(_.x-g.x)*(i.y-g.y)/(_.y-g.y)+g.x&&(E=!E);return E}function hu(t,i){for(var u=!1,g=0,_=t.length-1;g<t.length;_=g++){var E=t[g],P=t[_];E.y>i.y!=P.y>i.y&&i.x<(P.x-E.x)*(i.y-E.y)/(P.y-E.y)+E.x&&(u=!u)}return u}function rl(t,i,u){var g=u[0],_=u[2];if(t.x<g.x&&i.x<g.x||t.x>_.x&&i.x>_.x||t.y<g.y&&i.y<g.y||t.y>_.y&&i.y>_.y)return!1;var E=Ot(t,i,u[0]);return E!==Ot(t,i,u[1])||E!==Ot(t,i,u[2])||E!==Ot(t,i,u[3])}function Xo(t,i,u){var g=i.paint.get(t).value;return"constant"===g.kind?g.value:u.programConfigurations.get(i.id).getMaxValue(t)}function _u(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1])}function Js(t,i,u,g,_){if(!i[0]&&!i[1])return t;var E=Ft.convert(i)._mult(_);"viewport"===u&&E._rotate(-g);for(var P=[],A=0;A<t.length;A++)P.push(t[A].sub(E));return P}fn.prototype.populate=function(t,i,u){var g=this.layers[0],_=[],E=null,P=!1;"circle"===g.type&&(P=!(E=g.layout.get("circle-sort-key")).isConstant());for(var A=0,F=t;A<F.length;A+=1){var U=F[A],q=U.feature,G=U.id,K=U.index,ot=U.sourceLayerIndex,It=this.layers[0]._featureFilter.needGeometry,Mt=hn(q,It);if(this.layers[0]._featureFilter.filter(new ii(this.zoom),Mt,u)){var Zt=P?E.evaluate(Mt,{},u):void 0,Xt={id:G,properties:q.properties,type:q.type,sourceLayerIndex:ot,index:K,geometry:It?Mt.geometry:Qr(q),patterns:{},sortKey:Zt};_.push(Xt)}}P&&_.sort(function(zr,xr){return zr.sortKey-xr.sortKey});for(var ce=0,fe=_;ce<fe.length;ce+=1){var Ce=fe[ce],Pe=Ce.geometry,be=Ce.index,ar=Ce.sourceLayerIndex,lr=t[be].feature;this.addFeature(Ce,Pe,be,u),i.featureIndex.insert(lr,Pe,be,ar,this.index)}},fn.prototype.update=function(t,i,u){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,i,this.stateDependentLayers,u)},fn.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},fn.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},fn.prototype.upload=function(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,gt),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0},fn.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},fn.prototype.addFeature=function(t,i,u,g){for(var _=0,E=i;_<E.length;_+=1)for(var P=0,A=E[_];P<A.length;P+=1){var F=A[P],U=F.x,q=F.y;if(!(U<0||U>=8192||q<0||q>=8192)){var G=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,t.sortKey),K=G.vertexLength;Sn(this.layoutVertexArray,U,q,-1,-1),Sn(this.layoutVertexArray,U,q,1,-1),Sn(this.layoutVertexArray,U,q,1,1),Sn(this.layoutVertexArray,U,q,-1,1),this.indexArray.emplaceBack(K,K+1,K+2),this.indexArray.emplaceBack(K,K+3,K+2),G.vertexLength+=4,G.primitiveLength+=2}}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,u,{},g)},er("CircleBucket",fn,{omit:["layers"]});var Vu=new so({"circle-sort-key":new jr(_t.layout_circle["circle-sort-key"])}),Po={paint:new so({"circle-radius":new jr(_t.paint_circle["circle-radius"]),"circle-color":new jr(_t.paint_circle["circle-color"]),"circle-blur":new jr(_t.paint_circle["circle-blur"]),"circle-opacity":new jr(_t.paint_circle["circle-opacity"]),"circle-translate":new yr(_t.paint_circle["circle-translate"]),"circle-translate-anchor":new yr(_t.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new yr(_t.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new yr(_t.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new jr(_t.paint_circle["circle-stroke-width"]),"circle-stroke-color":new jr(_t.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new jr(_t.paint_circle["circle-stroke-opacity"])}),layout:Vu},go="undefined"!=typeof Float32Array?Float32Array:Array;function Za(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Cl(t,i,u){var g=i[0],_=i[1],E=i[2],P=i[3],A=i[4],F=i[5],U=i[6],q=i[7],G=i[8],K=i[9],ot=i[10],It=i[11],Mt=i[12],Zt=i[13],Xt=i[14],ce=i[15],fe=u[0],Ce=u[1],Pe=u[2],be=u[3];return t[0]=fe*g+Ce*A+Pe*G+be*Mt,t[1]=fe*_+Ce*F+Pe*K+be*Zt,t[2]=fe*E+Ce*U+Pe*ot+be*Xt,t[3]=fe*P+Ce*q+Pe*It+be*ce,t[4]=(fe=u[4])*g+(Ce=u[5])*A+(Pe=u[6])*G+(be=u[7])*Mt,t[5]=fe*_+Ce*F+Pe*K+be*Zt,t[6]=fe*E+Ce*U+Pe*ot+be*Xt,t[7]=fe*P+Ce*q+Pe*It+be*ce,t[8]=(fe=u[8])*g+(Ce=u[9])*A+(Pe=u[10])*G+(be=u[11])*Mt,t[9]=fe*_+Ce*F+Pe*K+be*Zt,t[10]=fe*E+Ce*U+Pe*ot+be*Xt,t[11]=fe*P+Ce*q+Pe*It+be*ce,t[12]=(fe=u[12])*g+(Ce=u[13])*A+(Pe=u[14])*G+(be=u[15])*Mt,t[13]=fe*_+Ce*F+Pe*K+be*Zt,t[14]=fe*E+Ce*U+Pe*ot+be*Xt,t[15]=fe*P+Ce*q+Pe*It+be*ce,t}Math.hypot||(Math.hypot=function(){for(var t=arguments,i=0,u=arguments.length;u--;)i+=t[u]*t[u];return Math.sqrt(i)});var Kl,t,Ah=Cl;function Ql(t,i,u){var g=i[0],_=i[1],E=i[2],P=i[3];return t[0]=u[0]*g+u[4]*_+u[8]*E+u[12]*P,t[1]=u[1]*g+u[5]*_+u[9]*E+u[13]*P,t[2]=u[2]*g+u[6]*_+u[10]*E+u[14]*P,t[3]=u[3]*g+u[7]*_+u[11]*E+u[15]*P,t}Kl=new go(3),go!=Float32Array&&(Kl[0]=0,Kl[1]=0,Kl[2]=0),t=new go(4),go!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0);var $l=(function(){var t=new go(2);go!=Float32Array&&(t[0]=0,t[1]=0)}(),function(t){function i(u){t.call(this,u,Po)}return t&&(i.__proto__=t),(i.prototype=Object.create(t&&t.prototype)).constructor=i,i.prototype.createBucket=function(u){return new fn(u)},i.prototype.queryRadius=function(u){var g=u;return Xo("circle-radius",this,g)+Xo("circle-stroke-width",this,g)+_u(this.paint.get("circle-translate"))},i.prototype.queryIntersectsFeature=function(u,g,_,E,P,A,F,U){for(var q=Js(u,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),A.angle,F),G=this.paint.get("circle-radius").evaluate(g,_)+this.paint.get("circle-stroke-width").evaluate(g,_),K="map"===this.paint.get("circle-pitch-alignment"),ot=K?q:function(ar,lr){return ar.map(function(zr){return $c(zr,lr)})}(q,U),It=K?G*F:G,Mt=0,Zt=E;Mt<Zt.length;Mt+=1)for(var Xt=0,ce=Zt[Mt];Xt<ce.length;Xt+=1){var fe=ce[Xt],Ce=K?fe:$c(fe,U),Pe=It,be=Ql([],[fe.x,fe.y,0,1],U);if("viewport"===this.paint.get("circle-pitch-scale")&&"map"===this.paint.get("circle-pitch-alignment")?Pe*=be[3]/A.cameraToCenterDistance:"map"===this.paint.get("circle-pitch-scale")&&"viewport"===this.paint.get("circle-pitch-alignment")&&(Pe*=A.cameraToCenterDistance/be[3]),Bs(ot,Ce,Pe))return!0}return!1},i}(Wr));function $c(t,i){var u=Ql([],[t.x,t.y,0,1],i);return new Ft(u[0]/u[3],u[1]/u[3])}var Sl=function(t){function i(){t.apply(this,arguments)}return t&&(i.__proto__=t),(i.prototype=Object.create(t&&t.prototype)).constructor=i,i}(fn);function Il(t,i,u,g){var _=i.width,E=i.height;if(g){if(g instanceof Uint8ClampedArray)g=new Uint8Array(g.buffer);else if(g.length!==_*E*u)throw new RangeError("mismatched image size")}else g=new Uint8Array(_*E*u);return t.width=_,t.height=E,t.data=g,t}function wp(t,i,u){var g=i.width,_=i.height;if(g!==t.width||_!==t.height){var E=Il({},{width:g,height:_},u);Lh(t,E,{x:0,y:0},{x:0,y:0},{width:Math.min(t.width,g),height:Math.min(t.height,_)},u),t.width=g,t.height=_,t.data=E.data}}function Lh(t,i,u,g,_,E){if(0===_.width||0===_.height)return i;if(_.width>t.width||_.height>t.height||u.x>t.width-_.width||u.y>t.height-_.height)throw new RangeError("out of range source coordinates for image copy");if(_.width>i.width||_.height>i.height||g.x>i.width-_.width||g.y>i.height-_.height)throw new RangeError("out of range destination coordinates for image copy");for(var P=t.data,A=i.data,F=0;F<_.height;F++)for(var U=((u.y+F)*t.width+u.x)*E,q=((g.y+F)*i.width+g.x)*E,G=0;G<_.width*E;G++)A[q+G]=P[U+G];return i}er("HeatmapBucket",Sl,{omit:["layers"]});var Pl=function(t,i){Il(this,t,1,i)};Pl.prototype.resize=function(t){wp(this,t,1)},Pl.prototype.clone=function(){return new Pl({width:this.width,height:this.height},new Uint8Array(this.data))},Pl.copy=function(t,i,u,g,_){Lh(t,i,u,g,_,1)};var ds=function(t,i){Il(this,t,4,i)};ds.prototype.resize=function(t){wp(this,t,4)},ds.prototype.replace=function(t,i){i?this.data.set(t):this.data=t instanceof Uint8ClampedArray?new Uint8Array(t.buffer):t},ds.prototype.clone=function(){return new ds({width:this.width,height:this.height},new Uint8Array(this.data))},ds.copy=function(t,i,u,g,_){Lh(t,i,u,g,_,4)},er("AlphaImage",Pl),er("RGBAImage",ds);var Gf={paint:new so({"heatmap-radius":new jr(_t.paint_heatmap["heatmap-radius"]),"heatmap-weight":new jr(_t.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new yr(_t.paint_heatmap["heatmap-intensity"]),"heatmap-color":new xa(_t.paint_heatmap["heatmap-color"]),"heatmap-opacity":new yr(_t.paint_heatmap["heatmap-opacity"])})};function Ep(t){var i={},u=t.resolution||256,g=t.clips?t.clips.length:1,_=t.image||new ds({width:u,height:g}),E=function(It,Mt,Zt){i[t.evaluationKey]=Zt;var Xt=t.expression.evaluate(i);_.data[It+Mt+0]=Math.floor(255*Xt.r/Xt.a),_.data[It+Mt+1]=Math.floor(255*Xt.g/Xt.a),_.data[It+Mt+2]=Math.floor(255*Xt.b/Xt.a),_.data[It+Mt+3]=Math.floor(255*Xt.a)};if(t.clips)for(var P=0,A=0;P<g;++P,A+=4*u)for(var F=0,U=0;F<u;F++,U+=4){var q=F/(u-1),G=t.clips[P];E(A,U,G.start*(1-q)+G.end*q)}else for(var K=0,ot=0;K<u;K++,ot+=4)E(0,ot,K/(u-1));return _}var Vf=function(t){function i(u){t.call(this,u,Gf),this._updateColorRamp()}return t&&(i.__proto__=t),(i.prototype=Object.create(t&&t.prototype)).constructor=i,i.prototype.createBucket=function(u){return new Sl(u)},i.prototype._handleSpecialPaintPropertyUpdate=function(u){"heatmap-color"===u&&this._updateColorRamp()},i.prototype._updateColorRamp=function(){this.colorRamp=Ep({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null},i.prototype.resize=function(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)},i.prototype.queryRadius=function(){return 0},i.prototype.queryIntersectsFeature=function(){return!1},i.prototype.hasOffscreenPass=function(){return 0!==this.paint.get("heatmap-opacity")&&"none"!==this.visibility},i}(Wr),jf={paint:new so({"hillshade-illumination-direction":new yr(_t.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new yr(_t.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new yr(_t.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new yr(_t.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new yr(_t.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new yr(_t.paint_hillshade["hillshade-accent-color"])})},Xf=function(t){function i(u){t.call(this,u,jf)}return t&&(i.__proto__=t),(i.prototype=Object.create(t&&t.prototype)).constructor=i,i.prototype.hasOffscreenPass=function(){return 0!==this.paint.get("hillshade-exaggeration")&&"none"!==this.visibility},i}(Wr),Yf=oi([{name:"a_pos",components:2,type:"Int16"}],4).members,Oh=th,Wf=th;function th(t,i,u){u=u||2;var g,_,E,P,A,F,U,q=i&&i.length,G=q?i[0]*u:t.length,K=Cp(t,0,G,u,!0),ot=[];if(!K||K.next===K.prev)return ot;if(q&&(K=function(Mt,Zt,Xt,ce){var fe,Ce,Pe,be=[];for(fe=0,Ce=Zt.length;fe<Ce;fe++)(Pe=Cp(Mt,Zt[fe]*ce,fe<Ce-1?Zt[fe+1]*ce:Mt.length,ce,!1))===Pe.next&&(Pe.steiner=!0),be.push(Dh(Pe));for(be.sort(ai),fe=0;fe<be.length;fe++)ui(be[fe],Xt),Xt=Rr(Xt,Xt.next);return Xt}(t,i,K,u)),t.length>80*u){g=E=t[0],_=P=t[1];for(var It=u;It<G;It+=u)(A=t[It])<g&&(g=A),(F=t[It+1])<_&&(_=F),A>E&&(E=A),F>P&&(P=F);U=0!==(U=Math.max(E-g,P-_))?1/U:0}return Nr(K,ot,u,g,_,U),ot}function Cp(t,i,u,g,_){var E,P;if(_===Nh(t,i,u,g)>0)for(E=i;E<u;E+=g)P=Pp(E,t[E],t[E+1],P);else for(E=u-g;E>=i;E-=g)P=Pp(E,t[E],t[E+1],P);return P&&eh(P,P.next)&&(Ac(P),P=P.next),P}function Rr(t,i){if(!t)return t;i||(i=t);var u,g=t;do{if(u=!1,g.steiner||!eh(g,g.next)&&0!==Yo(g.prev,g,g.next))g=g.next;else{if(Ac(g),(g=i=g.prev)===g.next)break;u=!0}}while(u||g!==i);return i}function Nr(t,i,u,g,_,E,P){if(t){!P&&E&&function(q,G,K,ot){var It=q;do{null===It.z&&(It.z=nt(It.x,It.y,G,K,ot)),It.prevZ=It.prev,It.nextZ=It.next,It=It.next}while(It!==q);It.prevZ.nextZ=null,It.prevZ=null,function(Mt){var Zt,Xt,ce,fe,Ce,Pe,be,ar,lr=1;do{for(Xt=Mt,Mt=null,Ce=null,Pe=0;Xt;){for(Pe++,ce=Xt,be=0,Zt=0;Zt<lr&&(be++,ce=ce.nextZ);Zt++);for(ar=lr;be>0||ar>0&&ce;)0!==be&&(0===ar||!ce||Xt.z<=ce.z)?(fe=Xt,Xt=Xt.nextZ,be--):(fe=ce,ce=ce.nextZ,ar--),Ce?Ce.nextZ=fe:Mt=fe,fe.prevZ=Ce,Ce=fe;Xt=ce}Ce.nextZ=null,lr*=2}while(Pe>1)}(It)}(t,g,_,E);for(var A,F,U=t;t.prev!==t.next;)if(A=t.prev,F=t.next,E?$r(t,g,_,E):an(t))i.push(A.i/u),i.push(t.i/u),i.push(F.i/u),Ac(t),t=F.next,U=F.next;else if((t=F)===U){P?1===P?Nr(t=bn(Rr(t),i,u),i,u,g,_,E,2):2===P&&xn(t,i,u,g,_,E):Nr(Rr(t),i,u,g,_,E,1);break}}}function an(t){var i=t.prev,u=t,g=t.next;if(Yo(i,u,g)>=0)return!1;for(var _=t.next.next;_!==t.prev;){if(tc(i.x,i.y,u.x,u.y,g.x,g.y,_.x,_.y)&&Yo(_.prev,_,_.next)>=0)return!1;_=_.next}return!0}function $r(t,i,u,g){var _=t.prev,E=t,P=t.next;if(Yo(_,E,P)>=0)return!1;for(var A=_.x>E.x?_.x>P.x?_.x:P.x:E.x>P.x?E.x:P.x,F=_.y>E.y?_.y>P.y?_.y:P.y:E.y>P.y?E.y:P.y,U=nt(_.x<E.x?_.x<P.x?_.x:P.x:E.x<P.x?E.x:P.x,_.y<E.y?_.y<P.y?_.y:P.y:E.y<P.y?E.y:P.y,i,u,g),q=nt(A,F,i,u,g),G=t.prevZ,K=t.nextZ;G&&G.z>=U&&K&&K.z<=q;){if(G!==t.prev&&G!==t.next&&tc(_.x,_.y,E.x,E.y,P.x,P.y,G.x,G.y)&&Yo(G.prev,G,G.next)>=0||(G=G.prevZ,K!==t.prev&&K!==t.next&&tc(_.x,_.y,E.x,E.y,P.x,P.y,K.x,K.y)&&Yo(K.prev,K,K.next)>=0))return!1;K=K.nextZ}for(;G&&G.z>=U;){if(G!==t.prev&&G!==t.next&&tc(_.x,_.y,E.x,E.y,P.x,P.y,G.x,G.y)&&Yo(G.prev,G,G.next)>=0)return!1;G=G.prevZ}for(;K&&K.z<=q;){if(K!==t.prev&&K!==t.next&&tc(_.x,_.y,E.x,E.y,P.x,P.y,K.x,K.y)&&Yo(K.prev,K,K.next)>=0)return!1;K=K.nextZ}return!0}function bn(t,i,u){var g=t;do{var _=g.prev,E=g.next.next;!eh(_,E)&&Sp(_,g,g.next,E)&&ih(_,E)&&ih(E,_)&&(i.push(_.i/u),i.push(g.i/u),i.push(E.i/u),Ac(g),Ac(g.next),g=t=E),g=g.next}while(g!==t);return Rr(g)}function xn(t,i,u,g,_,E){var P=t;do{for(var A=P.next.next;A!==P.prev;){if(P.i!==A.i&&Hf(P,A)){var F=Ip(P,A);return P=Rr(P,P.next),F=Rr(F,F.next),Nr(P,i,u,g,_,E),void Nr(F,i,u,g,_,E)}A=A.next}P=P.next}while(P!==t)}function ai(t,i){return t.x-i.x}function ui(t,i){if(i=function(g,_){var E,P=_,A=g.x,F=g.y,U=-1/0;do{if(F<=P.y&&F>=P.next.y&&P.next.y!==P.y){var q=P.x+(F-P.y)*(P.next.x-P.x)/(P.next.y-P.y);if(q<=A&&q>U){if(U=q,q===A){if(F===P.y)return P;if(F===P.next.y)return P.next}E=P.x<P.next.x?P:P.next}}P=P.next}while(P!==_);if(!E)return null;if(A===U)return E;var G,K=E,ot=E.x,It=E.y,Mt=1/0;P=E;do{A>=P.x&&P.x>=ot&&A!==P.x&&tc(F<It?A:U,F,ot,It,F<It?U:A,F,P.x,P.y)&&(G=Math.abs(F-P.y)/(A-P.x),ih(P,g)&&(G<Mt||G===Mt&&(P.x>E.x||P.x===E.x&&Ar(E,P)))&&(E=P,Mt=G)),P=P.next}while(P!==K);return E}(t,i)){var u=Ip(i,t);Rr(i,i.next),Rr(u,u.next)}}function Ar(t,i){return Yo(t.prev,t,i.prev)<0&&Yo(i.next,t,t.next)<0}function nt(t,i,u,g,_){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-u)*_)|t<<8))|t<<4))|t<<2))|t<<1))|(i=1431655765&((i=858993459&((i=252645135&((i=16711935&((i=32767*(i-g)*_)|i<<8))|i<<4))|i<<2))|i<<1))<<1}function Dh(t){var i=t,u=t;do{(i.x<u.x||i.x===u.x&&i.y<u.y)&&(u=i),i=i.next}while(i!==t);return u}function tc(t,i,u,g,_,E,P,A){return(_-P)*(i-A)-(t-P)*(E-A)>=0&&(t-P)*(g-A)-(u-P)*(i-A)>=0&&(u-P)*(E-A)-(_-P)*(g-A)>=0}function Hf(t,i){return t.next.i!==i.i&&t.prev.i!==i.i&&!function(u,g){var _=u;do{if(_.i!==u.i&&_.next.i!==u.i&&_.i!==g.i&&_.next.i!==g.i&&Sp(_,_.next,u,g))return!0;_=_.next}while(_!==u);return!1}(t,i)&&(ih(t,i)&&ih(i,t)&&function(u,g){var _=u,E=!1,P=(u.x+g.x)/2,A=(u.y+g.y)/2;do{_.y>A!=_.next.y>A&&_.next.y!==_.y&&P<(_.next.x-_.x)*(A-_.y)/(_.next.y-_.y)+_.x&&(E=!E),_=_.next}while(_!==u);return E}(t,i)&&(Yo(t.prev,t,i.prev)||Yo(t,i.prev,i))||eh(t,i)&&Yo(t.prev,t,t.next)>0&&Yo(i.prev,i,i.next)>0)}function Yo(t,i,u){return(i.y-t.y)*(u.x-i.x)-(i.x-t.x)*(u.y-i.y)}function eh(t,i){return t.x===i.x&&t.y===i.y}function Sp(t,i,u,g){var _=nh(Yo(t,i,u)),E=nh(Yo(t,i,g)),P=nh(Yo(u,g,t)),A=nh(Yo(u,g,i));return _!==E&&P!==A||!(0!==_||!rh(t,u,i))||!(0!==E||!rh(t,g,i))||!(0!==P||!rh(u,t,g))||!(0!==A||!rh(u,i,g))}function rh(t,i,u){return i.x<=Math.max(t.x,u.x)&&i.x>=Math.min(t.x,u.x)&&i.y<=Math.max(t.y,u.y)&&i.y>=Math.min(t.y,u.y)}function nh(t){return t>0?1:t<0?-1:0}function ih(t,i){return Yo(t.prev,t,t.next)<0?Yo(t,i,t.next)>=0&&Yo(t,t.prev,i)>=0:Yo(t,i,t.prev)<0||Yo(t,t.next,i)<0}function Ip(t,i){var u=new Rh(t.i,t.x,t.y),g=new Rh(i.i,i.x,i.y),_=t.next,E=i.prev;return t.next=i,i.prev=t,u.next=_,_.prev=u,g.next=u,u.prev=g,E.next=g,g.prev=E,g}function Pp(t,i,u,g){var _=new Rh(t,i,u);return g?(_.next=g.next,_.prev=g,g.next.prev=_,g.next=_):(_.prev=_,_.next=_),_}function Ac(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function Rh(t,i,u){this.i=t,this.x=i,this.y=u,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Nh(t,i,u,g){for(var _=0,E=i,P=u-g;E<u;E+=g)_+=(t[P]-t[E])*(t[E+1]+t[P+1]),P=E;return _}function Jf(t,i,u,g,_){!function E(P,A,F,U,q){for(;U>F;){if(U-F>600){var G=U-F+1,K=A-F+1,ot=Math.log(G),It=.5*Math.exp(2*ot/3),Mt=.5*Math.sqrt(ot*It*(G-It)/G)*(K-G/2<0?-1:1);E(P,A,Math.max(F,Math.floor(A-K*It/G+Mt)),Math.min(U,Math.floor(A+(G-K)*It/G+Mt)),q)}var Zt=P[A],Xt=F,ce=U;for(oh(P,F,A),q(P[U],Zt)>0&&oh(P,F,U);Xt<ce;){for(oh(P,Xt,ce),Xt++,ce--;q(P[Xt],Zt)<0;)Xt++;for(;q(P[ce],Zt)>0;)ce--}0===q(P[F],Zt)?oh(P,F,ce):oh(P,++ce,U),ce<=A&&(F=ce+1),A<=ce&&(U=ce-1)}}(t,i,u||0,g||t.length-1,_||ug)}function oh(t,i,u){var g=t[i];t[i]=t[u],t[u]=g}function ug(t,i){return t<i?-1:t>i?1:0}function Mp(t,i){var u=t.length;if(u<=1)return[t];for(var g,_,E=[],P=0;P<u;P++){var A=at(t[P]);0!==A&&(t[P].area=Math.abs(A),void 0===_&&(_=A<0),_===A<0?(g&&E.push(g),g=[t[P]]):g.push(t[P]))}if(g&&E.push(g),i>1)for(var F=0;F<E.length;F++)E[F].length<=i||(Jf(E[F],i,1,E[F].length-1,lg),E[F]=E[F].slice(0,i));return E}function lg(t,i){return i.area-t.area}function ah(t,i,u){for(var g=u.patternDependencies,_=!1,E=0,P=i;E<P.length;E+=1){var A=P[E].paint.get(t+"-pattern");A.isConstant()||(_=!0);var F=A.constantOr(null);F&&(_=!0,g[F.to]=!0,g[F.from]=!0)}return _}function zh(t,i,u,g,_){for(var E=_.patternDependencies,P=0,A=i;P<A.length;P+=1){var F=A[P],U=F.paint.get(t+"-pattern").value;if("constant"!==U.kind){var q=U.evaluate({zoom:g-1},u,{},_.availableImages),G=U.evaluate({zoom:g},u,{},_.availableImages),K=U.evaluate({zoom:g+1},u,{},_.availableImages);G=G&&G.name?G.name:G,K=K&&K.name?K.name:K,E[q=q&&q.name?q.name:q]=!0,E[G]=!0,E[K]=!0,u.patterns[F.id]={min:q,mid:G,max:K}}}return u}th.deviation=function(t,i,u,g){var _=i&&i.length,E=Math.abs(Nh(t,0,_?i[0]*u:t.length,u));if(_)for(var P=0,A=i.length;P<A;P++)E-=Math.abs(Nh(t,i[P]*u,P<A-1?i[P+1]*u:t.length,u));var F=0;for(P=0;P<g.length;P+=3){var U=g[P]*u,q=g[P+1]*u,G=g[P+2]*u;F+=Math.abs((t[U]-t[G])*(t[q+1]-t[U+1])-(t[U]-t[q])*(t[G+1]-t[U+1]))}return 0===E&&0===F?0:Math.abs((F-E)/E)},th.flatten=function(t){for(var i=t[0][0].length,u={vertices:[],holes:[],dimensions:i},g=0,_=0;_<t.length;_++){for(var E=0;E<t[_].length;E++)for(var P=0;P<i;P++)u.vertices.push(t[_][E][P]);_>0&&u.holes.push(g+=t[_-1].length)}return u},Oh.default=Wf;var Du=function(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(function(i){return i.id}),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Io,this.indexArray=new Gt,this.indexArray2=new Zr,this.programConfigurations=new qr(t.layers,t.zoom),this.segments=new ct,this.segments2=new ct,this.stateDependentLayerIds=this.layers.filter(function(i){return i.isStateDependent()}).map(function(i){return i.id})};Du.prototype.populate=function(t,i,u){this.hasPattern=ah("fill",this.layers,i);for(var g=this.layers[0].layout.get("fill-sort-key"),_=!g.isConstant(),E=[],P=0,A=t;P<A.length;P+=1){var F=A[P],U=F.feature,q=F.id,G=F.index,K=F.sourceLayerIndex,ot=this.layers[0]._featureFilter.needGeometry,It=hn(U,ot);if(this.layers[0]._featureFilter.filter(new ii(this.zoom),It,u)){var Mt=_?g.evaluate(It,{},u,i.availableImages):void 0,Zt={id:q,properties:U.properties,type:U.type,sourceLayerIndex:K,index:G,geometry:ot?It.geometry:Qr(U),patterns:{},sortKey:Mt};E.push(Zt)}}_&&E.sort(function(lr,zr){return lr.sortKey-zr.sortKey});for(var Xt=0,ce=E;Xt<ce.length;Xt+=1){var fe=ce[Xt],Ce=fe.geometry,Pe=fe.index,be=fe.sourceLayerIndex;if(this.hasPattern){var ar=zh("fill",this.layers,fe,this.zoom,i);this.patternFeatures.push(ar)}else this.addFeature(fe,Ce,Pe,u,{});i.featureIndex.insert(t[Pe].feature,Ce,Pe,be,this.index)}},Du.prototype.update=function(t,i,u){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,i,this.stateDependentLayers,u)},Du.prototype.addFeatures=function(t,i,u){for(var g=0,_=this.patternFeatures;g<_.length;g+=1){var E=_[g];this.addFeature(E,E.geometry,E.index,i,u)}},Du.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},Du.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Du.prototype.upload=function(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Yf),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.indexBuffer2=t.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(t),this.uploaded=!0},Du.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())},Du.prototype.addFeature=function(t,i,u,g,_){for(var E=0,P=Mp(i,500);E<P.length;E+=1){for(var A=P[E],F=0,U=0,q=A;U<q.length;U+=1)F+=q[U].length;for(var G=this.segments.prepareSegment(F,this.layoutVertexArray,this.indexArray),K=G.vertexLength,ot=[],It=[],Mt=0,Zt=A;Mt<Zt.length;Mt+=1){var Xt=Zt[Mt];if(0!==Xt.length){Xt!==A[0]&&It.push(ot.length/2);var ce=this.segments2.prepareSegment(Xt.length,this.layoutVertexArray,this.indexArray2),fe=ce.vertexLength;this.layoutVertexArray.emplaceBack(Xt[0].x,Xt[0].y),this.indexArray2.emplaceBack(fe+Xt.length-1,fe),ot.push(Xt[0].x),ot.push(Xt[0].y);for(var Ce=1;Ce<Xt.length;Ce++)this.layoutVertexArray.emplaceBack(Xt[Ce].x,Xt[Ce].y),this.indexArray2.emplaceBack(fe+Ce-1,fe+Ce),ot.push(Xt[Ce].x),ot.push(Xt[Ce].y);ce.vertexLength+=Xt.length,ce.primitiveLength+=Xt.length}}for(var Pe=Oh(ot,It),be=0;be<Pe.length;be+=3)this.indexArray.emplaceBack(K+Pe[be],K+Pe[be+1],K+Pe[be+2]);G.vertexLength+=F,G.primitiveLength+=Pe.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,u,_,g)},er("FillBucket",Du,{omit:["layers","patternFeatures"]});var cg=new so({"fill-sort-key":new jr(_t.layout_fill["fill-sort-key"])}),hg={paint:new so({"fill-antialias":new yr(_t.paint_fill["fill-antialias"]),"fill-opacity":new jr(_t.paint_fill["fill-opacity"]),"fill-color":new jr(_t.paint_fill["fill-color"]),"fill-outline-color":new jr(_t.paint_fill["fill-outline-color"]),"fill-translate":new yr(_t.paint_fill["fill-translate"]),"fill-translate-anchor":new yr(_t.paint_fill["fill-translate-anchor"]),"fill-pattern":new Ki(_t.paint_fill["fill-pattern"])}),layout:cg},sh=function(t){function i(u){t.call(this,u,hg)}return t&&(i.__proto__=t),(i.prototype=Object.create(t&&t.prototype)).constructor=i,i.prototype.recalculate=function(u,g){t.prototype.recalculate.call(this,u,g);var _=this.paint._values["fill-outline-color"];"constant"===_.value.kind&&void 0===_.value.value&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])},i.prototype.createBucket=function(u){return new Du(u)},i.prototype.queryRadius=function(){return _u(this.paint.get("fill-translate"))},i.prototype.queryIntersectsFeature=function(u,g,_,E,P,A,F){return us(Js(u,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),A.angle,F),E)},i.prototype.isTileClipped=function(){return!0},i}(Wr),kh=oi([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4).members,Tp=ec;function ec(t,i,u,g,_){this.properties={},this.extent=u,this.type=0,this._pbf=t,this._geometry=-1,this._keys=g,this._values=_,t.readFields(Kf,this,i)}function Kf(t,i,u){1==t?i.id=u.readVarint():2==t?function(g,_){for(var E=g.readVarint()+g.pos;g.pos<E;){var P=_._keys[g.readVarint()],A=_._values[g.readVarint()];_.properties[P]=A}}(u,i):3==t?i.type=u.readVarint():4==t&&(i._geometry=u.pos)}function Qf(t){for(var i,u,g=0,_=0,E=t.length,P=E-1;_<E;P=_++)g+=((u=t[P]).x-(i=t[_]).x)*(i.y+u.y);return g}ec.types=["Unknown","Point","LineString","Polygon"],ec.prototype.loadGeometry=function(){var t=this._pbf;t.pos=this._geometry;for(var i,u=t.readVarint()+t.pos,g=1,_=0,E=0,P=0,A=[];t.pos<u;){if(_<=0){var F=t.readVarint();g=7&F,_=F>>3}if(_--,1===g||2===g)E+=t.readSVarint(),P+=t.readSVarint(),1===g&&(i&&A.push(i),i=[]),i.push(new Ft(E,P));else{if(7!==g)throw new Error("unknown command "+g);i&&i.push(i[0].clone())}}return i&&A.push(i),A},ec.prototype.bbox=function(){var t=this._pbf;t.pos=this._geometry;for(var i=t.readVarint()+t.pos,u=1,g=0,_=0,E=0,P=1/0,A=-1/0,F=1/0,U=-1/0;t.pos<i;){if(g<=0){var q=t.readVarint();u=7&q,g=q>>3}if(g--,1===u||2===u)(_+=t.readSVarint())<P&&(P=_),_>A&&(A=_),(E+=t.readSVarint())<F&&(F=E),E>U&&(U=E);else if(7!==u)throw new Error("unknown command "+u)}return[P,F,A,U]},ec.prototype.toGeoJSON=function(t,i,u){var g,_,E=this.extent*Math.pow(2,u),P=this.extent*t,A=this.extent*i,F=this.loadGeometry(),U=ec.types[this.type];function q(ot){for(var It=0;It<ot.length;It++){var Mt=ot[It];ot[It]=[360*(Mt.x+P)/E-180,360/Math.PI*Math.atan(Math.exp((180-360*(Mt.y+A)/E)*Math.PI/180))-90]}}switch(this.type){case 1:var G=[];for(g=0;g<F.length;g++)G[g]=F[g][0];q(F=G);break;case 2:for(g=0;g<F.length;g++)q(F[g]);break;case 3:for(F=function(ot){var It=ot.length;if(It<=1)return[ot];for(var Mt,Zt,Xt=[],ce=0;ce<It;ce++){var fe=Qf(ot[ce]);0!==fe&&(void 0===Zt&&(Zt=fe<0),Zt===fe<0?(Mt&&Xt.push(Mt),Mt=[ot[ce]]):Mt.push(ot[ce]))}return Mt&&Xt.push(Mt),Xt}(F),g=0;g<F.length;g++)for(_=0;_<F[g].length;_++)q(F[g][_])}1===F.length?F=F[0]:U="Multi"+U;var K={type:"Feature",geometry:{type:U,coordinates:F},properties:this.properties};return"id"in this&&(K.id=this.id),K};var Ap=Lp;function Lp(t,i){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=t,this._keys=[],this._values=[],this._features=[],t.readFields(pg,this,i),this.length=this._features.length}function pg(t,i,u){15===t?i.version=u.readVarint():1===t?i.name=u.readString():5===t?i.extent=u.readVarint():2===t?i._features.push(u.pos):3===t?i._keys.push(u.readString()):4===t&&i._values.push(function(g){for(var _=null,E=g.readVarint()+g.pos;g.pos<E;){var P=g.readVarint()>>3;_=1===P?g.readString():2===P?g.readFloat():3===P?g.readDouble():4===P?g.readVarint64():5===P?g.readVarint():6===P?g.readSVarint():7===P?g.readBoolean():null}return _}(u))}function Op(t,i,u){if(3===t){var g=new Ap(u,u.readVarint()+u.pos);g.length&&(i[g.name]=g)}}Lp.prototype.feature=function(t){if(t<0||t>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[t];var i=this._pbf.readVarint()+this._pbf.pos;return new Tp(this._pbf,i,this.extent,this._keys,this._values)};var rc={VectorTile:function(t,i){this.layers=t.readFields(Op,{},i)},VectorTileFeature:Tp,VectorTileLayer:Ap},fg=rc.VectorTileFeature.types,Fh=Math.pow(2,13);function Ml(t,i,u,g,_,E,P,A){t.emplaceBack(i,u,2*Math.floor(g*Fh)+P,_*Fh*2,E*Fh*2,Math.round(A))}var xu=function(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(function(i){return i.id}),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new qa,this.indexArray=new Gt,this.programConfigurations=new qr(t.layers,t.zoom),this.segments=new ct,this.stateDependentLayerIds=this.layers.filter(function(i){return i.isStateDependent()}).map(function(i){return i.id})};function Dp(t,i){return t.x===i.x&&(t.x<0||t.x>8192)||t.y===i.y&&(t.y<0||t.y>8192)}xu.prototype.populate=function(t,i,u){this.features=[],this.hasPattern=ah("fill-extrusion",this.layers,i);for(var g=0,_=t;g<_.length;g+=1){var E=_[g],P=E.feature,A=E.id,F=E.index,U=E.sourceLayerIndex,q=this.layers[0]._featureFilter.needGeometry,G=hn(P,q);if(this.layers[0]._featureFilter.filter(new ii(this.zoom),G,u)){var K={id:A,sourceLayerIndex:U,index:F,geometry:q?G.geometry:Qr(P),properties:P.properties,type:P.type,patterns:{}};this.hasPattern?this.features.push(zh("fill-extrusion",this.layers,K,this.zoom,i)):this.addFeature(K,K.geometry,F,u,{}),i.featureIndex.insert(P,K.geometry,F,U,this.index,!0)}}},xu.prototype.addFeatures=function(t,i,u){for(var g=0,_=this.features;g<_.length;g+=1){var E=_[g];this.addFeature(E,E.geometry,E.index,i,u)}},xu.prototype.update=function(t,i,u){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,i,this.stateDependentLayers,u)},xu.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},xu.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},xu.prototype.upload=function(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,kh),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0},xu.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},xu.prototype.addFeature=function(t,i,u,g,_){for(var E=0,P=Mp(i,500);E<P.length;E+=1){for(var A=P[E],F=0,U=0,q=A;U<q.length;U+=1)F+=q[U].length;for(var G=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray),K=0,ot=A;K<ot.length;K+=1){var It=ot[K];if(0!==It.length&&!((An=It).every(function(mn){return mn.x<0})||An.every(function(mn){return mn.x>8192})||An.every(function(mn){return mn.y<0})||An.every(function(mn){return mn.y>8192})))for(var Mt=0,Zt=0;Zt<It.length;Zt++){var Xt=It[Zt];if(Zt>=1){var ce=It[Zt-1];if(!Dp(Xt,ce)){G.vertexLength+4>ct.MAX_VERTEX_ARRAY_LENGTH&&(G=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));var fe=Xt.sub(ce)._perp()._unit(),Ce=ce.dist(Xt);Mt+Ce>32768&&(Mt=0),Ml(this.layoutVertexArray,Xt.x,Xt.y,fe.x,fe.y,0,0,Mt),Ml(this.layoutVertexArray,Xt.x,Xt.y,fe.x,fe.y,0,1,Mt),Ml(this.layoutVertexArray,ce.x,ce.y,fe.x,fe.y,0,0,Mt+=Ce),Ml(this.layoutVertexArray,ce.x,ce.y,fe.x,fe.y,0,1,Mt);var Pe=G.vertexLength;this.indexArray.emplaceBack(Pe,Pe+2,Pe+1),this.indexArray.emplaceBack(Pe+1,Pe+2,Pe+3),G.vertexLength+=4,G.primitiveLength+=2}}}}if(G.vertexLength+F>ct.MAX_VERTEX_ARRAY_LENGTH&&(G=this.segments.prepareSegment(F,this.layoutVertexArray,this.indexArray)),"Polygon"===fg[t.type]){for(var be=[],ar=[],lr=G.vertexLength,zr=0,xr=A;zr<xr.length;zr+=1){var kr=xr[zr];if(0!==kr.length){kr!==A[0]&&ar.push(be.length/2);for(var Ir=0;Ir<kr.length;Ir++){var Ur=kr[Ir];Ml(this.layoutVertexArray,Ur.x,Ur.y,0,0,1,1,0),be.push(Ur.x),be.push(Ur.y)}}}for(var Hr=Oh(be,ar),Lr=0;Lr<Hr.length;Lr+=3)this.indexArray.emplaceBack(lr+Hr[Lr],lr+Hr[Lr+2],lr+Hr[Lr+1]);G.primitiveLength+=Hr.length/3,G.vertexLength+=F}}var An;this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,u,_,g)},er("FillExtrusionBucket",xu,{omit:["layers","features"]});var $f={paint:new so({"fill-extrusion-opacity":new yr(_t["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new jr(_t["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new yr(_t["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new yr(_t["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Ki(_t["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new jr(_t["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new jr(_t["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new yr(_t["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})},td=function(t){function i(u){t.call(this,u,$f)}return t&&(i.__proto__=t),(i.prototype=Object.create(t&&t.prototype)).constructor=i,i.prototype.createBucket=function(u){return new xu(u)},i.prototype.queryRadius=function(){return _u(this.paint.get("fill-extrusion-translate"))},i.prototype.is3D=function(){return!0},i.prototype.queryIntersectsFeature=function(u,g,_,E,P,A,F,U){var q=Js(u,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),A.angle,F),G=this.paint.get("fill-extrusion-height").evaluate(g,_),K=this.paint.get("fill-extrusion-base").evaluate(g,_),ot=function(Mt,Zt,Xt,ce){for(var fe=[],Ce=0,Pe=Mt;Ce<Pe.length;Ce+=1){var be=Pe[Ce],ar=[be.x,be.y,0,1];Ql(ar,ar,Zt),fe.push(new Ft(ar[0]/ar[3],ar[1]/ar[3]))}return fe}(q,U),It=function(Mt,Zt,Xt,ce){for(var fe=[],Ce=[],Pe=ce[8]*Zt,be=ce[9]*Zt,ar=ce[10]*Zt,lr=ce[11]*Zt,zr=ce[8]*Xt,xr=ce[9]*Xt,kr=ce[10]*Xt,Ir=ce[11]*Xt,Ur=0,Hr=Mt;Ur<Hr.length;Ur+=1){for(var Lr=[],An=[],mn=0,Gn=Hr[Ur];mn<Gn.length;mn+=1){var Vr=Gn[mn],Wn=Vr.x,Ri=Vr.y,uo=ce[0]*Wn+ce[4]*Ri+ce[12],eo=ce[1]*Wn+ce[5]*Ri+ce[13],Ui=ce[2]*Wn+ce[6]*Ri+ce[14],ro=ce[3]*Wn+ce[7]*Ri+ce[15],qo=Ui+ar,qi=ro+lr,Va=uo+zr,pa=eo+xr,ja=Ui+kr,mo=ro+Ir,Ea=new Ft((uo+Pe)/qi,(eo+be)/qi);Ea.z=qo/qi,Lr.push(Ea);var kn=new Ft(Va/mo,pa/mo);kn.z=ja/mo,An.push(kn)}fe.push(Lr),Ce.push(An)}return[fe,Ce]}(E,K,G,U);return function(Mt,Zt,Xt){var ce=1/0;us(Xt,Zt)&&(ce=Rp(Xt,Zt[0]));for(var fe=0;fe<Zt.length;fe++)for(var Ce=Zt[fe],Pe=Mt[fe],be=0;be<Ce.length-1;be++){var ar=Ce[be],lr=[ar,Ce[be+1],Pe[be+1],Pe[be],ar];ba(Xt,lr)&&(ce=Math.min(ce,Rp(Xt,lr)))}return ce!==1/0&&ce}(It[0],It[1],ot)},i}(Wr);function nc(t,i){return t.x*i.x+t.y*i.y}function Rp(t,i){if(1===t.length){for(var u,g=0,_=i[g++];!u||_.equals(u);)if(!(u=i[g++]))return 1/0;for(;g<i.length;g++){var E=i[g],P=t[0],A=u.sub(_),F=E.sub(_),U=P.sub(_),q=nc(A,A),G=nc(A,F),K=nc(F,F),ot=nc(U,A),It=nc(U,F),Mt=q*K-G*G,Zt=(K*ot-G*It)/Mt,Xt=(q*It-G*ot)/Mt,ce=_.z*(1-Zt-Xt)+u.z*Zt+E.z*Xt;if(isFinite(ce))return ce}return 1/0}for(var fe=1/0,Ce=0,Pe=i;Ce<Pe.length;Ce+=1)fe=Math.min(fe,Pe[Ce].z);return fe}var ed=oi([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4).members,rd=oi([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]).members,nd=rc.VectorTileFeature.types,id=Math.cos(Math.PI/180*37.5),od=Math.pow(2,14)/.5,gs=function(t){var i=this;this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(function(u){return u.id}),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(function(u){i.gradients[u.id]={}}),this.layoutVertexArray=new Hs,this.layoutVertexArray2=new n,this.indexArray=new Gt,this.programConfigurations=new qr(t.layers,t.zoom),this.segments=new ct,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(function(u){return u.isStateDependent()}).map(function(u){return u.id})};gs.prototype.populate=function(t,i,u){this.hasPattern=ah("line",this.layers,i);for(var g=this.layers[0].layout.get("line-sort-key"),_=!g.isConstant(),E=[],P=0,A=t;P<A.length;P+=1){var F=A[P],U=F.feature,q=F.id,G=F.index,K=F.sourceLayerIndex,ot=this.layers[0]._featureFilter.needGeometry,It=hn(U,ot);if(this.layers[0]._featureFilter.filter(new ii(this.zoom),It,u)){var Mt=_?g.evaluate(It,{},u):void 0,Zt={id:q,properties:U.properties,type:U.type,sourceLayerIndex:K,index:G,geometry:ot?It.geometry:Qr(U),patterns:{},sortKey:Mt};E.push(Zt)}}_&&E.sort(function(lr,zr){return lr.sortKey-zr.sortKey});for(var Xt=0,ce=E;Xt<ce.length;Xt+=1){var fe=ce[Xt],Ce=fe.geometry,Pe=fe.index,be=fe.sourceLayerIndex;if(this.hasPattern){var ar=zh("line",this.layers,fe,this.zoom,i);this.patternFeatures.push(ar)}else this.addFeature(fe,Ce,Pe,u,{});i.featureIndex.insert(t[Pe].feature,Ce,Pe,be,this.index)}},gs.prototype.update=function(t,i,u){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,i,this.stateDependentLayers,u)},gs.prototype.addFeatures=function(t,i,u){for(var g=0,_=this.patternFeatures;g<_.length;g+=1){var E=_[g];this.addFeature(E,E.geometry,E.index,i,u)}},gs.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},gs.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},gs.prototype.upload=function(t){this.uploaded||(0!==this.layoutVertexArray2.length&&(this.layoutVertexBuffer2=t.createVertexBuffer(this.layoutVertexArray2,rd)),this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,ed),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0},gs.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},gs.prototype.lineFeatureClips=function(t){if(t.properties&&t.properties.hasOwnProperty("mapbox_clip_start")&&t.properties.hasOwnProperty("mapbox_clip_end"))return{start:+t.properties.mapbox_clip_start,end:+t.properties.mapbox_clip_end}},gs.prototype.addFeature=function(t,i,u,g,_){var E=this.layers[0].layout,P=E.get("line-join").evaluate(t,{}),A=E.get("line-cap"),F=E.get("line-miter-limit"),U=E.get("line-round-limit");this.lineClips=this.lineFeatureClips(t);for(var q=0,G=i;q<G.length;q+=1)this.addLine(G[q],t,P,A,F,U);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,u,_,g)},gs.prototype.addLine=function(t,i,u,g,_,E){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(var P=0;P<t.length-1;P++)this.totalDistance+=t[P].dist(t[P+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}for(var A="Polygon"===nd[i.type],F=t.length;F>=2&&t[F-1].equals(t[F-2]);)F--;for(var U=0;U<F-1&&t[U].equals(t[U+1]);)U++;if(!(F<(A?3:2))){"bevel"===u&&(_=1.05);var q,G=this.overscaling<=16?122880/(512*this.overscaling):0,K=this.segments.prepareSegment(10*F,this.layoutVertexArray,this.indexArray),ot=void 0,It=void 0,Mt=void 0,Zt=void 0;this.e1=this.e2=-1,A&&(Zt=t[U].sub(q=t[F-2])._unit()._perp());for(var Xt=U;Xt<F;Xt++)if(!(It=Xt===F-1?A?t[U+1]:void 0:t[Xt+1])||!t[Xt].equals(It)){Zt&&(Mt=Zt),q&&(ot=q),q=t[Xt],Zt=It?It.sub(q)._unit()._perp():Mt;var ce=(Mt=Mt||Zt).add(Zt);0===ce.x&&0===ce.y||ce._unit();var fe=Mt.x*Zt.x+Mt.y*Zt.y,Ce=ce.x*Zt.x+ce.y*Zt.y,Pe=0!==Ce?1/Ce:1/0,be=2*Math.sqrt(2-2*Ce),ar=Ce<id&&ot&&It,lr=Mt.x*Zt.y-Mt.y*Zt.x>0;if(ar&&Xt>U){var zr=q.dist(ot);if(zr>2*G){var xr=q.sub(q.sub(ot)._mult(G/zr)._round());this.updateDistance(ot,xr),this.addCurrentVertex(xr,Mt,0,0,K),ot=xr}}var kr=ot&&It,Ir=kr?u:A?"butt":g;if(kr&&"round"===Ir&&(Pe<E?Ir="miter":Pe<=2&&(Ir="fakeround")),"miter"===Ir&&Pe>_&&(Ir="bevel"),"bevel"===Ir&&(Pe>2&&(Ir="flipbevel"),Pe<_&&(Ir="miter")),ot&&this.updateDistance(ot,q),"miter"===Ir)ce._mult(Pe),this.addCurrentVertex(q,ce,0,0,K);else if("flipbevel"===Ir){if(Pe>100)ce=Zt.mult(-1);else{var Ur=Pe*Mt.add(Zt).mag()/Mt.sub(Zt).mag();ce._perp()._mult(Ur*(lr?-1:1))}this.addCurrentVertex(q,ce,0,0,K),this.addCurrentVertex(q,ce.mult(-1),0,0,K)}else if("bevel"===Ir||"fakeround"===Ir){var Hr=-Math.sqrt(Pe*Pe-1),Lr=lr?Hr:0,An=lr?0:Hr;if(ot&&this.addCurrentVertex(q,Mt,Lr,An,K),"fakeround"===Ir)for(var mn=Math.round(180*be/Math.PI/20),Gn=1;Gn<mn;Gn++){var Vr=Gn/mn;if(.5!==Vr){var Wn=Vr-.5;Vr+=Vr*Wn*(Vr-1)*((1.0904+fe*(fe*(3.55645-1.43519*fe)-3.2452))*Wn*Wn+(.848013+fe*(.215638*fe-1.06021)))}var Ri=Zt.sub(Mt)._mult(Vr)._add(Mt)._unit()._mult(lr?-1:1);this.addHalfVertex(q,Ri.x,Ri.y,!1,lr,0,K)}It&&this.addCurrentVertex(q,Zt,-Lr,-An,K)}else if("butt"===Ir)this.addCurrentVertex(q,ce,0,0,K);else if("square"===Ir){var uo=ot?1:-1;this.addCurrentVertex(q,ce,uo,uo,K)}else"round"===Ir&&(ot&&(this.addCurrentVertex(q,Mt,0,0,K),this.addCurrentVertex(q,Mt,1,1,K,!0)),It&&(this.addCurrentVertex(q,Zt,-1,-1,K,!0),this.addCurrentVertex(q,Zt,0,0,K)));if(ar&&Xt<F-1){var eo=q.dist(It);if(eo>2*G){var Ui=q.add(It.sub(q)._mult(G/eo)._round());this.updateDistance(q,Ui),this.addCurrentVertex(Ui,Zt,0,0,K),q=Ui}}}}},gs.prototype.addCurrentVertex=function(t,i,u,g,_,E){void 0===E&&(E=!1);var P=i.y*g-i.x,A=-i.y-i.x*g;this.addHalfVertex(t,i.x+i.y*u,i.y-i.x*u,E,!1,u,_),this.addHalfVertex(t,P,A,E,!0,-g,_),this.distance>od/2&&0===this.totalDistance&&(this.distance=0,this.addCurrentVertex(t,i,u,g,_,E))},gs.prototype.addHalfVertex=function(t,i,u,g,_,E,P){var A=.5*(this.lineClips?this.scaledDistance*(od-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((t.x<<1)+(g?1:0),(t.y<<1)+(_?1:0),Math.round(63*i)+128,Math.round(63*u)+128,1+(0===E?0:E<0?-1:1)|(63&A)<<2,A>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);var F=P.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,F),P.primitiveLength++),_?this.e2=F:this.e1=F},gs.prototype.updateScaledDistance=function(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance},gs.prototype.updateDistance=function(t,i){this.distance+=t.dist(i),this.updateScaledDistance()},er("LineBucket",gs,{omit:["layers","patternFeatures"]});var dg=new so({"line-cap":new yr(_t.layout_line["line-cap"]),"line-join":new jr(_t.layout_line["line-join"]),"line-miter-limit":new yr(_t.layout_line["line-miter-limit"]),"line-round-limit":new yr(_t.layout_line["line-round-limit"]),"line-sort-key":new jr(_t.layout_line["line-sort-key"])}),ad={paint:new so({"line-opacity":new jr(_t.paint_line["line-opacity"]),"line-color":new jr(_t.paint_line["line-color"]),"line-translate":new yr(_t.paint_line["line-translate"]),"line-translate-anchor":new yr(_t.paint_line["line-translate-anchor"]),"line-width":new jr(_t.paint_line["line-width"]),"line-gap-width":new jr(_t.paint_line["line-gap-width"]),"line-offset":new jr(_t.paint_line["line-offset"]),"line-blur":new jr(_t.paint_line["line-blur"]),"line-dasharray":new ha(_t.paint_line["line-dasharray"]),"line-pattern":new Ki(_t.paint_line["line-pattern"]),"line-gradient":new xa(_t.paint_line["line-gradient"])}),layout:dg},Np=new(function(t){function i(){t.apply(this,arguments)}return t&&(i.__proto__=t),(i.prototype=Object.create(t&&t.prototype)).constructor=i,i.prototype.possiblyEvaluate=function(u,g){return g=new ii(Math.floor(g.zoom),{now:g.now,fadeDuration:g.fadeDuration,zoomHistory:g.zoomHistory,transition:g.transition}),t.prototype.possiblyEvaluate.call(this,u,g)},i.prototype.evaluate=function(u,g,_,E){return g=qt({},g,{zoom:Math.floor(g.zoom)}),t.prototype.evaluate.call(this,u,g,_,E)},i}(jr))(ad.paint.properties["line-width"].specification);Np.useIntegerZoom=!0;var sd=function(t){function i(u){t.call(this,u,ad),this.gradientVersion=0}return t&&(i.__proto__=t),(i.prototype=Object.create(t&&t.prototype)).constructor=i,i.prototype._handleSpecialPaintPropertyUpdate=function(u){"line-gradient"===u&&(this.stepInterpolant=this._transitionablePaint._values["line-gradient"].value.expression._styleExpression.expression instanceof co,this.gradientVersion=(this.gradientVersion+1)%Ze)},i.prototype.gradientExpression=function(){return this._transitionablePaint._values["line-gradient"].value.expression},i.prototype.recalculate=function(u,g){t.prototype.recalculate.call(this,u,g),this.paint._values["line-floorwidth"]=Np.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,u)},i.prototype.createBucket=function(u){return new gs(u)},i.prototype.queryRadius=function(u){var g=u,_=zp(Xo("line-width",this,g),Xo("line-gap-width",this,g)),E=Xo("line-offset",this,g);return _/2+Math.abs(E)+_u(this.paint.get("line-translate"))},i.prototype.queryIntersectsFeature=function(u,g,_,E,P,A,F){var U=Js(u,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),A.angle,F),q=F/2*zp(this.paint.get("line-width").evaluate(g,_),this.paint.get("line-gap-width").evaluate(g,_)),G=this.paint.get("line-offset").evaluate(g,_);return G&&(E=function(K,ot){for(var It=[],Mt=new Ft(0,0),Zt=0;Zt<K.length;Zt++){for(var Xt=K[Zt],ce=[],fe=0;fe<Xt.length;fe++){var Ce=Xt[fe],Pe=Xt[fe+1],be=0===fe?Mt:Ce.sub(Xt[fe-1])._unit()._perp(),ar=fe===Xt.length-1?Mt:Pe.sub(Ce)._unit()._perp(),lr=be._add(ar)._unit();lr._mult(1/(lr.x*ar.x+lr.y*ar.y)),ce.push(lr._mult(ot)._add(Ce))}It.push(ce)}return It}(E,G*F)),function(K,ot,It){for(var Mt=0;Mt<ot.length;Mt++){var Zt=ot[Mt];if(K.length>=3)for(var Xt=0;Xt<Zt.length;Xt++)if(hu(K,Zt[Xt]))return!0;if(El(K,Zt,It))return!0}return!1}(U,E,q)},i.prototype.isTileClipped=function(){return!0},i}(Wr);function zp(t,i){return i>0?i+2*t:t}var ud=oi([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),ld=oi([{name:"a_projected_pos",components:3,type:"Float32"}],4),cd=(oi([{name:"a_fade_opacity",components:1,type:"Uint32"}],4),oi([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}])),kp=(oi([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]),oi([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4)),Fp=oi([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function Bh(t,i,u){return t.sections.forEach(function(g){var _,P,A;g.text=(_=g.text,P=u,"uppercase"===(A=i.layout.get("text-transform").evaluate(P,{}))?_=_.toLocaleUpperCase():"lowercase"===A&&(_=_.toLocaleLowerCase()),Mn.applyArabicShaping&&(_=Mn.applyArabicShaping(_)),_)}),t}oi([{name:"triangle",components:3,type:"Uint16"}]),oi([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),oi([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),oi([{type:"Float32",name:"offsetX"}]),oi([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);var Lc={"!":"\ufe15","#":"\uff03",$:"\uff04","%":"\uff05","&":"\uff06","(":"\ufe35",")":"\ufe36","*":"\uff0a","+":"\uff0b",",":"\ufe10","-":"\ufe32",".":"\u30fb","/":"\uff0f",":":"\ufe13",";":"\ufe14","<":"\ufe3f","=":"\uff1d",">":"\ufe40","?":"\ufe16","@":"\uff20","[":"\ufe47","\\":"\uff3c","]":"\ufe48","^":"\uff3e",_:"\ufe33","`":"\uff40","{":"\ufe37","|":"\u2015","}":"\ufe38","~":"\uff5e","\xa2":"\uffe0","\xa3":"\uffe1","\xa5":"\uffe5","\xa6":"\uffe4","\xac":"\uffe2","\xaf":"\uffe3","\u2013":"\ufe32","\u2014":"\ufe31","\u2018":"\ufe43","\u2019":"\ufe44","\u201c":"\ufe41","\u201d":"\ufe42","\u2026":"\ufe19","\u2027":"\u30fb","\u20a9":"\uffe6","\u3001":"\ufe11","\u3002":"\ufe12","\u3008":"\ufe3f","\u3009":"\ufe40","\u300a":"\ufe3d","\u300b":"\ufe3e","\u300c":"\ufe41","\u300d":"\ufe42","\u300e":"\ufe43","\u300f":"\ufe44","\u3010":"\ufe3b","\u3011":"\ufe3c","\u3014":"\ufe39","\u3015":"\ufe3a","\u3016":"\ufe17","\u3017":"\ufe18","\uff01":"\ufe15","\uff08":"\ufe35","\uff09":"\ufe36","\uff0c":"\ufe10","\uff0d":"\ufe32","\uff0e":"\u30fb","\uff1a":"\ufe13","\uff1b":"\ufe14","\uff1c":"\ufe3f","\uff1e":"\ufe40","\uff1f":"\ufe16","\uff3b":"\ufe47","\uff3d":"\ufe48","\uff3f":"\ufe33","\uff5b":"\ufe37","\uff5c":"\u2015","\uff5d":"\ufe38","\uff5f":"\ufe35","\uff60":"\ufe36","\uff61":"\ufe12","\uff62":"\ufe41","\uff63":"\ufe42"},hd=function(t,i,u,g,_){var E,P,A=8*_-g-1,F=(1<<A)-1,U=F>>1,q=-7,G=u?_-1:0,K=u?-1:1,ot=t[i+G];for(G+=K,E=ot&(1<<-q)-1,ot>>=-q,q+=A;q>0;E=256*E+t[i+G],G+=K,q-=8);for(P=E&(1<<-q)-1,E>>=-q,q+=g;q>0;P=256*P+t[i+G],G+=K,q-=8);if(0===E)E=1-U;else{if(E===F)return P?NaN:1/0*(ot?-1:1);P+=Math.pow(2,g),E-=U}return(ot?-1:1)*P*Math.pow(2,E-g)},Uh=function(t,i,u,g,_,E){var P,A,F,U=8*E-_-1,q=(1<<U)-1,G=q>>1,K=23===_?Math.pow(2,-24)-Math.pow(2,-77):0,ot=g?0:E-1,It=g?1:-1,Mt=i<0||0===i&&1/i<0?1:0;for(i=Math.abs(i),isNaN(i)||i===1/0?(A=isNaN(i)?1:0,P=q):(P=Math.floor(Math.log(i)/Math.LN2),i*(F=Math.pow(2,-P))<1&&(P--,F*=2),(i+=P+G>=1?K/F:K*Math.pow(2,1-G))*F>=2&&(P++,F/=2),P+G>=q?(A=0,P=q):P+G>=1?(A=(i*F-1)*Math.pow(2,_),P+=G):(A=i*Math.pow(2,G-1)*Math.pow(2,_),P=0));_>=8;t[u+ot]=255&A,ot+=It,A/=256,_-=8);for(P=P<<_|A,U+=_;U>0;t[u+ot]=255&P,ot+=It,P/=256,U-=8);t[u+ot-It]|=128*Mt},uh=Di;function Di(t){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(t)?t:new Uint8Array(t||0),this.pos=0,this.type=0,this.length=this.buf.length}Di.Varint=0,Di.Fixed64=1,Di.Bytes=2,Di.Fixed32=5;var qh="undefined"==typeof TextDecoder?null:new TextDecoder("utf8");function Ru(t){return t.type===Di.Bytes?t.readVarint()+t.pos:t.pos+1}function pd(t,i,u){var g=i<=16383?1:i<=2097151?2:i<=268435455?3:Math.floor(Math.log(i)/(7*Math.LN2));u.realloc(g);for(var _=u.pos-1;_>=t;_--)u.buf[_+g]=u.buf[_]}function gg(t,i){for(var u=0;u<t.length;u++)i.writeVarint(t[u])}function mg(t,i){for(var u=0;u<t.length;u++)i.writeSVarint(t[u])}function yg(t,i){for(var u=0;u<t.length;u++)i.writeFloat(t[u])}function vg(t,i){for(var u=0;u<t.length;u++)i.writeDouble(t[u])}function _g(t,i){for(var u=0;u<t.length;u++)i.writeBoolean(t[u])}function xg(t,i){for(var u=0;u<t.length;u++)i.writeFixed32(t[u])}function bg(t,i){for(var u=0;u<t.length;u++)i.writeSFixed32(t[u])}function wg(t,i){for(var u=0;u<t.length;u++)i.writeFixed64(t[u])}function Eg(t,i){for(var u=0;u<t.length;u++)i.writeSFixed64(t[u])}function Zh(t,i){return(t[i]|t[i+1]<<8|t[i+2]<<16)+16777216*t[i+3]}function ic(t,i,u){t[u]=i,t[u+1]=i>>>8,t[u+2]=i>>>16,t[u+3]=i>>>24}function Gh(t,i){return(t[i]|t[i+1]<<8|t[i+2]<<16)+(t[i+3]<<24)}function Cg(t,i,u){1===t&&u.readMessage(Bp,i)}function Bp(t,i,u){if(3===t){var g=u.readMessage(fd,{}),_=g.width,E=g.height,P=g.left,A=g.top,F=g.advance;i.push({id:g.id,bitmap:new Pl({width:_+6,height:E+6},g.bitmap),metrics:{width:_,height:E,left:P,top:A,advance:F}})}}function fd(t,i,u){1===t?i.id=u.readVarint():2===t?i.bitmap=u.readBytes():3===t?i.width=u.readVarint():4===t?i.height=u.readVarint():5===t?i.left=u.readSVarint():6===t?i.top=u.readSVarint():7===t&&(i.advance=u.readVarint())}function Dc(t){for(var i=0,u=0,g=0,_=t;g<_.length;g+=1){var E=_[g];i+=E.w*E.h,u=Math.max(u,E.w)}t.sort(function(Mt,Zt){return Zt.h-Mt.h});for(var P=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(i/.95)),u),h:1/0}],A=0,F=0,U=0,q=t;U<q.length;U+=1)for(var G=q[U],K=P.length-1;K>=0;K--){var ot=P[K];if(!(G.w>ot.w||G.h>ot.h)){if(G.x=ot.x,G.y=ot.y,F=Math.max(F,G.y+G.h),A=Math.max(A,G.x+G.w),G.w===ot.w&&G.h===ot.h){var It=P.pop();K<P.length&&(P[K]=It)}else G.h===ot.h?(ot.x+=G.w,ot.w-=G.w):G.w===ot.w?(ot.y+=G.h,ot.h-=G.h):(P.push({x:ot.x+G.w,y:ot.y,w:ot.w-G.w,h:G.h}),ot.y+=G.h,ot.h-=G.h);break}}return{w:A,h:F,fill:i/(A*F)||0}}Di.prototype={destroy:function(){this.buf=null},readFields:function(t,i,u){for(u=u||this.length;this.pos<u;){var g=this.readVarint(),_=g>>3,E=this.pos;this.type=7&g,t(_,i,this),this.pos===E&&this.skip(g)}return i},readMessage:function(t,i){return this.readFields(t,i,this.readVarint()+this.pos)},readFixed32:function(){var t=Zh(this.buf,this.pos);return this.pos+=4,t},readSFixed32:function(){var t=Gh(this.buf,this.pos);return this.pos+=4,t},readFixed64:function(){var t=Zh(this.buf,this.pos)+4294967296*Zh(this.buf,this.pos+4);return this.pos+=8,t},readSFixed64:function(){var t=Zh(this.buf,this.pos)+4294967296*Gh(this.buf,this.pos+4);return this.pos+=8,t},readFloat:function(){var t=hd(this.buf,this.pos,!0,23,4);return this.pos+=4,t},readDouble:function(){var t=hd(this.buf,this.pos,!0,52,8);return this.pos+=8,t},readVarint:function(t){var i,u,g=this.buf;return i=127&(u=g[this.pos++]),u<128?i:(i|=(127&(u=g[this.pos++]))<<7,u<128?i:(i|=(127&(u=g[this.pos++]))<<14,u<128?i:(i|=(127&(u=g[this.pos++]))<<21,u<128?i:function(_,E,P){var A,F,U=P.buf;if(A=(112&(F=U[P.pos++]))>>4,F<128||(A|=(127&(F=U[P.pos++]))<<3,F<128)||(A|=(127&(F=U[P.pos++]))<<10,F<128)||(A|=(127&(F=U[P.pos++]))<<17,F<128)||(A|=(127&(F=U[P.pos++]))<<24,F<128)||(A|=(1&(F=U[P.pos++]))<<31,F<128))return function(t,i,u){return u?4294967296*i+(t>>>0):4294967296*(i>>>0)+(t>>>0)}(_,A,E);throw new Error("Expected varint not more than 10 bytes")}(i|=(15&(u=g[this.pos]))<<28,t,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var t=this.readVarint();return t%2==1?(t+1)/-2:t/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var t=this.readVarint()+this.pos,i=this.pos;return this.pos=t,t-i>=12&&qh?qh.decode(this.buf.subarray(i,t)):function(u,g,_){for(var E="",P=g;P<_;){var A,F,U,q=u[P],G=null,K=q>239?4:q>223?3:q>191?2:1;if(P+K>_)break;1===K?q<128&&(G=q):2===K?128==(192&(A=u[P+1]))&&(G=(31&q)<<6|63&A)<=127&&(G=null):3===K?(F=u[P+2],128==(192&(A=u[P+1]))&&128==(192&F)&&((G=(15&q)<<12|(63&A)<<6|63&F)<=2047||G>=55296&&G<=57343)&&(G=null)):4===K&&(F=u[P+2],U=u[P+3],128==(192&(A=u[P+1]))&&128==(192&F)&&128==(192&U)&&((G=(15&q)<<18|(63&A)<<12|(63&F)<<6|63&U)<=65535||G>=1114112)&&(G=null)),null===G?(G=65533,K=1):G>65535&&(G-=65536,E+=String.fromCharCode(G>>>10&1023|55296),G=56320|1023&G),E+=String.fromCharCode(G),P+=K}return E}(this.buf,i,t)},readBytes:function(){var t=this.readVarint()+this.pos,i=this.buf.subarray(this.pos,t);return this.pos=t,i},readPackedVarint:function(t,i){if(this.type!==Di.Bytes)return t.push(this.readVarint(i));var u=Ru(this);for(t=t||[];this.pos<u;)t.push(this.readVarint(i));return t},readPackedSVarint:function(t){if(this.type!==Di.Bytes)return t.push(this.readSVarint());var i=Ru(this);for(t=t||[];this.pos<i;)t.push(this.readSVarint());return t},readPackedBoolean:function(t){if(this.type!==Di.Bytes)return t.push(this.readBoolean());var i=Ru(this);for(t=t||[];this.pos<i;)t.push(this.readBoolean());return t},readPackedFloat:function(t){if(this.type!==Di.Bytes)return t.push(this.readFloat());var i=Ru(this);for(t=t||[];this.pos<i;)t.push(this.readFloat());return t},readPackedDouble:function(t){if(this.type!==Di.Bytes)return t.push(this.readDouble());var i=Ru(this);for(t=t||[];this.pos<i;)t.push(this.readDouble());return t},readPackedFixed32:function(t){if(this.type!==Di.Bytes)return t.push(this.readFixed32());var i=Ru(this);for(t=t||[];this.pos<i;)t.push(this.readFixed32());return t},readPackedSFixed32:function(t){if(this.type!==Di.Bytes)return t.push(this.readSFixed32());var i=Ru(this);for(t=t||[];this.pos<i;)t.push(this.readSFixed32());return t},readPackedFixed64:function(t){if(this.type!==Di.Bytes)return t.push(this.readFixed64());var i=Ru(this);for(t=t||[];this.pos<i;)t.push(this.readFixed64());return t},readPackedSFixed64:function(t){if(this.type!==Di.Bytes)return t.push(this.readSFixed64());var i=Ru(this);for(t=t||[];this.pos<i;)t.push(this.readSFixed64());return t},skip:function(t){var i=7&t;if(i===Di.Varint)for(;this.buf[this.pos++]>127;);else if(i===Di.Bytes)this.pos=this.readVarint()+this.pos;else if(i===Di.Fixed32)this.pos+=4;else{if(i!==Di.Fixed64)throw new Error("Unimplemented type: "+i);this.pos+=8}},writeTag:function(t,i){this.writeVarint(t<<3|i)},realloc:function(t){for(var i=this.length||16;i<this.pos+t;)i*=2;if(i!==this.length){var u=new Uint8Array(i);u.set(this.buf),this.buf=u,this.length=i}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(t){this.realloc(4),ic(this.buf,t,this.pos),this.pos+=4},writeSFixed32:function(t){this.realloc(4),ic(this.buf,t,this.pos),this.pos+=4},writeFixed64:function(t){this.realloc(8),ic(this.buf,-1&t,this.pos),ic(this.buf,Math.floor(t*(1/4294967296)),this.pos+4),this.pos+=8},writeSFixed64:function(t){this.realloc(8),ic(this.buf,-1&t,this.pos),ic(this.buf,Math.floor(t*(1/4294967296)),this.pos+4),this.pos+=8},writeVarint:function(t){(t=+t||0)>268435455||t<0?function(i,u){var g,_,E,A;if(i>=0?(g=i%4294967296|0,_=i/4294967296|0):(_=~(-i/4294967296),4294967295^(g=~(-i%4294967296))?g=g+1|0:(g=0,_=_+1|0)),i>=0x10000000000000000||i<-0x10000000000000000)throw new Error("Given varint doesn't fit into 10 bytes");u.realloc(10),E=g,(A=u).buf[A.pos++]=127&E|128,E>>>=7,A.buf[A.pos++]=127&E|128,E>>>=7,A.buf[A.pos++]=127&E|128,E>>>=7,A.buf[A.pos++]=127&E|128,A.buf[A.pos]=127&(E>>>=7),function(E,P){var A=(7&E)<<4;P.buf[P.pos++]|=A|((E>>>=3)?128:0),E&&(P.buf[P.pos++]=127&E|((E>>>=7)?128:0),E&&(P.buf[P.pos++]=127&E|((E>>>=7)?128:0),E&&(P.buf[P.pos++]=127&E|((E>>>=7)?128:0),E&&(P.buf[P.pos++]=127&E|((E>>>=7)?128:0),E&&(P.buf[P.pos++]=127&E)))))}(_,u)}(t,this):(this.realloc(4),this.buf[this.pos++]=127&t|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=t>>>7&127))))},writeSVarint:function(t){this.writeVarint(t<0?2*-t-1:2*t)},writeBoolean:function(t){this.writeVarint(Boolean(t))},writeString:function(t){t=String(t),this.realloc(4*t.length),this.pos++;var i=this.pos;this.pos=function(g,_,E){for(var P,A,F=0;F<_.length;F++){if((P=_.charCodeAt(F))>55295&&P<57344){if(!A){P>56319||F+1===_.length?(g[E++]=239,g[E++]=191,g[E++]=189):A=P;continue}if(P<56320){g[E++]=239,g[E++]=191,g[E++]=189,A=P;continue}P=A-55296<<10|P-56320|65536,A=null}else A&&(g[E++]=239,g[E++]=191,g[E++]=189,A=null);P<128?g[E++]=P:(P<2048?g[E++]=P>>6|192:(P<65536?g[E++]=P>>12|224:(g[E++]=P>>18|240,g[E++]=P>>12&63|128),g[E++]=P>>6&63|128),g[E++]=63&P|128)}return E}(this.buf,t,this.pos);var u=this.pos-i;u>=128&&pd(i,u,this),this.pos=i-1,this.writeVarint(u),this.pos+=u},writeFloat:function(t){this.realloc(4),Uh(this.buf,t,this.pos,!0,23,4),this.pos+=4},writeDouble:function(t){this.realloc(8),Uh(this.buf,t,this.pos,!0,52,8),this.pos+=8},writeBytes:function(t){var i=t.length;this.writeVarint(i),this.realloc(i);for(var u=0;u<i;u++)this.buf[this.pos++]=t[u]},writeRawMessage:function(t,i){this.pos++;var u=this.pos;t(i,this);var g=this.pos-u;g>=128&&pd(u,g,this),this.pos=u-1,this.writeVarint(g),this.pos+=g},writeMessage:function(t,i,u){this.writeTag(t,Di.Bytes),this.writeRawMessage(i,u)},writePackedVarint:function(t,i){i.length&&this.writeMessage(t,gg,i)},writePackedSVarint:function(t,i){i.length&&this.writeMessage(t,mg,i)},writePackedBoolean:function(t,i){i.length&&this.writeMessage(t,_g,i)},writePackedFloat:function(t,i){i.length&&this.writeMessage(t,yg,i)},writePackedDouble:function(t,i){i.length&&this.writeMessage(t,vg,i)},writePackedFixed32:function(t,i){i.length&&this.writeMessage(t,xg,i)},writePackedSFixed32:function(t,i){i.length&&this.writeMessage(t,bg,i)},writePackedFixed64:function(t,i){i.length&&this.writeMessage(t,wg,i)},writePackedSFixed64:function(t,i){i.length&&this.writeMessage(t,Eg,i)},writeBytesField:function(t,i){this.writeTag(t,Di.Bytes),this.writeBytes(i)},writeFixed32Field:function(t,i){this.writeTag(t,Di.Fixed32),this.writeFixed32(i)},writeSFixed32Field:function(t,i){this.writeTag(t,Di.Fixed32),this.writeSFixed32(i)},writeFixed64Field:function(t,i){this.writeTag(t,Di.Fixed64),this.writeFixed64(i)},writeSFixed64Field:function(t,i){this.writeTag(t,Di.Fixed64),this.writeSFixed64(i)},writeVarintField:function(t,i){this.writeTag(t,Di.Varint),this.writeVarint(i)},writeSVarintField:function(t,i){this.writeTag(t,Di.Varint),this.writeSVarint(i)},writeStringField:function(t,i){this.writeTag(t,Di.Bytes),this.writeString(i)},writeFloatField:function(t,i){this.writeTag(t,Di.Fixed32),this.writeFloat(i)},writeDoubleField:function(t,i){this.writeTag(t,Di.Fixed64),this.writeDouble(i)},writeBooleanField:function(t,i){this.writeVarintField(t,Boolean(i))}};var ju=function(t,i){var u=i.pixelRatio,g=i.version,_=i.stretchX,E=i.stretchY,P=i.content;this.paddedRect=t,this.pixelRatio=u,this.stretchX=_,this.stretchY=E,this.content=P,this.version=g},nl={tl:{configurable:!0},br:{configurable:!0},tlbr:{configurable:!0},displaySize:{configurable:!0}};nl.tl.get=function(){return[this.paddedRect.x+1,this.paddedRect.y+1]},nl.br.get=function(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]},nl.tlbr.get=function(){return this.tl.concat(this.br)},nl.displaySize.get=function(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]},Object.defineProperties(ju.prototype,nl);var oc=function(t,i){var u={},g={};this.haveRenderCallbacks=[];var _=[];this.addImages(t,u,_),this.addImages(i,g,_);var E=Dc(_),P=new ds({width:E.w||1,height:E.h||1});for(var A in t){var F=t[A],U=u[A].paddedRect;ds.copy(F.data,P,{x:0,y:0},{x:U.x+1,y:U.y+1},F.data)}for(var q in i){var G=i[q],K=g[q].paddedRect,ot=K.x+1,It=K.y+1,Mt=G.data.width,Zt=G.data.height;ds.copy(G.data,P,{x:0,y:0},{x:ot,y:It},G.data),ds.copy(G.data,P,{x:0,y:Zt-1},{x:ot,y:It-1},{width:Mt,height:1}),ds.copy(G.data,P,{x:0,y:0},{x:ot,y:It+Zt},{width:Mt,height:1}),ds.copy(G.data,P,{x:Mt-1,y:0},{x:ot-1,y:It},{width:1,height:Zt}),ds.copy(G.data,P,{x:0,y:0},{x:ot+Mt,y:It},{width:1,height:Zt})}this.image=P,this.iconPositions=u,this.patternPositions=g};oc.prototype.addImages=function(t,i,u){for(var g in t){var _=t[g],E={x:0,y:0,w:_.data.width+2,h:_.data.height+2};u.push(E),i[g]=new ju(E,_),_.hasRenderCallback&&this.haveRenderCallbacks.push(g)}},oc.prototype.patchUpdatedImages=function(t,i){for(var u in t.dispatchRenderCallbacks(this.haveRenderCallbacks),t.updatedImages)this.patchUpdatedImage(this.iconPositions[u],t.getImage(u),i),this.patchUpdatedImage(this.patternPositions[u],t.getImage(u),i)},oc.prototype.patchUpdatedImage=function(t,i,u){if(t&&i&&t.version!==i.version){t.version=i.version;var g=t.tl;u.update(i.data,void 0,{x:g[0],y:g[1]})}},er("ImagePosition",ju),er("ImageAtlas",oc);var Ks={horizontal:1,vertical:2,horizontalOnly:3},ac=function(){this.scale=1,this.fontStack="",this.imageName=null};ac.forText=function(t,i){var u=new ac;return u.scale=t||1,u.fontStack=i,u},ac.forImage=function(t){var i=new ac;return i.imageName=t,i};var ls=function(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null};function sc(t,i,u,g,_,E,P,A,F,U,q,G,K,ot,It,Mt){var Zt,Xt=ls.fromFeature(t,_);G===Ks.vertical&&Xt.verticalizePunctuation();var ce=Mn.processBidirectionalText,fe=Mn.processStyledBidirectionalText;if(ce&&1===Xt.sections.length){Zt=[];for(var Ce=0,Pe=ce(Xt.toString(),Al(Xt,U,E,i,g,ot,It));Ce<Pe.length;Ce+=1){var be=Pe[Ce],ar=new ls;ar.text=be,ar.sections=Xt.sections;for(var lr=0;lr<be.length;lr++)ar.sectionIndex.push(0);Zt.push(ar)}}else if(fe){Zt=[];for(var zr=0,xr=fe(Xt.text,Xt.sectionIndex,Al(Xt,U,E,i,g,ot,It));zr<xr.length;zr+=1){var kr=xr[zr],Ir=new ls;Ir.text=kr[0],Ir.sectionIndex=kr[1],Ir.sections=Xt.sections,Zt.push(Ir)}}else Zt=function(Lr,An){for(var mn=[],Gn=Lr.text,Vr=0,Wn=0,Ri=An;Wn<Ri.length;Wn+=1){var uo=Ri[Wn];mn.push(Lr.substring(Vr,uo)),Vr=uo}return Vr<Gn.length&&mn.push(Lr.substring(Vr,Gn.length)),mn}(Xt,Al(Xt,U,E,i,g,ot,It));var Ur=[],Hr={positionedLines:Ur,text:Xt.toString(),top:q[1],bottom:q[1],left:q[0],right:q[0],writingMode:G,iconsInText:!1,verticalizable:!1};return function(Lr,An,mn,Gn,Vr,Wn,Ri,uo,eo,Ui,ro,qo){for(var qi=0,Va=-17,pa=0,ja=0,mo="right"===uo?1:"left"===uo?0:.5,Ea=0,kn=0,wi=Vr;kn<wi.length;kn+=1){var Si=wi[kn];Si.trim();var qn=Si.getMaxScale(),ms=24*(qn-1),Xa={positionedGlyphs:[],lineOffset:0};Lr.positionedLines[Ea]=Xa;var Ni=Xa.positionedGlyphs,Fn=0;if(Si.length()){for(var Zi=0;Zi<Si.length();Zi++){var sn=Si.getSection(Zi),fa=Si.getSectionIndex(Zi),Ca=Si.getCharCode(Zi),wu=0,yo=null,As=null,ys=null,Qs=24,Ls=!(eo===Ks.horizontal||!ro&&!tl(Ca)||ro&&(Tl[Ca]||(da=Ca,dr.Arabic(da)||dr["Arabic Supplement"](da)||dr["Arabic Extended-A"](da)||dr["Arabic Presentation Forms-A"](da)||dr["Arabic Presentation Forms-B"](da))));if(sn.imageName){var Us=Gn[sn.imageName];if(!Us)continue;ys=sn.imageName,Lr.iconsInText=Lr.iconsInText||!0,As=Us.paddedRect;var Eu=Us.displaySize;sn.scale=24*sn.scale/qo,wu=ms+(24-Eu[1]*sn.scale),Qs=(yo={width:Eu[0],height:Eu[1],left:1,top:-3,advance:Ls?Eu[1]:Eu[0]}).advance;var zl=Ls?Eu[0]*sn.scale-24*qn:Eu[1]*sn.scale-24*qn;zl>0&&zl>Fn&&(Fn=zl)}else{var kc=mn[sn.fontStack],kl=kc&&kc[Ca];if(kl&&kl.rect)As=kl.rect,yo=kl.metrics;else{var _c=An[sn.fontStack],mh=_c&&_c[Ca];if(!mh)continue;yo=mh.metrics}wu=24*(qn-sn.scale)}Ls?(Lr.verticalizable=!0,Ni.push({glyph:Ca,imageName:ys,x:qi,y:Va+wu,vertical:Ls,scale:sn.scale,fontStack:sn.fontStack,sectionIndex:fa,metrics:yo,rect:As}),qi+=Qs*sn.scale+Ui):(Ni.push({glyph:Ca,imageName:ys,x:qi,y:Va+wu,vertical:Ls,scale:sn.scale,fontStack:sn.fontStack,sectionIndex:fa,metrics:yo,rect:As}),qi+=yo.advance*sn.scale+Ui)}0!==Ni.length&&(pa=Math.max(qi-Ui,pa),dd(Ni,0,Ni.length-1,mo,Fn)),qi=0;var yh=Wn*qn+Fn;Xa.lineOffset=Math.max(Fn,ms),Va+=yh,ja=Math.max(yh,ja),++Ea}else Va+=Wn,++Ea}var da,Fc=Va- -17,Fl=cc(Ri),Bl=Fl.horizontalAlign,Nu=Fl.verticalAlign;(function(Ul,ql,il,ol,Zl,al,sl,Gl,xc){var ul,Bc=(ql-il)*Zl;ul=al!==sl?-Gl*ol- -17:(-ol*xc+.5)*sl;for(var Vl=0,Oa=Ul;Vl<Oa.length;Vl+=1)for(var ga=0,Da=Oa[Vl].positionedGlyphs;ga<Da.length;ga+=1){var vs=Da[ga];vs.x+=Bc,vs.y+=ul}})(Lr.positionedLines,mo,Bl,Nu,pa,ja,Wn,Fc,Vr.length),Lr.top+=-Nu*Fc,Lr.bottom=Lr.top+Fc,Lr.left+=-Bl*pa,Lr.right=Lr.left+pa}(Hr,i,u,g,Zt,P,A,F,G,U,K,Mt),!function(Lr){for(var An=0,mn=Lr;An<mn.length;An+=1)if(0!==mn[An].positionedGlyphs.length)return!1;return!0}(Ur)&&Hr}ls.fromFeature=function(t,i){for(var u=new ls,g=0;g<t.sections.length;g++){var _=t.sections[g];_.image?u.addImageSection(_):u.addTextSection(_,i)}return u},ls.prototype.length=function(){return this.text.length},ls.prototype.getSection=function(t){return this.sections[this.sectionIndex[t]]},ls.prototype.getSectionIndex=function(t){return this.sectionIndex[t]},ls.prototype.getCharCode=function(t){return this.text.charCodeAt(t)},ls.prototype.verticalizePunctuation=function(){this.text=function(t){for(var i="",u=0;u<t.length;u++){var g=t.charCodeAt(u+1)||null,_=t.charCodeAt(u-1)||null;i+=g&&fs(g)&&!Lc[t[u+1]]||_&&fs(_)&&!Lc[t[u-1]]||!Lc[t[u]]?t[u]:Lc[t[u]]}return i}(this.text)},ls.prototype.trim=function(){for(var t=0,i=0;i<this.text.length&&Tl[this.text.charCodeAt(i)];i++)t++;for(var u=this.text.length,g=this.text.length-1;g>=0&&g>=t&&Tl[this.text.charCodeAt(g)];g--)u--;this.text=this.text.substring(t,u),this.sectionIndex=this.sectionIndex.slice(t,u)},ls.prototype.substring=function(t,i){var u=new ls;return u.text=this.text.substring(t,i),u.sectionIndex=this.sectionIndex.slice(t,i),u.sections=this.sections,u},ls.prototype.toString=function(){return this.text},ls.prototype.getMaxScale=function(){var t=this;return this.sectionIndex.reduce(function(i,u){return Math.max(i,t.sections[u].scale)},0)},ls.prototype.addTextSection=function(t,i){this.text+=t.text,this.sections.push(ac.forText(t.scale,t.fontStack||i));for(var u=this.sections.length-1,g=0;g<t.text.length;++g)this.sectionIndex.push(u)},ls.prototype.addImageSection=function(t){var i=t.image?t.image.name:"";if(0!==i.length){var u=this.getNextImageSectionCharCode();u?(this.text+=String.fromCharCode(u),this.sections.push(ac.forImage(i)),this.sectionIndex.push(this.sections.length-1)):xt("Reached maximum number of images 6401")}else xt("Can't add FormattedSection with an empty image.")},ls.prototype.getNextImageSectionCharCode=function(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)};var Tl={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},La={};function uc(t,i,u,g,_,E){if(i.imageName){var P=g[i.imageName];return P?P.displaySize[0]*i.scale*24/E+_:0}var A=u[i.fontStack],F=A&&A[t];return F?F.metrics.advance*i.scale+_:0}function Vh(t,i,u,g){var _=Math.pow(t-i,2);return g?t<i?_/2:2*_:_+Math.abs(u)*u}function Up(t,i,u){var g=0;return 10===t&&(g-=1e4),u&&(g+=150),40!==t&&65288!==t||(g+=50),41!==i&&65289!==i||(g+=50),g}function lc(t,i,u,g,_,E){for(var P=null,A=Vh(i,u,_,E),F=0,U=g;F<U.length;F+=1){var q=U[F],G=Vh(i-q.x,u,_,E)+q.badness;G<=A&&(P=q,A=G)}return{index:t,x:i,priorBreak:P,badness:A}}function Al(t,i,u,g,_,E,P){if("point"!==E)return[];if(!t)return[];for(var A,F=[],U=function(Zt,Xt,ce,fe,Ce,Pe){for(var be=0,ar=0;ar<Zt.length();ar++){var lr=Zt.getSection(ar);be+=uc(Zt.getCharCode(ar),lr,fe,Ce,Xt,Pe)}return be/Math.max(1,Math.ceil(be/ce))}(t,i,u,g,_,P),q=t.text.indexOf("\u200b")>=0,G=0,K=0;K<t.length();K++){var ot=t.getSection(K),It=t.getCharCode(K);if(Tl[It]||(G+=uc(It,ot,g,_,i,P)),K<t.length()-1){var Mt=!((A=It)<11904||!(dr["Bopomofo Extended"](A)||dr.Bopomofo(A)||dr["CJK Compatibility Forms"](A)||dr["CJK Compatibility Ideographs"](A)||dr["CJK Compatibility"](A)||dr["CJK Radicals Supplement"](A)||dr["CJK Strokes"](A)||dr["CJK Symbols and Punctuation"](A)||dr["CJK Unified Ideographs Extension A"](A)||dr["CJK Unified Ideographs"](A)||dr["Enclosed CJK Letters and Months"](A)||dr["Halfwidth and Fullwidth Forms"](A)||dr.Hiragana(A)||dr["Ideographic Description Characters"](A)||dr["Kangxi Radicals"](A)||dr["Katakana Phonetic Extensions"](A)||dr.Katakana(A)||dr["Vertical Forms"](A)||dr["Yi Radicals"](A)||dr["Yi Syllables"](A)));(La[It]||Mt||ot.imageName)&&F.push(lc(K+1,G,U,F,Up(It,t.getCharCode(K+1),Mt&&q),!1))}}return function Zt(Xt){return Xt?Zt(Xt.priorBreak).concat(Xt.index):[]}(lc(t.length(),G,U,F,0,!0))}function cc(t){var i=.5,u=.5;switch(t){case"right":case"top-right":case"bottom-right":i=1;break;case"left":case"top-left":case"bottom-left":i=0}switch(t){case"bottom":case"bottom-right":case"bottom-left":u=1;break;case"top":case"top-right":case"top-left":u=0}return{horizontalAlign:i,verticalAlign:u}}function dd(t,i,u,g,_){if(g||_)for(var E=t[u],P=(t[u].x+E.metrics.advance*E.scale)*g,A=i;A<=u;A++)t[A].x-=P,t[A].y+=_}function qp(t,i,u,g,_,E){var P,A=t.image;if(A.content){var F=A.content,U=A.pixelRatio||1;P=[F[0]/U,F[1]/U,A.displaySize[0]-F[2]/U,A.displaySize[1]-F[3]/U]}var q,G,K,ot,It=i.left*E,Mt=i.right*E;"width"===u||"both"===u?(ot=_[0]+It-g[3],G=_[0]+Mt+g[1]):G=(ot=_[0]+(It+Mt-A.displaySize[0])/2)+A.displaySize[0];var Zt=i.top*E,Xt=i.bottom*E;return"height"===u||"both"===u?(q=_[1]+Zt-g[0],K=_[1]+Xt+g[2]):K=(q=_[1]+(Zt+Xt-A.displaySize[1])/2)+A.displaySize[1],{image:A,top:q,right:G,bottom:K,left:ot,collisionPadding:P}}La[10]=!0,La[32]=!0,La[38]=!0,La[40]=!0,La[41]=!0,La[43]=!0,La[45]=!0,La[47]=!0,La[173]=!0,La[183]=!0,La[8203]=!0,La[8208]=!0,La[8211]=!0,La[8231]=!0;var hc=function(t){function i(u,g,_,E){t.call(this,u,g),this.angle=_,void 0!==E&&(this.segment=E)}return t&&(i.__proto__=t),(i.prototype=Object.create(t&&t.prototype)).constructor=i,i.prototype.clone=function(){return new i(this.x,this.y,this.angle,this.segment)},i}(Ft);function jh(t,i){var u=i.expression;if("constant"===u.kind)return{kind:"constant",layoutSize:u.evaluate(new ii(t+1))};if("source"===u.kind)return{kind:"source"};for(var g=u.zoomStops,_=u.interpolationType,E=0;E<g.length&&g[E]<=t;)E++;for(var P=E=Math.max(0,E-1);P<g.length&&g[P]<t+1;)P++;P=Math.min(g.length-1,P);var A=g[E],F=g[P];return"composite"===u.kind?{kind:"composite",minZoom:A,maxZoom:F,interpolationType:_}:{kind:"camera",minZoom:A,maxZoom:F,minSize:u.evaluate(new ii(A)),maxSize:u.evaluate(new ii(F)),interpolationType:_}}function Zp(t,i,u){var g=i.uSize,_=u.lowerSize;return"source"===t.kind?_/128:"composite"===t.kind?Ei(_/128,u.upperSize/128,i.uSizeT):g}function Xh(t,i){var u=0,g=0;if("constant"===t.kind)g=t.layoutSize;else if("source"!==t.kind){var _=t.interpolationType,E=_?de(si.interpolationFactor(_,i,t.minZoom,t.maxZoom),0,1):0;"camera"===t.kind?g=Ei(t.minSize,t.maxSize,E):u=E}return{uSizeT:u,uSize:g}}er("Anchor",hc);var gd=Object.freeze({__proto__:null,getSizeData:jh,evaluateSizeForFeature:Zp,evaluateSizeForZoom:Xh,SIZE_PACK_FACTOR:128});function Gp(t,i,u,g,_){if(void 0===i.segment)return!0;for(var E=i,P=i.segment+1,A=0;A>-u/2;){if(--P<0)return!1;A-=t[P].dist(E),E=t[P]}A+=t[P].dist(t[P+1]),P++;for(var F=[],U=0;A<u/2;){var q=t[P],G=t[P+1];if(!G)return!1;var K=t[P-1].angleTo(q)-q.angleTo(G);for(K=Math.abs((K+3*Math.PI)%(2*Math.PI)-Math.PI),F.push({distance:A,angleDelta:K}),U+=K;A-F[0].distance>g;)U-=F.shift().angleDelta;if(U>_)return!1;P++,A+=q.dist(G)}return!0}function Vp(t){for(var i=0,u=0;u<t.length-1;u++)i+=t[u].dist(t[u+1]);return i}function Yh(t,i,u){return t?.6*i*u:0}function lh(t,i){return Math.max(t?t.right-t.left:0,i?i.right-i.left:0)}function md(t,i,u,g,_,E){for(var P=Yh(u,_,E),A=lh(u,g)*E,F=0,U=Vp(t)/2,q=0;q<t.length-1;q++){var G=t[q],K=t[q+1],ot=G.dist(K);if(F+ot>U){var It=(U-F)/ot,Mt=Ei(G.x,K.x,It),Zt=Ei(G.y,K.y,It),Xt=new hc(Mt,Zt,K.angleTo(G),q);return Xt._round(),!P||Gp(t,Xt,A,P,i)?Xt:void 0}F+=ot}}function pc(t,i,u,g,_,E,P,A,F){var U=Yh(g,E,P),q=lh(g,_),G=q*P,K=0===t[0].x||t[0].x===F||0===t[0].y||t[0].y===F;return i-G<i/4&&(i=G+i/4),function ot(It,Mt,Zt,Xt,ce,fe,Ce,Pe,be){for(var ar=fe/2,lr=Vp(It),zr=0,xr=Mt-Zt,kr=[],Ir=0;Ir<It.length-1;Ir++){for(var Ur=It[Ir],Hr=It[Ir+1],Lr=Ur.dist(Hr),An=Hr.angleTo(Ur);xr+Zt<zr+Lr;){var mn=((xr+=Zt)-zr)/Lr,Gn=Ei(Ur.x,Hr.x,mn),Vr=Ei(Ur.y,Hr.y,mn);if(Gn>=0&&Gn<be&&Vr>=0&&Vr<be&&xr-ar>=0&&xr+ar<=lr){var Wn=new hc(Gn,Vr,An,Ir);Wn._round(),Xt&&!Gp(It,Wn,fe,Xt,ce)||kr.push(Wn)}}zr+=Lr}return Pe||kr.length||Ce||(kr=ot(It,zr/2,Zt,Xt,ce,fe,Ce,!0,be)),kr}(t,K?i/2*A%i:(q/2+2*E)*P*A%i,i,U,u,G,K,!1,F)}function Ll(t,i,u,g,_){for(var E=[],P=0;P<t.length;P++)for(var A=t[P],F=void 0,U=0;U<A.length-1;U++){var q=A[U],G=A[U+1];q.x<i&&G.x<i||(q.x<i?q=new Ft(i,q.y+(i-q.x)/(G.x-q.x)*(G.y-q.y))._round():G.x<i&&(G=new Ft(i,q.y+(i-q.x)/(G.x-q.x)*(G.y-q.y))._round()),q.y<u&&G.y<u||(q.y<u?q=new Ft(q.x+(u-q.y)/(G.y-q.y)*(G.x-q.x),u)._round():G.y<u&&(G=new Ft(q.x+(u-q.y)/(G.y-q.y)*(G.x-q.x),u)._round()),q.x>=g&&G.x>=g||(q.x>=g?q=new Ft(g,q.y+(g-q.x)/(G.x-q.x)*(G.y-q.y))._round():G.x>=g&&(G=new Ft(g,q.y+(g-q.x)/(G.x-q.x)*(G.y-q.y))._round()),q.y>=_&&G.y>=_||(q.y>=_?q=new Ft(q.x+(_-q.y)/(G.y-q.y)*(G.x-q.x),_)._round():G.y>=_&&(G=new Ft(q.x+(_-q.y)/(G.y-q.y)*(G.x-q.x),_)._round()),F&&q.equals(F[F.length-1])||E.push(F=[q]),F.push(G)))))}return E}function Wh(t,i,u,g){var _=[],E=t.image,P=E.pixelRatio,A=E.paddedRect.w-2,F=E.paddedRect.h-2,U=t.right-t.left,q=t.bottom-t.top,G=E.stretchX||[[0,A]],K=E.stretchY||[[0,F]],ot=function(Gn,Vr){return Gn+Vr[1]-Vr[0]},It=G.reduce(ot,0),Mt=K.reduce(ot,0),Zt=A-It,Xt=F-Mt,ce=0,fe=It,Ce=0,Pe=Mt,be=0,ar=Zt,lr=0,zr=Xt;if(E.content&&g){var xr=E.content;ce=ch(G,0,xr[0]),Ce=ch(K,0,xr[1]),fe=ch(G,xr[0],xr[2]),Pe=ch(K,xr[1],xr[3]),be=xr[0]-ce,lr=xr[1]-Ce,ar=xr[2]-xr[0]-fe,zr=xr[3]-xr[1]-Pe}var kr=function(Gn,Vr,Wn,Ri){var uo=fc(Gn.stretch-ce,fe,U,t.left),eo=hh(Gn.fixed-be,ar,Gn.stretch,It),Ui=fc(Vr.stretch-Ce,Pe,q,t.top),ro=hh(Vr.fixed-lr,zr,Vr.stretch,Mt),qo=fc(Wn.stretch-ce,fe,U,t.left),qi=hh(Wn.fixed-be,ar,Wn.stretch,It),Va=fc(Ri.stretch-Ce,Pe,q,t.top),pa=hh(Ri.fixed-lr,zr,Ri.stretch,Mt),ja=new Ft(uo,Ui),mo=new Ft(qo,Ui),Ea=new Ft(qo,Va),kn=new Ft(uo,Va),wi=new Ft(eo/P,ro/P),Si=new Ft(qi/P,pa/P),qn=i*Math.PI/180;if(qn){var ms=Math.sin(qn),Xa=Math.cos(qn),Ni=[Xa,-ms,ms,Xa];ja._matMult(Ni),mo._matMult(Ni),kn._matMult(Ni),Ea._matMult(Ni)}var Fn=Gn.stretch+Gn.fixed,Zi=Vr.stretch+Vr.fixed;return{tl:ja,tr:mo,bl:kn,br:Ea,tex:{x:E.paddedRect.x+1+Fn,y:E.paddedRect.y+1+Zi,w:Wn.stretch+Wn.fixed-Fn,h:Ri.stretch+Ri.fixed-Zi},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:wi,pixelOffsetBR:Si,minFontScaleX:ar/P/U,minFontScaleY:zr/P/q,isSDF:u}};if(g&&(E.stretchX||E.stretchY))for(var Ir=Hh(G,Zt,It),Ur=Hh(K,Xt,Mt),Hr=0;Hr<Ir.length-1;Hr++)for(var Lr=Ir[Hr],An=Ir[Hr+1],mn=0;mn<Ur.length-1;mn++)_.push(kr(Lr,Ur[mn],An,Ur[mn+1]));else _.push(kr({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:A+1},{fixed:0,stretch:F+1}));return _}function ch(t,i,u){for(var g=0,_=0,E=t;_<E.length;_+=1){var P=E[_];g+=Math.max(i,Math.min(u,P[1]))-Math.max(i,Math.min(u,P[0]))}return g}function Hh(t,i,u){for(var g=[{fixed:-1,stretch:0}],_=0,E=t;_<E.length;_+=1){var P=E[_],A=P[0],F=P[1],U=g[g.length-1];g.push({fixed:A-U.stretch,stretch:U.stretch}),g.push({fixed:A-U.stretch,stretch:U.stretch+(F-A)})}return g.push({fixed:i+1,stretch:u}),g}function fc(t,i,u,g){return t/i*u+g}function hh(t,i,u,g){return t-i*u/g}var ph=function(t,i,u,g,_,E,P,A,F,U){if(this.boxStartIndex=t.length,F){var q=E.top,G=E.bottom,K=E.collisionPadding;K&&(q-=K[1],G+=K[3]);var ot=G-q;ot>0&&(ot=Math.max(10,ot),this.circleDiameter=ot)}else{var It=E.top*P-A,Mt=E.bottom*P+A,Zt=E.left*P-A,Xt=E.right*P+A,ce=E.collisionPadding;if(ce&&(Zt-=ce[0]*P,It-=ce[1]*P,Xt+=ce[2]*P,Mt+=ce[3]*P),U){var fe=new Ft(Zt,It),Ce=new Ft(Xt,It),Pe=new Ft(Zt,Mt),be=new Ft(Xt,Mt),ar=U*Math.PI/180;fe._rotate(ar),Ce._rotate(ar),Pe._rotate(ar),be._rotate(ar),Zt=Math.min(fe.x,Ce.x,Pe.x,be.x),Xt=Math.max(fe.x,Ce.x,Pe.x,be.x),It=Math.min(fe.y,Ce.y,Pe.y,be.y),Mt=Math.max(fe.y,Ce.y,Pe.y,be.y)}t.emplaceBack(i.x,i.y,Zt,It,Xt,Mt,u,g,_)}this.boxEndIndex=t.length},Ol=function(t,i){if(void 0===t&&(t=[]),void 0===i&&(i=yd),this.data=t,this.length=this.data.length,this.compare=i,this.length>0)for(var u=(this.length>>1)-1;u>=0;u--)this._down(u)};function yd(t,i){return t<i?-1:t>i?1:0}function Bo(t,i,u){void 0===i&&(i=1),void 0===u&&(u=!1);for(var g=1/0,_=1/0,E=-1/0,P=-1/0,A=t[0],F=0;F<A.length;F++){var U=A[F];(!F||U.x<g)&&(g=U.x),(!F||U.y<_)&&(_=U.y),(!F||U.x>E)&&(E=U.x),(!F||U.y>P)&&(P=U.y)}var q=Math.min(E-g,P-_),G=q/2,K=new Ol([],vd);if(0===q)return new Ft(g,_);for(var ot=g;ot<E;ot+=q)for(var It=_;It<P;It+=q)K.push(new bu(ot+G,It+G,G,t));for(var Mt=function(ce){for(var fe=0,Ce=0,Pe=0,be=ce[0],ar=0,lr=be.length,zr=lr-1;ar<lr;zr=ar++){var xr=be[ar],kr=be[zr],Ir=xr.x*kr.y-kr.x*xr.y;Ce+=(xr.x+kr.x)*Ir,Pe+=(xr.y+kr.y)*Ir,fe+=3*Ir}return new bu(Ce/fe,Pe/fe,0,ce)}(t),Zt=K.length;K.length;){var Xt=K.pop();(Xt.d>Mt.d||!Mt.d)&&(Mt=Xt,u&&console.log("found best %d after %d probes",Math.round(1e4*Xt.d)/1e4,Zt)),Xt.max-Mt.d<=i||(K.push(new bu(Xt.p.x-(G=Xt.h/2),Xt.p.y-G,G,t)),K.push(new bu(Xt.p.x+G,Xt.p.y-G,G,t)),K.push(new bu(Xt.p.x-G,Xt.p.y+G,G,t)),K.push(new bu(Xt.p.x+G,Xt.p.y+G,G,t)),Zt+=4)}return u&&(console.log("num probes: "+Zt),console.log("best distance: "+Mt.d)),Mt.p}function vd(t,i){return i.max-t.max}function bu(t,i,u,g){this.p=new Ft(t,i),this.h=u,this.d=function(_,E){for(var P=!1,A=1/0,F=0;F<E.length;F++)for(var U=E[F],q=0,G=U.length,K=G-1;q<G;K=q++){var ot=U[q],It=U[K];ot.y>_.y!=It.y>_.y&&_.x<(It.x-ot.x)*(_.y-ot.y)/(It.y-ot.y)+ot.x&&(P=!P),A=Math.min(A,Gu(_,ot,It))}return(P?1:-1)*Math.sqrt(A)}(this.p,g),this.max=this.d+this.h*Math.SQRT2}Ol.prototype.push=function(t){this.data.push(t),this.length++,this._up(this.length-1)},Ol.prototype.pop=function(){if(0!==this.length){var t=this.data[0],i=this.data.pop();return this.length--,this.length>0&&(this.data[0]=i,this._down(0)),t}},Ol.prototype.peek=function(){return this.data[0]},Ol.prototype._up=function(t){for(var i=this.data,u=this.compare,g=i[t];t>0;){var _=t-1>>1,E=i[_];if(u(g,E)>=0)break;i[t]=E,t=_}i[t]=g},Ol.prototype._down=function(t){for(var i=this.data,u=this.compare,g=this.length>>1,_=i[t];t<g;){var E=1+(t<<1),P=i[E],A=E+1;if(A<this.length&&u(i[A],P)<0&&(E=A,P=i[A]),u(P,_)>=0)break;i[t]=P,t=E}i[t]=_};var Ts=Number.POSITIVE_INFINITY;function dc(t,i){return i[1]!==Ts?function(u,g,_){var E=0,P=0;switch(g=Math.abs(g),_=Math.abs(_),u){case"top-right":case"top-left":case"top":P=_-7;break;case"bottom-right":case"bottom-left":case"bottom":P=7-_}switch(u){case"top-right":case"bottom-right":case"right":E=-g;break;case"top-left":case"bottom-left":case"left":E=g}return[E,P]}(t,i[0],i[1]):function(u,g){var _=0,E=0;g<0&&(g=0);var P=g/Math.sqrt(2);switch(u){case"top-right":case"top-left":E=P-7;break;case"bottom-right":case"bottom-left":E=7-P;break;case"bottom":E=7-g;break;case"top":E=g-7}switch(u){case"top-right":case"bottom-right":_=-P;break;case"top-left":case"bottom-left":_=P;break;case"left":_=g;break;case"right":_=-g}return[_,E]}(t,i[0])}function Ga(t){switch(t){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function jp(t,i,u,g,_,E,P,A,F,U,q,G,K,ot,It){var Mt=function(Ce,Pe,be,ar,lr,zr,xr,kr){for(var Ir=ar.layout.get("text-rotate").evaluate(zr,{})*Math.PI/180,Ur=[],Hr=0,Lr=Pe.positionedLines;Hr<Lr.length;Hr+=1)for(var An=Lr[Hr],mn=0,Gn=An.positionedGlyphs;mn<Gn.length;mn+=1){var Vr=Gn[mn];if(Vr.rect){var Wn=Vr.rect||{},Ri=4,uo=!0,eo=1,Ui=0,ro=(lr||kr)&&Vr.vertical,qo=Vr.metrics.advance*Vr.scale/2;if(kr&&Pe.verticalizable&&(Ui=An.lineOffset/2-(Vr.imageName?-(24-Vr.metrics.width*Vr.scale)/2:24*(Vr.scale-1))),Vr.imageName){var qi=xr[Vr.imageName];uo=qi.sdf,Ri=1/(eo=qi.pixelRatio)}var Va=lr?[Vr.x+qo,Vr.y]:[0,0],pa=lr?[0,0]:[Vr.x+qo+be[0],Vr.y+be[1]-Ui],ja=[0,0];ro&&(ja=pa,pa=[0,0]);var mo=(Vr.metrics.left-Ri)*Vr.scale-qo+pa[0],Ea=(-Vr.metrics.top-Ri)*Vr.scale+pa[1],kn=mo+Wn.w*Vr.scale/eo,wi=Ea+Wn.h*Vr.scale/eo,Si=new Ft(mo,Ea),qn=new Ft(kn,Ea),ms=new Ft(mo,wi),Xa=new Ft(kn,wi);if(ro){var Ni=new Ft(-qo,qo- -17),Fn=-Math.PI/2,Zi=12-qo,sn=new Ft(22-Zi,-(Vr.imageName?Zi:0)),fa=new(Function.prototype.bind.apply(Ft,[null].concat(ja)));Si._rotateAround(Fn,Ni)._add(sn)._add(fa),qn._rotateAround(Fn,Ni)._add(sn)._add(fa),ms._rotateAround(Fn,Ni)._add(sn)._add(fa),Xa._rotateAround(Fn,Ni)._add(sn)._add(fa)}if(Ir){var Ca=Math.sin(Ir),wu=Math.cos(Ir),yo=[wu,-Ca,Ca,wu];Si._matMult(yo),qn._matMult(yo),ms._matMult(yo),Xa._matMult(yo)}var As=new Ft(0,0),ys=new Ft(0,0);Ur.push({tl:Si,tr:qn,bl:ms,br:Xa,tex:Wn,writingMode:Pe.writingMode,glyphOffset:Va,sectionIndex:Vr.sectionIndex,isSDF:uo,pixelOffsetTL:As,pixelOffsetBR:ys,minFontScaleX:0,minFontScaleY:0})}}return Ur}(0,u,A,_,E,P,g,t.allowVerticalPlacement),Zt=t.textSizeData,Xt=null;"source"===Zt.kind?(Xt=[128*_.layout.get("text-size").evaluate(P,{})])[0]>32640&&xt(t.layerIds[0]+': Value for "text-size" is >= 255. Reduce your "text-size".'):"composite"===Zt.kind&&((Xt=[128*ot.compositeTextSizes[0].evaluate(P,{},It),128*ot.compositeTextSizes[1].evaluate(P,{},It)])[0]>32640||Xt[1]>32640)&&xt(t.layerIds[0]+': Value for "text-size" is >= 255. Reduce your "text-size".'),t.addSymbols(t.text,Mt,Xt,A,E,P,U,i,F.lineStartIndex,F.lineLength,K,It);for(var ce=0,fe=q;ce<fe.length;ce+=1)G[fe[ce]]=t.text.placedSymbolArray.length-1;return 4*Mt.length}function Xp(t){for(var i in t)return t[i];return null}function Yp(t,i,u,g){var _=t.compareText;if(i in _){for(var E=_[i],P=E.length-1;P>=0;P--)if(g.dist(E[P])<u)return!0}else _[i]=[];return _[i].push(g),!1}var Sg=rc.VectorTileFeature.types,_d=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Jh(t,i,u,g,_,E,P,A,F,U,q,G,K){var ot=A?Math.min(32640,Math.round(A[0])):0,It=A?Math.min(32640,Math.round(A[1])):0;t.emplaceBack(i,u,Math.round(32*g),Math.round(32*_),E,P,(ot<<1)+(F?1:0),It,16*U,16*q,256*G,256*K)}function Wp(t,i,u){t.emplaceBack(i.x,i.y,u),t.emplaceBack(i.x,i.y,u),t.emplaceBack(i.x,i.y,u),t.emplaceBack(i.x,i.y,u)}function Ig(t){for(var i=0,u=t.sections;i<u.length;i+=1)if(wl(u[i].text))return!0;return!1}var Dl=function(t){this.layoutVertexArray=new h,this.indexArray=new Gt,this.programConfigurations=t,this.segments=new ct,this.dynamicLayoutVertexArray=new d,this.opacityVertexArray=new w,this.placedSymbolArray=new C};Dl.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length&&0===this.indexArray.length&&0===this.dynamicLayoutVertexArray.length&&0===this.opacityVertexArray.length},Dl.prototype.upload=function(t,i,u,g){this.isEmpty()||(u&&(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,ud.members),this.indexBuffer=t.createIndexBuffer(this.indexArray,i),this.dynamicLayoutVertexBuffer=t.createVertexBuffer(this.dynamicLayoutVertexArray,ld.members,!0),this.opacityVertexBuffer=t.createVertexBuffer(this.opacityVertexArray,_d,!0),this.opacityVertexBuffer.itemSize=1),(u||g)&&this.programConfigurations.upload(t))},Dl.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())},er("SymbolBuffers",Dl);var fh=function(t,i,u){this.layoutVertexArray=new t,this.layoutAttributes=i,this.indexArray=new u,this.segments=new ct,this.collisionVertexArray=new mt};fh.prototype.upload=function(t){this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=t.createVertexBuffer(this.collisionVertexArray,cd.members,!0)},fh.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())},er("CollisionBuffers",fh);var Mi=function(t){this.collisionBoxArray=t.collisionBoxArray,this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(function(E){return E.id}),this.index=t.index,this.pixelRatio=t.pixelRatio,this.sourceLayerIndex=t.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=Za([]),this.placementViewportMatrix=Za([]);var i=this.layers[0]._unevaluatedLayout._values;this.textSizeData=jh(this.zoom,i["text-size"]),this.iconSizeData=jh(this.zoom,i["icon-size"]);var u=this.layers[0].layout,g=u.get("symbol-sort-key"),_=u.get("symbol-z-order");this.canOverlap=u.get("text-allow-overlap")||u.get("icon-allow-overlap")||u.get("text-ignore-placement")||u.get("icon-ignore-placement"),this.sortFeaturesByKey="viewport-y"!==_&&!g.isConstant(),this.sortFeaturesByY=("viewport-y"===_||"auto"===_&&!this.sortFeaturesByKey)&&this.canOverlap,"point"===u.get("symbol-placement")&&(this.writingModes=u.get("text-writing-mode").map(function(E){return Ks[E]})),this.stateDependentLayerIds=this.layers.filter(function(E){return E.isStateDependent()}).map(function(E){return E.id}),this.sourceID=t.sourceID};Mi.prototype.createArrays=function(){this.text=new Dl(new qr(this.layers,this.zoom,function(t){return/^text/.test(t)})),this.icon=new Dl(new qr(this.layers,this.zoom,function(t){return/^icon/.test(t)})),this.glyphOffsetArray=new z,this.lineVertexArray=new Z,this.symbolInstances=new L},Mi.prototype.calculateGlyphDependencies=function(t,i,u,g,_){for(var E=0;E<t.length;E++)if(i[t.charCodeAt(E)]=!0,(u||g)&&_){var P=Lc[t.charAt(E)];P&&(i[P.charCodeAt(0)]=!0)}},Mi.prototype.populate=function(t,i,u){var g=this.layers[0],_=g.layout,E=_.get("text-font"),P=_.get("text-field"),A=_.get("icon-image"),F=("constant"!==P.value.kind||P.value.value instanceof no&&!P.value.value.isEmpty()||P.value.value.toString().length>0)&&("constant"!==E.value.kind||E.value.value.length>0),U="constant"!==A.value.kind||!!A.value.value||Object.keys(A.parameters).length>0,q=_.get("symbol-sort-key");if(this.features=[],F||U){for(var G=i.iconDependencies,K=i.glyphDependencies,ot=i.availableImages,It=new ii(this.zoom),Mt=0,Zt=t;Mt<Zt.length;Mt+=1){var Xt=Zt[Mt],ce=Xt.feature,fe=Xt.id,Ce=Xt.index,Pe=Xt.sourceLayerIndex,be=g._featureFilter.needGeometry,ar=hn(ce,be);if(g._featureFilter.filter(It,ar,u)){be||(ar.geometry=Qr(ce));var lr=void 0;if(F){var zr=g.getValueAndResolveTokens("text-field",ar,u,ot),xr=no.factory(zr);Ig(xr)&&(this.hasRTLText=!0),(!this.hasRTLText||"unavailable"===as()||this.hasRTLText&&Mn.isParsed())&&(lr=Bh(xr,g,ar))}var kr=void 0;if(U){var Ir=g.getValueAndResolveTokens("icon-image",ar,u,ot);kr=Ir instanceof jn?Ir:jn.fromString(Ir)}if(lr||kr){var Ur=this.sortFeaturesByKey?q.evaluate(ar,{},u):void 0;if(this.features.push({id:fe,text:lr,icon:kr,index:Ce,sourceLayerIndex:Pe,geometry:ar.geometry,properties:ce.properties,type:Sg[ce.type],sortKey:Ur}),kr&&(G[kr.name]=!0),lr){var Hr=E.evaluate(ar,{},u).join(","),Lr="map"===_.get("text-rotation-alignment")&&"point"!==_.get("symbol-placement");this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(Ks.vertical)>=0;for(var An=0,mn=lr.sections;An<mn.length;An+=1){var Gn=mn[An];if(Gn.image)G[Gn.image.name]=!0;else{var Vr=Bi(lr.toString()),Wn=Gn.fontStack||Hr,Ri=K[Wn]=K[Wn]||{};this.calculateGlyphDependencies(Gn.text,Ri,Lr,this.allowVerticalPlacement,Vr)}}}}}}"line"===_.get("symbol-placement")&&(this.features=function(uo){var eo={},Ui={},ro=[],qo=0;function qi(Ni){ro.push(uo[Ni]),qo++}function Va(Ni,Fn,Zi){var sn=Ui[Ni];return delete Ui[Ni],Ui[Fn]=sn,ro[sn].geometry[0].pop(),ro[sn].geometry[0]=ro[sn].geometry[0].concat(Zi[0]),sn}function pa(Ni,Fn,Zi){var sn=eo[Fn];return delete eo[Fn],eo[Ni]=sn,ro[sn].geometry[0].shift(),ro[sn].geometry[0]=Zi[0].concat(ro[sn].geometry[0]),sn}function ja(Ni,Fn,Zi){var sn=Zi?Fn[0][Fn[0].length-1]:Fn[0][0];return Ni+":"+sn.x+":"+sn.y}for(var mo=0;mo<uo.length;mo++){var Ea=uo[mo],kn=Ea.geometry,wi=Ea.text?Ea.text.toString():null;if(wi){var Si=ja(wi,kn),qn=ja(wi,kn,!0);if(Si in Ui&&qn in eo&&Ui[Si]!==eo[qn]){var ms=pa(Si,qn,kn),Xa=Va(Si,qn,ro[ms].geometry);delete eo[Si],delete Ui[qn],Ui[ja(wi,ro[Xa].geometry,!0)]=Xa,ro[ms].geometry=null}else Si in Ui?Va(Si,qn,kn):qn in eo?pa(Si,qn,kn):(qi(mo),eo[Si]=qo-1,Ui[qn]=qo-1)}else qi(mo)}return ro.filter(function(Ni){return Ni.geometry})}(this.features)),this.sortFeaturesByKey&&this.features.sort(function(uo,eo){return uo.sortKey-eo.sortKey})}},Mi.prototype.update=function(t,i,u){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(t,i,this.layers,u),this.icon.programConfigurations.updatePaintArrays(t,i,this.layers,u))},Mi.prototype.isEmpty=function(){return 0===this.symbolInstances.length&&!this.hasRTLText},Mi.prototype.uploadPending=function(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload},Mi.prototype.upload=function(t){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(t),this.iconCollisionBox.upload(t)),this.text.upload(t,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(t,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0},Mi.prototype.destroyDebugData=function(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()},Mi.prototype.destroy=function(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()},Mi.prototype.addToLineVertexArray=function(t,i){var u=this.lineVertexArray.length;if(void 0!==t.segment){for(var g=t.dist(i[t.segment+1]),_=t.dist(i[t.segment]),E={},P=t.segment+1;P<i.length;P++)E[P]={x:i[P].x,y:i[P].y,tileUnitDistanceFromAnchor:g},P<i.length-1&&(g+=i[P+1].dist(i[P]));for(var A=t.segment||0;A>=0;A--)E[A]={x:i[A].x,y:i[A].y,tileUnitDistanceFromAnchor:_},A>0&&(_+=i[A-1].dist(i[A]));for(var F=0;F<i.length;F++){var U=E[F];this.lineVertexArray.emplaceBack(U.x,U.y,U.tileUnitDistanceFromAnchor)}}return{lineStartIndex:u,lineLength:this.lineVertexArray.length-u}},Mi.prototype.addSymbols=function(t,i,u,g,_,E,P,A,F,U,q,G){for(var K=t.indexArray,ot=t.layoutVertexArray,It=t.segments.prepareSegment(4*i.length,ot,K,this.canOverlap?E.sortKey:void 0),Mt=this.glyphOffsetArray.length,Zt=It.vertexLength,Xt=this.allowVerticalPlacement&&P===Ks.vertical?Math.PI/2:0,ce=E.text&&E.text.sections,fe=0;fe<i.length;fe++){var Ce=i[fe],Pe=Ce.tl,be=Ce.tr,ar=Ce.bl,lr=Ce.br,zr=Ce.tex,xr=Ce.pixelOffsetTL,kr=Ce.pixelOffsetBR,Ir=Ce.minFontScaleX,Ur=Ce.minFontScaleY,Hr=Ce.glyphOffset,Lr=Ce.isSDF,An=Ce.sectionIndex,mn=It.vertexLength,Gn=Hr[1];Jh(ot,A.x,A.y,Pe.x,Gn+Pe.y,zr.x,zr.y,u,Lr,xr.x,xr.y,Ir,Ur),Jh(ot,A.x,A.y,be.x,Gn+be.y,zr.x+zr.w,zr.y,u,Lr,kr.x,xr.y,Ir,Ur),Jh(ot,A.x,A.y,ar.x,Gn+ar.y,zr.x,zr.y+zr.h,u,Lr,xr.x,kr.y,Ir,Ur),Jh(ot,A.x,A.y,lr.x,Gn+lr.y,zr.x+zr.w,zr.y+zr.h,u,Lr,kr.x,kr.y,Ir,Ur),Wp(t.dynamicLayoutVertexArray,A,Xt),K.emplaceBack(mn,mn+1,mn+2),K.emplaceBack(mn+1,mn+2,mn+3),It.vertexLength+=4,It.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Hr[0]),fe!==i.length-1&&An===i[fe+1].sectionIndex||t.programConfigurations.populatePaintArrays(ot.length,E,E.index,{},G,ce&&ce[An])}t.placedSymbolArray.emplaceBack(A.x,A.y,Mt,this.glyphOffsetArray.length-Mt,Zt,F,U,A.segment,u?u[0]:0,u?u[1]:0,g[0],g[1],P,0,!1,0,q)},Mi.prototype._addCollisionDebugVertex=function(t,i,u,g,_,E){return i.emplaceBack(0,0),t.emplaceBack(u.x,u.y,g,_,Math.round(E.x),Math.round(E.y))},Mi.prototype.addCollisionDebugVertices=function(t,i,u,g,_,E,P){var A=_.segments.prepareSegment(4,_.layoutVertexArray,_.indexArray),F=A.vertexLength,U=_.layoutVertexArray,q=_.collisionVertexArray,G=P.anchorX,K=P.anchorY;this._addCollisionDebugVertex(U,q,E,G,K,new Ft(t,i)),this._addCollisionDebugVertex(U,q,E,G,K,new Ft(u,i)),this._addCollisionDebugVertex(U,q,E,G,K,new Ft(u,g)),this._addCollisionDebugVertex(U,q,E,G,K,new Ft(t,g)),A.vertexLength+=4;var ot=_.indexArray;ot.emplaceBack(F,F+1),ot.emplaceBack(F+1,F+2),ot.emplaceBack(F+2,F+3),ot.emplaceBack(F+3,F),A.primitiveLength+=4},Mi.prototype.addDebugCollisionBoxes=function(t,i,u,g){for(var _=t;_<i;_++){var E=this.collisionBoxArray.get(_);this.addCollisionDebugVertices(E.x1,E.y1,E.x2,E.y2,g?this.textCollisionBox:this.iconCollisionBox,E.anchorPoint,u)}},Mi.prototype.generateCollisionDebugBuffers=function(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new fh(k,kp.members,Zr),this.iconCollisionBox=new fh(k,kp.members,Zr);for(var t=0;t<this.symbolInstances.length;t++){var i=this.symbolInstances.get(t);this.addDebugCollisionBoxes(i.textBoxStartIndex,i.textBoxEndIndex,i,!0),this.addDebugCollisionBoxes(i.verticalTextBoxStartIndex,i.verticalTextBoxEndIndex,i,!0),this.addDebugCollisionBoxes(i.iconBoxStartIndex,i.iconBoxEndIndex,i,!1),this.addDebugCollisionBoxes(i.verticalIconBoxStartIndex,i.verticalIconBoxEndIndex,i,!1)}},Mi.prototype._deserializeCollisionBoxesForSymbol=function(t,i,u,g,_,E,P,A,F){for(var U={},q=i;q<u;q++){var G=t.get(q);U.textBox={x1:G.x1,y1:G.y1,x2:G.x2,y2:G.y2,anchorPointX:G.anchorPointX,anchorPointY:G.anchorPointY},U.textFeatureIndex=G.featureIndex;break}for(var K=g;K<_;K++){var ot=t.get(K);U.verticalTextBox={x1:ot.x1,y1:ot.y1,x2:ot.x2,y2:ot.y2,anchorPointX:ot.anchorPointX,anchorPointY:ot.anchorPointY},U.verticalTextFeatureIndex=ot.featureIndex;break}for(var It=E;It<P;It++){var Mt=t.get(It);U.iconBox={x1:Mt.x1,y1:Mt.y1,x2:Mt.x2,y2:Mt.y2,anchorPointX:Mt.anchorPointX,anchorPointY:Mt.anchorPointY},U.iconFeatureIndex=Mt.featureIndex;break}for(var Zt=A;Zt<F;Zt++){var Xt=t.get(Zt);U.verticalIconBox={x1:Xt.x1,y1:Xt.y1,x2:Xt.x2,y2:Xt.y2,anchorPointX:Xt.anchorPointX,anchorPointY:Xt.anchorPointY},U.verticalIconFeatureIndex=Xt.featureIndex;break}return U},Mi.prototype.deserializeCollisionBoxes=function(t){this.collisionArrays=[];for(var i=0;i<this.symbolInstances.length;i++){var u=this.symbolInstances.get(i);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(t,u.textBoxStartIndex,u.textBoxEndIndex,u.verticalTextBoxStartIndex,u.verticalTextBoxEndIndex,u.iconBoxStartIndex,u.iconBoxEndIndex,u.verticalIconBoxStartIndex,u.verticalIconBoxEndIndex))}},Mi.prototype.hasTextData=function(){return this.text.segments.get().length>0},Mi.prototype.hasIconData=function(){return this.icon.segments.get().length>0},Mi.prototype.hasDebugData=function(){return this.textCollisionBox&&this.iconCollisionBox},Mi.prototype.hasTextCollisionBoxData=function(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0},Mi.prototype.hasIconCollisionBoxData=function(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0},Mi.prototype.addIndicesForPlacedSymbol=function(t,i){for(var u=t.placedSymbolArray.get(i),g=u.vertexStartIndex+4*u.numGlyphs,_=u.vertexStartIndex;_<g;_+=4)t.indexArray.emplaceBack(_,_+1,_+2),t.indexArray.emplaceBack(_+1,_+2,_+3)},Mi.prototype.getSortedSymbolIndexes=function(t){if(this.sortedAngle===t&&void 0!==this.symbolInstanceIndexes)return this.symbolInstanceIndexes;for(var i=Math.sin(t),u=Math.cos(t),g=[],_=[],E=[],P=0;P<this.symbolInstances.length;++P){E.push(P);var A=this.symbolInstances.get(P);g.push(0|Math.round(i*A.anchorX+u*A.anchorY)),_.push(A.featureIndex)}return E.sort(function(F,U){return g[F]-g[U]||_[U]-_[F]}),E},Mi.prototype.addToSortKeyRanges=function(t,i){var u=this.sortKeyRanges[this.sortKeyRanges.length-1];u&&u.sortKey===i?u.symbolInstanceEnd=t+1:this.sortKeyRanges.push({sortKey:i,symbolInstanceStart:t,symbolInstanceEnd:t+1})},Mi.prototype.sortFeatures=function(t){var i=this;if(this.sortFeaturesByY&&this.sortedAngle!==t&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(t),this.sortedAngle=t,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(var u=0,g=this.symbolInstanceIndexes;u<g.length;u+=1){var _=this.symbolInstances.get(g[u]);this.featureSortOrder.push(_.featureIndex),[_.rightJustifiedTextSymbolIndex,_.centerJustifiedTextSymbolIndex,_.leftJustifiedTextSymbolIndex].forEach(function(E,P,A){E>=0&&A.indexOf(E)===P&&i.addIndicesForPlacedSymbol(i.text,E)}),_.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,_.verticalPlacedTextSymbolIndex),_.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,_.placedIconSymbolIndex),_.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,_.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}},er("SymbolBucket",Mi,{omit:["layers","collisionBoxArray","features","compareText"]}),Mi.MAX_GLYPHS=65535,Mi.addDynamicAttributes=Wp;var Pg=new so({"symbol-placement":new yr(_t.layout_symbol["symbol-placement"]),"symbol-spacing":new yr(_t.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new yr(_t.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new jr(_t.layout_symbol["symbol-sort-key"]),"symbol-z-order":new yr(_t.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new yr(_t.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new yr(_t.layout_symbol["icon-ignore-placement"]),"icon-optional":new yr(_t.layout_symbol["icon-optional"]),"icon-rotation-alignment":new yr(_t.layout_symbol["icon-rotation-alignment"]),"icon-size":new jr(_t.layout_symbol["icon-size"]),"icon-text-fit":new yr(_t.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new yr(_t.layout_symbol["icon-text-fit-padding"]),"icon-image":new jr(_t.layout_symbol["icon-image"]),"icon-rotate":new jr(_t.layout_symbol["icon-rotate"]),"icon-padding":new yr(_t.layout_symbol["icon-padding"]),"icon-keep-upright":new yr(_t.layout_symbol["icon-keep-upright"]),"icon-offset":new jr(_t.layout_symbol["icon-offset"]),"icon-anchor":new jr(_t.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new yr(_t.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new yr(_t.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new yr(_t.layout_symbol["text-rotation-alignment"]),"text-field":new jr(_t.layout_symbol["text-field"]),"text-font":new jr(_t.layout_symbol["text-font"]),"text-size":new jr(_t.layout_symbol["text-size"]),"text-max-width":new jr(_t.layout_symbol["text-max-width"]),"text-line-height":new yr(_t.layout_symbol["text-line-height"]),"text-letter-spacing":new jr(_t.layout_symbol["text-letter-spacing"]),"text-justify":new jr(_t.layout_symbol["text-justify"]),"text-radial-offset":new jr(_t.layout_symbol["text-radial-offset"]),"text-variable-anchor":new yr(_t.layout_symbol["text-variable-anchor"]),"text-anchor":new jr(_t.layout_symbol["text-anchor"]),"text-max-angle":new yr(_t.layout_symbol["text-max-angle"]),"text-writing-mode":new yr(_t.layout_symbol["text-writing-mode"]),"text-rotate":new jr(_t.layout_symbol["text-rotate"]),"text-padding":new yr(_t.layout_symbol["text-padding"]),"text-keep-upright":new yr(_t.layout_symbol["text-keep-upright"]),"text-transform":new jr(_t.layout_symbol["text-transform"]),"text-offset":new jr(_t.layout_symbol["text-offset"]),"text-allow-overlap":new yr(_t.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new yr(_t.layout_symbol["text-ignore-placement"]),"text-optional":new yr(_t.layout_symbol["text-optional"])}),Hp={paint:new so({"icon-opacity":new jr(_t.paint_symbol["icon-opacity"]),"icon-color":new jr(_t.paint_symbol["icon-color"]),"icon-halo-color":new jr(_t.paint_symbol["icon-halo-color"]),"icon-halo-width":new jr(_t.paint_symbol["icon-halo-width"]),"icon-halo-blur":new jr(_t.paint_symbol["icon-halo-blur"]),"icon-translate":new yr(_t.paint_symbol["icon-translate"]),"icon-translate-anchor":new yr(_t.paint_symbol["icon-translate-anchor"]),"text-opacity":new jr(_t.paint_symbol["text-opacity"]),"text-color":new jr(_t.paint_symbol["text-color"],{runtimeType:ln,getOverride:function(t){return t.textColor},hasOverride:function(t){return!!t.textColor}}),"text-halo-color":new jr(_t.paint_symbol["text-halo-color"]),"text-halo-width":new jr(_t.paint_symbol["text-halo-width"]),"text-halo-blur":new jr(_t.paint_symbol["text-halo-blur"]),"text-translate":new yr(_t.paint_symbol["text-translate"]),"text-translate-anchor":new yr(_t.paint_symbol["text-translate-anchor"])}),layout:Pg},Rl=function(t){this.type=t.property.overrides?t.property.overrides.runtimeType:Tr,this.defaultValue=t};Rl.prototype.evaluate=function(t){if(t.formattedSection){var i=this.defaultValue.property.overrides;if(i&&i.hasOverride(t.formattedSection))return i.getOverride(t.formattedSection)}return t.feature&&t.featureState?this.defaultValue.evaluate(t.feature,t.featureState):this.defaultValue.property.specification.default},Rl.prototype.eachChild=function(t){this.defaultValue.isConstant()||t(this.defaultValue.value._styleExpression.expression)},Rl.prototype.outputDefined=function(){return!1},Rl.prototype.serialize=function(){return null},er("FormatSectionOverride",Rl,{omit:["defaultValue"]});var Mg=function(t){function i(u){t.call(this,u,Hp)}return t&&(i.__proto__=t),(i.prototype=Object.create(t&&t.prototype)).constructor=i,i.prototype.recalculate=function(u,g){if(t.prototype.recalculate.call(this,u,g),"auto"===this.layout.get("icon-rotation-alignment")&&(this.layout._values["icon-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-rotation-alignment")&&(this.layout._values["text-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-pitch-alignment")&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),"auto"===this.layout.get("icon-pitch-alignment")&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),"point"===this.layout.get("symbol-placement")){var _=this.layout.get("text-writing-mode");if(_){for(var E=[],P=0,A=_;P<A.length;P+=1){var F=A[P];E.indexOf(F)<0&&E.push(F)}this.layout._values["text-writing-mode"]=E}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()},i.prototype.getValueAndResolveTokens=function(u,g,_,E){var F,P=this.layout.get(u).evaluate(g,{},_,E),A=this._unevaluatedLayout._values[u];return A.isDataDriven()||Na(A.value)||!P?P:(F=g.properties,P.replace(/{([^{}]+)}/g,function(q,G){return G in F?String(F[G]):""}))},i.prototype.createBucket=function(u){return new Mi(u)},i.prototype.queryRadius=function(){return 0},i.prototype.queryIntersectsFeature=function(){return!1},i.prototype._setPaintOverrides=function(){for(var u=0,g=Hp.paint.overridableProperties;u<g.length;u+=1){var _=g[u];if(i.hasPaintOverride(this.layout,_)){var E,P=this.paint.get(_),A=new Rl(P),F=new jo(A,P.property.specification);E="constant"===P.value.kind||"source"===P.value.kind?new hs("source",F):new za("composite",F,P.value.zoomStops,P.value._interpolationType),this.paint._values[_]=new ca(P.property,E,P.parameters)}}},i.prototype._handleOverridablePaintPropertyUpdate=function(u,g,_){return!(!this.layout||g.isDataDriven()||_.isDataDriven())&&i.hasPaintOverride(this.layout,u)},i.hasPaintOverride=function(u,g){var _=u.get("text-field"),E=Hp.paint.properties[g],P=!1,A=function(q){for(var G=0,K=q;G<K.length;G+=1)if(E.overrides&&E.overrides.hasOverride(K[G]))return void(P=!0)};if("constant"===_.value.kind&&_.value.value instanceof no)A(_.value.value.sections);else if("source"===_.value.kind){var F=function(q){P||(q instanceof En&&xo(q.value)===ir?A(q.value.sections):q instanceof en?A(q.sections):q.eachChild(F))},U=_.value;U._styleExpression&&F(U._styleExpression.expression)}return P},i}(Wr),Tg={paint:new so({"background-color":new yr(_t.paint_background["background-color"]),"background-pattern":new ha(_t.paint_background["background-pattern"]),"background-opacity":new yr(_t.paint_background["background-opacity"])})},Jp=function(t){function i(u){t.call(this,u,Tg)}return t&&(i.__proto__=t),(i.prototype=Object.create(t&&t.prototype)).constructor=i,i}(Wr),Ag={paint:new so({"raster-opacity":new yr(_t.paint_raster["raster-opacity"]),"raster-hue-rotate":new yr(_t.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new yr(_t.paint_raster["raster-brightness-min"]),"raster-brightness-max":new yr(_t.paint_raster["raster-brightness-max"]),"raster-saturation":new yr(_t.paint_raster["raster-saturation"]),"raster-contrast":new yr(_t.paint_raster["raster-contrast"]),"raster-resampling":new yr(_t.paint_raster["raster-resampling"]),"raster-fade-duration":new yr(_t.paint_raster["raster-fade-duration"])})},Lg=function(t){function i(u){t.call(this,u,Ag)}return t&&(i.__proto__=t),(i.prototype=Object.create(t&&t.prototype)).constructor=i,i}(Wr),Og=function(t){function i(u){t.call(this,u,{}),this.implementation=u}return t&&(i.__proto__=t),(i.prototype=Object.create(t&&t.prototype)).constructor=i,i.prototype.is3D=function(){return"3d"===this.implementation.renderingMode},i.prototype.hasOffscreenPass=function(){return void 0!==this.implementation.prerender},i.prototype.recalculate=function(){},i.prototype.updateTransitions=function(){},i.prototype.hasTransition=function(){},i.prototype.serialize=function(){},i.prototype.onAdd=function(u){this.implementation.onAdd&&this.implementation.onAdd(u,u.painter.context.gl)},i.prototype.onRemove=function(u){this.implementation.onRemove&&this.implementation.onRemove(u,u.painter.context.gl)},i}(Wr),Dg={circle:$l,heatmap:Vf,hillshade:Xf,fill:sh,"fill-extrusion":td,line:sd,symbol:Mg,background:Jp,raster:Lg},Kp=kt.HTMLImageElement,Qp=kt.HTMLCanvasElement,xd=kt.HTMLVideoElement,$p=kt.ImageData,Kh=kt.ImageBitmap,gc=function(t,i,u,g){this.context=t,this.format=u,this.texture=t.gl.createTexture(),this.update(i,g)};gc.prototype.update=function(t,i,u){var g=t.width,_=t.height,E=!(this.size&&this.size[0]===g&&this.size[1]===_||u),P=this.context,A=P.gl;if(this.useMipmap=Boolean(i&&i.useMipmap),A.bindTexture(A.TEXTURE_2D,this.texture),P.pixelStoreUnpackFlipY.set(!1),P.pixelStoreUnpack.set(1),P.pixelStoreUnpackPremultiplyAlpha.set(this.format===A.RGBA&&(!i||!1!==i.premultiply)),E)this.size=[g,_],t instanceof Kp||t instanceof Qp||t instanceof xd||t instanceof $p||Kh&&t instanceof Kh?A.texImage2D(A.TEXTURE_2D,0,this.format,this.format,A.UNSIGNED_BYTE,t):A.texImage2D(A.TEXTURE_2D,0,this.format,g,_,0,this.format,A.UNSIGNED_BYTE,t.data);else{var F=u||{x:0,y:0},U=F.x,q=F.y;t instanceof Kp||t instanceof Qp||t instanceof xd||t instanceof $p||Kh&&t instanceof Kh?A.texSubImage2D(A.TEXTURE_2D,0,U,q,A.RGBA,A.UNSIGNED_BYTE,t):A.texSubImage2D(A.TEXTURE_2D,0,U,q,g,_,A.RGBA,A.UNSIGNED_BYTE,t.data)}this.useMipmap&&this.isSizePowerOfTwo()&&A.generateMipmap(A.TEXTURE_2D)},gc.prototype.bind=function(t,i,u){var g=this.context.gl;g.bindTexture(g.TEXTURE_2D,this.texture),u!==g.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(u=g.LINEAR),t!==this.filter&&(g.texParameteri(g.TEXTURE_2D,g.TEXTURE_MAG_FILTER,t),g.texParameteri(g.TEXTURE_2D,g.TEXTURE_MIN_FILTER,u||t),this.filter=t),i!==this.wrap&&(g.texParameteri(g.TEXTURE_2D,g.TEXTURE_WRAP_S,i),g.texParameteri(g.TEXTURE_2D,g.TEXTURE_WRAP_T,i),this.wrap=i)},gc.prototype.isSizePowerOfTwo=function(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0},gc.prototype.destroy=function(){this.context.gl.deleteTexture(this.texture),this.texture=null};var dh=function(t){var i=this;this._callback=t,this._triggered=!1,"undefined"!=typeof MessageChannel&&(this._channel=new MessageChannel,this._channel.port2.onmessage=function(){i._triggered=!1,i._callback()})};dh.prototype.trigger=function(){var t=this;this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(function(){t._triggered=!1,t._callback()},0))},dh.prototype.remove=function(){delete this._channel,this._callback=function(){}};var mc=function(t,i,u){this.target=t,this.parent=i,this.mapId=u,this.callbacks={},this.tasks={},this.taskQueue=[],this.cancelCallbacks={},bt(["receive","process"],this),this.invoker=new dh(this.process),this.target.addEventListener("message",this.receive,!1),this.globalScope=ke()?t:kt};function bd(t,i,u){var g=2*Math.PI*6378137/256/Math.pow(2,u);return[t*g-2*Math.PI*6378137/2,i*g-2*Math.PI*6378137/2]}mc.prototype.send=function(t,i,u,g,_){var E=this;void 0===_&&(_=!1);var P=Math.round(1e18*Math.random()).toString(36).substring(0,10);u&&(this.callbacks[P]=u);var A=ne(this.globalScope)?void 0:[];return this.target.postMessage({id:P,type:t,hasCallback:!!u,targetMapId:g,mustQueue:_,sourceMapId:this.mapId,data:ji(i,A)},A),{cancel:function(){u&&delete E.callbacks[P],E.target.postMessage({id:P,type:"<cancel>",targetMapId:g,sourceMapId:E.mapId})}}},mc.prototype.receive=function(t){var i=t.data,u=i.id;if(u&&(!i.targetMapId||this.mapId===i.targetMapId))if("<cancel>"===i.type){delete this.tasks[u];var g=this.cancelCallbacks[u];delete this.cancelCallbacks[u],g&&g()}else ke()||i.mustQueue?(this.tasks[u]=i,this.taskQueue.push(u),this.invoker.trigger()):this.processTask(u,i)},mc.prototype.process=function(){if(this.taskQueue.length){var t=this.taskQueue.shift(),i=this.tasks[t];delete this.tasks[t],this.taskQueue.length&&this.invoker.trigger(),i&&this.processTask(t,i)}},mc.prototype.processTask=function(t,i){var u=this;if("<response>"===i.type){var g=this.callbacks[t];delete this.callbacks[t],g&&(i.error?g(ps(i.error)):g(null,ps(i.data)))}else{var _=!1,E=ne(this.globalScope)?void 0:[],P=i.hasCallback?function(q,G){_=!0,delete u.cancelCallbacks[t],u.target.postMessage({id:t,type:"<response>",sourceMapId:u.mapId,error:q?ji(q):null,data:ji(G,E)},E)}:function(q){_=!0},A=null,F=ps(i.data);if(this.parent[i.type])A=this.parent[i.type](i.sourceMapId,F,P);else if(this.parent.getWorkerSource){var U=i.type.split(".");A=this.parent.getWorkerSource(i.sourceMapId,U[0],F.source)[U[1]](F,P)}else P(new Error("Could not find function "+i.type));!_&&A&&A.cancel&&(this.cancelCallbacks[t]=A.cancel)}},mc.prototype.remove=function(){this.invoker.remove(),this.target.removeEventListener("message",this.receive,!1)};var ra=function(t,i){t&&(i?this.setSouthWest(t).setNorthEast(i):4===t.length?this.setSouthWest([t[0],t[1]]).setNorthEast([t[2],t[3]]):this.setSouthWest(t[0]).setNorthEast(t[1]))};ra.prototype.setNorthEast=function(t){return this._ne=t instanceof Xi?new Xi(t.lng,t.lat):Xi.convert(t),this},ra.prototype.setSouthWest=function(t){return this._sw=t instanceof Xi?new Xi(t.lng,t.lat):Xi.convert(t),this},ra.prototype.extend=function(t){var i,u,g=this._sw,_=this._ne;if(t instanceof Xi)i=t,u=t;else{if(!(t instanceof ra))return Array.isArray(t)?4===t.length||t.every(Array.isArray)?this.extend(ra.convert(t)):this.extend(Xi.convert(t)):this;if(u=t._ne,!(i=t._sw)||!u)return this}return g||_?(g.lng=Math.min(i.lng,g.lng),g.lat=Math.min(i.lat,g.lat),_.lng=Math.max(u.lng,_.lng),_.lat=Math.max(u.lat,_.lat)):(this._sw=new Xi(i.lng,i.lat),this._ne=new Xi(u.lng,u.lat)),this},ra.prototype.getCenter=function(){return new Xi((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)},ra.prototype.getSouthWest=function(){return this._sw},ra.prototype.getNorthEast=function(){return this._ne},ra.prototype.getNorthWest=function(){return new Xi(this.getWest(),this.getNorth())},ra.prototype.getSouthEast=function(){return new Xi(this.getEast(),this.getSouth())},ra.prototype.getWest=function(){return this._sw.lng},ra.prototype.getSouth=function(){return this._sw.lat},ra.prototype.getEast=function(){return this._ne.lng},ra.prototype.getNorth=function(){return this._ne.lat},ra.prototype.toArray=function(){return[this._sw.toArray(),this._ne.toArray()]},ra.prototype.toString=function(){return"LngLatBounds("+this._sw.toString()+", "+this._ne.toString()+")"},ra.prototype.isEmpty=function(){return!(this._sw&&this._ne)},ra.prototype.contains=function(t){var i=Xi.convert(t),u=i.lng,g=i.lat,_=this._sw.lng<=u&&u<=this._ne.lng;return this._sw.lng>this._ne.lng&&(_=this._sw.lng>=u&&u>=this._ne.lng),this._sw.lat<=g&&g<=this._ne.lat&&_},ra.convert=function(t){return!t||t instanceof ra?t:new ra(t)};var Xi=function(t,i){if(isNaN(t)||isNaN(i))throw new Error("Invalid LngLat object: ("+t+", "+i+")");if(this.lng=+t,this.lat=+i,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")};Xi.prototype.wrap=function(){return new Xi(Ye(this.lng,-180,180),this.lat)},Xi.prototype.toArray=function(){return[this.lng,this.lat]},Xi.prototype.toString=function(){return"LngLat("+this.lng+", "+this.lat+")"},Xi.prototype.distanceTo=function(t){var i=Math.PI/180,u=this.lat*i,g=t.lat*i,_=Math.sin(u)*Math.sin(g)+Math.cos(u)*Math.cos(g)*Math.cos((t.lng-this.lng)*i);return 6371008.8*Math.acos(Math.min(_,1))},Xi.prototype.toBounds=function(t){void 0===t&&(t=0);var i=360*t/40075017,u=i/Math.cos(Math.PI/180*this.lat);return new ra(new Xi(this.lng-u,this.lat-i),new Xi(this.lng+u,this.lat+i))},Xi.convert=function(t){if(t instanceof Xi)return t;if(Array.isArray(t)&&(2===t.length||3===t.length))return new Xi(Number(t[0]),Number(t[1]));if(!Array.isArray(t)&&"object"==typeof t&&null!==t)return new Xi(Number("lng"in t?t.lng:t.lon),Number(t.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")};var Qh=2*Math.PI*6371008.8;function $h(t){return Qh*Math.cos(t*Math.PI/180)}function tf(t){return(180+t)/360}function ef(t){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+t*Math.PI/360)))/360}function gh(t,i){return t/$h(i)}function rf(t){return 360/Math.PI*Math.atan(Math.exp((180-360*t)*Math.PI/180))-90}var yc=function(t,i,u){void 0===u&&(u=0),this.x=+t,this.y=+i,this.z=+u};yc.fromLngLat=function(t,i){void 0===i&&(i=0);var u=Xi.convert(t);return new yc(tf(u.lng),ef(u.lat),gh(i,u.lat))},yc.prototype.toLngLat=function(){return new Xi(360*this.x-180,rf(this.y))},yc.prototype.toAltitude=function(){return this.z*$h(rf(this.y))},yc.prototype.meterInMercatorCoordinateUnits=function(){return 1/Qh*(t=rf(this.y),1/Math.cos(t*Math.PI/180));var t};var vc=function(t,i,u){this.z=t,this.x=i,this.y=u,this.key=Rc(0,t,t,i,u)};vc.prototype.equals=function(t){return this.z===t.z&&this.x===t.x&&this.y===t.y},vc.prototype.url=function(t,i){var u,g,_,E,P,A=(g=this.y,_=this.z,E=bd(256*(u=this.x),256*(g=Math.pow(2,_)-g-1),_),P=bd(256*(u+1),256*(g+1),_),E[0]+","+E[1]+","+P[0]+","+P[1]),F=function(U,q,G){for(var K,ot="",It=U;It>0;It--)ot+=(q&(K=1<<It-1)?1:0)+(G&K?2:0);return ot}(this.z,this.x,this.y);return t[(this.x+this.y)%t.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace("{z}",String(this.z)).replace("{x}",String(this.x)).replace("{y}",String("tms"===i?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",F).replace("{bbox-epsg-3857}",A)},vc.prototype.getTilePoint=function(t){var i=Math.pow(2,this.z);return new Ft(8192*(t.x*i-this.x),8192*(t.y*i-this.y))},vc.prototype.toString=function(){return this.z+"/"+this.x+"/"+this.y};var nf=function(t,i){this.wrap=t,this.canonical=i,this.key=Rc(t,i.z,i.z,i.x,i.y)},Uo=function(t,i,u,g,_){this.overscaledZ=t,this.wrap=i,this.canonical=new vc(u,+g,+_),this.key=Rc(i,t,u,g,_)};function Rc(t,i,u,g,_){(t*=2)<0&&(t=-1*t-1);var E=1<<u;return(E*E*t+E*_+g).toString(36)+u.toString(36)+i.toString(36)}Uo.prototype.equals=function(t){return this.overscaledZ===t.overscaledZ&&this.wrap===t.wrap&&this.canonical.equals(t.canonical)},Uo.prototype.scaledTo=function(t){var i=this.canonical.z-t;return t>this.canonical.z?new Uo(t,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Uo(t,this.wrap,t,this.canonical.x>>i,this.canonical.y>>i)},Uo.prototype.calculateScaledKey=function(t,i){var u=this.canonical.z-t;return t>this.canonical.z?Rc(this.wrap*+i,t,this.canonical.z,this.canonical.x,this.canonical.y):Rc(this.wrap*+i,t,t,this.canonical.x>>u,this.canonical.y>>u)},Uo.prototype.isChildOf=function(t){if(t.wrap!==this.wrap)return!1;var i=this.canonical.z-t.canonical.z;return 0===t.overscaledZ||t.overscaledZ<this.overscaledZ&&t.canonical.x===this.canonical.x>>i&&t.canonical.y===this.canonical.y>>i},Uo.prototype.children=function(t){if(this.overscaledZ>=t)return[new Uo(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];var i=this.canonical.z+1,u=2*this.canonical.x,g=2*this.canonical.y;return[new Uo(i,this.wrap,i,u,g),new Uo(i,this.wrap,i,u+1,g),new Uo(i,this.wrap,i,u,g+1),new Uo(i,this.wrap,i,u+1,g+1)]},Uo.prototype.isLessThan=function(t){return this.wrap<t.wrap||!(this.wrap>t.wrap)&&(this.overscaledZ<t.overscaledZ||!(this.overscaledZ>t.overscaledZ)&&(this.canonical.x<t.canonical.x||!(this.canonical.x>t.canonical.x)&&this.canonical.y<t.canonical.y))},Uo.prototype.wrapped=function(){return new Uo(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)},Uo.prototype.unwrapTo=function(t){return new Uo(this.overscaledZ,t,this.canonical.z,this.canonical.x,this.canonical.y)},Uo.prototype.overscaleFactor=function(){return Math.pow(2,this.overscaledZ-this.canonical.z)},Uo.prototype.toUnwrapped=function(){return new nf(this.wrap,this.canonical)},Uo.prototype.toString=function(){return this.overscaledZ+"/"+this.canonical.x+"/"+this.canonical.y},Uo.prototype.getTilePoint=function(t){return this.canonical.getTilePoint(new yc(t.x-this.wrap,t.y))},er("CanonicalTileID",vc),er("OverscaledTileID",Uo,{omit:["posMatrix"]});var Xu=function(t,i,u){if(this.uid=t,i.height!==i.width)throw new RangeError("DEM tiles must be square");if(u&&"mapbox"!==u&&"terrarium"!==u)return xt('"'+u+'" is not a valid encoding type. Valid types include "mapbox" and "terrarium".');this.stride=i.height;var g=this.dim=i.height-2;this.data=new Uint32Array(i.data.buffer),this.encoding=u||"mapbox";for(var _=0;_<g;_++)this.data[this._idx(-1,_)]=this.data[this._idx(0,_)],this.data[this._idx(g,_)]=this.data[this._idx(g-1,_)],this.data[this._idx(_,-1)]=this.data[this._idx(_,0)],this.data[this._idx(_,g)]=this.data[this._idx(_,g-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(g,-1)]=this.data[this._idx(g-1,0)],this.data[this._idx(-1,g)]=this.data[this._idx(0,g-1)],this.data[this._idx(g,g)]=this.data[this._idx(g-1,g-1)]};Xu.prototype.get=function(t,i){var u=new Uint8Array(this.data.buffer),g=4*this._idx(t,i);return("terrarium"===this.encoding?this._unpackTerrarium:this._unpackMapbox)(u[g],u[g+1],u[g+2])},Xu.prototype.getUnpackVector=function(){return"terrarium"===this.encoding?[256,1,1/256,32768]:[6553.6,25.6,.1,1e4]},Xu.prototype._idx=function(t,i){if(t<-1||t>=this.dim+1||i<-1||i>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(i+1)*this.stride+(t+1)},Xu.prototype._unpackMapbox=function(t,i,u){return(256*t*256+256*i+u)/10-1e4},Xu.prototype._unpackTerrarium=function(t,i,u){return 256*t+i+u/256-32768},Xu.prototype.getPixels=function(){return new ds({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))},Xu.prototype.backfillBorder=function(t,i,u){if(this.dim!==t.dim)throw new Error("dem dimension mismatch");var g=i*this.dim,_=i*this.dim+this.dim,E=u*this.dim,P=u*this.dim+this.dim;switch(i){case-1:g=_-1;break;case 1:_=g+1}switch(u){case-1:E=P-1;break;case 1:P=E+1}for(var A=-i*this.dim,F=-u*this.dim,U=E;U<P;U++)for(var q=g;q<_;q++)this.data[this._idx(q,U)]=t.data[this._idx(q+A,U+F)]},er("DEMData",Xu);var Nc=function(t){this._stringToNumber={},this._numberToString=[];for(var i=0;i<t.length;i++){var u=t[i];this._stringToNumber[u]=i,this._numberToString[i]=u}};Nc.prototype.encode=function(t){return this._stringToNumber[t]},Nc.prototype.decode=function(t){return this._numberToString[t]};var tp=function(t,i,u,g,_){this.type="Feature",this._vectorTileFeature=t,t._z=i,t._x=u,t._y=g,this.properties=t.properties,this.id=_},ep={geometry:{configurable:!0}};ep.geometry.get=function(){return void 0===this._geometry&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry},ep.geometry.set=function(t){this._geometry=t},tp.prototype.toJSON=function(){var t={geometry:this.geometry};for(var i in this)"_geometry"!==i&&"_vectorTileFeature"!==i&&(t[i]=this[i]);return t},Object.defineProperties(tp.prototype,ep);var zc=function(){this.state={},this.stateChanges={},this.deletedStates={}};zc.prototype.updateState=function(t,i,u){var g=String(i);if(this.stateChanges[t]=this.stateChanges[t]||{},this.stateChanges[t][g]=this.stateChanges[t][g]||{},qt(this.stateChanges[t][g],u),null===this.deletedStates[t])for(var _ in this.deletedStates[t]={},this.state[t])_!==g&&(this.deletedStates[t][_]=null);else if(this.deletedStates[t]&&null===this.deletedStates[t][g])for(var E in this.deletedStates[t][g]={},this.state[t][g])u[E]||(this.deletedStates[t][g][E]=null);else for(var P in u)this.deletedStates[t]&&this.deletedStates[t][g]&&null===this.deletedStates[t][g][P]&&delete this.deletedStates[t][g][P]},zc.prototype.removeFeatureState=function(t,i,u){if(null!==this.deletedStates[t]){var g=String(i);if(this.deletedStates[t]=this.deletedStates[t]||{},u&&void 0!==i)null!==this.deletedStates[t][g]&&(this.deletedStates[t][g]=this.deletedStates[t][g]||{},this.deletedStates[t][g][u]=null);else if(void 0!==i)if(this.stateChanges[t]&&this.stateChanges[t][g])for(u in this.deletedStates[t][g]={},this.stateChanges[t][g])this.deletedStates[t][g][u]=null;else this.deletedStates[t][g]=null;else this.deletedStates[t]=null}},zc.prototype.getState=function(t,i){var u=String(i),g=qt({},(this.state[t]||{})[u],(this.stateChanges[t]||{})[u]);if(null===this.deletedStates[t])return{};if(this.deletedStates[t]){var _=this.deletedStates[t][i];if(null===_)return{};for(var E in _)delete g[E]}return g},zc.prototype.initializeTileState=function(t,i){t.setFeatureState(this.state,i)},zc.prototype.coalesceChanges=function(t,i){var u={};for(var g in this.stateChanges){this.state[g]=this.state[g]||{};var _={};for(var E in this.stateChanges[g])this.state[g][E]||(this.state[g][E]={}),qt(this.state[g][E],this.stateChanges[g][E]),_[E]=this.state[g][E];u[g]=_}for(var P in this.deletedStates){this.state[P]=this.state[P]||{};var A={};if(null===this.deletedStates[P])for(var F in this.state[P])A[F]={},this.state[P][F]={};else for(var U in this.deletedStates[P]){if(null===this.deletedStates[P][U])this.state[P][U]={};else for(var q=0,G=Object.keys(this.deletedStates[P][U]);q<G.length;q+=1)delete this.state[P][U][G[q]];A[U]=this.state[P][U]}u[P]=u[P]||{},qt(u[P],A)}if(this.stateChanges={},this.deletedStates={},0!==Object.keys(u).length)for(var K in t)t[K].setFeatureState(u,i)};var Yu=function(t,i){this.tileID=t,this.x=t.canonical.x,this.y=t.canonical.y,this.z=t.canonical.z,this.grid=new _i(8192,16,0),this.grid3D=new _i(8192,16,0),this.featureIndexArray=new ut,this.promoteId=i};function rp(t,i,u,g,_){return tt(t,function(E,P){var A=i instanceof Ms?i.get(P):null;return A&&A.evaluate?A.evaluate(u,g,_):A})}function of(t){for(var i=1/0,u=1/0,g=-1/0,_=-1/0,E=0,P=t;E<P.length;E+=1){var A=P[E];i=Math.min(i,A.x),u=Math.min(u,A.y),g=Math.max(g,A.x),_=Math.max(_,A.y)}return{minX:i,minY:u,maxX:g,maxY:_}}function Rg(t,i){return i-t}Yu.prototype.insert=function(t,i,u,g,_,E){var P=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(u,g,_);for(var A=E?this.grid3D:this.grid,F=0;F<i.length;F++){for(var U=i[F],q=[1/0,1/0,-1/0,-1/0],G=0;G<U.length;G++){var K=U[G];q[0]=Math.min(q[0],K.x),q[1]=Math.min(q[1],K.y),q[2]=Math.max(q[2],K.x),q[3]=Math.max(q[3],K.y)}q[0]<8192&&q[1]<8192&&q[2]>=0&&q[3]>=0&&A.insert(P,q[0],q[1],q[2],q[3])}},Yu.prototype.loadVTLayers=function(){return this.vtLayers||(this.vtLayers=new rc.VectorTile(new uh(this.rawTileData)).layers,this.sourceLayerCoder=new Nc(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers},Yu.prototype.query=function(t,i,u,g){var _=this;this.loadVTLayers();for(var E=t.params||{},P=8192/t.tileSize/t.scale,A=Es(E.filter),F=t.queryGeometry,U=t.queryPadding*P,q=of(F),G=this.grid.query(q.minX-U,q.minY-U,q.maxX+U,q.maxY+U),K=of(t.cameraQueryGeometry),It=0,Mt=this.grid3D.query(K.minX-U,K.minY-U,K.maxX+U,K.maxY+U,function(Ce,Pe,be,ar){return function(lr,zr,xr,kr,Ir){for(var Ur=0,Hr=lr;Ur<Hr.length;Ur+=1){var Lr=Hr[Ur];if(zr<=Lr.x&&xr<=Lr.y&&kr>=Lr.x&&Ir>=Lr.y)return!0}var An=[new Ft(zr,xr),new Ft(zr,Ir),new Ft(kr,Ir),new Ft(kr,xr)];if(lr.length>2)for(var mn=0,Gn=An;mn<Gn.length;mn+=1)if(hu(lr,Gn[mn]))return!0;for(var Vr=0;Vr<lr.length-1;Vr++)if(rl(lr[Vr],lr[Vr+1],An))return!0;return!1}(t.cameraQueryGeometry,Ce-U,Pe-U,be+U,ar+U)});It<Mt.length;It+=1)G.push(Mt[It]);G.sort(Rg);for(var Zt,Xt={},ce=function(Ce){var Pe=G[Ce];if(Pe!==Zt){Zt=Pe;var be=_.featureIndexArray.get(Pe),ar=null;_.loadMatchingFeature(Xt,be.bucketIndex,be.sourceLayerIndex,be.featureIndex,A,E.layers,E.availableImages,i,u,g,function(lr,zr,xr){return ar||(ar=Qr(lr)),zr.queryIntersectsFeature(F,lr,xr,ar,_.z,t.transform,P,t.pixelPosMatrix)})}},fe=0;fe<G.length;fe++)ce(fe);return Xt},Yu.prototype.loadMatchingFeature=function(t,i,u,g,_,E,P,A,F,U,q){var G=this.bucketLayerIDs[i];if(!E||function(lr,zr){for(var xr=0;xr<lr.length;xr++)if(zr.indexOf(lr[xr])>=0)return!0;return!1}(E,G)){var K=this.sourceLayerCoder.decode(u),ot=this.vtLayers[K].feature(g);if(_.needGeometry){var It=hn(ot,!0);if(!_.filter(new ii(this.tileID.overscaledZ),It,this.tileID.canonical))return}else if(!_.filter(new ii(this.tileID.overscaledZ),ot))return;for(var Mt=this.getId(ot,K),Zt=0;Zt<G.length;Zt++){var Xt=G[Zt];if(!(E&&E.indexOf(Xt)<0)){var ce=A[Xt];if(ce){var fe={};void 0!==Mt&&U&&(fe=U.getState(ce.sourceLayer||"_geojsonTileLayer",Mt));var Ce=qt({},F[Xt]);Ce.paint=rp(Ce.paint,ce.paint,ot,fe,P),Ce.layout=rp(Ce.layout,ce.layout,ot,fe,P);var Pe=!q||q(ot,ce,fe);if(Pe){var be=new tp(ot,this.z,this.x,this.y,Mt);be.layer=Ce;var ar=t[Xt];void 0===ar&&(ar=t[Xt]=[]),ar.push({featureIndex:g,feature:be,intersectionZ:Pe})}}}}}},Yu.prototype.lookupSymbolFeatures=function(t,i,u,g,_,E,P,A){var F={};this.loadVTLayers();for(var U=Es(_),q=0,G=t;q<G.length;q+=1)this.loadMatchingFeature(F,u,g,G[q],U,E,P,A,i);return F},Yu.prototype.hasLayer=function(t){for(var i=0,u=this.bucketLayerIDs;i<u.length;i+=1)for(var g=0,_=u[i];g<_.length;g+=1)if(t===_[g])return!0;return!1},Yu.prototype.getId=function(t,i){var u=t.id;return this.promoteId&&"boolean"==typeof(u=t.properties["string"==typeof this.promoteId?this.promoteId:this.promoteId[i]])&&(u=Number(u)),u},er("FeatureIndex",Yu,{omit:["rawTileData","sourceLayerCoder"]});var wa=function(t,i){this.tileID=t,this.uid=X(),this.uses=0,this.tileSize=i,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.expiredRequestCount=0,this.state="loading"};wa.prototype.registerFadeDuration=function(t){var i=t+this.timeAdded;i<Xr.now()||this.fadeEndTime&&i<this.fadeEndTime||(this.fadeEndTime=i)},wa.prototype.wasRequested=function(){return"errored"===this.state||"loaded"===this.state||"reloading"===this.state},wa.prototype.loadVectorData=function(t,i,u){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",t){for(var g in t.featureIndex&&(this.latestFeatureIndex=t.featureIndex,t.rawTileData?(this.latestRawTileData=t.rawTileData,this.latestFeatureIndex.rawTileData=t.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=t.collisionBoxArray,this.buckets=function(U,q){var G={};if(!q)return G;for(var K=function(){var Mt=It[ot],Zt=Mt.layerIds.map(function(fe){return q.getLayer(fe)}).filter(Boolean);if(0!==Zt.length){Mt.layers=Zt,Mt.stateDependentLayerIds&&(Mt.stateDependentLayers=Mt.stateDependentLayerIds.map(function(fe){return Zt.filter(function(Ce){return Ce.id===fe})[0]}));for(var Xt=0,ce=Zt;Xt<ce.length;Xt+=1)G[ce[Xt].id]=Mt}},ot=0,It=U;ot<It.length;ot+=1)K();return G}(t.buckets,i.style),this.hasSymbolBuckets=!1,this.buckets){var _=this.buckets[g];if(_ instanceof Mi){if(this.hasSymbolBuckets=!0,!u)break;_.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(var E in this.buckets){var P=this.buckets[E];if(P instanceof Mi&&P.hasRTLText){this.hasRTLText=!0,Mn.isLoading()||Mn.isLoaded()||"deferred"!==as()||Ws();break}}for(var A in this.queryPadding=0,this.buckets){var F=this.buckets[A];this.queryPadding=Math.max(this.queryPadding,i.style.getLayer(A).queryRadius(F))}t.imageAtlas&&(this.imageAtlas=t.imageAtlas),t.glyphAtlasImage&&(this.glyphAtlasImage=t.glyphAtlasImage)}else this.collisionBoxArray=new c},wa.prototype.unloadVectorData=function(){for(var t in this.buckets)this.buckets[t].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"},wa.prototype.getBucket=function(t){return this.buckets[t.id]},wa.prototype.upload=function(t){for(var i in this.buckets){var u=this.buckets[i];u.uploadPending()&&u.upload(t)}var g=t.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new gc(t,this.imageAtlas.image,g.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new gc(t,this.glyphAtlasImage,g.ALPHA),this.glyphAtlasImage=null)},wa.prototype.prepare=function(t){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(t,this.imageAtlasTexture)},wa.prototype.queryRenderedFeatures=function(t,i,u,g,_,E,P,A,F,U){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:g,cameraQueryGeometry:_,scale:E,tileSize:this.tileSize,pixelPosMatrix:U,transform:A,params:P,queryPadding:this.queryPadding*F},t,i,u):{}},wa.prototype.querySourceFeatures=function(t,i){var u=this.latestFeatureIndex;if(u&&u.rawTileData){var g=u.loadVTLayers(),_=i?i.sourceLayer:"",E=g._geojsonTileLayer||g[_];if(E)for(var P=Es(i&&i.filter),A=this.tileID.canonical,F=A.z,U=A.x,q=A.y,G={z:F,x:U,y:q},K=0;K<E.length;K++){var ot=E.feature(K);if(P.needGeometry){var It=hn(ot,!0);if(!P.filter(new ii(this.tileID.overscaledZ),It,this.tileID.canonical))continue}else if(!P.filter(new ii(this.tileID.overscaledZ),ot))continue;var Mt=u.getId(ot,_),Zt=new tp(ot,F,U,q,Mt);Zt.tile=G,t.push(Zt)}}},wa.prototype.hasData=function(){return"loaded"===this.state||"reloading"===this.state||"expired"===this.state},wa.prototype.patternsLoaded=function(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length},wa.prototype.setExpiryData=function(t){var i=this.expirationTime;if(t.cacheControl){var u=Te(t.cacheControl);u["max-age"]&&(this.expirationTime=Date.now()+1e3*u["max-age"])}else t.expires&&(this.expirationTime=new Date(t.expires).getTime());if(this.expirationTime){var g=Date.now(),_=!1;if(this.expirationTime>g)_=!1;else if(i)if(this.expirationTime<i)_=!0;else{var E=this.expirationTime-i;E?this.expirationTime=g+Math.max(E,3e4):_=!0}else _=!0;_?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}},wa.prototype.getExpiryTimeout=function(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-(new Date).getTime(),Math.pow(2,31)-1)},wa.prototype.setFeatureState=function(t,i){if(this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData&&0!==Object.keys(t).length){var u=this.latestFeatureIndex.loadVTLayers();for(var g in this.buckets)if(i.style.hasLayer(g)){var _=this.buckets[g],E=_.layers[0].sourceLayer||"_geojsonTileLayer",P=u[E],A=t[E];if(P&&A&&0!==Object.keys(A).length){_.update(A,P,this.imageAtlas&&this.imageAtlas.patternPositions||{});var F=i&&i.style&&i.style.getLayer(g);F&&(this.queryPadding=Math.max(this.queryPadding,F.queryRadius(_)))}}}},wa.prototype.holdingForFade=function(){return void 0!==this.symbolFadeHoldUntil},wa.prototype.symbolFadeFinished=function(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<Xr.now()},wa.prototype.clearFadeHold=function(){this.symbolFadeHoldUntil=void 0},wa.prototype.setHoldDuration=function(t){this.symbolFadeHoldUntil=Xr.now()+t},wa.prototype.setDependencies=function(t,i){for(var u={},g=0,_=i;g<_.length;g+=1)u[_[g]]=!0;this.dependencies[t]=u},wa.prototype.hasDependency=function(t,i){for(var u=0,g=t;u<g.length;u+=1){var _=this.dependencies[g[u]];if(_)for(var E=0,P=i;E<P.length;E+=1)if(_[P[E]])return!0}return!1};var Nl=kt.performance,wd=function(t){this._marks={start:[t.url,"start"].join("#"),end:[t.url,"end"].join("#"),measure:t.url.toString()},Nl.mark(this._marks.start)};wd.prototype.finish=function(){Nl.mark(this._marks.end);var t=Nl.getEntriesByName(this._marks.measure);return 0===t.length&&(Nl.measure(this._marks.measure,this._marks.start,this._marks.end),t=Nl.getEntriesByName(this._marks.measure),Nl.clearMarks(this._marks.start),Nl.clearMarks(this._marks.end),Nl.clearMeasures(this._marks.measure)),t},v.Actor=mc,v.AlphaImage=Pl,v.CanonicalTileID=vc,v.CollisionBoxArray=c,v.Color=Pn,v.DEMData=Xu,v.DataConstantProperty=yr,v.DictionaryCoder=Nc,v.EXTENT=8192,v.ErrorEvent=ie,v.EvaluationParameters=ii,v.Event=Wt,v.Evented=Ht,v.FeatureIndex=Yu,v.FillBucket=Du,v.FillExtrusionBucket=xu,v.ImageAtlas=oc,v.ImagePosition=ju,v.LineBucket=gs,v.LngLat=Xi,v.LngLatBounds=ra,v.MercatorCoordinate=yc,v.ONE_EM=24,v.OverscaledTileID=Uo,v.Point=Ft,v.Point$1=Ft,v.Properties=so,v.Protobuf=uh,v.RGBAImage=ds,v.RequestManager=In,v.RequestPerformance=wd,v.ResourceType=vo,v.SegmentVector=ct,v.SourceFeatureState=zc,v.StructArrayLayout1ui2=Kn,v.StructArrayLayout2f1f2i16=W,v.StructArrayLayout2i4=Io,v.StructArrayLayout3ui6=Gt,v.StructArrayLayout4i8=bi,v.SymbolBucket=Mi,v.Texture=gc,v.Tile=wa,v.Transitionable=la,v.Uniform1f=ze,v.Uniform1i=qe,v.Uniform2f=Ve,v.Uniform3f=$e,v.Uniform4f=rr,v.UniformColor=tr,v.UniformMatrix4f=Xe,v.UnwrappedTileID=nf,v.ValidationError=Ut,v.WritingMode=Ks,v.ZoomHistory=xi,v.add=function(t,i,u){return t[0]=i[0]+u[0],t[1]=i[1]+u[1],t[2]=i[2]+u[2],t},v.addDynamicAttributes=Wp,v.asyncAll=function(t,i,u){if(!t.length)return u(null,[]);var g=t.length,_=new Array(t.length),E=null;t.forEach(function(P,A){i(P,function(F,U){F&&(E=F),_[A]=U,0==--g&&u(E,_)})})},v.bezier=ye,v.bindAll=bt,v.browser=Xr,v.cacheEntryPossiblyAdded=function(t){++Ii>vn&&(t.getActor().send("enforceCacheSizeLimit",sr),Ii=0)},v.clamp=de,v.clearTileCache=function(t){var i=kt.caches.delete("mapbox-tiles");t&&i.catch(t).then(function(){return t()})},v.clipLine=Ll,v.clone=function(t){var i=new go(16);return i[0]=t[0],i[1]=t[1],i[2]=t[2],i[3]=t[3],i[4]=t[4],i[5]=t[5],i[6]=t[6],i[7]=t[7],i[8]=t[8],i[9]=t[9],i[10]=t[10],i[11]=t[11],i[12]=t[12],i[13]=t[13],i[14]=t[14],i[15]=t[15],i},v.clone$1=j,v.clone$2=function(t){var i=new go(3);return i[0]=t[0],i[1]=t[1],i[2]=t[2],i},v.collisionCircleLayout=Fp,v.config=Er,v.create=function(){var t=new go(16);return go!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0),t[0]=1,t[5]=1,t[10]=1,t[15]=1,t},v.create$1=function(){var t=new go(9);return go!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[5]=0,t[6]=0,t[7]=0),t[0]=1,t[4]=1,t[8]=1,t},v.create$2=function(){var t=new go(4);return go!=Float32Array&&(t[1]=0,t[2]=0),t[0]=1,t[3]=1,t},v.createCommonjsModule=Bt,v.createExpression=Pa,v.createLayout=oi,v.createStyleLayer=function(t){return"custom"===t.type?new Og(t):new Dg[t.type](t)},v.cross=function(t,i,u){var g=i[0],_=i[1],E=i[2],P=u[0],A=u[1],F=u[2];return t[0]=_*F-E*A,t[1]=E*P-g*F,t[2]=g*A-_*P,t},v.deepEqual=function t(i,u){if(Array.isArray(i)){if(!Array.isArray(u)||i.length!==u.length)return!1;for(var g=0;g<i.length;g++)if(!t(i[g],u[g]))return!1;return!0}if("object"==typeof i&&null!==i&&null!==u){if("object"!=typeof u||Object.keys(i).length!==Object.keys(u).length)return!1;for(var _ in i)if(!t(i[_],u[_]))return!1;return!0}return i===u},v.dot=function(t,i){return t[0]*i[0]+t[1]*i[1]+t[2]*i[2]},v.dot$1=function(t,i){return t[0]*i[0]+t[1]*i[1]+t[2]*i[2]+t[3]*i[3]},v.ease=ue,v.emitValidationErrors=is,v.endsWith=et,v.enforceCacheSizeLimit=function(t){Bn(),Jt&&Jt.then(function(i){i.keys().then(function(u){for(var g=0;g<u.length-t;g++)i.delete(u[g])})})},v.evaluateSizeForFeature=Zp,v.evaluateSizeForZoom=Xh,v.evaluateVariableOffset=dc,v.evented=$o,v.extend=qt,v.featureFilter=Es,v.filterObject=lt,v.fromRotation=function(t,i){var u=Math.sin(i),g=Math.cos(i);return t[0]=g,t[1]=u,t[2]=0,t[3]=-u,t[4]=g,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},v.getAnchorAlignment=cc,v.getAnchorJustification=Ga,v.getArrayBuffer=di,v.getImage=it,v.getJSON=function(t,i){return Je(qt(t,{type:"json"}),i)},v.getRTLTextPluginStatus=as,v.getReferrer=lo,v.getVideo=function(t,i){var u,g,_=kt.document.createElement("video");_.muted=!0,_.onloadstart=function(){i(null,_)};for(var E=0;E<t.length;E++){var P=kt.document.createElement("source");u=t[E],g=void 0,(g=kt.document.createElement("a")).href=u,(g.protocol!==kt.document.location.protocol||g.host!==kt.document.location.host)&&(_.crossOrigin="Anonymous"),P.src=t[E],_.appendChild(P)}return{cancel:function(){}}},v.identity=Za,v.invert=function(t,i){var u=i[0],g=i[1],_=i[2],E=i[3],P=i[4],A=i[5],F=i[6],U=i[7],q=i[8],G=i[9],K=i[10],ot=i[11],It=i[12],Mt=i[13],Zt=i[14],Xt=i[15],ce=u*A-g*P,fe=u*F-_*P,Ce=u*U-E*P,Pe=g*F-_*A,be=g*U-E*A,ar=_*U-E*F,lr=q*Mt-G*It,zr=q*Zt-K*It,xr=q*Xt-ot*It,kr=G*Zt-K*Mt,Ir=G*Xt-ot*Mt,Ur=K*Xt-ot*Zt,Hr=ce*Ur-fe*Ir+Ce*kr+Pe*xr-be*zr+ar*lr;return Hr?(t[0]=(A*Ur-F*Ir+U*kr)*(Hr=1/Hr),t[1]=(_*Ir-g*Ur-E*kr)*Hr,t[2]=(Mt*ar-Zt*be+Xt*Pe)*Hr,t[3]=(K*be-G*ar-ot*Pe)*Hr,t[4]=(F*xr-P*Ur-U*zr)*Hr,t[5]=(u*Ur-_*xr+E*zr)*Hr,t[6]=(Zt*Ce-It*ar-Xt*fe)*Hr,t[7]=(q*ar-K*Ce+ot*fe)*Hr,t[8]=(P*Ir-A*xr+U*lr)*Hr,t[9]=(g*xr-u*Ir-E*lr)*Hr,t[10]=(It*be-Mt*Ce+Xt*ce)*Hr,t[11]=(G*Ce-q*be-ot*ce)*Hr,t[12]=(A*zr-P*kr-F*lr)*Hr,t[13]=(u*kr-g*zr+_*lr)*Hr,t[14]=(Mt*fe-It*Pe-Zt*ce)*Hr,t[15]=(q*Pe-G*fe+K*ce)*Hr,t):null},v.isChar=dr,v.isMapboxURL=$n,v.keysDifference=function(t,i){var u=[];for(var g in t)g in i||u.push(g);return u},v.makeRequest=Je,v.mapObject=tt,v.mercatorXfromLng=tf,v.mercatorYfromLat=ef,v.mercatorZfromAltitude=gh,v.mul=Ah,v.multiply=Cl,v.mvt=rc,v.nextPowerOfTwo=function(t){return t<=1?1:Math.pow(2,Math.ceil(Math.log(t)/Math.LN2))},v.normalize=function(t,i){var u=i[0],g=i[1],_=i[2],E=u*u+g*g+_*_;return E>0&&(E=1/Math.sqrt(E)),t[0]=i[0]*E,t[1]=i[1]*E,t[2]=i[2]*E,t},v.number=Ei,v.offscreenCanvasSupported=Gi,v.ortho=function(t,i,u,g,_,E,P){var A=1/(i-u),F=1/(g-_),U=1/(E-P);return t[0]=-2*A,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*F,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*U,t[11]=0,t[12]=(i+u)*A,t[13]=(_+g)*F,t[14]=(P+E)*U,t[15]=1,t},v.parseGlyphPBF=function(t){return new uh(t).readFields(Cg,[])},v.pbf=uh,v.performSymbolLayout=function(t,i,u,g,_,E,P){t.createArrays(),t.tilePixelRatio=8192/(512*t.overscaling),t.compareText={},t.iconsNeedLinear=!1;var A=t.layers[0].layout,F=t.layers[0]._unevaluatedLayout._values,U={};if("composite"===t.textSizeData.kind){var q=t.textSizeData,G=q.maxZoom;U.compositeTextSizes=[F["text-size"].possiblyEvaluate(new ii(q.minZoom),P),F["text-size"].possiblyEvaluate(new ii(G),P)]}if("composite"===t.iconSizeData.kind){var K=t.iconSizeData,ot=K.maxZoom;U.compositeIconSizes=[F["icon-size"].possiblyEvaluate(new ii(K.minZoom),P),F["icon-size"].possiblyEvaluate(new ii(ot),P)]}U.layoutTextSize=F["text-size"].possiblyEvaluate(new ii(t.zoom+1),P),U.layoutIconSize=F["icon-size"].possiblyEvaluate(new ii(t.zoom+1),P),U.textMaxSize=F["text-size"].possiblyEvaluate(new ii(18));for(var It=24*A.get("text-line-height"),Mt="map"===A.get("text-rotation-alignment")&&"point"!==A.get("symbol-placement"),Zt=A.get("text-keep-upright"),Xt=A.get("text-size"),ce=function(){var Pe=Ce[fe],be=A.get("text-font").evaluate(Pe,{},P).join(","),ar=Xt.evaluate(Pe,{},P),lr=U.layoutTextSize.evaluate(Pe,{},P),zr=U.layoutIconSize.evaluate(Pe,{},P),xr={horizontal:{},vertical:void 0},kr=Pe.text,Ir=[0,0];if(kr){var Ur=kr.toString(),Hr=24*A.get("text-letter-spacing").evaluate(Pe,{},P),Lr=function(kn){for(var wi=0,Si=kn;wi<Si.length;wi+=1)if(qn=Si[wi].charCodeAt(0),dr.Arabic(qn)||dr["Arabic Supplement"](qn)||dr["Arabic Extended-A"](qn)||dr["Arabic Presentation Forms-A"](qn)||dr["Arabic Presentation Forms-B"](qn))return!1;var qn;return!0}(Ur)?Hr:0,An=A.get("text-anchor").evaluate(Pe,{},P),mn=A.get("text-variable-anchor");if(!mn){var Gn=A.get("text-radial-offset").evaluate(Pe,{},P);Ir=Gn?dc(An,[24*Gn,Ts]):A.get("text-offset").evaluate(Pe,{},P).map(function(kn){return 24*kn})}var Vr=Mt?"center":A.get("text-justify").evaluate(Pe,{},P),Wn=A.get("symbol-placement"),Ri="point"===Wn?24*A.get("text-max-width").evaluate(Pe,{},P):0,uo=function(){t.allowVerticalPlacement&&Bi(Ur)&&(xr.vertical=sc(kr,i,u,_,be,Ri,It,An,"left",Lr,Ir,Ks.vertical,!0,Wn,lr,ar))};if(!Mt&&mn){for(var eo="auto"===Vr?mn.map(function(kn){return Ga(kn)}):[Vr],Ui=!1,ro=0;ro<eo.length;ro++){var qo=eo[ro];if(!xr.horizontal[qo])if(Ui)xr.horizontal[qo]=xr.horizontal[0];else{var qi=sc(kr,i,u,_,be,Ri,It,"center",qo,Lr,Ir,Ks.horizontal,!1,Wn,lr,ar);qi&&(xr.horizontal[qo]=qi,Ui=1===qi.positionedLines.length)}}uo()}else{"auto"===Vr&&(Vr=Ga(An));var Va=sc(kr,i,u,_,be,Ri,It,An,Vr,Lr,Ir,Ks.horizontal,!1,Wn,lr,ar);Va&&(xr.horizontal[Vr]=Va),uo(),Bi(Ur)&&Mt&&Zt&&(xr.vertical=sc(kr,i,u,_,be,Ri,It,An,Vr,Lr,Ir,Ks.vertical,!1,Wn,lr,ar))}}var kn,wi,qn,ms,Xa,pa=void 0,ja=!1;if(Pe.icon&&Pe.icon.name){var mo=g[Pe.icon.name];mo&&(kn=_[Pe.icon.name],wi=A.get("icon-offset").evaluate(Pe,{},P),qn=cc(A.get("icon-anchor").evaluate(Pe,{},P)),pa={image:kn,top:Xa=wi[1]-kn.displaySize[1]*qn.verticalAlign,bottom:Xa+kn.displaySize[1],left:ms=wi[0]-kn.displaySize[0]*qn.horizontalAlign,right:ms+kn.displaySize[0]},ja=mo.sdf,void 0===t.sdfIcons?t.sdfIcons=mo.sdf:t.sdfIcons!==mo.sdf&&xt("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(mo.pixelRatio!==t.pixelRatio||0!==A.get("icon-rotate").constantOr(1))&&(t.iconsNeedLinear=!0))}var Ea=Xp(xr.horizontal)||xr.vertical;t.iconsInText=!!Ea&&Ea.iconsInText,(Ea||pa)&&function(kn,wi,Si,qn,ms,Xa,Ni,Fn,Zi,sn,fa){var Ca=Xa.textMaxSize.evaluate(wi,{});void 0===Ca&&(Ca=Ni);var wu,yo=kn.layers[0].layout,As=yo.get("icon-offset").evaluate(wi,{},fa),ys=Xp(Si.horizontal),Qs=Ni/24,Ls=kn.tilePixelRatio*Qs,Us=kn.tilePixelRatio*Ca/24,Eu=kn.tilePixelRatio*Fn,zl=kn.tilePixelRatio*yo.get("symbol-spacing"),kc=yo.get("text-padding")*kn.tilePixelRatio,kl=yo.get("icon-padding")*kn.tilePixelRatio,_c=yo.get("text-max-angle")/180*Math.PI,mh="map"===yo.get("text-rotation-alignment")&&"point"!==yo.get("symbol-placement"),yh="map"===yo.get("icon-rotation-alignment")&&"point"!==yo.get("symbol-placement"),da=yo.get("symbol-placement"),Fc=zl/2,Fl=yo.get("icon-text-fit");qn&&"none"!==Fl&&(kn.allowVerticalPlacement&&Si.vertical&&(wu=qp(qn,Si.vertical,Fl,yo.get("icon-text-fit-padding"),As,Qs)),ys&&(qn=qp(qn,ys,Fl,yo.get("icon-text-fit-padding"),As,Qs)));var Bl=function(sf,qc){qc.x<0||qc.x>=8192||qc.y<0||qc.y>=8192||function(Mo,Cu,uf,jl,Zc,lf,Gc,Su,Vc,_h,xh,jc,cf,hf,ll,pf,ip,op,ff,df,Os,ap,Ed,Wu,gf){var Cd,wc,cl,hl,pl,Xc=Mo.addToLineVertexArray(Cu,uf),mf=0,Sd=0,Id=0,Pd=0,sp=-1,Xl=-1,pu={},yf=Vt(""),vf=0,Yc=0;if(void 0===Su._unevaluatedLayout.getValue("text-radial-offset")?(vf=(Cd=Su.layout.get("text-offset").evaluate(Os,{},Wu).map(function(Ih){return 24*Ih}))[0],Yc=Cd[1]):(vf=24*Su.layout.get("text-radial-offset").evaluate(Os,{},Wu),Yc=Ts),Mo.allowVerticalPlacement&&jl.vertical){var up=Su.layout.get("text-rotate").evaluate(Os,{},Wu)+90;hl=new ph(Vc,Cu,_h,xh,jc,jl.vertical,cf,hf,ll,up),Gc&&(pl=new ph(Vc,Cu,_h,xh,jc,Gc,ip,op,ll,up))}if(Zc){var Wc=Su.layout.get("icon-rotate").evaluate(Os,{}),bh="none"!==Su.layout.get("icon-text-fit"),Hc=Wh(Zc,Wc,Ed,bh),Ec=Gc?Wh(Gc,Wc,Ed,bh):void 0;cl=new ph(Vc,Cu,_h,xh,jc,Zc,ip,op,!1,Wc),mf=4*Hc.length;var Yl=Mo.iconSizeData,Jc=null;"source"===Yl.kind?(Jc=[128*Su.layout.get("icon-size").evaluate(Os,{})])[0]>32640&&xt(Mo.layerIds[0]+': Value for "icon-size" is >= 255. Reduce your "icon-size".'):"composite"===Yl.kind&&((Jc=[128*ap.compositeIconSizes[0].evaluate(Os,{},Wu),128*ap.compositeIconSizes[1].evaluate(Os,{},Wu)])[0]>32640||Jc[1]>32640)&&xt(Mo.layerIds[0]+': Value for "icon-size" is >= 255. Reduce your "icon-size".'),Mo.addSymbols(Mo.icon,Hc,Jc,df,ff,Os,!1,Cu,Xc.lineStartIndex,Xc.lineLength,-1,Wu),sp=Mo.icon.placedSymbolArray.length-1,Ec&&(Sd=4*Ec.length,Mo.addSymbols(Mo.icon,Ec,Jc,df,ff,Os,Ks.vertical,Cu,Xc.lineStartIndex,Xc.lineLength,-1,Wu),Xl=Mo.icon.placedSymbolArray.length-1)}for(var _f in jl.horizontal){var wh=jl.horizontal[_f];if(!wc){yf=Vt(wh.text);var Md=Su.layout.get("text-rotate").evaluate(Os,{},Wu);wc=new ph(Vc,Cu,_h,xh,jc,wh,cf,hf,ll,Md)}var xf=1===wh.positionedLines.length;if(Id+=jp(Mo,Cu,wh,lf,Su,ll,Os,pf,Xc,jl.vertical?Ks.horizontal:Ks.horizontalOnly,xf?Object.keys(jl.horizontal):[_f],pu,sp,ap,Wu),xf)break}jl.vertical&&(Pd+=jp(Mo,Cu,jl.vertical,lf,Su,ll,Os,pf,Xc,Ks.vertical,["vertical"],pu,Xl,ap,Wu));var lp=wc?wc.boxStartIndex:Mo.collisionBoxArray.length,Td=wc?wc.boxEndIndex:Mo.collisionBoxArray.length,Eh=hl?hl.boxStartIndex:Mo.collisionBoxArray.length,bf=hl?hl.boxEndIndex:Mo.collisionBoxArray.length,wf=cl?cl.boxStartIndex:Mo.collisionBoxArray.length,Ch=cl?cl.boxEndIndex:Mo.collisionBoxArray.length,Ef=pl?pl.boxStartIndex:Mo.collisionBoxArray.length,Cf=pl?pl.boxEndIndex:Mo.collisionBoxArray.length,Iu=-1,Sh=function(Ih,hp){return Ih&&Ih.circleDiameter?Math.max(Ih.circleDiameter,hp):hp};Iu=Sh(wc,Iu),Iu=Sh(hl,Iu),Iu=Sh(cl,Iu);var cp=(Iu=Sh(pl,Iu))>-1?1:0;cp&&(Iu*=gf/24),Mo.glyphOffsetArray.length>=Mi.MAX_GLYPHS&&xt("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),void 0!==Os.sortKey&&Mo.addToSortKeyRanges(Mo.symbolInstances.length,Os.sortKey),Mo.symbolInstances.emplaceBack(Cu.x,Cu.y,pu.right>=0?pu.right:-1,pu.center>=0?pu.center:-1,pu.left>=0?pu.left:-1,pu.vertical||-1,sp,Xl,yf,lp,Td,Eh,bf,wf,Ch,Ef,Cf,_h,Id,Pd,mf,Sd,cp,0,cf,vf,Yc,Iu)}(kn,qc,sf,Si,qn,ms,wu,kn.layers[0],kn.collisionBoxArray,wi.index,wi.sourceLayerIndex,kn.index,Ls,kc,mh,Zi,Eu,kl,yh,As,wi,Xa,sn,fa,Ni)};if("line"===da)for(var Nu=0,Ul=Ll(wi.geometry,0,0,8192,8192);Nu<Ul.length;Nu+=1)for(var ql=Ul[Nu],il=0,ol=pc(ql,zl,_c,Si.vertical||ys,qn,24,Us,kn.overscaling,8192);il<ol.length;il+=1){var Zl=ol[il];ys&&Yp(kn,ys.text,Fc,Zl)||Bl(ql,Zl)}else if("line-center"===da)for(var al=0,sl=wi.geometry;al<sl.length;al+=1){var Gl=sl[al];if(Gl.length>1){var xc=md(Gl,_c,Si.vertical||ys,qn,24,Us);xc&&Bl(Gl,xc)}}else if("Polygon"===wi.type)for(var ul=0,Bc=Mp(wi.geometry,0);ul<Bc.length;ul+=1){var Vl=Bc[ul],Oa=Bo(Vl,16);Bl(Vl[0],new hc(Oa.x,Oa.y,0))}else if("LineString"===wi.type)for(var ga=0,Da=wi.geometry;ga<Da.length;ga+=1){var vs=Da[ga];Bl(vs,new hc(vs[0].x,vs[0].y,0))}else if("Point"===wi.type)for(var Uc=0,bc=wi.geometry;Uc<bc.length;Uc+=1)for(var vh=0,af=bc[Uc];vh<af.length;vh+=1){var np=af[vh];Bl([np],new hc(np.x,np.y,0))}}(t,Pe,xr,pa,g,U,lr,zr,Ir,ja,P)},fe=0,Ce=t.features;fe<Ce.length;fe+=1)ce();E&&t.generateCollisionDebugBuffers()},v.perspective=function(t,i,u,g,_){var E,P=1/Math.tan(i/2);return t[0]=P/u,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=P,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,null!=_&&_!==1/0?(t[10]=(_+g)*(E=1/(g-_)),t[14]=2*_*g*E):(t[10]=-1,t[14]=-2*g),t},v.pick=function(t,i){for(var u={},g=0;g<i.length;g++){var _=i[g];_ in t&&(u[_]=t[_])}return u},v.plugin=Mn,v.polygonIntersectsPolygon=ba,v.postMapLoadEvent=gn,v.postTurnstileEvent=Le,v.potpack=Dc,v.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],v.register=er,v.registerForPluginStateChange=function(t){return t({pluginStatus:fo,pluginURL:Oi}),$o.on("pluginStateChange",t),t},v.renderColorRamp=Ep,v.rotate=function(t,i,u){var g=i[0],_=i[1],E=i[2],P=i[3],A=Math.sin(u),F=Math.cos(u);return t[0]=g*F+E*A,t[1]=_*F+P*A,t[2]=g*-A+E*F,t[3]=_*-A+P*F,t},v.rotateX=function(t,i,u){var g=Math.sin(u),_=Math.cos(u),E=i[4],P=i[5],A=i[6],F=i[7],U=i[8],q=i[9],G=i[10],K=i[11];return i!==t&&(t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t[12]=i[12],t[13]=i[13],t[14]=i[14],t[15]=i[15]),t[4]=E*_+U*g,t[5]=P*_+q*g,t[6]=A*_+G*g,t[7]=F*_+K*g,t[8]=U*_-E*g,t[9]=q*_-P*g,t[10]=G*_-A*g,t[11]=K*_-F*g,t},v.rotateZ=function(t,i,u){var g=Math.sin(u),_=Math.cos(u),E=i[0],P=i[1],A=i[2],F=i[3],U=i[4],q=i[5],G=i[6],K=i[7];return i!==t&&(t[8]=i[8],t[9]=i[9],t[10]=i[10],t[11]=i[11],t[12]=i[12],t[13]=i[13],t[14]=i[14],t[15]=i[15]),t[0]=E*_+U*g,t[1]=P*_+q*g,t[2]=A*_+G*g,t[3]=F*_+K*g,t[4]=U*_-E*g,t[5]=q*_-P*g,t[6]=G*_-A*g,t[7]=K*_-F*g,t},v.scale=function(t,i,u){var g=u[0],_=u[1],E=u[2];return t[0]=i[0]*g,t[1]=i[1]*g,t[2]=i[2]*g,t[3]=i[3]*g,t[4]=i[4]*_,t[5]=i[5]*_,t[6]=i[6]*_,t[7]=i[7]*_,t[8]=i[8]*E,t[9]=i[9]*E,t[10]=i[10]*E,t[11]=i[11]*E,t[12]=i[12],t[13]=i[13],t[14]=i[14],t[15]=i[15],t},v.scale$1=function(t,i,u){return t[0]=i[0]*u,t[1]=i[1]*u,t[2]=i[2]*u,t[3]=i[3]*u,t},v.scale$2=function(t,i,u){return t[0]=i[0]*u,t[1]=i[1]*u,t[2]=i[2]*u,t},v.setCacheLimits=function(t,i){sr=t,vn=i},v.setRTLTextPlugin=function(t,i,u){if(void 0===u&&(u=!1),"deferred"===fo||"loading"===fo||"loaded"===fo)throw new Error("setRTLTextPlugin cannot be called multiple times.");Oi=Xr.resolveURL(t),fo="deferred",uu=i,Lu(),u||Ws()},v.sphericalToCartesian=function(t){var i=t[0],u=t[1],g=t[2];return u+=90,u*=Math.PI/180,g*=Math.PI/180,{x:i*Math.cos(u)*Math.sin(g),y:i*Math.sin(u)*Math.sin(g),z:i*Math.cos(g)}},v.sqrLen=function(t){var i=t[0],u=t[1];return i*i+u*u},v.styleSpec=_t,v.sub=function(t,i,u){return t[0]=i[0]-u[0],t[1]=i[1]-u[1],t[2]=i[2]-u[2],t},v.symbolSize=gd,v.transformMat3=function(t,i,u){var g=i[0],_=i[1],E=i[2];return t[0]=g*u[0]+_*u[3]+E*u[6],t[1]=g*u[1]+_*u[4]+E*u[7],t[2]=g*u[2]+_*u[5]+E*u[8],t},v.transformMat4=Ql,v.translate=function(t,i,u){var g,_,E,P,A,F,U,q,G,K,ot,It,Mt=u[0],Zt=u[1],Xt=u[2];return i===t?(t[12]=i[0]*Mt+i[4]*Zt+i[8]*Xt+i[12],t[13]=i[1]*Mt+i[5]*Zt+i[9]*Xt+i[13],t[14]=i[2]*Mt+i[6]*Zt+i[10]*Xt+i[14],t[15]=i[3]*Mt+i[7]*Zt+i[11]*Xt+i[15]):(_=i[1],E=i[2],P=i[3],A=i[4],F=i[5],U=i[6],q=i[7],G=i[8],K=i[9],ot=i[10],It=i[11],t[0]=g=i[0],t[1]=_,t[2]=E,t[3]=P,t[4]=A,t[5]=F,t[6]=U,t[7]=q,t[8]=G,t[9]=K,t[10]=ot,t[11]=It,t[12]=g*Mt+A*Zt+G*Xt+i[12],t[13]=_*Mt+F*Zt+K*Xt+i[13],t[14]=E*Mt+U*Zt+ot*Xt+i[14],t[15]=P*Mt+q*Zt+It*Xt+i[15]),t},v.triggerPluginCompletionEvent=Fo,v.uniqueId=X,v.validateCustomStyleLayer=function(t){var i=[],u=t.id;return void 0===u&&i.push({message:"layers."+u+': missing required property "id"'}),void 0===t.render&&i.push({message:"layers."+u+': missing required method "render"'}),t.renderingMode&&"2d"!==t.renderingMode&&"3d"!==t.renderingMode&&i.push({message:"layers."+u+': property "renderingMode" must be either "2d" or "3d"'}),i},v.validateLight=ns,v.validateStyle=Ta,v.values=function(t){var i=[];for(var u in t)i.push(t[u]);return i},v.vectorTile=rc,v.version="1.15.2",v.warnOnce=xt,v.webpSupported=Yr,v.window=kt,v.wrap=Ye}),b(0,function(v){function Bt(V){var Y=typeof V;if("number"===Y||"boolean"===Y||"string"===Y||null==V)return JSON.stringify(V);if(Array.isArray(V)){for(var it="[",ht=0,Lt=V;ht<Lt.length;ht+=1)it+=Bt(Lt[ht])+",";return it+"]"}for(var Wt=Object.keys(V).sort(),ie="{",Ht=0;Ht<Wt.length;Ht++)ie+=JSON.stringify(Wt[Ht])+":"+Bt(V[Wt[Ht]])+",";return ie+"}"}function ft(V){for(var Y="",it=0,ht=v.refProperties;it<ht.length;it+=1)Y+="/"+Bt(V[ht[it]]);return Y}var St=function(V){this.keyCache={},V&&this.replace(V)};St.prototype.replace=function(V){this._layerConfigs={},this._layers={},this.update(V,[])},St.prototype.update=function(V,Y){for(var it=this,ht=0,Lt=V;ht<Lt.length;ht+=1){var Wt=Lt[ht];this._layerConfigs[Wt.id]=Wt;var ie=this._layers[Wt.id]=v.createStyleLayer(Wt);ie._featureFilter=v.featureFilter(ie.filter),this.keyCache[Wt.id]&&delete this.keyCache[Wt.id]}for(var Ht=0,_t=Y;Ht<_t.length;Ht+=1){var Ut=_t[Ht];delete this.keyCache[Ut],delete this._layerConfigs[Ut],delete this._layers[Ut]}this.familiesBySource={};for(var je=0,ur=function(nr,Ue){for(var ln={},Gr=0;Gr<nr.length;Gr++){var Sr=Ue&&Ue[nr[Gr].id]||ft(nr[Gr]);Ue&&(Ue[nr[Gr].id]=Sr);var un=ln[Sr];un||(un=ln[Sr]=[]),un.push(nr[Gr])}var ir=[];for(var ci in ln)ir.push(ln[ci]);return ir}(v.values(this._layerConfigs),this.keyCache);je<ur.length;je+=1){var ge=ur[je].map(function(nr){return it._layers[nr.id]}),Oe=ge[0];if("none"!==Oe.visibility){var cr=Oe.source||"",pr=this.familiesBySource[cr];pr||(pr=this.familiesBySource[cr]={});var Tr=Oe.sourceLayer||"_geojsonTileLayer",Re=pr[Tr];Re||(Re=pr[Tr]=[]),Re.push(ge)}}};var Ft=function(V){var Y={},it=[];for(var ht in V){var Lt=V[ht],Wt=Y[ht]={};for(var ie in Lt){var Ht=Lt[+ie];if(Ht&&0!==Ht.bitmap.width&&0!==Ht.bitmap.height){var _t={x:0,y:0,w:Ht.bitmap.width+2,h:Ht.bitmap.height+2};it.push(_t),Wt[ie]={rect:_t,metrics:Ht.metrics}}}}var Ut=v.potpack(it),je=new v.AlphaImage({width:Ut.w||1,height:Ut.h||1});for(var ur in V){var ge=V[ur];for(var Oe in ge){var cr=ge[+Oe];if(cr&&0!==cr.bitmap.width&&0!==cr.bitmap.height){var pr=Y[ur][Oe].rect;v.AlphaImage.copy(cr.bitmap,je,{x:0,y:0},{x:pr.x+1,y:pr.y+1},cr.bitmap)}}}this.image=je,this.positions=Y};v.register("GlyphAtlas",Ft);var le=function(V){this.tileID=new v.OverscaledTileID(V.tileID.overscaledZ,V.tileID.wrap,V.tileID.canonical.z,V.tileID.canonical.x,V.tileID.canonical.y),this.uid=V.uid,this.zoom=V.zoom,this.pixelRatio=V.pixelRatio,this.tileSize=V.tileSize,this.source=V.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=V.showCollisionBoxes,this.collectResourceTiming=!!V.collectResourceTiming,this.returnDependencies=!!V.returnDependencies,this.promoteId=V.promoteId};function kt(V,Y,it){for(var ht=new v.EvaluationParameters(Y),Lt=0,Wt=V;Lt<Wt.length;Lt+=1)Wt[Lt].recalculate(ht,it)}function Ze(V,Y){var it=v.getArrayBuffer(V.request,function(ht,Lt,Wt,ie){ht?Y(ht):Lt&&Y(null,{vectorTile:new v.vectorTile.VectorTile(new v.pbf(Lt)),rawData:Lt,cacheControl:Wt,expires:ie})});return function(){it.cancel(),Y()}}le.prototype.parse=function(V,Y,it,ht,Lt){var Wt=this;this.status="parsing",this.data=V,this.collisionBoxArray=new v.CollisionBoxArray;var ie=new v.DictionaryCoder(Object.keys(V.layers).sort()),Ht=new v.FeatureIndex(this.tileID,this.promoteId);Ht.bucketLayerIDs=[];var _t,Ut,je,ur,ge={},Oe={featureIndex:Ht,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:it},cr=Y.familiesBySource[this.source];for(var pr in cr){var Tr=V.layers[pr];if(Tr){1===Tr.version&&v.warnOnce('Vector tile source "'+this.source+'" layer "'+pr+'" does not use vector tile spec v2 and therefore may have some rendering errors.');for(var Re=ie.encode(pr),nr=[],Ue=0;Ue<Tr.length;Ue++){var ln=Tr.feature(Ue),Gr=Ht.getId(ln,pr);nr.push({feature:ln,id:Gr,index:Ue,sourceLayerIndex:Re})}for(var Sr=0,un=cr[pr];Sr<un.length;Sr+=1){var ir=un[Sr],ci=ir[0];ci.minzoom&&this.zoom<Math.floor(ci.minzoom)||ci.maxzoom&&this.zoom>=ci.maxzoom||"none"!==ci.visibility&&(kt(ir,this.zoom,it),(ge[ci.id]=ci.createBucket({index:Ht.bucketLayerIDs.length,layers:ir,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Re,sourceID:this.source})).populate(nr,Oe,this.tileID.canonical),Ht.bucketLayerIDs.push(ir.map(function(Un){return Un.id})))}}}var On=v.mapObject(Oe.glyphDependencies,function(Un){return Object.keys(Un).map(Number)});Object.keys(On).length?ht.send("getGlyphs",{uid:this.uid,stacks:On},function(Un,on){_t||(_t=Un,Ut=on,gi.call(Wt))}):Ut={};var wn=Object.keys(Oe.iconDependencies);wn.length?ht.send("getImages",{icons:wn,source:this.source,tileID:this.tileID,type:"icons"},function(Un,on){_t||(_t=Un,je=on,gi.call(Wt))}):je={};var cn=Object.keys(Oe.patternDependencies);function gi(){if(_t)return Lt(_t);if(Ut&&je&&ur){var Un=new Ft(Ut),on=new v.ImageAtlas(je,ur);for(var Zo in ge){var Pn=ge[Zo];Pn instanceof v.SymbolBucket?(kt(Pn.layers,this.zoom,it),v.performSymbolLayout(Pn,Ut,Un.positions,je,on.iconPositions,this.showCollisionBoxes,this.tileID.canonical)):Pn.hasPattern&&(Pn instanceof v.LineBucket||Pn instanceof v.FillBucket||Pn instanceof v.FillExtrusionBucket)&&(kt(Pn.layers,this.zoom,it),Pn.addFeatures(Oe,this.tileID.canonical,on.patternPositions))}this.status="done",Lt(null,{buckets:v.values(ge).filter(function(Ds){return!Ds.isEmpty()}),featureIndex:Ht,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Un.image,imageAtlas:on,glyphMap:this.returnDependencies?Ut:null,iconMap:this.returnDependencies?je:null,glyphPositions:this.returnDependencies?Un.positions:null})}}cn.length?ht.send("getImages",{icons:cn,source:this.source,tileID:this.tileID,type:"patterns"},function(Un,on){_t||(_t=Un,ur=on,gi.call(Wt))}):ur={},gi.call(this)};var ye=function(V,Y,it,ht){this.actor=V,this.layerIndex=Y,this.availableImages=it,this.loadVectorData=ht||Ze,this.loading={},this.loaded={}};ye.prototype.loadTile=function(V,Y){var it=this,ht=V.uid;this.loading||(this.loading={});var Lt=!!(V&&V.request&&V.request.collectResourceTiming)&&new v.RequestPerformance(V.request),Wt=this.loading[ht]=new le(V);Wt.abort=this.loadVectorData(V,function(ie,Ht){if(delete it.loading[ht],ie||!Ht)return Wt.status="done",it.loaded[ht]=Wt,Y(ie);var _t=Ht.rawData,Ut={};Ht.expires&&(Ut.expires=Ht.expires),Ht.cacheControl&&(Ut.cacheControl=Ht.cacheControl);var je={};if(Lt){var ur=Lt.finish();ur&&(je.resourceTiming=JSON.parse(JSON.stringify(ur)))}Wt.vectorTile=Ht.vectorTile,Wt.parse(Ht.vectorTile,it.layerIndex,it.availableImages,it.actor,function(ge,Oe){if(ge||!Oe)return Y(ge);Y(null,v.extend({rawTileData:_t.slice(0)},Oe,Ut,je))}),it.loaded=it.loaded||{},it.loaded[ht]=Wt})},ye.prototype.reloadTile=function(V,Y){var it=this,ht=this.loaded,Lt=V.uid,Wt=this;if(ht&&ht[Lt]){var ie=ht[Lt];ie.showCollisionBoxes=V.showCollisionBoxes;var Ht=function(_t,Ut){var je=ie.reloadCallback;je&&(delete ie.reloadCallback,ie.parse(ie.vectorTile,Wt.layerIndex,it.availableImages,Wt.actor,je)),Y(_t,Ut)};"parsing"===ie.status?ie.reloadCallback=Ht:"done"===ie.status&&(ie.vectorTile?ie.parse(ie.vectorTile,this.layerIndex,this.availableImages,this.actor,Ht):Ht())}},ye.prototype.abortTile=function(V,Y){var it=this.loading,ht=V.uid;it&&it[ht]&&it[ht].abort&&(it[ht].abort(),delete it[ht]),Y()},ye.prototype.removeTile=function(V,Y){var it=this.loaded,ht=V.uid;it&&it[ht]&&delete it[ht],Y()};var ue=v.window.ImageBitmap,de=function(){this.loaded={}};function Ye(V,Y){if(0!==V.length){qt(V[0],Y);for(var it=1;it<V.length;it++)qt(V[it],!Y)}}function qt(V,Y){for(var it=0,ht=0,Lt=V.length,Wt=Lt-1;ht<Lt;Wt=ht++)it+=(V[ht][0]-V[Wt][0])*(V[Wt][1]+V[ht][1]);it>=0!=!!Y&&V.reverse()}de.prototype.loadTile=function(V,Y){var it=V.uid,ht=V.encoding,Lt=V.rawImageData,Wt=ue&&Lt instanceof ue?this.getImageData(Lt):Lt,ie=new v.DEMData(it,Wt,ht);this.loaded=this.loaded||{},this.loaded[it]=ie,Y(null,ie)},de.prototype.getImageData=function(V){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(V.width,V.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d")),this.offscreenCanvas.width=V.width,this.offscreenCanvas.height=V.height,this.offscreenCanvasContext.drawImage(V,0,0,V.width,V.height);var Y=this.offscreenCanvasContext.getImageData(-1,-1,V.width+2,V.height+2);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),new v.RGBAImage({width:Y.width,height:Y.height},Y.data)},de.prototype.removeTile=function(V){var Y=this.loaded,it=V.uid;Y&&Y[it]&&delete Y[it]};var Qt=v.vectorTile.VectorTileFeature.prototype.toGeoJSON,X=function(V){this._feature=V,this.extent=v.EXTENT,this.type=V.type,this.properties=V.tags,"id"in V&&!isNaN(V.id)&&(this.id=parseInt(V.id,10))};X.prototype.loadGeometry=function(){if(1===this._feature.type){for(var V=[],Y=0,it=this._feature.geometry;Y<it.length;Y+=1){var ht=it[Y];V.push([new v.Point$1(ht[0],ht[1])])}return V}for(var Lt=[],Wt=0,ie=this._feature.geometry;Wt<ie.length;Wt+=1){for(var Ht=[],_t=0,Ut=ie[Wt];_t<Ut.length;_t+=1){var je=Ut[_t];Ht.push(new v.Point$1(je[0],je[1]))}Lt.push(Ht)}return Lt},X.prototype.toGeoJSON=function(V,Y,it){return Qt.call(this,V,Y,it)};var J=function(V){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=v.EXTENT,this.length=V.length,this._features=V};J.prototype.feature=function(V){return new X(this._features[V])};var Q=v.vectorTile.VectorTileFeature,bt=et;function et(V,Y){this.options=Y||{},this.features=V,this.length=V.length}function tt(V,Y){this.id="number"==typeof V.id?V.id:void 0,this.type=V.type,this.rawGeometry=1===V.type?[V.geometry]:V.geometry,this.properties=V.tags,this.extent=Y||4096}et.prototype.feature=function(V){return new tt(this.features[V],this.options.extent)},tt.prototype.loadGeometry=function(){var V=this.rawGeometry;this.geometry=[];for(var Y=0;Y<V.length;Y++){for(var it=V[Y],ht=[],Lt=0;Lt<it.length;Lt++)ht.push(new v.Point$1(it[Lt][0],it[Lt][1]));this.geometry.push(ht)}return this.geometry},tt.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var V=this.geometry,Y=1/0,it=-1/0,ht=1/0,Lt=-1/0,Wt=0;Wt<V.length;Wt++)for(var ie=V[Wt],Ht=0;Ht<ie.length;Ht++){var _t=ie[Ht];Y=Math.min(Y,_t.x),it=Math.max(it,_t.x),ht=Math.min(ht,_t.y),Lt=Math.max(Lt,_t.y)}return[Y,ht,it,Lt]},tt.prototype.toGeoJSON=Q.prototype.toGeoJSON;var lt=re,j=bt;function re(V){var Y=new v.pbf;return function(it,ht){for(var Lt in it.layers)ht.writeMessage(3,xt,it.layers[Lt])}(V,Y),Y.finish()}function xt(V,Y){var it;Y.writeVarintField(15,V.version||1),Y.writeStringField(1,V.name||""),Y.writeVarintField(5,V.extent||4096);var ht={keys:[],values:[],keycache:{},valuecache:{}};for(it=0;it<V.length;it++)ht.feature=V.feature(it),Y.writeMessage(2,Ot,ht);var Lt=ht.keys;for(it=0;it<Lt.length;it++)Y.writeStringField(3,Lt[it]);var Wt=ht.values;for(it=0;it<Wt.length;it++)Y.writeMessage(4,ne,Wt[it])}function Ot(V,Y){var it=V.feature;void 0!==it.id&&Y.writeVarintField(1,it.id),Y.writeMessage(2,at,V),Y.writeVarintField(3,it.type),Y.writeMessage(4,Et,it)}function at(V,Y){var it=V.feature,ht=V.keys,Lt=V.values,Wt=V.keycache,ie=V.valuecache;for(var Ht in it.properties){var _t=Wt[Ht];void 0===_t&&(ht.push(Ht),Wt[Ht]=_t=ht.length-1),Y.writeVarint(_t);var Ut=it.properties[Ht],je=typeof Ut;"string"!==je&&"boolean"!==je&&"number"!==je&&(Ut=JSON.stringify(Ut));var ur=je+":"+Ut,ge=ie[ur];void 0===ge&&(Lt.push(Ut),ie[ur]=ge=Lt.length-1),Y.writeVarint(ge)}}function ke(V,Y){return(Y<<3)+(7&V)}function Te(V){return V<<1^V>>31}function Et(V,Y){for(var it=V.loadGeometry(),ht=V.type,Lt=0,Wt=0,ie=it.length,Ht=0;Ht<ie;Ht++){var _t=it[Ht],Ut=1;1===ht&&(Ut=_t.length),Y.writeVarint(ke(1,Ut));for(var je=3===ht?_t.length-1:_t.length,ur=0;ur<je;ur++){1===ur&&1!==ht&&Y.writeVarint(ke(2,je-1));var ge=_t[ur].x-Lt,Oe=_t[ur].y-Wt;Y.writeVarint(Te(ge)),Y.writeVarint(Te(Oe)),Lt+=ge,Wt+=Oe}3===ht&&Y.writeVarint(ke(7,1))}}function ne(V,Y){var it=typeof V;"string"===it?Y.writeStringField(1,V):"boolean"===it?Y.writeBooleanField(7,V):"number"===it&&(V%1!=0?Y.writeDoubleField(3,V):V<0?Y.writeSVarintField(6,V):Y.writeVarintField(5,V))}function Pt(V,Y,it,ht){Kt(V,it,ht),Kt(Y,2*it,2*ht),Kt(Y,2*it+1,2*ht+1)}function Kt(V,Y,it){var ht=V[Y];V[Y]=V[it],V[it]=ht}function te(V,Y,it,ht){var Lt=V-it,Wt=Y-ht;return Lt*Lt+Wt*Wt}lt.fromVectorTileJs=re,lt.fromGeojsonVt=function(V,Y){Y=Y||{};var it={};for(var ht in V)it[ht]=new bt(V[ht].features,Y),it[ht].name=ht,it[ht].version=Y.version,it[ht].extent=Y.extent;return re({layers:it})},lt.GeoJSONWrapper=j;var vt=function(V){return V[0]},Se=function(V){return V[1]},Fe=function(V,Y,it,ht,Lt){void 0===Y&&(Y=vt),void 0===it&&(it=Se),void 0===ht&&(ht=64),void 0===Lt&&(Lt=Float64Array),this.nodeSize=ht,this.points=V;for(var Wt=V.length<65536?Uint16Array:Uint32Array,ie=this.ids=new Wt(V.length),Ht=this.coords=new Lt(2*V.length),_t=0;_t<V.length;_t++)ie[_t]=_t,Ht[2*_t]=Y(V[_t]),Ht[2*_t+1]=it(V[_t]);!function Ut(je,ur,ge,Oe,cr,pr){if(!(cr-Oe<=ge)){var Tr=Oe+cr>>1;(function Re(nr,Ue,ln,Gr,Sr,un){for(;Sr>Gr;){if(Sr-Gr>600){var ir=Sr-Gr+1,ci=ln-Gr+1,On=Math.log(ir),wn=.5*Math.exp(2*On/3),cn=.5*Math.sqrt(On*wn*(ir-wn)/ir)*(ci-ir/2<0?-1:1);Re(nr,Ue,ln,Math.max(Gr,Math.floor(ln-ci*wn/ir+cn)),Math.min(Sr,Math.floor(ln+(ir-ci)*wn/ir+cn)),un)}var gi=Ue[2*ln+un],Un=Gr,on=Sr;for(Pt(nr,Ue,Gr,ln),Ue[2*Sr+un]>gi&&Pt(nr,Ue,Gr,Sr);Un<on;){for(Pt(nr,Ue,Un,on),Un++,on--;Ue[2*Un+un]<gi;)Un++;for(;Ue[2*on+un]>gi;)on--}Ue[2*Gr+un]===gi?Pt(nr,Ue,Gr,on):Pt(nr,Ue,++on,Sr),on<=ln&&(Gr=on+1),ln<=on&&(Sr=on-1)}})(je,ur,Tr,Oe,cr,pr%2),Ut(je,ur,ge,Oe,Tr-1,pr+1),Ut(je,ur,ge,Tr+1,cr,pr+1)}}(ie,Ht,ht,0,ie.length-1,0)};Fe.prototype.range=function(V,Y,it,ht){return function(Lt,Wt,ie,Ht,_t,Ut,je){for(var ur,ge,Oe=[0,Lt.length-1,0],cr=[];Oe.length;){var pr=Oe.pop(),Tr=Oe.pop(),Re=Oe.pop();if(Tr-Re<=je)for(var nr=Re;nr<=Tr;nr++)ge=Wt[2*nr+1],(ur=Wt[2*nr])>=ie&&ur<=_t&&ge>=Ht&&ge<=Ut&&cr.push(Lt[nr]);else{var Ue=Math.floor((Re+Tr)/2);ge=Wt[2*Ue+1],(ur=Wt[2*Ue])>=ie&&ur<=_t&&ge>=Ht&&ge<=Ut&&cr.push(Lt[Ue]);var ln=(pr+1)%2;(0===pr?ie<=ur:Ht<=ge)&&(Oe.push(Re),Oe.push(Ue-1),Oe.push(ln)),(0===pr?_t>=ur:Ut>=ge)&&(Oe.push(Ue+1),Oe.push(Tr),Oe.push(ln))}}return cr}(this.ids,this.coords,V,Y,it,ht,this.nodeSize)},Fe.prototype.within=function(V,Y,it){return function(ht,Lt,Wt,ie,Ht,_t){for(var Ut=[0,ht.length-1,0],je=[],ur=Ht*Ht;Ut.length;){var ge=Ut.pop(),Oe=Ut.pop(),cr=Ut.pop();if(Oe-cr<=_t)for(var pr=cr;pr<=Oe;pr++)te(Lt[2*pr],Lt[2*pr+1],Wt,ie)<=ur&&je.push(ht[pr]);else{var Tr=Math.floor((cr+Oe)/2),Re=Lt[2*Tr],nr=Lt[2*Tr+1];te(Re,nr,Wt,ie)<=ur&&je.push(ht[Tr]);var Ue=(ge+1)%2;(0===ge?Wt-Ht<=Re:ie-Ht<=nr)&&(Ut.push(cr),Ut.push(Tr-1),Ut.push(Ue)),(0===ge?Wt+Ht>=Re:ie+Ht>=nr)&&(Ut.push(Tr+1),Ut.push(Oe),Ut.push(Ue))}}return je}(this.ids,this.coords,V,Y,it,this.nodeSize)};var wr={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:function(V){return V}},De=function(V){this.options=ti(Object.create(wr),V),this.trees=new Array(this.options.maxZoom+1)};function Xr(V,Y,it,ht,Lt){return{x:V,y:Y,zoom:1/0,id:it,parentId:-1,numPoints:ht,properties:Lt}}function Er(V,Y){var it=V.geometry.coordinates,ht=it[1];return{x:Mr(it[0]),y:Be(ht),zoom:1/0,index:Y,parentId:-1}}function Yr(V){return{type:"Feature",id:V.id,properties:Cr(V),geometry:{type:"Point",coordinates:[(ht=V.x,360*(ht-.5)),(Y=V.y,it=(180-360*Y)*Math.PI/180,360*Math.atan(Math.exp(it))/Math.PI-90)]}};var Y,it,ht}function Cr(V){var Y=V.numPoints,it=Y>=1e4?Math.round(Y/1e3)+"k":Y>=1e3?Math.round(Y/100)/10+"k":Y;return ti(ti({},V.properties),{cluster:!0,cluster_id:V.id,point_count:Y,point_count_abbreviated:it})}function Mr(V){return V/360+.5}function Be(V){var Y=Math.sin(V*Math.PI/180),it=.5-.25*Math.log((1+Y)/(1-Y))/Math.PI;return it<0?0:it>1?1:it}function ti(V,Y){for(var it in Y)V[it]=Y[it];return V}function In(V){return V.x}function $n(V){return V.y}function li(V,Y,it,ht,Lt,Wt){var ie=Lt-it,Ht=Wt-ht;if(0!==ie||0!==Ht){var _t=((V-it)*ie+(Y-ht)*Ht)/(ie*ie+Ht*Ht);_t>1?(it=Lt,ht=Wt):_t>0&&(it+=ie*_t,ht+=Ht*_t)}return(ie=V-it)*ie+(Ht=Y-ht)*Ht}function fi(V,Y,it,ht){var Lt={id:void 0===V?null:V,type:Y,geometry:it,tags:ht,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(Wt){var ie=Wt.geometry,Ht=Wt.type;if("Point"===Ht||"MultiPoint"===Ht||"LineString"===Ht)ae(Wt,ie);else if("Polygon"===Ht||"MultiLineString"===Ht)for(var _t=0;_t<ie.length;_t++)ae(Wt,ie[_t]);else if("MultiPolygon"===Ht)for(_t=0;_t<ie.length;_t++)for(var Ut=0;Ut<ie[_t].length;Ut++)ae(Wt,ie[_t][Ut])}(Lt),Lt}function ae(V,Y){for(var it=0;it<Y.length;it+=3)V.minX=Math.min(V.minX,Y[it]),V.minY=Math.min(V.minY,Y[it+1]),V.maxX=Math.max(V.maxX,Y[it]),V.maxY=Math.max(V.maxY,Y[it+1])}function st(V,Y,it,ht){if(Y.geometry){var Lt=Y.geometry.coordinates,Wt=Y.geometry.type,ie=Math.pow(it.tolerance/((1<<it.maxZoom)*it.extent),2),Ht=[],_t=Y.id;if(it.promoteId?_t=Y.properties[it.promoteId]:it.generateId&&(_t=ht||0),"Point"===Wt)rt(Lt,Ht);else if("MultiPoint"===Wt)for(var Ut=0;Ut<Lt.length;Ut++)rt(Lt[Ut],Ht);else if("LineString"===Wt)$(Lt,Ht,ie,!1);else if("MultiLineString"===Wt){if(it.lineMetrics){for(Ut=0;Ut<Lt.length;Ut++)$(Lt[Ut],Ht=[],ie,!1),V.push(fi(_t,"LineString",Ht,Y.properties));return}Tt(Lt,Ht,ie,!1)}else if("Polygon"===Wt)Tt(Lt,Ht,ie,!0);else{if("MultiPolygon"!==Wt){if("GeometryCollection"===Wt){for(Ut=0;Ut<Y.geometry.geometries.length;Ut++)st(V,{id:_t,geometry:Y.geometry.geometries[Ut],properties:Y.properties},it,ht);return}throw new Error("Input data is not a valid GeoJSON object.")}for(Ut=0;Ut<Lt.length;Ut++){var je=[];Tt(Lt[Ut],je,ie,!0),Ht.push(je)}}V.push(fi(_t,Wt,Ht,Y.properties))}}function rt(V,Y){Y.push(Jt(V[0])),Y.push(Ee(V[1])),Y.push(0)}function $(V,Y,it,ht){for(var Lt,Wt,ie=0,Ht=0;Ht<V.length;Ht++){var _t=Jt(V[Ht][0]),Ut=Ee(V[Ht][1]);Y.push(_t),Y.push(Ut),Y.push(0),Ht>0&&(ie+=ht?(Lt*Ut-_t*Wt)/2:Math.sqrt(Math.pow(_t-Lt,2)+Math.pow(Ut-Wt,2))),Lt=_t,Wt=Ut}var je=Y.length-3;Y[2]=1,function ur(ge,Oe,cr,pr){for(var Tr,Re=pr,nr=cr-Oe>>1,Ue=cr-Oe,ln=ge[Oe],Gr=ge[Oe+1],Sr=ge[cr],un=ge[cr+1],ir=Oe+3;ir<cr;ir+=3){var ci=li(ge[ir],ge[ir+1],ln,Gr,Sr,un);if(ci>Re)Tr=ir,Re=ci;else if(ci===Re){var On=Math.abs(ir-nr);On<Ue&&(Tr=ir,Ue=On)}}Re>pr&&(Tr-Oe>3&&ur(ge,Oe,Tr,pr),ge[Tr+2]=Re,cr-Tr>3&&ur(ge,Tr,cr,pr))}(Y,0,je,it),Y[je+2]=1,Y.size=Math.abs(ie),Y.start=0,Y.end=Y.size}function Tt(V,Y,it,ht){for(var Lt=0;Lt<V.length;Lt++){var Wt=[];$(V[Lt],Wt,it,ht),Y.push(Wt)}}function Jt(V){return V/360+.5}function Ee(V){var Y=Math.sin(V*Math.PI/180),it=.5-.25*Math.log((1+Y)/(1-Y))/Math.PI;return it<0?0:it>1?1:it}function Ge(V,Y,it,ht,Lt,Wt,ie,Ht){if(ht/=Y,Wt>=(it/=Y)&&ie<ht)return V;if(ie<it||Wt>=ht)return null;for(var _t=[],Ut=0;Ut<V.length;Ut++){var je=V[Ut],ur=je.geometry,ge=je.type,Oe=0===Lt?je.minX:je.minY,cr=0===Lt?je.maxX:je.maxY;if(Oe>=it&&cr<ht)_t.push(je);else if(!(cr<it||Oe>=ht)){var pr=[];if("Point"===ge||"MultiPoint"===ge)We(ur,pr,it,ht,Lt);else if("LineString"===ge)Le(ur,pr,it,ht,Lt,!1,Ht.lineMetrics);else if("MultiLineString"===ge)gn(ur,pr,it,ht,Lt,!1);else if("Polygon"===ge)gn(ur,pr,it,ht,Lt,!0);else if("MultiPolygon"===ge)for(var Tr=0;Tr<ur.length;Tr++){var Re=[];gn(ur[Tr],Re,it,ht,Lt,!0),Re.length&&pr.push(Re)}if(pr.length){if(Ht.lineMetrics&&"LineString"===ge){for(Tr=0;Tr<pr.length;Tr++)_t.push(fi(je.id,ge,pr[Tr],je.tags));continue}"LineString"!==ge&&"MultiLineString"!==ge||(1===pr.length?(ge="LineString",pr=pr[0]):ge="MultiLineString"),"Point"!==ge&&"MultiPoint"!==ge||(ge=3===pr.length?"Point":"MultiPoint"),_t.push(fi(je.id,ge,pr,je.tags))}}}return _t.length?_t:null}function We(V,Y,it,ht,Lt){for(var Wt=0;Wt<V.length;Wt+=3){var ie=V[Wt+Lt];ie>=it&&ie<=ht&&(Y.push(V[Wt]),Y.push(V[Wt+1]),Y.push(V[Wt+2]))}}function Le(V,Y,it,ht,Lt,Wt,ie){for(var Ht,_t,Ut=tn(V),je=0===Lt?vn:Bn,ur=V.start,ge=0;ge<V.length-3;ge+=3){var Oe=V[ge],cr=V[ge+1],pr=V[ge+2],Tr=V[ge+3],Re=V[ge+4],nr=0===Lt?Oe:cr,Ue=0===Lt?Tr:Re,ln=!1;ie&&(Ht=Math.sqrt(Math.pow(Oe-Tr,2)+Math.pow(cr-Re,2))),nr<it?Ue>it&&(_t=je(Ut,Oe,cr,Tr,Re,it),ie&&(Ut.start=ur+Ht*_t)):nr>ht?Ue<ht&&(_t=je(Ut,Oe,cr,Tr,Re,ht),ie&&(Ut.start=ur+Ht*_t)):sr(Ut,Oe,cr,pr),Ue<it&&nr>=it&&(_t=je(Ut,Oe,cr,Tr,Re,it),ln=!0),Ue>ht&&nr<=ht&&(_t=je(Ut,Oe,cr,Tr,Re,ht),ln=!0),!Wt&&ln&&(ie&&(Ut.end=ur+Ht*_t),Y.push(Ut),Ut=tn(V)),ie&&(ur+=Ht)}var Gr=V.length-3;Oe=V[Gr],cr=V[Gr+1],pr=V[Gr+2],(nr=0===Lt?Oe:cr)>=it&&nr<=ht&&sr(Ut,Oe,cr,pr),Gr=Ut.length-3,Wt&&Gr>=3&&(Ut[Gr]!==Ut[0]||Ut[Gr+1]!==Ut[1])&&sr(Ut,Ut[0],Ut[1],Ut[2]),Ut.length&&Y.push(Ut)}function tn(V){var Y=[];return Y.size=V.size,Y.start=V.start,Y.end=V.end,Y}function gn(V,Y,it,ht,Lt,Wt){for(var ie=0;ie<V.length;ie++)Le(V[ie],Y,it,ht,Lt,Wt,!1)}function sr(V,Y,it,ht){V.push(Y),V.push(it),V.push(ht)}function vn(V,Y,it,ht,Lt,Wt){var ie=(Wt-Y)/(ht-Y);return V.push(Wt),V.push(it+(Lt-it)*ie),V.push(1),ie}function Bn(V,Y,it,ht,Lt,Wt){var ie=(Wt-it)/(Lt-it);return V.push(Y+(ht-Y)*ie),V.push(Wt),V.push(1),ie}function Dn(V,Y){for(var it=[],ht=0;ht<V.length;ht++){var Lt,Wt=V[ht],ie=Wt.type;if("Point"===ie||"MultiPoint"===ie||"LineString"===ie)Lt=Rn(Wt.geometry,Y);else if("MultiLineString"===ie||"Polygon"===ie){Lt=[];for(var Ht=0;Ht<Wt.geometry.length;Ht++)Lt.push(Rn(Wt.geometry[Ht],Y))}else if("MultiPolygon"===ie)for(Lt=[],Ht=0;Ht<Wt.geometry.length;Ht++){for(var _t=[],Ut=0;Ut<Wt.geometry[Ht].length;Ut++)_t.push(Rn(Wt.geometry[Ht][Ut],Y));Lt.push(_t)}it.push(fi(Wt.id,ie,Lt,Wt.tags))}return it}function Rn(V,Y){var it=[];it.size=V.size,void 0!==V.start&&(it.start=V.start,it.end=V.end);for(var ht=0;ht<V.length;ht+=3)it.push(V[ht]+Y,V[ht+1],V[ht+2]);return it}function Ii(V,Y){if(V.transformed)return V;var it,ht,Lt,Wt=1<<V.z,ie=V.x,Ht=V.y;for(it=0;it<V.features.length;it++){var _t=V.features[it],Ut=_t.geometry,je=_t.type;if(_t.geometry=[],1===je)for(ht=0;ht<Ut.length;ht+=2)_t.geometry.push(Gi(Ut[ht],Ut[ht+1],Y,Wt,ie,Ht));else for(ht=0;ht<Ut.length;ht++){var ur=[];for(Lt=0;Lt<Ut[ht].length;Lt+=2)ur.push(Gi(Ut[ht][Lt],Ut[ht][Lt+1],Y,Wt,ie,Ht));_t.geometry.push(ur)}}return V.transformed=!0,V}function Gi(V,Y,it,ht,Lt,Wt){return[Math.round(it*(V*ht-Lt)),Math.round(it*(Y*ht-Wt))]}function vo(V,Y,it,ht,Lt){for(var Wt=Y===Lt.maxZoom?0:Lt.tolerance/((1<<Y)*Lt.extent),ie={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:it,y:ht,z:Y,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},Ht=0;Ht<V.length;Ht++){ie.numFeatures++,Yi(ie,V[Ht],Wt,Lt);var _t=V[Ht].minX,Ut=V[Ht].minY,je=V[Ht].maxX,ur=V[Ht].maxY;_t<ie.minX&&(ie.minX=_t),Ut<ie.minY&&(ie.minY=Ut),je>ie.maxX&&(ie.maxX=je),ur>ie.maxY&&(ie.maxY=ur)}return ie}function Yi(V,Y,it,ht){var Lt=Y.geometry,Wt=Y.type,ie=[];if("Point"===Wt||"MultiPoint"===Wt)for(var Ht=0;Ht<Lt.length;Ht+=3)ie.push(Lt[Ht]),ie.push(Lt[Ht+1]),V.numPoints++,V.numSimplified++;else if("LineString"===Wt)lo(ie,Lt,V,it,!1,!1);else if("MultiLineString"===Wt||"Polygon"===Wt)for(Ht=0;Ht<Lt.length;Ht++)lo(ie,Lt[Ht],V,it,"Polygon"===Wt,0===Ht);else if("MultiPolygon"===Wt)for(var _t=0;_t<Lt.length;_t++){var Ut=Lt[_t];for(Ht=0;Ht<Ut.length;Ht++)lo(ie,Ut[Ht],V,it,!0,0===Ht)}if(ie.length){var je=Y.tags||null;if("LineString"===Wt&&ht.lineMetrics){for(var ur in je={},Y.tags)je[ur]=Y.tags[ur];je.mapbox_clip_start=Lt.start/Lt.size,je.mapbox_clip_end=Lt.end/Lt.size}var ge={geometry:ie,type:"Polygon"===Wt||"MultiPolygon"===Wt?3:"LineString"===Wt||"MultiLineString"===Wt?2:1,tags:je};null!==Y.id&&(ge.id=Y.id),V.features.push(ge)}}function lo(V,Y,it,ht,Lt,Wt){var ie=ht*ht;if(ht>0&&Y.size<(Lt?ie:ht))it.numPoints+=Y.length/3;else{for(var Ht=[],_t=0;_t<Y.length;_t+=3)(0===ht||Y[_t+2]>ie)&&(it.numSimplified++,Ht.push(Y[_t]),Ht.push(Y[_t+1])),it.numPoints++;Lt&&function(Ut,je){for(var ur=0,ge=0,Oe=Ut.length,cr=Oe-2;ge<Oe;cr=ge,ge+=2)ur+=(Ut[ge]-Ut[cr])*(Ut[ge+1]+Ut[cr+1]);if(ur>0===je)for(ge=0,Oe=Ut.length;ge<Oe/2;ge+=2){var pr=Ut[ge],Tr=Ut[ge+1];Ut[ge]=Ut[Oe-2-ge],Ut[ge+1]=Ut[Oe-1-ge],Ut[Oe-2-ge]=pr,Ut[Oe-1-ge]=Tr}}(Ht,Wt),V.push(Ht)}}function ei(V,Y){var it=(Y=this.options=function(Lt,Wt){for(var ie in Wt)Lt[ie]=Wt[ie];return Lt}(Object.create(this.options),Y)).debug;if(it&&console.time("preprocess data"),Y.maxZoom<0||Y.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(Y.promoteId&&Y.generateId)throw new Error("promoteId and generateId cannot be used together.");var Lt,Wt,ie,Ht,_t,Ut,ht=function(Lt,Wt){var ie=[];if("FeatureCollection"===Lt.type)for(var Ht=0;Ht<Lt.features.length;Ht++)st(ie,Lt.features[Ht],Wt,Ht);else st(ie,"Feature"===Lt.type?Lt:{geometry:Lt},Wt);return ie}(V,Y);this.tiles={},this.tileCoords=[],it&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",Y.indexMaxZoom,Y.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),(Lt=ht,Wt=Y,ie=Wt.buffer/Wt.extent,Ht=Lt,_t=Ge(Lt,1,-1-ie,ie,0,-1,2,Wt),Ut=Ge(Lt,1,1-ie,2+ie,0,-1,2,Wt),(_t||Ut)&&(Ht=Ge(Lt,1,-ie,1+ie,0,-1,2,Wt)||[],_t&&(Ht=Dn(_t,1).concat(Ht)),Ut&&(Ht=Ht.concat(Dn(Ut,-1)))),ht=Ht).length&&this.splitTile(ht,0,0,0),it&&(ht.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function _o(V,Y,it){return 32*((1<<V)*it+Y)+V}function ki(V,Y){var it=V.tileID.canonical;if(!this._geoJSONIndex)return Y(null,null);var ht=this._geoJSONIndex.getTile(it.z,it.x,it.y);if(!ht)return Y(null,null);var Lt=new J(ht.features),Wt=lt(Lt);0===Wt.byteOffset&&Wt.byteLength===Wt.buffer.byteLength||(Wt=new Uint8Array(Wt)),Y(null,{vectorTile:Lt,rawData:Wt.buffer})}De.prototype.load=function(V){var Y=this.options,it=Y.log,ht=Y.minZoom,Lt=Y.maxZoom,Wt=Y.nodeSize;it&&console.time("total time");var ie="prepare "+V.length+" points";it&&console.time(ie),this.points=V;for(var Ht=[],_t=0;_t<V.length;_t++)V[_t].geometry&&Ht.push(Er(V[_t],_t));this.trees[Lt+1]=new Fe(Ht,In,$n,Wt,Float32Array),it&&console.timeEnd(ie);for(var Ut=Lt;Ut>=ht;Ut--){var je=+Date.now();Ht=this._cluster(Ht,Ut),this.trees[Ut]=new Fe(Ht,In,$n,Wt,Float32Array),it&&console.log("z%d: %d clusters in %dms",Ut,Ht.length,+Date.now()-je)}return it&&console.timeEnd("total time"),this},De.prototype.getClusters=function(V,Y){var it=((V[0]+180)%360+360)%360-180,ht=Math.max(-90,Math.min(90,V[1])),Lt=180===V[2]?180:((V[2]+180)%360+360)%360-180,Wt=Math.max(-90,Math.min(90,V[3]));if(V[2]-V[0]>=360)it=-180,Lt=180;else if(it>Lt){var ie=this.getClusters([it,ht,180,Wt],Y),Ht=this.getClusters([-180,ht,Lt,Wt],Y);return ie.concat(Ht)}for(var _t=this.trees[this._limitZoom(Y)],Ut=[],je=0,ur=_t.range(Mr(it),Be(Wt),Mr(Lt),Be(ht));je<ur.length;je+=1){var ge=_t.points[ur[je]];Ut.push(ge.numPoints?Yr(ge):this.points[ge.index])}return Ut},De.prototype.getChildren=function(V){var Y=this._getOriginId(V),it=this._getOriginZoom(V),ht="No cluster with the specified id.",Lt=this.trees[it];if(!Lt)throw new Error(ht);var Wt=Lt.points[Y];if(!Wt)throw new Error(ht);for(var ie=this.options.radius/(this.options.extent*Math.pow(2,it-1)),Ht=[],_t=0,Ut=Lt.within(Wt.x,Wt.y,ie);_t<Ut.length;_t+=1){var je=Lt.points[Ut[_t]];je.parentId===V&&Ht.push(je.numPoints?Yr(je):this.points[je.index])}if(0===Ht.length)throw new Error(ht);return Ht},De.prototype.getLeaves=function(V,Y,it){var ht=[];return this._appendLeaves(ht,V,Y=Y||10,it=it||0,0),ht},De.prototype.getTile=function(V,Y,it){var ht=this.trees[this._limitZoom(V)],Lt=Math.pow(2,V),Wt=this.options,ie=Wt.radius/Wt.extent,Ht=(it-ie)/Lt,_t=(it+1+ie)/Lt,Ut={features:[]};return this._addTileFeatures(ht.range((Y-ie)/Lt,Ht,(Y+1+ie)/Lt,_t),ht.points,Y,it,Lt,Ut),0===Y&&this._addTileFeatures(ht.range(1-ie/Lt,Ht,1,_t),ht.points,Lt,it,Lt,Ut),Y===Lt-1&&this._addTileFeatures(ht.range(0,Ht,ie/Lt,_t),ht.points,-1,it,Lt,Ut),Ut.features.length?Ut:null},De.prototype.getClusterExpansionZoom=function(V){for(var Y=this._getOriginZoom(V)-1;Y<=this.options.maxZoom;){var it=this.getChildren(V);if(Y++,1!==it.length)break;V=it[0].properties.cluster_id}return Y},De.prototype._appendLeaves=function(V,Y,it,ht,Lt){for(var Wt=0,ie=this.getChildren(Y);Wt<ie.length;Wt+=1){var Ht=ie[Wt],_t=Ht.properties;if(_t&&_t.cluster?Lt+_t.point_count<=ht?Lt+=_t.point_count:Lt=this._appendLeaves(V,_t.cluster_id,it,ht,Lt):Lt<ht?Lt++:V.push(Ht),V.length===it)break}return Lt},De.prototype._addTileFeatures=function(V,Y,it,ht,Lt,Wt){for(var ie=0,Ht=V;ie<Ht.length;ie+=1){var _t=Y[Ht[ie]],Ut=_t.numPoints,je={type:1,geometry:[[Math.round(this.options.extent*(_t.x*Lt-it)),Math.round(this.options.extent*(_t.y*Lt-ht))]],tags:Ut?Cr(_t):this.points[_t.index].properties},ur=void 0;Ut?ur=_t.id:this.options.generateId?ur=_t.index:this.points[_t.index].id&&(ur=this.points[_t.index].id),void 0!==ur&&(je.id=ur),Wt.features.push(je)}},De.prototype._limitZoom=function(V){return Math.max(this.options.minZoom,Math.min(+V,this.options.maxZoom+1))},De.prototype._cluster=function(V,Y){for(var it=[],ht=this.options,Lt=ht.reduce,Wt=ht.minPoints,ie=ht.radius/(ht.extent*Math.pow(2,Y)),Ht=0;Ht<V.length;Ht++){var _t=V[Ht];if(!(_t.zoom<=Y)){_t.zoom=Y;for(var Ut=this.trees[Y+1],je=Ut.within(_t.x,_t.y,ie),ur=_t.numPoints||1,ge=ur,Oe=0,cr=je;Oe<cr.length;Oe+=1){var pr=Ut.points[cr[Oe]];pr.zoom>Y&&(ge+=pr.numPoints||1)}if(ge>=Wt){for(var Tr=_t.x*ur,Re=_t.y*ur,nr=Lt&&ur>1?this._map(_t,!0):null,Ue=(Ht<<5)+(Y+1)+this.points.length,ln=0,Gr=je;ln<Gr.length;ln+=1){var Sr=Ut.points[Gr[ln]];if(!(Sr.zoom<=Y)){Sr.zoom=Y;var un=Sr.numPoints||1;Tr+=Sr.x*un,Re+=Sr.y*un,Sr.parentId=Ue,Lt&&(nr||(nr=this._map(_t,!0)),Lt(nr,this._map(Sr)))}}_t.parentId=Ue,it.push(Xr(Tr/ge,Re/ge,Ue,ge,nr))}else if(it.push(_t),ge>1)for(var ir=0,ci=je;ir<ci.length;ir+=1){var On=Ut.points[ci[ir]];On.zoom<=Y||(On.zoom=Y,it.push(On))}}}return it},De.prototype._getOriginId=function(V){return V-this.points.length>>5},De.prototype._getOriginZoom=function(V){return(V-this.points.length)%32},De.prototype._map=function(V,Y){if(V.numPoints)return Y?ti({},V.properties):V.properties;var it=this.points[V.index].properties,ht=this.options.map(it);return Y&&ht===it?ti({},ht):ht},ei.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},ei.prototype.splitTile=function(V,Y,it,ht,Lt,Wt,ie){for(var Ht=[V,Y,it,ht],_t=this.options,Ut=_t.debug;Ht.length;){ht=Ht.pop(),it=Ht.pop(),Y=Ht.pop(),V=Ht.pop();var je=1<<Y,ur=_o(Y,it,ht),ge=this.tiles[ur];if(!ge&&(Ut>1&&console.time("creation"),ge=this.tiles[ur]=vo(V,Y,it,ht,_t),this.tileCoords.push({z:Y,x:it,y:ht}),Ut)){Ut>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",Y,it,ht,ge.numFeatures,ge.numPoints,ge.numSimplified),console.timeEnd("creation"));var Oe="z"+Y;this.stats[Oe]=(this.stats[Oe]||0)+1,this.total++}if(ge.source=V,Lt){if(Y===_t.maxZoom||Y===Lt)continue;var cr=1<<Lt-Y;if(it!==Math.floor(Wt/cr)||ht!==Math.floor(ie/cr))continue}else if(Y===_t.indexMaxZoom||ge.numPoints<=_t.indexMaxPoints)continue;if(ge.source=null,0!==V.length){Ut>1&&console.time("clipping");var pr,Tr,Re,nr,Ue,ln,Gr=.5*_t.buffer/_t.extent,Sr=.5-Gr,un=.5+Gr,ir=1+Gr;pr=Tr=Re=nr=null,Ue=Ge(V,je,it-Gr,it+un,0,ge.minX,ge.maxX,_t),ln=Ge(V,je,it+Sr,it+ir,0,ge.minX,ge.maxX,_t),V=null,Ue&&(pr=Ge(Ue,je,ht-Gr,ht+un,1,ge.minY,ge.maxY,_t),Tr=Ge(Ue,je,ht+Sr,ht+ir,1,ge.minY,ge.maxY,_t),Ue=null),ln&&(Re=Ge(ln,je,ht-Gr,ht+un,1,ge.minY,ge.maxY,_t),nr=Ge(ln,je,ht+Sr,ht+ir,1,ge.minY,ge.maxY,_t),ln=null),Ut>1&&console.timeEnd("clipping"),Ht.push(pr||[],Y+1,2*it,2*ht),Ht.push(Tr||[],Y+1,2*it,2*ht+1),Ht.push(Re||[],Y+1,2*it+1,2*ht),Ht.push(nr||[],Y+1,2*it+1,2*ht+1)}}},ei.prototype.getTile=function(V,Y,it){var ht=this.options,Lt=ht.extent,Wt=ht.debug;if(V<0||V>24)return null;var ie=1<<V,Ht=_o(V,Y=(Y%ie+ie)%ie,it);if(this.tiles[Ht])return Ii(this.tiles[Ht],Lt);Wt>1&&console.log("drilling down to z%d-%d-%d",V,Y,it);for(var _t,Ut=V,je=Y,ur=it;!_t&&Ut>0;)Ut--,je=Math.floor(je/2),ur=Math.floor(ur/2),_t=this.tiles[_o(Ut,je,ur)];return _t&&_t.source?(Wt>1&&console.log("found parent tile z%d-%d-%d",Ut,je,ur),Wt>1&&console.time("drilling down"),this.splitTile(_t.source,Ut,je,ur,V,Y,it),Wt>1&&console.timeEnd("drilling down"),this.tiles[Ht]?Ii(this.tiles[Ht],Lt):null):null};var Je=function(V){function Y(it,ht,Lt,Wt){V.call(this,it,ht,Lt,ki),Wt&&(this.loadGeoJSON=Wt)}return V&&(Y.__proto__=V),(Y.prototype=Object.create(V&&V.prototype)).constructor=Y,Y.prototype.loadData=function(it,ht){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),this._pendingCallback=ht,this._pendingLoadDataParams=it,this._state&&"Idle"!==this._state?this._state="NeedsLoadData":(this._state="Coalescing",this._loadData())},Y.prototype._loadData=function(){var it=this;if(this._pendingCallback&&this._pendingLoadDataParams){var ht=this._pendingCallback,Lt=this._pendingLoadDataParams;delete this._pendingCallback,delete this._pendingLoadDataParams;var Wt=!!(Lt&&Lt.request&&Lt.request.collectResourceTiming)&&new v.RequestPerformance(Lt.request);this.loadGeoJSON(Lt,function(ie,Ht){if(ie||!Ht)return ht(ie);if("object"!=typeof Ht)return ht(new Error("Input data given to '"+Lt.source+"' is not a valid GeoJSON object."));!function ge(Oe,cr){var pr,Tr=Oe&&Oe.type;if("FeatureCollection"===Tr)for(pr=0;pr<Oe.features.length;pr++)ge(Oe.features[pr],cr);else if("GeometryCollection"===Tr)for(pr=0;pr<Oe.geometries.length;pr++)ge(Oe.geometries[pr],cr);else if("Feature"===Tr)ge(Oe.geometry,cr);else if("Polygon"===Tr)Ye(Oe.coordinates,cr);else if("MultiPolygon"===Tr)for(pr=0;pr<Oe.coordinates.length;pr++)Ye(Oe.coordinates[pr],cr);return Oe}(Ht,!0);try{if(Lt.filter){var _t=v.createExpression(Lt.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if("error"===_t.result)throw new Error(_t.value.map(function(ge){return ge.key+": "+ge.message}).join(", "));var Ut=Ht.features.filter(function(ge){return _t.value.evaluate({zoom:0},ge)});Ht={type:"FeatureCollection",features:Ut}}it._geoJSONIndex=Lt.cluster?new De(function(ge){var Oe=ge.superclusterOptions,cr=ge.clusterProperties;if(!cr||!Oe)return Oe;for(var pr={},Tr={},Re={accumulated:null,zoom:0},nr={properties:null},Ue=Object.keys(cr),ln=0,Gr=Ue;ln<Gr.length;ln+=1){var Sr=Gr[ln],un=cr[Sr],ir=un[0],ci=v.createExpression(un[1]),On=v.createExpression("string"==typeof ir?[ir,["accumulated"],["get",Sr]]:ir);pr[Sr]=ci.value,Tr[Sr]=On.value}return Oe.map=function(wn){nr.properties=wn;for(var cn={},gi=0,Un=Ue;gi<Un.length;gi+=1){var on=Un[gi];cn[on]=pr[on].evaluate(Re,nr)}return cn},Oe.reduce=function(wn,cn){nr.properties=cn;for(var gi=0,Un=Ue;gi<Un.length;gi+=1){var on=Un[gi];Re.accumulated=wn[on],wn[on]=Tr[on].evaluate(Re,nr)}},Oe}(Lt)).load(Ht.features):new ei(ge=Ht,Lt.geojsonVtOptions)}catch(ge){return ht(ge)}var ge;it.loaded={};var je={};if(Wt){var ur=Wt.finish();ur&&(je.resourceTiming={},je.resourceTiming[Lt.source]=JSON.parse(JSON.stringify(ur)))}ht(null,je)})}},Y.prototype.coalesce=function(){"Coalescing"===this._state?this._state="Idle":"NeedsLoadData"===this._state&&(this._state="Coalescing",this._loadData())},Y.prototype.reloadTile=function(it,ht){var Lt=this.loaded;return Lt&&Lt[it.uid]?V.prototype.reloadTile.call(this,it,ht):this.loadTile(it,ht)},Y.prototype.loadGeoJSON=function(it,ht){if(it.request)v.getJSON(it.request,ht);else{if("string"!=typeof it.data)return ht(new Error("Input data given to '"+it.source+"' is not a valid GeoJSON object."));try{return ht(null,JSON.parse(it.data))}catch(Lt){return ht(new Error("Input data given to '"+it.source+"' is not a valid GeoJSON object."))}}},Y.prototype.removeSource=function(it,ht){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),ht()},Y.prototype.getClusterExpansionZoom=function(it,ht){try{ht(null,this._geoJSONIndex.getClusterExpansionZoom(it.clusterId))}catch(Lt){ht(Lt)}},Y.prototype.getClusterChildren=function(it,ht){try{ht(null,this._geoJSONIndex.getChildren(it.clusterId))}catch(Lt){ht(Lt)}},Y.prototype.getClusterLeaves=function(it,ht){try{ht(null,this._geoJSONIndex.getLeaves(it.clusterId,it.limit,it.offset))}catch(Lt){ht(Lt)}},Y}(ye),di=function(V){var Y=this;this.self=V,this.actor=new v.Actor(V,this),this.layerIndexes={},this.availableImages={},this.workerSourceTypes={vector:ye,geojson:Je},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=function(it,ht){if(Y.workerSourceTypes[it])throw new Error('Worker source with name "'+it+'" already registered.');Y.workerSourceTypes[it]=ht},this.self.registerRTLTextPlugin=function(it){if(v.plugin.isParsed())throw new Error("RTL text plugin already registered.");v.plugin.applyArabicShaping=it.applyArabicShaping,v.plugin.processBidirectionalText=it.processBidirectionalText,v.plugin.processStyledBidirectionalText=it.processStyledBidirectionalText}};return di.prototype.setReferrer=function(V,Y){this.referrer=Y},di.prototype.setImages=function(V,Y,it){for(var ht in this.availableImages[V]=Y,this.workerSources[V]){var Lt=this.workerSources[V][ht];for(var Wt in Lt)Lt[Wt].availableImages=Y}it()},di.prototype.setLayers=function(V,Y,it){this.getLayerIndex(V).replace(Y),it()},di.prototype.updateLayers=function(V,Y,it){this.getLayerIndex(V).update(Y.layers,Y.removedIds),it()},di.prototype.loadTile=function(V,Y,it){this.getWorkerSource(V,Y.type,Y.source).loadTile(Y,it)},di.prototype.loadDEMTile=function(V,Y,it){this.getDEMWorkerSource(V,Y.source).loadTile(Y,it)},di.prototype.reloadTile=function(V,Y,it){this.getWorkerSource(V,Y.type,Y.source).reloadTile(Y,it)},di.prototype.abortTile=function(V,Y,it){this.getWorkerSource(V,Y.type,Y.source).abortTile(Y,it)},di.prototype.removeTile=function(V,Y,it){this.getWorkerSource(V,Y.type,Y.source).removeTile(Y,it)},di.prototype.removeDEMTile=function(V,Y){this.getDEMWorkerSource(V,Y.source).removeTile(Y)},di.prototype.removeSource=function(V,Y,it){if(this.workerSources[V]&&this.workerSources[V][Y.type]&&this.workerSources[V][Y.type][Y.source]){var ht=this.workerSources[V][Y.type][Y.source];delete this.workerSources[V][Y.type][Y.source],void 0!==ht.removeSource?ht.removeSource(Y,it):it()}},di.prototype.loadWorkerSource=function(V,Y,it){try{this.self.importScripts(Y.url),it()}catch(ht){it(ht.toString())}},di.prototype.syncRTLPluginState=function(V,Y,it){try{v.plugin.setState(Y);var ht=v.plugin.getPluginURL();if(v.plugin.isLoaded()&&!v.plugin.isParsed()&&null!=ht){this.self.importScripts(ht);var Lt=v.plugin.isParsed();it(Lt?void 0:new Error("RTL Text Plugin failed to import scripts from "+ht),Lt)}}catch(Wt){it(Wt.toString())}},di.prototype.getAvailableImages=function(V){var Y=this.availableImages[V];return Y||(Y=[]),Y},di.prototype.getLayerIndex=function(V){var Y=this.layerIndexes[V];return Y||(Y=this.layerIndexes[V]=new St),Y},di.prototype.getWorkerSource=function(V,Y,it){var ht=this;return this.workerSources[V]||(this.workerSources[V]={}),this.workerSources[V][Y]||(this.workerSources[V][Y]={}),this.workerSources[V][Y][it]||(this.workerSources[V][Y][it]=new this.workerSourceTypes[Y]({send:function(Lt,Wt,ie){ht.actor.send(Lt,Wt,ie,V)}},this.getLayerIndex(V),this.getAvailableImages(V))),this.workerSources[V][Y][it]},di.prototype.getDEMWorkerSource=function(V,Y){return this.demWorkerSources[V]||(this.demWorkerSources[V]={}),this.demWorkerSources[V][Y]||(this.demWorkerSources[V][Y]=new de),this.demWorkerSources[V][Y]},di.prototype.enforceCacheSizeLimit=function(V,Y){v.enforceCacheSizeLimit(Y)},"undefined"!=typeof WorkerGlobalScope&&"undefined"!=typeof self&&self instanceof WorkerGlobalScope&&(self.worker=new di(self)),di}),b(0,function(v){var Bt=v.createCommonjsModule(function(l){function p(C){return!c(C)}function c(C){return"undefined"==typeof window||"undefined"==typeof document?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var L,z,Z=new Blob([""],{type:"text/javascript"}),H=URL.createObjectURL(Z);try{z=new Worker(H),L=!0}catch(ut){L=!1}return z&&z.terminate(),URL.revokeObjectURL(H),L}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var L=document.createElement("canvas");L.width=L.height=1;var z=L.getContext("2d");if(!z)return!1;var Z=z.getImageData(0,0,1,1);return Z&&Z.width===L.width}()?(void 0===y[T=C&&C.failIfMajorPerformanceCaveat]&&(y[T]=function(L){var H,ut,gt,z=(H=L,ut=document.createElement("canvas"),(gt=Object.create(p.webGLContextAttributes)).failIfMajorPerformanceCaveat=H,ut.probablySupportsContext?ut.probablySupportsContext("webgl",gt)||ut.probablySupportsContext("experimental-webgl",gt):ut.supportsContext?ut.supportsContext("webgl",gt)||ut.supportsContext("experimental-webgl",gt):ut.getContext("webgl",gt)||ut.getContext("experimental-webgl",gt));if(!z)return!1;var Z=z.createShader(z.VERTEX_SHADER);return!(!Z||z.isContextLost())&&(z.shaderSource(Z,"void main() {}"),z.compileShader(Z),!0===z.getShaderParameter(Z,z.COMPILE_STATUS))}(T)),y[T]?void 0:"insufficient WebGL support"):"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support";var T}l.exports?l.exports=p:window&&(window.mapboxgl=window.mapboxgl||{},window.mapboxgl.supported=p,window.mapboxgl.notSupportedReason=c);var y={};p.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0}}),ft={create:function(l,p,c){var y=v.window.document.createElement(l);return void 0!==p&&(y.className=p),c&&c.appendChild(y),y},createNS:function(l,p){return v.window.document.createElementNS(l,p)}},St=v.window.document&&v.window.document.documentElement.style;function Ft(l){if(!St)return l[0];for(var p=0;p<l.length;p++)if(l[p]in St)return l[p];return l[0]}var le,kt=Ft(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]);ft.disableDrag=function(){St&&kt&&(le=St[kt],St[kt]="none")},ft.enableDrag=function(){St&&kt&&(St[kt]=le)};var Ze=Ft(["transform","WebkitTransform"]);ft.setTransform=function(l,p){l.style[Ze]=p};var ye=!1;try{var ue=Object.defineProperty({},"passive",{get:function(){ye=!0}});v.window.addEventListener("test",ue,ue),v.window.removeEventListener("test",ue,ue)}catch(l){ye=!1}ft.addEventListener=function(l,p,c,y){void 0===y&&(y={}),l.addEventListener(p,c,"passive"in y&&ye?y:y.capture)},ft.removeEventListener=function(l,p,c,y){void 0===y&&(y={}),l.removeEventListener(p,c,"passive"in y&&ye?y:y.capture)};var de=function(l){l.preventDefault(),l.stopPropagation(),v.window.removeEventListener("click",de,!0)};function Ye(l){var p=l.userImage;return!!(p&&p.render&&p.render())&&(l.data.replace(new Uint8Array(p.data.buffer)),!0)}ft.suppressClick=function(){v.window.addEventListener("click",de,!0),v.window.setTimeout(function(){v.window.removeEventListener("click",de,!0)},0)},ft.mousePos=function(l,p){var c=l.getBoundingClientRect();return new v.Point(p.clientX-c.left-l.clientLeft,p.clientY-c.top-l.clientTop)},ft.touchPos=function(l,p){for(var c=l.getBoundingClientRect(),y=[],C=0;C<p.length;C++)y.push(new v.Point(p[C].clientX-c.left-l.clientLeft,p[C].clientY-c.top-l.clientTop));return y},ft.mouseButton=function(l){return void 0!==v.window.InstallTrigger&&2===l.button&&l.ctrlKey&&v.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:l.button},ft.remove=function(l){l.parentNode&&l.parentNode.removeChild(l)};var qt=function(l){function p(){l.call(this),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new v.RGBAImage({width:1,height:1}),this.dirty=!0}return l&&(p.__proto__=l),(p.prototype=Object.create(l&&l.prototype)).constructor=p,p.prototype.isLoaded=function(){return this.loaded},p.prototype.setLoaded=function(c){if(this.loaded!==c&&(this.loaded=c,c)){for(var y=0,C=this.requestors;y<C.length;y+=1){var T=C[y];this._notify(T.ids,T.callback)}this.requestors=[]}},p.prototype.getImage=function(c){return this.images[c]},p.prototype.addImage=function(c,y){this._validate(c,y)&&(this.images[c]=y)},p.prototype._validate=function(c,y){var C=!0;return this._validateStretch(y.stretchX,y.data&&y.data.width)||(this.fire(new v.ErrorEvent(new Error('Image "'+c+'" has invalid "stretchX" value'))),C=!1),this._validateStretch(y.stretchY,y.data&&y.data.height)||(this.fire(new v.ErrorEvent(new Error('Image "'+c+'" has invalid "stretchY" value'))),C=!1),this._validateContent(y.content,y)||(this.fire(new v.ErrorEvent(new Error('Image "'+c+'" has invalid "content" value'))),C=!1),C},p.prototype._validateStretch=function(c,y){if(!c)return!0;for(var C=0,T=0,L=c;T<L.length;T+=1){var z=L[T];if(z[0]<C||z[1]<z[0]||y<z[1])return!1;C=z[1]}return!0},p.prototype._validateContent=function(c,y){return!(c&&(4!==c.length||c[0]<0||y.data.width<c[0]||c[1]<0||y.data.height<c[1]||c[2]<0||y.data.width<c[2]||c[3]<0||y.data.height<c[3]||c[2]<c[0]||c[3]<c[1]))},p.prototype.updateImage=function(c,y){y.version=this.images[c].version+1,this.images[c]=y,this.updatedImages[c]=!0},p.prototype.removeImage=function(c){var y=this.images[c];delete this.images[c],delete this.patterns[c],y.userImage&&y.userImage.onRemove&&y.userImage.onRemove()},p.prototype.listImages=function(){return Object.keys(this.images)},p.prototype.getImages=function(c,y){var C=!0;if(!this.isLoaded())for(var T=0,L=c;T<L.length;T+=1)this.images[L[T]]||(C=!1);this.isLoaded()||C?this._notify(c,y):this.requestors.push({ids:c,callback:y})},p.prototype._notify=function(c,y){for(var C={},T=0,L=c;T<L.length;T+=1){var z=L[T];this.images[z]||this.fire(new v.Event("styleimagemissing",{id:z}));var Z=this.images[z];Z?C[z]={data:Z.data.clone(),pixelRatio:Z.pixelRatio,sdf:Z.sdf,version:Z.version,stretchX:Z.stretchX,stretchY:Z.stretchY,content:Z.content,hasRenderCallback:Boolean(Z.userImage&&Z.userImage.render)}:v.warnOnce('Image "'+z+'" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.')}y(null,C)},p.prototype.getPixelSize=function(){var c=this.atlasImage;return{width:c.width,height:c.height}},p.prototype.getPattern=function(c){var y=this.patterns[c],C=this.getImage(c);if(!C)return null;if(y&&y.position.version===C.version)return y.position;if(y)y.position.version=C.version;else{var T={w:C.data.width+2,h:C.data.height+2,x:0,y:0},L=new v.ImagePosition(T,C);this.patterns[c]={bin:T,position:L}}return this._updatePatternAtlas(),this.patterns[c].position},p.prototype.bind=function(c){var y=c.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new v.Texture(c,this.atlasImage,y.RGBA),this.atlasTexture.bind(y.LINEAR,y.CLAMP_TO_EDGE)},p.prototype._updatePatternAtlas=function(){var c=[];for(var y in this.patterns)c.push(this.patterns[y].bin);var C=v.potpack(c),T=C.w,L=C.h,z=this.atlasImage;for(var Z in z.resize({width:T||1,height:L||1}),this.patterns){var H=this.patterns[Z].bin,ut=H.x+1,gt=H.y+1,ct=this.images[Z].data,zt=ct.width,Rt=ct.height;v.RGBAImage.copy(ct,z,{x:0,y:0},{x:ut,y:gt},{width:zt,height:Rt}),v.RGBAImage.copy(ct,z,{x:0,y:Rt-1},{x:ut,y:gt-1},{width:zt,height:1}),v.RGBAImage.copy(ct,z,{x:0,y:0},{x:ut,y:gt+Rt},{width:zt,height:1}),v.RGBAImage.copy(ct,z,{x:zt-1,y:0},{x:ut-1,y:gt},{width:1,height:Rt}),v.RGBAImage.copy(ct,z,{x:0,y:0},{x:ut+zt,y:gt},{width:1,height:Rt})}this.dirty=!0},p.prototype.beginFrame=function(){this.callbackDispatchedThisFrame={}},p.prototype.dispatchRenderCallbacks=function(c){for(var y=0,C=c;y<C.length;y+=1){var T=C[y];if(!this.callbackDispatchedThisFrame[T]){this.callbackDispatchedThisFrame[T]=!0;var L=this.images[T];Ye(L)&&this.updateImage(T,L)}}},p}(v.Evented),Qt=Q,X=Q,J=1e20;function Q(l,p,c,y,C,T){this.fontSize=l||24,this.buffer=void 0===p?3:p,this.cutoff=y||.25,this.fontFamily=C||"sans-serif",this.fontWeight=T||"normal",this.radius=c||8;var L=this.size=this.fontSize+2*this.buffer;this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=L,this.ctx=this.canvas.getContext("2d"),this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.ctx.textBaseline="middle",this.ctx.fillStyle="black",this.gridOuter=new Float64Array(L*L),this.gridInner=new Float64Array(L*L),this.f=new Float64Array(L),this.d=new Float64Array(L),this.z=new Float64Array(L+1),this.v=new Int16Array(L),this.middle=Math.round(L/2*(navigator.userAgent.indexOf("Gecko/")>=0?1.2:1))}function bt(l,p,c,y,C,T,L){for(var z=0;z<p;z++){for(var Z=0;Z<c;Z++)y[Z]=l[Z*p+z];for(et(y,C,T,L,c),Z=0;Z<c;Z++)l[Z*p+z]=C[Z]}for(Z=0;Z<c;Z++){for(z=0;z<p;z++)y[z]=l[Z*p+z];for(et(y,C,T,L,p),z=0;z<p;z++)l[Z*p+z]=Math.sqrt(C[z])}}function et(l,p,c,y,C){c[0]=0,y[0]=-J,y[1]=+J;for(var T=1,L=0;T<C;T++){for(var z=(l[T]+T*T-(l[c[L]]+c[L]*c[L]))/(2*T-2*c[L]);z<=y[L];)L--,z=(l[T]+T*T-(l[c[L]]+c[L]*c[L]))/(2*T-2*c[L]);c[++L]=T,y[L]=z,y[L+1]=+J}for(T=0,L=0;T<C;T++){for(;y[L+1]<T;)L++;p[T]=(T-c[L])*(T-c[L])+l[c[L]]}}Q.prototype.draw=function(l){this.ctx.clearRect(0,0,this.size,this.size),this.ctx.fillText(l,this.buffer,this.middle);for(var p=this.ctx.getImageData(0,0,this.size,this.size),c=new Uint8ClampedArray(this.size*this.size),y=0;y<this.size*this.size;y++){var C=p.data[4*y+3]/255;this.gridOuter[y]=1===C?0:0===C?J:Math.pow(Math.max(0,.5-C),2),this.gridInner[y]=1===C?J:0===C?0:Math.pow(Math.max(0,C-.5),2)}for(bt(this.gridOuter,this.size,this.size,this.f,this.d,this.v,this.z),bt(this.gridInner,this.size,this.size,this.f,this.d,this.v,this.z),y=0;y<this.size*this.size;y++)c[y]=Math.max(0,Math.min(255,Math.round(255-255*((this.gridOuter[y]-this.gridInner[y])/this.radius+this.cutoff))));return c},Qt.default=X;var tt=function(l,p){this.requestManager=l,this.localIdeographFontFamily=p,this.entries={}};tt.prototype.setURL=function(l){this.url=l},tt.prototype.getGlyphs=function(l,p){var c=this,y=[];for(var C in l)for(var T=0,L=l[C];T<L.length;T+=1)y.push({stack:C,id:L[T]});v.asyncAll(y,function(z,Z){var H=z.stack,ut=z.id,gt=c.entries[H];gt||(gt=c.entries[H]={glyphs:{},requests:{},ranges:{}});var ct=gt.glyphs[ut];if(void 0===ct){if(ct=c._tinySDF(gt,H,ut))return gt.glyphs[ut]=ct,void Z(null,{stack:H,id:ut,glyph:ct});var zt=Math.floor(ut/256);if(256*zt>65535)Z(new Error("glyphs > 65535 not supported"));else if(gt.ranges[zt])Z(null,{stack:H,id:ut,glyph:ct});else{var Rt=gt.requests[zt];Rt||(Rt=gt.requests[zt]=[],tt.loadGlyphRange(H,zt,c.url,c.requestManager,function(Yt,Dt){if(Dt){for(var Vt in Dt)c._doesCharSupportLocalGlyph(+Vt)||(gt.glyphs[+Vt]=Dt[+Vt]);gt.ranges[zt]=!0}for(var ee=0,he=Rt;ee<he.length;ee+=1)(0,he[ee])(Yt,Dt);delete gt.requests[zt]})),Rt.push(function(Yt,Dt){Yt?Z(Yt):Dt&&Z(null,{stack:H,id:ut,glyph:Dt[ut]||null})})}}else Z(null,{stack:H,id:ut,glyph:ct})},function(z,Z){if(z)p(z);else if(Z){for(var H={},ut=0,gt=Z;ut<gt.length;ut+=1){var ct=gt[ut],zt=ct.stack,Rt=ct.id,Yt=ct.glyph;(H[zt]||(H[zt]={}))[Rt]=Yt&&{id:Yt.id,bitmap:Yt.bitmap.clone(),metrics:Yt.metrics}}p(null,H)}})},tt.prototype._doesCharSupportLocalGlyph=function(l){return!!this.localIdeographFontFamily&&(v.isChar["CJK Unified Ideographs"](l)||v.isChar["Hangul Syllables"](l)||v.isChar.Hiragana(l)||v.isChar.Katakana(l))},tt.prototype._tinySDF=function(l,p,c){var y=this.localIdeographFontFamily;if(y&&this._doesCharSupportLocalGlyph(c)){var C=l.tinySDF;if(!C){var T="400";/bold/i.test(p)?T="900":/medium/i.test(p)?T="500":/light/i.test(p)&&(T="200"),C=l.tinySDF=new tt.TinySDF(24,3,8,.25,y,T)}return{id:c,bitmap:new v.AlphaImage({width:30,height:30},C.draw(String.fromCharCode(c))),metrics:{width:24,height:24,left:0,top:-8,advance:24}}}},tt.loadGlyphRange=function(l,p,c,y,C){var T=256*p,L=T+255,z=y.transformRequest(y.normalizeGlyphsURL(c).replace("{fontstack}",l).replace("{range}",T+"-"+L),v.ResourceType.Glyphs);v.getArrayBuffer(z,function(Z,H){if(Z)C(Z);else if(H){for(var ut={},gt=0,ct=v.parseGlyphPBF(H);gt<ct.length;gt+=1){var zt=ct[gt];ut[zt.id]=zt}C(null,ut)}})},tt.TinySDF=Qt;var lt=function(){this.specification=v.styleSpec.light.position};lt.prototype.possiblyEvaluate=function(l,p){return v.sphericalToCartesian(l.expression.evaluate(p))},lt.prototype.interpolate=function(l,p,c){return{x:v.number(l.x,p.x,c),y:v.number(l.y,p.y,c),z:v.number(l.z,p.z,c)}};var j=new v.Properties({anchor:new v.DataConstantProperty(v.styleSpec.light.anchor),position:new lt,color:new v.DataConstantProperty(v.styleSpec.light.color),intensity:new v.DataConstantProperty(v.styleSpec.light.intensity)}),re=function(l){function p(c){l.call(this),this._transitionable=new v.Transitionable(j),this.setLight(c),this._transitioning=this._transitionable.untransitioned()}return l&&(p.__proto__=l),(p.prototype=Object.create(l&&l.prototype)).constructor=p,p.prototype.getLight=function(){return this._transitionable.serialize()},p.prototype.setLight=function(c,y){if(void 0===y&&(y={}),!this._validate(v.validateLight,c,y))for(var C in c){var T=c[C];v.endsWith(C,"-transition")?this._transitionable.setTransition(C.slice(0,-"-transition".length),T):this._transitionable.setValue(C,T)}},p.prototype.updateTransitions=function(c){this._transitioning=this._transitionable.transitioned(c,this._transitioning)},p.prototype.hasTransition=function(){return this._transitioning.hasTransition()},p.prototype.recalculate=function(c){this.properties=this._transitioning.possiblyEvaluate(c)},p.prototype._validate=function(c,y,C){return(!C||!1!==C.validate)&&v.emitValidationErrors(this,c.call(v.validateStyle,v.extend({value:y,style:{glyphs:!0,sprite:!0},styleSpec:v.styleSpec})))},p}(v.Evented),xt=function(l,p){this.width=l,this.height=p,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}};xt.prototype.getDash=function(l,p){var c=l.join(",")+String(p);return this.dashEntry[c]||(this.dashEntry[c]=this.addDash(l,p)),this.dashEntry[c]},xt.prototype.getDashRanges=function(l,p,c){var y=[],C=l.length%2==1?-l[l.length-1]*c:0,T=l[0]*c,L=!0;y.push({left:C,right:T,isDash:L,zeroLength:0===l[0]});for(var z=l[0],Z=1;Z<l.length;Z++){var H=l[Z];y.push({left:C=z*c,right:T=(z+=H)*c,isDash:L=!L,zeroLength:0===H})}return y},xt.prototype.addRoundDash=function(l,p,c){for(var y=p/2,C=-c;C<=c;C++)for(var T=this.width*(this.nextRow+c+C),L=0,z=l[L],Z=0;Z<this.width;Z++){Z/z.right>1&&(z=l[++L]);var H=Math.abs(Z-z.left),ut=Math.abs(Z-z.right),gt=Math.min(H,ut),ct=void 0,zt=C/c*(y+1);if(z.isDash){var Rt=y-Math.abs(zt);ct=Math.sqrt(gt*gt+Rt*Rt)}else ct=y-Math.sqrt(gt*gt+zt*zt);this.data[T+Z]=Math.max(0,Math.min(255,ct+128))}},xt.prototype.addRegularDash=function(l){for(var p=l.length-1;p>=0;--p){var c=l[p],y=l[p+1];c.zeroLength?l.splice(p,1):y&&y.isDash===c.isDash&&(y.left=c.left,l.splice(p,1))}var C=l[0],T=l[l.length-1];C.isDash===T.isDash&&(C.left=T.left-this.width,T.right=C.right+this.width);for(var L=this.width*this.nextRow,z=0,Z=l[z],H=0;H<this.width;H++){H/Z.right>1&&(Z=l[++z]);var ut=Math.abs(H-Z.left),gt=Math.abs(H-Z.right),ct=Math.min(ut,gt);this.data[L+H]=Math.max(0,Math.min(255,(Z.isDash?ct:-ct)+128))}},xt.prototype.addDash=function(l,p){var c=p?7:0,y=2*c+1;if(this.nextRow+y>this.height)return v.warnOnce("LineAtlas out of space"),null;for(var C=0,T=0;T<l.length;T++)C+=l[T];if(0!==C){var L=this.width/C,z=this.getDashRanges(l,this.width,L);p?this.addRoundDash(z,L,c):this.addRegularDash(z)}var Z={y:(this.nextRow+c+.5)/this.height,height:2*c/this.height,width:C};return this.nextRow+=y,this.dirty=!0,Z},xt.prototype.bind=function(l){var p=l.gl;this.texture?(p.bindTexture(p.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,p.texSubImage2D(p.TEXTURE_2D,0,0,0,this.width,this.height,p.ALPHA,p.UNSIGNED_BYTE,this.data))):(this.texture=p.createTexture(),p.bindTexture(p.TEXTURE_2D,this.texture),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_WRAP_S,p.REPEAT),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_WRAP_T,p.REPEAT),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MIN_FILTER,p.LINEAR),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MAG_FILTER,p.LINEAR),p.texImage2D(p.TEXTURE_2D,0,p.ALPHA,this.width,this.height,0,p.ALPHA,p.UNSIGNED_BYTE,this.data))};var Ot=function l(p,c){this.workerPool=p,this.actors=[],this.currentActor=0,this.id=v.uniqueId();for(var y=this.workerPool.acquire(this.id),C=0;C<y.length;C++){var T=new l.Actor(y[C],c,this.id);T.name="Worker "+C,this.actors.push(T)}};function at(l,p,c){var y=function(C,T){if(C)return c(C);if(T){var L=v.pick(v.extend(T,l),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);T.vector_layers&&(L.vectorLayers=T.vector_layers,L.vectorLayerIds=L.vectorLayers.map(function(z){return z.id})),L.tiles=p.canonicalizeTileset(L,l.url),c(null,L)}};return l.url?v.getJSON(p.transformRequest(p.normalizeSourceURL(l.url),v.ResourceType.Source),y):v.browser.frame(function(){return y(null,l)})}Ot.prototype.broadcast=function(l,p,c){v.asyncAll(this.actors,function(y,C){y.send(l,p,C)},c=c||function(){})},Ot.prototype.getActor=function(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]},Ot.prototype.remove=function(){this.actors.forEach(function(l){l.remove()}),this.actors=[],this.workerPool.release(this.id)},Ot.Actor=v.Actor;var ke=function(l,p,c){this.bounds=v.LngLatBounds.convert(this.validateBounds(l)),this.minzoom=p||0,this.maxzoom=c||24};ke.prototype.validateBounds=function(l){return Array.isArray(l)&&4===l.length?[Math.max(-180,l[0]),Math.max(-90,l[1]),Math.min(180,l[2]),Math.min(90,l[3])]:[-180,-90,180,90]},ke.prototype.contains=function(l){var p=Math.pow(2,l.z),c=Math.floor(v.mercatorXfromLng(this.bounds.getWest())*p),y=Math.floor(v.mercatorYfromLat(this.bounds.getNorth())*p),C=Math.ceil(v.mercatorXfromLng(this.bounds.getEast())*p),T=Math.ceil(v.mercatorYfromLat(this.bounds.getSouth())*p);return l.x>=c&&l.x<C&&l.y>=y&&l.y<T};var Te=function(l){function p(c,y,C,T){if(l.call(this),this.id=c,this.dispatcher=C,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,v.extend(this,v.pick(y,["url","scheme","tileSize","promoteId"])),this._options=v.extend({type:"vector"},y),this._collectResourceTiming=y.collectResourceTiming,512!==this.tileSize)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(T)}return l&&(p.__proto__=l),(p.prototype=Object.create(l&&l.prototype)).constructor=p,p.prototype.load=function(){var c=this;this._loaded=!1,this.fire(new v.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=at(this._options,this.map._requestManager,function(y,C){c._tileJSONRequest=null,c._loaded=!0,y?c.fire(new v.ErrorEvent(y)):C&&(v.extend(c,C),C.bounds&&(c.tileBounds=new ke(C.bounds,c.minzoom,c.maxzoom)),v.postTurnstileEvent(C.tiles,c.map._requestManager._customAccessToken),v.postMapLoadEvent(C.tiles,c.map._getMapId(),c.map._requestManager._skuToken,c.map._requestManager._customAccessToken),c.fire(new v.Event("data",{dataType:"source",sourceDataType:"metadata"})),c.fire(new v.Event("data",{dataType:"source",sourceDataType:"content"})))})},p.prototype.loaded=function(){return this._loaded},p.prototype.hasTile=function(c){return!this.tileBounds||this.tileBounds.contains(c.canonical)},p.prototype.onAdd=function(c){this.map=c,this.load()},p.prototype.setSourceProperty=function(c){this._tileJSONRequest&&this._tileJSONRequest.cancel(),c(),this.map.style.sourceCaches[this.id].clearTiles(),this.load()},p.prototype.setTiles=function(c){var y=this;return this.setSourceProperty(function(){y._options.tiles=c}),this},p.prototype.setUrl=function(c){var y=this;return this.setSourceProperty(function(){y.url=c,y._options.url=c}),this},p.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},p.prototype.serialize=function(){return v.extend({},this._options)},p.prototype.loadTile=function(c,y){var C=this.map._requestManager.normalizeTileURL(c.tileID.canonical.url(this.tiles,this.scheme)),T={request:this.map._requestManager.transformRequest(C,v.ResourceType.Tile),uid:c.uid,tileID:c.tileID,zoom:c.tileID.overscaledZ,tileSize:this.tileSize*c.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:v.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};function L(z,Z){return delete c.request,c.aborted?y(null):z&&404!==z.status?y(z):(Z&&Z.resourceTiming&&(c.resourceTiming=Z.resourceTiming),this.map._refreshExpiredTiles&&Z&&c.setExpiryData(Z),c.loadVectorData(Z,this.map.painter),v.cacheEntryPossiblyAdded(this.dispatcher),y(null),void(c.reloadCallback&&(this.loadTile(c,c.reloadCallback),c.reloadCallback=null)))}T.request.collectResourceTiming=this._collectResourceTiming,c.actor&&"expired"!==c.state?"loading"===c.state?c.reloadCallback=y:c.request=c.actor.send("reloadTile",T,L.bind(this)):(c.actor=this.dispatcher.getActor(),c.request=c.actor.send("loadTile",T,L.bind(this)))},p.prototype.abortTile=function(c){c.request&&(c.request.cancel(),delete c.request),c.actor&&c.actor.send("abortTile",{uid:c.uid,type:this.type,source:this.id},void 0)},p.prototype.unloadTile=function(c){c.unloadVectorData(),c.actor&&c.actor.send("removeTile",{uid:c.uid,type:this.type,source:this.id},void 0)},p.prototype.hasTransition=function(){return!1},p}(v.Evented),Et=function(l){function p(c,y,C,T){l.call(this),this.id=c,this.dispatcher=C,this.setEventedParent(T),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=v.extend({type:"raster"},y),v.extend(this,v.pick(y,["url","scheme","tileSize"]))}return l&&(p.__proto__=l),(p.prototype=Object.create(l&&l.prototype)).constructor=p,p.prototype.load=function(){var c=this;this._loaded=!1,this.fire(new v.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=at(this._options,this.map._requestManager,function(y,C){c._tileJSONRequest=null,c._loaded=!0,y?c.fire(new v.ErrorEvent(y)):C&&(v.extend(c,C),C.bounds&&(c.tileBounds=new ke(C.bounds,c.minzoom,c.maxzoom)),v.postTurnstileEvent(C.tiles),v.postMapLoadEvent(C.tiles,c.map._getMapId(),c.map._requestManager._skuToken),c.fire(new v.Event("data",{dataType:"source",sourceDataType:"metadata"})),c.fire(new v.Event("data",{dataType:"source",sourceDataType:"content"})))})},p.prototype.loaded=function(){return this._loaded},p.prototype.onAdd=function(c){this.map=c,this.load()},p.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},p.prototype.serialize=function(){return v.extend({},this._options)},p.prototype.hasTile=function(c){return!this.tileBounds||this.tileBounds.contains(c.canonical)},p.prototype.loadTile=function(c,y){var C=this,T=this.map._requestManager.normalizeTileURL(c.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);c.request=v.getImage(this.map._requestManager.transformRequest(T,v.ResourceType.Tile),function(L,z){if(delete c.request,c.aborted)c.state="unloaded",y(null);else if(L)c.state="errored",y(L);else if(z){C.map._refreshExpiredTiles&&c.setExpiryData(z),delete z.cacheControl,delete z.expires;var Z=C.map.painter.context,H=Z.gl;c.texture=C.map.painter.getTileTexture(z.width),c.texture?c.texture.update(z,{useMipmap:!0}):(c.texture=new v.Texture(Z,z,H.RGBA,{useMipmap:!0}),c.texture.bind(H.LINEAR,H.CLAMP_TO_EDGE,H.LINEAR_MIPMAP_NEAREST),Z.extTextureFilterAnisotropic&&H.texParameterf(H.TEXTURE_2D,Z.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,Z.extTextureFilterAnisotropicMax)),c.state="loaded",v.cacheEntryPossiblyAdded(C.dispatcher),y(null)}})},p.prototype.abortTile=function(c,y){c.request&&(c.request.cancel(),delete c.request),y()},p.prototype.unloadTile=function(c,y){c.texture&&this.map.painter.saveTileTexture(c.texture),y()},p.prototype.hasTransition=function(){return!1},p}(v.Evented),ne=function(l){function p(c,y,C,T){l.call(this,c,y,C,T),this.type="raster-dem",this.maxzoom=22,this._options=v.extend({type:"raster-dem"},y),this.encoding=y.encoding||"mapbox"}return l&&(p.__proto__=l),(p.prototype=Object.create(l&&l.prototype)).constructor=p,p.prototype.serialize=function(){return{type:"raster-dem",url:this.url,tileSize:this.tileSize,tiles:this.tiles,bounds:this.bounds,encoding:this.encoding}},p.prototype.loadTile=function(c,y){var C=this.map._requestManager.normalizeTileURL(c.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);function T(L,z){L&&(c.state="errored",y(L)),z&&(c.dem=z,c.needsHillshadePrepare=!0,c.state="loaded",y(null))}c.request=v.getImage(this.map._requestManager.transformRequest(C,v.ResourceType.Tile),function(L,z){if(delete c.request,c.aborted)c.state="unloaded",y(null);else if(L)c.state="errored",y(L);else if(z){this.map._refreshExpiredTiles&&c.setExpiryData(z),delete z.cacheControl,delete z.expires;var Z=v.window.ImageBitmap&&z instanceof v.window.ImageBitmap&&v.offscreenCanvasSupported()?z:v.browser.getImageData(z,1),H={uid:c.uid,coord:c.tileID,source:this.id,rawImageData:Z,encoding:this.encoding};c.actor&&"expired"!==c.state||(c.actor=this.dispatcher.getActor(),c.actor.send("loadDEMTile",H,T.bind(this)))}}.bind(this)),c.neighboringTiles=this._getNeighboringTiles(c.tileID)},p.prototype._getNeighboringTiles=function(c){var y=c.canonical,C=Math.pow(2,y.z),T=(y.x-1+C)%C,L=0===y.x?c.wrap-1:c.wrap,z=(y.x+1+C)%C,Z=y.x+1===C?c.wrap+1:c.wrap,H={};return H[new v.OverscaledTileID(c.overscaledZ,L,y.z,T,y.y).key]={backfilled:!1},H[new v.OverscaledTileID(c.overscaledZ,Z,y.z,z,y.y).key]={backfilled:!1},y.y>0&&(H[new v.OverscaledTileID(c.overscaledZ,L,y.z,T,y.y-1).key]={backfilled:!1},H[new v.OverscaledTileID(c.overscaledZ,c.wrap,y.z,y.x,y.y-1).key]={backfilled:!1},H[new v.OverscaledTileID(c.overscaledZ,Z,y.z,z,y.y-1).key]={backfilled:!1}),y.y+1<C&&(H[new v.OverscaledTileID(c.overscaledZ,L,y.z,T,y.y+1).key]={backfilled:!1},H[new v.OverscaledTileID(c.overscaledZ,c.wrap,y.z,y.x,y.y+1).key]={backfilled:!1},H[new v.OverscaledTileID(c.overscaledZ,Z,y.z,z,y.y+1).key]={backfilled:!1}),H},p.prototype.unloadTile=function(c){c.demTexture&&this.map.painter.saveTileTexture(c.demTexture),c.fbo&&(c.fbo.destroy(),delete c.fbo),c.dem&&delete c.dem,delete c.neighboringTiles,c.state="unloaded",c.actor&&c.actor.send("removeDEMTile",{uid:c.uid,source:this.id})},p}(Et),Pt=function(l){function p(c,y,C,T){l.call(this),this.id=c,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._loaded=!1,this.actor=C.getActor(),this.setEventedParent(T),this._data=y.data,this._options=v.extend({},y),this._collectResourceTiming=y.collectResourceTiming,this._resourceTiming=[],void 0!==y.maxzoom&&(this.maxzoom=y.maxzoom),y.type&&(this.type=y.type),y.attribution&&(this.attribution=y.attribution),this.promoteId=y.promoteId;var L=v.EXTENT/this.tileSize;this.workerOptions=v.extend({source:this.id,cluster:y.cluster||!1,geojsonVtOptions:{buffer:(void 0!==y.buffer?y.buffer:128)*L,tolerance:(void 0!==y.tolerance?y.tolerance:.375)*L,extent:v.EXTENT,maxZoom:this.maxzoom,lineMetrics:y.lineMetrics||!1,generateId:y.generateId||!1},superclusterOptions:{maxZoom:void 0!==y.clusterMaxZoom?Math.min(y.clusterMaxZoom,this.maxzoom-1):this.maxzoom-1,minPoints:Math.max(2,y.clusterMinPoints||2),extent:v.EXTENT,radius:(y.clusterRadius||50)*L,log:!1,generateId:y.generateId||!1},clusterProperties:y.clusterProperties,filter:y.filter},y.workerOptions)}return l&&(p.__proto__=l),(p.prototype=Object.create(l&&l.prototype)).constructor=p,p.prototype.load=function(){var c=this;this.fire(new v.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(y){if(y)c.fire(new v.ErrorEvent(y));else{var C={dataType:"source",sourceDataType:"metadata"};c._collectResourceTiming&&c._resourceTiming&&c._resourceTiming.length>0&&(C.resourceTiming=c._resourceTiming,c._resourceTiming=[]),c.fire(new v.Event("data",C))}})},p.prototype.onAdd=function(c){this.map=c,this.load()},p.prototype.setData=function(c){var y=this;return this._data=c,this.fire(new v.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(C){if(C)y.fire(new v.ErrorEvent(C));else{var T={dataType:"source",sourceDataType:"content"};y._collectResourceTiming&&y._resourceTiming&&y._resourceTiming.length>0&&(T.resourceTiming=y._resourceTiming,y._resourceTiming=[]),y.fire(new v.Event("data",T))}}),this},p.prototype.getClusterExpansionZoom=function(c,y){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:c,source:this.id},y),this},p.prototype.getClusterChildren=function(c,y){return this.actor.send("geojson.getClusterChildren",{clusterId:c,source:this.id},y),this},p.prototype.getClusterLeaves=function(c,y,C,T){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:c,limit:y,offset:C},T),this},p.prototype._updateWorkerData=function(c){var y=this;this._loaded=!1;var C=v.extend({},this.workerOptions),T=this._data;"string"==typeof T?(C.request=this.map._requestManager.transformRequest(v.browser.resolveURL(T),v.ResourceType.Source),C.request.collectResourceTiming=this._collectResourceTiming):C.data=JSON.stringify(T),this.actor.send(this.type+".loadData",C,function(L,z){y._removed||z&&z.abandoned||(y._loaded=!0,z&&z.resourceTiming&&z.resourceTiming[y.id]&&(y._resourceTiming=z.resourceTiming[y.id].slice(0)),y.actor.send(y.type+".coalesce",{source:C.source},null),c(L))})},p.prototype.loaded=function(){return this._loaded},p.prototype.loadTile=function(c,y){var C=this,T=c.actor?"reloadTile":"loadTile";c.actor=this.actor,c.request=this.actor.send(T,{type:this.type,uid:c.uid,tileID:c.tileID,zoom:c.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:v.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId},function(L,z){return delete c.request,c.unloadVectorData(),c.aborted?y(null):L?y(L):(c.loadVectorData(z,C.map.painter,"reloadTile"===T),y(null))})},p.prototype.abortTile=function(c){c.request&&(c.request.cancel(),delete c.request),c.aborted=!0},p.prototype.unloadTile=function(c){c.unloadVectorData(),this.actor.send("removeTile",{uid:c.uid,type:this.type,source:this.id})},p.prototype.onRemove=function(){this._removed=!0,this.actor.send("removeSource",{type:this.type,source:this.id})},p.prototype.serialize=function(){return v.extend({},this._options,{type:this.type,data:this._data})},p.prototype.hasTransition=function(){return!1},p}(v.Evented),Kt=v.createLayout([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]),te=function(l){function p(c,y,C,T){l.call(this),this.id=c,this.dispatcher=C,this.coordinates=y.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(T),this.options=y}return l&&(p.__proto__=l),(p.prototype=Object.create(l&&l.prototype)).constructor=p,p.prototype.load=function(c,y){var C=this;this._loaded=!1,this.fire(new v.Event("dataloading",{dataType:"source"})),this.url=this.options.url,v.getImage(this.map._requestManager.transformRequest(this.url,v.ResourceType.Image),function(T,L){C._loaded=!0,T?C.fire(new v.ErrorEvent(T)):L&&(C.image=L,c&&(C.coordinates=c),y&&y(),C._finishLoading())})},p.prototype.loaded=function(){return this._loaded},p.prototype.updateImage=function(c){var y=this;return this.image&&c.url?(this.options.url=c.url,this.load(c.coordinates,function(){y.texture=null}),this):this},p.prototype._finishLoading=function(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new v.Event("data",{dataType:"source",sourceDataType:"metadata"})))},p.prototype.onAdd=function(c){this.map=c,this.load()},p.prototype.setCoordinates=function(c){var y=this;this.coordinates=c;var C=c.map(v.MercatorCoordinate.fromLngLat);this.tileID=function(L){for(var z=1/0,Z=1/0,H=-1/0,ut=-1/0,gt=0,ct=L;gt<ct.length;gt+=1){var zt=ct[gt];z=Math.min(z,zt.x),Z=Math.min(Z,zt.y),H=Math.max(H,zt.x),ut=Math.max(ut,zt.y)}var Rt=Math.max(H-z,ut-Z),Yt=Math.max(0,Math.floor(-Math.log(Rt)/Math.LN2)),Dt=Math.pow(2,Yt);return new v.CanonicalTileID(Yt,Math.floor((z+H)/2*Dt),Math.floor((Z+ut)/2*Dt))}(C),this.minzoom=this.maxzoom=this.tileID.z;var T=C.map(function(L){return y.tileID.getTilePoint(L)._round()});return this._boundsArray=new v.StructArrayLayout4i8,this._boundsArray.emplaceBack(T[0].x,T[0].y,0,0),this._boundsArray.emplaceBack(T[1].x,T[1].y,v.EXTENT,0),this._boundsArray.emplaceBack(T[3].x,T[3].y,0,v.EXTENT),this._boundsArray.emplaceBack(T[2].x,T[2].y,v.EXTENT,v.EXTENT),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new v.Event("data",{dataType:"source",sourceDataType:"content"})),this},p.prototype.prepare=function(){if(0!==Object.keys(this.tiles).length&&this.image){var c=this.map.painter.context,y=c.gl;for(var C in this.boundsBuffer||(this.boundsBuffer=c.createVertexBuffer(this._boundsArray,Kt.members)),this.boundsSegments||(this.boundsSegments=v.SegmentVector.simpleSegment(0,0,4,2)),this.texture||(this.texture=new v.Texture(c,this.image,y.RGBA),this.texture.bind(y.LINEAR,y.CLAMP_TO_EDGE)),this.tiles){var T=this.tiles[C];"loaded"!==T.state&&(T.state="loaded",T.texture=this.texture)}}},p.prototype.loadTile=function(c,y){this.tileID&&this.tileID.equals(c.tileID.canonical)?(this.tiles[String(c.tileID.wrap)]=c,c.buckets={},y(null)):(c.state="errored",y(null))},p.prototype.serialize=function(){return{type:"image",url:this.options.url,coordinates:this.coordinates}},p.prototype.hasTransition=function(){return!1},p}(v.Evented),vt=function(l){function p(c,y,C,T){l.call(this,c,y,C,T),this.roundZoom=!0,this.type="video",this.options=y}return l&&(p.__proto__=l),(p.prototype=Object.create(l&&l.prototype)).constructor=p,p.prototype.load=function(){var c=this;this._loaded=!1;var y=this.options;this.urls=[];for(var C=0,T=y.urls;C<T.length;C+=1)this.urls.push(this.map._requestManager.transformRequest(T[C],v.ResourceType.Source).url);v.getVideo(this.urls,function(L,z){c._loaded=!0,L?c.fire(new v.ErrorEvent(L)):z&&(c.video=z,c.video.loop=!0,c.video.addEventListener("playing",function(){c.map.triggerRepaint()}),c.map&&c.video.play(),c._finishLoading())})},p.prototype.pause=function(){this.video&&this.video.pause()},p.prototype.play=function(){this.video&&this.video.play()},p.prototype.seek=function(c){if(this.video){var y=this.video.seekable;c<y.start(0)||c>y.end(0)?this.fire(new v.ErrorEvent(new v.ValidationError("sources."+this.id,null,"Playback for this video can be set only between the "+y.start(0)+" and "+y.end(0)+"-second mark."))):this.video.currentTime=c}},p.prototype.getVideo=function(){return this.video},p.prototype.onAdd=function(c){this.map||(this.map=c,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))},p.prototype.prepare=function(){if(!(0===Object.keys(this.tiles).length||this.video.readyState<2)){var c=this.map.painter.context,y=c.gl;for(var C in this.boundsBuffer||(this.boundsBuffer=c.createVertexBuffer(this._boundsArray,Kt.members)),this.boundsSegments||(this.boundsSegments=v.SegmentVector.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(y.LINEAR,y.CLAMP_TO_EDGE),y.texSubImage2D(y.TEXTURE_2D,0,0,0,y.RGBA,y.UNSIGNED_BYTE,this.video)):(this.texture=new v.Texture(c,this.video,y.RGBA),this.texture.bind(y.LINEAR,y.CLAMP_TO_EDGE)),this.tiles){var T=this.tiles[C];"loaded"!==T.state&&(T.state="loaded",T.texture=this.texture)}}},p.prototype.serialize=function(){return{type:"video",urls:this.urls,coordinates:this.coordinates}},p.prototype.hasTransition=function(){return this.video&&!this.video.paused},p}(te),Se=function(l){function p(c,y,C,T){l.call(this,c,y,C,T),y.coordinates?Array.isArray(y.coordinates)&&4===y.coordinates.length&&!y.coordinates.some(function(L){return!Array.isArray(L)||2!==L.length||L.some(function(z){return"number"!=typeof z})})||this.fire(new v.ErrorEvent(new v.ValidationError("sources."+c,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new v.ErrorEvent(new v.ValidationError("sources."+c,null,'missing required property "coordinates"'))),y.animate&&"boolean"!=typeof y.animate&&this.fire(new v.ErrorEvent(new v.ValidationError("sources."+c,null,'optional "animate" property must be a boolean value'))),y.canvas?"string"==typeof y.canvas||y.canvas instanceof v.window.HTMLCanvasElement||this.fire(new v.ErrorEvent(new v.ValidationError("sources."+c,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new v.ErrorEvent(new v.ValidationError("sources."+c,null,'missing required property "canvas"'))),this.options=y,this.animate=void 0===y.animate||y.animate}return l&&(p.__proto__=l),(p.prototype=Object.create(l&&l.prototype)).constructor=p,p.prototype.load=function(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof v.window.HTMLCanvasElement?this.options.canvas:v.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new v.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())},p.prototype.getCanvas=function(){return this.canvas},p.prototype.onAdd=function(c){this.map=c,this.load(),this.canvas&&this.animate&&this.play()},p.prototype.onRemove=function(){this.pause()},p.prototype.prepare=function(){var c=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,c=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,c=!0),!this._hasInvalidDimensions()&&0!==Object.keys(this.tiles).length){var y=this.map.painter.context,C=y.gl;for(var T in this.boundsBuffer||(this.boundsBuffer=y.createVertexBuffer(this._boundsArray,Kt.members)),this.boundsSegments||(this.boundsSegments=v.SegmentVector.simpleSegment(0,0,4,2)),this.texture?(c||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new v.Texture(y,this.canvas,C.RGBA,{premultiply:!0}),this.tiles){var L=this.tiles[T];"loaded"!==L.state&&(L.state="loaded",L.texture=this.texture)}}},p.prototype.serialize=function(){return{type:"canvas",coordinates:this.coordinates}},p.prototype.hasTransition=function(){return this._playing},p.prototype._hasInvalidDimensions=function(){for(var c=0,y=[this.canvas.width,this.canvas.height];c<y.length;c+=1){var C=y[c];if(isNaN(C)||C<=0)return!0}return!1},p}(te),Fe={vector:Te,raster:Et,"raster-dem":ne,geojson:Pt,video:vt,image:te,canvas:Se};function wr(l,p){var c=v.identity([]);return v.translate(c,c,[1,1,0]),v.scale(c,c,[.5*l.width,.5*l.height,1]),v.multiply(c,c,l.calculatePosMatrix(p.toUnwrapped()))}function De(l,p,c,y,C,T){var L=function(Yt,Dt,Vt){if(Yt)for(var ee=0,he=Yt;ee<he.length;ee+=1){var _e=Dt[he[ee]];if(_e&&_e.source===Vt&&"fill-extrusion"===_e.type)return!0}else for(var ve in Dt){var we=Dt[ve];if(we.source===Vt&&"fill-extrusion"===we.type)return!0}return!1}(C&&C.layers,p,l.id),z=T.maxPitchScaleFactor(),Z=l.tilesIn(y,z,L);Z.sort(Xr);for(var H=[],ut=0,gt=Z;ut<gt.length;ut+=1){var ct=gt[ut];H.push({wrappedTileID:ct.tileID.wrapped().key,queryResults:ct.tile.queryRenderedFeatures(p,c,l._state,ct.queryGeometry,ct.cameraQueryGeometry,ct.scale,C,T,z,wr(l.transform,ct.tileID))})}var zt=function(Yt){for(var Dt={},Vt={},ee=0,he=Yt;ee<he.length;ee+=1){var _e=he[ee],ve=_e.queryResults,we=_e.wrappedTileID,Ne=Vt[we]=Vt[we]||{};for(var qe in ve)for(var ze=ve[qe],Ve=Ne[qe]=Ne[qe]||{},$e=Dt[qe]=Dt[qe]||[],rr=0,tr=ze;rr<tr.length;rr+=1){var Dr=tr[rr];Ve[Dr.featureIndex]||(Ve[Dr.featureIndex]=!0,$e.push(Dr))}}return Dt}(H);for(var Rt in zt)zt[Rt].forEach(function(Yt){var Dt=Yt.feature,Vt=l.getFeatureState(Dt.layer["source-layer"],Dt.id);Dt.source=Dt.layer.source,Dt.layer["source-layer"]&&(Dt.sourceLayer=Dt.layer["source-layer"]),Dt.state=Vt});return zt}function Xr(l,p){var c=l.tileID,y=p.tileID;return c.overscaledZ-y.overscaledZ||c.canonical.y-y.canonical.y||c.wrap-y.wrap||c.canonical.x-y.canonical.x}var Er=function(l,p){this.max=l,this.onRemove=p,this.reset()};Er.prototype.reset=function(){for(var l in this.data)for(var p=0,c=this.data[l];p<c.length;p+=1){var y=c[p];y.timeout&&clearTimeout(y.timeout),this.onRemove(y.value)}return this.data={},this.order=[],this},Er.prototype.add=function(l,p,c){var y=this,C=l.wrapped().key;void 0===this.data[C]&&(this.data[C]=[]);var T={value:p,timeout:void 0};if(void 0!==c&&(T.timeout=setTimeout(function(){y.remove(l,T)},c)),this.data[C].push(T),this.order.push(C),this.order.length>this.max){var L=this._getAndRemoveByKey(this.order[0]);L&&this.onRemove(L)}return this},Er.prototype.has=function(l){return l.wrapped().key in this.data},Er.prototype.getAndRemove=function(l){return this.has(l)?this._getAndRemoveByKey(l.wrapped().key):null},Er.prototype._getAndRemoveByKey=function(l){var p=this.data[l].shift();return p.timeout&&clearTimeout(p.timeout),0===this.data[l].length&&delete this.data[l],this.order.splice(this.order.indexOf(l),1),p.value},Er.prototype.getByKey=function(l){var p=this.data[l];return p?p[0].value:null},Er.prototype.get=function(l){return this.has(l)?this.data[l.wrapped().key][0].value:null},Er.prototype.remove=function(l,p){if(!this.has(l))return this;var c=l.wrapped().key,y=void 0===p?0:this.data[c].indexOf(p),C=this.data[c][y];return this.data[c].splice(y,1),C.timeout&&clearTimeout(C.timeout),0===this.data[c].length&&delete this.data[c],this.onRemove(C.value),this.order.splice(this.order.indexOf(c),1),this},Er.prototype.setMaxSize=function(l){for(this.max=l;this.order.length>this.max;){var p=this._getAndRemoveByKey(this.order[0]);p&&this.onRemove(p)}return this},Er.prototype.filter=function(l){var p=[];for(var c in this.data)for(var y=0,C=this.data[c];y<C.length;y+=1){var T=C[y];l(T.value)||p.push(T)}for(var L=0,z=p;L<z.length;L+=1){var Z=z[L];this.remove(Z.value.tileID,Z)}};var Yr=function(l,p,c){this.context=l;var y=l.gl;this.buffer=y.createBuffer(),this.dynamicDraw=Boolean(c),this.context.unbindVAO(),l.bindElementBuffer.set(this.buffer),y.bufferData(y.ELEMENT_ARRAY_BUFFER,p.arrayBuffer,this.dynamicDraw?y.DYNAMIC_DRAW:y.STATIC_DRAW),this.dynamicDraw||delete p.arrayBuffer};Yr.prototype.bind=function(){this.context.bindElementBuffer.set(this.buffer)},Yr.prototype.updateData=function(l){var p=this.context.gl;this.context.unbindVAO(),this.bind(),p.bufferSubData(p.ELEMENT_ARRAY_BUFFER,0,l.arrayBuffer)},Yr.prototype.destroy=function(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)};var Cr={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"},Mr=function(l,p,c,y){this.length=p.length,this.attributes=c,this.itemSize=p.bytesPerElement,this.dynamicDraw=y,this.context=l;var C=l.gl;this.buffer=C.createBuffer(),l.bindVertexBuffer.set(this.buffer),C.bufferData(C.ARRAY_BUFFER,p.arrayBuffer,this.dynamicDraw?C.DYNAMIC_DRAW:C.STATIC_DRAW),this.dynamicDraw||delete p.arrayBuffer};Mr.prototype.bind=function(){this.context.bindVertexBuffer.set(this.buffer)},Mr.prototype.updateData=function(l){var p=this.context.gl;this.bind(),p.bufferSubData(p.ARRAY_BUFFER,0,l.arrayBuffer)},Mr.prototype.enableAttributes=function(l,p){for(var c=0;c<this.attributes.length;c++){var y=p.attributes[this.attributes[c].name];void 0!==y&&l.enableVertexAttribArray(y)}},Mr.prototype.setVertexAttribPointers=function(l,p,c){for(var y=0;y<this.attributes.length;y++){var C=this.attributes[y],T=p.attributes[C.name];void 0!==T&&l.vertexAttribPointer(T,C.components,l[Cr[C.type]],!1,this.itemSize,C.offset+this.itemSize*(c||0))}},Mr.prototype.destroy=function(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)};var Be=function(l){this.gl=l.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1};Be.prototype.get=function(){return this.current},Be.prototype.set=function(l){},Be.prototype.getDefault=function(){return this.default},Be.prototype.setDefault=function(){this.set(this.default)};var ti=function(l){function p(){l.apply(this,arguments)}return l&&(p.__proto__=l),(p.prototype=Object.create(l&&l.prototype)).constructor=p,p.prototype.getDefault=function(){return v.Color.transparent},p.prototype.set=function(c){var y=this.current;(c.r!==y.r||c.g!==y.g||c.b!==y.b||c.a!==y.a||this.dirty)&&(this.gl.clearColor(c.r,c.g,c.b,c.a),this.current=c,this.dirty=!1)},p}(Be),In=function(l){function p(){l.apply(this,arguments)}return l&&(p.__proto__=l),(p.prototype=Object.create(l&&l.prototype)).constructor=p,p.prototype.getDefault=function(){return 1},p.prototype.set=function(c){(c!==this.current||this.dirty)&&(this.gl.clearDepth(c),this.current=c,this.dirty=!1)},p}(Be),$n=function(l){function p(){l.apply(this,arguments)}return l&&(p.__proto__=l),(p.prototype=Object.create(l&&l.prototype)).constructor=p,p.prototype.getDefault=function(){return 0},p.prototype.set=function(c){(c!==this.current||this.dirty)&&(this.gl.clearStencil(c),this.current=c,this.dirty=!1)},p}(Be),li=function(l){function p(){l.apply(this,arguments)}return l&&(p.__proto__=l),(p.prototype=Object.create(l&&l.prototype)).constructor=p,p.prototype.getDefault=function(){return[!0,!0,!0,!0]},p.prototype.set=function(c){var y=this.current;(c[0]!==y[0]||c[1]!==y[1]||c[2]!==y[2]||c[3]!==y[3]||this.dirty)&&(this.gl.colorMask(c[0],c[1],c[2],c[3]),this.current=c,this.dirty=!1)},p}(Be),fi=function(l){function p(){l.apply(this,arguments)}return l&&(p.__proto__=l),(p.prototype=Object.create(l&&l.prototype)).constructor=p,p.prototype.getDefault=function(){return!0},p.prototype.set=function(c){(c!==this.current||this.dirty)&&(this.gl.depthMask(c),this.current=c,this.dirty=!1)},p}(Be),ae=function(l){function p(){l.apply(this,arguments)}return l&&(p.__proto__=l),(p.prototype=Object.create(l&&l.prototype)).constructor=p,p.prototype.getDefault=function(){return 255},p.prototype.set=function(c){(c!==this.current||this.dirty)&&(this.gl.stencilMask(c),this.current=c,this.dirty=!1)},p}(Be),st=function(l){function p(){l.apply(this,arguments)}return l&&(p.__proto__=l),(p.prototype=Object.create(l&&l.prototype)).constructor=p,p.prototype.getDefault=function(){return{func:this.gl.ALWAYS,ref:0,mask:255}},p.prototype.set=function(c){var y=this.current;(c.func!==y.func||c.ref!==y.ref||c.mask!==y.mask||this.dirty)&&(this.gl.stencilFunc(c.func,c.ref,c.mask),this.current=c,this.dirty=!1)},p}(Be),rt=function(l){function p(){l.apply(this,arguments)}return l&&(p.__proto__=l),(p.prototype=Object.create(l&&l.prototype)).constructor=p,p.prototype.getDefault=function(){var c=this.gl;return[c.KEEP,c.KEEP,c.KEEP]},p.prototype.set=function(c){var y=this.current;(c[0]!==y[0]||c[1]!==y[1]||c[2]!==y[2]||this.dirty)&&(this.gl.stencilOp(c[0],c[1],c[2]),this.current=c,this.dirty=!1)},p}(Be),$=function(l){function p(){l.apply(this,arguments)}return l&&(p.__proto__=l),(p.prototype=Object.create(l&&l.prototype)).constructor=p,p.prototype.getDefault=function(){return!1},p.prototype.set=function(c){if(c!==this.current||this.dirty){var y=this.gl;c?y.enable(y.STENCIL_TEST):y.disable(y.STENCIL_TEST),this.current=c,this.dirty=!1}},p}(Be),Tt=function(l){function p(){l.apply(this,arguments)}return l&&(p.__proto__=l),(p.prototype=Object.create(l&&l.prototype)).constructor=p,p.prototype.getDefault=function(){return[0,1]},p.prototype.set=function(c){var y=this.current;(c[0]!==y[0]||c[1]!==y[1]||this.dirty)&&(this.gl.depthRange(c[0],c[1]),this.current=c,this.dirty=!1)},p}(Be),Jt=function(l){function p(){l.apply(this,arguments)}return l&&(p.__proto__=l),(p.prototype=Object.create(l&&l.prototype)).constructor=p,p.prototype.getDefault=function(){return!1},p.prototype.set=function(c){if(c!==this.current||this.dirty){var y=this.gl;c?y.enable(y.DEPTH_TEST):y.disable(y.DEPTH_TEST),this.current=c,this.dirty=!1}},p}(Be),Ee=function(l){function p(){l.apply(this,arguments)}return l&&(p.__proto__=l),(p.prototype=Object.create(l&&l.prototype)).constructor=p,p.prototype.getDefault=function(){return this.gl.LESS},p.prototype.set=function(c){(c!==this.current||this.dirty)&&(this.gl.depthFunc(c),this.current=c,this.dirty=!1)},p}(Be),Ge=function(l){function p(){l.apply(this,arguments)}return l&&(p.__proto__=l),(p.prototype=Object.create(l&&l.prototype)).constructor=p,p.prototype.getDefault=function(){return!1},p.prototype.set=function(c){if(c!==this.current||this.dirty){var y=this.gl;c?y.enable(y.BLEND):y.disable(y.BLEND),this.current=c,this.dirty=!1}},p}(Be),We=function(l){function p(){l.apply(this,arguments)}return l&&(p.__proto__=l),(p.prototype=Object.create(l&&l.prototype)).constructor=p,p.prototype.getDefault=function(){var c=this.gl;return[c.ONE,c.ZERO]},p.prototype.set=function(c){var y=this.current;(c[0]!==y[0]||c[1]!==y[1]||this.dirty)&&(this.gl.blendFunc(c[0],c[1]),this.current=c,this.dirty=!1)},p}(Be),Le=function(l){function p(){l.apply(this,arguments)}return l&&(p.__proto__=l),(p.prototype=Object.create(l&&l.prototype)).constructor=p,p.prototype.getDefault=function(){return v.Color.transparent},p.prototype.set=function(c){var y=this.current;(c.r!==y.r||c.g!==y.g||c.b!==y.b||c.a!==y.a||this.dirty)&&(this.gl.blendColor(c.r,c.g,c.b,c.a),this.current=c,this.dirty=!1)},p}(Be),tn=function(l){function p(){l.apply(this,arguments)}return l&&(p.__proto__=l),(p.prototype=Object.create(l&&l.prototype)).constructor=p,p.prototype.getDefault=function(){return this.gl.FUNC_ADD},p.prototype.set=function(c){(c!==this.current||this.dirty)&&(this.gl.blendEquation(c),this.current=c,this.dirty=!1)},p}(Be),gn=function(l){function p(){l.apply(this,arguments)}return l&&(p.__proto__=l),(p.prototype=Object.create(l&&l.prototype)).constructor=p,p.prototype.getDefault=function(){return!1},p.prototype.set=function(c){if(c!==this.current||this.dirty){var y=this.gl;c?y.enable(y.CULL_FACE):y.disable(y.CULL_FACE),this.current=c,this.dirty=!1}},p}(Be),sr=function(l){function p(){l.apply(this,arguments)}return l&&(p.__proto__=l),(p.prototype=Object.create(l&&l.prototype)).constructor=p,p.prototype.getDefault=function(){return this.gl.BACK},p.prototype.set=function(c){(c!==this.current||this.dirty)&&(this.gl.cullFace(c),this.current=c,this.dirty=!1)},p}(Be),vn=function(l){function p(){l.apply(this,arguments)}return l&&(p.__proto__=l),(p.prototype=Object.create(l&&l.prototype)).constructor=p,p.prototype.getDefault=function(){return this.gl.CCW},p.prototype.set=function(c){(c!==this.current||this.dirty)&&(this.gl.frontFace(c),this.current=c,this.dirty=!1)},p}(Be),Bn=function(l){function p(){l.apply(this,arguments)}return l&&(p.__proto__=l),(p.prototype=Object.create(l&&l.prototype)).constructor=p,p.prototype.getDefault=function(){return null},p.prototype.set=function(c){(c!==this.current||this.dirty)&&(this.gl.useProgram(c),this.current=c,this.dirty=!1)},p}(Be),Dn=function(l){function p(){l.apply(this,arguments)}return l&&(p.__proto__=l),(p.prototype=Object.create(l&&l.prototype)).constructor=p,p.prototype.getDefault=function(){return this.gl.TEXTURE0},p.prototype.set=function(c){(c!==this.current||this.dirty)&&(this.gl.activeTexture(c),this.current=c,this.dirty=!1)},p}(Be),Rn=function(l){function p(){l.apply(this,arguments)}return l&&(p.__proto__=l),(p.prototype=Object.create(l&&l.prototype)).constructor=p,p.prototype.getDefault=function(){var c=this.gl;return[0,0,c.drawingBufferWidth,c.drawingBufferHeight]},p.prototype.set=function(c){var y=this.current;(c[0]!==y[0]||c[1]!==y[1]||c[2]!==y[2]||c[3]!==y[3]||this.dirty)&&(this.gl.viewport(c[0],c[1],c[2],c[3]),this.current=c,this.dirty=!1)},p}(Be),Ii=function(l){function p(){l.apply(this,arguments)}return l&&(p.__proto__=l),(p.prototype=Object.create(l&&l.prototype)).constructor=p,p.prototype.getDefault=function(){return null},p.prototype.set=function(c){if(c!==this.current||this.dirty){var y=this.gl;y.bindFramebuffer(y.FRAMEBUFFER,c),this.current=c,this.dirty=!1}},p}(Be),Gi=function(l){function p(){l.apply(this,arguments)}return l&&(p.__proto__=l),(p.prototype=Object.create(l&&l.prototype)).constructor=p,p.prototype.getDefault=function(){return null},p.prototype.set=function(c){if(c!==this.current||this.dirty){var y=this.gl;y.bindRenderbuffer(y.RENDERBUFFER,c),this.current=c,this.dirty=!1}},p}(Be),vo=function(l){function p(){l.apply(this,arguments)}return l&&(p.__proto__=l),(p.prototype=Object.create(l&&l.prototype)).constructor=p,p.prototype.getDefault=function(){return null},p.prototype.set=function(c){if(c!==this.current||this.dirty){var y=this.gl;y.bindTexture(y.TEXTURE_2D,c),this.current=c,this.dirty=!1}},p}(Be),Yi=function(l){function p(){l.apply(this,arguments)}return l&&(p.__proto__=l),(p.prototype=Object.create(l&&l.prototype)).constructor=p,p.prototype.getDefault=function(){return null},p.prototype.set=function(c){if(c!==this.current||this.dirty){var y=this.gl;y.bindBuffer(y.ARRAY_BUFFER,c),this.current=c,this.dirty=!1}},p}(Be),lo=function(l){function p(){l.apply(this,arguments)}return l&&(p.__proto__=l),(p.prototype=Object.create(l&&l.prototype)).constructor=p,p.prototype.getDefault=function(){return null},p.prototype.set=function(c){var y=this.gl;y.bindBuffer(y.ELEMENT_ARRAY_BUFFER,c),this.current=c,this.dirty=!1},p}(Be),ei=function(l){function p(c){l.call(this,c),this.vao=c.extVertexArrayObject}return l&&(p.__proto__=l),(p.prototype=Object.create(l&&l.prototype)).constructor=p,p.prototype.getDefault=function(){return null},p.prototype.set=function(c){this.vao&&(c!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(c),this.current=c,this.dirty=!1)},p}(Be),_o=function(l){function p(){l.apply(this,arguments)}return l&&(p.__proto__=l),(p.prototype=Object.create(l&&l.prototype)).constructor=p,p.prototype.getDefault=function(){return 4},p.prototype.set=function(c){if(c!==this.current||this.dirty){var y=this.gl;y.pixelStorei(y.UNPACK_ALIGNMENT,c),this.current=c,this.dirty=!1}},p}(Be),ki=function(l){function p(){l.apply(this,arguments)}return l&&(p.__proto__=l),(p.prototype=Object.create(l&&l.prototype)).constructor=p,p.prototype.getDefault=function(){return!1},p.prototype.set=function(c){if(c!==this.current||this.dirty){var y=this.gl;y.pixelStorei(y.UNPACK_PREMULTIPLY_ALPHA_WEBGL,c),this.current=c,this.dirty=!1}},p}(Be),Je=function(l){function p(){l.apply(this,arguments)}return l&&(p.__proto__=l),(p.prototype=Object.create(l&&l.prototype)).constructor=p,p.prototype.getDefault=function(){return!1},p.prototype.set=function(c){if(c!==this.current||this.dirty){var y=this.gl;y.pixelStorei(y.UNPACK_FLIP_Y_WEBGL,c),this.current=c,this.dirty=!1}},p}(Be),di=function(l){function p(c,y){l.call(this,c),this.context=c,this.parent=y}return l&&(p.__proto__=l),(p.prototype=Object.create(l&&l.prototype)).constructor=p,p.prototype.getDefault=function(){return null},p}(Be),V=function(l){function p(){l.apply(this,arguments)}return l&&(p.__proto__=l),(p.prototype=Object.create(l&&l.prototype)).constructor=p,p.prototype.setDirty=function(){this.dirty=!0},p.prototype.set=function(c){if(c!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var y=this.gl;y.framebufferTexture2D(y.FRAMEBUFFER,y.COLOR_ATTACHMENT0,y.TEXTURE_2D,c,0),this.current=c,this.dirty=!1}},p}(di),Y=function(l){function p(){l.apply(this,arguments)}return l&&(p.__proto__=l),(p.prototype=Object.create(l&&l.prototype)).constructor=p,p.prototype.set=function(c){if(c!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var y=this.gl;y.framebufferRenderbuffer(y.FRAMEBUFFER,y.DEPTH_ATTACHMENT,y.RENDERBUFFER,c),this.current=c,this.dirty=!1}},p}(di),it=function(l,p,c,y){this.context=l,this.width=p,this.height=c;var C=this.framebuffer=l.gl.createFramebuffer();this.colorAttachment=new V(l,C),y&&(this.depthAttachment=new Y(l,C))};it.prototype.destroy=function(){var l=this.context.gl,p=this.colorAttachment.get();if(p&&l.deleteTexture(p),this.depthAttachment){var c=this.depthAttachment.get();c&&l.deleteRenderbuffer(c)}l.deleteFramebuffer(this.framebuffer)};var ht=function(l,p,c){this.func=l,this.mask=p,this.range=c};ht.ReadOnly=!1,ht.ReadWrite=!0,ht.disabled=new ht(519,ht.ReadOnly,[0,1]);var Lt=function(l,p,c,y,C,T){this.test=l,this.ref=p,this.mask=c,this.fail=y,this.depthFail=C,this.pass=T};Lt.disabled=new Lt({func:519,mask:0},0,0,7680,7680,7680);var Wt=function(l,p,c){this.blendFunction=l,this.blendColor=p,this.mask=c};Wt.disabled=new Wt(Wt.Replace=[1,0],v.Color.transparent,[!1,!1,!1,!1]),Wt.unblended=new Wt(Wt.Replace,v.Color.transparent,[!0,!0,!0,!0]),Wt.alphaBlended=new Wt([1,771],v.Color.transparent,[!0,!0,!0,!0]);var ie=function(l,p,c){this.enable=l,this.mode=p,this.frontFace=c};ie.disabled=new ie(!1,1029,2305),ie.backCCW=new ie(!0,1029,2305);var Ht=function(l){this.gl=l,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),this.clearColor=new ti(this),this.clearDepth=new In(this),this.clearStencil=new $n(this),this.colorMask=new li(this),this.depthMask=new fi(this),this.stencilMask=new ae(this),this.stencilFunc=new st(this),this.stencilOp=new rt(this),this.stencilTest=new $(this),this.depthRange=new Tt(this),this.depthTest=new Jt(this),this.depthFunc=new Ee(this),this.blend=new Ge(this),this.blendFunc=new We(this),this.blendColor=new Le(this),this.blendEquation=new tn(this),this.cullFace=new gn(this),this.cullFaceSide=new sr(this),this.frontFace=new vn(this),this.program=new Bn(this),this.activeTexture=new Dn(this),this.viewport=new Rn(this),this.bindFramebuffer=new Ii(this),this.bindRenderbuffer=new Gi(this),this.bindTexture=new vo(this),this.bindVertexBuffer=new Yi(this),this.bindElementBuffer=new lo(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new ei(this),this.pixelStoreUnpack=new _o(this),this.pixelStoreUnpackPremultiplyAlpha=new ki(this),this.pixelStoreUnpackFlipY=new Je(this),this.extTextureFilterAnisotropic=l.getExtension("EXT_texture_filter_anisotropic")||l.getExtension("MOZ_EXT_texture_filter_anisotropic")||l.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=l.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureHalfFloat=l.getExtension("OES_texture_half_float"),this.extTextureHalfFloat&&(l.getExtension("OES_texture_half_float_linear"),this.extRenderToTextureHalfFloat=l.getExtension("EXT_color_buffer_half_float")),this.extTimerQuery=l.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=l.getParameter(l.MAX_TEXTURE_SIZE)};Ht.prototype.setDefault=function(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()},Ht.prototype.setDirty=function(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0},Ht.prototype.createIndexBuffer=function(l,p){return new Yr(this,l,p)},Ht.prototype.createVertexBuffer=function(l,p,c){return new Mr(this,l,p,c)},Ht.prototype.createRenderbuffer=function(l,p,c){var y=this.gl,C=y.createRenderbuffer();return this.bindRenderbuffer.set(C),y.renderbufferStorage(y.RENDERBUFFER,l,p,c),this.bindRenderbuffer.set(null),C},Ht.prototype.createFramebuffer=function(l,p,c){return new it(this,l,p,c)},Ht.prototype.clear=function(l){var p=l.color,c=l.depth,y=this.gl,C=0;p&&(C|=y.COLOR_BUFFER_BIT,this.clearColor.set(p),this.colorMask.set([!0,!0,!0,!0])),void 0!==c&&(C|=y.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(c),this.depthMask.set(!0)),y.clear(C)},Ht.prototype.setCullFace=function(l){!1===l.enable?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(l.mode),this.frontFace.set(l.frontFace))},Ht.prototype.setDepthMode=function(l){l.func!==this.gl.ALWAYS||l.mask?(this.depthTest.set(!0),this.depthFunc.set(l.func),this.depthMask.set(l.mask),this.depthRange.set(l.range)):this.depthTest.set(!1)},Ht.prototype.setStencilMode=function(l){l.test.func!==this.gl.ALWAYS||l.mask?(this.stencilTest.set(!0),this.stencilMask.set(l.mask),this.stencilOp.set([l.fail,l.depthFail,l.pass]),this.stencilFunc.set({func:l.test.func,ref:l.ref,mask:l.test.mask})):this.stencilTest.set(!1)},Ht.prototype.setColorMode=function(l){v.deepEqual(l.blendFunction,Wt.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(l.blendFunction),this.blendColor.set(l.blendColor)),this.colorMask.set(l.mask)},Ht.prototype.unbindVAO=function(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)};var _t=function(l){function p(c,y,C){var T=this;l.call(this),this.id=c,this.dispatcher=C,this.on("data",function(L){"source"===L.dataType&&"metadata"===L.sourceDataType&&(T._sourceLoaded=!0),T._sourceLoaded&&!T._paused&&"source"===L.dataType&&"content"===L.sourceDataType&&(T.reload(),T.transform&&T.update(T.transform))}),this.on("error",function(){T._sourceErrored=!0}),this._source=function(L,z,Z,H){var ut=new Fe[z.type](L,z,Z,H);if(ut.id!==L)throw new Error("Expected Source id to be "+L+" instead of "+ut.id);return v.bindAll(["load","abort","unload","serialize","prepare"],ut),ut}(c,y,C,this),this._tiles={},this._cache=new Er(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new v.SourceFeatureState}return l&&(p.__proto__=l),(p.prototype=Object.create(l&&l.prototype)).constructor=p,p.prototype.onAdd=function(c){this.map=c,this._maxTileCacheSize=c?c._maxTileCacheSize:null,this._source&&this._source.onAdd&&this._source.onAdd(c)},p.prototype.onRemove=function(c){this._source&&this._source.onRemove&&this._source.onRemove(c)},p.prototype.loaded=function(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(var c in this._tiles){var y=this._tiles[c];if("loaded"!==y.state&&"errored"!==y.state)return!1}return!0},p.prototype.getSource=function(){return this._source},p.prototype.pause=function(){this._paused=!0},p.prototype.resume=function(){if(this._paused){var c=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,c&&this.reload(),this.transform&&this.update(this.transform)}},p.prototype._loadTile=function(c,y){return this._source.loadTile(c,y)},p.prototype._unloadTile=function(c){if(this._source.unloadTile)return this._source.unloadTile(c,function(){})},p.prototype._abortTile=function(c){if(this._source.abortTile)return this._source.abortTile(c,function(){})},p.prototype.serialize=function(){return this._source.serialize()},p.prototype.prepare=function(c){for(var y in this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null),this._tiles){var C=this._tiles[y];C.upload(c),C.prepare(this.map.style.imageManager)}},p.prototype.getIds=function(){return v.values(this._tiles).map(function(c){return c.tileID}).sort(Ut).map(function(c){return c.key})},p.prototype.getRenderableIds=function(c){var y=this,C=[];for(var T in this._tiles)this._isIdRenderable(T,c)&&C.push(this._tiles[T]);return c?C.sort(function(L,z){var Z=L.tileID,H=z.tileID,ut=new v.Point(Z.canonical.x,Z.canonical.y)._rotate(y.transform.angle),gt=new v.Point(H.canonical.x,H.canonical.y)._rotate(y.transform.angle);return Z.overscaledZ-H.overscaledZ||gt.y-ut.y||gt.x-ut.x}).map(function(L){return L.tileID.key}):C.map(function(L){return L.tileID}).sort(Ut).map(function(L){return L.key})},p.prototype.hasRenderableParent=function(c){var y=this.findLoadedParent(c,0);return!!y&&this._isIdRenderable(y.tileID.key)},p.prototype._isIdRenderable=function(c,y){return this._tiles[c]&&this._tiles[c].hasData()&&!this._coveredTiles[c]&&(y||!this._tiles[c].holdingForFade())},p.prototype.reload=function(){if(this._paused)this._shouldReloadOnResume=!0;else for(var c in this._cache.reset(),this._tiles)"errored"!==this._tiles[c].state&&this._reloadTile(c,"reloading")},p.prototype._reloadTile=function(c,y){var C=this._tiles[c];C&&("loading"!==C.state&&(C.state=y),this._loadTile(C,this._tileLoaded.bind(this,C,c,y)))},p.prototype._tileLoaded=function(c,y,C,T){if(T)return c.state="errored",void(404!==T.status?this._source.fire(new v.ErrorEvent(T,{tile:c})):this.update(this.transform));c.timeAdded=v.browser.now(),"expired"===C&&(c.refreshedUponExpiration=!0),this._setTileReloadTimer(y,c),"raster-dem"===this.getSource().type&&c.dem&&this._backfillDEM(c),this._state.initializeTileState(c,this.map?this.map.painter:null),this._source.fire(new v.Event("data",{dataType:"source",tile:c,coord:c.tileID}))},p.prototype._backfillDEM=function(c){for(var y=this.getRenderableIds(),C=0;C<y.length;C++){var T=y[C];if(c.neighboringTiles&&c.neighboringTiles[T]){var L=this.getTileByID(T);z(c,L),z(L,c)}}function z(Z,H){Z.needsHillshadePrepare=!0;var ut=H.tileID.canonical.x-Z.tileID.canonical.x,gt=H.tileID.canonical.y-Z.tileID.canonical.y,ct=Math.pow(2,Z.tileID.canonical.z),zt=H.tileID.key;0===ut&&0===gt||Math.abs(gt)>1||(Math.abs(ut)>1&&(1===Math.abs(ut+ct)?ut+=ct:1===Math.abs(ut-ct)&&(ut-=ct)),H.dem&&Z.dem&&(Z.dem.backfillBorder(H.dem,ut,gt),Z.neighboringTiles&&Z.neighboringTiles[zt]&&(Z.neighboringTiles[zt].backfilled=!0)))}},p.prototype.getTile=function(c){return this.getTileByID(c.key)},p.prototype.getTileByID=function(c){return this._tiles[c]},p.prototype._retainLoadedChildren=function(c,y,C,T){for(var L in this._tiles){var z=this._tiles[L];if(!(T[L]||!z.hasData()||z.tileID.overscaledZ<=y||z.tileID.overscaledZ>C)){for(var Z=z.tileID;z&&z.tileID.overscaledZ>y+1;){var H=z.tileID.scaledTo(z.tileID.overscaledZ-1);(z=this._tiles[H.key])&&z.hasData()&&(Z=H)}for(var ut=Z;ut.overscaledZ>y;)if(c[(ut=ut.scaledTo(ut.overscaledZ-1)).key]){T[Z.key]=Z;break}}}},p.prototype.findLoadedParent=function(c,y){if(c.key in this._loadedParentTiles){var C=this._loadedParentTiles[c.key];return C&&C.tileID.overscaledZ>=y?C:null}for(var T=c.overscaledZ-1;T>=y;T--){var L=c.scaledTo(T),z=this._getLoadedTile(L);if(z)return z}},p.prototype._getLoadedTile=function(c){var y=this._tiles[c.key];return y&&y.hasData()?y:this._cache.getByKey(c.wrapped().key)},p.prototype.updateCacheSize=function(c){var y=Math.ceil(c.width/this._source.tileSize)+1,C=Math.ceil(c.height/this._source.tileSize)+1,T=Math.floor(y*C*5),L="number"==typeof this._maxTileCacheSize?Math.min(this._maxTileCacheSize,T):T;this._cache.setMaxSize(L)},p.prototype.handleWrapJump=function(c){var y=Math.round((c-(void 0===this._prevLng?c:this._prevLng))/360);if(this._prevLng=c,y){var C={};for(var T in this._tiles){var L=this._tiles[T];L.tileID=L.tileID.unwrapTo(L.tileID.wrap+y),C[L.tileID.key]=L}for(var z in this._tiles=C,this._timers)clearTimeout(this._timers[z]),delete this._timers[z];for(var Z in this._tiles)this._setTileReloadTimer(Z,this._tiles[Z])}},p.prototype.update=function(c){var y=this;if(this.transform=c,this._sourceLoaded&&!this._paused){var C;this.updateCacheSize(c),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used?this._source.tileID?C=c.getVisibleUnwrappedCoordinates(this._source.tileID).map(function(Ne){return new v.OverscaledTileID(Ne.canonical.z,Ne.wrap,Ne.canonical.z,Ne.canonical.x,Ne.canonical.y)}):(C=c.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}),this._source.hasTile&&(C=C.filter(function(Ne){return y._source.hasTile(Ne)}))):C=[];var T=c.coveringZoomLevel(this._source),L=Math.max(T-p.maxOverzooming,this._source.minzoom),z=Math.max(T+p.maxUnderzooming,this._source.minzoom),Z=this._updateRetainedTiles(C,T);if(je(this._source.type)){for(var H={},ut={},gt=0,ct=Object.keys(Z);gt<ct.length;gt+=1){var zt=ct[gt],Rt=Z[zt],Yt=this._tiles[zt];if(Yt&&!(Yt.fadeEndTime&&Yt.fadeEndTime<=v.browser.now())){var Dt=this.findLoadedParent(Rt,L);Dt&&(this._addTile(Dt.tileID),H[Dt.tileID.key]=Dt.tileID),ut[zt]=Rt}}for(var Vt in this._retainLoadedChildren(ut,T,z,Z),H)Z[Vt]||(this._coveredTiles[Vt]=!0,Z[Vt]=H[Vt])}for(var ee in Z)this._tiles[ee].clearFadeHold();for(var he=0,_e=v.keysDifference(this._tiles,Z);he<_e.length;he+=1){var ve=_e[he],we=this._tiles[ve];we.hasSymbolBuckets&&!we.holdingForFade()?we.setHoldDuration(this.map._fadeDuration):we.hasSymbolBuckets&&!we.symbolFadeFinished()||this._removeTile(ve)}this._updateLoadedParentTileCache()}},p.prototype.releaseSymbolFadeTiles=function(){for(var c in this._tiles)this._tiles[c].holdingForFade()&&this._removeTile(c)},p.prototype._updateRetainedTiles=function(c,y){for(var C={},T={},L=Math.max(y-p.maxOverzooming,this._source.minzoom),z=Math.max(y+p.maxUnderzooming,this._source.minzoom),Z={},H=0,ut=c;H<ut.length;H+=1){var gt=ut[H],ct=this._addTile(gt);C[gt.key]=gt,ct.hasData()||y<this._source.maxzoom&&(Z[gt.key]=gt)}this._retainLoadedChildren(Z,y,z,C);for(var zt=0,Rt=c;zt<Rt.length;zt+=1){var Yt=Rt[zt],Dt=this._tiles[Yt.key];if(!Dt.hasData()){if(y+1>this._source.maxzoom){var Vt=Yt.children(this._source.maxzoom)[0],ee=this.getTile(Vt);if(ee&&ee.hasData()){C[Vt.key]=Vt;continue}}else{var he=Yt.children(this._source.maxzoom);if(C[he[0].key]&&C[he[1].key]&&C[he[2].key]&&C[he[3].key])continue}for(var _e=Dt.wasRequested(),ve=Yt.overscaledZ-1;ve>=L;--ve){var we=Yt.scaledTo(ve);if(T[we.key]||(T[we.key]=!0,!(Dt=this.getTile(we))&&_e&&(Dt=this._addTile(we)),Dt&&(C[we.key]=we,_e=Dt.wasRequested(),Dt.hasData())))break}}}return C},p.prototype._updateLoadedParentTileCache=function(){for(var c in this._loadedParentTiles={},this._tiles){for(var y=[],C=void 0,T=this._tiles[c].tileID;T.overscaledZ>0;){if(T.key in this._loadedParentTiles){C=this._loadedParentTiles[T.key];break}y.push(T.key);var L=T.scaledTo(T.overscaledZ-1);if(C=this._getLoadedTile(L))break;T=L}for(var z=0,Z=y;z<Z.length;z+=1)this._loadedParentTiles[Z[z]]=C}},p.prototype._addTile=function(c){var y=this._tiles[c.key];if(y)return y;(y=this._cache.getAndRemove(c))&&(this._setTileReloadTimer(c.key,y),y.tileID=c,this._state.initializeTileState(y,this.map?this.map.painter:null),this._cacheTimers[c.key]&&(clearTimeout(this._cacheTimers[c.key]),delete this._cacheTimers[c.key],this._setTileReloadTimer(c.key,y)));var C=Boolean(y);return C||(y=new v.Tile(c,this._source.tileSize*c.overscaleFactor()),this._loadTile(y,this._tileLoaded.bind(this,y,c.key,y.state))),y?(y.uses++,this._tiles[c.key]=y,C||this._source.fire(new v.Event("dataloading",{tile:y,coord:y.tileID,dataType:"source"})),y):null},p.prototype._setTileReloadTimer=function(c,y){var C=this;c in this._timers&&(clearTimeout(this._timers[c]),delete this._timers[c]);var T=y.getExpiryTimeout();T&&(this._timers[c]=setTimeout(function(){C._reloadTile(c,"expired"),delete C._timers[c]},T))},p.prototype._removeTile=function(c){var y=this._tiles[c];y&&(y.uses--,delete this._tiles[c],this._timers[c]&&(clearTimeout(this._timers[c]),delete this._timers[c]),y.uses>0||(y.hasData()&&"reloading"!==y.state?this._cache.add(y.tileID,y,y.getExpiryTimeout()):(y.aborted=!0,this._abortTile(y),this._unloadTile(y))))},p.prototype.clearTiles=function(){for(var c in this._shouldReloadOnResume=!1,this._paused=!1,this._tiles)this._removeTile(c);this._cache.reset()},p.prototype.tilesIn=function(c,y,C){var T=this,L=[],z=this.transform;if(!z)return L;for(var Z=C?z.getCameraQueryGeometry(c):c,H=c.map(function(ve){return z.pointCoordinate(ve)}),ut=Z.map(function(ve){return z.pointCoordinate(ve)}),gt=this.getIds(),ct=1/0,zt=1/0,Rt=-1/0,Yt=-1/0,Dt=0,Vt=ut;Dt<Vt.length;Dt+=1){var ee=Vt[Dt];ct=Math.min(ct,ee.x),zt=Math.min(zt,ee.y),Rt=Math.max(Rt,ee.x),Yt=Math.max(Yt,ee.y)}for(var he=function(ve){var we=T._tiles[gt[ve]];if(!we.holdingForFade()){var Ne=we.tileID,qe=Math.pow(2,z.zoom-we.tileID.overscaledZ),ze=y*we.queryPadding*v.EXTENT/we.tileSize/qe,Ve=[Ne.getTilePoint(new v.MercatorCoordinate(ct,zt)),Ne.getTilePoint(new v.MercatorCoordinate(Rt,Yt))];if(Ve[0].x-ze<v.EXTENT&&Ve[0].y-ze<v.EXTENT&&Ve[1].x+ze>=0&&Ve[1].y+ze>=0){var $e=H.map(function(tr){return Ne.getTilePoint(tr)}),rr=ut.map(function(tr){return Ne.getTilePoint(tr)});L.push({tile:we,tileID:Ne,queryGeometry:$e,cameraQueryGeometry:rr,scale:qe})}}},_e=0;_e<gt.length;_e++)he(_e);return L},p.prototype.getVisibleCoordinates=function(c){for(var y=this,C=this.getRenderableIds(c).map(function(Z){return y._tiles[Z].tileID}),T=0,L=C;T<L.length;T+=1){var z=L[T];z.posMatrix=this.transform.calculatePosMatrix(z.toUnwrapped())}return C},p.prototype.hasTransition=function(){if(this._source.hasTransition())return!0;if(je(this._source.type))for(var c in this._tiles){var y=this._tiles[c];if(void 0!==y.fadeEndTime&&y.fadeEndTime>=v.browser.now())return!0}return!1},p.prototype.setFeatureState=function(c,y,C){this._state.updateState(c=c||"_geojsonTileLayer",y,C)},p.prototype.removeFeatureState=function(c,y,C){this._state.removeFeatureState(c=c||"_geojsonTileLayer",y,C)},p.prototype.getFeatureState=function(c,y){return this._state.getState(c=c||"_geojsonTileLayer",y)},p.prototype.setDependencies=function(c,y,C){var T=this._tiles[c];T&&T.setDependencies(y,C)},p.prototype.reloadTilesForDependencies=function(c,y){for(var C in this._tiles)this._tiles[C].hasDependency(c,y)&&this._reloadTile(C,"reloading");this._cache.filter(function(T){return!T.hasDependency(c,y)})},p}(v.Evented);function Ut(l,p){var c=Math.abs(2*l.wrap)-+(l.wrap<0),y=Math.abs(2*p.wrap)-+(p.wrap<0);return l.overscaledZ-p.overscaledZ||y-c||p.canonical.y-l.canonical.y||p.canonical.x-l.canonical.x}function je(l){return"raster"===l||"image"===l||"video"===l}function ur(){return new v.window.Worker(Kn.workerUrl)}_t.maxOverzooming=10,_t.maxUnderzooming=3;var ge="mapboxgl_preloaded_worker_pool",Oe=function(){this.active={}};Oe.prototype.acquire=function(l){if(!this.workers)for(this.workers=[];this.workers.length<Oe.workerCount;)this.workers.push(new ur);return this.active[l]=!0,this.workers.slice()},Oe.prototype.release=function(l){delete this.active[l],0===this.numActive()&&(this.workers.forEach(function(p){p.terminate()}),this.workers=null)},Oe.prototype.isPreloaded=function(){return!!this.active[ge]},Oe.prototype.numActive=function(){return Object.keys(this.active).length};var cr,pr=Math.floor(v.browser.hardwareConcurrency/2);function Tr(){return cr||(cr=new Oe),cr}function Re(l,p){var c={};for(var y in l)"ref"!==y&&(c[y]=l[y]);return v.refProperties.forEach(function(C){C in p&&(c[C]=p[C])}),c}function nr(l){l=l.slice();for(var p=Object.create(null),c=0;c<l.length;c++)p[l[c].id]=l[c];for(var y=0;y<l.length;y++)"ref"in l[y]&&(l[y]=Re(l[y],p[l[y].ref]));return l}Oe.workerCount=Math.max(Math.min(pr,6),1);var Ue={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight"};function ln(l,p,c){c.push({command:Ue.addSource,args:[l,p[l]]})}function Gr(l,p,c){p.push({command:Ue.removeSource,args:[l]}),c[l]=!0}function Sr(l,p,c,y){Gr(l,c,y),ln(l,p,c)}function un(l,p,c){var y;for(y in l[c])if(l[c].hasOwnProperty(y)&&"data"!==y&&!v.deepEqual(l[c][y],p[c][y]))return!1;for(y in p[c])if(p[c].hasOwnProperty(y)&&"data"!==y&&!v.deepEqual(l[c][y],p[c][y]))return!1;return!0}function ir(l,p,c,y,C,T){var L;for(L in p=p||{},l=l||{})l.hasOwnProperty(L)&&(v.deepEqual(l[L],p[L])||c.push({command:T,args:[y,L,p[L],C]}));for(L in p)p.hasOwnProperty(L)&&!l.hasOwnProperty(L)&&(v.deepEqual(l[L],p[L])||c.push({command:T,args:[y,L,p[L],C]}))}function ci(l){return l.id}function On(l,p){return l[p.id]=p,l}var wn=function(l,p){this.reset(l,p)};wn.prototype.reset=function(l,p){this.points=l||[],this._distances=[0];for(var c=1;c<this.points.length;c++)this._distances[c]=this._distances[c-1]+this.points[c].dist(this.points[c-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(p||0,.5*this.length),this.paddedLength=this.length-2*this.padding},wn.prototype.lerp=function(l){if(1===this.points.length)return this.points[0];l=v.clamp(l,0,1);for(var p=1,c=this._distances[p],y=l*this.paddedLength+this.padding;c<y&&p<this._distances.length;)c=this._distances[++p];var C=p-1,T=this._distances[C],L=c-T,z=L>0?(y-T)/L:0;return this.points[C].mult(1-z).add(this.points[p].mult(z))};var cn=function(l,p,c){var y=this.boxCells=[],C=this.circleCells=[];this.xCellCount=Math.ceil(l/c),this.yCellCount=Math.ceil(p/c);for(var T=0;T<this.xCellCount*this.yCellCount;T++)y.push([]),C.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=l,this.height=p,this.xScale=this.xCellCount/l,this.yScale=this.yCellCount/p,this.boxUid=0,this.circleUid=0};function gi(l,p,c,y,C){var T=v.create();return p?(v.scale(T,T,[1/C,1/C,1]),c||v.rotateZ(T,T,y.angle)):v.multiply(T,y.labelPlaneMatrix,l),T}function Un(l,p,c,y,C){if(p){var T=v.clone(l);return v.scale(T,T,[C,C,1]),c||v.rotateZ(T,T,-y.angle),T}return y.glCoordMatrix}function on(l,p){var c=[l.x,l.y,0,1];En(c,c,p);var y=c[3];return{point:new v.Point(c[0]/y,c[1]/y),signedDistanceFromCamera:y}}function Zo(l,p){return.5+l/p*.5}function Pn(l,p){var c=l[0]/l[3],y=l[1]/l[3];return c>=-p[0]&&c<=p[0]&&y>=-p[1]&&y<=p[1]}function Ds(l,p,c,y,C,T,L,z){var Z=y?l.textSizeData:l.iconSizeData,H=v.evaluateSizeForZoom(Z,c.transform.zoom),ut=[256/c.width*2+1,256/c.height*2+1],gt=y?l.text.dynamicLayoutVertexArray:l.icon.dynamicLayoutVertexArray;gt.clear();for(var ct=l.lineVertexArray,zt=y?l.text.placedSymbolArray:l.icon.placedSymbolArray,Rt=c.transform.width/c.transform.height,Yt=!1,Dt=0;Dt<zt.length;Dt++){var Vt=zt.get(Dt);if(Vt.hidden||Vt.writingMode===v.WritingMode.vertical&&!Yt)Rs(Vt.numGlyphs,gt);else{Yt=!1;var ee=[Vt.anchorX,Vt.anchorY,0,1];if(v.transformMat4(ee,ee,p),Pn(ee,ut)){var he=Zo(c.transform.cameraToCenterDistance,ee[3]),_e=v.evaluateSizeForFeature(Z,H,Vt),ve=L?_e/he:_e*he,we=new v.Point(Vt.anchorX,Vt.anchorY),Ne=on(we,C).point,qe={},ze=jn(Vt,ve,!1,z,p,C,T,l.glyphOffsetArray,ct,gt,Ne,we,qe,Rt);Yt=ze.useVertical,(ze.notEnoughRoom||Yt||ze.needsFlipping&&jn(Vt,ve,!0,z,p,C,T,l.glyphOffsetArray,ct,gt,Ne,we,qe,Rt).notEnoughRoom)&&Rs(Vt.numGlyphs,gt)}else Rs(Vt.numGlyphs,gt)}}y?l.text.dynamicLayoutVertexBuffer.updateData(gt):l.icon.dynamicLayoutVertexBuffer.updateData(gt)}function $s(l,p,c,y,C,T,L,z,Z,H,ut){var gt=z.glyphStartIndex+z.numGlyphs,ct=z.lineStartIndex,zt=z.lineStartIndex+z.lineLength,Rt=p.getoffsetX(z.glyphStartIndex),Yt=p.getoffsetX(gt-1),Dt=ma(l*Rt,c,y,C,T,L,z.segment,ct,zt,Z,H,ut);if(!Dt)return null;var Vt=ma(l*Yt,c,y,C,T,L,z.segment,ct,zt,Z,H,ut);return Vt?{first:Dt,last:Vt}:null}function no(l,p,c,y){return l===v.WritingMode.horizontal&&Math.abs(c.y-p.y)>Math.abs(c.x-p.x)*y?{useVertical:!0}:(l===v.WritingMode.vertical?p.y<c.y:p.x>c.x)?{needsFlipping:!0}:null}function jn(l,p,c,y,C,T,L,z,Z,H,ut,gt,ct,zt){var Rt,Yt=p/24,Dt=l.lineOffsetX*Yt,Vt=l.lineOffsetY*Yt;if(l.numGlyphs>1){var ee=l.glyphStartIndex+l.numGlyphs,he=l.lineStartIndex,_e=l.lineStartIndex+l.lineLength,ve=$s(Yt,z,Dt,Vt,c,ut,gt,l,Z,T,ct);if(!ve)return{notEnoughRoom:!0};var we=on(ve.first.point,L).point,Ne=on(ve.last.point,L).point;if(y&&!c){var qe=no(l.writingMode,we,Ne,zt);if(qe)return qe}Rt=[ve.first];for(var ze=l.glyphStartIndex+1;ze<ee-1;ze++)Rt.push(ma(Yt*z.getoffsetX(ze),Dt,Vt,c,ut,gt,l.segment,he,_e,Z,T,ct));Rt.push(ve.last)}else{if(y&&!c){var Ve=on(gt,C).point,$e=l.lineStartIndex+l.segment+1,rr=new v.Point(Z.getx($e),Z.gety($e)),tr=on(rr,C),Dr=tr.signedDistanceFromCamera>0?tr.point:_l(gt,rr,Ve,1,C),Xe=no(l.writingMode,Ve,Dr,zt);if(Xe)return Xe}var vr=ma(Yt*z.getoffsetX(l.glyphStartIndex),Dt,Vt,c,ut,gt,l.segment,l.lineStartIndex,l.lineStartIndex+l.lineLength,Z,T,ct);if(!vr)return{notEnoughRoom:!0};Rt=[vr]}for(var Pr=0,_r=Rt;Pr<_r.length;Pr+=1){var mr=_r[Pr];v.addDynamicAttributes(H,mr.point,mr.angle)}return{}}function _l(l,p,c,y,C){var T=on(l.add(l.sub(p)._unit()),C).point,L=c.sub(T);return c.add(L._mult(y/L.mag()))}function ma(l,p,c,y,C,T,L,z,Z,H,ut,gt){var ct=y?l-p:l+p,zt=ct>0?1:-1,Rt=0;y&&(zt*=-1,Rt=Math.PI),zt<0&&(Rt+=Math.PI);for(var Yt=zt>0?z+L:z+L+1,Dt=C,Vt=C,ee=0,he=0,_e=Math.abs(ct),ve=[];ee+he<=_e;){if((Yt+=zt)<z||Yt>=Z)return null;if(Vt=Dt,ve.push(Dt),void 0===(Dt=gt[Yt])){var we=new v.Point(H.getx(Yt),H.gety(Yt)),Ne=on(we,ut);if(Ne.signedDistanceFromCamera>0)Dt=gt[Yt]=Ne.point;else{var qe=Yt-zt;Dt=_l(0===ee?T:new v.Point(H.getx(qe),H.gety(qe)),we,Vt,_e-ee+1,ut)}}ee+=he,he=Vt.dist(Dt)}var ze=(_e-ee)/he,Ve=Dt.sub(Vt),$e=Ve.mult(ze)._add(Vt);$e._add(Ve._unit()._perp()._mult(c*zt));var rr=Rt+Math.atan2(Dt.y-Vt.y,Dt.x-Vt.x);return ve.push($e),{point:$e,angle:rr,path:ve}}cn.prototype.keysLength=function(){return this.boxKeys.length+this.circleKeys.length},cn.prototype.insert=function(l,p,c,y,C){this._forEachCell(p,c,y,C,this._insertBoxCell,this.boxUid++),this.boxKeys.push(l),this.bboxes.push(p),this.bboxes.push(c),this.bboxes.push(y),this.bboxes.push(C)},cn.prototype.insertCircle=function(l,p,c,y){this._forEachCell(p-y,c-y,p+y,c+y,this._insertCircleCell,this.circleUid++),this.circleKeys.push(l),this.circles.push(p),this.circles.push(c),this.circles.push(y)},cn.prototype._insertBoxCell=function(l,p,c,y,C,T){this.boxCells[C].push(T)},cn.prototype._insertCircleCell=function(l,p,c,y,C,T){this.circleCells[C].push(T)},cn.prototype._query=function(l,p,c,y,C,T){if(c<0||l>this.width||y<0||p>this.height)return!C&&[];var L=[];if(l<=0&&p<=0&&this.width<=c&&this.height<=y){if(C)return!0;for(var z=0;z<this.boxKeys.length;z++)L.push({key:this.boxKeys[z],x1:this.bboxes[4*z],y1:this.bboxes[4*z+1],x2:this.bboxes[4*z+2],y2:this.bboxes[4*z+3]});for(var Z=0;Z<this.circleKeys.length;Z++){var H=this.circles[3*Z],ut=this.circles[3*Z+1],gt=this.circles[3*Z+2];L.push({key:this.circleKeys[Z],x1:H-gt,y1:ut-gt,x2:H+gt,y2:ut+gt})}return T?L.filter(T):L}return this._forEachCell(l,p,c,y,this._queryCell,L,{hitTest:C,seenUids:{box:{},circle:{}}},T),C?L.length>0:L},cn.prototype._queryCircle=function(l,p,c,y,C){var T=l-c,L=l+c,z=p-c,Z=p+c;if(L<0||T>this.width||Z<0||z>this.height)return!y&&[];var H=[];return this._forEachCell(T,z,L,Z,this._queryCellCircle,H,{hitTest:y,circle:{x:l,y:p,radius:c},seenUids:{box:{},circle:{}}},C),y?H.length>0:H},cn.prototype.query=function(l,p,c,y,C){return this._query(l,p,c,y,!1,C)},cn.prototype.hitTest=function(l,p,c,y,C){return this._query(l,p,c,y,!0,C)},cn.prototype.hitTestCircle=function(l,p,c,y){return this._queryCircle(l,p,c,!0,y)},cn.prototype._queryCell=function(l,p,c,y,C,T,L,z){var Z=L.seenUids,H=this.boxCells[C];if(null!==H)for(var ut=this.bboxes,gt=0,ct=H;gt<ct.length;gt+=1){var zt=ct[gt];if(!Z.box[zt]){Z.box[zt]=!0;var Rt=4*zt;if(l<=ut[Rt+2]&&p<=ut[Rt+3]&&c>=ut[Rt+0]&&y>=ut[Rt+1]&&(!z||z(this.boxKeys[zt]))){if(L.hitTest)return T.push(!0),!0;T.push({key:this.boxKeys[zt],x1:ut[Rt],y1:ut[Rt+1],x2:ut[Rt+2],y2:ut[Rt+3]})}}}var Yt=this.circleCells[C];if(null!==Yt)for(var Dt=this.circles,Vt=0,ee=Yt;Vt<ee.length;Vt+=1){var he=ee[Vt];if(!Z.circle[he]){Z.circle[he]=!0;var _e=3*he;if(this._circleAndRectCollide(Dt[_e],Dt[_e+1],Dt[_e+2],l,p,c,y)&&(!z||z(this.circleKeys[he]))){if(L.hitTest)return T.push(!0),!0;var ve=Dt[_e],we=Dt[_e+1],Ne=Dt[_e+2];T.push({key:this.circleKeys[he],x1:ve-Ne,y1:we-Ne,x2:ve+Ne,y2:we+Ne})}}}},cn.prototype._queryCellCircle=function(l,p,c,y,C,T,L,z){var Z=L.circle,H=L.seenUids,ut=this.boxCells[C];if(null!==ut)for(var gt=this.bboxes,ct=0,zt=ut;ct<zt.length;ct+=1){var Rt=zt[ct];if(!H.box[Rt]){H.box[Rt]=!0;var Yt=4*Rt;if(this._circleAndRectCollide(Z.x,Z.y,Z.radius,gt[Yt+0],gt[Yt+1],gt[Yt+2],gt[Yt+3])&&(!z||z(this.boxKeys[Rt])))return T.push(!0),!0}}var Dt=this.circleCells[C];if(null!==Dt)for(var Vt=this.circles,ee=0,he=Dt;ee<he.length;ee+=1){var _e=he[ee];if(!H.circle[_e]){H.circle[_e]=!0;var ve=3*_e;if(this._circlesCollide(Vt[ve],Vt[ve+1],Vt[ve+2],Z.x,Z.y,Z.radius)&&(!z||z(this.circleKeys[_e])))return T.push(!0),!0}}},cn.prototype._forEachCell=function(l,p,c,y,C,T,L,z){for(var Z=this._convertToXCellCoord(l),H=this._convertToYCellCoord(p),ut=this._convertToXCellCoord(c),gt=this._convertToYCellCoord(y),ct=Z;ct<=ut;ct++)for(var zt=H;zt<=gt;zt++)if(C.call(this,l,p,c,y,this.xCellCount*zt+ct,T,L,z))return},cn.prototype._convertToXCellCoord=function(l){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(l*this.xScale)))},cn.prototype._convertToYCellCoord=function(l){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(l*this.yScale)))},cn.prototype._circlesCollide=function(l,p,c,y,C,T){var L=y-l,z=C-p,Z=c+T;return Z*Z>L*L+z*z},cn.prototype._circleAndRectCollide=function(l,p,c,y,C,T,L){var z=(T-y)/2,Z=Math.abs(l-(y+z));if(Z>z+c)return!1;var H=(L-C)/2,ut=Math.abs(p-(C+H));if(ut>H+c)return!1;if(Z<=z||ut<=H)return!0;var gt=Z-z,ct=ut-H;return gt*gt+ct*ct<=c*c};var xo=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function Rs(l,p){for(var c=0;c<l;c++){var y=p.length;p.resize(y+4),p.float32.set(xo,3*y)}}function En(l,p,c){var y=p[0],C=p[1];return l[0]=c[0]*y+c[4]*C+c[12],l[1]=c[1]*y+c[5]*C+c[13],l[3]=c[3]*y+c[7]*C+c[15],l}var Ai=function(l,p,c){void 0===p&&(p=new cn(l.width+200,l.height+200,25)),void 0===c&&(c=new cn(l.width+200,l.height+200,25)),this.transform=l,this.grid=p,this.ignoredGrid=c,this.pitchfactor=Math.cos(l._pitch)*l.cameraToCenterDistance,this.screenRightBoundary=l.width+100,this.screenBottomBoundary=l.height+100,this.gridRightBoundary=l.width+200,this.gridBottomBoundary=l.height+200};function Wi(l,p,c){return p*(v.EXTENT/(l.tileSize*Math.pow(2,c-l.tileID.overscaledZ)))}Ai.prototype.placeCollisionBox=function(l,p,c,y,C){var T=this.projectAndGetPerspectiveRatio(y,l.anchorPointX,l.anchorPointY),L=c*T.perspectiveRatio,z=l.x1*L+T.point.x,Z=l.y1*L+T.point.y,H=l.x2*L+T.point.x,ut=l.y2*L+T.point.y;return!this.isInsideGrid(z,Z,H,ut)||!p&&this.grid.hitTest(z,Z,H,ut,C)?{box:[],offscreen:!1}:{box:[z,Z,H,ut],offscreen:this.isOffscreen(z,Z,H,ut)}},Ai.prototype.placeCollisionCircles=function(l,p,c,y,C,T,L,z,Z,H,ut,gt,ct){var zt=[],Rt=new v.Point(p.anchorX,p.anchorY),Yt=on(Rt,T),Dt=Zo(this.transform.cameraToCenterDistance,Yt.signedDistanceFromCamera),Vt=(H?C/Dt:C*Dt)/v.ONE_EM,ee=on(Rt,L).point,he=$s(Vt,y,p.lineOffsetX*Vt,p.lineOffsetY*Vt,!1,ee,Rt,p,c,L,{}),_e=!1,ve=!1,we=!0;if(he){for(var Ne=.5*gt*Dt+ct,qe=new v.Point(-100,-100),ze=new v.Point(this.screenRightBoundary,this.screenBottomBoundary),Ve=new wn,$e=he.first,rr=he.last,tr=[],Dr=$e.path.length-1;Dr>=1;Dr--)tr.push($e.path[Dr]);for(var Xe=1;Xe<rr.path.length;Xe++)tr.push(rr.path[Xe]);var vr=2.5*Ne;if(z){var Pr=tr.map(function(us){return on(us,z)});tr=Pr.some(function(us){return us.signedDistanceFromCamera<=0})?[]:Pr.map(function(us){return us.point})}var _r=[];if(tr.length>0){for(var mr=tr[0].clone(),fr=tr[0].clone(),hr=1;hr<tr.length;hr++)mr.x=Math.min(mr.x,tr[hr].x),mr.y=Math.min(mr.y,tr[hr].y),fr.x=Math.max(fr.x,tr[hr].x),fr.y=Math.max(fr.y,tr[hr].y);_r=mr.x>=qe.x&&fr.x<=ze.x&&mr.y>=qe.y&&fr.y<=ze.y?[tr]:fr.x<qe.x||mr.x>ze.x||fr.y<qe.y||mr.y>ze.y?[]:v.clipLine([tr],qe.x,qe.y,ze.x,ze.y)}for(var or=0,qr=_r;or<qr.length;or+=1){var Kr;Ve.reset(qr[or],.25*Ne),Kr=Ve.length<=.5*Ne?1:Math.ceil(Ve.paddedLength/vr)+1;for(var pn=0;pn<Kr;pn++){var rn=pn/Math.max(Kr-1,1),nn=Ve.lerp(rn),Qr=nn.x+100,hn=nn.y+100;zt.push(Qr,hn,Ne,0);var Sn=Qr-Ne,fn=hn-Ne,ba=Qr+Ne,Bs=hn+Ne;if(we=we&&this.isOffscreen(Sn,fn,ba,Bs),ve=ve||this.isInsideGrid(Sn,fn,ba,Bs),!l&&this.grid.hitTestCircle(Qr,hn,Ne,ut)&&(_e=!0,!Z))return{circles:[],offscreen:!1,collisionDetected:_e}}}}return{circles:!Z&&_e||!ve?[]:zt,offscreen:we,collisionDetected:_e}},Ai.prototype.queryRenderedSymbols=function(l){if(0===l.length||0===this.grid.keysLength()&&0===this.ignoredGrid.keysLength())return{};for(var p=[],c=1/0,y=1/0,C=-1/0,T=-1/0,L=0,z=l;L<z.length;L+=1){var Z=z[L],H=new v.Point(Z.x+100,Z.y+100);c=Math.min(c,H.x),y=Math.min(y,H.y),C=Math.max(C,H.x),T=Math.max(T,H.y),p.push(H)}for(var ut={},gt={},ct=0,zt=this.grid.query(c,y,C,T).concat(this.ignoredGrid.query(c,y,C,T));ct<zt.length;ct+=1){var Rt=zt[ct],Yt=Rt.key;if(void 0===ut[Yt.bucketInstanceId]&&(ut[Yt.bucketInstanceId]={}),!ut[Yt.bucketInstanceId][Yt.featureIndex]){var Dt=[new v.Point(Rt.x1,Rt.y1),new v.Point(Rt.x2,Rt.y1),new v.Point(Rt.x2,Rt.y2),new v.Point(Rt.x1,Rt.y2)];v.polygonIntersectsPolygon(p,Dt)&&(ut[Yt.bucketInstanceId][Yt.featureIndex]=!0,void 0===gt[Yt.bucketInstanceId]&&(gt[Yt.bucketInstanceId]=[]),gt[Yt.bucketInstanceId].push(Yt.featureIndex))}}return gt},Ai.prototype.insertCollisionBox=function(l,p,c,y,C){(p?this.ignoredGrid:this.grid).insert({bucketInstanceId:c,featureIndex:y,collisionGroupID:C},l[0],l[1],l[2],l[3])},Ai.prototype.insertCollisionCircles=function(l,p,c,y,C){for(var T=p?this.ignoredGrid:this.grid,L={bucketInstanceId:c,featureIndex:y,collisionGroupID:C},z=0;z<l.length;z+=4)T.insertCircle(L,l[z],l[z+1],l[z+2])},Ai.prototype.projectAndGetPerspectiveRatio=function(l,p,c){var y=[p,c,0,1];return En(y,y,l),{point:new v.Point((y[0]/y[3]+1)/2*this.transform.width+100,(-y[1]/y[3]+1)/2*this.transform.height+100),perspectiveRatio:.5+this.transform.cameraToCenterDistance/y[3]*.5}},Ai.prototype.isOffscreen=function(l,p,c,y){return c<100||l>=this.screenRightBoundary||y<100||p>this.screenBottomBoundary},Ai.prototype.isInsideGrid=function(l,p,c,y){return c>=0&&l<this.gridRightBoundary&&y>=0&&p<this.gridBottomBoundary},Ai.prototype.getViewportMatrix=function(){var l=v.identity([]);return v.translate(l,l,[-100,-100,0]),l};var Ao=function(l,p,c,y){this.opacity=l?Math.max(0,Math.min(1,l.opacity+(l.placed?p:-p))):y&&c?1:0,this.placed=c};Ao.prototype.isHidden=function(){return 0===this.opacity&&!this.placed};var en=function(l,p,c,y,C){this.text=new Ao(l?l.text:null,p,c,C),this.icon=new Ao(l?l.icon:null,p,y,C)};en.prototype.isHidden=function(){return this.text.isHidden()&&this.icon.isHidden()};var Ns=function(l,p,c){this.text=l,this.icon=p,this.skipFade=c},Ic=function(){this.invProjMatrix=v.create(),this.viewportMatrix=v.create(),this.circles=[]},Ra=function(l,p,c,y,C){this.bucketInstanceId=l,this.featureIndex=p,this.sourceLayerIndex=c,this.bucketIndex=y,this.tileID=C},ya=function(l){this.crossSourceCollisions=l,this.maxGroupID=0,this.collisionGroups={}};function Wo(l,p,c,y,C){var T=v.getAnchorAlignment(l),L=-(T.horizontalAlign-.5)*p,z=-(T.verticalAlign-.5)*c,Z=v.evaluateVariableOffset(l,y);return new v.Point(L+Z[0]*C,z+Z[1]*C)}function Lo(l,p,c,y,C,T){var L=l.x1,z=l.x2,Z=l.y1,H=l.y2,ut=l.anchorPointX,gt=l.anchorPointY,ct=new v.Point(p,c);return y&&ct._rotate(C?T:-T),{x1:L+ct.x,y1:Z+ct.y,x2:z+ct.x,y2:H+ct.y,anchorPointX:ut,anchorPointY:gt}}ya.prototype.get=function(l){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[l]){var p=++this.maxGroupID;this.collisionGroups[l]={ID:p,predicate:function(c){return c.collisionGroupID===p}}}return this.collisionGroups[l]};var bo=function(l,p,c,y){this.transform=l.clone(),this.collisionIndex=new Ai(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=p,this.retainedQueryData={},this.collisionGroups=new ya(c),this.collisionCircleArrays={},this.prevPlacement=y,y&&(y.prevPlacement=void 0),this.placedOrientations={}};function Qe(l,p,c,y,C){l.emplaceBack(p?1:0,c?1:0,y||0,C||0),l.emplaceBack(p?1:0,c?1:0,y||0,C||0),l.emplaceBack(p?1:0,c?1:0,y||0,C||0),l.emplaceBack(p?1:0,c?1:0,y||0,C||0)}bo.prototype.getBucketParts=function(l,p,c,y){var C=c.getBucket(p),T=c.latestFeatureIndex;if(C&&T&&p.id===C.layerIds[0]){var L=c.collisionBoxArray,z=C.layers[0].layout,Z=Math.pow(2,this.transform.zoom-c.tileID.overscaledZ),H=c.tileSize/v.EXTENT,ut=this.transform.calculatePosMatrix(c.tileID.toUnwrapped()),gt="map"===z.get("text-pitch-alignment"),ct="map"===z.get("text-rotation-alignment"),zt=Wi(c,1,this.transform.zoom),Rt=gi(ut,gt,ct,this.transform,zt),Yt=null;if(gt){var Dt=Un(ut,gt,ct,this.transform,zt);Yt=v.multiply([],this.transform.labelPlaneMatrix,Dt)}this.retainedQueryData[C.bucketInstanceId]=new Ra(C.bucketInstanceId,T,C.sourceLayerIndex,C.index,c.tileID);var Vt={bucket:C,layout:z,posMatrix:ut,textLabelPlaneMatrix:Rt,labelToScreenMatrix:Yt,scale:Z,textPixelRatio:H,holdingForFade:c.holdingForFade(),collisionBoxArray:L,partiallyEvaluatedTextSize:v.evaluateSizeForZoom(C.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(C.sourceID)};if(y)for(var ee=0,he=C.sortKeyRanges;ee<he.length;ee+=1){var _e=he[ee];l.push({sortKey:_e.sortKey,symbolInstanceStart:_e.symbolInstanceStart,symbolInstanceEnd:_e.symbolInstanceEnd,parameters:Vt})}else l.push({symbolInstanceStart:0,symbolInstanceEnd:C.symbolInstances.length,parameters:Vt})}},bo.prototype.attemptAnchorPlacement=function(l,p,c,y,C,T,L,z,Z,H,ut,gt,ct,zt,Rt){var Yt,Dt=[gt.textOffset0,gt.textOffset1],Vt=Wo(l,c,y,Dt,C),ee=this.collisionIndex.placeCollisionBox(Lo(p,Vt.x,Vt.y,T,L,this.transform.angle),ut,z,Z,H.predicate);if(!Rt||0!==this.collisionIndex.placeCollisionBox(Lo(Rt,Vt.x,Vt.y,T,L,this.transform.angle),ut,z,Z,H.predicate).box.length)return ee.box.length>0?(this.prevPlacement&&this.prevPlacement.variableOffsets[gt.crossTileID]&&this.prevPlacement.placements[gt.crossTileID]&&this.prevPlacement.placements[gt.crossTileID].text&&(Yt=this.prevPlacement.variableOffsets[gt.crossTileID].anchor),this.variableOffsets[gt.crossTileID]={textOffset:Dt,width:c,height:y,anchor:l,textBoxScale:C,prevAnchor:Yt},this.markUsedJustification(ct,l,gt,zt),ct.allowVerticalPlacement&&(this.markUsedOrientation(ct,zt,gt),this.placedOrientations[gt.crossTileID]=zt),{shift:Vt,placedGlyphBoxes:ee}):void 0},bo.prototype.placeLayerBucketPart=function(l,p,c){var y=this,C=l.parameters,T=C.bucket,L=C.layout,z=C.posMatrix,Z=C.textLabelPlaneMatrix,H=C.labelToScreenMatrix,ut=C.textPixelRatio,gt=C.holdingForFade,ct=C.collisionBoxArray,zt=C.partiallyEvaluatedTextSize,Rt=C.collisionGroup,Yt=L.get("text-optional"),Dt=L.get("icon-optional"),Vt=L.get("text-allow-overlap"),ee=L.get("icon-allow-overlap"),he="map"===L.get("text-rotation-alignment"),_e="map"===L.get("text-pitch-alignment"),ve="none"!==L.get("icon-text-fit"),we="viewport-y"===L.get("symbol-z-order"),Ne=Vt&&(ee||!T.hasIconData()||Dt),qe=ee&&(Vt||!T.hasTextData()||Yt);!T.collisionArrays&&ct&&T.deserializeCollisionBoxes(ct);var ze=function(Xe,vr){if(!p[Xe.crossTileID])if(gt)y.placements[Xe.crossTileID]=new Ns(!1,!1,!1);else{var Pr,_r=!1,mr=!1,fr=!0,hr=null,or={box:null,offscreen:null},qr={box:null,offscreen:null},Kr=null,pn=null,rn=0,nn=0,Qr=0;vr.textFeatureIndex?rn=vr.textFeatureIndex:Xe.useRuntimeCollisionCircles&&(rn=Xe.featureIndex),vr.verticalTextFeatureIndex&&(nn=vr.verticalTextFeatureIndex);var hn=vr.textBox;if(hn){var Sn=function(Po){var go=v.WritingMode.horizontal;if(T.allowVerticalPlacement&&!Po&&y.prevPlacement){var Za=y.prevPlacement.placedOrientations[Xe.crossTileID];Za&&(y.placedOrientations[Xe.crossTileID]=Za,y.markUsedOrientation(T,go=Za,Xe))}return go},fn=function(Po,go){if(T.allowVerticalPlacement&&Xe.numVerticalGlyphVertices>0&&vr.verticalTextBox)for(var Za=0,Cl=T.writingModes;Za<Cl.length&&(Cl[Za]===v.WritingMode.vertical?(or=go(),qr=or):or=Po(),!(or&&or.box&&or.box.length));Za+=1);else or=Po()};if(L.get("text-variable-anchor")){var ba=L.get("text-variable-anchor");if(y.prevPlacement&&y.prevPlacement.variableOffsets[Xe.crossTileID]){var Bs=y.prevPlacement.variableOffsets[Xe.crossTileID];ba.indexOf(Bs.anchor)>0&&(ba=ba.filter(function(Po){return Po!==Bs.anchor})).unshift(Bs.anchor)}var us=function(Po,go,Za){for(var Cl=Po.x2-Po.x1,Kl=Po.y2-Po.y1,Ah=Xe.textBoxScale,Ql=ve&&!ee?go:null,$l={box:[],offscreen:!1},$c=Vt?2*ba.length:ba.length,Sl=0;Sl<$c;++Sl){var Il=y.attemptAnchorPlacement(ba[Sl%ba.length],Po,Cl,Kl,Ah,he,_e,ut,z,Rt,Sl>=ba.length,Xe,T,Za,Ql);if(Il&&($l=Il.placedGlyphBoxes)&&$l.box&&$l.box.length){_r=!0,hr=Il.shift;break}}return $l};fn(function(){return us(hn,vr.iconBox,v.WritingMode.horizontal)},function(){var Po=vr.verticalTextBox;return T.allowVerticalPlacement&&!(or&&or.box&&or.box.length)&&Xe.numVerticalGlyphVertices>0&&Po?us(Po,vr.verticalIconBox,v.WritingMode.vertical):{box:null,offscreen:null}}),or&&(_r=or.box,fr=or.offscreen);var El=Sn(or&&or.box);if(!_r&&y.prevPlacement){var cu=y.prevPlacement.variableOffsets[Xe.crossTileID];cu&&(y.variableOffsets[Xe.crossTileID]=cu,y.markUsedJustification(T,cu.anchor,Xe,El))}}else{var Ou=function(Po,go){var Za=y.collisionIndex.placeCollisionBox(Po,Vt,ut,z,Rt.predicate);return Za&&Za.box&&Za.box.length&&(y.markUsedOrientation(T,go,Xe),y.placedOrientations[Xe.crossTileID]=go),Za};fn(function(){return Ou(hn,v.WritingMode.horizontal)},function(){var Po=vr.verticalTextBox;return T.allowVerticalPlacement&&Xe.numVerticalGlyphVertices>0&&Po?Ou(Po,v.WritingMode.vertical):{box:null,offscreen:null}}),Sn(or&&or.box&&or.box.length)}}if(_r=(Pr=or)&&Pr.box&&Pr.box.length>0,fr=Pr&&Pr.offscreen,Xe.useRuntimeCollisionCircles){var vu=T.text.placedSymbolArray.get(Xe.centerJustifiedTextSymbolIndex),Gu=v.evaluateSizeForFeature(T.textSizeData,zt,vu),el=L.get("text-padding");Kr=y.collisionIndex.placeCollisionCircles(Vt,vu,T.lineVertexArray,T.glyphOffsetArray,Gu,z,Z,H,c,_e,Rt.predicate,Xe.collisionCircleDiameter,el),_r=Vt||Kr.circles.length>0&&!Kr.collisionDetected,fr=fr&&Kr.offscreen}if(vr.iconFeatureIndex&&(Qr=vr.iconFeatureIndex),vr.iconBox){var hu=function(Po){var go=ve&&hr?Lo(Po,hr.x,hr.y,he,_e,y.transform.angle):Po;return y.collisionIndex.placeCollisionBox(go,ee,ut,z,Rt.predicate)};mr=qr&&qr.box&&qr.box.length&&vr.verticalIconBox?(pn=hu(vr.verticalIconBox)).box.length>0:(pn=hu(vr.iconBox)).box.length>0,fr=fr&&pn.offscreen}var rl=Yt||0===Xe.numHorizontalGlyphVertices&&0===Xe.numVerticalGlyphVertices,Xo=Dt||0===Xe.numIconVertices;if(rl||Xo?Xo?rl||(mr=mr&&_r):_r=mr&&_r:mr=_r=mr&&_r,_r&&Pr&&Pr.box&&y.collisionIndex.insertCollisionBox(Pr.box,L.get("text-ignore-placement"),T.bucketInstanceId,qr&&qr.box&&nn?nn:rn,Rt.ID),mr&&pn&&y.collisionIndex.insertCollisionBox(pn.box,L.get("icon-ignore-placement"),T.bucketInstanceId,Qr,Rt.ID),Kr&&(_r&&y.collisionIndex.insertCollisionCircles(Kr.circles,L.get("text-ignore-placement"),T.bucketInstanceId,rn,Rt.ID),c)){var _u=T.bucketInstanceId,Js=y.collisionCircleArrays[_u];void 0===Js&&(Js=y.collisionCircleArrays[_u]=new Ic);for(var Vu=0;Vu<Kr.circles.length;Vu+=4)Js.circles.push(Kr.circles[Vu+0]),Js.circles.push(Kr.circles[Vu+1]),Js.circles.push(Kr.circles[Vu+2]),Js.circles.push(Kr.collisionDetected?1:0)}y.placements[Xe.crossTileID]=new Ns(_r||Ne,mr||qe,fr||T.justReloaded),p[Xe.crossTileID]=!0}};if(we)for(var Ve=T.getSortedSymbolIndexes(this.transform.angle),$e=Ve.length-1;$e>=0;--$e){var rr=Ve[$e];ze(T.symbolInstances.get(rr),T.collisionArrays[rr])}else for(var tr=l.symbolInstanceStart;tr<l.symbolInstanceEnd;tr++)ze(T.symbolInstances.get(tr),T.collisionArrays[tr]);if(c&&T.bucketInstanceId in this.collisionCircleArrays){var Dr=this.collisionCircleArrays[T.bucketInstanceId];v.invert(Dr.invProjMatrix,z),Dr.viewportMatrix=this.collisionIndex.getViewportMatrix()}T.justReloaded=!1},bo.prototype.markUsedJustification=function(l,p,c,y){var C;C=y===v.WritingMode.vertical?c.verticalPlacedTextSymbolIndex:{left:c.leftJustifiedTextSymbolIndex,center:c.centerJustifiedTextSymbolIndex,right:c.rightJustifiedTextSymbolIndex}[v.getAnchorJustification(p)];for(var T=0,L=[c.leftJustifiedTextSymbolIndex,c.centerJustifiedTextSymbolIndex,c.rightJustifiedTextSymbolIndex,c.verticalPlacedTextSymbolIndex];T<L.length;T+=1){var z=L[T];z>=0&&(l.text.placedSymbolArray.get(z).crossTileID=C>=0&&z!==C?0:c.crossTileID)}},bo.prototype.markUsedOrientation=function(l,p,c){for(var y=p===v.WritingMode.horizontal||p===v.WritingMode.horizontalOnly?p:0,C=p===v.WritingMode.vertical?p:0,T=0,L=[c.leftJustifiedTextSymbolIndex,c.centerJustifiedTextSymbolIndex,c.rightJustifiedTextSymbolIndex];T<L.length;T+=1)l.text.placedSymbolArray.get(L[T]).placedOrientation=y;c.verticalPlacedTextSymbolIndex&&(l.text.placedSymbolArray.get(c.verticalPlacedTextSymbolIndex).placedOrientation=C)},bo.prototype.commit=function(l){this.commitTime=l,this.zoomAtLastRecencyCheck=this.transform.zoom;var p=this.prevPlacement,c=!1;this.prevZoomAdjustment=p?p.zoomAdjustment(this.transform.zoom):0;var y=p?p.symbolFadeChange(l):1,C=p?p.opacities:{},T=p?p.variableOffsets:{},L=p?p.placedOrientations:{};for(var z in this.placements){var Z=this.placements[z],H=C[z];H?(this.opacities[z]=new en(H,y,Z.text,Z.icon),c=c||Z.text!==H.text.placed||Z.icon!==H.icon.placed):(this.opacities[z]=new en(null,y,Z.text,Z.icon,Z.skipFade),c=c||Z.text||Z.icon)}for(var ut in C){var gt=C[ut];if(!this.opacities[ut]){var ct=new en(gt,y,!1,!1);ct.isHidden()||(this.opacities[ut]=ct,c=c||gt.text.placed||gt.icon.placed)}}for(var zt in T)this.variableOffsets[zt]||!this.opacities[zt]||this.opacities[zt].isHidden()||(this.variableOffsets[zt]=T[zt]);for(var Rt in L)this.placedOrientations[Rt]||!this.opacities[Rt]||this.opacities[Rt].isHidden()||(this.placedOrientations[Rt]=L[Rt]);c?this.lastPlacementChangeTime=l:"number"!=typeof this.lastPlacementChangeTime&&(this.lastPlacementChangeTime=p?p.lastPlacementChangeTime:l)},bo.prototype.updateLayerOpacities=function(l,p){for(var c={},y=0,C=p;y<C.length;y+=1){var T=C[y],L=T.getBucket(l);L&&T.latestFeatureIndex&&l.id===L.layerIds[0]&&this.updateBucketOpacities(L,c,T.collisionBoxArray)}},bo.prototype.updateBucketOpacities=function(l,p,c){var y=this;l.hasTextData()&&l.text.opacityVertexArray.clear(),l.hasIconData()&&l.icon.opacityVertexArray.clear(),l.hasIconCollisionBoxData()&&l.iconCollisionBox.collisionVertexArray.clear(),l.hasTextCollisionBoxData()&&l.textCollisionBox.collisionVertexArray.clear();var C=l.layers[0].layout,T=new en(null,0,!1,!1,!0),L=C.get("text-allow-overlap"),z=C.get("icon-allow-overlap"),Z=C.get("text-variable-anchor"),H="map"===C.get("text-rotation-alignment"),ut="map"===C.get("text-pitch-alignment"),gt="none"!==C.get("icon-text-fit"),ct=new en(null,0,L&&(z||!l.hasIconData()||C.get("icon-optional")),z&&(L||!l.hasTextData()||C.get("text-optional")),!0);!l.collisionArrays&&c&&(l.hasIconCollisionBoxData()||l.hasTextCollisionBoxData())&&l.deserializeCollisionBoxes(c);for(var zt=function(Vt,ee,he){for(var _e=0;_e<ee/4;_e++)Vt.opacityVertexArray.emplaceBack(he)},Rt=function(Vt){var ee=l.symbolInstances.get(Vt),he=ee.numHorizontalGlyphVertices,_e=ee.numVerticalGlyphVertices,ve=ee.crossTileID,we=y.opacities[ve];p[ve]?we=T:we||(y.opacities[ve]=we=ct),p[ve]=!0;var Ne=ee.numIconVertices>0,qe=y.placedOrientations[ee.crossTileID],ze=qe===v.WritingMode.vertical,Ve=qe===v.WritingMode.horizontal||qe===v.WritingMode.horizontalOnly;if(he>0||_e>0){var $e=Li(we.text);zt(l.text,he,ze?xl:$e),zt(l.text,_e,Ve?xl:$e);var rr=we.text.isHidden();[ee.rightJustifiedTextSymbolIndex,ee.centerJustifiedTextSymbolIndex,ee.leftJustifiedTextSymbolIndex].forEach(function(or){or>=0&&(l.text.placedSymbolArray.get(or).hidden=rr||ze?1:0)}),ee.verticalPlacedTextSymbolIndex>=0&&(l.text.placedSymbolArray.get(ee.verticalPlacedTextSymbolIndex).hidden=rr||Ve?1:0);var tr=y.variableOffsets[ee.crossTileID];tr&&y.markUsedJustification(l,tr.anchor,ee,qe);var Dr=y.placedOrientations[ee.crossTileID];Dr&&(y.markUsedJustification(l,"left",ee,Dr),y.markUsedOrientation(l,Dr,ee))}if(Ne){var Xe=Li(we.icon),vr=!(gt&&ee.verticalPlacedIconSymbolIndex&&ze);ee.placedIconSymbolIndex>=0&&(zt(l.icon,ee.numIconVertices,vr?Xe:xl),l.icon.placedSymbolArray.get(ee.placedIconSymbolIndex).hidden=we.icon.isHidden()),ee.verticalPlacedIconSymbolIndex>=0&&(zt(l.icon,ee.numVerticalIconVertices,vr?xl:Xe),l.icon.placedSymbolArray.get(ee.verticalPlacedIconSymbolIndex).hidden=we.icon.isHidden())}if(l.hasIconCollisionBoxData()||l.hasTextCollisionBoxData()){var Pr=l.collisionArrays[Vt];if(Pr){var _r=new v.Point(0,0);if(Pr.textBox||Pr.verticalTextBox){var mr=!0;if(Z){var fr=y.variableOffsets[ve];fr?(_r=Wo(fr.anchor,fr.width,fr.height,fr.textOffset,fr.textBoxScale),H&&_r._rotate(ut?y.transform.angle:-y.transform.angle)):mr=!1}Pr.textBox&&Qe(l.textCollisionBox.collisionVertexArray,we.text.placed,!mr||ze,_r.x,_r.y),Pr.verticalTextBox&&Qe(l.textCollisionBox.collisionVertexArray,we.text.placed,!mr||Ve,_r.x,_r.y)}var hr=Boolean(!Ve&&Pr.verticalIconBox);Pr.iconBox&&Qe(l.iconCollisionBox.collisionVertexArray,we.icon.placed,hr,gt?_r.x:0,gt?_r.y:0),Pr.verticalIconBox&&Qe(l.iconCollisionBox.collisionVertexArray,we.icon.placed,!hr,gt?_r.x:0,gt?_r.y:0)}}},Yt=0;Yt<l.symbolInstances.length;Yt++)Rt(Yt);if(l.sortFeatures(this.transform.angle),this.retainedQueryData[l.bucketInstanceId]&&(this.retainedQueryData[l.bucketInstanceId].featureSortOrder=l.featureSortOrder),l.hasTextData()&&l.text.opacityVertexBuffer&&l.text.opacityVertexBuffer.updateData(l.text.opacityVertexArray),l.hasIconData()&&l.icon.opacityVertexBuffer&&l.icon.opacityVertexBuffer.updateData(l.icon.opacityVertexArray),l.hasIconCollisionBoxData()&&l.iconCollisionBox.collisionVertexBuffer&&l.iconCollisionBox.collisionVertexBuffer.updateData(l.iconCollisionBox.collisionVertexArray),l.hasTextCollisionBoxData()&&l.textCollisionBox.collisionVertexBuffer&&l.textCollisionBox.collisionVertexBuffer.updateData(l.textCollisionBox.collisionVertexArray),l.bucketInstanceId in this.collisionCircleArrays){var Dt=this.collisionCircleArrays[l.bucketInstanceId];l.placementInvProjMatrix=Dt.invProjMatrix,l.placementViewportMatrix=Dt.viewportMatrix,l.collisionCircleArray=Dt.circles,delete this.collisionCircleArrays[l.bucketInstanceId]}},bo.prototype.symbolFadeChange=function(l){return 0===this.fadeDuration?1:(l-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment},bo.prototype.zoomAdjustment=function(l){return Math.max(0,(this.transform.zoom-l)/1.5)},bo.prototype.hasTransitions=function(l){return this.stale||l-this.lastPlacementChangeTime<this.fadeDuration},bo.prototype.stillRecent=function(l,p){var c=this.zoomAtLastRecencyCheck===p?1-this.zoomAdjustment(p):1;return this.zoomAtLastRecencyCheck=p,this.commitTime+this.fadeDuration*c>l},bo.prototype.setStale=function(){this.stale=!0};var tu=Math.pow(2,25),Ha=Math.pow(2,24),Ja=Math.pow(2,17),ku=Math.pow(2,16),ia=Math.pow(2,9),yi=Math.pow(2,8),ri=Math.pow(2,1);function Li(l){if(0===l.opacity&&!l.placed)return 0;if(1===l.opacity&&l.placed)return 4294967295;var p=l.placed?1:0,c=Math.floor(127*l.opacity);return c*tu+p*Ha+c*Ja+p*ku+c*ia+p*yi+c*ri+p}var xl=0,bl=function(l){this._sortAcrossTiles="viewport-y"!==l.layout.get("symbol-z-order")&&!l.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]};bl.prototype.continuePlacement=function(l,p,c,y,C){for(var T=this._bucketParts;this._currentTileIndex<l.length;)if(p.getBucketParts(T,y,l[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,C())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,T.sort(function(L,z){return L.sortKey-z.sortKey}));this._currentPartIndex<T.length;)if(p.placeLayerBucketPart(T[this._currentPartIndex],this._seenCrossTileIDs,c),this._currentPartIndex++,C())return!0;return!1};var Ho=function(l,p,c,y,C,T,L){this.placement=new bo(l,C,T,L),this._currentPlacementIndex=p.length-1,this._forceFullPlacement=c,this._showCollisionBoxes=y,this._done=!1};Ho.prototype.isDone=function(){return this._done},Ho.prototype.continuePlacement=function(l,p,c){for(var y=this,C=v.browser.now(),T=function(){var Z=v.browser.now()-C;return!y._forceFullPlacement&&Z>2};this._currentPlacementIndex>=0;){var L=p[l[this._currentPlacementIndex]],z=this.placement.collisionIndex.transform.zoom;if("symbol"===L.type&&(!L.minzoom||L.minzoom<=z)&&(!L.maxzoom||L.maxzoom>z)){if(this._inProgressLayer||(this._inProgressLayer=new bl(L)),this._inProgressLayer.continuePlacement(c[L.source],this.placement,this._showCollisionBoxes,L,T))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0},Ho.prototype.commit=function(l){return this.placement.commit(l),this.placement};var Hu=512/v.EXTENT/2,Sa=function(l,p,c){this.tileID=l,this.indexedSymbolInstances={},this.bucketInstanceId=c;for(var y=0;y<p.length;y++){var C=p.get(y),T=C.key;this.indexedSymbolInstances[T]||(this.indexedSymbolInstances[T]=[]),this.indexedSymbolInstances[T].push({crossTileID:C.crossTileID,coord:this.getScaledCoordinates(C,l)})}};Sa.prototype.getScaledCoordinates=function(l,p){var c=Hu/Math.pow(2,p.canonical.z-this.tileID.canonical.z);return{x:Math.floor((p.canonical.x*v.EXTENT+l.anchorX)*c),y:Math.floor((p.canonical.y*v.EXTENT+l.anchorY)*c)}},Sa.prototype.findMatches=function(l,p,c){for(var y=this.tileID.canonical.z<p.canonical.z?1:Math.pow(2,this.tileID.canonical.z-p.canonical.z),C=0;C<l.length;C++){var T=l.get(C);if(!T.crossTileID){var L=this.indexedSymbolInstances[T.key];if(L)for(var z=this.getScaledCoordinates(T,p),Z=0,H=L;Z<H.length;Z+=1){var ut=H[Z];if(Math.abs(ut.coord.x-z.x)<=y&&Math.abs(ut.coord.y-z.y)<=y&&!c[ut.crossTileID]){c[ut.crossTileID]=!0,T.crossTileID=ut.crossTileID;break}}}}};var ni=function(){this.maxCrossTileID=0};ni.prototype.generate=function(){return++this.maxCrossTileID};var Jo=function(){this.indexes={},this.usedCrossTileIDs={},this.lng=0};Jo.prototype.handleWrapJump=function(l){var p=Math.round((l-this.lng)/360);if(0!==p)for(var c in this.indexes){var y=this.indexes[c],C={};for(var T in y){var L=y[T];L.tileID=L.tileID.unwrapTo(L.tileID.wrap+p),C[L.tileID.key]=L}this.indexes[c]=C}this.lng=l},Jo.prototype.addBucket=function(l,p,c){if(this.indexes[l.overscaledZ]&&this.indexes[l.overscaledZ][l.key]){if(this.indexes[l.overscaledZ][l.key].bucketInstanceId===p.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(l.overscaledZ,this.indexes[l.overscaledZ][l.key])}for(var y=0;y<p.symbolInstances.length;y++)p.symbolInstances.get(y).crossTileID=0;this.usedCrossTileIDs[l.overscaledZ]||(this.usedCrossTileIDs[l.overscaledZ]={});var C=this.usedCrossTileIDs[l.overscaledZ];for(var T in this.indexes){var L=this.indexes[T];if(Number(T)>l.overscaledZ)for(var z in L){var Z=L[z];Z.tileID.isChildOf(l)&&Z.findMatches(p.symbolInstances,l,C)}else{var H=L[l.scaledTo(Number(T)).key];H&&H.findMatches(p.symbolInstances,l,C)}}for(var ut=0;ut<p.symbolInstances.length;ut++){var gt=p.symbolInstances.get(ut);gt.crossTileID||(gt.crossTileID=c.generate(),C[gt.crossTileID]=!0)}return void 0===this.indexes[l.overscaledZ]&&(this.indexes[l.overscaledZ]={}),this.indexes[l.overscaledZ][l.key]=new Sa(l,p.symbolInstances,p.bucketInstanceId),!0},Jo.prototype.removeBucketCrossTileIDs=function(l,p){for(var c in p.indexedSymbolInstances)for(var y=0,C=p.indexedSymbolInstances[c];y<C.length;y+=1)delete this.usedCrossTileIDs[l][C[y].crossTileID]},Jo.prototype.removeStaleBuckets=function(l){var p=!1;for(var c in this.indexes){var y=this.indexes[c];for(var C in y)l[y[C].bucketInstanceId]||(this.removeBucketCrossTileIDs(c,y[C]),delete y[C],p=!0)}return p};var $i=function(){this.layerIndexes={},this.crossTileIDs=new ni,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}};$i.prototype.addLayer=function(l,p,c){var y=this.layerIndexes[l.id];void 0===y&&(y=this.layerIndexes[l.id]=new Jo);var C=!1,T={};y.handleWrapJump(c);for(var L=0,z=p;L<z.length;L+=1){var Z=z[L],H=Z.getBucket(l);H&&l.id===H.layerIds[0]&&(H.bucketInstanceId||(H.bucketInstanceId=++this.maxBucketInstanceId),y.addBucket(Z.tileID,H,this.crossTileIDs)&&(C=!0),T[H.bucketInstanceId]=!0)}return y.removeStaleBuckets(T)&&(C=!0),C},$i.prototype.pruneUnusedLayers=function(l){var p={};for(var c in l.forEach(function(y){p[y]=!0}),this.layerIndexes)p[c]||delete this.layerIndexes[c]};var zs=function(l,p){return v.emitValidationErrors(l,p&&p.filter(function(c){return"source.canvas"!==c.identifier}))},eu=v.pick(Ue,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData"]),hi=v.pick(Ue,["setCenter","setZoom","setBearing","setPitch"]),io=function(){var l={},p=v.styleSpec.$version;for(var c in v.styleSpec.$root){var y,C=v.styleSpec.$root[c];C.required&&null!=(y="version"===c?p:"array"===C.type?[]:{})&&(l[c]=y)}return l}(),Ka=function(l){function p(c,y){var C=this;void 0===y&&(y={}),l.call(this),this.map=c,this.dispatcher=new Ot(Tr(),this),this.imageManager=new qt,this.imageManager.setEventedParent(this),this.glyphManager=new tt(c._requestManager,y.localIdeographFontFamily),this.lineAtlas=new xt(256,512),this.crossTileSymbolIndex=new $i,this._layers={},this._serializedLayers={},this._order=[],this.sourceCaches={},this.zoomHistory=new v.ZoomHistory,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("setReferrer",v.getReferrer());var T=this;this._rtlTextPluginCallback=p.registerForPluginStateChange(function(L){T.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:L.pluginStatus,pluginURL:L.pluginURL},function(z,Z){if(v.triggerPluginCompletionEvent(z),Z&&Z.every(function(ut){return ut}))for(var H in T.sourceCaches)T.sourceCaches[H].reload()})}),this.on("data",function(L){if("source"===L.dataType&&"metadata"===L.sourceDataType){var z=C.sourceCaches[L.sourceId];if(z){var Z=z.getSource();if(Z&&Z.vectorLayerIds)for(var H in C._layers){var ut=C._layers[H];ut.source===Z.id&&C._validateLayer(ut)}}}})}return l&&(p.__proto__=l),(p.prototype=Object.create(l&&l.prototype)).constructor=p,p.prototype.loadURL=function(c,y){var C=this;void 0===y&&(y={}),this.fire(new v.Event("dataloading",{dataType:"style"}));var T="boolean"==typeof y.validate?y.validate:!v.isMapboxURL(c);c=this.map._requestManager.normalizeStyleURL(c,y.accessToken);var L=this.map._requestManager.transformRequest(c,v.ResourceType.Style);this._request=v.getJSON(L,function(z,Z){C._request=null,z?C.fire(new v.ErrorEvent(z)):Z&&C._load(Z,T)})},p.prototype.loadJSON=function(c,y){var C=this;void 0===y&&(y={}),this.fire(new v.Event("dataloading",{dataType:"style"})),this._request=v.browser.frame(function(){C._request=null,C._load(c,!1!==y.validate)})},p.prototype.loadEmpty=function(){this.fire(new v.Event("dataloading",{dataType:"style"})),this._load(io,!1)},p.prototype._load=function(c,y){if(!y||!zs(this,v.validateStyle(c))){for(var C in this._loaded=!0,this.stylesheet=c,c.sources)this.addSource(C,c.sources[C],{validate:!1});c.sprite?this._loadSprite(c.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(c.glyphs);var T=nr(this.stylesheet.layers);this._order=T.map(function(H){return H.id}),this._layers={},this._serializedLayers={};for(var L=0,z=T;L<z.length;L+=1){var Z=z[L];(Z=v.createStyleLayer(Z)).setEventedParent(this,{layer:{id:Z.id}}),this._layers[Z.id]=Z,this._serializedLayers[Z.id]=Z.serialize()}this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new re(this.stylesheet.light),this.fire(new v.Event("data",{dataType:"style"})),this.fire(new v.Event("style.load"))}},p.prototype._loadSprite=function(c){var y=this;this._spriteRequest=function(C,T,L){var z,Z,H,ut=v.browser.devicePixelRatio>1?"@2x":"",gt=v.getJSON(T.transformRequest(T.normalizeSpriteURL(C,ut,".json"),v.ResourceType.SpriteJSON),function(Rt,Yt){gt=null,H||(H=Rt,z=Yt,zt())}),ct=v.getImage(T.transformRequest(T.normalizeSpriteURL(C,ut,".png"),v.ResourceType.SpriteImage),function(Rt,Yt){ct=null,H||(H=Rt,Z=Yt,zt())});function zt(){if(H)L(H);else if(z&&Z){var Rt=v.browser.getImageData(Z),Yt={};for(var Dt in z){var Vt=z[Dt],ee=Vt.width,he=Vt.height,_e=Vt.x,ve=Vt.y,we=Vt.sdf,Ne=Vt.pixelRatio,qe=Vt.stretchX,ze=Vt.stretchY,Ve=Vt.content,$e=new v.RGBAImage({width:ee,height:he});v.RGBAImage.copy(Rt,$e,{x:_e,y:ve},{x:0,y:0},{width:ee,height:he}),Yt[Dt]={data:$e,pixelRatio:Ne,sdf:we,stretchX:qe,stretchY:ze,content:Ve}}L(null,Yt)}}return{cancel:function(){gt&&(gt.cancel(),gt=null),ct&&(ct.cancel(),ct=null)}}}(c,this.map._requestManager,function(C,T){if(y._spriteRequest=null,C)y.fire(new v.ErrorEvent(C));else if(T)for(var L in T)y.imageManager.addImage(L,T[L]);y.imageManager.setLoaded(!0),y._availableImages=y.imageManager.listImages(),y.dispatcher.broadcast("setImages",y._availableImages),y.fire(new v.Event("data",{dataType:"style"}))})},p.prototype._validateLayer=function(c){var y=this.sourceCaches[c.source];if(y){var C=c.sourceLayer;if(C){var T=y.getSource();("geojson"===T.type||T.vectorLayerIds&&-1===T.vectorLayerIds.indexOf(C))&&this.fire(new v.ErrorEvent(new Error('Source layer "'+C+'" does not exist on source "'+T.id+'" as specified by style layer "'+c.id+'"')))}}},p.prototype.loaded=function(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(var c in this.sourceCaches)if(!this.sourceCaches[c].loaded())return!1;return!!this.imageManager.isLoaded()},p.prototype._serializeLayers=function(c){for(var y=[],C=0,T=c;C<T.length;C+=1){var L=this._layers[T[C]];"custom"!==L.type&&y.push(L.serialize())}return y},p.prototype.hasTransitions=function(){if(this.light&&this.light.hasTransition())return!0;for(var c in this.sourceCaches)if(this.sourceCaches[c].hasTransition())return!0;for(var y in this._layers)if(this._layers[y].hasTransition())return!0;return!1},p.prototype._checkLoaded=function(){if(!this._loaded)throw new Error("Style is not done loading")},p.prototype.update=function(c){if(this._loaded){var y=this._changed;if(this._changed){var C=Object.keys(this._updatedLayers),T=Object.keys(this._removedLayers);for(var L in(C.length||T.length)&&this._updateWorkerLayers(C,T),this._updatedSources){var z=this._updatedSources[L];"reload"===z?this._reloadSource(L):"clear"===z&&this._clearSource(L)}for(var Z in this._updateTilesForChangedImages(),this._updatedPaintProps)this._layers[Z].updateTransitions(c);this.light.updateTransitions(c),this._resetUpdates()}var H={};for(var ut in this.sourceCaches){var gt=this.sourceCaches[ut];H[ut]=gt.used,gt.used=!1}for(var ct=0,zt=this._order;ct<zt.length;ct+=1){var Rt=this._layers[zt[ct]];Rt.recalculate(c,this._availableImages),!Rt.isHidden(c.zoom)&&Rt.source&&(this.sourceCaches[Rt.source].used=!0)}for(var Yt in H){var Dt=this.sourceCaches[Yt];H[Yt]!==Dt.used&&Dt.fire(new v.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:Yt}))}this.light.recalculate(c),this.z=c.zoom,y&&this.fire(new v.Event("data",{dataType:"style"}))}},p.prototype._updateTilesForChangedImages=function(){var c=Object.keys(this._changedImages);if(c.length){for(var y in this.sourceCaches)this.sourceCaches[y].reloadTilesForDependencies(["icons","patterns"],c);this._changedImages={}}},p.prototype._updateWorkerLayers=function(c,y){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(c),removedIds:y})},p.prototype._resetUpdates=function(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}},p.prototype.setState=function(c){var y=this;if(this._checkLoaded(),zs(this,v.validateStyle(c)))return!1;(c=v.clone$1(c)).layers=nr(c.layers);var C=function(L,z){if(!L)return[{command:Ue.setStyle,args:[z]}];var Z=[];try{if(!v.deepEqual(L.version,z.version))return[{command:Ue.setStyle,args:[z]}];v.deepEqual(L.center,z.center)||Z.push({command:Ue.setCenter,args:[z.center]}),v.deepEqual(L.zoom,z.zoom)||Z.push({command:Ue.setZoom,args:[z.zoom]}),v.deepEqual(L.bearing,z.bearing)||Z.push({command:Ue.setBearing,args:[z.bearing]}),v.deepEqual(L.pitch,z.pitch)||Z.push({command:Ue.setPitch,args:[z.pitch]}),v.deepEqual(L.sprite,z.sprite)||Z.push({command:Ue.setSprite,args:[z.sprite]}),v.deepEqual(L.glyphs,z.glyphs)||Z.push({command:Ue.setGlyphs,args:[z.glyphs]}),v.deepEqual(L.transition,z.transition)||Z.push({command:Ue.setTransition,args:[z.transition]}),v.deepEqual(L.light,z.light)||Z.push({command:Ue.setLight,args:[z.light]});var H={},ut=[];!function(ct,zt,Rt,Yt){var Dt;for(Dt in zt=zt||{},ct=ct||{})ct.hasOwnProperty(Dt)&&(zt.hasOwnProperty(Dt)||Gr(Dt,Rt,Yt));for(Dt in zt)zt.hasOwnProperty(Dt)&&(ct.hasOwnProperty(Dt)?v.deepEqual(ct[Dt],zt[Dt])||("geojson"===ct[Dt].type&&"geojson"===zt[Dt].type&&un(ct,zt,Dt)?Rt.push({command:Ue.setGeoJSONSourceData,args:[Dt,zt[Dt].data]}):Sr(Dt,zt,Rt,Yt)):ln(Dt,zt,Rt))}(L.sources,z.sources,ut,H);var gt=[];L.layers&&L.layers.forEach(function(ct){H[ct.source]?Z.push({command:Ue.removeLayer,args:[ct.id]}):gt.push(ct)}),Z=Z.concat(ut),function(ct,zt,Rt){zt=zt||[];var Yt,Dt,Vt,ee,he,_e,ve,we=(ct=ct||[]).map(ci),Ne=zt.map(ci),qe=ct.reduce(On,{}),ze=zt.reduce(On,{}),Ve=we.slice(),$e=Object.create(null);for(Yt=0,Dt=0;Yt<we.length;Yt++)ze.hasOwnProperty(Vt=we[Yt])?Dt++:(Rt.push({command:Ue.removeLayer,args:[Vt]}),Ve.splice(Ve.indexOf(Vt,Dt),1));for(Yt=0,Dt=0;Yt<Ne.length;Yt++)Ve[Ve.length-1-Yt]!==(Vt=Ne[Ne.length-1-Yt])&&(qe.hasOwnProperty(Vt)?(Rt.push({command:Ue.removeLayer,args:[Vt]}),Ve.splice(Ve.lastIndexOf(Vt,Ve.length-Dt),1)):Dt++,Rt.push({command:Ue.addLayer,args:[ze[Vt],_e=Ve[Ve.length-Yt]]}),Ve.splice(Ve.length-Yt,0,Vt),$e[Vt]=!0);for(Yt=0;Yt<Ne.length;Yt++)if(ee=qe[Vt=Ne[Yt]],he=ze[Vt],!$e[Vt]&&!v.deepEqual(ee,he))if(v.deepEqual(ee.source,he.source)&&v.deepEqual(ee["source-layer"],he["source-layer"])&&v.deepEqual(ee.type,he.type)){for(ve in ir(ee.layout,he.layout,Rt,Vt,null,Ue.setLayoutProperty),ir(ee.paint,he.paint,Rt,Vt,null,Ue.setPaintProperty),v.deepEqual(ee.filter,he.filter)||Rt.push({command:Ue.setFilter,args:[Vt,he.filter]}),v.deepEqual(ee.minzoom,he.minzoom)&&v.deepEqual(ee.maxzoom,he.maxzoom)||Rt.push({command:Ue.setLayerZoomRange,args:[Vt,he.minzoom,he.maxzoom]}),ee)ee.hasOwnProperty(ve)&&"layout"!==ve&&"paint"!==ve&&"filter"!==ve&&"metadata"!==ve&&"minzoom"!==ve&&"maxzoom"!==ve&&(0===ve.indexOf("paint.")?ir(ee[ve],he[ve],Rt,Vt,ve.slice(6),Ue.setPaintProperty):v.deepEqual(ee[ve],he[ve])||Rt.push({command:Ue.setLayerProperty,args:[Vt,ve,he[ve]]}));for(ve in he)he.hasOwnProperty(ve)&&!ee.hasOwnProperty(ve)&&"layout"!==ve&&"paint"!==ve&&"filter"!==ve&&"metadata"!==ve&&"minzoom"!==ve&&"maxzoom"!==ve&&(0===ve.indexOf("paint.")?ir(ee[ve],he[ve],Rt,Vt,ve.slice(6),Ue.setPaintProperty):v.deepEqual(ee[ve],he[ve])||Rt.push({command:Ue.setLayerProperty,args:[Vt,ve,he[ve]]}))}else Rt.push({command:Ue.removeLayer,args:[Vt]}),_e=Ve[Ve.lastIndexOf(Vt)+1],Rt.push({command:Ue.addLayer,args:[he,_e]})}(gt,z.layers,Z)}catch(ct){console.warn("Unable to compute style diff:",ct),Z=[{command:Ue.setStyle,args:[z]}]}return Z}(this.serialize(),c).filter(function(L){return!(L.command in hi)});if(0===C.length)return!1;var T=C.filter(function(L){return!(L.command in eu)});if(T.length>0)throw new Error("Unimplemented: "+T.map(function(L){return L.command}).join(", ")+".");return C.forEach(function(L){"setTransition"!==L.command&&y[L.command].apply(y,L.args)}),this.stylesheet=c,!0},p.prototype.addImage=function(c,y){if(this.getImage(c))return this.fire(new v.ErrorEvent(new Error("An image with this name already exists.")));this.imageManager.addImage(c,y),this._afterImageUpdated(c)},p.prototype.updateImage=function(c,y){this.imageManager.updateImage(c,y)},p.prototype.getImage=function(c){return this.imageManager.getImage(c)},p.prototype.removeImage=function(c){if(!this.getImage(c))return this.fire(new v.ErrorEvent(new Error("No image with this name exists.")));this.imageManager.removeImage(c),this._afterImageUpdated(c)},p.prototype._afterImageUpdated=function(c){this._availableImages=this.imageManager.listImages(),this._changedImages[c]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new v.Event("data",{dataType:"style"}))},p.prototype.listImages=function(){return this._checkLoaded(),this.imageManager.listImages()},p.prototype.addSource=function(c,y,C){var T=this;if(void 0===C&&(C={}),this._checkLoaded(),void 0!==this.sourceCaches[c])throw new Error("There is already a source with this ID");if(!y.type)throw new Error("The type property must be defined, but only the following properties were given: "+Object.keys(y).join(", ")+".");if(!(["vector","raster","geojson","video","image"].indexOf(y.type)>=0&&this._validate(v.validateStyle.source,"sources."+c,y,null,C))){this.map&&this.map._collectResourceTiming&&(y.collectResourceTiming=!0);var L=this.sourceCaches[c]=new _t(c,y,this.dispatcher);L.style=this,L.setEventedParent(this,function(){return{isSourceLoaded:T.loaded(),source:L.serialize(),sourceId:c}}),L.onAdd(this.map),this._changed=!0}},p.prototype.removeSource=function(c){if(this._checkLoaded(),void 0===this.sourceCaches[c])throw new Error("There is no source with this ID");for(var y in this._layers)if(this._layers[y].source===c)return this.fire(new v.ErrorEvent(new Error('Source "'+c+'" cannot be removed while layer "'+y+'" is using it.')));var C=this.sourceCaches[c];delete this.sourceCaches[c],delete this._updatedSources[c],C.fire(new v.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:c})),C.setEventedParent(null),C.clearTiles(),C.onRemove&&C.onRemove(this.map),this._changed=!0},p.prototype.setGeoJSONSourceData=function(c,y){this._checkLoaded(),this.sourceCaches[c].getSource().setData(y),this._changed=!0},p.prototype.getSource=function(c){return this.sourceCaches[c]&&this.sourceCaches[c].getSource()},p.prototype.addLayer=function(c,y,C){void 0===C&&(C={}),this._checkLoaded();var T=c.id;if(this.getLayer(T))this.fire(new v.ErrorEvent(new Error('Layer with id "'+T+'" already exists on this map')));else{var L;if("custom"===c.type){if(zs(this,v.validateCustomStyleLayer(c)))return;L=v.createStyleLayer(c)}else{if("object"==typeof c.source&&(this.addSource(T,c.source),c=v.clone$1(c),c=v.extend(c,{source:T})),this._validate(v.validateStyle.layer,"layers."+T,c,{arrayIndex:-1},C))return;L=v.createStyleLayer(c),this._validateLayer(L),L.setEventedParent(this,{layer:{id:T}}),this._serializedLayers[L.id]=L.serialize()}var z=y?this._order.indexOf(y):this._order.length;if(y&&-1===z)this.fire(new v.ErrorEvent(new Error('Layer with id "'+y+'" does not exist on this map.')));else{if(this._order.splice(z,0,T),this._layerOrderChanged=!0,this._layers[T]=L,this._removedLayers[T]&&L.source&&"custom"!==L.type){var Z=this._removedLayers[T];delete this._removedLayers[T],Z.type!==L.type?this._updatedSources[L.source]="clear":(this._updatedSources[L.source]="reload",this.sourceCaches[L.source].pause())}this._updateLayer(L),L.onAdd&&L.onAdd(this.map)}}},p.prototype.moveLayer=function(c,y){if(this._checkLoaded(),this._changed=!0,this._layers[c]){if(c!==y){var C=this._order.indexOf(c);this._order.splice(C,1);var T=y?this._order.indexOf(y):this._order.length;y&&-1===T?this.fire(new v.ErrorEvent(new Error('Layer with id "'+y+'" does not exist on this map.'))):(this._order.splice(T,0,c),this._layerOrderChanged=!0)}}else this.fire(new v.ErrorEvent(new Error("The layer '"+c+"' does not exist in the map's style and cannot be moved.")))},p.prototype.removeLayer=function(c){this._checkLoaded();var y=this._layers[c];if(y){y.setEventedParent(null);var C=this._order.indexOf(c);this._order.splice(C,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[c]=y,delete this._layers[c],delete this._serializedLayers[c],delete this._updatedLayers[c],delete this._updatedPaintProps[c],y.onRemove&&y.onRemove(this.map)}else this.fire(new v.ErrorEvent(new Error("The layer '"+c+"' does not exist in the map's style and cannot be removed.")))},p.prototype.getLayer=function(c){return this._layers[c]},p.prototype.hasLayer=function(c){return c in this._layers},p.prototype.setLayerZoomRange=function(c,y,C){this._checkLoaded();var T=this.getLayer(c);T?T.minzoom===y&&T.maxzoom===C||(null!=y&&(T.minzoom=y),null!=C&&(T.maxzoom=C),this._updateLayer(T)):this.fire(new v.ErrorEvent(new Error("The layer '"+c+"' does not exist in the map's style and cannot have zoom extent.")))},p.prototype.setFilter=function(c,y,C){void 0===C&&(C={}),this._checkLoaded();var T=this.getLayer(c);if(T){if(!v.deepEqual(T.filter,y))return null==y?(T.filter=void 0,void this._updateLayer(T)):void(this._validate(v.validateStyle.filter,"layers."+T.id+".filter",y,null,C)||(T.filter=v.clone$1(y),this._updateLayer(T)))}else this.fire(new v.ErrorEvent(new Error("The layer '"+c+"' does not exist in the map's style and cannot be filtered.")))},p.prototype.getFilter=function(c){return v.clone$1(this.getLayer(c).filter)},p.prototype.setLayoutProperty=function(c,y,C,T){void 0===T&&(T={}),this._checkLoaded();var L=this.getLayer(c);L?v.deepEqual(L.getLayoutProperty(y),C)||(L.setLayoutProperty(y,C,T),this._updateLayer(L)):this.fire(new v.ErrorEvent(new Error("The layer '"+c+"' does not exist in the map's style and cannot be styled.")))},p.prototype.getLayoutProperty=function(c,y){var C=this.getLayer(c);if(C)return C.getLayoutProperty(y);this.fire(new v.ErrorEvent(new Error("The layer '"+c+"' does not exist in the map's style.")))},p.prototype.setPaintProperty=function(c,y,C,T){void 0===T&&(T={}),this._checkLoaded();var L=this.getLayer(c);L?v.deepEqual(L.getPaintProperty(y),C)||(L.setPaintProperty(y,C,T)&&this._updateLayer(L),this._changed=!0,this._updatedPaintProps[c]=!0):this.fire(new v.ErrorEvent(new Error("The layer '"+c+"' does not exist in the map's style and cannot be styled.")))},p.prototype.getPaintProperty=function(c,y){return this.getLayer(c).getPaintProperty(y)},p.prototype.setFeatureState=function(c,y){this._checkLoaded();var C=c.source,T=c.sourceLayer,L=this.sourceCaches[C];if(void 0!==L){var z=L.getSource().type;"geojson"===z&&T?this.fire(new v.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):"vector"!==z||T?(void 0===c.id&&this.fire(new v.ErrorEvent(new Error("The feature id parameter must be provided."))),L.setFeatureState(T,c.id,y)):this.fire(new v.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new v.ErrorEvent(new Error("The source '"+C+"' does not exist in the map's style.")))},p.prototype.removeFeatureState=function(c,y){this._checkLoaded();var C=c.source,T=this.sourceCaches[C];if(void 0!==T){var L=T.getSource().type,z="vector"===L?c.sourceLayer:void 0;"vector"!==L||z?y&&"string"!=typeof c.id&&"number"!=typeof c.id?this.fire(new v.ErrorEvent(new Error("A feature id is required to remove its specific state property."))):T.removeFeatureState(z,c.id,y):this.fire(new v.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new v.ErrorEvent(new Error("The source '"+C+"' does not exist in the map's style.")))},p.prototype.getFeatureState=function(c){this._checkLoaded();var y=c.source,C=c.sourceLayer,T=this.sourceCaches[y];if(void 0!==T){if("vector"!==T.getSource().type||C)return void 0===c.id&&this.fire(new v.ErrorEvent(new Error("The feature id parameter must be provided."))),T.getFeatureState(C,c.id);this.fire(new v.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new v.ErrorEvent(new Error("The source '"+y+"' does not exist in the map's style.")))},p.prototype.getTransition=function(){return v.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)},p.prototype.serialize=function(){return v.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,sources:v.mapObject(this.sourceCaches,function(c){return c.serialize()}),layers:this._serializeLayers(this._order)},function(c){return void 0!==c})},p.prototype._updateLayer=function(c){this._updatedLayers[c.id]=!0,c.source&&!this._updatedSources[c.source]&&"raster"!==this.sourceCaches[c.source].getSource().type&&(this._updatedSources[c.source]="reload",this.sourceCaches[c.source].pause()),this._changed=!0},p.prototype._flattenAndSortRenderedFeatures=function(c){for(var y=this,C=function(qe){return"fill-extrusion"===y._layers[qe].type},T={},L=[],z=this._order.length-1;z>=0;z--){var Z=this._order[z];if(C(Z)){T[Z]=z;for(var H=0,ut=c;H<ut.length;H+=1){var gt=ut[H][Z];if(gt)for(var ct=0,zt=gt;ct<zt.length;ct+=1)L.push(zt[ct])}}}L.sort(function(qe,ze){return ze.intersectionZ-qe.intersectionZ});for(var Rt=[],Yt=this._order.length-1;Yt>=0;Yt--){var Dt=this._order[Yt];if(C(Dt))for(var Vt=L.length-1;Vt>=0;Vt--){var ee=L[Vt].feature;if(T[ee.layer.id]<Yt)break;Rt.push(ee),L.pop()}else for(var he=0,_e=c;he<_e.length;he+=1){var ve=_e[he][Dt];if(ve)for(var we=0,Ne=ve;we<Ne.length;we+=1)Rt.push(Ne[we].feature)}}return Rt},p.prototype.queryRenderedFeatures=function(c,y,C){y&&y.filter&&this._validate(v.validateStyle.filter,"queryRenderedFeatures.filter",y.filter,null,y);var T={};if(y&&y.layers){if(!Array.isArray(y.layers))return this.fire(new v.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(var L=0,z=y.layers;L<z.length;L+=1){var Z=z[L],H=this._layers[Z];if(!H)return this.fire(new v.ErrorEvent(new Error("The layer '"+Z+"' does not exist in the map's style and cannot be queried for features."))),[];T[H.source]=!0}}var ut=[];for(var gt in y.availableImages=this._availableImages,this.sourceCaches)y.layers&&!T[gt]||ut.push(De(this.sourceCaches[gt],this._layers,this._serializedLayers,c,y,C));return this.placement&&ut.push(function(ct,zt,Rt,Yt,Dt,Vt,ee){for(var he={},_e=Vt.queryRenderedSymbols(Yt),ve=[],we=0,Ne=Object.keys(_e).map(Number);we<Ne.length;we+=1)ve.push(ee[Ne[we]]);ve.sort(Xr);for(var qe=function(){var tr=Ve[ze],Dr=tr.featureIndex.lookupSymbolFeatures(_e[tr.bucketInstanceId],zt,tr.bucketIndex,tr.sourceLayerIndex,Dt.filter,Dt.layers,Dt.availableImages,ct);for(var Xe in Dr){var vr=he[Xe]=he[Xe]||[],Pr=Dr[Xe];Pr.sort(function(fr,hr){var or=tr.featureSortOrder;if(or){var qr=or.indexOf(fr.featureIndex);return or.indexOf(hr.featureIndex)-qr}return hr.featureIndex-fr.featureIndex});for(var _r=0,mr=Pr;_r<mr.length;_r+=1)vr.push(mr[_r])}},ze=0,Ve=ve;ze<Ve.length;ze+=1)qe();var $e=function(tr){he[tr].forEach(function(Dr){var Xe=Dr.feature,vr=Rt[ct[tr].source].getFeatureState(Xe.layer["source-layer"],Xe.id);Xe.source=Xe.layer.source,Xe.layer["source-layer"]&&(Xe.sourceLayer=Xe.layer["source-layer"]),Xe.state=vr})};for(var rr in he)$e(rr);return he}(this._layers,this._serializedLayers,this.sourceCaches,c,y,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(ut)},p.prototype.querySourceFeatures=function(c,y){y&&y.filter&&this._validate(v.validateStyle.filter,"querySourceFeatures.filter",y.filter,null,y);var C=this.sourceCaches[c];return C?function(T,L){for(var z=T.getRenderableIds().map(function(zt){return T.getTileByID(zt)}),Z=[],H={},ut=0;ut<z.length;ut++){var gt=z[ut],ct=gt.tileID.canonical.key;H[ct]||(H[ct]=!0,gt.querySourceFeatures(Z,L))}return Z}(C,y):[]},p.prototype.addSourceType=function(c,y,C){return p.getSourceType(c)?C(new Error('A source type called "'+c+'" already exists.')):(p.setSourceType(c,y),y.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:c,url:y.workerSourceURL},C):C(null,null))},p.prototype.getLight=function(){return this.light.getLight()},p.prototype.setLight=function(c,y){void 0===y&&(y={}),this._checkLoaded();var C=this.light.getLight(),T=!1;for(var L in c)if(!v.deepEqual(c[L],C[L])){T=!0;break}if(T){var z={now:v.browser.now(),transition:v.extend({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(c,y),this.light.updateTransitions(z)}},p.prototype._validate=function(c,y,C,T,L){return void 0===L&&(L={}),(!L||!1!==L.validate)&&zs(this,c.call(v.validateStyle,v.extend({key:y,style:this.serialize(),value:C,styleSpec:v.styleSpec},T)))},p.prototype._remove=function(){for(var c in this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),v.evented.off("pluginStateChange",this._rtlTextPluginCallback),this._layers)this._layers[c].setEventedParent(null);for(var y in this.sourceCaches)this.sourceCaches[y].clearTiles(),this.sourceCaches[y].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()},p.prototype._clearSource=function(c){this.sourceCaches[c].clearTiles()},p.prototype._reloadSource=function(c){this.sourceCaches[c].resume(),this.sourceCaches[c].reload()},p.prototype._updateSources=function(c){for(var y in this.sourceCaches)this.sourceCaches[y].update(c)},p.prototype._generateCollisionBoxes=function(){for(var c in this.sourceCaches)this._reloadSource(c)},p.prototype._updatePlacement=function(c,y,C,T,L){void 0===L&&(L=!1);for(var z=!1,Z=!1,H={},ut=0,gt=this._order;ut<gt.length;ut+=1){var ct=this._layers[gt[ut]];if("symbol"===ct.type){if(!H[ct.source]){var zt=this.sourceCaches[ct.source];H[ct.source]=zt.getRenderableIds(!0).map(function(ee){return zt.getTileByID(ee)}).sort(function(ee,he){return he.tileID.overscaledZ-ee.tileID.overscaledZ||(ee.tileID.isLessThan(he.tileID)?-1:1)})}var Rt=this.crossTileSymbolIndex.addLayer(ct,H[ct.source],c.center.lng);z=z||Rt}}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((L=L||this._layerOrderChanged||0===C)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(v.browser.now(),c.zoom))&&(this.pauseablePlacement=new Ho(c,this._order,L,y,C,T,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,H),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(v.browser.now()),Z=!0),z&&this.pauseablePlacement.placement.setStale()),Z||z)for(var Yt=0,Dt=this._order;Yt<Dt.length;Yt+=1){var Vt=this._layers[Dt[Yt]];"symbol"===Vt.type&&this.placement.updateLayerOpacities(Vt,H[Vt.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(v.browser.now())},p.prototype._releaseSymbolFadeTiles=function(){for(var c in this.sourceCaches)this.sourceCaches[c].releaseSymbolFadeTiles()},p.prototype.getImages=function(c,y,C){this.imageManager.getImages(y.icons,C),this._updateTilesForChangedImages();var T=this.sourceCaches[y.source];T&&T.setDependencies(y.tileID.key,y.type,y.icons)},p.prototype.getGlyphs=function(c,y,C){this.glyphManager.getGlyphs(y.stacks,C)},p.prototype.getResource=function(c,y,C){return v.makeRequest(y,C)},p}(v.Evented);Ka.getSourceType=function(l){return Fe[l]},Ka.setSourceType=function(l,p){Fe[l]=p},Ka.registerForPluginStateChange=v.registerForPluginStateChange;var co=v.createLayout([{name:"a_pos",type:"Int16",components:2}]),Ei=Ci("#ifdef GL_ES\nprecision mediump float;\n#else\n#if !defined(lowp)\n#define lowp\n#endif\n#if !defined(mediump)\n#define mediump\n#endif\n#if !defined(highp)\n#define highp\n#endif\n#endif","#ifdef GL_ES\nprecision highp float;\n#else\n#if !defined(lowp)\n#define lowp\n#endif\n#if !defined(mediump)\n#define mediump\n#endif\n#if !defined(highp)\n#define highp\n#endif\n#endif\nvec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0\n);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}"),xs=Ci("uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),fu=Ci("uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),ho=Ci("varying vec3 v_data;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvoid main(void) {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,0,1);} else {gl_Position=u_matrix*vec4(circle_center,0,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}"),Pc=Ci("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),oa=Ci("uniform highp float u_intensity;varying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#define GAUSS_COEF 0.3989422804014327\nvoid main() {\n#pragma mapbox: initialize highp float weight\nfloat d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#pragma mapbox: define mediump float radius\nconst highp float ZERO=1.0/255.0/16.0;\n#define GAUSS_COEF 0.3989422804014327\nvoid main(void) {\n#pragma mapbox: initialize highp float weight\n#pragma mapbox: initialize mediump float radius\nvec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}"),Fi=Ci("uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(0.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),to=Ci("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,0.0,1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),Fu=Ci("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),Hl=Ci("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,0,1);}"),du=Ci("#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_FragColor=color*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);}"),Jl=Ci("varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}"),ru=Ci("uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}"),wo=Ci("uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}"),cs=Ci("varying vec4 v_color;void main() {gl_FragColor=v_color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec4 v_color;\n#pragma mapbox: define highp float base\n#pragma mapbox: define highp float height\n#pragma mapbox: define highp vec4 color\nvoid main() {\n#pragma mapbox: initialize highp float base\n#pragma mapbox: initialize highp float height\n#pragma mapbox: initialize highp vec4 color\nvec3 normal=a_normal_ed.xyz;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}"),si=Ci("uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0\n? a_pos\n: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}"),Gs=Ci("#ifdef GL_ES\nprecision highp float;\n#endif\nuniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),Go=Ci("uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;\n#define PI 3.141592653589793\nvoid main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),Qa=Ci("uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}"),vi=Ci("uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}"),Fr=Ci("uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\n#define LINE_DISTANCE_SCALE 2.0\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}"),nu=Ci("uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\n#define LINE_DISTANCE_SCALE 2.0\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}"),ks=Ci("uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),po=Ci("uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nlowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),0.0,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));}"),Vo=Ci("#define SDF_PX 8.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}"),iu=Ci("#define SDF_PX 8.0\n#define SDF 1.0\n#define ICON 0.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\nreturn;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}");function Ci(l,p){var c=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,y=p.match(/attribute ([\w]+) ([\w]+)/g),C=l.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),T=p.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),L=T?T.concat(C):C,z={};return{fragmentSource:l=l.replace(c,function(Z,H,ut,gt,ct){return z[ct]=!0,"define"===H?"\n#ifndef HAS_UNIFORM_u_"+ct+"\nvarying "+ut+" "+gt+" "+ct+";\n#else\nuniform "+ut+" "+gt+" u_"+ct+";\n#endif\n":"\n#ifdef HAS_UNIFORM_u_"+ct+"\n    "+ut+" "+gt+" "+ct+" = u_"+ct+";\n#endif\n"}),vertexSource:p=p.replace(c,function(Z,H,ut,gt,ct){var zt="float"===gt?"vec2":"vec4",Rt=ct.match(/color/)?"color":zt;return z[ct]?"define"===H?"\n#ifndef HAS_UNIFORM_u_"+ct+"\nuniform lowp float u_"+ct+"_t;\nattribute "+ut+" "+zt+" a_"+ct+";\nvarying "+ut+" "+gt+" "+ct+";\n#else\nuniform "+ut+" "+gt+" u_"+ct+";\n#endif\n":"vec4"===Rt?"\n#ifndef HAS_UNIFORM_u_"+ct+"\n    "+ct+" = a_"+ct+";\n#else\n    "+ut+" "+gt+" "+ct+" = u_"+ct+";\n#endif\n":"\n#ifndef HAS_UNIFORM_u_"+ct+"\n    "+ct+" = unpack_mix_"+Rt+"(a_"+ct+", u_"+ct+"_t);\n#else\n    "+ut+" "+gt+" "+ct+" = u_"+ct+";\n#endif\n":"define"===H?"\n#ifndef HAS_UNIFORM_u_"+ct+"\nuniform lowp float u_"+ct+"_t;\nattribute "+ut+" "+zt+" a_"+ct+";\n#else\nuniform "+ut+" "+gt+" u_"+ct+";\n#endif\n":"vec4"===Rt?"\n#ifndef HAS_UNIFORM_u_"+ct+"\n    "+ut+" "+gt+" "+ct+" = a_"+ct+";\n#else\n    "+ut+" "+gt+" "+ct+" = u_"+ct+";\n#endif\n":"\n#ifndef HAS_UNIFORM_u_"+ct+"\n    "+ut+" "+gt+" "+ct+" = unpack_mix_"+Rt+"(a_"+ct+", u_"+ct+"_t);\n#else\n    "+ut+" "+gt+" "+ct+" = u_"+ct+";\n#endif\n"}),staticAttributes:y,staticUniforms:L}}var gu=Object.freeze({__proto__:null,prelude:Ei,background:xs,backgroundPattern:fu,circle:ho,clippingMask:Pc,heatmap:oa,heatmapTexture:Fi,collisionBox:to,collisionCircle:Fu,debug:Hl,fill:du,fillOutline:Jl,fillOutlinePattern:ru,fillPattern:wo,fillExtrusion:cs,fillExtrusionPattern:si,hillshadePrepare:Gs,hillshade:Go,line:Qa,lineGradient:vi,linePattern:Fr,lineSDF:nu,raster:ks,symbolIcon:po,symbolSDF:Vo,symbolTextAndIcon:iu}),Ju=function(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null};function Hn(l){for(var p=[],c=0;c<l.length;c++)if(null!==l[c]){var y=l[c].split(" ");p.push(y.pop())}return p}Ju.prototype.bind=function(l,p,c,y,C,T,L,z){this.context=l;for(var Z=this.boundPaintVertexBuffers.length!==y.length,H=0;!Z&&H<y.length;H++)this.boundPaintVertexBuffers[H]!==y[H]&&(Z=!0);l.extVertexArrayObject&&this.vao&&this.boundProgram===p&&this.boundLayoutVertexBuffer===c&&!Z&&this.boundIndexBuffer===C&&this.boundVertexOffset===T&&this.boundDynamicVertexBuffer===L&&this.boundDynamicVertexBuffer2===z?(l.bindVertexArrayOES.set(this.vao),L&&L.bind(),C&&C.dynamicDraw&&C.bind(),z&&z.bind()):this.freshBind(p,c,y,C,T,L,z)},Ju.prototype.freshBind=function(l,p,c,y,C,T,L){var z,Z=l.numAttributes,H=this.context,ut=H.gl;if(H.extVertexArrayObject)this.vao&&this.destroy(),this.vao=H.extVertexArrayObject.createVertexArrayOES(),H.bindVertexArrayOES.set(this.vao),z=0,this.boundProgram=l,this.boundLayoutVertexBuffer=p,this.boundPaintVertexBuffers=c,this.boundIndexBuffer=y,this.boundVertexOffset=C,this.boundDynamicVertexBuffer=T,this.boundDynamicVertexBuffer2=L;else{z=H.currentNumAttributes||0;for(var gt=Z;gt<z;gt++)ut.disableVertexAttribArray(gt)}p.enableAttributes(ut,l);for(var ct=0,zt=c;ct<zt.length;ct+=1)zt[ct].enableAttributes(ut,l);T&&T.enableAttributes(ut,l),L&&L.enableAttributes(ut,l),p.bind(),p.setVertexAttribPointers(ut,l,C);for(var Rt=0,Yt=c;Rt<Yt.length;Rt+=1){var Dt=Yt[Rt];Dt.bind(),Dt.setVertexAttribPointers(ut,l,C)}T&&(T.bind(),T.setVertexAttribPointers(ut,l,C)),y&&y.bind(),L&&(L.bind(),L.setVertexAttribPointers(ut,l,C)),H.currentNumAttributes=Z},Ju.prototype.destroy=function(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)};var bs=function(l,p,c,y,C,T){var L=l.gl;this.program=L.createProgram();for(var z=Hn(c.staticAttributes),Z=y?y.getBinderAttributes():[],H=z.concat(Z),ut=c.staticUniforms?Hn(c.staticUniforms):[],gt=y?y.getBinderUniforms():[],ct=[],zt=0,Rt=ut.concat(gt);zt<Rt.length;zt+=1){var Yt=Rt[zt];ct.indexOf(Yt)<0&&ct.push(Yt)}var Dt=y?y.defines():[];T&&Dt.push("#define OVERDRAW_INSPECTOR;");var Vt=Dt.concat(Ei.fragmentSource,c.fragmentSource).join("\n"),ee=Dt.concat(Ei.vertexSource,c.vertexSource).join("\n"),he=L.createShader(L.FRAGMENT_SHADER);if(L.isContextLost())this.failedToCreate=!0;else{L.shaderSource(he,Vt),L.compileShader(he),L.attachShader(this.program,he);var _e=L.createShader(L.VERTEX_SHADER);if(L.isContextLost())this.failedToCreate=!0;else{L.shaderSource(_e,ee),L.compileShader(_e),L.attachShader(this.program,_e),this.attributes={};var ve={};this.numAttributes=H.length;for(var we=0;we<this.numAttributes;we++)H[we]&&(L.bindAttribLocation(this.program,we,H[we]),this.attributes[H[we]]=we);L.linkProgram(this.program),L.deleteShader(_e),L.deleteShader(he);for(var Ne=0;Ne<ct.length;Ne++){var qe=ct[Ne];if(qe&&!ve[qe]){var ze=L.getUniformLocation(this.program,qe);ze&&(ve[qe]=ze)}}this.fixedUniforms=C(l,ve),this.binderUniforms=y?y.getUniforms(l,ve):[]}}};function Vi(l,p,c){var y=1/Wi(c,1,p.transform.tileZoom),C=Math.pow(2,c.tileID.overscaledZ),T=c.tileSize*Math.pow(2,p.transform.tileZoom)/C,L=T*(c.tileID.canonical.x+c.tileID.wrap*C),z=T*c.tileID.canonical.y;return{u_image:0,u_texsize:c.imageAtlasTexture.size,u_scale:[y,l.fromScale,l.toScale],u_fade:l.t,u_pixel_coord_upper:[L>>16,z>>16],u_pixel_coord_lower:[65535&L,65535&z]}}bs.prototype.draw=function(l,p,c,y,C,T,L,z,Z,H,ut,gt,ct,zt,Rt,Yt){var Dt,Vt=l.gl;if(!this.failedToCreate){for(var ee in l.program.set(this.program),l.setDepthMode(c),l.setStencilMode(y),l.setColorMode(C),l.setCullFace(T),this.fixedUniforms)this.fixedUniforms[ee].set(L[ee]);zt&&zt.setUniforms(l,this.binderUniforms,gt,{zoom:ct});for(var he=(Dt={},Dt[Vt.LINES]=2,Dt[Vt.TRIANGLES]=3,Dt[Vt.LINE_STRIP]=1,Dt)[p],_e=0,ve=ut.get();_e<ve.length;_e+=1){var we=ve[_e],Ne=we.vaos||(we.vaos={});(Ne[z]||(Ne[z]=new Ju)).bind(l,this,Z,zt?zt.getPaintVertexBuffers():[],H,we.vertexOffset,Rt,Yt),Vt.drawElements(p,we.primitiveLength*he,Vt.UNSIGNED_SHORT,we.primitiveOffset*he*2)}}};var Pu=function(l,p,c,y){var C=p.style.light,T=C.properties.get("position"),L=[T.x,T.y,T.z],z=v.create$1();"viewport"===C.properties.get("anchor")&&v.fromRotation(z,-p.transform.angle),v.transformMat3(L,L,z);var Z=C.properties.get("color");return{u_matrix:l,u_lightpos:L,u_lightintensity:C.properties.get("intensity"),u_lightcolor:[Z.r,Z.g,Z.b],u_vertical_gradient:+c,u_opacity:y}},Ia=function(l,p,c,y,C,T,L){return v.extend(Pu(l,p,c,y),Vi(T,p,L),{u_height_factor:-Math.pow(2,C.overscaledZ)/L.tileSize/8})},Vs=function(l){return{u_matrix:l}},Cn=function(l,p,c,y){return v.extend(Vs(l),Vi(c,p,y))},ws=function(l,p){return{u_matrix:l,u_world:p}},Pi=function(l,p,c,y,C){return v.extend(Cn(l,p,c,y),{u_world:C})},Bu=function(l,p,c,y){var C,T,L=l.transform;if("map"===y.paint.get("circle-pitch-alignment")){var z=Wi(c,1,L.zoom);C=!0,T=[z,z]}else C=!1,T=L.pixelsToGLUnits;return{u_camera_to_center_distance:L.cameraToCenterDistance,u_scale_with_map:+("map"===y.paint.get("circle-pitch-scale")),u_matrix:l.translatePosMatrix(p.posMatrix,c,y.paint.get("circle-translate"),y.paint.get("circle-translate-anchor")),u_pitch_with_map:+C,u_device_pixel_ratio:v.browser.devicePixelRatio,u_extrude_scale:T}},Ko=function(l,p,c){var y=Wi(c,1,p.zoom),C=Math.pow(2,p.zoom-c.tileID.overscaledZ),T=c.tileID.overscaleFactor();return{u_matrix:l,u_camera_to_center_distance:p.cameraToCenterDistance,u_pixels_to_tile_units:y,u_extrude_scale:[p.pixelsToGLUnits[0]/(y*C),p.pixelsToGLUnits[1]/(y*C)],u_overscale_factor:T}},$a=function(l,p,c){return{u_matrix:l,u_inv_matrix:p,u_camera_to_center_distance:c.cameraToCenterDistance,u_viewport_size:[c.width,c.height]}},Ku=function(l,p,c){return void 0===c&&(c=1),{u_matrix:l,u_color:p,u_overlay:0,u_overlay_scale:c}},ts=function(l){return{u_matrix:l}},Nn=function(l,p,c,y){return{u_matrix:l,u_extrude_scale:Wi(p,1,c),u_intensity:y}},va=function(l,p,c){var y=l.transform;return{u_matrix:Uu(l,p,c),u_ratio:1/Wi(p,1,y.zoom),u_device_pixel_ratio:v.browser.devicePixelRatio,u_units_to_pixels:[1/y.pixelsToGLUnits[0],1/y.pixelsToGLUnits[1]]}},mu=function(l,p,c,y){return v.extend(va(l,p,c),{u_image:0,u_image_height:y})},Xn=function(l,p,c,y){var C=l.transform,T=Oo(p,C);return{u_matrix:Uu(l,p,c),u_texsize:p.imageAtlasTexture.size,u_ratio:1/Wi(p,1,C.zoom),u_device_pixel_ratio:v.browser.devicePixelRatio,u_image:0,u_scale:[T,y.fromScale,y.toScale],u_fade:y.t,u_units_to_pixels:[1/C.pixelsToGLUnits[0],1/C.pixelsToGLUnits[1]]}},aa=function(l,p,c,y,C){var T=l.lineAtlas,L=Oo(p,l.transform),z="round"===c.layout.get("line-cap"),Z=T.getDash(y.from,z),H=T.getDash(y.to,z),ut=Z.width*C.fromScale,gt=H.width*C.toScale;return v.extend(va(l,p,c),{u_patternscale_a:[L/ut,-Z.height/2],u_patternscale_b:[L/gt,-H.height/2],u_sdfgamma:T.width/(256*Math.min(ut,gt)*v.browser.devicePixelRatio)/2,u_image:0,u_tex_y_a:Z.y,u_tex_y_b:H.y,u_mix:C.t})};function Oo(l,p){return 1/Wi(l,1,p.tileZoom)}function Uu(l,p,c){return l.translatePosMatrix(p.tileID.posMatrix,p,c.paint.get("line-translate"),c.paint.get("line-translate-anchor"))}var Mc=function(l,p,c,y,C){return{u_matrix:l,u_tl_parent:p,u_scale_parent:c,u_buffer_scale:1,u_fade_t:y.mix,u_opacity:y.opacity*C.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:C.paint.get("raster-brightness-min"),u_brightness_high:C.paint.get("raster-brightness-max"),u_saturation_factor:(L=C.paint.get("raster-saturation"),L>0?1-1/(1.001-L):-L),u_contrast_factor:(T=C.paint.get("raster-contrast"),T>0?1/(1-T):1+T),u_spin_weights:ou(C.paint.get("raster-hue-rotate"))};var T,L};function ou(l){l*=Math.PI/180;var p=Math.sin(l),c=Math.cos(l);return[(2*c+1)/3,(-Math.sqrt(3)*p-c+1)/3,(Math.sqrt(3)*p-c+1)/3]}var _a,au=function(l,p,c,y,C,T,L,z,Z,H){var ut=C.transform;return{u_is_size_zoom_constant:+("constant"===l||"source"===l),u_is_size_feature_constant:+("constant"===l||"camera"===l),u_size_t:p?p.uSizeT:0,u_size:p?p.uSize:0,u_camera_to_center_distance:ut.cameraToCenterDistance,u_pitch:ut.pitch/360*2*Math.PI,u_rotate_symbol:+c,u_aspect_ratio:ut.width/ut.height,u_fade_change:C.options.fadeDuration?C.symbolFadeChange:1,u_matrix:T,u_label_plane_matrix:L,u_coord_matrix:z,u_is_text:+Z,u_pitch_with_map:+y,u_texsize:H,u_texture:0}},jo=function(l,p,c,y,C,T,L,z,Z,H,ut){var gt=C.transform;return v.extend(au(l,p,c,y,C,T,L,z,Z,H),{u_gamma_scale:y?Math.cos(gt._pitch)*gt.cameraToCenterDistance:1,u_device_pixel_ratio:v.browser.devicePixelRatio,u_is_halo:+ut})},Na=function(l,p,c,y,C,T,L,z,Z,H){return v.extend(jo(l,p,c,y,C,T,L,z,!0,Z,!0),{u_texsize_icon:H,u_texture_icon:1})},Pa=function(l,p,c){return{u_matrix:l,u_opacity:p,u_color:c}},hs=function(l,p,c,y,C,T){return v.extend((z=T,H=C,ut=(Z=c).imageManager.getPattern((L=y).from.toString()),gt=Z.imageManager.getPattern(L.to.toString()),zt=(ct=Z.imageManager.getPixelSize()).width,Rt=ct.height,Yt=Math.pow(2,H.tileID.overscaledZ),Vt=(Dt=H.tileSize*Math.pow(2,Z.transform.tileZoom)/Yt)*(H.tileID.canonical.x+H.tileID.wrap*Yt),ee=Dt*H.tileID.canonical.y,{u_image:0,u_pattern_tl_a:ut.tl,u_pattern_br_a:ut.br,u_pattern_tl_b:gt.tl,u_pattern_br_b:gt.br,u_texsize:[zt,Rt],u_mix:z.t,u_pattern_size_a:ut.displaySize,u_pattern_size_b:gt.displaySize,u_scale_a:z.fromScale,u_scale_b:z.toScale,u_tile_units_to_pixels:1/Wi(H,1,Z.transform.tileZoom),u_pixel_coord_upper:[Vt>>16,ee>>16],u_pixel_coord_lower:[65535&Vt,65535&ee]}),{u_matrix:l,u_opacity:p});var L,z,Z,H,ut,gt,ct,zt,Rt,Yt,Dt,Vt,ee},za={fillExtrusion:function(l,p){return{u_matrix:new v.UniformMatrix4f(l,p.u_matrix),u_lightpos:new v.Uniform3f(l,p.u_lightpos),u_lightintensity:new v.Uniform1f(l,p.u_lightintensity),u_lightcolor:new v.Uniform3f(l,p.u_lightcolor),u_vertical_gradient:new v.Uniform1f(l,p.u_vertical_gradient),u_opacity:new v.Uniform1f(l,p.u_opacity)}},fillExtrusionPattern:function(l,p){return{u_matrix:new v.UniformMatrix4f(l,p.u_matrix),u_lightpos:new v.Uniform3f(l,p.u_lightpos),u_lightintensity:new v.Uniform1f(l,p.u_lightintensity),u_lightcolor:new v.Uniform3f(l,p.u_lightcolor),u_vertical_gradient:new v.Uniform1f(l,p.u_vertical_gradient),u_height_factor:new v.Uniform1f(l,p.u_height_factor),u_image:new v.Uniform1i(l,p.u_image),u_texsize:new v.Uniform2f(l,p.u_texsize),u_pixel_coord_upper:new v.Uniform2f(l,p.u_pixel_coord_upper),u_pixel_coord_lower:new v.Uniform2f(l,p.u_pixel_coord_lower),u_scale:new v.Uniform3f(l,p.u_scale),u_fade:new v.Uniform1f(l,p.u_fade),u_opacity:new v.Uniform1f(l,p.u_opacity)}},fill:function(l,p){return{u_matrix:new v.UniformMatrix4f(l,p.u_matrix)}},fillPattern:function(l,p){return{u_matrix:new v.UniformMatrix4f(l,p.u_matrix),u_image:new v.Uniform1i(l,p.u_image),u_texsize:new v.Uniform2f(l,p.u_texsize),u_pixel_coord_upper:new v.Uniform2f(l,p.u_pixel_coord_upper),u_pixel_coord_lower:new v.Uniform2f(l,p.u_pixel_coord_lower),u_scale:new v.Uniform3f(l,p.u_scale),u_fade:new v.Uniform1f(l,p.u_fade)}},fillOutline:function(l,p){return{u_matrix:new v.UniformMatrix4f(l,p.u_matrix),u_world:new v.Uniform2f(l,p.u_world)}},fillOutlinePattern:function(l,p){return{u_matrix:new v.UniformMatrix4f(l,p.u_matrix),u_world:new v.Uniform2f(l,p.u_world),u_image:new v.Uniform1i(l,p.u_image),u_texsize:new v.Uniform2f(l,p.u_texsize),u_pixel_coord_upper:new v.Uniform2f(l,p.u_pixel_coord_upper),u_pixel_coord_lower:new v.Uniform2f(l,p.u_pixel_coord_lower),u_scale:new v.Uniform3f(l,p.u_scale),u_fade:new v.Uniform1f(l,p.u_fade)}},circle:function(l,p){return{u_camera_to_center_distance:new v.Uniform1f(l,p.u_camera_to_center_distance),u_scale_with_map:new v.Uniform1i(l,p.u_scale_with_map),u_pitch_with_map:new v.Uniform1i(l,p.u_pitch_with_map),u_extrude_scale:new v.Uniform2f(l,p.u_extrude_scale),u_device_pixel_ratio:new v.Uniform1f(l,p.u_device_pixel_ratio),u_matrix:new v.UniformMatrix4f(l,p.u_matrix)}},collisionBox:function(l,p){return{u_matrix:new v.UniformMatrix4f(l,p.u_matrix),u_camera_to_center_distance:new v.Uniform1f(l,p.u_camera_to_center_distance),u_pixels_to_tile_units:new v.Uniform1f(l,p.u_pixels_to_tile_units),u_extrude_scale:new v.Uniform2f(l,p.u_extrude_scale),u_overscale_factor:new v.Uniform1f(l,p.u_overscale_factor)}},collisionCircle:function(l,p){return{u_matrix:new v.UniformMatrix4f(l,p.u_matrix),u_inv_matrix:new v.UniformMatrix4f(l,p.u_inv_matrix),u_camera_to_center_distance:new v.Uniform1f(l,p.u_camera_to_center_distance),u_viewport_size:new v.Uniform2f(l,p.u_viewport_size)}},debug:function(l,p){return{u_color:new v.UniformColor(l,p.u_color),u_matrix:new v.UniformMatrix4f(l,p.u_matrix),u_overlay:new v.Uniform1i(l,p.u_overlay),u_overlay_scale:new v.Uniform1f(l,p.u_overlay_scale)}},clippingMask:function(l,p){return{u_matrix:new v.UniformMatrix4f(l,p.u_matrix)}},heatmap:function(l,p){return{u_extrude_scale:new v.Uniform1f(l,p.u_extrude_scale),u_intensity:new v.Uniform1f(l,p.u_intensity),u_matrix:new v.UniformMatrix4f(l,p.u_matrix)}},heatmapTexture:function(l,p){return{u_matrix:new v.UniformMatrix4f(l,p.u_matrix),u_world:new v.Uniform2f(l,p.u_world),u_image:new v.Uniform1i(l,p.u_image),u_color_ramp:new v.Uniform1i(l,p.u_color_ramp),u_opacity:new v.Uniform1f(l,p.u_opacity)}},hillshade:function(l,p){return{u_matrix:new v.UniformMatrix4f(l,p.u_matrix),u_image:new v.Uniform1i(l,p.u_image),u_latrange:new v.Uniform2f(l,p.u_latrange),u_light:new v.Uniform2f(l,p.u_light),u_shadow:new v.UniformColor(l,p.u_shadow),u_highlight:new v.UniformColor(l,p.u_highlight),u_accent:new v.UniformColor(l,p.u_accent)}},hillshadePrepare:function(l,p){return{u_matrix:new v.UniformMatrix4f(l,p.u_matrix),u_image:new v.Uniform1i(l,p.u_image),u_dimension:new v.Uniform2f(l,p.u_dimension),u_zoom:new v.Uniform1f(l,p.u_zoom),u_unpack:new v.Uniform4f(l,p.u_unpack)}},line:function(l,p){return{u_matrix:new v.UniformMatrix4f(l,p.u_matrix),u_ratio:new v.Uniform1f(l,p.u_ratio),u_device_pixel_ratio:new v.Uniform1f(l,p.u_device_pixel_ratio),u_units_to_pixels:new v.Uniform2f(l,p.u_units_to_pixels)}},lineGradient:function(l,p){return{u_matrix:new v.UniformMatrix4f(l,p.u_matrix),u_ratio:new v.Uniform1f(l,p.u_ratio),u_device_pixel_ratio:new v.Uniform1f(l,p.u_device_pixel_ratio),u_units_to_pixels:new v.Uniform2f(l,p.u_units_to_pixels),u_image:new v.Uniform1i(l,p.u_image),u_image_height:new v.Uniform1f(l,p.u_image_height)}},linePattern:function(l,p){return{u_matrix:new v.UniformMatrix4f(l,p.u_matrix),u_texsize:new v.Uniform2f(l,p.u_texsize),u_ratio:new v.Uniform1f(l,p.u_ratio),u_device_pixel_ratio:new v.Uniform1f(l,p.u_device_pixel_ratio),u_image:new v.Uniform1i(l,p.u_image),u_units_to_pixels:new v.Uniform2f(l,p.u_units_to_pixels),u_scale:new v.Uniform3f(l,p.u_scale),u_fade:new v.Uniform1f(l,p.u_fade)}},lineSDF:function(l,p){return{u_matrix:new v.UniformMatrix4f(l,p.u_matrix),u_ratio:new v.Uniform1f(l,p.u_ratio),u_device_pixel_ratio:new v.Uniform1f(l,p.u_device_pixel_ratio),u_units_to_pixels:new v.Uniform2f(l,p.u_units_to_pixels),u_patternscale_a:new v.Uniform2f(l,p.u_patternscale_a),u_patternscale_b:new v.Uniform2f(l,p.u_patternscale_b),u_sdfgamma:new v.Uniform1f(l,p.u_sdfgamma),u_image:new v.Uniform1i(l,p.u_image),u_tex_y_a:new v.Uniform1f(l,p.u_tex_y_a),u_tex_y_b:new v.Uniform1f(l,p.u_tex_y_b),u_mix:new v.Uniform1f(l,p.u_mix)}},raster:function(l,p){return{u_matrix:new v.UniformMatrix4f(l,p.u_matrix),u_tl_parent:new v.Uniform2f(l,p.u_tl_parent),u_scale_parent:new v.Uniform1f(l,p.u_scale_parent),u_buffer_scale:new v.Uniform1f(l,p.u_buffer_scale),u_fade_t:new v.Uniform1f(l,p.u_fade_t),u_opacity:new v.Uniform1f(l,p.u_opacity),u_image0:new v.Uniform1i(l,p.u_image0),u_image1:new v.Uniform1i(l,p.u_image1),u_brightness_low:new v.Uniform1f(l,p.u_brightness_low),u_brightness_high:new v.Uniform1f(l,p.u_brightness_high),u_saturation_factor:new v.Uniform1f(l,p.u_saturation_factor),u_contrast_factor:new v.Uniform1f(l,p.u_contrast_factor),u_spin_weights:new v.Uniform3f(l,p.u_spin_weights)}},symbolIcon:function(l,p){return{u_is_size_zoom_constant:new v.Uniform1i(l,p.u_is_size_zoom_constant),u_is_size_feature_constant:new v.Uniform1i(l,p.u_is_size_feature_constant),u_size_t:new v.Uniform1f(l,p.u_size_t),u_size:new v.Uniform1f(l,p.u_size),u_camera_to_center_distance:new v.Uniform1f(l,p.u_camera_to_center_distance),u_pitch:new v.Uniform1f(l,p.u_pitch),u_rotate_symbol:new v.Uniform1i(l,p.u_rotate_symbol),u_aspect_ratio:new v.Uniform1f(l,p.u_aspect_ratio),u_fade_change:new v.Uniform1f(l,p.u_fade_change),u_matrix:new v.UniformMatrix4f(l,p.u_matrix),u_label_plane_matrix:new v.UniformMatrix4f(l,p.u_label_plane_matrix),u_coord_matrix:new v.UniformMatrix4f(l,p.u_coord_matrix),u_is_text:new v.Uniform1i(l,p.u_is_text),u_pitch_with_map:new v.Uniform1i(l,p.u_pitch_with_map),u_texsize:new v.Uniform2f(l,p.u_texsize),u_texture:new v.Uniform1i(l,p.u_texture)}},symbolSDF:function(l,p){return{u_is_size_zoom_constant:new v.Uniform1i(l,p.u_is_size_zoom_constant),u_is_size_feature_constant:new v.Uniform1i(l,p.u_is_size_feature_constant),u_size_t:new v.Uniform1f(l,p.u_size_t),u_size:new v.Uniform1f(l,p.u_size),u_camera_to_center_distance:new v.Uniform1f(l,p.u_camera_to_center_distance),u_pitch:new v.Uniform1f(l,p.u_pitch),u_rotate_symbol:new v.Uniform1i(l,p.u_rotate_symbol),u_aspect_ratio:new v.Uniform1f(l,p.u_aspect_ratio),u_fade_change:new v.Uniform1f(l,p.u_fade_change),u_matrix:new v.UniformMatrix4f(l,p.u_matrix),u_label_plane_matrix:new v.UniformMatrix4f(l,p.u_label_plane_matrix),u_coord_matrix:new v.UniformMatrix4f(l,p.u_coord_matrix),u_is_text:new v.Uniform1i(l,p.u_is_text),u_pitch_with_map:new v.Uniform1i(l,p.u_pitch_with_map),u_texsize:new v.Uniform2f(l,p.u_texsize),u_texture:new v.Uniform1i(l,p.u_texture),u_gamma_scale:new v.Uniform1f(l,p.u_gamma_scale),u_device_pixel_ratio:new v.Uniform1f(l,p.u_device_pixel_ratio),u_is_halo:new v.Uniform1i(l,p.u_is_halo)}},symbolTextAndIcon:function(l,p){return{u_is_size_zoom_constant:new v.Uniform1i(l,p.u_is_size_zoom_constant),u_is_size_feature_constant:new v.Uniform1i(l,p.u_is_size_feature_constant),u_size_t:new v.Uniform1f(l,p.u_size_t),u_size:new v.Uniform1f(l,p.u_size),u_camera_to_center_distance:new v.Uniform1f(l,p.u_camera_to_center_distance),u_pitch:new v.Uniform1f(l,p.u_pitch),u_rotate_symbol:new v.Uniform1i(l,p.u_rotate_symbol),u_aspect_ratio:new v.Uniform1f(l,p.u_aspect_ratio),u_fade_change:new v.Uniform1f(l,p.u_fade_change),u_matrix:new v.UniformMatrix4f(l,p.u_matrix),u_label_plane_matrix:new v.UniformMatrix4f(l,p.u_label_plane_matrix),u_coord_matrix:new v.UniformMatrix4f(l,p.u_coord_matrix),u_is_text:new v.Uniform1i(l,p.u_is_text),u_pitch_with_map:new v.Uniform1i(l,p.u_pitch_with_map),u_texsize:new v.Uniform2f(l,p.u_texsize),u_texsize_icon:new v.Uniform2f(l,p.u_texsize_icon),u_texture:new v.Uniform1i(l,p.u_texture),u_texture_icon:new v.Uniform1i(l,p.u_texture_icon),u_gamma_scale:new v.Uniform1f(l,p.u_gamma_scale),u_device_pixel_ratio:new v.Uniform1f(l,p.u_device_pixel_ratio),u_is_halo:new v.Uniform1i(l,p.u_is_halo)}},background:function(l,p){return{u_matrix:new v.UniformMatrix4f(l,p.u_matrix),u_opacity:new v.Uniform1f(l,p.u_opacity),u_color:new v.UniformColor(l,p.u_color)}},backgroundPattern:function(l,p){return{u_matrix:new v.UniformMatrix4f(l,p.u_matrix),u_opacity:new v.Uniform1f(l,p.u_opacity),u_image:new v.Uniform1i(l,p.u_image),u_pattern_tl_a:new v.Uniform2f(l,p.u_pattern_tl_a),u_pattern_br_a:new v.Uniform2f(l,p.u_pattern_br_a),u_pattern_tl_b:new v.Uniform2f(l,p.u_pattern_tl_b),u_pattern_br_b:new v.Uniform2f(l,p.u_pattern_br_b),u_texsize:new v.Uniform2f(l,p.u_texsize),u_mix:new v.Uniform1f(l,p.u_mix),u_pattern_size_a:new v.Uniform2f(l,p.u_pattern_size_a),u_pattern_size_b:new v.Uniform2f(l,p.u_pattern_size_b),u_scale_a:new v.Uniform1f(l,p.u_scale_a),u_scale_b:new v.Uniform1f(l,p.u_scale_b),u_pixel_coord_upper:new v.Uniform2f(l,p.u_pixel_coord_upper),u_pixel_coord_lower:new v.Uniform2f(l,p.u_pixel_coord_lower),u_tile_units_to_pixels:new v.Uniform1f(l,p.u_tile_units_to_pixels)}}};function Eo(l,p,c,y,C,T,L){for(var z=l.context,Z=z.gl,H=l.useProgram("collisionBox"),ut=[],gt=0,ct=0,zt=0;zt<y.length;zt++){var Rt=y[zt],Yt=p.getTile(Rt),Dt=Yt.getBucket(c);if(Dt){var Vt=Rt.posMatrix;0===C[0]&&0===C[1]||(Vt=l.translatePosMatrix(Rt.posMatrix,Yt,C,T));var ee=L?Dt.textCollisionBox:Dt.iconCollisionBox,he=Dt.collisionCircleArray;if(he.length>0){var _e=v.create(),ve=Vt;v.mul(_e,Dt.placementInvProjMatrix,l.transform.glCoordMatrix),v.mul(_e,_e,Dt.placementViewportMatrix),ut.push({circleArray:he,circleOffset:ct,transform:ve,invTransform:_e}),ct=gt+=he.length/4}ee&&H.draw(z,Z.LINES,ht.disabled,Lt.disabled,l.colorModeForRenderPass(),ie.disabled,Ko(Vt,l.transform,Yt),c.id,ee.layoutVertexBuffer,ee.indexBuffer,ee.segments,null,l.transform.zoom,null,null,ee.collisionVertexBuffer)}}if(L&&ut.length){var we=l.useProgram("collisionCircle"),Ne=new v.StructArrayLayout2f1f2i16;Ne.resize(4*gt),Ne._trim();for(var qe=0,ze=0,Ve=ut;ze<Ve.length;ze+=1)for(var $e=Ve[ze],rr=0;rr<$e.circleArray.length/4;rr++){var tr=4*rr,Dr=$e.circleArray[tr+0],Xe=$e.circleArray[tr+1],vr=$e.circleArray[tr+2],Pr=$e.circleArray[tr+3];Ne.emplace(qe++,Dr,Xe,vr,Pr,0),Ne.emplace(qe++,Dr,Xe,vr,Pr,1),Ne.emplace(qe++,Dr,Xe,vr,Pr,2),Ne.emplace(qe++,Dr,Xe,vr,Pr,3)}(!_a||_a.length<2*gt)&&(_a=function(Kr){var pn=2*Kr,rn=new v.StructArrayLayout3ui6;rn.resize(pn),rn._trim();for(var nn=0;nn<pn;nn++){var Qr=6*nn;rn.uint16[Qr+0]=4*nn+0,rn.uint16[Qr+1]=4*nn+1,rn.uint16[Qr+2]=4*nn+2,rn.uint16[Qr+3]=4*nn+2,rn.uint16[Qr+4]=4*nn+3,rn.uint16[Qr+5]=4*nn+0}return rn}(gt));for(var _r=z.createIndexBuffer(_a,!0),mr=z.createVertexBuffer(Ne,v.collisionCircleLayout.members,!0),fr=0,hr=ut;fr<hr.length;fr+=1){var or=hr[fr],qr=$a(or.transform,or.invTransform,l.transform);we.draw(z,Z.TRIANGLES,ht.disabled,Lt.disabled,l.colorModeForRenderPass(),ie.disabled,qr,c.id,mr,_r,v.SegmentVector.simpleSegment(0,2*or.circleOffset,or.circleArray.length,or.circleArray.length/2),null,l.transform.zoom,null,null,null)}mr.destroy(),_r.destroy()}}var qu=v.identity(new Float32Array(16));function es(l,p,c,y,C,T){var L=v.getAnchorAlignment(l),z=-(L.horizontalAlign-.5)*p,Z=-(L.verticalAlign-.5)*c,H=v.evaluateVariableOffset(l,y);return new v.Point((z/C+H[0])*T,(Z/C+H[1])*T)}function Qo(l,p,c,y,C,T,L,z,Z,H,ut){var gt=l.text.placedSymbolArray,ct=l.text.dynamicLayoutVertexArray,zt=l.icon.dynamicLayoutVertexArray,Rt={};ct.clear();for(var Yt=0;Yt<gt.length;Yt++){var Dt=gt.get(Yt),Vt=Dt.hidden||!Dt.crossTileID||l.allowVerticalPlacement&&!Dt.placedOrientation?null:y[Dt.crossTileID];if(Vt){var ee=new v.Point(Dt.anchorX,Dt.anchorY),he=on(ee,c?z:L),_e=Zo(T.cameraToCenterDistance,he.signedDistanceFromCamera),ve=C.evaluateSizeForFeature(l.textSizeData,H,Dt)*_e/v.ONE_EM;c&&(ve*=l.tilePixelRatio/Z);for(var we=es(Vt.anchor,Vt.width,Vt.height,Vt.textOffset,Vt.textBoxScale,ve),Ne=c?on(ee.add(we),L).point:he.point.add(p?we.rotate(-T.angle):we),qe=l.allowVerticalPlacement&&Dt.placedOrientation===v.WritingMode.vertical?Math.PI/2:0,ze=0;ze<Dt.numGlyphs;ze++)v.addDynamicAttributes(ct,Ne,qe);ut&&Dt.associatedIconIndex>=0&&(Rt[Dt.associatedIconIndex]={shiftedAnchor:Ne,angle:qe})}else Rs(Dt.numGlyphs,ct)}if(ut){zt.clear();for(var Ve=l.icon.placedSymbolArray,$e=0;$e<Ve.length;$e++){var rr=Ve.get($e);if(rr.hidden)Rs(rr.numGlyphs,zt);else{var tr=Rt[$e];if(tr)for(var Dr=0;Dr<rr.numGlyphs;Dr++)v.addDynamicAttributes(zt,tr.shiftedAnchor,tr.angle);else Rs(rr.numGlyphs,zt)}}l.icon.dynamicLayoutVertexBuffer.updateData(zt)}l.text.dynamicLayoutVertexBuffer.updateData(ct)}function js(l,p,c){return c.iconsInText&&p?"symbolTextAndIcon":l?"symbolSDF":"symbolIcon"}function ka(l,p,c,y,C,T,L,z,Z,H,ut,gt){for(var ct=l.context,zt=ct.gl,Rt=l.transform,Yt="map"===z,Dt="map"===Z,Vt=Yt&&"point"!==c.layout.get("symbol-placement"),ee=Yt&&!Dt&&!Vt,he=!c.layout.get("symbol-sort-key").isConstant(),_e=!1,ve=l.depthModeForSublayer(0,ht.ReadOnly),we=c.layout.get("text-variable-anchor"),Ne=[],qe=0,ze=y;qe<ze.length;qe+=1){var Ve=ze[qe],$e=p.getTile(Ve),rr=$e.getBucket(c);if(rr){var tr=C?rr.text:rr.icon;if(tr&&tr.segments.get().length){var Dr=tr.programConfigurations.get(c.id),Xe=C||rr.sdfIcons,vr=C?rr.textSizeData:rr.iconSizeData,Pr=Dt||0!==Rt.pitch,_r=l.useProgram(js(Xe,C,rr),Dr),mr=v.evaluateSizeForZoom(vr,Rt.zoom),fr=void 0,hr=[0,0],or=void 0,qr=void 0,Kr=null,pn=void 0;if(C)or=$e.glyphAtlasTexture,qr=zt.LINEAR,fr=$e.glyphAtlasTexture.size,rr.iconsInText&&(hr=$e.imageAtlasTexture.size,Kr=$e.imageAtlasTexture,pn=Pr||l.options.rotating||l.options.zooming||"composite"===vr.kind||"camera"===vr.kind?zt.LINEAR:zt.NEAREST);else{var rn=1!==c.layout.get("icon-size").constantOr(0)||rr.iconsNeedLinear;or=$e.imageAtlasTexture,qr=Xe||l.options.rotating||l.options.zooming||rn||Pr?zt.LINEAR:zt.NEAREST,fr=$e.imageAtlasTexture.size}var nn=Wi($e,1,l.transform.zoom),Qr=gi(Ve.posMatrix,Dt,Yt,l.transform,nn),hn=Un(Ve.posMatrix,Dt,Yt,l.transform,nn),Sn=we&&rr.hasTextData(),fn="none"!==c.layout.get("icon-text-fit")&&Sn&&rr.hasIconData();Vt&&Ds(rr,Ve.posMatrix,l,C,Qr,hn,Dt,H);var ba=l.translatePosMatrix(Ve.posMatrix,$e,T,L),Bs=Vt||C&&we||fn?qu:Qr,us=l.translatePosMatrix(hn,$e,T,L,!0),El=Xe&&0!==c.paint.get(C?"text-halo-width":"icon-halo-width").constantOr(1),cu={program:_r,buffers:tr,uniformValues:Xe?rr.iconsInText?Na(vr.kind,mr,ee,Dt,l,ba,Bs,us,fr,hr):jo(vr.kind,mr,ee,Dt,l,ba,Bs,us,C,fr,!0):au(vr.kind,mr,ee,Dt,l,ba,Bs,us,C,fr),atlasTexture:or,atlasTextureIcon:Kr,atlasInterpolation:qr,atlasInterpolationIcon:pn,isSDF:Xe,hasHalo:El};if(he&&rr.canOverlap){_e=!0;for(var Ou=0,vu=tr.segments.get();Ou<vu.length;Ou+=1){var Gu=vu[Ou];Ne.push({segments:new v.SegmentVector([Gu]),sortKey:Gu.sortKey,state:cu})}}else Ne.push({segments:tr.segments,sortKey:0,state:cu})}}}_e&&Ne.sort(function(Js,Vu){return Js.sortKey-Vu.sortKey});for(var el=0,hu=Ne;el<hu.length;el+=1){var rl=hu[el],Xo=rl.state;if(ct.activeTexture.set(zt.TEXTURE0),Xo.atlasTexture.bind(Xo.atlasInterpolation,zt.CLAMP_TO_EDGE),Xo.atlasTextureIcon&&(ct.activeTexture.set(zt.TEXTURE1),Xo.atlasTextureIcon&&Xo.atlasTextureIcon.bind(Xo.atlasInterpolationIcon,zt.CLAMP_TO_EDGE)),Xo.isSDF){var _u=Xo.uniformValues;Xo.hasHalo&&(_u.u_is_halo=1,yu(Xo.buffers,rl.segments,c,l,Xo.program,ve,ut,gt,_u)),_u.u_is_halo=0}yu(Xo.buffers,rl.segments,c,l,Xo.program,ve,ut,gt,Xo.uniformValues)}}function yu(l,p,c,y,C,T,L,z,Z){var H=y.context;C.draw(H,H.gl.TRIANGLES,T,L,z,ie.disabled,Z,c.id,l.layoutVertexBuffer,l.indexBuffer,p,c.paint,y.transform.zoom,l.programConfigurations.get(c.id),l.dynamicLayoutVertexBuffer,l.opacityVertexBuffer)}function Do(l,p,c,y,C,T,L){var z,Z,H,ut,gt,ct=l.context.gl,zt=c.paint.get("fill-pattern"),Rt=zt&&zt.constantOr(1),Yt=c.getCrossfadeParameters();L?(Z=Rt&&!c.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",z=ct.LINES):(Z=Rt?"fillPattern":"fill",z=ct.TRIANGLES);for(var Dt=0,Vt=y;Dt<Vt.length;Dt+=1){var ee=Vt[Dt],he=p.getTile(ee);if(!Rt||he.patternsLoaded()){var _e=he.getBucket(c);if(_e){var ve=_e.programConfigurations.get(c.id),we=l.useProgram(Z,ve);Rt&&(l.context.activeTexture.set(ct.TEXTURE0),he.imageAtlasTexture.bind(ct.LINEAR,ct.CLAMP_TO_EDGE),ve.updatePaintBuffers(Yt));var Ne=zt.constantOr(null);if(Ne&&he.imageAtlas){var qe=he.imageAtlas,ze=qe.patternPositions[Ne.to.toString()],Ve=qe.patternPositions[Ne.from.toString()];ze&&Ve&&ve.setConstantPatternPositions(ze,Ve)}var $e=l.translatePosMatrix(ee.posMatrix,he,c.paint.get("fill-translate"),c.paint.get("fill-translate-anchor"));if(L){ut=_e.indexBuffer2,gt=_e.segments2;var rr=[ct.drawingBufferWidth,ct.drawingBufferHeight];H="fillOutlinePattern"===Z&&Rt?Pi($e,l,Yt,he,rr):ws($e,rr)}else ut=_e.indexBuffer,gt=_e.segments,H=Rt?Cn($e,l,Yt,he):Vs($e);we.draw(l.context,z,C,l.stencilModeForClipping(ee),T,ie.disabled,H,c.id,_e.layoutVertexBuffer,ut,gt,c.paint,l.transform.zoom,ve)}}}}function Mu(l,p,c,y,C,T,L){for(var z=l.context,Z=z.gl,H=c.paint.get("fill-extrusion-pattern"),ut=H.constantOr(1),gt=c.getCrossfadeParameters(),ct=c.paint.get("fill-extrusion-opacity"),zt=0,Rt=y;zt<Rt.length;zt+=1){var Yt=Rt[zt],Dt=p.getTile(Yt),Vt=Dt.getBucket(c);if(Vt){var ee=Vt.programConfigurations.get(c.id),he=l.useProgram(ut?"fillExtrusionPattern":"fillExtrusion",ee);ut&&(l.context.activeTexture.set(Z.TEXTURE0),Dt.imageAtlasTexture.bind(Z.LINEAR,Z.CLAMP_TO_EDGE),ee.updatePaintBuffers(gt));var _e=H.constantOr(null);if(_e&&Dt.imageAtlas){var ve=Dt.imageAtlas,we=ve.patternPositions[_e.to.toString()],Ne=ve.patternPositions[_e.from.toString()];we&&Ne&&ee.setConstantPatternPositions(we,Ne)}var qe=l.translatePosMatrix(Yt.posMatrix,Dt,c.paint.get("fill-extrusion-translate"),c.paint.get("fill-extrusion-translate-anchor")),ze=c.paint.get("fill-extrusion-vertical-gradient"),Ve=ut?Ia(qe,l,ze,ct,Yt,gt,Dt):Pu(qe,l,ze,ct);he.draw(z,z.gl.TRIANGLES,C,T,L,ie.backCCW,Ve,c.id,Vt.layoutVertexBuffer,Vt.indexBuffer,Vt.segments,c.paint,l.transform.zoom,ee)}}}function Tu(l,p,c,y,C,T){var L=l.context,z=L.gl,Z=p.fbo;if(Z){var H=l.useProgram("hillshade");L.activeTexture.set(z.TEXTURE0),z.bindTexture(z.TEXTURE_2D,Z.colorAttachment.get());var ut=function(gt,ct,zt){var Rt=zt.paint.get("hillshade-shadow-color"),Yt=zt.paint.get("hillshade-highlight-color"),Dt=zt.paint.get("hillshade-accent-color"),Vt=zt.paint.get("hillshade-illumination-direction")*(Math.PI/180);"viewport"===zt.paint.get("hillshade-illumination-anchor")&&(Vt-=gt.transform.angle);var ee,he,_e,ve=!gt.options.moving;return{u_matrix:gt.transform.calculatePosMatrix(ct.tileID.toUnwrapped(),ve),u_image:0,u_latrange:(ee=ct.tileID,he=Math.pow(2,ee.canonical.z),_e=ee.canonical.y,[new v.MercatorCoordinate(0,_e/he).toLngLat().lat,new v.MercatorCoordinate(0,(_e+1)/he).toLngLat().lat]),u_light:[zt.paint.get("hillshade-exaggeration"),Vt],u_shadow:Rt,u_highlight:Yt,u_accent:Dt}}(l,p,c);H.draw(L,z.TRIANGLES,y,C,T,ie.disabled,ut,c.id,l.rasterBoundsBuffer,l.quadTriangleIndexBuffer,l.rasterBoundsSegments)}}function Es(l,p,c,y,C,T){var Yt,Dt,Vt,ee,L=l.context,z=L.gl,Z=p.dem;if(Z&&Z.data){var H=Z.dim,ut=Z.stride,gt=Z.getPixels();if(L.activeTexture.set(z.TEXTURE1),L.pixelStoreUnpackPremultiplyAlpha.set(!1),p.demTexture=p.demTexture||l.getTileTexture(ut),p.demTexture){var ct=p.demTexture;ct.update(gt,{premultiply:!1}),ct.bind(z.NEAREST,z.CLAMP_TO_EDGE)}else p.demTexture=new v.Texture(L,gt,z.RGBA,{premultiply:!1}),p.demTexture.bind(z.NEAREST,z.CLAMP_TO_EDGE);L.activeTexture.set(z.TEXTURE0);var zt=p.fbo;if(!zt){var Rt=new v.Texture(L,{width:H,height:H,data:null},z.RGBA);Rt.bind(z.LINEAR,z.CLAMP_TO_EDGE),(zt=p.fbo=L.createFramebuffer(H,H,!0)).colorAttachment.set(Rt.texture)}L.bindFramebuffer.set(zt.framebuffer),L.viewport.set([0,0,H,H]),l.useProgram("hillshadePrepare").draw(L,z.TRIANGLES,y,C,T,ie.disabled,(Yt=p.tileID,Vt=(Dt=Z).stride,ee=v.create(),v.ortho(ee,0,v.EXTENT,-v.EXTENT,0,0,1),v.translate(ee,ee,[0,-v.EXTENT,0]),{u_matrix:ee,u_image:1,u_dimension:[Vt,Vt],u_zoom:Yt.overscaledZ,u_unpack:Dt.getUnpackVector()}),c.id,l.rasterBoundsBuffer,l.quadTriangleIndexBuffer,l.rasterBoundsSegments),p.needsHillshadePrepare=!1}}function Tc(l,p,c,y,C){var T=y.paint.get("raster-fade-duration");if(T>0){var L=v.browser.now(),z=(L-l.timeAdded)/T,Z=p?(L-p.timeAdded)/T:-1,H=c.getSource(),ut=C.coveringZoomLevel({tileSize:H.tileSize,roundZoom:H.roundZoom}),gt=!p||Math.abs(p.tileID.overscaledZ-ut)>Math.abs(l.tileID.overscaledZ-ut),ct=gt&&l.refreshedUponExpiration?1:v.clamp(gt?z:1-Z,0,1);return l.refreshedUponExpiration&&z>=1&&(l.refreshedUponExpiration=!1),p?{opacity:1,mix:1-ct}:{opacity:ct,mix:0}}return{opacity:1,mix:0}}var Qu=new v.Color(1,0,0,1),Xs=new v.Color(0,1,0,1),Cs=new v.Color(0,0,1,1),Ro=new v.Color(1,0,1,1),su=new v.Color(0,1,1,1);function No(l,p,c,y){Ss(l,0,p+c/2,l.transform.width,c,y)}function rs(l,p,c,y){Ss(l,p-c/2,0,c,l.transform.height,y)}function Ss(l,p,c,y,C,T){var L=l.context,z=L.gl;z.enable(z.SCISSOR_TEST),z.scissor(p*v.browser.devicePixelRatio,c*v.browser.devicePixelRatio,y*v.browser.devicePixelRatio,C*v.browser.devicePixelRatio),L.clear({color:T}),z.disable(z.SCISSOR_TEST)}function $u(l,p,c){var y=l.context,C=y.gl,T=c.posMatrix,L=l.useProgram("debug"),z=ht.disabled,Z=Lt.disabled,H=l.colorModeForRenderPass();y.activeTexture.set(C.TEXTURE0),l.emptyTexture.bind(C.LINEAR,C.CLAMP_TO_EDGE),L.draw(y,C.LINE_STRIP,z,Z,H,ie.disabled,Ku(T,v.Color.red),"$debug",l.debugBuffer,l.tileBorderIndexBuffer,l.debugSegments);var ut=p.getTileByID(c.key).latestRawTileData,gt=Math.floor((ut&&ut.byteLength||0)/1024),ct=p.getTile(c).tileSize,zt=512/Math.min(ct,512)*(c.overscaledZ/l.transform.zoom)*.5,Rt=c.canonical.toString();c.overscaledZ!==c.canonical.z&&(Rt+=" => "+c.overscaledZ),function(Yt,Dt){Yt.initDebugOverlayCanvas();var Vt=Yt.debugOverlayCanvas,ee=Yt.context.gl,he=Yt.debugOverlayCanvas.getContext("2d");he.clearRect(0,0,Vt.width,Vt.height),he.shadowColor="white",he.shadowBlur=2,he.lineWidth=1.5,he.strokeStyle="white",he.textBaseline="top",he.font="bold 36px Open Sans, sans-serif",he.fillText(Dt,5,5),he.strokeText(Dt,5,5),Yt.debugOverlayTexture.update(Vt),Yt.debugOverlayTexture.bind(ee.LINEAR,ee.CLAMP_TO_EDGE)}(l,Rt+" "+gt+"kb"),L.draw(y,C.TRIANGLES,z,Z,Wt.alphaBlended,ie.disabled,Ku(T,v.Color.transparent,zt),"$debug",l.debugBuffer,l.quadTriangleIndexBuffer,l.debugSegments)}var Fs={symbol:function(l,p,c,y,C){if("translucent"===l.renderPass){var T=Lt.disabled,L=l.colorModeForRenderPass();c.layout.get("text-variable-anchor")&&function(z,Z,H,ut,gt,ct,zt){for(var Rt=Z.transform,Yt="map"===gt,Dt="map"===ct,Vt=0,ee=z;Vt<ee.length;Vt+=1){var he=ee[Vt],_e=ut.getTile(he),ve=_e.getBucket(H);if(ve&&ve.text&&ve.text.segments.get().length){var we=v.evaluateSizeForZoom(ve.textSizeData,Rt.zoom),Ne=Wi(_e,1,Z.transform.zoom),qe=gi(he.posMatrix,Dt,Yt,Z.transform,Ne),ze="none"!==H.layout.get("icon-text-fit")&&ve.hasIconData();if(we){var Ve=Math.pow(2,Rt.zoom-_e.tileID.overscaledZ);Qo(ve,Yt,Dt,zt,v.symbolSize,Rt,qe,he.posMatrix,Ve,we,ze)}}}}(y,l,c,p,c.layout.get("text-rotation-alignment"),c.layout.get("text-pitch-alignment"),C),0!==c.paint.get("icon-opacity").constantOr(1)&&ka(l,p,c,y,!1,c.paint.get("icon-translate"),c.paint.get("icon-translate-anchor"),c.layout.get("icon-rotation-alignment"),c.layout.get("icon-pitch-alignment"),c.layout.get("icon-keep-upright"),T,L),0!==c.paint.get("text-opacity").constantOr(1)&&ka(l,p,c,y,!0,c.paint.get("text-translate"),c.paint.get("text-translate-anchor"),c.layout.get("text-rotation-alignment"),c.layout.get("text-pitch-alignment"),c.layout.get("text-keep-upright"),T,L),p.map.showCollisionBoxes&&(Eo(l,p,c,y,c.paint.get("text-translate"),c.paint.get("text-translate-anchor"),!0),Eo(l,p,c,y,c.paint.get("icon-translate"),c.paint.get("icon-translate-anchor"),!1))}},circle:function(l,p,c,y){if("translucent"===l.renderPass){var C=c.paint.get("circle-opacity"),T=c.paint.get("circle-stroke-width"),L=c.paint.get("circle-stroke-opacity"),z=!c.layout.get("circle-sort-key").isConstant();if(0!==C.constantOr(1)||0!==T.constantOr(1)&&0!==L.constantOr(1)){for(var Z=l.context,H=Z.gl,ut=l.depthModeForSublayer(0,ht.ReadOnly),gt=Lt.disabled,ct=l.colorModeForRenderPass(),zt=[],Rt=0;Rt<y.length;Rt++){var Yt=y[Rt],Dt=p.getTile(Yt),Vt=Dt.getBucket(c);if(Vt){var ee=Vt.programConfigurations.get(c.id),he={programConfiguration:ee,program:l.useProgram("circle",ee),layoutVertexBuffer:Vt.layoutVertexBuffer,indexBuffer:Vt.indexBuffer,uniformValues:Bu(l,Yt,Dt,c)};if(z)for(var _e=0,ve=Vt.segments.get();_e<ve.length;_e+=1){var we=ve[_e];zt.push({segments:new v.SegmentVector([we]),sortKey:we.sortKey,state:he})}else zt.push({segments:Vt.segments,sortKey:0,state:he})}}z&&zt.sort(function($e,rr){return $e.sortKey-rr.sortKey});for(var Ne=0,qe=zt;Ne<qe.length;Ne+=1){var ze=qe[Ne],Ve=ze.state;Ve.program.draw(Z,H.TRIANGLES,ut,gt,ct,ie.disabled,Ve.uniformValues,c.id,Ve.layoutVertexBuffer,Ve.indexBuffer,ze.segments,c.paint,l.transform.zoom,Ve.programConfiguration)}}}},heatmap:function(l,p,c,y){if(0!==c.paint.get("heatmap-opacity"))if("offscreen"===l.renderPass){var C=l.context,T=C.gl,L=Lt.disabled,z=new Wt([T.ONE,T.ONE],v.Color.transparent,[!0,!0,!0,!0]);(function(zt,Rt,Yt){var Dt=zt.gl;zt.activeTexture.set(Dt.TEXTURE1),zt.viewport.set([0,0,Rt.width/4,Rt.height/4]);var he,_e,ve,we,Ne,Vt=Yt.heatmapFbo;if(Vt)Dt.bindTexture(Dt.TEXTURE_2D,Vt.colorAttachment.get()),zt.bindFramebuffer.set(Vt.framebuffer);else{var ee=Dt.createTexture();Dt.bindTexture(Dt.TEXTURE_2D,ee),Dt.texParameteri(Dt.TEXTURE_2D,Dt.TEXTURE_WRAP_S,Dt.CLAMP_TO_EDGE),Dt.texParameteri(Dt.TEXTURE_2D,Dt.TEXTURE_WRAP_T,Dt.CLAMP_TO_EDGE),Dt.texParameteri(Dt.TEXTURE_2D,Dt.TEXTURE_MIN_FILTER,Dt.LINEAR),Dt.texParameteri(Dt.TEXTURE_2D,Dt.TEXTURE_MAG_FILTER,Dt.LINEAR),ve=ee,we=Vt=Yt.heatmapFbo=zt.createFramebuffer(Rt.width/4,Rt.height/4,!1),(Ne=(he=zt).gl).texImage2D(Ne.TEXTURE_2D,0,Ne.RGBA,(_e=Rt).width/4,_e.height/4,0,Ne.RGBA,he.extRenderToTextureHalfFloat?he.extTextureHalfFloat.HALF_FLOAT_OES:Ne.UNSIGNED_BYTE,null),we.colorAttachment.set(ve)}})(C,l,c),C.clear({color:v.Color.transparent});for(var Z=0;Z<y.length;Z++){var H=y[Z];if(!p.hasRenderableParent(H)){var ut=p.getTile(H),gt=ut.getBucket(c);if(gt){var ct=gt.programConfigurations.get(c.id);l.useProgram("heatmap",ct).draw(C,T.TRIANGLES,ht.disabled,L,z,ie.disabled,Nn(H.posMatrix,ut,l.transform.zoom,c.paint.get("heatmap-intensity")),c.id,gt.layoutVertexBuffer,gt.indexBuffer,gt.segments,c.paint,l.transform.zoom,ct)}}}C.viewport.set([0,0,l.width,l.height])}else"translucent"===l.renderPass&&(l.context.setColorMode(l.colorModeForRenderPass()),function(zt,Rt){var Yt=zt.context,Dt=Yt.gl,Vt=Rt.heatmapFbo;if(Vt){Yt.activeTexture.set(Dt.TEXTURE0),Dt.bindTexture(Dt.TEXTURE_2D,Vt.colorAttachment.get()),Yt.activeTexture.set(Dt.TEXTURE1);var ee=Rt.colorRampTexture;ee||(ee=Rt.colorRampTexture=new v.Texture(Yt,Rt.colorRamp,Dt.RGBA)),ee.bind(Dt.LINEAR,Dt.CLAMP_TO_EDGE),zt.useProgram("heatmapTexture").draw(Yt,Dt.TRIANGLES,ht.disabled,Lt.disabled,zt.colorModeForRenderPass(),ie.disabled,function(he,_e,ve,we){var Ne=v.create();v.ortho(Ne,0,he.width,he.height,0,0,1);var qe=he.context.gl;return{u_matrix:Ne,u_world:[qe.drawingBufferWidth,qe.drawingBufferHeight],u_image:0,u_color_ramp:1,u_opacity:_e.paint.get("heatmap-opacity")}}(zt,Rt),Rt.id,zt.viewportBuffer,zt.quadTriangleIndexBuffer,zt.viewportSegments,Rt.paint,zt.transform.zoom)}}(l,c))},line:function(l,p,c,y){if("translucent"===l.renderPass){var C=c.paint.get("line-opacity"),T=c.paint.get("line-width");if(0!==C.constantOr(1)&&0!==T.constantOr(1))for(var L=l.depthModeForSublayer(0,ht.ReadOnly),z=l.colorModeForRenderPass(),Z=c.paint.get("line-dasharray"),H=c.paint.get("line-pattern"),ut=H.constantOr(1),gt=c.paint.get("line-gradient"),ct=c.getCrossfadeParameters(),zt=ut?"linePattern":Z?"lineSDF":gt?"lineGradient":"line",Rt=l.context,Yt=Rt.gl,Dt=!0,Vt=0,ee=y;Vt<ee.length;Vt+=1){var he=ee[Vt],_e=p.getTile(he);if(!ut||_e.patternsLoaded()){var ve=_e.getBucket(c);if(ve){var we=ve.programConfigurations.get(c.id),Ne=l.context.program.get(),qe=l.useProgram(zt,we),ze=Dt||qe.program!==Ne,Ve=H.constantOr(null);if(Ve&&_e.imageAtlas){var $e=_e.imageAtlas,rr=$e.patternPositions[Ve.to.toString()],tr=$e.patternPositions[Ve.from.toString()];rr&&tr&&we.setConstantPatternPositions(rr,tr)}var Dr=ut?Xn(l,_e,c,ct):Z?aa(l,_e,c,Z,ct):gt?mu(l,_e,c,ve.lineClipsArray.length):va(l,_e,c);if(ut)Rt.activeTexture.set(Yt.TEXTURE0),_e.imageAtlasTexture.bind(Yt.LINEAR,Yt.CLAMP_TO_EDGE),we.updatePaintBuffers(ct);else if(Z&&(ze||l.lineAtlas.dirty))Rt.activeTexture.set(Yt.TEXTURE0),l.lineAtlas.bind(Rt);else if(gt){var Xe=ve.gradients[c.id],vr=Xe.texture;if(c.gradientVersion!==Xe.version){var Pr=256;if(c.stepInterpolant){var _r=p.getSource().maxzoom,mr=he.canonical.z===_r?Math.ceil(1<<l.transform.maxZoom-he.canonical.z):1;Pr=v.clamp(v.nextPowerOfTwo(ve.maxLineLength/v.EXTENT*1024*mr),256,Rt.maxTextureSize)}Xe.gradient=v.renderColorRamp({expression:c.gradientExpression(),evaluationKey:"lineProgress",resolution:Pr,image:Xe.gradient||void 0,clips:ve.lineClipsArray}),Xe.texture?Xe.texture.update(Xe.gradient):Xe.texture=new v.Texture(Rt,Xe.gradient,Yt.RGBA),Xe.version=c.gradientVersion,vr=Xe.texture}Rt.activeTexture.set(Yt.TEXTURE0),vr.bind(c.stepInterpolant?Yt.NEAREST:Yt.LINEAR,Yt.CLAMP_TO_EDGE)}qe.draw(Rt,Yt.TRIANGLES,L,l.stencilModeForClipping(he),z,ie.disabled,Dr,c.id,ve.layoutVertexBuffer,ve.indexBuffer,ve.segments,c.paint,l.transform.zoom,we,ve.layoutVertexBuffer2),Dt=!1}}}}},fill:function(l,p,c,y){var C=c.paint.get("fill-color"),T=c.paint.get("fill-opacity");if(0!==T.constantOr(1)){var L=l.colorModeForRenderPass(),z=c.paint.get("fill-pattern"),Z=l.opaquePassEnabledForLayer()&&!z.constantOr(1)&&1===C.constantOr(v.Color.transparent).a&&1===T.constantOr(0)?"opaque":"translucent";if(l.renderPass===Z){var H=l.depthModeForSublayer(1,"opaque"===l.renderPass?ht.ReadWrite:ht.ReadOnly);Do(l,p,c,y,H,L,!1)}if("translucent"===l.renderPass&&c.paint.get("fill-antialias")){var ut=l.depthModeForSublayer(c.getPaintProperty("fill-outline-color")?2:0,ht.ReadOnly);Do(l,p,c,y,ut,L,!0)}}},"fill-extrusion":function(l,p,c,y){var C=c.paint.get("fill-extrusion-opacity");if(0!==C&&"translucent"===l.renderPass){var T=new ht(l.context.gl.LEQUAL,ht.ReadWrite,l.depthRangeFor3D);if(1!==C||c.paint.get("fill-extrusion-pattern").constantOr(1))Mu(l,p,c,y,T,Lt.disabled,Wt.disabled),Mu(l,p,c,y,T,l.stencilModeFor3D(),l.colorModeForRenderPass());else{var L=l.colorModeForRenderPass();Mu(l,p,c,y,T,Lt.disabled,L)}}},hillshade:function(l,p,c,y){if("offscreen"===l.renderPass||"translucent"===l.renderPass){for(var C=l.context,T=l.depthModeForSublayer(0,ht.ReadOnly),L=l.colorModeForRenderPass(),z="translucent"===l.renderPass?l.stencilConfigForOverlap(y):[{},y],Z=z[0],H=0,ut=z[1];H<ut.length;H+=1){var gt=ut[H],ct=p.getTile(gt);ct.needsHillshadePrepare&&"offscreen"===l.renderPass?Es(l,ct,c,T,Lt.disabled,L):"translucent"===l.renderPass&&Tu(l,ct,c,T,Z[gt.overscaledZ],L)}C.viewport.set([0,0,l.width,l.height])}},raster:function(l,p,c,y){if("translucent"===l.renderPass&&0!==c.paint.get("raster-opacity")&&y.length)for(var C=l.context,T=C.gl,L=p.getSource(),z=l.useProgram("raster"),Z=l.colorModeForRenderPass(),H=L instanceof te?[{},y]:l.stencilConfigForOverlap(y),ut=H[0],gt=H[1],ct=gt[gt.length-1].overscaledZ,zt=!l.options.moving,Rt=0,Yt=gt;Rt<Yt.length;Rt+=1){var Dt=Yt[Rt],Vt=l.depthModeForSublayer(Dt.overscaledZ-ct,1===c.paint.get("raster-opacity")?ht.ReadWrite:ht.ReadOnly,T.LESS),ee=p.getTile(Dt),he=l.transform.calculatePosMatrix(Dt.toUnwrapped(),zt);ee.registerFadeDuration(c.paint.get("raster-fade-duration"));var _e=p.findLoadedParent(Dt,0),ve=Tc(ee,_e,p,c,l.transform),we=void 0,Ne=void 0,qe="nearest"===c.paint.get("raster-resampling")?T.NEAREST:T.LINEAR;C.activeTexture.set(T.TEXTURE0),ee.texture.bind(qe,T.CLAMP_TO_EDGE,T.LINEAR_MIPMAP_NEAREST),C.activeTexture.set(T.TEXTURE1),_e?(_e.texture.bind(qe,T.CLAMP_TO_EDGE,T.LINEAR_MIPMAP_NEAREST),we=Math.pow(2,_e.tileID.overscaledZ-ee.tileID.overscaledZ),Ne=[ee.tileID.canonical.x*we%1,ee.tileID.canonical.y*we%1]):ee.texture.bind(qe,T.CLAMP_TO_EDGE,T.LINEAR_MIPMAP_NEAREST);var ze=Mc(he,Ne||[0,0],we||1,ve,c);L instanceof te?z.draw(C,T.TRIANGLES,Vt,Lt.disabled,Z,ie.disabled,ze,c.id,L.boundsBuffer,l.quadTriangleIndexBuffer,L.boundsSegments):z.draw(C,T.TRIANGLES,Vt,ut[Dt.overscaledZ],Z,ie.disabled,ze,c.id,l.rasterBoundsBuffer,l.quadTriangleIndexBuffer,l.rasterBoundsSegments)}},background:function(l,p,c){var y=c.paint.get("background-color"),C=c.paint.get("background-opacity");if(0!==C){var T=l.context,L=T.gl,z=l.transform,Z=z.tileSize,H=c.paint.get("background-pattern");if(!l.isPatternMissing(H)){var ut=!H&&1===y.a&&1===C&&l.opaquePassEnabledForLayer()?"opaque":"translucent";if(l.renderPass===ut){var gt=Lt.disabled,ct=l.depthModeForSublayer(0,"opaque"===ut?ht.ReadWrite:ht.ReadOnly),zt=l.colorModeForRenderPass(),Rt=l.useProgram(H?"backgroundPattern":"background"),Yt=z.coveringTiles({tileSize:Z});H&&(T.activeTexture.set(L.TEXTURE0),l.imageManager.bind(l.context));for(var Dt=c.getCrossfadeParameters(),Vt=0,ee=Yt;Vt<ee.length;Vt+=1){var he=ee[Vt],_e=l.transform.calculatePosMatrix(he.toUnwrapped()),ve=H?hs(_e,C,l,H,{tileID:he,tileSize:Z},Dt):Pa(_e,C,y);Rt.draw(T,L.TRIANGLES,ct,gt,zt,ie.disabled,ve,c.id,l.tileExtentBuffer,l.quadTriangleIndexBuffer,l.tileExtentSegments)}}}}},debug:function(l,p,c){for(var y=0;y<c.length;y++)$u(l,p,c[y])},custom:function(l,p,c){var y=l.context,C=c.implementation;if("offscreen"===l.renderPass){var T=C.prerender;T&&(l.setCustomLayerDefaults(),y.setColorMode(l.colorModeForRenderPass()),T.call(C,y.gl,l.transform.customLayerMatrix()),y.setDirty(),l.setBaseState())}else if("translucent"===l.renderPass){l.setCustomLayerDefaults(),y.setColorMode(l.colorModeForRenderPass()),y.setStencilMode(Lt.disabled);var L="3d"===C.renderingMode?new ht(l.context.gl.LEQUAL,ht.ReadWrite,l.depthRangeFor3D):l.depthModeForSublayer(0,ht.ReadOnly);y.setDepthMode(L),C.render(y.gl,l.transform.customLayerMatrix()),y.setDirty(),l.setBaseState(),y.bindFramebuffer.set(null)}}},Yn=function(l,p){this.context=new Ht(l),this.transform=p,this._tileTextures={},this.setup(),this.numSublayers=_t.maxUnderzooming+_t.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new $i,this.gpuTimers={}};Yn.prototype.resize=function(l,p){if(this.width=l*v.browser.devicePixelRatio,this.height=p*v.browser.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(var c=0,y=this.style._order;c<y.length;c+=1)this.style._layers[y[c]].resize()},Yn.prototype.setup=function(){var l=this.context,p=new v.StructArrayLayout2i4;p.emplaceBack(0,0),p.emplaceBack(v.EXTENT,0),p.emplaceBack(0,v.EXTENT),p.emplaceBack(v.EXTENT,v.EXTENT),this.tileExtentBuffer=l.createVertexBuffer(p,co.members),this.tileExtentSegments=v.SegmentVector.simpleSegment(0,0,4,2);var c=new v.StructArrayLayout2i4;c.emplaceBack(0,0),c.emplaceBack(v.EXTENT,0),c.emplaceBack(0,v.EXTENT),c.emplaceBack(v.EXTENT,v.EXTENT),this.debugBuffer=l.createVertexBuffer(c,co.members),this.debugSegments=v.SegmentVector.simpleSegment(0,0,4,5);var y=new v.StructArrayLayout4i8;y.emplaceBack(0,0,0,0),y.emplaceBack(v.EXTENT,0,v.EXTENT,0),y.emplaceBack(0,v.EXTENT,0,v.EXTENT),y.emplaceBack(v.EXTENT,v.EXTENT,v.EXTENT,v.EXTENT),this.rasterBoundsBuffer=l.createVertexBuffer(y,Kt.members),this.rasterBoundsSegments=v.SegmentVector.simpleSegment(0,0,4,2);var C=new v.StructArrayLayout2i4;C.emplaceBack(0,0),C.emplaceBack(1,0),C.emplaceBack(0,1),C.emplaceBack(1,1),this.viewportBuffer=l.createVertexBuffer(C,co.members),this.viewportSegments=v.SegmentVector.simpleSegment(0,0,4,2);var T=new v.StructArrayLayout1ui2;T.emplaceBack(0),T.emplaceBack(1),T.emplaceBack(3),T.emplaceBack(2),T.emplaceBack(0),this.tileBorderIndexBuffer=l.createIndexBuffer(T);var L=new v.StructArrayLayout3ui6;L.emplaceBack(0,1,2),L.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=l.createIndexBuffer(L),this.emptyTexture=new v.Texture(l,{width:1,height:1,data:new Uint8Array([0,0,0,0])},l.gl.RGBA);var z=this.context.gl;this.stencilClearMode=new Lt({func:z.ALWAYS,mask:0},0,255,z.ZERO,z.ZERO,z.ZERO)},Yn.prototype.clearStencil=function(){var l=this.context,p=l.gl;this.nextStencilID=1,this.currentStencilSource=void 0;var c=v.create();v.ortho(c,0,this.width,this.height,0,0,1),v.scale(c,c,[p.drawingBufferWidth,p.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(l,p.TRIANGLES,ht.disabled,this.stencilClearMode,Wt.disabled,ie.disabled,ts(c),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)},Yn.prototype._renderTileClippingMasks=function(l,p){if(this.currentStencilSource!==l.source&&l.isTileClipped()&&p&&p.length){this.currentStencilSource=l.source;var c=this.context,y=c.gl;this.nextStencilID+p.length>256&&this.clearStencil(),c.setColorMode(Wt.disabled),c.setDepthMode(ht.disabled);var C=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(var T=0,L=p;T<L.length;T+=1){var z=L[T],Z=this._tileClippingMaskIDs[z.key]=this.nextStencilID++;C.draw(c,y.TRIANGLES,ht.disabled,new Lt({func:y.ALWAYS,mask:0},Z,255,y.KEEP,y.KEEP,y.REPLACE),Wt.disabled,ie.disabled,ts(z.posMatrix),"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}},Yn.prototype.stencilModeFor3D=function(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();var l=this.nextStencilID++,p=this.context.gl;return new Lt({func:p.NOTEQUAL,mask:255},l,255,p.KEEP,p.KEEP,p.REPLACE)},Yn.prototype.stencilModeForClipping=function(l){var p=this.context.gl;return new Lt({func:p.EQUAL,mask:255},this._tileClippingMaskIDs[l.key],0,p.KEEP,p.KEEP,p.REPLACE)},Yn.prototype.stencilConfigForOverlap=function(l){var p,c=this.context.gl,y=l.sort(function(Z,H){return H.overscaledZ-Z.overscaledZ}),C=y[y.length-1].overscaledZ,T=y[0].overscaledZ-C+1;if(T>1){this.currentStencilSource=void 0,this.nextStencilID+T>256&&this.clearStencil();for(var L={},z=0;z<T;z++)L[z+C]=new Lt({func:c.GEQUAL,mask:255},z+this.nextStencilID,255,c.KEEP,c.KEEP,c.REPLACE);return this.nextStencilID+=T,[L,y]}return[(p={},p[C]=Lt.disabled,p),y]},Yn.prototype.colorModeForRenderPass=function(){var l=this.context.gl;return this._showOverdrawInspector?new Wt([l.CONSTANT_COLOR,l.ONE],new v.Color(1/8,1/8,1/8,0),[!0,!0,!0,!0]):"opaque"===this.renderPass?Wt.unblended:Wt.alphaBlended},Yn.prototype.depthModeForSublayer=function(l,p,c){if(!this.opaquePassEnabledForLayer())return ht.disabled;var y=1-((1+this.currentLayer)*this.numSublayers+l)*this.depthEpsilon;return new ht(c||this.context.gl.LEQUAL,p,[y,y])},Yn.prototype.opaquePassEnabledForLayer=function(){return this.currentLayer<this.opaquePassCutoff},Yn.prototype.render=function(l,p){var c=this;this.style=l,this.options=p,this.lineAtlas=l.lineAtlas,this.imageManager=l.imageManager,this.glyphManager=l.glyphManager,this.symbolFadeChange=l.placement.symbolFadeChange(v.browser.now()),this.imageManager.beginFrame();var y=this.style._order,C=this.style.sourceCaches;for(var T in C){var L=C[T];L.used&&L.prepare(this.context)}var z,Z,H={},ut={},gt={};for(var ct in C){var zt=C[ct];H[ct]=zt.getVisibleCoordinates(),ut[ct]=H[ct].slice().reverse(),gt[ct]=zt.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(var Rt=0;Rt<y.length;Rt++)if(this.style._layers[y[Rt]].is3D()){this.opaquePassCutoff=Rt;break}this.renderPass="offscreen";for(var Yt=0,Dt=y;Yt<Dt.length;Yt+=1){var Vt=this.style._layers[Dt[Yt]];if(Vt.hasOffscreenPass()&&!Vt.isHidden(this.transform.zoom)){var ee=ut[Vt.source];("custom"===Vt.type||ee.length)&&this.renderLayer(this,C[Vt.source],Vt,ee)}}for(this.context.bindFramebuffer.set(null),this.context.clear({color:p.showOverdrawInspector?v.Color.black:v.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=p.showOverdrawInspector,this.depthRangeFor3D=[0,1-(l._order.length+2)*this.numSublayers*this.depthEpsilon],this.renderPass="opaque",this.currentLayer=y.length-1;this.currentLayer>=0;this.currentLayer--){var he=this.style._layers[y[this.currentLayer]],_e=C[he.source],ve=H[he.source];this._renderTileClippingMasks(he,ve),this.renderLayer(this,_e,he,ve)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<y.length;this.currentLayer++){var we=this.style._layers[y[this.currentLayer]],Ne=C[we.source],qe=("symbol"===we.type?gt:ut)[we.source];this._renderTileClippingMasks(we,H[we.source]),this.renderLayer(this,Ne,we,qe)}this.options.showTileBoundaries&&(v.values(this.style._layers).forEach(function(ze){ze.source&&!ze.isHidden(c.transform.zoom)&&(ze.source!==(Z&&Z.id)&&(Z=c.style.sourceCaches[ze.source]),(!z||z.getSource().maxzoom<Z.getSource().maxzoom)&&(z=Z))}),z&&Fs.debug(this,z,z.getVisibleCoordinates())),this.options.showPadding&&function(ze){var Ve=ze.transform.padding;No(ze,ze.transform.height-(Ve.top||0),3,Qu),No(ze,Ve.bottom||0,3,Xs),rs(ze,Ve.left||0,3,Cs),rs(ze,ze.transform.width-(Ve.right||0),3,Ro);var rr,tr,Dr,Xe,$e=ze.transform.centerPoint;Ss(rr=ze,(tr=$e.x)-1,(Dr=ze.transform.height-$e.y)-10,2,20,Xe=su),Ss(rr,tr-10,Dr-1,20,2,Xe)}(this),this.context.setDefault()},Yn.prototype.renderLayer=function(l,p,c,y){c.isHidden(this.transform.zoom)||("background"===c.type||"custom"===c.type||y.length)&&(this.id=c.id,this.gpuTimingStart(c),Fs[c.type](l,p,c,y,this.style.placement.variableOffsets),this.gpuTimingEnd())},Yn.prototype.gpuTimingStart=function(l){if(this.options.gpuTiming){var p=this.context.extTimerQuery,c=this.gpuTimers[l.id];c||(c=this.gpuTimers[l.id]={calls:0,cpuTime:0,query:p.createQueryEXT()}),c.calls++,p.beginQueryEXT(p.TIME_ELAPSED_EXT,c.query)}},Yn.prototype.gpuTimingEnd=function(){if(this.options.gpuTiming){var l=this.context.extTimerQuery;l.endQueryEXT(l.TIME_ELAPSED_EXT)}},Yn.prototype.collectGpuTimers=function(){var l=this.gpuTimers;return this.gpuTimers={},l},Yn.prototype.queryGpuTimers=function(l){var p={};for(var c in l){var y=l[c],C=this.context.extTimerQuery,T=C.getQueryObjectEXT(y.query,C.QUERY_RESULT_EXT)/1e6;C.deleteQueryEXT(y.query),p[c]=T}return p},Yn.prototype.translatePosMatrix=function(l,p,c,y,C){if(!c[0]&&!c[1])return l;var T=C?"map"===y?this.transform.angle:0:"viewport"===y?-this.transform.angle:0;if(T){var L=Math.sin(T),z=Math.cos(T);c=[c[0]*z-c[1]*L,c[0]*L+c[1]*z]}var Z=[C?c[0]:Wi(p,c[0],this.transform.zoom),C?c[1]:Wi(p,c[1],this.transform.zoom),0],H=new Float32Array(16);return v.translate(H,l,Z),H},Yn.prototype.saveTileTexture=function(l){var p=this._tileTextures[l.size[0]];p?p.push(l):this._tileTextures[l.size[0]]=[l]},Yn.prototype.getTileTexture=function(l){var p=this._tileTextures[l];return p&&p.length>0?p.pop():null},Yn.prototype.isPatternMissing=function(l){if(!l)return!1;if(!l.from||!l.to)return!0;var p=this.imageManager.getPattern(l.from.toString()),c=this.imageManager.getPattern(l.to.toString());return!p||!c},Yn.prototype.useProgram=function(l,p){this.cache=this.cache||{};var c=""+l+(p?p.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"");return this.cache[c]||(this.cache[c]=new bs(this.context,l,gu[l],p,za[l],this._showOverdrawInspector)),this.cache[c]},Yn.prototype.setCustomLayerDefaults=function(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()},Yn.prototype.setBaseState=function(){var l=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(l.FUNC_ADD)},Yn.prototype.initDebugOverlayCanvas=function(){null==this.debugOverlayCanvas&&(this.debugOverlayCanvas=v.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new v.Texture(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))},Yn.prototype.destroy=function(){this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy()};var Fa=function(l,p){this.points=l,this.planes=p};Fa.fromInvProjectionMatrix=function(l,p,c){var y=Math.pow(2,c),C=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(function(L){return v.transformMat4([],L,l)}).map(function(L){return v.scale$1([],L,1/L[3]/p*y)}),T=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(function(L){var z=v.sub([],C[L[0]],C[L[1]]),Z=v.sub([],C[L[2]],C[L[1]]),H=v.normalize([],v.cross([],z,Z)),ut=-v.dot(H,C[L[1]]);return H.concat(ut)});return new Fa(C,T)};var Hi=function(l,p){this.min=l,this.max=p,this.center=v.scale$2([],v.add([],this.min,this.max),.5)};Hi.prototype.quadrant=function(l){for(var p=[l%2==0,l<2],c=v.clone$2(this.min),y=v.clone$2(this.max),C=0;C<p.length;C++)c[C]=p[C]?this.min[C]:this.center[C],y[C]=p[C]?this.center[C]:this.max[C];return y[2]=this.max[2],new Hi(c,y)},Hi.prototype.distanceX=function(l){return Math.max(Math.min(this.max[0],l[0]),this.min[0])-l[0]},Hi.prototype.distanceY=function(l){return Math.max(Math.min(this.max[1],l[1]),this.min[1])-l[1]},Hi.prototype.intersects=function(l){for(var p=[[this.min[0],this.min[1],0,1],[this.max[0],this.min[1],0,1],[this.max[0],this.max[1],0,1],[this.min[0],this.max[1],0,1]],c=!0,y=0;y<l.planes.length;y++){for(var C=l.planes[y],T=0,L=0;L<p.length;L++)T+=v.dot$1(C,p[L])>=0;if(0===T)return 0;T!==p.length&&(c=!1)}if(c)return 2;for(var z=0;z<3;z++){for(var Z=Number.MAX_VALUE,H=-Number.MAX_VALUE,ut=0;ut<l.points.length;ut++){var gt=l.points[ut][z]-this.min[z];Z=Math.min(Z,gt),H=Math.max(H,gt)}if(H<0||Z>this.max[z]-this.min[z])return 0}return 1};var zo=function(l,p,c,y){if(void 0===l&&(l=0),void 0===p&&(p=0),void 0===c&&(c=0),void 0===y&&(y=0),isNaN(l)||l<0||isNaN(p)||p<0||isNaN(c)||c<0||isNaN(y)||y<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=l,this.bottom=p,this.left=c,this.right=y};zo.prototype.interpolate=function(l,p,c){return null!=p.top&&null!=l.top&&(this.top=v.number(l.top,p.top,c)),null!=p.bottom&&null!=l.bottom&&(this.bottom=v.number(l.bottom,p.bottom,c)),null!=p.left&&null!=l.left&&(this.left=v.number(l.left,p.left,c)),null!=p.right&&null!=l.right&&(this.right=v.number(l.right,p.right,c)),this},zo.prototype.getCenter=function(l,p){var c=v.clamp((this.left+l-this.right)/2,0,l),y=v.clamp((this.top+p-this.bottom)/2,0,p);return new v.Point(c,y)},zo.prototype.equals=function(l){return this.top===l.top&&this.bottom===l.bottom&&this.left===l.left&&this.right===l.right},zo.prototype.clone=function(){return new zo(this.top,this.bottom,this.left,this.right)},zo.prototype.toJSON=function(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}};var _n=function(l,p,c,y,C){this.tileSize=512,this.maxValidLatitude=85.051129,this._renderWorldCopies=void 0===C||C,this._minZoom=l||0,this._maxZoom=p||22,this._minPitch=null==c?0:c,this._maxPitch=null==y?60:y,this.setMaxBounds(),this.width=0,this.height=0,this._center=new v.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new zo,this._posMatrixCache={},this._alignedPosMatrixCache={}},zn={minZoom:{configurable:!0},maxZoom:{configurable:!0},minPitch:{configurable:!0},maxPitch:{configurable:!0},renderWorldCopies:{configurable:!0},worldSize:{configurable:!0},centerOffset:{configurable:!0},size:{configurable:!0},bearing:{configurable:!0},pitch:{configurable:!0},fov:{configurable:!0},zoom:{configurable:!0},center:{configurable:!0},padding:{configurable:!0},centerPoint:{configurable:!0},unmodified:{configurable:!0},point:{configurable:!0}};_n.prototype.clone=function(){var l=new _n(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return l.tileSize=this.tileSize,l.latRange=this.latRange,l.width=this.width,l.height=this.height,l._center=this._center,l.zoom=this.zoom,l.angle=this.angle,l._fov=this._fov,l._pitch=this._pitch,l._unmodified=this._unmodified,l._edgeInsets=this._edgeInsets.clone(),l._calcMatrices(),l},zn.minZoom.get=function(){return this._minZoom},zn.minZoom.set=function(l){this._minZoom!==l&&(this._minZoom=l,this.zoom=Math.max(this.zoom,l))},zn.maxZoom.get=function(){return this._maxZoom},zn.maxZoom.set=function(l){this._maxZoom!==l&&(this._maxZoom=l,this.zoom=Math.min(this.zoom,l))},zn.minPitch.get=function(){return this._minPitch},zn.minPitch.set=function(l){this._minPitch!==l&&(this._minPitch=l,this.pitch=Math.max(this.pitch,l))},zn.maxPitch.get=function(){return this._maxPitch},zn.maxPitch.set=function(l){this._maxPitch!==l&&(this._maxPitch=l,this.pitch=Math.min(this.pitch,l))},zn.renderWorldCopies.get=function(){return this._renderWorldCopies},zn.renderWorldCopies.set=function(l){void 0===l?l=!0:null===l&&(l=!1),this._renderWorldCopies=l},zn.worldSize.get=function(){return this.tileSize*this.scale},zn.centerOffset.get=function(){return this.centerPoint._sub(this.size._div(2))},zn.size.get=function(){return new v.Point(this.width,this.height)},zn.bearing.get=function(){return-this.angle/Math.PI*180},zn.bearing.set=function(l){var p=-v.wrap(l,-180,180)*Math.PI/180;this.angle!==p&&(this._unmodified=!1,this.angle=p,this._calcMatrices(),this.rotationMatrix=v.create$2(),v.rotate(this.rotationMatrix,this.rotationMatrix,this.angle))},zn.pitch.get=function(){return this._pitch/Math.PI*180},zn.pitch.set=function(l){var p=v.clamp(l,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==p&&(this._unmodified=!1,this._pitch=p,this._calcMatrices())},zn.fov.get=function(){return this._fov/Math.PI*180},zn.fov.set=function(l){l=Math.max(.01,Math.min(60,l)),this._fov!==l&&(this._unmodified=!1,this._fov=l/180*Math.PI,this._calcMatrices())},zn.zoom.get=function(){return this._zoom},zn.zoom.set=function(l){var p=Math.min(Math.max(l,this.minZoom),this.maxZoom);this._zoom!==p&&(this._unmodified=!1,this._zoom=p,this.scale=this.zoomScale(p),this.tileZoom=Math.floor(p),this.zoomFraction=p-this.tileZoom,this._constrain(),this._calcMatrices())},zn.center.get=function(){return this._center},zn.center.set=function(l){l.lat===this._center.lat&&l.lng===this._center.lng||(this._unmodified=!1,this._center=l,this._constrain(),this._calcMatrices())},zn.padding.get=function(){return this._edgeInsets.toJSON()},zn.padding.set=function(l){this._edgeInsets.equals(l)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,l,1),this._calcMatrices())},zn.centerPoint.get=function(){return this._edgeInsets.getCenter(this.width,this.height)},_n.prototype.isPaddingEqual=function(l){return this._edgeInsets.equals(l)},_n.prototype.interpolatePadding=function(l,p,c){this._unmodified=!1,this._edgeInsets.interpolate(l,p,c),this._constrain(),this._calcMatrices()},_n.prototype.coveringZoomLevel=function(l){var p=(l.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/l.tileSize));return Math.max(0,p)},_n.prototype.getVisibleUnwrappedCoordinates=function(l){var p=[new v.UnwrappedTileID(0,l)];if(this._renderWorldCopies)for(var c=this.pointCoordinate(new v.Point(0,0)),y=this.pointCoordinate(new v.Point(this.width,0)),C=this.pointCoordinate(new v.Point(this.width,this.height)),T=this.pointCoordinate(new v.Point(0,this.height)),L=Math.floor(Math.min(c.x,y.x,C.x,T.x)),z=Math.floor(Math.max(c.x,y.x,C.x,T.x)),Z=L-1;Z<=z+1;Z++)0!==Z&&p.push(new v.UnwrappedTileID(Z,l));return p},_n.prototype.coveringTiles=function(l){var p=this.coveringZoomLevel(l),c=p;if(void 0!==l.minzoom&&p<l.minzoom)return[];void 0!==l.maxzoom&&p>l.maxzoom&&(p=l.maxzoom);var y=v.MercatorCoordinate.fromLngLat(this.center),C=Math.pow(2,p),T=[C*y.x,C*y.y,0],L=Fa.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,p),z=l.minzoom||0;this.pitch<=60&&this._edgeInsets.top<.1&&(z=p);var Z=function(ze){return{aabb:new Hi([ze*C,0,0],[(ze+1)*C,C,0]),zoom:0,x:0,y:0,wrap:ze,fullyVisible:!1}},H=[],ut=[],gt=p,ct=l.reparseOverscaled?c:p;if(this._renderWorldCopies)for(var zt=1;zt<=3;zt++)H.push(Z(-zt)),H.push(Z(zt));for(H.push(Z(0));H.length>0;){var Rt=H.pop(),Yt=Rt.x,Dt=Rt.y,Vt=Rt.fullyVisible;if(!Vt){var ee=Rt.aabb.intersects(L);if(0===ee)continue;Vt=2===ee}var he=Rt.aabb.distanceX(T),_e=Rt.aabb.distanceY(T),ve=Math.max(Math.abs(he),Math.abs(_e));if(Rt.zoom===gt||ve>3+(1<<gt-Rt.zoom)-2&&Rt.zoom>=z)ut.push({tileID:new v.OverscaledTileID(Rt.zoom===gt?ct:Rt.zoom,Rt.wrap,Rt.zoom,Yt,Dt),distanceSq:v.sqrLen([T[0]-.5-Yt,T[1]-.5-Dt])});else for(var we=0;we<4;we++){var Ne=(Yt<<1)+we%2,qe=(Dt<<1)+(we>>1);H.push({aabb:Rt.aabb.quadrant(we),zoom:Rt.zoom+1,x:Ne,y:qe,wrap:Rt.wrap,fullyVisible:Vt})}}return ut.sort(function(ze,Ve){return ze.distanceSq-Ve.distanceSq}).map(function(ze){return ze.tileID})},_n.prototype.resize=function(l,p){this.width=l,this.height=p,this.pixelsToGLUnits=[2/l,-2/p],this._constrain(),this._calcMatrices()},zn.unmodified.get=function(){return this._unmodified},_n.prototype.zoomScale=function(l){return Math.pow(2,l)},_n.prototype.scaleZoom=function(l){return Math.log(l)/Math.LN2},_n.prototype.project=function(l){var p=v.clamp(l.lat,-this.maxValidLatitude,this.maxValidLatitude);return new v.Point(v.mercatorXfromLng(l.lng)*this.worldSize,v.mercatorYfromLat(p)*this.worldSize)},_n.prototype.unproject=function(l){return new v.MercatorCoordinate(l.x/this.worldSize,l.y/this.worldSize).toLngLat()},zn.point.get=function(){return this.project(this.center)},_n.prototype.setLocationAtPoint=function(l,p){var c=this.pointCoordinate(p),y=this.pointCoordinate(this.centerPoint),C=this.locationCoordinate(l),T=new v.MercatorCoordinate(C.x-(c.x-y.x),C.y-(c.y-y.y));this.center=this.coordinateLocation(T),this._renderWorldCopies&&(this.center=this.center.wrap())},_n.prototype.locationPoint=function(l){return this.coordinatePoint(this.locationCoordinate(l))},_n.prototype.pointLocation=function(l){return this.coordinateLocation(this.pointCoordinate(l))},_n.prototype.locationCoordinate=function(l){return v.MercatorCoordinate.fromLngLat(l)},_n.prototype.coordinateLocation=function(l){return l.toLngLat()},_n.prototype.pointCoordinate=function(l){var p=[l.x,l.y,0,1],c=[l.x,l.y,1,1];v.transformMat4(p,p,this.pixelMatrixInverse),v.transformMat4(c,c,this.pixelMatrixInverse);var y=p[3],C=c[3],T=p[1]/y,L=c[1]/C,z=p[2]/y,Z=c[2]/C,H=z===Z?0:(0-z)/(Z-z);return new v.MercatorCoordinate(v.number(p[0]/y,c[0]/C,H)/this.worldSize,v.number(T,L,H)/this.worldSize)},_n.prototype.coordinatePoint=function(l){var p=[l.x*this.worldSize,l.y*this.worldSize,0,1];return v.transformMat4(p,p,this.pixelMatrix),new v.Point(p[0]/p[3],p[1]/p[3])},_n.prototype.getBounds=function(){return(new v.LngLatBounds).extend(this.pointLocation(new v.Point(0,0))).extend(this.pointLocation(new v.Point(this.width,0))).extend(this.pointLocation(new v.Point(this.width,this.height))).extend(this.pointLocation(new v.Point(0,this.height)))},_n.prototype.getMaxBounds=function(){return this.latRange&&2===this.latRange.length&&this.lngRange&&2===this.lngRange.length?new v.LngLatBounds([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null},_n.prototype.setMaxBounds=function(l){l?(this.lngRange=[l.getWest(),l.getEast()],this.latRange=[l.getSouth(),l.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])},_n.prototype.calculatePosMatrix=function(l,p){void 0===p&&(p=!1);var c=l.key,y=p?this._alignedPosMatrixCache:this._posMatrixCache;if(y[c])return y[c];var C=l.canonical,T=this.worldSize/this.zoomScale(C.z),L=C.x+Math.pow(2,C.z)*l.wrap,z=v.identity(new Float64Array(16));return v.translate(z,z,[L*T,C.y*T,0]),v.scale(z,z,[T/v.EXTENT,T/v.EXTENT,1]),v.multiply(z,p?this.alignedProjMatrix:this.projMatrix,z),y[c]=new Float32Array(z),y[c]},_n.prototype.customLayerMatrix=function(){return this.mercatorMatrix.slice()},_n.prototype._constrain=function(){if(this.center&&this.width&&this.height&&!this._constraining){this._constraining=!0;var l,p,c,y,C=-90,T=90,L=-180,z=180,Z=this.size,H=this._unmodified;if(this.latRange){var ut=this.latRange;C=v.mercatorYfromLat(ut[1])*this.worldSize,l=(T=v.mercatorYfromLat(ut[0])*this.worldSize)-C<Z.y?Z.y/(T-C):0}if(this.lngRange){var gt=this.lngRange;L=v.mercatorXfromLng(gt[0])*this.worldSize,p=(z=v.mercatorXfromLng(gt[1])*this.worldSize)-L<Z.x?Z.x/(z-L):0}var ct=this.point,zt=Math.max(p||0,l||0);if(zt)return this.center=this.unproject(new v.Point(p?(z+L)/2:ct.x,l?(T+C)/2:ct.y)),this.zoom+=this.scaleZoom(zt),this._unmodified=H,void(this._constraining=!1);if(this.latRange){var Rt=ct.y,Yt=Z.y/2;Rt-Yt<C&&(y=C+Yt),Rt+Yt>T&&(y=T-Yt)}if(this.lngRange){var Dt=ct.x,Vt=Z.x/2;Dt-Vt<L&&(c=L+Vt),Dt+Vt>z&&(c=z-Vt)}void 0===c&&void 0===y||(this.center=this.unproject(new v.Point(void 0!==c?c:ct.x,void 0!==y?y:ct.y))),this._unmodified=H,this._constraining=!1}},_n.prototype._calcMatrices=function(){if(this.height){var l=this.centerOffset;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height;var p=Math.PI/2+this._pitch,c=this._fov*(.5+l.y/this.height),y=Math.sin(c)*this.cameraToCenterDistance/Math.sin(v.clamp(Math.PI-p-c,.01,Math.PI-.01)),C=this.point,T=C.x,L=C.y,z=1.01*(Math.cos(Math.PI/2-this._pitch)*y+this.cameraToCenterDistance),Z=this.height/50,H=new Float64Array(16);v.perspective(H,this._fov,this.width/this.height,Z,z),H[8]=2*-l.x/this.width,H[9]=2*l.y/this.height,v.scale(H,H,[1,-1,1]),v.translate(H,H,[0,0,-this.cameraToCenterDistance]),v.rotateX(H,H,this._pitch),v.rotateZ(H,H,this.angle),v.translate(H,H,[-T,-L,0]),this.mercatorMatrix=v.scale([],H,[this.worldSize,this.worldSize,this.worldSize]),v.scale(H,H,[1,1,v.mercatorZfromAltitude(1,this.center.lat)*this.worldSize,1]),this.projMatrix=H,this.invProjMatrix=v.invert([],this.projMatrix);var ut=this.width%2/2,gt=this.height%2/2,ct=Math.cos(this.angle),zt=Math.sin(this.angle),Rt=T-Math.round(T)+ct*ut+zt*gt,Yt=L-Math.round(L)+ct*gt+zt*ut,Dt=new Float64Array(H);if(v.translate(Dt,Dt,[Rt>.5?Rt-1:Rt,Yt>.5?Yt-1:Yt,0]),this.alignedProjMatrix=Dt,H=v.create(),v.scale(H,H,[this.width/2,-this.height/2,1]),v.translate(H,H,[1,-1,0]),this.labelPlaneMatrix=H,H=v.create(),v.scale(H,H,[1,-1,1]),v.translate(H,H,[-1,-1,0]),v.scale(H,H,[2/this.width,2/this.height,1]),this.glCoordMatrix=H,this.pixelMatrix=v.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),!(H=v.invert(new Float64Array(16),this.pixelMatrix)))throw new Error("failed to invert matrix");this.pixelMatrixInverse=H,this._posMatrixCache={},this._alignedPosMatrixCache={}}},_n.prototype.maxPitchScaleFactor=function(){if(!this.pixelMatrixInverse)return 1;var l=this.pointCoordinate(new v.Point(0,0)),p=[l.x*this.worldSize,l.y*this.worldSize,0,1];return v.transformMat4(p,p,this.pixelMatrix)[3]/this.cameraToCenterDistance},_n.prototype.getCameraPoint=function(){var l=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new v.Point(0,l))},_n.prototype.getCameraQueryGeometry=function(l){var p=this.getCameraPoint();if(1===l.length)return[l[0],p];for(var c=p.x,y=p.y,C=p.x,T=p.y,L=0,z=l;L<z.length;L+=1){var Z=z[L];c=Math.min(c,Z.x),y=Math.min(y,Z.y),C=Math.max(C,Z.x),T=Math.max(T,Z.y)}return[new v.Point(c,y),new v.Point(C,y),new v.Point(C,T),new v.Point(c,T),new v.Point(c,y)]},Object.defineProperties(_n.prototype,zn);var sa=function(l){var p,c,y,C;this._hashName=l&&encodeURIComponent(l),v.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=(p=this._updateHashUnthrottled.bind(this),c=!1,y=null,C=function(){y=null,c&&(p(),y=setTimeout(C,300),c=!1)},function(){return c=!0,y||C(),y})};sa.prototype.addTo=function(l){return this._map=l,v.window.addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this},sa.prototype.remove=function(){return v.window.removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this},sa.prototype.getHashString=function(l){var p=this._map.getCenter(),c=Math.round(100*this._map.getZoom())/100,y=Math.ceil((c*Math.LN2+Math.log(512/360/.5))/Math.LN10),C=Math.pow(10,y),T=Math.round(p.lng*C)/C,L=Math.round(p.lat*C)/C,z=this._map.getBearing(),Z=this._map.getPitch(),H="";if(H+=l?"/"+T+"/"+L+"/"+c:c+"/"+L+"/"+T,(z||Z)&&(H+="/"+Math.round(10*z)/10),Z&&(H+="/"+Math.round(Z)),this._hashName){var ut=this._hashName,gt=!1,ct=v.window.location.hash.slice(1).split("&").map(function(zt){var Rt=zt.split("=")[0];return Rt===ut?(gt=!0,Rt+"="+H):zt}).filter(function(zt){return zt});return gt||ct.push(ut+"="+H),"#"+ct.join("&")}return"#"+H},sa.prototype._getCurrentHash=function(){var l,p=this,c=v.window.location.hash.replace("#","");return this._hashName?(c.split("&").map(function(y){return y.split("=")}).forEach(function(y){y[0]===p._hashName&&(l=y)}),(l&&l[1]||"").split("/")):c.split("/")},sa.prototype._onHashChange=function(){var l=this._getCurrentHash();if(l.length>=3&&!l.some(function(c){return isNaN(c)})){var p=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(l[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+l[2],+l[1]],zoom:+l[0],bearing:p,pitch:+(l[4]||0)}),!0}return!1},sa.prototype._updateHashUnthrottled=function(){var l=v.window.location.href.replace(/(#.+)?$/,this.getHashString());try{v.window.history.replaceState(v.window.history.state,null,l)}catch(p){}};var Ma={linearity:.3,easing:v.bezier(0,0,.3,1)},ko=v.extend({deceleration:2500,maxSpeed:1400},Ma),oo=v.extend({deceleration:20,maxSpeed:1400},Ma),Ta=v.extend({deceleration:1e3,maxSpeed:360},Ma),ns=v.extend({deceleration:1e3,maxSpeed:90},Ma),Au=function(l){this._map=l,this.clear()};function Ys(l,p){(!l.duration||l.duration<p.duration)&&(l.duration=p.duration,l.easing=p.easing)}function is(l,p,c){var y=c.maxSpeed,C=c.linearity,T=c.deceleration,L=v.clamp(l*C/(p/1e3),-y,y),z=Math.abs(L)/(T*C);return{easing:c.easing,duration:1e3*z,amount:L*(z/2)}}Au.prototype.clear=function(){this._inertiaBuffer=[]},Au.prototype.record=function(l){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:v.browser.now(),settings:l})},Au.prototype._drainInertiaBuffer=function(){for(var l=this._inertiaBuffer,p=v.browser.now();l.length>0&&p-l[0].time>160;)l.shift()},Au.prototype._onMoveEnd=function(l){if(this._drainInertiaBuffer(),!(this._inertiaBuffer.length<2)){for(var p={zoom:0,bearing:0,pitch:0,pan:new v.Point(0,0),pinchAround:void 0,around:void 0},c=0,y=this._inertiaBuffer;c<y.length;c+=1){var C=y[c].settings;p.zoom+=C.zoomDelta||0,p.bearing+=C.bearingDelta||0,p.pitch+=C.pitchDelta||0,C.panDelta&&p.pan._add(C.panDelta),C.around&&(p.around=C.around),C.pinchAround&&(p.pinchAround=C.pinchAround)}var T=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,L={};if(p.pan.mag()){var z=is(p.pan.mag(),T,v.extend({},ko,l||{}));L.offset=p.pan.mult(z.amount/p.pan.mag()),L.center=this._map.transform.center,Ys(L,z)}if(p.zoom){var Z=is(p.zoom,T,oo);L.zoom=this._map.transform.zoom+Z.amount,Ys(L,Z)}if(p.bearing){var H=is(p.bearing,T,Ta);L.bearing=this._map.transform.bearing+v.clamp(H.amount,-179,179),Ys(L,H)}if(p.pitch){var ut=is(p.pitch,T,ns);L.pitch=this._map.transform.pitch+ut.amount,Ys(L,ut)}if(L.zoom||L.bearing){var gt=void 0===p.pinchAround?p.around:p.pinchAround;L.around=gt?this._map.unproject(gt):this._map.getCenter()}return this.clear(),v.extend(L,{noMoveStart:!0})}};var _i=function(l){function p(y,C,T,L){void 0===L&&(L={});var z=ft.mousePos(C.getCanvasContainer(),T),Z=C.unproject(z);l.call(this,y,v.extend({point:z,lngLat:Z,originalEvent:T},L)),this._defaultPrevented=!1,this.target=C}l&&(p.__proto__=l),(p.prototype=Object.create(l&&l.prototype)).constructor=p;var c={defaultPrevented:{configurable:!0}};return p.prototype.preventDefault=function(){this._defaultPrevented=!0},c.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(p.prototype,c),p}(v.Event),Ba=function(l){function p(y,C,T){var L="touchend"===y?T.changedTouches:T.touches,z=ft.touchPos(C.getCanvasContainer(),L),Z=z.map(function(gt){return C.unproject(gt)}),H=z.reduce(function(gt,ct,zt,Rt){return gt.add(ct.div(Rt.length))},new v.Point(0,0)),ut=C.unproject(H);l.call(this,y,{points:z,point:H,lngLats:Z,lngLat:ut,originalEvent:T}),this._defaultPrevented=!1}l&&(p.__proto__=l),(p.prototype=Object.create(l&&l.prototype)).constructor=p;var c={defaultPrevented:{configurable:!0}};return p.prototype.preventDefault=function(){this._defaultPrevented=!0},c.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(p.prototype,c),p}(v.Event),Co=function(l){function p(y,C,T){l.call(this,y,{originalEvent:T}),this._defaultPrevented=!1}l&&(p.__proto__=l),(p.prototype=Object.create(l&&l.prototype)).constructor=p;var c={defaultPrevented:{configurable:!0}};return p.prototype.preventDefault=function(){this._defaultPrevented=!0},c.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(p.prototype,c),p}(v.Event),So=function(l,p){this._map=l,this._clickTolerance=p.clickTolerance};So.prototype.reset=function(){delete this._mousedownPos},So.prototype.wheel=function(l){return this._firePreventable(new Co(l.type,this._map,l))},So.prototype.mousedown=function(l,p){return this._mousedownPos=p,this._firePreventable(new _i(l.type,this._map,l))},So.prototype.mouseup=function(l){this._map.fire(new _i(l.type,this._map,l))},So.prototype.click=function(l,p){this._mousedownPos&&this._mousedownPos.dist(p)>=this._clickTolerance||this._map.fire(new _i(l.type,this._map,l))},So.prototype.dblclick=function(l){return this._firePreventable(new _i(l.type,this._map,l))},So.prototype.mouseover=function(l){this._map.fire(new _i(l.type,this._map,l))},So.prototype.mouseout=function(l){this._map.fire(new _i(l.type,this._map,l))},So.prototype.touchstart=function(l){return this._firePreventable(new Ba(l.type,this._map,l))},So.prototype.touchmove=function(l){this._map.fire(new Ba(l.type,this._map,l))},So.prototype.touchend=function(l){this._map.fire(new Ba(l.type,this._map,l))},So.prototype.touchcancel=function(l){this._map.fire(new Ba(l.type,this._map,l))},So.prototype._firePreventable=function(l){if(this._map.fire(l),l.defaultPrevented)return{}},So.prototype.isEnabled=function(){return!0},So.prototype.isActive=function(){return!1},So.prototype.enable=function(){},So.prototype.disable=function(){};var Ji=function(l){this._map=l};Ji.prototype.reset=function(){this._delayContextMenu=!1,delete this._contextMenuEvent},Ji.prototype.mousemove=function(l){this._map.fire(new _i(l.type,this._map,l))},Ji.prototype.mousedown=function(){this._delayContextMenu=!0},Ji.prototype.mouseup=function(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new _i("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)},Ji.prototype.contextmenu=function(l){this._delayContextMenu?this._contextMenuEvent=l:this._map.fire(new _i(l.type,this._map,l)),this._map.listens("contextmenu")&&l.preventDefault()},Ji.prototype.isEnabled=function(){return!0},Ji.prototype.isActive=function(){return!1},Ji.prototype.enable=function(){},Ji.prototype.disable=function(){};var er=function(l,p){this._map=l,this._el=l.getCanvasContainer(),this._container=l.getContainer(),this._clickTolerance=p.clickTolerance||1};function ua(l,p){for(var c={},y=0;y<l.length;y++)c[l[y].identifier]=p[y];return c}er.prototype.isEnabled=function(){return!!this._enabled},er.prototype.isActive=function(){return!!this._active},er.prototype.enable=function(){this.isEnabled()||(this._enabled=!0)},er.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},er.prototype.mousedown=function(l,p){this.isEnabled()&&l.shiftKey&&0===l.button&&(ft.disableDrag(),this._startPos=this._lastPos=p,this._active=!0)},er.prototype.mousemoveWindow=function(l,p){if(this._active){var c=p;if(!(this._lastPos.equals(c)||!this._box&&c.dist(this._startPos)<this._clickTolerance)){var y=this._startPos;this._lastPos=c,this._box||(this._box=ft.create("div","maplibregl-boxzoom mapboxgl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair","mapboxgl-crosshair"),this._fireEvent("boxzoomstart",l));var C=Math.min(y.x,c.x),T=Math.max(y.x,c.x),L=Math.min(y.y,c.y),z=Math.max(y.y,c.y);ft.setTransform(this._box,"translate("+C+"px,"+L+"px)"),this._box.style.width=T-C+"px",this._box.style.height=z-L+"px"}}},er.prototype.mouseupWindow=function(l,p){var c=this;if(this._active&&0===l.button){var y=this._startPos,C=p;if(this.reset(),ft.suppressClick(),y.x!==C.x||y.y!==C.y)return this._map.fire(new v.Event("boxzoomend",{originalEvent:l})),{cameraAnimation:function(T){return T.fitScreenCoordinates(y,C,c._map.getBearing(),{linear:!0})}};this._fireEvent("boxzoomcancel",l)}},er.prototype.keydown=function(l){this._active&&27===l.keyCode&&(this.reset(),this._fireEvent("boxzoomcancel",l))},er.prototype.reset=function(){this._active=!1,this._container.classList.remove("maplibregl-crosshair","mapboxgl-crosshair"),this._box&&(ft.remove(this._box),this._box=null),ft.enableDrag(),delete this._startPos,delete this._lastPos},er.prototype._fireEvent=function(l,p){return this._map.fire(new v.Event(l,{originalEvent:p}))};var os=function(l){this.reset(),this.numTouches=l.numTouches};os.prototype.reset=function(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1},os.prototype.touchstart=function(l,p,c){(this.centroid||c.length>this.numTouches)&&(this.aborted=!0),this.aborted||(void 0===this.startTime&&(this.startTime=l.timeStamp),c.length===this.numTouches&&(this.centroid=function(y){for(var C=new v.Point(0,0),T=0,L=y;T<L.length;T+=1)C._add(L[T]);return C.div(y.length)}(p),this.touches=ua(c,p)))},os.prototype.touchmove=function(l,p,c){if(!this.aborted&&this.centroid){var y=ua(c,p);for(var C in this.touches){var T=y[C];(!T||T.dist(this.touches[C])>30)&&(this.aborted=!0)}}},os.prototype.touchend=function(l,p,c){if((!this.centroid||l.timeStamp-this.startTime>500)&&(this.aborted=!0),0===c.length){var y=!this.aborted&&this.centroid;if(this.reset(),y)return y}};var Ua=function(l){this.singleTap=new os(l),this.numTaps=l.numTaps,this.reset()};Ua.prototype.reset=function(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()},Ua.prototype.touchstart=function(l,p,c){this.singleTap.touchstart(l,p,c)},Ua.prototype.touchmove=function(l,p,c){this.singleTap.touchmove(l,p,c)},Ua.prototype.touchend=function(l,p,c){var y=this.singleTap.touchend(l,p,c);if(y){var C=l.timeStamp-this.lastTime<500,T=!this.lastTap||this.lastTap.dist(y)<30;if(C&&T||this.reset(),this.count++,this.lastTime=l.timeStamp,this.lastTap=y,this.count===this.numTaps)return this.reset(),y}};var ji=function(){this._zoomIn=new Ua({numTouches:1,numTaps:2}),this._zoomOut=new Ua({numTouches:2,numTaps:1}),this.reset()};ji.prototype.reset=function(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()},ji.prototype.touchstart=function(l,p,c){this._zoomIn.touchstart(l,p,c),this._zoomOut.touchstart(l,p,c)},ji.prototype.touchmove=function(l,p,c){this._zoomIn.touchmove(l,p,c),this._zoomOut.touchmove(l,p,c)},ji.prototype.touchend=function(l,p,c){var y=this,C=this._zoomIn.touchend(l,p,c),T=this._zoomOut.touchend(l,p,c);return C?(this._active=!0,l.preventDefault(),setTimeout(function(){return y.reset()},0),{cameraAnimation:function(L){return L.easeTo({duration:300,zoom:L.getZoom()+1,around:L.unproject(C)},{originalEvent:l})}}):T?(this._active=!0,l.preventDefault(),setTimeout(function(){return y.reset()},0),{cameraAnimation:function(L){return L.easeTo({duration:300,zoom:L.getZoom()-1,around:L.unproject(T)},{originalEvent:l})}}):void 0},ji.prototype.touchcancel=function(){this.reset()},ji.prototype.enable=function(){this._enabled=!0},ji.prototype.disable=function(){this._enabled=!1,this.reset()},ji.prototype.isEnabled=function(){return this._enabled},ji.prototype.isActive=function(){return this._active};var ps={0:1,2:2},xi=function(l){this.reset(),this._clickTolerance=l.clickTolerance||1};xi.prototype.reset=function(){this._active=!1,this._moved=!1,delete this._lastPoint,delete this._eventButton},xi.prototype._correctButton=function(l,p){return!1},xi.prototype._move=function(l,p){return{}},xi.prototype.mousedown=function(l,p){if(!this._lastPoint){var c=ft.mouseButton(l);this._correctButton(l,c)&&(this._lastPoint=p,this._eventButton=c)}},xi.prototype.mousemoveWindow=function(l,p){var y,T,c=this._lastPoint;if(c)if(l.preventDefault(),T=ps[this._eventButton],void 0===(y=l).buttons||(y.buttons&T)!==T)this.reset();else if(this._moved||!(p.dist(c)<this._clickTolerance))return this._moved=!0,this._lastPoint=p,this._move(c,p)},xi.prototype.mouseupWindow=function(l){this._lastPoint&&ft.mouseButton(l)===this._eventButton&&(this._moved&&ft.suppressClick(),this.reset())},xi.prototype.enable=function(){this._enabled=!0},xi.prototype.disable=function(){this._enabled=!1,this.reset()},xi.prototype.isEnabled=function(){return this._enabled},xi.prototype.isActive=function(){return this._active};var dr=function(l){function p(){l.apply(this,arguments)}return l&&(p.__proto__=l),(p.prototype=Object.create(l&&l.prototype)).constructor=p,p.prototype.mousedown=function(c,y){l.prototype.mousedown.call(this,c,y),this._lastPoint&&(this._active=!0)},p.prototype._correctButton=function(c,y){return 0===y&&!c.ctrlKey},p.prototype._move=function(c,y){return{around:y,panDelta:y.sub(c)}},p}(xi),Bi=function(l){function p(){l.apply(this,arguments)}return l&&(p.__proto__=l),(p.prototype=Object.create(l&&l.prototype)).constructor=p,p.prototype._correctButton=function(c,y){return 0===y&&c.ctrlKey||2===y},p.prototype._move=function(c,y){var C=.8*(y.x-c.x);if(C)return this._active=!0,{bearingDelta:C}},p.prototype.contextmenu=function(c){c.preventDefault()},p}(xi),tl=function(l){function p(){l.apply(this,arguments)}return l&&(p.__proto__=l),(p.prototype=Object.create(l&&l.prototype)).constructor=p,p.prototype._correctButton=function(c,y){return 0===y&&c.ctrlKey||2===y},p.prototype._move=function(c,y){var C=-.5*(y.y-c.y);if(C)return this._active=!0,{pitchDelta:C}},p.prototype.contextmenu=function(c){c.preventDefault()},p}(xi),fs=function(l){this._minTouches=1,this._clickTolerance=l.clickTolerance||1,this.reset()};fs.prototype.reset=function(){this._active=!1,this._touches={},this._sum=new v.Point(0,0)},fs.prototype.touchstart=function(l,p,c){return this._calculateTransform(l,p,c)},fs.prototype.touchmove=function(l,p,c){if(this._active&&!(c.length<this._minTouches))return l.preventDefault(),this._calculateTransform(l,p,c)},fs.prototype.touchend=function(l,p,c){this._calculateTransform(l,p,c),this._active&&c.length<this._minTouches&&this.reset()},fs.prototype.touchcancel=function(){this.reset()},fs.prototype._calculateTransform=function(l,p,c){c.length>0&&(this._active=!0);var y=ua(c,p),C=new v.Point(0,0),T=new v.Point(0,0),L=0;for(var z in y){var Z=y[z],H=this._touches[z];H&&(C._add(Z),T._add(Z.sub(H)),L++,y[z]=Z)}if(this._touches=y,!(L<this._minTouches)&&T.mag()){var ut=T.div(L);if(this._sum._add(ut),!(this._sum.mag()<this._clickTolerance))return{around:C.div(L),panDelta:ut}}},fs.prototype.enable=function(){this._enabled=!0},fs.prototype.disable=function(){this._enabled=!1,this.reset()},fs.prototype.isEnabled=function(){return this._enabled},fs.prototype.isActive=function(){return this._active};var mi=function(){this.reset()};function Is(l,p,c){for(var y=0;y<l.length;y++)if(l[y].identifier===c)return p[y]}function wl(l,p){return Math.log(l/p)/Math.LN2}mi.prototype.reset=function(){this._active=!1,delete this._firstTwoTouches},mi.prototype._start=function(l){},mi.prototype._move=function(l,p,c){return{}},mi.prototype.touchstart=function(l,p,c){this._firstTwoTouches||c.length<2||(this._firstTwoTouches=[c[0].identifier,c[1].identifier],this._start([p[0],p[1]]))},mi.prototype.touchmove=function(l,p,c){if(this._firstTwoTouches){l.preventDefault();var y=this._firstTwoTouches,C=y[1],T=Is(c,p,y[0]),L=Is(c,p,C);if(T&&L){var z=this._aroundCenter?null:T.add(L).div(2);return this._move([T,L],z,l)}}},mi.prototype.touchend=function(l,p,c){if(this._firstTwoTouches){var y=this._firstTwoTouches,C=y[1],T=Is(c,p,y[0]),L=Is(c,p,C);T&&L||(this._active&&ft.suppressClick(),this.reset())}},mi.prototype.touchcancel=function(){this.reset()},mi.prototype.enable=function(l){this._enabled=!0,this._aroundCenter=!!l&&"center"===l.around},mi.prototype.disable=function(){this._enabled=!1,this.reset()},mi.prototype.isEnabled=function(){return this._enabled},mi.prototype.isActive=function(){return this._active};var uu=function(l){function p(){l.apply(this,arguments)}return l&&(p.__proto__=l),(p.prototype=Object.create(l&&l.prototype)).constructor=p,p.prototype.reset=function(){l.prototype.reset.call(this),delete this._distance,delete this._startDistance},p.prototype._start=function(c){this._startDistance=this._distance=c[0].dist(c[1])},p.prototype._move=function(c,y){var C=this._distance;if(this._distance=c[0].dist(c[1]),this._active||!(Math.abs(wl(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:wl(this._distance,C),pinchAround:y}},p}(mi);function fo(l,p){return 180*l.angleWith(p)/Math.PI}var Oi=function(l){function p(){l.apply(this,arguments)}return l&&(p.__proto__=l),(p.prototype=Object.create(l&&l.prototype)).constructor=p,p.prototype.reset=function(){l.prototype.reset.call(this),delete this._minDiameter,delete this._startVector,delete this._vector},p.prototype._start=function(c){this._startVector=this._vector=c[0].sub(c[1]),this._minDiameter=c[0].dist(c[1])},p.prototype._move=function(c,y){var C=this._vector;if(this._vector=c[0].sub(c[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:fo(this._vector,C),pinchAround:y}},p.prototype._isBelowThreshold=function(c){this._minDiameter=Math.min(this._minDiameter,c.mag());var y=25/(Math.PI*this._minDiameter)*360,C=fo(c,this._startVector);return Math.abs(C)<y},p}(mi);function Fo(l){return Math.abs(l.y)>Math.abs(l.x)}var Lu=function(l){function p(){l.apply(this,arguments)}return l&&(p.__proto__=l),(p.prototype=Object.create(l&&l.prototype)).constructor=p,p.prototype.reset=function(){l.prototype.reset.call(this),this._valid=void 0,delete this._firstMove,delete this._lastPoints},p.prototype._start=function(c){this._lastPoints=c,Fo(c[0].sub(c[1]))&&(this._valid=!1)},p.prototype._move=function(c,y,C){var T=c[0].sub(this._lastPoints[0]),L=c[1].sub(this._lastPoints[1]);if(this._valid=this.gestureBeginsVertically(T,L,C.timeStamp),this._valid)return this._lastPoints=c,this._active=!0,{pitchDelta:(T.y+L.y)/2*-.5}},p.prototype.gestureBeginsVertically=function(c,y,C){if(void 0!==this._valid)return this._valid;var T=c.mag()>=2,L=y.mag()>=2;if(T||L){if(!T||!L)return void 0===this._firstMove&&(this._firstMove=C),C-this._firstMove<100&&void 0;var z=c.y>0==y.y>0;return Fo(c)&&Fo(y)&&z}},p}(mi),$o={panStep:100,bearingStep:15,pitchStep:10},as=function(){var l=$o;this._panStep=l.panStep,this._bearingStep=l.bearingStep,this._pitchStep=l.pitchStep,this._rotationDisabled=!1};function Ws(l){return l*(2-l)}as.prototype.reset=function(){this._active=!1},as.prototype.keydown=function(l){var p=this;if(!(l.altKey||l.ctrlKey||l.metaKey)){var c=0,y=0,C=0,T=0,L=0;switch(l.keyCode){case 61:case 107:case 171:case 187:c=1;break;case 189:case 109:case 173:c=-1;break;case 37:l.shiftKey?y=-1:(l.preventDefault(),T=-1);break;case 39:l.shiftKey?y=1:(l.preventDefault(),T=1);break;case 38:l.shiftKey?C=1:(l.preventDefault(),L=-1);break;case 40:l.shiftKey?C=-1:(l.preventDefault(),L=1);break;default:return}return this._rotationDisabled&&(y=0,C=0),{cameraAnimation:function(z){var Z=z.getZoom();z.easeTo({duration:300,easeId:"keyboardHandler",easing:Ws,zoom:c?Math.round(Z)+c*(l.shiftKey?2:1):Z,bearing:z.getBearing()+y*p._bearingStep,pitch:z.getPitch()+C*p._pitchStep,offset:[-T*p._panStep,-L*p._panStep],center:z.getCenter()},{originalEvent:l})}}}},as.prototype.enable=function(){this._enabled=!0},as.prototype.disable=function(){this._enabled=!1,this.reset()},as.prototype.isEnabled=function(){return this._enabled},as.prototype.isActive=function(){return this._active},as.prototype.disableRotation=function(){this._rotationDisabled=!0},as.prototype.enableRotation=function(){this._rotationDisabled=!1};var Mn=function(l,p){this._map=l,this._el=l.getCanvasContainer(),this._handler=p,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=1/450,v.bindAll(["_onTimeout"],this)};Mn.prototype.setZoomRate=function(l){this._defaultZoomRate=l},Mn.prototype.setWheelZoomRate=function(l){this._wheelZoomRate=l},Mn.prototype.isEnabled=function(){return!!this._enabled},Mn.prototype.isActive=function(){return!!this._active||void 0!==this._finishTimeout},Mn.prototype.isZooming=function(){return!!this._zooming},Mn.prototype.enable=function(l){this.isEnabled()||(this._enabled=!0,this._aroundCenter=l&&"center"===l.around)},Mn.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},Mn.prototype.wheel=function(l){if(this.isEnabled()){var p=l.deltaMode===v.window.WheelEvent.DOM_DELTA_LINE?40*l.deltaY:l.deltaY,c=v.browser.now(),y=c-(this._lastWheelEventTime||0);this._lastWheelEventTime=c,0!==p&&p%4.000244140625==0?this._type="wheel":0!==p&&Math.abs(p)<4?this._type="trackpad":y>400?(this._type=null,this._lastValue=p,this._timeout=setTimeout(this._onTimeout,40,l)):this._type||(this._type=Math.abs(y*p)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,p+=this._lastValue)),l.shiftKey&&p&&(p/=4),this._type&&(this._lastWheelEvent=l,this._delta-=p,this._active||this._start(l)),l.preventDefault()}},Mn.prototype._onTimeout=function(l){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(l)},Mn.prototype._start=function(l){if(this._delta){this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);var p=ft.mousePos(this._el,l);this._around=v.LngLat.convert(this._aroundCenter?this._map.getCenter():this._map.unproject(p)),this._aroundPoint=this._map.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}},Mn.prototype.renderFrame=function(){var l=this;if(this._frameId&&(this._frameId=null,this.isActive())){var p=this._map.transform;if(0!==this._delta){var c="wheel"===this._type&&Math.abs(this._delta)>4.000244140625?this._wheelZoomRate:this._defaultZoomRate,y=2/(1+Math.exp(-Math.abs(this._delta*c)));this._delta<0&&0!==y&&(y=1/y);var C="number"==typeof this._targetZoom?p.zoomScale(this._targetZoom):p.scale;this._targetZoom=Math.min(p.maxZoom,Math.max(p.minZoom,p.scaleZoom(C*y))),"wheel"===this._type&&(this._startZoom=p.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}var T,L="number"==typeof this._targetZoom?this._targetZoom:p.zoom,z=this._startZoom,Z=this._easing,H=!1;if("wheel"===this._type&&z&&Z){var ut=Math.min((v.browser.now()-this._lastWheelEventTime)/200,1),gt=Z(ut);T=v.number(z,L,gt),ut<1?this._frameId||(this._frameId=!0):H=!0}else T=L,H=!0;return this._active=!0,H&&(this._active=!1,this._finishTimeout=setTimeout(function(){l._zooming=!1,l._handler._triggerRenderFrame(),delete l._targetZoom,delete l._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!H,zoomDelta:T-p.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}},Mn.prototype._smoothOutEasing=function(l){var p=v.ease;if(this._prevEase){var c=this._prevEase,y=(v.browser.now()-c.start)/c.duration,C=c.easing(y+.01)-c.easing(y),T=.27/Math.sqrt(C*C+1e-4)*.01,L=Math.sqrt(.0729-T*T);p=v.bezier(T,L,.25,1)}return this._prevEase={start:v.browser.now(),duration:l,easing:p},p},Mn.prototype.reset=function(){this._active=!1};var ii=function(l,p){this._clickZoom=l,this._tapZoom=p};ii.prototype.enable=function(){this._clickZoom.enable(),this._tapZoom.enable()},ii.prototype.disable=function(){this._clickZoom.disable(),this._tapZoom.disable()},ii.prototype.isEnabled=function(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()},ii.prototype.isActive=function(){return this._clickZoom.isActive()||this._tapZoom.isActive()};var ao=function(){this.reset()};ao.prototype.reset=function(){this._active=!1},ao.prototype.dblclick=function(l,p){return l.preventDefault(),{cameraAnimation:function(c){c.easeTo({duration:300,zoom:c.getZoom()+(l.shiftKey?-1:1),around:c.unproject(p)},{originalEvent:l})}}},ao.prototype.enable=function(){this._enabled=!0},ao.prototype.disable=function(){this._enabled=!1,this.reset()},ao.prototype.isEnabled=function(){return this._enabled},ao.prototype.isActive=function(){return this._active};var ta=function(){this._tap=new Ua({numTouches:1,numTaps:1}),this.reset()};ta.prototype.reset=function(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,this._tap.reset()},ta.prototype.touchstart=function(l,p,c){this._swipePoint||(this._tapTime&&l.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?c.length>0&&(this._swipePoint=p[0],this._swipeTouch=c[0].identifier):this._tap.touchstart(l,p,c))},ta.prototype.touchmove=function(l,p,c){if(this._tapTime){if(this._swipePoint){if(c[0].identifier!==this._swipeTouch)return;var y=p[0],C=y.y-this._swipePoint.y;return this._swipePoint=y,l.preventDefault(),this._active=!0,{zoomDelta:C/128}}}else this._tap.touchmove(l,p,c)},ta.prototype.touchend=function(l,p,c){this._tapTime?this._swipePoint&&0===c.length&&this.reset():this._tap.touchend(l,p,c)&&(this._tapTime=l.timeStamp)},ta.prototype.touchcancel=function(){this.reset()},ta.prototype.enable=function(){this._enabled=!0},ta.prototype.disable=function(){this._enabled=!1,this.reset()},ta.prototype.isEnabled=function(){return this._enabled},ta.prototype.isActive=function(){return this._active};var la=function(l,p,c){this._el=l,this._mousePan=p,this._touchPan=c};la.prototype.enable=function(l){this._inertiaOptions=l||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan","mapboxgl-touch-drag-pan")},la.prototype.disable=function(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan","mapboxgl-touch-drag-pan")},la.prototype.isEnabled=function(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()},la.prototype.isActive=function(){return this._mousePan.isActive()||this._touchPan.isActive()};var Ps=function(l,p,c){this._pitchWithRotate=l.pitchWithRotate,this._mouseRotate=p,this._mousePitch=c};Ps.prototype.enable=function(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()},Ps.prototype.disable=function(){this._mouseRotate.disable(),this._mousePitch.disable()},Ps.prototype.isEnabled=function(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())},Ps.prototype.isActive=function(){return this._mouseRotate.isActive()||this._mousePitch.isActive()};var Aa=function(l,p,c,y){this._el=l,this._touchZoom=p,this._touchRotate=c,this._tapDragZoom=y,this._rotationDisabled=!1,this._enabled=!0};Aa.prototype.enable=function(l){this._touchZoom.enable(l),this._rotationDisabled||this._touchRotate.enable(l),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate","mapboxgl-touch-zoom-rotate")},Aa.prototype.disable=function(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate","mapboxgl-touch-zoom-rotate")},Aa.prototype.isEnabled=function(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()},Aa.prototype.isActive=function(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()},Aa.prototype.disableRotation=function(){this._rotationDisabled=!0,this._touchRotate.disable()},Aa.prototype.enableRotation=function(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()};var ea=function(l){return l.zoom||l.drag||l.pitch||l.rotate},ca=function(l){function p(){l.apply(this,arguments)}return l&&(p.__proto__=l),(p.prototype=Object.create(l&&l.prototype)).constructor=p,p}(v.Event);function Ms(l){return l.panDelta&&l.panDelta.mag()||l.zoomDelta||l.bearingDelta||l.pitchDelta}var yr=function(l,p){this._map=l,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Au(l),this._bearingSnap=p.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(p),v.bindAll(["handleEvent","handleWindowEvent"],this);var c=this._el;this._listeners=[[c,"touchstart",{passive:!0}],[c,"touchmove",{passive:!1}],[c,"touchend",void 0],[c,"touchcancel",void 0],[c,"mousedown",void 0],[c,"mousemove",void 0],[c,"mouseup",void 0],[v.window.document,"mousemove",{capture:!0}],[v.window.document,"mouseup",void 0],[c,"mouseover",void 0],[c,"mouseout",void 0],[c,"dblclick",void 0],[c,"click",void 0],[c,"keydown",{capture:!1}],[c,"keyup",void 0],[c,"wheel",{passive:!1}],[c,"contextmenu",void 0],[v.window,"blur",void 0]];for(var y=0,C=this._listeners;y<C.length;y+=1){var T=C[y],L=T[0];ft.addEventListener(L,T[1],L===v.window.document?this.handleWindowEvent:this.handleEvent,T[2])}};yr.prototype.destroy=function(){for(var l=0,p=this._listeners;l<p.length;l+=1){var c=p[l],y=c[0];ft.removeEventListener(y,c[1],y===v.window.document?this.handleWindowEvent:this.handleEvent,c[2])}},yr.prototype._addDefaultHandlers=function(l){var p=this._map,c=p.getCanvasContainer();this._add("mapEvent",new So(p,l));var y=p.boxZoom=new er(p,l);this._add("boxZoom",y);var C=new ji,T=new ao;p.doubleClickZoom=new ii(T,C),this._add("tapZoom",C),this._add("clickZoom",T);var L=new ta;this._add("tapDragZoom",L);var z=p.touchPitch=new Lu;this._add("touchPitch",z);var Z=new Bi(l),H=new tl(l);p.dragRotate=new Ps(l,Z,H),this._add("mouseRotate",Z,["mousePitch"]),this._add("mousePitch",H,["mouseRotate"]);var ut=new dr(l),gt=new fs(l);p.dragPan=new la(c,ut,gt),this._add("mousePan",ut),this._add("touchPan",gt,["touchZoom","touchRotate"]);var ct=new Oi,zt=new uu;p.touchZoomRotate=new Aa(c,zt,ct,L),this._add("touchRotate",ct,["touchPan","touchZoom"]),this._add("touchZoom",zt,["touchPan","touchRotate"]);var Rt=p.scrollZoom=new Mn(p,this);this._add("scrollZoom",Rt,["mousePan"]);var Yt=p.keyboard=new as;this._add("keyboard",Yt),this._add("blockableMapEvent",new Ji(p));for(var Dt=0,Vt=["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"];Dt<Vt.length;Dt+=1){var ee=Vt[Dt];l.interactive&&l[ee]&&p[ee].enable(l[ee])}},yr.prototype._add=function(l,p,c){this._handlers.push({handlerName:l,handler:p,allowed:c}),this._handlersById[l]=p},yr.prototype.stop=function(l){if(!this._updatingCamera){for(var p=0,c=this._handlers;p<c.length;p+=1)c[p].handler.reset();this._inertia.clear(),this._fireEvents({},{},l),this._changes=[]}},yr.prototype.isActive=function(){for(var l=0,p=this._handlers;l<p.length;l+=1)if(p[l].handler.isActive())return!0;return!1},yr.prototype.isZooming=function(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()},yr.prototype.isRotating=function(){return!!this._eventsInProgress.rotate},yr.prototype.isMoving=function(){return Boolean(ea(this._eventsInProgress))||this.isZooming()},yr.prototype._blockedByActive=function(l,p,c){for(var y in l)if(y!==c&&(!p||p.indexOf(y)<0))return!0;return!1},yr.prototype.handleWindowEvent=function(l){this.handleEvent(l,l.type+"Window")},yr.prototype._getMapTouches=function(l){for(var p=[],c=0,y=l;c<y.length;c+=1){var C=y[c];this._el.contains(C.target)&&p.push(C)}return p},yr.prototype.handleEvent=function(l,p){if("blur"!==l.type){this._updatingCamera=!0;for(var c="renderFrame"===l.type?void 0:l,y={needsRenderFrame:!1},C={},T={},L=l.touches?this._getMapTouches(l.touches):void 0,z=L?ft.touchPos(this._el,L):ft.mousePos(this._el,l),Z=0,H=this._handlers;Z<H.length;Z+=1){var ut=H[Z],gt=ut.handlerName,ct=ut.handler,zt=ut.allowed;if(ct.isEnabled()){var Rt=void 0;this._blockedByActive(T,zt,gt)?ct.reset():ct[p||l.type]&&(Rt=ct[p||l.type](l,z,L),this.mergeHandlerResult(y,C,Rt,gt,c),Rt&&Rt.needsRenderFrame&&this._triggerRenderFrame()),(Rt||ct.isActive())&&(T[gt]=ct)}}var Yt={};for(var Dt in this._previousActiveHandlers)T[Dt]||(Yt[Dt]=c);this._previousActiveHandlers=T,(Object.keys(Yt).length||Ms(y))&&(this._changes.push([y,C,Yt]),this._triggerRenderFrame()),(Object.keys(T).length||Ms(y))&&this._map._stop(!0),this._updatingCamera=!1;var Vt=y.cameraAnimation;Vt&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],Vt(this._map))}else this.stop(!0)},yr.prototype.mergeHandlerResult=function(l,p,c,y,C){if(c){v.extend(l,c);var T={handlerName:y,originalEvent:c.originalEvent||C};void 0!==c.zoomDelta&&(p.zoom=T),void 0!==c.panDelta&&(p.drag=T),void 0!==c.pitchDelta&&(p.pitch=T),void 0!==c.bearingDelta&&(p.rotate=T)}},yr.prototype._applyChanges=function(){for(var l={},p={},c={},y=0,C=this._changes;y<C.length;y+=1){var T=C[y],L=T[0],z=T[1],Z=T[2];L.panDelta&&(l.panDelta=(l.panDelta||new v.Point(0,0))._add(L.panDelta)),L.zoomDelta&&(l.zoomDelta=(l.zoomDelta||0)+L.zoomDelta),L.bearingDelta&&(l.bearingDelta=(l.bearingDelta||0)+L.bearingDelta),L.pitchDelta&&(l.pitchDelta=(l.pitchDelta||0)+L.pitchDelta),void 0!==L.around&&(l.around=L.around),void 0!==L.pinchAround&&(l.pinchAround=L.pinchAround),L.noInertia&&(l.noInertia=L.noInertia),v.extend(p,z),v.extend(c,Z)}this._updateMapTransform(l,p,c),this._changes=[]},yr.prototype._updateMapTransform=function(l,p,c){var y=this._map,C=y.transform;if(!Ms(l))return this._fireEvents(p,c,!0);var T=l.panDelta,L=l.zoomDelta,z=l.bearingDelta,Z=l.pitchDelta,H=l.around,ut=l.pinchAround;void 0!==ut&&(H=ut),y._stop(!0),H=H||y.transform.centerPoint;var gt=C.pointLocation(T?H.sub(T):H);z&&(C.bearing+=z),Z&&(C.pitch+=Z),L&&(C.zoom+=L),C.setLocationAtPoint(gt,H),this._map._update(),l.noInertia||this._inertia.record(l),this._fireEvents(p,c,!0)},yr.prototype._fireEvents=function(l,p,c){var y=this,C=ea(this._eventsInProgress),T=ea(l),L={};for(var z in l)this._eventsInProgress[z]||(L[z+"start"]=l[z].originalEvent),this._eventsInProgress[z]=l[z];for(var Z in!C&&T&&this._fireEvent("movestart",T.originalEvent),L)this._fireEvent(Z,L[Z]);for(var H in T&&this._fireEvent("move",T.originalEvent),l)this._fireEvent(H,l[H].originalEvent);var ut,gt={};for(var ct in this._eventsInProgress){var zt=this._eventsInProgress[ct],Rt=zt.handlerName,Yt=zt.originalEvent;this._handlersById[Rt].isActive()||(delete this._eventsInProgress[ct],gt[ct+"end"]=ut=p[Rt]||Yt)}for(var Dt in gt)this._fireEvent(Dt,gt[Dt]);var Vt=ea(this._eventsInProgress);if(c&&(C||T)&&!Vt){this._updatingCamera=!0;var ee=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),he=function(_e){return 0!==_e&&-y._bearingSnap<_e&&_e<y._bearingSnap};ee?(he(ee.bearing||this._map.getBearing())&&(ee.bearing=0),this._map.easeTo(ee,{originalEvent:ut})):(this._map.fire(new v.Event("moveend",{originalEvent:ut})),he(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}},yr.prototype._fireEvent=function(l,p){this._map.fire(new v.Event(l,p?{originalEvent:p}:{}))},yr.prototype._requestFrame=function(){var l=this;return this._map.triggerRepaint(),this._map._renderTaskQueue.add(function(p){delete l._frameId,l.handleEvent(new ca("renderFrame",{timeStamp:p})),l._applyChanges()})},yr.prototype._triggerRenderFrame=function(){void 0===this._frameId&&(this._frameId=this._requestFrame())};var jr=function(l){function p(c,y){l.call(this),this._moving=!1,this._zooming=!1,this.transform=c,this._bearingSnap=y.bearingSnap,v.bindAll(["_renderFrameCallback"],this)}return l&&(p.__proto__=l),(p.prototype=Object.create(l&&l.prototype)).constructor=p,p.prototype.getCenter=function(){return new v.LngLat(this.transform.center.lng,this.transform.center.lat)},p.prototype.setCenter=function(c,y){return this.jumpTo({center:c},y)},p.prototype.panBy=function(c,y,C){return c=v.Point.convert(c).mult(-1),this.panTo(this.transform.center,v.extend({offset:c},y),C)},p.prototype.panTo=function(c,y,C){return this.easeTo(v.extend({center:c},y),C)},p.prototype.getZoom=function(){return this.transform.zoom},p.prototype.setZoom=function(c,y){return this.jumpTo({zoom:c},y),this},p.prototype.zoomTo=function(c,y,C){return this.easeTo(v.extend({zoom:c},y),C)},p.prototype.zoomIn=function(c,y){return this.zoomTo(this.getZoom()+1,c,y),this},p.prototype.zoomOut=function(c,y){return this.zoomTo(this.getZoom()-1,c,y),this},p.prototype.getBearing=function(){return this.transform.bearing},p.prototype.setBearing=function(c,y){return this.jumpTo({bearing:c},y),this},p.prototype.getPadding=function(){return this.transform.padding},p.prototype.setPadding=function(c,y){return this.jumpTo({padding:c},y),this},p.prototype.rotateTo=function(c,y,C){return this.easeTo(v.extend({bearing:c},y),C)},p.prototype.resetNorth=function(c,y){return this.rotateTo(0,v.extend({duration:1e3},c),y),this},p.prototype.resetNorthPitch=function(c,y){return this.easeTo(v.extend({bearing:0,pitch:0,duration:1e3},c),y),this},p.prototype.snapToNorth=function(c,y){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(c,y):this},p.prototype.getPitch=function(){return this.transform.pitch},p.prototype.setPitch=function(c,y){return this.jumpTo({pitch:c},y),this},p.prototype.cameraForBounds=function(c,y){c=v.LngLatBounds.convert(c);var C=y&&y.bearing||0;return this._cameraForBoxAndBearing(c.getNorthWest(),c.getSouthEast(),C,y)},p.prototype._cameraForBoxAndBearing=function(c,y,C,T){var L={top:0,bottom:0,right:0,left:0};if("number"==typeof(T=v.extend({padding:L,offset:[0,0],maxZoom:this.transform.maxZoom},T)).padding){var z=T.padding;T.padding={top:z,bottom:z,right:z,left:z}}T.padding=v.extend(L,T.padding);var Z=this.transform,H=Z.padding,ut=Z.project(v.LngLat.convert(c)),gt=Z.project(v.LngLat.convert(y)),ct=ut.rotate(-C*Math.PI/180),zt=gt.rotate(-C*Math.PI/180),Rt=new v.Point(Math.max(ct.x,zt.x),Math.max(ct.y,zt.y)),Yt=new v.Point(Math.min(ct.x,zt.x),Math.min(ct.y,zt.y)),Dt=Rt.sub(Yt),Vt=(Z.width-(H.left+H.right+T.padding.left+T.padding.right))/Dt.x,ee=(Z.height-(H.top+H.bottom+T.padding.top+T.padding.bottom))/Dt.y;if(!(ee<0||Vt<0)){var he=Math.min(Z.scaleZoom(Z.scale*Math.min(Vt,ee)),T.maxZoom),_e="number"==typeof T.offset.x?new v.Point(T.offset.x,T.offset.y):v.Point.convert(T.offset),ve=new v.Point((T.padding.left-T.padding.right)/2,(T.padding.top-T.padding.bottom)/2).rotate(C*Math.PI/180),we=_e.add(ve).mult(Z.scale/Z.zoomScale(he));return{center:Z.unproject(ut.add(gt).div(2).sub(we)),zoom:he,bearing:C}}v.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.")},p.prototype.fitBounds=function(c,y,C){return this._fitInternal(this.cameraForBounds(c,y),y,C)},p.prototype.fitScreenCoordinates=function(c,y,C,T,L){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(v.Point.convert(c)),this.transform.pointLocation(v.Point.convert(y)),C,T),T,L)},p.prototype._fitInternal=function(c,y,C){return c?(delete(y=v.extend(c,y)).padding,y.linear?this.easeTo(y,C):this.flyTo(y,C)):this},p.prototype.jumpTo=function(c,y){this.stop();var C=this.transform,T=!1,L=!1,z=!1;return"zoom"in c&&C.zoom!==+c.zoom&&(T=!0,C.zoom=+c.zoom),void 0!==c.center&&(C.center=v.LngLat.convert(c.center)),"bearing"in c&&C.bearing!==+c.bearing&&(L=!0,C.bearing=+c.bearing),"pitch"in c&&C.pitch!==+c.pitch&&(z=!0,C.pitch=+c.pitch),null==c.padding||C.isPaddingEqual(c.padding)||(C.padding=c.padding),this.fire(new v.Event("movestart",y)).fire(new v.Event("move",y)),T&&this.fire(new v.Event("zoomstart",y)).fire(new v.Event("zoom",y)).fire(new v.Event("zoomend",y)),L&&this.fire(new v.Event("rotatestart",y)).fire(new v.Event("rotate",y)).fire(new v.Event("rotateend",y)),z&&this.fire(new v.Event("pitchstart",y)).fire(new v.Event("pitch",y)).fire(new v.Event("pitchend",y)),this.fire(new v.Event("moveend",y))},p.prototype.easeTo=function(c,y){var C=this;this._stop(!1,c.easeId),(!1===(c=v.extend({offset:[0,0],duration:500,easing:v.ease},c)).animate||!c.essential&&v.browser.prefersReducedMotion)&&(c.duration=0);var T=this.transform,L=this.getZoom(),z=this.getBearing(),Z=this.getPitch(),H=this.getPadding(),ut="zoom"in c?+c.zoom:L,gt="bearing"in c?this._normalizeBearing(c.bearing,z):z,ct="pitch"in c?+c.pitch:Z,zt="padding"in c?c.padding:T.padding,Rt=v.Point.convert(c.offset),Yt=T.centerPoint.add(Rt),Dt=T.pointLocation(Yt),Vt=v.LngLat.convert(c.center||Dt);this._normalizeCenter(Vt);var ee,he,_e=T.project(Dt),ve=T.project(Vt).sub(_e),we=T.zoomScale(ut-L);c.around&&(ee=v.LngLat.convert(c.around),he=T.locationPoint(ee));var Ne={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||ut!==L,this._rotating=this._rotating||z!==gt,this._pitching=this._pitching||ct!==Z,this._padding=!T.isPaddingEqual(zt),this._easeId=c.easeId,this._prepareEase(y,c.noMoveStart,Ne),this._ease(function(qe){if(C._zooming&&(T.zoom=v.number(L,ut,qe)),C._rotating&&(T.bearing=v.number(z,gt,qe)),C._pitching&&(T.pitch=v.number(Z,ct,qe)),C._padding&&(T.interpolatePadding(H,zt,qe),Yt=T.centerPoint.add(Rt)),ee)T.setLocationAtPoint(ee,he);else{var ze=T.zoomScale(T.zoom-L),Ve=ut>L?Math.min(2,we):Math.max(.5,we),$e=Math.pow(Ve,1-qe),rr=T.unproject(_e.add(ve.mult(qe*$e)).mult(ze));T.setLocationAtPoint(T.renderWorldCopies?rr.wrap():rr,Yt)}C._fireMoveEvents(y)},function(qe){C._afterEase(y,qe)},c),this},p.prototype._prepareEase=function(c,y,C){void 0===C&&(C={}),this._moving=!0,y||C.moving||this.fire(new v.Event("movestart",c)),this._zooming&&!C.zooming&&this.fire(new v.Event("zoomstart",c)),this._rotating&&!C.rotating&&this.fire(new v.Event("rotatestart",c)),this._pitching&&!C.pitching&&this.fire(new v.Event("pitchstart",c))},p.prototype._fireMoveEvents=function(c){this.fire(new v.Event("move",c)),this._zooming&&this.fire(new v.Event("zoom",c)),this._rotating&&this.fire(new v.Event("rotate",c)),this._pitching&&this.fire(new v.Event("pitch",c))},p.prototype._afterEase=function(c,y){if(!this._easeId||!y||this._easeId!==y){delete this._easeId;var C=this._zooming,T=this._rotating,L=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,C&&this.fire(new v.Event("zoomend",c)),T&&this.fire(new v.Event("rotateend",c)),L&&this.fire(new v.Event("pitchend",c)),this.fire(new v.Event("moveend",c))}},p.prototype.flyTo=function(c,y){var C=this;if(!c.essential&&v.browser.prefersReducedMotion){var T=v.pick(c,["center","zoom","bearing","pitch","around"]);return this.jumpTo(T,y)}this.stop(),c=v.extend({offset:[0,0],speed:1.2,curve:1.42,easing:v.ease},c);var L=this.transform,z=this.getZoom(),Z=this.getBearing(),H=this.getPitch(),ut=this.getPadding(),gt="zoom"in c?v.clamp(+c.zoom,L.minZoom,L.maxZoom):z,ct="bearing"in c?this._normalizeBearing(c.bearing,Z):Z,zt="pitch"in c?+c.pitch:H,Rt="padding"in c?c.padding:L.padding,Yt=L.zoomScale(gt-z),Dt=v.Point.convert(c.offset),Vt=L.centerPoint.add(Dt),ee=L.pointLocation(Vt),he=v.LngLat.convert(c.center||ee);this._normalizeCenter(he);var _e=L.project(ee),ve=L.project(he).sub(_e),we=c.curve,Ne=Math.max(L.width,L.height),qe=Ne/Yt,ze=ve.mag();if("minZoom"in c){var Ve=v.clamp(Math.min(c.minZoom,z,gt),L.minZoom,L.maxZoom),$e=Ne/L.zoomScale(Ve-z);we=Math.sqrt($e/ze*2)}var rr=we*we;function tr(hr){var or=(qe*qe-Ne*Ne+(hr?-1:1)*rr*rr*ze*ze)/(2*(hr?qe:Ne)*rr*ze);return Math.log(Math.sqrt(or*or+1)-or)}function Dr(hr){return(Math.exp(hr)-Math.exp(-hr))/2}function Xe(hr){return(Math.exp(hr)+Math.exp(-hr))/2}var vr=tr(0),Pr=function(hr){return Xe(vr)/Xe(vr+we*hr)},_r=function(hr){return Ne*((Xe(vr)*(Dr(or=vr+we*hr)/Xe(or))-Dr(vr))/rr)/ze;var or},mr=(tr(1)-vr)/we;if(Math.abs(ze)<1e-6||!isFinite(mr)){if(Math.abs(Ne-qe)<1e-6)return this.easeTo(c,y);var fr=qe<Ne?-1:1;mr=Math.abs(Math.log(qe/Ne))/we,_r=function(){return 0},Pr=function(hr){return Math.exp(fr*we*hr)}}return c.duration="duration"in c?+c.duration:1e3*mr/("screenSpeed"in c?+c.screenSpeed/we:+c.speed),c.maxDuration&&c.duration>c.maxDuration&&(c.duration=0),this._zooming=!0,this._rotating=Z!==ct,this._pitching=zt!==H,this._padding=!L.isPaddingEqual(Rt),this._prepareEase(y,!1),this._ease(function(hr){var or=hr*mr,qr=1/Pr(or);L.zoom=1===hr?gt:z+L.scaleZoom(qr),C._rotating&&(L.bearing=v.number(Z,ct,hr)),C._pitching&&(L.pitch=v.number(H,zt,hr)),C._padding&&(L.interpolatePadding(ut,Rt,hr),Vt=L.centerPoint.add(Dt));var Kr=1===hr?he:L.unproject(_e.add(ve.mult(_r(or))).mult(qr));L.setLocationAtPoint(L.renderWorldCopies?Kr.wrap():Kr,Vt),C._fireMoveEvents(y)},function(){return C._afterEase(y)},c),this},p.prototype.isEasing=function(){return!!this._easeFrameId},p.prototype.stop=function(){return this._stop()},p.prototype._stop=function(c,y){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){var C=this._onEaseEnd;delete this._onEaseEnd,C.call(this,y)}if(!c){var T=this.handlers;T&&T.stop(!1)}return this},p.prototype._ease=function(c,y,C){!1===C.animate||0===C.duration?(c(1),y()):(this._easeStart=v.browser.now(),this._easeOptions=C,this._onEaseFrame=c,this._onEaseEnd=y,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))},p.prototype._renderFrameCallback=function(){var c=Math.min((v.browser.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(c)),c<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},p.prototype._normalizeBearing=function(c,y){c=v.wrap(c,-180,180);var C=Math.abs(c-y);return Math.abs(c-360-y)<C&&(c-=360),Math.abs(c+360-y)<C&&(c+=360),c},p.prototype._normalizeCenter=function(c){var y=this.transform;if(y.renderWorldCopies&&!y.lngRange){var C=c.lng-y.center.lng;c.lng+=C>180?-360:C<-180?360:0}},p}(v.Evented),Ki=function(l){void 0===l&&(l={}),this.options=l,v.bindAll(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)};Ki.prototype.getDefaultPosition=function(){return"bottom-right"},Ki.prototype.onAdd=function(l){var p=this.options&&this.options.compact;return this._map=l,this._container=ft.create("div","maplibregl-ctrl maplibregl-ctrl-attrib mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=ft.create("button","maplibregl-ctrl-attrib-button mapboxgl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._compactButton.type="button",this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=ft.create("div","maplibregl-ctrl-attrib-inner mapboxgl-ctrl-attrib-inner",this._container),this._innerContainer.setAttribute("role","list"),p&&this._container.classList.add("maplibregl-compact","mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),void 0===p&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container},Ki.prototype.onRemove=function(){ft.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0},Ki.prototype._setElementTitle=function(l,p){var c=this._map._getUIString("AttributionControl."+p);l.title=c,l.setAttribute("aria-label",c)},Ki.prototype._toggleAttribution=function(){this._container.classList.contains("maplibregl-compact-show")||this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("maplibregl-compact-show","mapboxgl-compact-show"),this._compactButton.setAttribute("aria-pressed","false")):(this._container.classList.add("maplibregl-compact-show","mapboxgl-compact-show"),this._compactButton.setAttribute("aria-pressed","true"))},Ki.prototype._updateEditLink=function(){var l=this._editLink;l||(l=this._editLink=this._container.querySelector(".mapbox-improve-map"));var p=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||v.config.ACCESS_TOKEN}];if(l){var c=p.reduce(function(y,C,T){return C.value&&(y+=C.key+"="+C.value+(T<p.length-1?"&":"")),y},"?");l.href=v.config.FEEDBACK_URL+"/"+c+(this._map._hash?this._map._hash.getHashString(!0):""),l.rel="noopener nofollow",this._setElementTitle(l,"MapFeedback")}},Ki.prototype._updateData=function(l){!l||"metadata"!==l.sourceDataType&&"visibility"!==l.sourceDataType&&"style"!==l.dataType||(this._updateAttributions(),this._updateEditLink())},Ki.prototype._updateAttributions=function(){if(this._map.style){var l=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?l=l.concat(this.options.customAttribution.map(function(z){return"string"!=typeof z?"":z})):"string"==typeof this.options.customAttribution&&l.push(this.options.customAttribution)),this._map.style.stylesheet){var p=this._map.style.stylesheet;this.styleOwner=p.owner,this.styleId=p.id}var c=this._map.style.sourceCaches;for(var y in c){var C=c[y];if(C.used){var T=C.getSource();T.attribution&&l.indexOf(T.attribution)<0&&l.push(T.attribution)}}l.sort(function(z,Z){return z.length-Z.length});var L=(l=l.filter(function(z,Z){for(var H=Z+1;H<l.length;H++)if(l[H].indexOf(z)>=0)return!1;return!0})).join(" | ");L!==this._attribHTML&&(this._attribHTML=L,l.length?(this._innerContainer.innerHTML=L,this._container.classList.remove("maplibregl-attrib-empty","mapboxgl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty","mapboxgl-attrib-empty"),this._editLink=null)}},Ki.prototype._updateCompact=function(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("maplibregl-compact","mapboxgl-compact"):this._container.classList.remove("maplibregl-compact","maplibregl-compact-show","mapboxgl-compact","mapboxgl-compact-show")};var ha=function(){v.bindAll(["_updateLogo"],this),v.bindAll(["_updateCompact"],this)};ha.prototype.onAdd=function(l){this._map=l,this._container=ft.create("div","maplibregl-ctrl mapboxgl-ctrl");var p=ft.create("a","maplibregl-ctrl-logo mapboxgl-ctrl-logo");return p.target="_blank",p.rel="noopener nofollow",p.href="https://maplibre.org/",p.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),p.setAttribute("rel","noopener nofollow"),this._container.appendChild(p),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container},ha.prototype.onRemove=function(){ft.remove(this._container),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)},ha.prototype.getDefaultPosition=function(){return"bottom-left"},ha.prototype._updateLogo=function(l){l&&"metadata"!==l.sourceDataType||(this._container.style.display=this._logoRequired()?"block":"none")},ha.prototype._logoRequired=function(){if(this._map.style){var l=this._map.style.sourceCaches;for(var p in l)if(l[p].getSource().mapbox_logo)return!0;return!1}},ha.prototype._updateCompact=function(){var l=this._container.children;if(l.length){var p=l[0];this._map.getCanvasContainer().offsetWidth<250?p.classList.add("maplibregl-compact","mapboxgl-compact"):p.classList.remove("maplibregl-compact","mapboxgl-compact")}};var xa=function(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1};xa.prototype.add=function(l){var p=++this._id;return this._queue.push({callback:l,id:p,cancelled:!1}),p},xa.prototype.remove=function(l){for(var p=this._currentlyRunning,c=0,y=p?this._queue.concat(p):this._queue;c<y.length;c+=1){var C=y[c];if(C.id===l)return void(C.cancelled=!0)}},xa.prototype.run=function(l){void 0===l&&(l=0);var p=this._currentlyRunning=this._queue;this._queue=[];for(var c=0,y=p;c<y.length;c+=1){var C=y[c];if(!C.cancelled&&(C.callback(l),this._cleared))break}this._cleared=!1,this._currentlyRunning=!1},xa.prototype.clear=function(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]};var so={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm"},Wr=v.window.HTMLImageElement,lu=v.window.HTMLElement,ss=v.window.ImageBitmap,Jn={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",transformRequest:null,accessToken:null,fadeDuration:300,crossSourceCollisions:!0},oi=function(l){function p(y){var C=this;if(null!=(y=v.extend({},Jn,y)).minZoom&&null!=y.maxZoom&&y.minZoom>y.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(null!=y.minPitch&&null!=y.maxPitch&&y.minPitch>y.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(null!=y.minPitch&&y.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(null!=y.maxPitch&&y.maxPitch>60)throw new Error("maxPitch must be less than or equal to 60");var T=new _n(y.minZoom,y.maxZoom,y.minPitch,y.maxPitch,y.renderWorldCopies);if(l.call(this,T,y),this._interactive=y.interactive,this._maxTileCacheSize=y.maxTileCacheSize,this._failIfMajorPerformanceCaveat=y.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=y.preserveDrawingBuffer,this._antialias=y.antialias,this._trackResize=y.trackResize,this._bearingSnap=y.bearingSnap,this._refreshExpiredTiles=y.refreshExpiredTiles,this._fadeDuration=y.fadeDuration,this._crossSourceCollisions=y.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=y.collectResourceTiming,this._renderTaskQueue=new xa,this._controls=[],this._mapId=v.uniqueId(),this._locale=v.extend({},so,y.locale),this._clickTolerance=y.clickTolerance,this._requestManager=new v.RequestManager(y.transformRequest,y.accessToken),"string"==typeof y.container){if(this._container=v.window.document.getElementById(y.container),!this._container)throw new Error("Container '"+y.container+"' not found.")}else{if(!(y.container instanceof lu))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=y.container}if(y.maxBounds&&this.setMaxBounds(y.maxBounds),v.bindAll(["_onWindowOnline","_onWindowResize","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),void 0===this.painter)throw new Error("Failed to initialize WebGL.");this.on("move",function(){return C._update(!1)}),this.on("moveend",function(){return C._update(!1)}),this.on("zoom",function(){return C._update(!0)}),void 0!==v.window&&(v.window.addEventListener("online",this._onWindowOnline,!1),v.window.addEventListener("resize",this._onWindowResize,!1),v.window.addEventListener("orientationchange",this._onWindowResize,!1)),this.handlers=new yr(this,y),this._hash=y.hash&&new sa("string"==typeof y.hash&&y.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:y.center,zoom:y.zoom,bearing:y.bearing,pitch:y.pitch}),y.bounds&&(this.resize(),this.fitBounds(y.bounds,v.extend({},y.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=y.localIdeographFontFamily,y.style&&this.setStyle(y.style,{localIdeographFontFamily:y.localIdeographFontFamily}),y.attributionControl&&this.addControl(new Ki({customAttribution:y.customAttribution})),this.addControl(new ha,y.logoPosition),this.on("style.load",function(){C.transform.unmodified&&C.jumpTo(C.style.stylesheet)}),this.on("data",function(L){C._update("style"===L.dataType),C.fire(new v.Event(L.dataType+"data",L))}),this.on("dataloading",function(L){C.fire(new v.Event(L.dataType+"dataloading",L))})}l&&(p.__proto__=l),(p.prototype=Object.create(l&&l.prototype)).constructor=p;var c={showTileBoundaries:{configurable:!0},showPadding:{configurable:!0},showCollisionBoxes:{configurable:!0},showOverdrawInspector:{configurable:!0},repaint:{configurable:!0},vertices:{configurable:!0},version:{configurable:!0}};return p.prototype._getMapId=function(){return this._mapId},p.prototype.addControl=function(y,C){if(void 0===C&&(C=y.getDefaultPosition?y.getDefaultPosition():"top-right"),!y||!y.onAdd)return this.fire(new v.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));var T=y.onAdd(this);this._controls.push(y);var L=this._controlPositions[C];return-1!==C.indexOf("bottom")?L.insertBefore(T,L.firstChild):L.appendChild(T),this},p.prototype.removeControl=function(y){if(!y||!y.onRemove)return this.fire(new v.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));var C=this._controls.indexOf(y);return C>-1&&this._controls.splice(C,1),y.onRemove(this),this},p.prototype.hasControl=function(y){return this._controls.indexOf(y)>-1},p.prototype.resize=function(y){var C=this._containerDimensions(),T=C[0],L=C[1];this._resizeCanvas(T,L),this.transform.resize(T,L),this.painter.resize(T,L);var z=!this._moving;return z&&(this.stop(),this.fire(new v.Event("movestart",y)).fire(new v.Event("move",y))),this.fire(new v.Event("resize",y)),z&&this.fire(new v.Event("moveend",y)),this},p.prototype.getBounds=function(){return this.transform.getBounds()},p.prototype.getMaxBounds=function(){return this.transform.getMaxBounds()},p.prototype.setMaxBounds=function(y){return this.transform.setMaxBounds(v.LngLatBounds.convert(y)),this._update()},p.prototype.setMinZoom=function(y){if((y=null==y?-2:y)>=-2&&y<=this.transform.maxZoom)return this.transform.minZoom=y,this._update(),this.getZoom()<y&&this.setZoom(y),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")},p.prototype.getMinZoom=function(){return this.transform.minZoom},p.prototype.setMaxZoom=function(y){if((y=null==y?22:y)>=this.transform.minZoom)return this.transform.maxZoom=y,this._update(),this.getZoom()>y&&this.setZoom(y),this;throw new Error("maxZoom must be greater than the current minZoom")},p.prototype.getMaxZoom=function(){return this.transform.maxZoom},p.prototype.setMinPitch=function(y){if((y=null==y?0:y)<0)throw new Error("minPitch must be greater than or equal to 0");if(y>=0&&y<=this.transform.maxPitch)return this.transform.minPitch=y,this._update(),this.getPitch()<y&&this.setPitch(y),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")},p.prototype.getMinPitch=function(){return this.transform.minPitch},p.prototype.setMaxPitch=function(y){if((y=null==y?60:y)>60)throw new Error("maxPitch must be less than or equal to 60");if(y>=this.transform.minPitch)return this.transform.maxPitch=y,this._update(),this.getPitch()>y&&this.setPitch(y),this;throw new Error("maxPitch must be greater than the current minPitch")},p.prototype.getMaxPitch=function(){return this.transform.maxPitch},p.prototype.getRenderWorldCopies=function(){return this.transform.renderWorldCopies},p.prototype.setRenderWorldCopies=function(y){return this.transform.renderWorldCopies=y,this._update()},p.prototype.project=function(y){return this.transform.locationPoint(v.LngLat.convert(y))},p.prototype.unproject=function(y){return this.transform.pointLocation(v.Point.convert(y))},p.prototype.isMoving=function(){return this._moving||this.handlers.isMoving()},p.prototype.isZooming=function(){return this._zooming||this.handlers.isZooming()},p.prototype.isRotating=function(){return this._rotating||this.handlers.isRotating()},p.prototype._createDelegatedListener=function(y,C,T){var L,z=this;if("mouseenter"===y||"mouseover"===y){var Z=!1;return{layer:C,listener:T,delegates:{mousemove:function(ut){var gt=z.getLayer(C)?z.queryRenderedFeatures(ut.point,{layers:[C]}):[];gt.length?Z||(Z=!0,T.call(z,new _i(y,z,ut.originalEvent,{features:gt}))):Z=!1},mouseout:function(){Z=!1}}}}if("mouseleave"===y||"mouseout"===y){var H=!1;return{layer:C,listener:T,delegates:{mousemove:function(ut){(z.getLayer(C)?z.queryRenderedFeatures(ut.point,{layers:[C]}):[]).length?H=!0:H&&(H=!1,T.call(z,new _i(y,z,ut.originalEvent)))},mouseout:function(ut){H&&(H=!1,T.call(z,new _i(y,z,ut.originalEvent)))}}}}return{layer:C,listener:T,delegates:(L={},L[y]=function(ut){var gt=z.getLayer(C)?z.queryRenderedFeatures(ut.point,{layers:[C]}):[];gt.length&&(ut.features=gt,T.call(z,ut),delete ut.features)},L)}},p.prototype.on=function(y,C,T){if(void 0===T)return l.prototype.on.call(this,y,C);var L=this._createDelegatedListener(y,C,T);for(var z in this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[y]=this._delegatedListeners[y]||[],this._delegatedListeners[y].push(L),L.delegates)this.on(z,L.delegates[z]);return this},p.prototype.once=function(y,C,T){if(void 0===T)return l.prototype.once.call(this,y,C);var L=this._createDelegatedListener(y,C,T);for(var z in L.delegates)this.once(z,L.delegates[z]);return this},p.prototype.off=function(y,C,T){var L=this;return void 0===T?l.prototype.off.call(this,y,C):(this._delegatedListeners&&this._delegatedListeners[y]&&function(z){for(var Z=z[y],H=0;H<Z.length;H++){var ut=Z[H];if(ut.layer===C&&ut.listener===T){for(var gt in ut.delegates)L.off(gt,ut.delegates[gt]);return Z.splice(H,1),L}}}(this._delegatedListeners),this)},p.prototype.queryRenderedFeatures=function(y,C){if(!this.style)return[];var T;if(void 0!==C||void 0===y||y instanceof v.Point||Array.isArray(y)||(C=y,y=void 0),C=C||{},(y=y||[[0,0],[this.transform.width,this.transform.height]])instanceof v.Point||"number"==typeof y[0])T=[v.Point.convert(y)];else{var L=v.Point.convert(y[0]),z=v.Point.convert(y[1]);T=[L,new v.Point(z.x,L.y),z,new v.Point(L.x,z.y),L]}return this.style.queryRenderedFeatures(T,C,this.transform)},p.prototype.querySourceFeatures=function(y,C){return this.style.querySourceFeatures(y,C)},p.prototype.setStyle=function(y,C){return!1!==(C=v.extend({},{localIdeographFontFamily:this._localIdeographFontFamily},C)).diff&&C.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&y?(this._diffStyle(y,C),this):(this._localIdeographFontFamily=C.localIdeographFontFamily,this._updateStyle(y,C))},p.prototype.setTransformRequest=function(y){return this._requestManager.setTransformRequest(y),this},p.prototype._getUIString=function(y){var C=this._locale[y];if(null==C)throw new Error("Missing UI string '"+y+"'");return C},p.prototype._updateStyle=function(y,C){return this.style&&(this.style.setEventedParent(null),this.style._remove()),y?(this.style=new Ka(this,C||{}),this.style.setEventedParent(this,{style:this.style}),"string"==typeof y?this.style.loadURL(y):this.style.loadJSON(y),this):(delete this.style,this)},p.prototype._lazyInitEmptyStyle=function(){this.style||(this.style=new Ka(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())},p.prototype._diffStyle=function(y,C){var T=this;if("string"==typeof y){var L=this._requestManager.normalizeStyleURL(y),z=this._requestManager.transformRequest(L,v.ResourceType.Style);v.getJSON(z,function(Z,H){Z?T.fire(new v.ErrorEvent(Z)):H&&T._updateDiff(H,C)})}else"object"==typeof y&&this._updateDiff(y,C)},p.prototype._updateDiff=function(y,C){try{this.style.setState(y)&&this._update(!0)}catch(T){v.warnOnce("Unable to perform style diff: "+(T.message||T.error||T)+".  Rebuilding the style from scratch."),this._updateStyle(y,C)}},p.prototype.getStyle=function(){if(this.style)return this.style.serialize()},p.prototype.isStyleLoaded=function(){return this.style?this.style.loaded():v.warnOnce("There is no style added to the map.")},p.prototype.addSource=function(y,C){return this._lazyInitEmptyStyle(),this.style.addSource(y,C),this._update(!0)},p.prototype.isSourceLoaded=function(y){var C=this.style&&this.style.sourceCaches[y];if(void 0!==C)return C.loaded();this.fire(new v.ErrorEvent(new Error("There is no source with ID '"+y+"'")))},p.prototype.areTilesLoaded=function(){var y=this.style&&this.style.sourceCaches;for(var C in y){var T=y[C]._tiles;for(var L in T){var z=T[L];if("loaded"!==z.state&&"errored"!==z.state)return!1}}return!0},p.prototype.addSourceType=function(y,C,T){return this._lazyInitEmptyStyle(),this.style.addSourceType(y,C,T)},p.prototype.removeSource=function(y){return this.style.removeSource(y),this._update(!0)},p.prototype.getSource=function(y){return this.style.getSource(y)},p.prototype.addImage=function(y,C,T){void 0===T&&(T={});var L=T.pixelRatio;void 0===L&&(L=1);var z=T.sdf;void 0===z&&(z=!1);var Z=T.stretchX,H=T.stretchY,ut=T.content;if(this._lazyInitEmptyStyle(),C instanceof Wr||ss&&C instanceof ss){var gt=v.browser.getImageData(C);this.style.addImage(y,{data:new v.RGBAImage({width:gt.width,height:gt.height},gt.data),pixelRatio:L,stretchX:Z,stretchY:H,content:ut,sdf:z,version:0})}else{if(void 0===C.width||void 0===C.height)return this.fire(new v.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));var ct=C;this.style.addImage(y,{data:new v.RGBAImage({width:C.width,height:C.height},new Uint8Array(C.data)),pixelRatio:L,stretchX:Z,stretchY:H,content:ut,sdf:z,version:0,userImage:ct}),ct.onAdd&&ct.onAdd(this,y)}},p.prototype.updateImage=function(y,C){var T=this.style.getImage(y);if(!T)return this.fire(new v.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));var L=C instanceof Wr||ss&&C instanceof ss?v.browser.getImageData(C):C,z=L.width,Z=L.height,H=L.data;return void 0===z||void 0===Z?this.fire(new v.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`"))):z!==T.data.width||Z!==T.data.height?this.fire(new v.ErrorEvent(new Error("The width and height of the updated image must be that same as the previous version of the image"))):(T.data.replace(H,!(C instanceof Wr||ss&&C instanceof ss)),void this.style.updateImage(y,T))},p.prototype.hasImage=function(y){return y?!!this.style.getImage(y):(this.fire(new v.ErrorEvent(new Error("Missing required image id"))),!1)},p.prototype.removeImage=function(y){this.style.removeImage(y)},p.prototype.loadImage=function(y,C){v.getImage(this._requestManager.transformRequest(y,v.ResourceType.Image),C)},p.prototype.listImages=function(){return this.style.listImages()},p.prototype.addLayer=function(y,C){return this._lazyInitEmptyStyle(),this.style.addLayer(y,C),this._update(!0)},p.prototype.moveLayer=function(y,C){return this.style.moveLayer(y,C),this._update(!0)},p.prototype.removeLayer=function(y){return this.style.removeLayer(y),this._update(!0)},p.prototype.getLayer=function(y){return this.style.getLayer(y)},p.prototype.setLayerZoomRange=function(y,C,T){return this.style.setLayerZoomRange(y,C,T),this._update(!0)},p.prototype.setFilter=function(y,C,T){return void 0===T&&(T={}),this.style.setFilter(y,C,T),this._update(!0)},p.prototype.getFilter=function(y){return this.style.getFilter(y)},p.prototype.setPaintProperty=function(y,C,T,L){return void 0===L&&(L={}),this.style.setPaintProperty(y,C,T,L),this._update(!0)},p.prototype.getPaintProperty=function(y,C){return this.style.getPaintProperty(y,C)},p.prototype.setLayoutProperty=function(y,C,T,L){return void 0===L&&(L={}),this.style.setLayoutProperty(y,C,T,L),this._update(!0)},p.prototype.getLayoutProperty=function(y,C){return this.style.getLayoutProperty(y,C)},p.prototype.setLight=function(y,C){return void 0===C&&(C={}),this._lazyInitEmptyStyle(),this.style.setLight(y,C),this._update(!0)},p.prototype.getLight=function(){return this.style.getLight()},p.prototype.setFeatureState=function(y,C){return this.style.setFeatureState(y,C),this._update()},p.prototype.removeFeatureState=function(y,C){return this.style.removeFeatureState(y,C),this._update()},p.prototype.getFeatureState=function(y){return this.style.getFeatureState(y)},p.prototype.getContainer=function(){return this._container},p.prototype.getCanvasContainer=function(){return this._canvasContainer},p.prototype.getCanvas=function(){return this._canvas},p.prototype._containerDimensions=function(){var y=0,C=0;return this._container&&(y=this._container.clientWidth||400,C=this._container.clientHeight||300),[y,C]},p.prototype._setupContainer=function(){var y=this._container;y.classList.add("maplibregl-map","mapboxgl-map");var C=this._canvasContainer=ft.create("div","maplibregl-canvas-container mapboxgl-canvas-container",y);this._interactive&&C.classList.add("maplibregl-interactive","mapboxgl-interactive"),this._canvas=ft.create("canvas","maplibregl-canvas mapboxgl-canvas",C),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map"),this._canvas.setAttribute("role","region");var T=this._containerDimensions();this._resizeCanvas(T[0],T[1]);var L=this._controlContainer=ft.create("div","maplibregl-control-container mapboxgl-control-container",y),z=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(function(Z){z[Z]=ft.create("div","maplibregl-ctrl-"+Z+" mapboxgl-ctrl-"+Z,L)}),this._container.addEventListener("scroll",this._onMapScroll,!1)},p.prototype._resizeCanvas=function(y,C){var T=v.browser.devicePixelRatio||1;this._canvas.width=T*y,this._canvas.height=T*C,this._canvas.style.width=y+"px",this._canvas.style.height=C+"px"},p.prototype._setupPainter=function(){var y=v.extend({},Bt.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),C=this._canvas.getContext("webgl",y)||this._canvas.getContext("experimental-webgl",y);C?(this.painter=new Yn(C,this.transform),v.webpSupported.testSupport(C)):this.fire(new v.ErrorEvent(new Error("Failed to initialize WebGL")))},p.prototype._contextLost=function(y){y.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new v.Event("webglcontextlost",{originalEvent:y}))},p.prototype._contextRestored=function(y){this._setupPainter(),this.resize(),this._update(),this.fire(new v.Event("webglcontextrestored",{originalEvent:y}))},p.prototype._onMapScroll=function(y){if(y.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},p.prototype.loaded=function(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()},p.prototype._update=function(y){return this.style?(this._styleDirty=this._styleDirty||y,this._sourcesDirty=!0,this.triggerRepaint(),this):this},p.prototype._requestRenderFrame=function(y){return this._update(),this._renderTaskQueue.add(y)},p.prototype._cancelRenderFrame=function(y){this._renderTaskQueue.remove(y)},p.prototype._render=function(y){var C,T=this,L=0,z=this.painter.context.extTimerQuery;if(this.listens("gpu-timing-frame")&&(C=z.createQueryEXT(),z.beginQueryEXT(z.TIME_ELAPSED_EXT,C),L=v.browser.now()),this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(y),!this._removed){var Z=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;var H=this.transform.zoom,ut=v.browser.now();this.style.zoomHistory.update(H,ut);var gt=new v.EvaluationParameters(H,{now:ut,fadeDuration:this._fadeDuration,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),ct=gt.crossFadingFactor();1===ct&&ct===this._crossFadingFactor||(Z=!0,this._crossFadingFactor=ct),this.style.update(gt)}if(this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,this._fadeDuration,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:this._fadeDuration,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer")}),this.fire(new v.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new v.Event("load"))),this.style&&(this.style.hasTransitions()||Z)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),this.listens("gpu-timing-frame")){var zt=v.browser.now()-L;z.endQueryEXT(z.TIME_ELAPSED_EXT,C),setTimeout(function(){var Dt=z.getQueryObjectEXT(C,z.QUERY_RESULT_EXT)/1e6;z.deleteQueryEXT(C),T.fire(new v.Event("gpu-timing-frame",{cpuTime:zt,gpuTime:Dt}))},50)}if(this.listens("gpu-timing-layer")){var Rt=this.painter.collectGpuTimers();setTimeout(function(){var Dt=T.painter.queryGpuTimers(Rt);T.fire(new v.Event("gpu-timing-layer",{layerTimes:Dt}))},50)}var Yt=this._sourcesDirty||this._styleDirty||this._placementDirty;return Yt||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new v.Event("idle")),!this._loaded||this._fullyLoaded||Yt||(this._fullyLoaded=!0),this}},p.prototype.remove=function(){this._hash&&this._hash.remove();for(var y=0,C=this._controls;y<C.length;y+=1)C[y].onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),void 0!==v.window&&(v.window.removeEventListener("resize",this._onWindowResize,!1),v.window.removeEventListener("orientationchange",this._onWindowResize,!1),v.window.removeEventListener("online",this._onWindowOnline,!1));var T=this.painter.context.gl.getExtension("WEBGL_lose_context");T&&T.loseContext(),Zu(this._canvasContainer),Zu(this._controlContainer),this._container.classList.remove("maplibregl-map","mapboxgl-map"),this._removed=!0,this.fire(new v.Event("remove"))},p.prototype.triggerRepaint=function(){var y=this;this.style&&!this._frame&&(this._frame=v.browser.frame(function(C){y._frame=null,y._render(C)}))},p.prototype._onWindowOnline=function(){this._update()},p.prototype._onWindowResize=function(y){this._trackResize&&this.resize({originalEvent:y})._update()},c.showTileBoundaries.get=function(){return!!this._showTileBoundaries},c.showTileBoundaries.set=function(y){this._showTileBoundaries!==y&&(this._showTileBoundaries=y,this._update())},c.showPadding.get=function(){return!!this._showPadding},c.showPadding.set=function(y){this._showPadding!==y&&(this._showPadding=y,this._update())},c.showCollisionBoxes.get=function(){return!!this._showCollisionBoxes},c.showCollisionBoxes.set=function(y){this._showCollisionBoxes!==y&&(this._showCollisionBoxes=y,y?this.style._generateCollisionBoxes():this._update())},c.showOverdrawInspector.get=function(){return!!this._showOverdrawInspector},c.showOverdrawInspector.set=function(y){this._showOverdrawInspector!==y&&(this._showOverdrawInspector=y,this._update())},c.repaint.get=function(){return!!this._repaint},c.repaint.set=function(y){this._repaint!==y&&(this._repaint=y,this.triggerRepaint())},c.vertices.get=function(){return!!this._vertices},c.vertices.set=function(y){this._vertices=y,this._update()},p.prototype._setCacheLimits=function(y,C){v.setCacheLimits(y,C)},c.version.get=function(){return v.version},Object.defineProperties(p.prototype,c),p}(jr);function Zu(l){l.parentNode&&l.parentNode.removeChild(l)}var Io={showCompass:!0,showZoom:!0,visualizePitch:!1},bi=function(l){var p=this;this.options=v.extend({},Io,l),this._container=ft.create("div","maplibregl-ctrl maplibregl-ctrl-group mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",function(c){return c.preventDefault()}),this.options.showZoom&&(v.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in mapboxgl-ctrl-zoom-in",function(c){return p._map.zoomIn({},{originalEvent:c})}),ft.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden",!0),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out mapboxgl-ctrl-zoom-out",function(c){return p._map.zoomOut({},{originalEvent:c})}),ft.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden",!0)),this.options.showCompass&&(v.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("maplibregl-ctrl-compass mapboxgl-ctrl-compass",function(c){p.options.visualizePitch?p._map.resetNorthPitch({},{originalEvent:c}):p._map.resetNorth({},{originalEvent:c})}),this._compassIcon=ft.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden",!0))};bi.prototype._updateZoomButtons=function(){var l=this._map.getZoom(),p=l===this._map.getMaxZoom(),c=l===this._map.getMinZoom();this._zoomInButton.disabled=p,this._zoomOutButton.disabled=c,this._zoomInButton.setAttribute("aria-disabled",p.toString()),this._zoomOutButton.setAttribute("aria-disabled",c.toString())},bi.prototype._rotateCompassArrow=function(){var l=this.options.visualizePitch?"scale("+1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)+") rotateX("+this._map.transform.pitch+"deg) rotateZ("+this._map.transform.angle*(180/Math.PI)+"deg)":"rotate("+this._map.transform.angle*(180/Math.PI)+"deg)";this._compassIcon.style.transform=l},bi.prototype.onAdd=function(l){return this._map=l,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new qa(this._map,this._compass,this.options.visualizePitch)),this._container},bi.prototype.onRemove=function(){ft.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map},bi.prototype._createButton=function(l,p){var c=ft.create("button",l,this._container);return c.type="button",c.addEventListener("click",p),c},bi.prototype._setButtonTitle=function(l,p){var c=this._map._getUIString("NavigationControl."+p);l.title=c,l.setAttribute("aria-label",c)};var qa=function(l,p,c){void 0===c&&(c=!1),this._clickTolerance=10,this.element=p,this.mouseRotate=new Bi({clickTolerance:l.dragRotate._mouseRotate._clickTolerance}),this.map=l,c&&(this.mousePitch=new tl({clickTolerance:l.dragRotate._mousePitch._clickTolerance})),v.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),ft.addEventListener(p,"mousedown",this.mousedown),ft.addEventListener(p,"touchstart",this.touchstart,{passive:!1}),ft.addEventListener(p,"touchmove",this.touchmove),ft.addEventListener(p,"touchend",this.touchend),ft.addEventListener(p,"touchcancel",this.reset)};function Hs(l,p,c){if(l=new v.LngLat(l.lng,l.lat),p){var y=new v.LngLat(l.lng-360,l.lat),C=new v.LngLat(l.lng+360,l.lat),T=c.locationPoint(l).distSqr(p);c.locationPoint(y).distSqr(p)<T?l=y:c.locationPoint(C).distSqr(p)<T&&(l=C)}for(;Math.abs(l.lng-c.center.lng)>180;){var L=c.locationPoint(l);if(L.x>=0&&L.y>=0&&L.x<=c.width&&L.y<=c.height)break;l.lng>c.center.lng?l.lng-=360:l.lng+=360}return l}qa.prototype.down=function(l,p){this.mouseRotate.mousedown(l,p),this.mousePitch&&this.mousePitch.mousedown(l,p),ft.disableDrag()},qa.prototype.move=function(l,p){var c=this.map,y=this.mouseRotate.mousemoveWindow(l,p);if(y&&y.bearingDelta&&c.setBearing(c.getBearing()+y.bearingDelta),this.mousePitch){var C=this.mousePitch.mousemoveWindow(l,p);C&&C.pitchDelta&&c.setPitch(c.getPitch()+C.pitchDelta)}},qa.prototype.off=function(){var l=this.element;ft.removeEventListener(l,"mousedown",this.mousedown),ft.removeEventListener(l,"touchstart",this.touchstart,{passive:!1}),ft.removeEventListener(l,"touchmove",this.touchmove),ft.removeEventListener(l,"touchend",this.touchend),ft.removeEventListener(l,"touchcancel",this.reset),this.offTemp()},qa.prototype.offTemp=function(){ft.enableDrag(),ft.removeEventListener(v.window,"mousemove",this.mousemove),ft.removeEventListener(v.window,"mouseup",this.mouseup)},qa.prototype.mousedown=function(l){this.down(v.extend({},l,{ctrlKey:!0,preventDefault:function(){return l.preventDefault()}}),ft.mousePos(this.element,l)),ft.addEventListener(v.window,"mousemove",this.mousemove),ft.addEventListener(v.window,"mouseup",this.mouseup)},qa.prototype.mousemove=function(l){this.move(l,ft.mousePos(this.element,l))},qa.prototype.mouseup=function(l){this.mouseRotate.mouseupWindow(l),this.mousePitch&&this.mousePitch.mouseupWindow(l),this.offTemp()},qa.prototype.touchstart=function(l){1!==l.targetTouches.length?this.reset():(this._startPos=this._lastPos=ft.touchPos(this.element,l.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:function(){return l.preventDefault()}},this._startPos))},qa.prototype.touchmove=function(l){1!==l.targetTouches.length?this.reset():(this._lastPos=ft.touchPos(this.element,l.targetTouches)[0],this.move({preventDefault:function(){return l.preventDefault()}},this._lastPos))},qa.prototype.touchend=function(l){0===l.targetTouches.length&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()},qa.prototype.reset=function(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()};var n={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function a(l,p,c){var y=l.classList;for(var C in n)y.remove("maplibregl-"+c+"-anchor-"+C,"mapboxgl-"+c+"-anchor-"+C);y.add("maplibregl-"+c+"-anchor-"+p,"mapboxgl-"+c+"-anchor-"+p)}var h,d=function(l){function p(c,y){if(l.call(this),(c instanceof v.window.HTMLElement||y)&&(c=v.extend({element:c},y)),v.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress"],this),this._anchor=c&&c.anchor||"center",this._color=c&&c.color||"#3FB1CE",this._scale=c&&c.scale||1,this._draggable=c&&c.draggable||!1,this._clickTolerance=c&&c.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=c&&c.rotation||0,this._rotationAlignment=c&&c.rotationAlignment||"auto",this._pitchAlignment=c&&c.pitchAlignment&&"auto"!==c.pitchAlignment?c.pitchAlignment:this._rotationAlignment,c&&c.element)this._element=c.element,this._offset=v.Point.convert(c&&c.offset||[0,0]);else{this._defaultMarker=!0,this._element=ft.create("div"),this._element.setAttribute("aria-label","Map marker");var C=ft.createNS("http://www.w3.org/2000/svg","svg");C.setAttributeNS(null,"display","block"),C.setAttributeNS(null,"height","41px"),C.setAttributeNS(null,"width","27px"),C.setAttributeNS(null,"viewBox","0 0 27 41");var T=ft.createNS("http://www.w3.org/2000/svg","g");T.setAttributeNS(null,"stroke","none"),T.setAttributeNS(null,"stroke-width","1"),T.setAttributeNS(null,"fill","none"),T.setAttributeNS(null,"fill-rule","evenodd");var L=ft.createNS("http://www.w3.org/2000/svg","g");L.setAttributeNS(null,"fill-rule","nonzero");var z=ft.createNS("http://www.w3.org/2000/svg","g");z.setAttributeNS(null,"transform","translate(3.0, 29.0)"),z.setAttributeNS(null,"fill","#000000");for(var Z=0,H=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];Z<H.length;Z+=1){var ut=H[Z],gt=ft.createNS("http://www.w3.org/2000/svg","ellipse");gt.setAttributeNS(null,"opacity","0.04"),gt.setAttributeNS(null,"cx","10.5"),gt.setAttributeNS(null,"cy","5.80029008"),gt.setAttributeNS(null,"rx",ut.rx),gt.setAttributeNS(null,"ry",ut.ry),z.appendChild(gt)}var ct=ft.createNS("http://www.w3.org/2000/svg","g");ct.setAttributeNS(null,"fill",this._color);var zt=ft.createNS("http://www.w3.org/2000/svg","path");zt.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),ct.appendChild(zt);var Rt=ft.createNS("http://www.w3.org/2000/svg","g");Rt.setAttributeNS(null,"opacity","0.25"),Rt.setAttributeNS(null,"fill","#000000");var Yt=ft.createNS("http://www.w3.org/2000/svg","path");Yt.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),Rt.appendChild(Yt);var Dt=ft.createNS("http://www.w3.org/2000/svg","g");Dt.setAttributeNS(null,"transform","translate(6.0, 7.0)"),Dt.setAttributeNS(null,"fill","#FFFFFF");var Vt=ft.createNS("http://www.w3.org/2000/svg","g");Vt.setAttributeNS(null,"transform","translate(8.0, 8.0)");var ee=ft.createNS("http://www.w3.org/2000/svg","circle");ee.setAttributeNS(null,"fill","#000000"),ee.setAttributeNS(null,"opacity","0.25"),ee.setAttributeNS(null,"cx","5.5"),ee.setAttributeNS(null,"cy","5.5"),ee.setAttributeNS(null,"r","5.4999962");var he=ft.createNS("http://www.w3.org/2000/svg","circle");he.setAttributeNS(null,"fill","#FFFFFF"),he.setAttributeNS(null,"cx","5.5"),he.setAttributeNS(null,"cy","5.5"),he.setAttributeNS(null,"r","5.4999962"),Vt.appendChild(ee),Vt.appendChild(he),L.appendChild(z),L.appendChild(ct),L.appendChild(Rt),L.appendChild(Dt),L.appendChild(Vt),C.appendChild(L),C.setAttributeNS(null,"height",41*this._scale+"px"),C.setAttributeNS(null,"width",27*this._scale+"px"),this._element.appendChild(C),this._offset=v.Point.convert(c&&c.offset||[0,-14])}this._element.classList.add("maplibregl-marker","mapboxgl-marker"),this._element.addEventListener("dragstart",function(_e){_e.preventDefault()}),this._element.addEventListener("mousedown",function(_e){_e.preventDefault()}),a(this._element,this._anchor,"marker"),this._popup=null}return l&&(p.__proto__=l),(p.prototype=Object.create(l&&l.prototype)).constructor=p,p.prototype.addTo=function(c){return this.remove(),this._map=c,c.getCanvasContainer().appendChild(this._element),c.on("move",this._update),c.on("moveend",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this},p.prototype.remove=function(){return this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),ft.remove(this._element),this._popup&&this._popup.remove(),this},p.prototype.getLngLat=function(){return this._lngLat},p.prototype.setLngLat=function(c){return this._lngLat=v.LngLat.convert(c),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this},p.prototype.getElement=function(){return this._element},p.prototype.setPopup=function(c){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),c){if(!("offset"in c.options)){var y=Math.sqrt(Math.pow(13.5,2)/2);c.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[y,-1*(24.6+y)],"bottom-right":[-y,-1*(24.6+y)],left:[13.5,-24.6],right:[-13.5,-24.6]}:this._offset}this._popup=c,this._lngLat&&this._popup.setLngLat(this._lngLat),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this},p.prototype._onKeyPress=function(c){var y=c.code,C=c.charCode||c.keyCode;"Space"!==y&&"Enter"!==y&&32!==C&&13!==C||this.togglePopup()},p.prototype._onMapClick=function(c){var y=c.originalEvent.target,C=this._element;this._popup&&(y===C||C.contains(y))&&this.togglePopup()},p.prototype.getPopup=function(){return this._popup},p.prototype.togglePopup=function(){var c=this._popup;return c?(c.isOpen()?c.remove():c.addTo(this._map),this):this},p.prototype._update=function(c){if(this._map){this._map.transform.renderWorldCopies&&(this._lngLat=Hs(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._offset);var y="";"viewport"===this._rotationAlignment||"auto"===this._rotationAlignment?y="rotateZ("+this._rotation+"deg)":"map"===this._rotationAlignment&&(y="rotateZ("+(this._rotation-this._map.getBearing())+"deg)");var C="";"viewport"===this._pitchAlignment||"auto"===this._pitchAlignment?C="rotateX(0deg)":"map"===this._pitchAlignment&&(C="rotateX("+this._map.getPitch()+"deg)"),c&&"moveend"!==c.type||(this._pos=this._pos.round()),ft.setTransform(this._element,n[this._anchor]+" translate("+this._pos.x+"px, "+this._pos.y+"px) "+C+" "+y)}},p.prototype.getOffset=function(){return this._offset},p.prototype.setOffset=function(c){return this._offset=v.Point.convert(c),this._update(),this},p.prototype._onMove=function(c){if(!this._isDragging){var y=this._clickTolerance||this._map._clickTolerance;this._isDragging=c.point.dist(this._pointerdownPos)>=y}this._isDragging&&(this._pos=c.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none","pending"===this._state&&(this._state="active",this.fire(new v.Event("dragstart"))),this.fire(new v.Event("drag")))},p.prototype._onUp=function(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),"active"===this._state&&this.fire(new v.Event("dragend")),this._state="inactive"},p.prototype._addDragHandler=function(c){this._element.contains(c.originalEvent.target)&&(c.preventDefault(),this._positionDelta=c.point.sub(this._pos).add(this._offset),this._pointerdownPos=c.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},p.prototype.setDraggable=function(c){return this._draggable=!!c,this._map&&(c?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this},p.prototype.isDraggable=function(){return this._draggable},p.prototype.setRotation=function(c){return this._rotation=c||0,this._update(),this},p.prototype.getRotation=function(){return this._rotation},p.prototype.setRotationAlignment=function(c){return this._rotationAlignment=c||"auto",this._update(),this},p.prototype.getRotationAlignment=function(){return this._rotationAlignment},p.prototype.setPitchAlignment=function(c){return this._pitchAlignment=c&&"auto"!==c?c:this._rotationAlignment,this._update(),this},p.prototype.getPitchAlignment=function(){return this._pitchAlignment},p}(v.Evented),w={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0},O=0,k=!1,W=function(l){function p(c){l.call(this),this.options=v.extend({},w,c),v.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker"],this)}return l&&(p.__proto__=l),(p.prototype=Object.create(l&&l.prototype)).constructor=p,p.prototype.onAdd=function(c){var y;return this._map=c,this._container=ft.create("div","maplibregl-ctrl maplibregl-ctrl-group mapboxgl-ctrl mapboxgl-ctrl-group"),y=this._setupUI,void 0!==h?y(h):void 0!==v.window.navigator.permissions?v.window.navigator.permissions.query({name:"geolocation"}).then(function(C){y(h="denied"!==C.state)}):y(h=!!v.window.navigator.geolocation),this._container},p.prototype.onRemove=function(){void 0!==this._geolocationWatchID&&(v.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),ft.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,O=0,k=!1},p.prototype._isOutOfMapMaxBounds=function(c){var y=this._map.getMaxBounds(),C=c.coords;return y&&(C.longitude<y.getWest()||C.longitude>y.getEast()||C.latitude<y.getSouth()||C.latitude>y.getNorth())},p.prototype._setErrorState=function(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error","mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting")}},p.prototype._onSuccess=function(c){if(this._map){if(this._isOutOfMapMaxBounds(c))return this._setErrorState(),this.fire(new v.Event("outofmaxbounds",c)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=c,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error","mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&"OFF"!==this._watchState&&this._updateMarker(c),this.options.trackUserLocation&&"ACTIVE_LOCK"!==this._watchState||this._updateCamera(c),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale","mapboxgl-user-location-dot-stale"),this.fire(new v.Event("geolocate",c)),this._finish()}},p.prototype._updateCamera=function(c){var y=new v.LngLat(c.coords.longitude,c.coords.latitude),C=c.coords.accuracy,T=this._map.getBearing(),L=v.extend({bearing:T},this.options.fitBoundsOptions);this._map.fitBounds(y.toBounds(C),L,{geolocateSource:!0})},p.prototype._updateMarker=function(c){if(c){var y=new v.LngLat(c.coords.longitude,c.coords.latitude);this._accuracyCircleMarker.setLngLat(y).addTo(this._map),this._userLocationDotMarker.setLngLat(y).addTo(this._map),this._accuracy=c.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},p.prototype._updateCircleRadius=function(){var c=this._map._container.clientHeight/2,y=this._map.unproject([0,c]),C=this._map.unproject([1,c]),T=y.distanceTo(C),L=Math.ceil(2*this._accuracy/T);this._circleElement.style.width=L+"px",this._circleElement.style.height=L+"px"},p.prototype._onZoom=function(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},p.prototype._onError=function(c){if(this._map){if(this.options.trackUserLocation)if(1===c.code){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error","mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;var y=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=y,this._geolocateButton.setAttribute("aria-label",y),void 0!==this._geolocationWatchID&&this._clearWatch()}else{if(3===c.code&&k)return;this._setErrorState()}"OFF"!==this._watchState&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale","mapboxgl-user-location-dot-stale"),this.fire(new v.Event("error",c)),this._finish()}},p.prototype._finish=function(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},p.prototype._setupUI=function(c){var y=this;if(this._container.addEventListener("contextmenu",function(L){return L.preventDefault()}),this._geolocateButton=ft.create("button","maplibregl-ctrl-geolocate mapboxgl-ctrl-geolocate",this._container),ft.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden",!0),this._geolocateButton.type="button",!1===c){v.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");var C=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=C,this._geolocateButton.setAttribute("aria-label",C)}else{var T=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=T,this._geolocateButton.setAttribute("aria-label",T)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=ft.create("div","maplibregl-user-location-dot mapboxgl-user-location-dot"),this._userLocationDotMarker=new d(this._dotElement),this._circleElement=ft.create("div","maplibregl-user-location-accuracy-circle mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new d({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",function(L){L.geolocateSource||"ACTIVE_LOCK"!==y._watchState||L.originalEvent&&"resize"===L.originalEvent.type||(y._watchState="BACKGROUND",y._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),y._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),y.fire(new v.Event("trackuserlocationend")))})},p.prototype.trigger=function(){if(!this._setup)return v.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new v.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":O--,k=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error","mapboxgl-ctrl-geolocate-background-error"),this.fire(new v.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new v.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error","mapboxgl-ctrl-geolocate-background-error")}if("OFF"===this._watchState&&void 0!==this._geolocationWatchID)this._clearWatch();else if(void 0===this._geolocationWatchID){var c;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),++O>1?(c={maximumAge:6e5,timeout:0},k=!0):(c=this.options.positionOptions,k=!1),this._geolocationWatchID=v.window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,c)}}else v.window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0},p.prototype._clearWatch=function(){v.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)},p}(v.Evented),mt={maxWidth:100,unit:"metric"},Gt=function(l){this.options=v.extend({},mt,l),v.bindAll(["_onMove","setUnit"],this)};function Ie(l,p,c){var y=c&&c.maxWidth||100,C=l._container.clientHeight/2,T=l.unproject([0,C]),L=l.unproject([y,C]),z=T.distanceTo(L);if(c&&"imperial"===c.unit){var Z=3.2808*z;Z>5280?Me(p,y,Z/5280,l._getUIString("ScaleControl.Miles")):Me(p,y,Z,l._getUIString("ScaleControl.Feet"))}else c&&"nautical"===c.unit?Me(p,y,z/1852,l._getUIString("ScaleControl.NauticalMiles")):z>=1e3?Me(p,y,z/1e3,l._getUIString("ScaleControl.Kilometers")):Me(p,y,z,l._getUIString("ScaleControl.Meters"))}function Me(l,p,c,y){var C,T,L,Z,H,z=(C=c,(T=Math.pow(10,(""+Math.floor(C)).length-1))*(L=(L=C/T)>=10?10:L>=5?5:L>=3?3:L>=2?2:L>=1?1:(Z=L,H=Math.pow(10,Math.ceil(-Math.log(Z)/Math.LN10)),Math.round(Z*H)/H)));l.style.width=p*(z/c)+"px",l.innerHTML=z+"&nbsp;"+y}Gt.prototype.getDefaultPosition=function(){return"bottom-left"},Gt.prototype._onMove=function(){Ie(this._map,this._container,this.options)},Gt.prototype.onAdd=function(l){return this._map=l,this._container=ft.create("div","maplibregl-ctrl maplibregl-ctrl-scale mapboxgl-ctrl mapboxgl-ctrl-scale",l.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container},Gt.prototype.onRemove=function(){ft.remove(this._container),this._map.off("move",this._onMove),this._map=void 0},Gt.prototype.setUnit=function(l){this.options.unit=l,Ie(this._map,this._container,this.options)};var Ke=function(l){this._fullscreen=!1,l&&l.container&&(l.container instanceof v.window.HTMLElement?this._container=l.container:v.warnOnce("Full screen control 'container' must be a DOM element.")),v.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in v.window.document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in v.window.document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in v.window.document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in v.window.document&&(this._fullscreenchange="MSFullscreenChange")};Ke.prototype.onAdd=function(l){return this._map=l,this._container||(this._container=this._map.getContainer()),this._controlContainer=ft.create("div","maplibregl-ctrl maplibregl-ctrl-group mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",v.warnOnce("This device does not support fullscreen mode.")),this._controlContainer},Ke.prototype.onRemove=function(){ft.remove(this._controlContainer),this._map=null,v.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)},Ke.prototype._checkFullscreenSupport=function(){return!!(v.window.document.fullscreenEnabled||v.window.document.mozFullScreenEnabled||v.window.document.msFullscreenEnabled||v.window.document.webkitFullscreenEnabled)},Ke.prototype._setupUI=function(){var l=this._fullscreenButton=ft.create("button","maplibregl-ctrl-fullscreen mapboxgl-ctrl-fullscreen",this._controlContainer);ft.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",l).setAttribute("aria-hidden",!0),l.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),v.window.document.addEventListener(this._fullscreenchange,this._changeIcon)},Ke.prototype._updateTitle=function(){var l=this._getTitle();this._fullscreenButton.setAttribute("aria-label",l),this._fullscreenButton.title=l},Ke.prototype._getTitle=function(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")},Ke.prototype._isFullscreen=function(){return this._fullscreen},Ke.prototype._changeIcon=function(){(v.window.document.fullscreenElement||v.window.document.mozFullScreenElement||v.window.document.webkitFullscreenElement||v.window.document.msFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())},Ke.prototype._onClickFullscreen=function(){this._isFullscreen()?v.window.document.exitFullscreen?v.window.document.exitFullscreen():v.window.document.mozCancelFullScreen?v.window.document.mozCancelFullScreen():v.window.document.msExitFullscreen?v.window.document.msExitFullscreen():v.window.document.webkitCancelFullScreen&&v.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()};var gr={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},Or=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", "),Zr=function(l){function p(c){l.call(this),this.options=v.extend(Object.create(gr),c),v.bindAll(["_update","_onClose","remove","_onMouseMove","_onMouseUp","_onDrag"],this)}return l&&(p.__proto__=l),(p.prototype=Object.create(l&&l.prototype)).constructor=p,p.prototype.addTo=function(c){return this._map&&this.remove(),this._map=c,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer","mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer","mapboxgl-track-pointer")):this._map.on("move",this._update),this.fire(new v.Event("open")),this},p.prototype.isOpen=function(){return!!this._map},p.prototype.remove=function(){return this._content&&ft.remove(this._content),this._container&&(ft.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),delete this._map),this.fire(new v.Event("close")),this},p.prototype.getLngLat=function(){return this._lngLat},p.prototype.setLngLat=function(c){return this._lngLat=v.LngLat.convert(c),this._pos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer","mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer","mapboxgl-track-pointer")),this},p.prototype.trackPointer=function(){return this._trackPointer=!0,this._pos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer","mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer","mapboxgl-track-pointer")),this},p.prototype.getElement=function(){return this._container},p.prototype.setText=function(c){return this.setDOMContent(v.window.document.createTextNode(c))},p.prototype.setHTML=function(c){var y,C=v.window.document.createDocumentFragment(),T=v.window.document.createElement("body");for(T.innerHTML=c;y=T.firstChild;)C.appendChild(y);return this.setDOMContent(C)},p.prototype.getMaxWidth=function(){return this._container&&this._container.style.maxWidth},p.prototype.setMaxWidth=function(c){return this.options.maxWidth=c,this._update(),this},p.prototype.setDOMContent=function(c){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=ft.create("div","maplibregl-popup-content mapboxgl-popup-content",this._container);return this._content.appendChild(c),this._createCloseButton(),this._update(),this._focusFirstElement(),this},p.prototype.addClassName=function(c){this._container&&this._container.classList.add(c)},p.prototype.removeClassName=function(c){this._container&&this._container.classList.remove(c)},p.prototype.setOffset=function(c){return this.options.offset=c,this._update(),this},p.prototype.toggleClassName=function(c){if(this._container)return this._container.classList.toggle(c)},p.prototype._createCloseButton=function(){this.options.closeButton&&(this._closeButton=ft.create("button","maplibregl-popup-close-button mapboxgl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))},p.prototype._onMouseUp=function(c){this._update(c.point)},p.prototype._onMouseMove=function(c){this._update(c.point)},p.prototype._onDrag=function(c){this._update(c.point)},p.prototype._update=function(c){var y=this;if(this._map&&(this._lngLat||this._trackPointer)&&this._content&&(this._container||(this._container=ft.create("div","maplibregl-popup mapboxgl-popup",this._map.getContainer()),this._tip=ft.create("div","maplibregl-popup-tip mapboxgl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className&&this.options.className.split(" ").forEach(function(gt){return y._container.classList.add(gt)}),this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer","mapboxgl-popup-track-pointer")),this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=Hs(this._lngLat,this._pos,this._map.transform)),!this._trackPointer||c)){var C=this._pos=this._trackPointer&&c?c:this._map.project(this._lngLat),T=this.options.anchor,L=function gt(ct){if(ct){if("number"==typeof ct){var zt=Math.round(Math.sqrt(.5*Math.pow(ct,2)));return{center:new v.Point(0,0),top:new v.Point(0,ct),"top-left":new v.Point(zt,zt),"top-right":new v.Point(-zt,zt),bottom:new v.Point(0,-ct),"bottom-left":new v.Point(zt,-zt),"bottom-right":new v.Point(-zt,-zt),left:new v.Point(ct,0),right:new v.Point(-ct,0)}}if(ct instanceof v.Point||Array.isArray(ct)){var Rt=v.Point.convert(ct);return{center:Rt,top:Rt,"top-left":Rt,"top-right":Rt,bottom:Rt,"bottom-left":Rt,"bottom-right":Rt,left:Rt,right:Rt}}return{center:v.Point.convert(ct.center||[0,0]),top:v.Point.convert(ct.top||[0,0]),"top-left":v.Point.convert(ct["top-left"]||[0,0]),"top-right":v.Point.convert(ct["top-right"]||[0,0]),bottom:v.Point.convert(ct.bottom||[0,0]),"bottom-left":v.Point.convert(ct["bottom-left"]||[0,0]),"bottom-right":v.Point.convert(ct["bottom-right"]||[0,0]),left:v.Point.convert(ct.left||[0,0]),right:v.Point.convert(ct.right||[0,0])}}return gt(new v.Point(0,0))}(this.options.offset);if(!T){var z,Z=this._container.offsetWidth,H=this._container.offsetHeight;z=C.y+L.bottom.y<H?["top"]:C.y>this._map.transform.height-H?["bottom"]:[],C.x<Z/2?z.push("left"):C.x>this._map.transform.width-Z/2&&z.push("right"),T=0===z.length?"bottom":z.join("-")}var ut=C.add(L[T]).round();ft.setTransform(this._container,n[T]+" translate("+ut.x+"px,"+ut.y+"px)"),a(this._container,T,"popup")}},p.prototype._focusFirstElement=function(){if(this.options.focusAfterOpen&&this._container){var c=this._container.querySelector(Or);c&&c.focus()}},p.prototype._onClose=function(){this.remove()},p}(v.Evented),Kn={version:v.version,supported:Bt,setRTLTextPlugin:v.setRTLTextPlugin,getRTLTextPluginStatus:v.getRTLTextPluginStatus,Map:oi,NavigationControl:bi,GeolocateControl:W,AttributionControl:Ki,ScaleControl:Gt,FullscreenControl:Ke,Popup:Zr,Marker:d,Style:Ka,LngLat:v.LngLat,LngLatBounds:v.LngLatBounds,Point:v.Point,MercatorCoordinate:v.MercatorCoordinate,Evented:v.Evented,config:v.config,prewarm:function(){Tr().acquire(ge)},clearPrewarmedResources:function(){var l=cr;l&&(l.isPreloaded()&&1===l.numActive()?(l.release(ge),cr=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return v.config.ACCESS_TOKEN},set accessToken(l){v.config.ACCESS_TOKEN=l},get baseApiUrl(){return v.config.API_URL},set baseApiUrl(l){v.config.API_URL=l},get workerCount(){return Oe.workerCount},set workerCount(l){Oe.workerCount=l},get maxParallelImageRequests(){return v.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(l){v.config.MAX_PARALLEL_IMAGE_REQUESTS=l},clearStorage:function(l){v.clearTileCache(l)},workerUrl:"",addProtocol:function(l,p){v.config.REGISTERED_PROTOCOLS[l]=p},removeProtocol:function(l){delete v.config.REGISTERED_PROTOCOLS[l]}};return Kn}),yt}()},8228:He=>{"use strict";var pe=Object.getOwnPropertySymbols,wt=Object.prototype.hasOwnProperty,yt=Object.prototype.propertyIsEnumerable;function b(Bt){if(null==Bt)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(Bt)}He.exports=function(){try{if(!Object.assign)return!1;var Bt=new String("abc");if(Bt[5]="de","5"===Object.getOwnPropertyNames(Bt)[0])return!1;for(var ft={},St=0;St<10;St++)ft["_"+String.fromCharCode(St)]=St;if("0123456789"!==Object.getOwnPropertyNames(ft).map(function(kt){return ft[kt]}).join(""))return!1;var le={};return"abcdefghijklmnopqrst".split("").forEach(function(kt){le[kt]=kt}),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},le)).join("")}catch(kt){return!1}}()?Object.assign:function(Bt,ft){for(var St,le,Ft=b(Bt),kt=1;kt<arguments.length;kt++){for(var Ze in St=Object(arguments[kt]))wt.call(St,Ze)&&(Ft[Ze]=St[Ze]);if(pe){le=pe(St);for(var ye=0;ye<le.length;ye++)yt.call(St,le[ye])&&(Ft[le[ye]]=St[le[ye]])}}return Ft}},7859:He=>{"use strict";var pe=function(wt){return wt!=wt};He.exports=function(yt,b){return 0===yt&&0===b?1/yt==1/b:!!(yt===b||pe(yt)&&pe(b))}},4269:(He,pe,wt)=>{"use strict";var yt=wt(6886),b=wt(44),v=wt(7859),Bt=wt(8593),ft=wt(6343),St=b(Bt(),Object);yt(St,{getPolyfill:Bt,implementation:v,shim:ft}),He.exports=St},8593:(He,pe,wt)=>{"use strict";var yt=wt(7859);He.exports=function(){return"function"==typeof Object.is?Object.is:yt}},6343:(He,pe,wt)=>{"use strict";var yt=wt(8593),b=wt(6886);He.exports=function(){var Bt=yt();return b(Object,{is:Bt},{is:function(){return Object.is!==Bt}}),Bt}},6068:(He,pe,wt)=>{"use strict";var yt;if(!Object.keys){var b=Object.prototype.hasOwnProperty,v=Object.prototype.toString,Bt=wt(2666),ft=Object.prototype.propertyIsEnumerable,St=!ft.call({toString:null},"toString"),Ft=ft.call(function(){},"prototype"),le=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],kt=function(de){var Ye=de.constructor;return Ye&&Ye.prototype===de},Ze={$applicationCache:!0,$console:!0,$external:!0,$frame:!0,$frameElement:!0,$frames:!0,$innerHeight:!0,$innerWidth:!0,$onmozfullscreenchange:!0,$onmozfullscreenerror:!0,$outerHeight:!0,$outerWidth:!0,$pageXOffset:!0,$pageYOffset:!0,$parent:!0,$scrollLeft:!0,$scrollTop:!0,$scrollX:!0,$scrollY:!0,$self:!0,$webkitIndexedDB:!0,$webkitStorageInfo:!0,$window:!0},ye=function(){if("undefined"==typeof window)return!1;for(var de in window)try{if(!Ze["$"+de]&&b.call(window,de)&&null!==window[de]&&"object"==typeof window[de])try{kt(window[de])}catch(Ye){return!0}}catch(Ye){return!0}return!1}();yt=function(Ye){var qt=null!==Ye&&"object"==typeof Ye,Qt="[object Function]"===v.call(Ye),X=Bt(Ye),J=qt&&"[object String]"===v.call(Ye),Q=[];if(!qt&&!Qt&&!X)throw new TypeError("Object.keys called on a non-object");var bt=Ft&&Qt;if(J&&Ye.length>0&&!b.call(Ye,0))for(var et=0;et<Ye.length;++et)Q.push(String(et));if(X&&Ye.length>0)for(var tt=0;tt<Ye.length;++tt)Q.push(String(tt));else for(var lt in Ye)(!bt||"prototype"!==lt)&&b.call(Ye,lt)&&Q.push(String(lt));if(St)for(var j=function(de){if("undefined"==typeof window||!ye)return kt(de);try{return kt(de)}catch(Ye){return!1}}(Ye),re=0;re<le.length;++re)(!j||"constructor"!==le[re])&&b.call(Ye,le[re])&&Q.push(le[re]);return Q}}He.exports=yt},8507:(He,pe,wt)=>{"use strict";var yt=Array.prototype.slice,b=wt(2666),v=Object.keys,Bt=v?function(Ft){return v(Ft)}:wt(6068),ft=Object.keys;Bt.shim=function(){return Object.keys?function(){var le=Object.keys(arguments);return le&&le.length===arguments.length}(1,2)||(Object.keys=function(kt){return b(kt)?ft(yt.call(kt)):ft(kt)}):Object.keys=Bt,Object.keys||Bt},He.exports=Bt},2666:He=>{"use strict";var pe=Object.prototype.toString;He.exports=function(yt){var b=pe.call(yt),v="[object Arguments]"===b;return v||(v="[object Array]"!==b&&null!==yt&&"object"==typeof yt&&"number"==typeof yt.length&&yt.length>=0&&"[object Function]"===pe.call(yt.callee)),v}},5751:He=>{He.exports=function(wt,yt,b,v){var Bt=wt[0],ft=wt[1],St=!1;void 0===b&&(b=0),void 0===v&&(v=yt.length);for(var Ft=(v-b)/2,le=0,kt=Ft-1;le<Ft;kt=le++){var Ze=yt[b+2*le+0],ye=yt[b+2*le+1],de=yt[b+2*kt+1];ye>ft!=de>ft&&Bt<(yt[b+2*kt+0]-Ze)*(ft-ye)/(de-ye)+Ze&&(St=!St)}return St}},5503:(He,pe,wt)=>{var yt=wt(5751),b=wt(5891);He.exports=function(Bt,ft,St,Ft){return ft.length>0&&Array.isArray(ft[0])?b(Bt,ft,St,Ft):yt(Bt,ft,St,Ft)},He.exports.nested=b,He.exports.flat=yt},5891:He=>{He.exports=function(wt,yt,b,v){var Bt=wt[0],ft=wt[1],St=!1;void 0===b&&(b=0),void 0===v&&(v=yt.length);for(var Ft=v-b,le=0,kt=Ft-1;le<Ft;kt=le++){var Ze=yt[le+b][0],ye=yt[le+b][1],de=yt[kt+b][1];ye>ft!=de>ft&&Bt<(yt[kt+b][0]-Ze)*(ft-ye)/(de-ye)+Ze&&(St=!St)}return St}},171:function(He){He.exports=function(){"use strict";function pe(ae,st){if(!(ae instanceof st))throw new TypeError("Cannot call a class as a function")}function wt(ae,st){for(var rt=0;rt<st.length;rt++){var $=st[rt];$.enumerable=$.enumerable||!1,$.configurable=!0,"value"in $&&($.writable=!0),Object.defineProperty(ae,$.key,$)}}function yt(ae,st,rt){return st&&wt(ae.prototype,st),rt&&wt(ae,rt),ae}var b=function(st,rt){this.next=null,this.key=st,this.data=rt,this.left=null,this.right=null};function v(ae,st){return ae>st?1:ae<st?-1:0}function Bt(ae,st,rt){for(var $=new b(null,null),Tt=$,Jt=$;;){var Ee=rt(ae,st.key);if(Ee<0){if(null===st.left)break;if(rt(ae,st.left.key)<0&&(st.left=(Ge=st.left).right,Ge.right=st,null===(st=Ge).left))break;Jt.left=st,Jt=st,st=st.left}else{if(!(Ee>0))break;if(null===st.right)break;var Ge;if(rt(ae,st.right.key)>0&&(st.right=(Ge=st.right).left,Ge.left=st,null===(st=Ge).right))break;Tt.right=st,Tt=st,st=st.right}}return Tt.right=st.left,Jt.left=st.right,st.left=$.right,st.right=$.left,st}function ft(ae,st,rt,$){var Tt=new b(ae,st);if(null===rt)return Tt.left=Tt.right=null,Tt;var Jt=$(ae,(rt=Bt(ae,rt,$)).key);return Jt<0?(Tt.left=rt.left,Tt.right=rt,rt.left=null):Jt>=0&&(Tt.right=rt.right,Tt.left=rt,rt.right=null),Tt}function St(ae,st,rt){var $=null,Tt=null;if(st){var Jt=rt((st=Bt(ae,st,rt)).key,ae);0===Jt?($=st.left,Tt=st.right):Jt<0?(Tt=st.right,st.right=null,$=st):($=st.left,st.left=null,Tt=st)}return{left:$,right:Tt}}function le(ae,st,rt,$,Tt){if(ae){$(st+(rt?"\u2514\u2500\u2500 ":"\u251c\u2500\u2500 ")+Tt(ae)+"\n");var Jt=st+(rt?"    ":"\u2502   ");ae.left&&le(ae.left,Jt,!1,$,Tt),ae.right&&le(ae.right,Jt,!0,$,Tt)}}var kt=function(){function ae(st){void 0===st&&(st=v),this._root=null,this._size=0,this._comparator=st}return ae.prototype.insert=function(st,rt){return this._size++,this._root=ft(st,rt,this._root,this._comparator)},ae.prototype.add=function(st,rt){var $=new b(st,rt);null===this._root&&($.left=$.right=null,this._size++,this._root=$);var Tt=this._comparator,Jt=Bt(st,this._root,Tt),Ee=Tt(st,Jt.key);return 0===Ee?this._root=Jt:(Ee<0?($.left=Jt.left,$.right=Jt,Jt.left=null):Ee>0&&($.right=Jt.right,$.left=Jt,Jt.right=null),this._size++,this._root=$),this._root},ae.prototype.remove=function(st){this._root=this._remove(st,this._root,this._comparator)},ae.prototype._remove=function(st,rt,$){var Tt;return null===rt?null:0===$(st,(rt=Bt(st,rt,$)).key)?(null===rt.left?Tt=rt.right:(Tt=Bt(st,rt.left,$)).right=rt.right,this._size--,Tt):rt},ae.prototype.pop=function(){var st=this._root;if(st){for(;st.left;)st=st.left;return this._root=Bt(st.key,this._root,this._comparator),this._root=this._remove(st.key,this._root,this._comparator),{key:st.key,data:st.data}}return null},ae.prototype.findStatic=function(st){for(var rt=this._root,$=this._comparator;rt;){var Tt=$(st,rt.key);if(0===Tt)return rt;rt=Tt<0?rt.left:rt.right}return null},ae.prototype.find=function(st){return this._root&&(this._root=Bt(st,this._root,this._comparator),0!==this._comparator(st,this._root.key))?null:this._root},ae.prototype.contains=function(st){for(var rt=this._root,$=this._comparator;rt;){var Tt=$(st,rt.key);if(0===Tt)return!0;rt=Tt<0?rt.left:rt.right}return!1},ae.prototype.forEach=function(st,rt){for(var $=this._root,Tt=[],Jt=!1;!Jt;)null!==$?(Tt.push($),$=$.left):0!==Tt.length?($=Tt.pop(),st.call(rt,$),$=$.right):Jt=!0;return this},ae.prototype.range=function(st,rt,$,Tt){for(var Jt=[],Ee=this._comparator,Ge=this._root;0!==Jt.length||Ge;)if(Ge)Jt.push(Ge),Ge=Ge.left;else{if(Ee((Ge=Jt.pop()).key,rt)>0)break;if(Ee(Ge.key,st)>=0&&$.call(Tt,Ge))return this;Ge=Ge.right}return this},ae.prototype.keys=function(){var st=[];return this.forEach(function(rt){return st.push(rt.key)}),st},ae.prototype.values=function(){var st=[];return this.forEach(function(rt){return st.push(rt.data)}),st},ae.prototype.min=function(){return this._root?this.minNode(this._root).key:null},ae.prototype.max=function(){return this._root?this.maxNode(this._root).key:null},ae.prototype.minNode=function(st){if(void 0===st&&(st=this._root),st)for(;st.left;)st=st.left;return st},ae.prototype.maxNode=function(st){if(void 0===st&&(st=this._root),st)for(;st.right;)st=st.right;return st},ae.prototype.at=function(st){for(var rt=this._root,$=!1,Tt=0,Jt=[];!$;)if(rt)Jt.push(rt),rt=rt.left;else if(Jt.length>0){if(rt=Jt.pop(),Tt===st)return rt;Tt++,rt=rt.right}else $=!0;return null},ae.prototype.next=function(st){var rt=this._root,$=null;if(st.right){for($=st.right;$.left;)$=$.left;return $}for(var Tt=this._comparator;rt;){var Jt=Tt(st.key,rt.key);if(0===Jt)break;Jt<0?($=rt,rt=rt.left):rt=rt.right}return $},ae.prototype.prev=function(st){var rt=this._root,$=null;if(null!==st.left){for($=st.left;$.right;)$=$.right;return $}for(var Tt=this._comparator;rt;){var Jt=Tt(st.key,rt.key);if(0===Jt)break;Jt<0?rt=rt.left:($=rt,rt=rt.right)}return $},ae.prototype.clear=function(){return this._root=null,this._size=0,this},ae.prototype.toList=function(){return function(ae){for(var st=ae,rt=[],$=!1,Tt=new b(null,null),Jt=Tt;!$;)st?(rt.push(st),st=st.left):rt.length>0?st=(st=Jt=Jt.next=rt.pop()).right:$=!0;return Jt.next=null,Tt.next}(this._root)},ae.prototype.load=function(st,rt,$){void 0===rt&&(rt=[]),void 0===$&&($=!1);var Tt=st.length,Jt=this._comparator;if($&&qt(st,rt,0,Tt-1,Jt),null===this._root)this._root=Ze(st,rt,0,Tt),this._size=Tt;else{var Ee=function(ae,st,rt){for(var $=new b(null,null),Tt=$,Jt=ae,Ee=st;null!==Jt&&null!==Ee;)rt(Jt.key,Ee.key)<0?(Tt.next=Jt,Jt=Jt.next):(Tt.next=Ee,Ee=Ee.next),Tt=Tt.next;return null!==Jt?Tt.next=Jt:null!==Ee&&(Tt.next=Ee),$.next}(this.toList(),function(ae,st){for(var rt=new b(null,null),$=rt,Tt=0;Tt<ae.length;Tt++)$=$.next=new b(ae[Tt],st[Tt]);return $.next=null,rt.next}(st,rt),Jt);this._root=de({head:Ee},0,Tt=this._size+Tt)}return this},ae.prototype.isEmpty=function(){return null===this._root},Object.defineProperty(ae.prototype,"size",{get:function(){return this._size},enumerable:!0,configurable:!0}),Object.defineProperty(ae.prototype,"root",{get:function(){return this._root},enumerable:!0,configurable:!0}),ae.prototype.toString=function(st){void 0===st&&(st=function(Tt){return String(Tt.key)});var rt=[];return le(this._root,"",!0,function($){return rt.push($)},st),rt.join("")},ae.prototype.update=function(st,rt,$){var Tt=this._comparator,Jt=St(st,this._root,Tt),Ee=Jt.left,Ge=Jt.right;Tt(st,rt)<0?Ge=ft(rt,$,Ge,Tt):Ee=ft(rt,$,Ee,Tt),this._root=function(ae,st,rt){return null===st?ae:(null===ae||((st=Bt(ae.key,st,rt)).left=ae),st)}(Ee,Ge,Tt)},ae.prototype.split=function(st){return St(st,this._root,this._comparator)},ae}();function Ze(ae,st,rt,$){var Tt=$-rt;if(Tt>0){var Jt=rt+Math.floor(Tt/2),We=new b(ae[Jt],st[Jt]);return We.left=Ze(ae,st,rt,Jt),We.right=Ze(ae,st,Jt+1,$),We}return null}function de(ae,st,rt){var $=rt-st;if($>0){var Tt=st+Math.floor($/2),Jt=de(ae,st,Tt),Ee=ae.head;return Ee.left=Jt,ae.head=ae.head.next,Ee.right=de(ae,Tt+1,rt),Ee}return null}function qt(ae,st,rt,$,Tt){if(!(rt>=$)){for(var Jt=ae[rt+$>>1],Ee=rt-1,Ge=$+1;;){do{Ee++}while(Tt(ae[Ee],Jt)<0);do{Ge--}while(Tt(ae[Ge],Jt)>0);if(Ee>=Ge)break;var We=ae[Ee];ae[Ee]=ae[Ge],ae[Ge]=We,We=st[Ee],st[Ee]=st[Ge],st[Ge]=We}qt(ae,st,rt,Ge,Tt),qt(ae,st,Ge+1,$,Tt)}}var Qt=function(st,rt){return st.ll.x<=rt.x&&rt.x<=st.ur.x&&st.ll.y<=rt.y&&rt.y<=st.ur.y},X=function(st,rt){return rt.ur.x<st.ll.x||st.ur.x<rt.ll.x||rt.ur.y<st.ll.y||st.ur.y<rt.ll.y?null:{ll:{x:st.ll.x<rt.ll.x?rt.ll.x:st.ll.x,y:st.ll.y<rt.ll.y?rt.ll.y:st.ll.y},ur:{x:st.ur.x<rt.ur.x?st.ur.x:rt.ur.x,y:st.ur.y<rt.ur.y?st.ur.y:rt.ur.y}}},J=Number.EPSILON;void 0===J&&(J=Math.pow(2,-52));var Q=J*J,bt=function(st,rt){if(-J<st&&st<J&&-J<rt&&rt<J)return 0;var $=st-rt;return $*$<Q*st*rt?0:st<rt?-1:1},et=function(){function ae(){pe(this,ae),this.reset()}return yt(ae,[{key:"reset",value:function(){this.xRounder=new tt,this.yRounder=new tt}},{key:"round",value:function(rt,$){return{x:this.xRounder.round(rt),y:this.yRounder.round($)}}}]),ae}(),tt=function(){function ae(){pe(this,ae),this.tree=new kt,this.round(0)}return yt(ae,[{key:"round",value:function(rt){var $=this.tree.add(rt),Tt=this.tree.prev($);if(null!==Tt&&0===bt($.key,Tt.key))return this.tree.remove(rt),Tt.key;var Jt=this.tree.next($);return null!==Jt&&0===bt($.key,Jt.key)?(this.tree.remove(rt),Jt.key):rt}}]),ae}(),lt=new et,j=function(st,rt){return st.x*rt.y-st.y*rt.x},re=function(st,rt){return st.x*rt.x+st.y*rt.y},xt=function(st,rt,$){var Ee=j({x:rt.x-st.x,y:rt.y-st.y},{x:$.x-st.x,y:$.y-st.y});return bt(Ee,0)},Ot=function(st){return Math.sqrt(re(st,st))},at=function(st,rt,$){var Tt={x:rt.x-st.x,y:rt.y-st.y},Jt={x:$.x-st.x,y:$.y-st.y};return j(Jt,Tt)/Ot(Jt)/Ot(Tt)},ke=function(st,rt,$){var Tt={x:rt.x-st.x,y:rt.y-st.y},Jt={x:$.x-st.x,y:$.y-st.y};return re(Jt,Tt)/Ot(Jt)/Ot(Tt)},Te=function(st,rt,$){return 0===rt.y?null:{x:st.x+rt.x/rt.y*($-st.y),y:$}},Et=function(st,rt,$){return 0===rt.x?null:{x:$,y:st.y+rt.y/rt.x*($-st.x)}},Pt=function(){function ae(st,rt){pe(this,ae),void 0===st.events?st.events=[this]:st.events.push(this),this.point=st,this.isLeft=rt}return yt(ae,null,[{key:"compare",value:function(rt,$){var Tt=ae.comparePoints(rt.point,$.point);return 0!==Tt?Tt:(rt.point!==$.point&&rt.link($),rt.isLeft!==$.isLeft?rt.isLeft?1:-1:te.compare(rt.segment,$.segment))}},{key:"comparePoints",value:function(rt,$){return rt.x<$.x?-1:rt.x>$.x?1:rt.y<$.y?-1:rt.y>$.y?1:0}}]),yt(ae,[{key:"link",value:function(rt){if(rt.point===this.point)throw new Error("Tried to link already linked events");for(var $=rt.point.events,Tt=0,Jt=$.length;Tt<Jt;Tt++){var Ee=$[Tt];this.point.events.push(Ee),Ee.point=this.point}this.checkForConsuming()}},{key:"checkForConsuming",value:function(){for(var rt=this.point.events.length,$=0;$<rt;$++){var Tt=this.point.events[$];if(void 0===Tt.segment.consumedBy)for(var Jt=$+1;Jt<rt;Jt++){var Ee=this.point.events[Jt];void 0===Ee.consumedBy&&Tt.otherSE.point.events===Ee.otherSE.point.events&&Tt.segment.consume(Ee.segment)}}}},{key:"getAvailableLinkedEvents",value:function(){for(var rt=[],$=0,Tt=this.point.events.length;$<Tt;$++){var Jt=this.point.events[$];Jt!==this&&!Jt.segment.ringOut&&Jt.segment.isInResult()&&rt.push(Jt)}return rt}},{key:"getLeftmostComparator",value:function(rt){var $=this,Tt=new Map,Jt=function(Ge){var We=Ge.otherSE;Tt.set(Ge,{sine:at($.point,rt.point,We.point),cosine:ke($.point,rt.point,We.point)})};return function(Ee,Ge){Tt.has(Ee)||Jt(Ee),Tt.has(Ge)||Jt(Ge);var We=Tt.get(Ee),Le=We.sine,tn=We.cosine,gn=Tt.get(Ge),sr=gn.sine,vn=gn.cosine;return Le>=0&&sr>=0?tn<vn?1:tn>vn?-1:0:Le<0&&sr<0?tn<vn?-1:tn>vn?1:0:sr<Le?-1:sr>Le?1:0}}}]),ae}(),Kt=0,te=function(){function ae(st,rt,$,Tt){pe(this,ae),this.id=++Kt,this.leftSE=st,st.segment=this,st.otherSE=rt,this.rightSE=rt,rt.segment=this,rt.otherSE=st,this.rings=$,this.windings=Tt}return yt(ae,null,[{key:"compare",value:function(rt,$){var Tt=rt.leftSE.point.x,Jt=$.leftSE.point.x,Ee=rt.rightSE.point.x,Ge=$.rightSE.point.x;if(Ge<Tt)return 1;if(Ee<Jt)return-1;var We=rt.leftSE.point.y,Le=$.leftSE.point.y,tn=rt.rightSE.point.y,gn=$.rightSE.point.y;if(Tt<Jt){if(Le<We&&Le<tn)return 1;if(Le>We&&Le>tn)return-1;var sr=rt.comparePoint($.leftSE.point);if(sr<0)return 1;if(sr>0)return-1;var vn=$.comparePoint(rt.rightSE.point);return 0!==vn?vn:-1}if(Tt>Jt){if(We<Le&&We<gn)return-1;if(We>Le&&We>gn)return 1;var Bn=$.comparePoint(rt.leftSE.point);if(0!==Bn)return Bn;var Dn=rt.comparePoint($.rightSE.point);return Dn<0?1:Dn>0?-1:1}if(We<Le)return-1;if(We>Le)return 1;if(Ee<Ge){var Rn=$.comparePoint(rt.rightSE.point);if(0!==Rn)return Rn}if(Ee>Ge){var Ii=rt.comparePoint($.rightSE.point);if(Ii<0)return 1;if(Ii>0)return-1}if(Ee!==Ge){var Gi=tn-We,vo=Ee-Tt,Yi=gn-Le,lo=Ge-Jt;if(Gi>vo&&Yi<lo)return 1;if(Gi<vo&&Yi>lo)return-1}return Ee>Ge?1:Ee<Ge||tn<gn?-1:tn>gn?1:rt.id<$.id?-1:rt.id>$.id?1:0}}]),yt(ae,[{key:"replaceRightSE",value:function(rt){this.rightSE=rt,this.rightSE.segment=this,this.rightSE.otherSE=this.leftSE,this.leftSE.otherSE=this.rightSE}},{key:"bbox",value:function(){var rt=this.leftSE.point.y,$=this.rightSE.point.y;return{ll:{x:this.leftSE.point.x,y:rt<$?rt:$},ur:{x:this.rightSE.point.x,y:rt>$?rt:$}}}},{key:"vector",value:function(){return{x:this.rightSE.point.x-this.leftSE.point.x,y:this.rightSE.point.y-this.leftSE.point.y}}},{key:"isAnEndpoint",value:function(rt){return rt.x===this.leftSE.point.x&&rt.y===this.leftSE.point.y||rt.x===this.rightSE.point.x&&rt.y===this.rightSE.point.y}},{key:"comparePoint",value:function(rt){if(this.isAnEndpoint(rt))return 0;var $=this.leftSE.point,Tt=this.rightSE.point,Jt=this.vector();if($.x===Tt.x)return rt.x===$.x?0:rt.x<$.x?1:-1;if(rt.x===$.x+(rt.y-$.y)/Jt.y*Jt.x)return 0;var Le=$.y+(rt.x-$.x)/Jt.x*Jt.y;return rt.y===Le?0:rt.y<Le?-1:1}},{key:"getIntersection",value:function(rt){var $=this.bbox(),Tt=rt.bbox(),Jt=X($,Tt);if(null===Jt)return null;var Ee=this.leftSE.point,Ge=this.rightSE.point,We=rt.leftSE.point,Le=rt.rightSE.point,tn=Qt($,We)&&0===this.comparePoint(We),gn=Qt(Tt,Ee)&&0===rt.comparePoint(Ee),sr=Qt($,Le)&&0===this.comparePoint(Le),vn=Qt(Tt,Ge)&&0===rt.comparePoint(Ge);if(gn&&tn)return vn&&!sr?Ge:!vn&&sr?Le:null;if(gn)return sr&&Ee.x===Le.x&&Ee.y===Le.y?null:Ee;if(tn)return vn&&Ge.x===We.x&&Ge.y===We.y?null:We;if(vn&&sr)return null;if(vn)return Ge;if(sr)return Le;var Bn=function(st,rt,$,Tt){if(0===rt.x)return Et($,Tt,st.x);if(0===Tt.x)return Et(st,rt,$.x);if(0===rt.y)return Te($,Tt,st.y);if(0===Tt.y)return Te(st,rt,$.y);var Jt=j(rt,Tt);if(0==Jt)return null;var Ee={x:$.x-st.x,y:$.y-st.y},Ge=j(Ee,rt)/Jt,We=j(Ee,Tt)/Jt;return{x:(st.x+We*rt.x+($.x+Ge*Tt.x))/2,y:(st.y+We*rt.y+($.y+Ge*Tt.y))/2}}(Ee,this.vector(),We,rt.vector());return null!==Bn&&Qt(Jt,Bn)?lt.round(Bn.x,Bn.y):null}},{key:"split",value:function(rt){var $=[],Tt=void 0!==rt.events,Jt=new Pt(rt,!0),Ee=new Pt(rt,!1),Ge=this.rightSE;this.replaceRightSE(Ee),$.push(Ee),$.push(Jt);var We=new ae(Jt,Ge,this.rings.slice(),this.windings.slice());return Pt.comparePoints(We.leftSE.point,We.rightSE.point)>0&&We.swapEvents(),Pt.comparePoints(this.leftSE.point,this.rightSE.point)>0&&this.swapEvents(),Tt&&(Jt.checkForConsuming(),Ee.checkForConsuming()),$}},{key:"swapEvents",value:function(){var rt=this.rightSE;this.rightSE=this.leftSE,this.leftSE=rt,this.leftSE.isLeft=!0,this.rightSE.isLeft=!1;for(var $=0,Tt=this.windings.length;$<Tt;$++)this.windings[$]*=-1}},{key:"consume",value:function(rt){for(var $=this,Tt=rt;$.consumedBy;)$=$.consumedBy;for(;Tt.consumedBy;)Tt=Tt.consumedBy;var Jt=ae.compare($,Tt);if(0!==Jt){if(Jt>0){var Ee=$;$=Tt,Tt=Ee}if($.prev===Tt){var Ge=$;$=Tt,Tt=Ge}for(var We=0,Le=Tt.rings.length;We<Le;We++){var tn=Tt.rings[We],gn=Tt.windings[We],sr=$.rings.indexOf(tn);-1===sr?($.rings.push(tn),$.windings.push(gn)):$.windings[sr]+=gn}Tt.rings=null,Tt.windings=null,Tt.consumedBy=$,Tt.leftSE.consumedBy=$.leftSE,Tt.rightSE.consumedBy=$.rightSE}}},{key:"prevInResult",value:function(){return void 0!==this._prevInResult||(this._prevInResult=this.prev?this.prev.isInResult()?this.prev:this.prev.prevInResult():null),this._prevInResult}},{key:"beforeState",value:function(){return void 0!==this._beforeState||(this._beforeState=this.prev?(this.prev.consumedBy||this.prev).afterState():{rings:[],windings:[],multiPolys:[]}),this._beforeState}},{key:"afterState",value:function(){if(void 0!==this._afterState)return this._afterState;var rt=this.beforeState();this._afterState={rings:rt.rings.slice(0),windings:rt.windings.slice(0),multiPolys:[]};for(var $=this._afterState.rings,Tt=this._afterState.windings,Jt=this._afterState.multiPolys,Ee=0,Ge=this.rings.length;Ee<Ge;Ee++){var We=this.rings[Ee],Le=this.windings[Ee],tn=$.indexOf(We);-1===tn?($.push(We),Tt.push(Le)):Tt[tn]+=Le}for(var gn=[],sr=[],vn=0,Bn=$.length;vn<Bn;vn++)if(0!==Tt[vn]){var Dn=$[vn],Rn=Dn.poly;if(-1===sr.indexOf(Rn))if(Dn.isExterior)gn.push(Rn);else{-1===sr.indexOf(Rn)&&sr.push(Rn);var Ii=gn.indexOf(Dn.poly);-1!==Ii&&gn.splice(Ii,1)}}for(var Gi=0,vo=gn.length;Gi<vo;Gi++){var Yi=gn[Gi].multiPoly;-1===Jt.indexOf(Yi)&&Jt.push(Yi)}return this._afterState}},{key:"isInResult",value:function(){if(this.consumedBy)return!1;if(void 0!==this._isInResult)return this._isInResult;var rt=this.beforeState().multiPolys,$=this.afterState().multiPolys;switch(Be.type){case"union":this._isInResult=0===rt.length!=(0===$.length);break;case"intersection":var Ee,Ge;rt.length<$.length?(Ee=rt.length,Ge=$.length):(Ee=$.length,Ge=rt.length),this._isInResult=Ge===Be.numMultiPolys&&Ee<Ge;break;case"xor":var We=Math.abs(rt.length-$.length);this._isInResult=We%2==1;break;case"difference":var Le=function(gn){return 1===gn.length&&gn[0].isSubject};this._isInResult=Le(rt)!==Le($);break;default:throw new Error("Unrecognized operation type found ".concat(Be.type))}return this._isInResult}}],[{key:"fromRing",value:function(rt,$,Tt){var Jt,Ee,Ge,We=Pt.comparePoints(rt,$);if(We<0)Jt=rt,Ee=$,Ge=1;else{if(!(We>0))throw new Error("Tried to create degenerate segment at [".concat(rt.x,", ").concat(rt.y,"]"));Jt=$,Ee=rt,Ge=-1}return new ae(new Pt(Jt,!0),new Pt(Ee,!1),[Tt],[Ge])}}]),ae}(),vt=function(){function ae(st,rt,$){if(pe(this,ae),!Array.isArray(st)||0===st.length)throw new Error("Input geometry is not a valid Polygon or MultiPolygon");if(this.poly=rt,this.isExterior=$,this.segments=[],"number"!=typeof st[0][0]||"number"!=typeof st[0][1])throw new Error("Input geometry is not a valid Polygon or MultiPolygon");var Tt=lt.round(st[0][0],st[0][1]);this.bbox={ll:{x:Tt.x,y:Tt.y},ur:{x:Tt.x,y:Tt.y}};for(var Jt=Tt,Ee=1,Ge=st.length;Ee<Ge;Ee++){if("number"!=typeof st[Ee][0]||"number"!=typeof st[Ee][1])throw new Error("Input geometry is not a valid Polygon or MultiPolygon");var We=lt.round(st[Ee][0],st[Ee][1]);We.x===Jt.x&&We.y===Jt.y||(this.segments.push(te.fromRing(Jt,We,this)),We.x<this.bbox.ll.x&&(this.bbox.ll.x=We.x),We.y<this.bbox.ll.y&&(this.bbox.ll.y=We.y),We.x>this.bbox.ur.x&&(this.bbox.ur.x=We.x),We.y>this.bbox.ur.y&&(this.bbox.ur.y=We.y),Jt=We)}(Tt.x!==Jt.x||Tt.y!==Jt.y)&&this.segments.push(te.fromRing(Jt,Tt,this))}return yt(ae,[{key:"getSweepEvents",value:function(){for(var rt=[],$=0,Tt=this.segments.length;$<Tt;$++){var Jt=this.segments[$];rt.push(Jt.leftSE),rt.push(Jt.rightSE)}return rt}}]),ae}(),Se=function(){function ae(st,rt){if(pe(this,ae),!Array.isArray(st))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");this.exteriorRing=new vt(st[0],this,!0),this.bbox={ll:{x:this.exteriorRing.bbox.ll.x,y:this.exteriorRing.bbox.ll.y},ur:{x:this.exteriorRing.bbox.ur.x,y:this.exteriorRing.bbox.ur.y}},this.interiorRings=[];for(var $=1,Tt=st.length;$<Tt;$++){var Jt=new vt(st[$],this,!1);Jt.bbox.ll.x<this.bbox.ll.x&&(this.bbox.ll.x=Jt.bbox.ll.x),Jt.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=Jt.bbox.ll.y),Jt.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=Jt.bbox.ur.x),Jt.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=Jt.bbox.ur.y),this.interiorRings.push(Jt)}this.multiPoly=rt}return yt(ae,[{key:"getSweepEvents",value:function(){for(var rt=this.exteriorRing.getSweepEvents(),$=0,Tt=this.interiorRings.length;$<Tt;$++)for(var Jt=this.interiorRings[$].getSweepEvents(),Ee=0,Ge=Jt.length;Ee<Ge;Ee++)rt.push(Jt[Ee]);return rt}}]),ae}(),Fe=function(){function ae(st,rt){if(pe(this,ae),!Array.isArray(st))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");try{"number"==typeof st[0][0][0]&&(st=[st])}catch(Ee){}this.polys=[],this.bbox={ll:{x:Number.POSITIVE_INFINITY,y:Number.POSITIVE_INFINITY},ur:{x:Number.NEGATIVE_INFINITY,y:Number.NEGATIVE_INFINITY}};for(var $=0,Tt=st.length;$<Tt;$++){var Jt=new Se(st[$],this);Jt.bbox.ll.x<this.bbox.ll.x&&(this.bbox.ll.x=Jt.bbox.ll.x),Jt.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=Jt.bbox.ll.y),Jt.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=Jt.bbox.ur.x),Jt.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=Jt.bbox.ur.y),this.polys.push(Jt)}this.isSubject=rt}return yt(ae,[{key:"getSweepEvents",value:function(){for(var rt=[],$=0,Tt=this.polys.length;$<Tt;$++)for(var Jt=this.polys[$].getSweepEvents(),Ee=0,Ge=Jt.length;Ee<Ge;Ee++)rt.push(Jt[Ee]);return rt}}]),ae}(),wr=function(){function ae(st){pe(this,ae),this.events=st;for(var rt=0,$=st.length;rt<$;rt++)st[rt].segment.ringOut=this;this.poly=null}return yt(ae,null,[{key:"factory",value:function(rt){for(var $=[],Tt=0,Jt=rt.length;Tt<Jt;Tt++){var Ee=rt[Tt];if(Ee.isInResult()&&!Ee.ringOut){for(var Ge=null,We=Ee.leftSE,Le=Ee.rightSE,tn=[We],gn=We.point,sr=[];Ge=We,tn.push(We=Le),We.point!==gn;)for(;;){var vn=We.getAvailableLinkedEvents();if(0===vn.length){var Bn=tn[0].point,Dn=tn[tn.length-1].point;throw new Error("Unable to complete output ring starting at [".concat(Bn.x,",")+" ".concat(Bn.y,"]. Last matching segment found ends at")+" [".concat(Dn.x,", ").concat(Dn.y,"]."))}if(1===vn.length){Le=vn[0].otherSE;break}for(var Rn=null,Ii=0,Gi=sr.length;Ii<Gi;Ii++)if(sr[Ii].point===We.point){Rn=Ii;break}if(null===Rn){sr.push({index:tn.length,point:We.point});var lo=We.getLeftmostComparator(Ge);Le=vn.sort(lo)[0].otherSE;break}var vo=sr.splice(Rn)[0],Yi=tn.splice(vo.index);Yi.unshift(Yi[0].otherSE),$.push(new ae(Yi.reverse()))}$.push(new ae(tn))}}return $}}]),yt(ae,[{key:"getGeom",value:function(){for(var rt=this.events[0].point,$=[rt],Tt=1,Jt=this.events.length-1;Tt<Jt;Tt++){var Ee=this.events[Tt].point;0!==xt(Ee,rt,this.events[Tt+1].point)&&($.push(Ee),rt=Ee)}if(1===$.length)return null;0===xt($[0],rt,$[1])&&$.shift(),$.push($[0]);for(var tn=this.isExteriorRing()?1:-1,gn=this.isExteriorRing()?0:$.length-1,sr=this.isExteriorRing()?$.length:-1,vn=[],Bn=gn;Bn!=sr;Bn+=tn)vn.push([$[Bn].x,$[Bn].y]);return vn}},{key:"isExteriorRing",value:function(){if(void 0===this._isExteriorRing){var rt=this.enclosingRing();this._isExteriorRing=!rt||!rt.isExteriorRing()}return this._isExteriorRing}},{key:"enclosingRing",value:function(){return void 0===this._enclosingRing&&(this._enclosingRing=this._calcEnclosingRing()),this._enclosingRing}},{key:"_calcEnclosingRing",value:function(){for(var rt=this.events[0],$=1,Tt=this.events.length;$<Tt;$++){var Jt=this.events[$];Pt.compare(rt,Jt)>0&&(rt=Jt)}for(var Ee=rt.segment.prevInResult(),Ge=Ee?Ee.prevInResult():null;;){if(!Ee)return null;if(!Ge)return Ee.ringOut;if(Ge.ringOut!==Ee.ringOut)return Ge.ringOut.enclosingRing()!==Ee.ringOut?Ee.ringOut:Ee.ringOut.enclosingRing();Ee=Ge.prevInResult(),Ge=Ee?Ee.prevInResult():null}}}]),ae}(),De=function(){function ae(st){pe(this,ae),this.exteriorRing=st,st.poly=this,this.interiorRings=[]}return yt(ae,[{key:"addInterior",value:function(rt){this.interiorRings.push(rt),rt.poly=this}},{key:"getGeom",value:function(){var rt=[this.exteriorRing.getGeom()];if(null===rt[0])return null;for(var $=0,Tt=this.interiorRings.length;$<Tt;$++){var Jt=this.interiorRings[$].getGeom();null!==Jt&&rt.push(Jt)}return rt}}]),ae}(),Xr=function(){function ae(st){pe(this,ae),this.rings=st,this.polys=this._composePolys(st)}return yt(ae,[{key:"getGeom",value:function(){for(var rt=[],$=0,Tt=this.polys.length;$<Tt;$++){var Jt=this.polys[$].getGeom();null!==Jt&&rt.push(Jt)}return rt}},{key:"_composePolys",value:function(rt){for(var $=[],Tt=0,Jt=rt.length;Tt<Jt;Tt++){var Ee=rt[Tt];if(!Ee.poly)if(Ee.isExteriorRing())$.push(new De(Ee));else{var Ge=Ee.enclosingRing();Ge.poly||$.push(new De(Ge)),Ge.poly.addInterior(Ee)}}return $}}]),ae}(),Er=function(){function ae(st){var rt=arguments.length>1&&void 0!==arguments[1]?arguments[1]:te.compare;pe(this,ae),this.queue=st,this.tree=new kt(rt),this.segments=[]}return yt(ae,[{key:"process",value:function(rt){var $=rt.segment,Tt=[];if(rt.consumedBy)return rt.isLeft?this.queue.remove(rt.otherSE):this.tree.remove($),Tt;var Jt=rt.isLeft?this.tree.insert($):this.tree.find($);if(!Jt)throw new Error("Unable to find segment #".concat($.id," ")+"[".concat($.leftSE.point.x,", ").concat($.leftSE.point.y,"] -> ")+"[".concat($.rightSE.point.x,", ").concat($.rightSE.point.y,"] ")+"in SweepLine tree. Please submit a bug report.");for(var Ee=Jt,Ge=Jt,We=void 0,Le=void 0;void 0===We;)null===(Ee=this.tree.prev(Ee))?We=null:void 0===Ee.key.consumedBy&&(We=Ee.key);for(;void 0===Le;)null===(Ge=this.tree.next(Ge))?Le=null:void 0===Ge.key.consumedBy&&(Le=Ge.key);if(rt.isLeft){var tn=null;if(We){var gn=We.getIntersection($);if(null!==gn&&($.isAnEndpoint(gn)||(tn=gn),!We.isAnEndpoint(gn)))for(var sr=this._splitSafely(We,gn),vn=0,Bn=sr.length;vn<Bn;vn++)Tt.push(sr[vn])}var Dn=null;if(Le){var Rn=Le.getIntersection($);if(null!==Rn&&($.isAnEndpoint(Rn)||(Dn=Rn),!Le.isAnEndpoint(Rn)))for(var Ii=this._splitSafely(Le,Rn),Gi=0,vo=Ii.length;Gi<vo;Gi++)Tt.push(Ii[Gi])}if(null!==tn||null!==Dn){var Yi;Yi=null===tn?Dn:null===Dn||Pt.comparePoints(tn,Dn)<=0?tn:Dn,this.queue.remove($.rightSE),Tt.push($.rightSE);for(var ei=$.split(Yi),_o=0,ki=ei.length;_o<ki;_o++)Tt.push(ei[_o])}Tt.length>0?(this.tree.remove($),Tt.push(rt)):(this.segments.push($),$.prev=We)}else{if(We&&Le){var Je=We.getIntersection(Le);if(null!==Je){if(!We.isAnEndpoint(Je))for(var di=this._splitSafely(We,Je),V=0,Y=di.length;V<Y;V++)Tt.push(di[V]);if(!Le.isAnEndpoint(Je))for(var it=this._splitSafely(Le,Je),ht=0,Lt=it.length;ht<Lt;ht++)Tt.push(it[ht])}}this.tree.remove($)}return Tt}},{key:"_splitSafely",value:function(rt,$){this.tree.remove(rt);var Tt=rt.rightSE;this.queue.remove(Tt);var Jt=rt.split($);return Jt.push(Tt),void 0===rt.consumedBy&&this.tree.insert(rt),Jt}}]),ae}(),Yr="undefined"!=typeof process&&process.env.POLYGON_CLIPPING_MAX_QUEUE_SIZE||1e6,Cr="undefined"!=typeof process&&process.env.POLYGON_CLIPPING_MAX_SWEEPLINE_SEGMENTS||1e6,Be=new(function(){function ae(){pe(this,ae)}return yt(ae,[{key:"run",value:function(rt,$,Tt){Be.type=rt,lt.reset();for(var Jt=[new Fe($,!0)],Ee=0,Ge=Tt.length;Ee<Ge;Ee++)Jt.push(new Fe(Tt[Ee],!1));if(Be.numMultiPolys=Jt.length,"difference"===Be.type)for(var We=Jt[0],Le=1;Le<Jt.length;)null!==X(Jt[Le].bbox,We.bbox)?Le++:Jt.splice(Le,1);if("intersection"===Be.type)for(var tn=0,gn=Jt.length;tn<gn;tn++)for(var sr=Jt[tn],vn=tn+1,Bn=Jt.length;vn<Bn;vn++)if(null===X(sr.bbox,Jt[vn].bbox))return[];for(var Dn=new kt(Pt.compare),Rn=0,Ii=Jt.length;Rn<Ii;Rn++)for(var Gi=Jt[Rn].getSweepEvents(),vo=0,Yi=Gi.length;vo<Yi;vo++)if(Dn.insert(Gi[vo]),Dn.size>Yr)throw new Error("Infinite loop when putting segment endpoints in a priority queue (queue size too big). Please file a bug report.");for(var lo=new Er(Dn),ei=Dn.size,_o=Dn.pop();_o;){var ki=_o.key;if(Dn.size===ei){var Je=ki.segment;throw new Error("Unable to pop() ".concat(ki.isLeft?"left":"right"," SweepEvent ")+"[".concat(ki.point.x,", ").concat(ki.point.y,"] from segment #").concat(Je.id," ")+"[".concat(Je.leftSE.point.x,", ").concat(Je.leftSE.point.y,"] -> ")+"[".concat(Je.rightSE.point.x,", ").concat(Je.rightSE.point.y,"] from queue. ")+"Please file a bug report.")}if(Dn.size>Yr)throw new Error("Infinite loop when passing sweep line over endpoints (queue size too big). Please file a bug report.");if(lo.segments.length>Cr)throw new Error("Infinite loop when passing sweep line over endpoints (too many sweep line segments). Please file a bug report.");for(var di=lo.process(ki),V=0,Y=di.length;V<Y;V++){var it=di[V];void 0===it.consumedBy&&Dn.insert(it)}ei=Dn.size,_o=Dn.pop()}lt.reset();var ht=wr.factory(lo.segments);return new Xr(ht).getGeom()}}]),ae}());return{union:function(st){for(var rt=arguments.length,$=new Array(rt>1?rt-1:0),Tt=1;Tt<rt;Tt++)$[Tt-1]=arguments[Tt];return Be.run("union",st,$)},intersection:function(st){for(var rt=arguments.length,$=new Array(rt>1?rt-1:0),Tt=1;Tt<rt;Tt++)$[Tt-1]=arguments[Tt];return Be.run("intersection",st,$)},xor:function(st){for(var rt=arguments.length,$=new Array(rt>1?rt-1:0),Tt=1;Tt<rt;Tt++)$[Tt-1]=arguments[Tt];return Be.run("xor",st,$)},difference:function(st){for(var rt=arguments.length,$=new Array(rt>1?rt-1:0),Tt=1;Tt<rt;Tt++)$[Tt-1]=arguments[Tt];return Be.run("difference",st,$)}}}()},3036:function(He){He.exports=function(){"use strict";function pe(qt,Qt,X,J,Q){!function bt(et,tt,lt,j,re){for(;j>lt;){if(j-lt>600){var xt=j-lt+1,Ot=tt-lt+1,at=Math.log(xt),ke=.5*Math.exp(2*at/3),Te=.5*Math.sqrt(at*ke*(xt-ke)/xt)*(Ot-xt/2<0?-1:1);bt(et,tt,Math.max(lt,Math.floor(tt-Ot*ke/xt+Te)),Math.min(j,Math.floor(tt+(xt-Ot)*ke/xt+Te)),re)}var Pt=et[tt],Kt=lt,te=j;for(wt(et,lt,tt),re(et[j],Pt)>0&&wt(et,lt,j);Kt<te;){for(wt(et,Kt,te),Kt++,te--;re(et[Kt],Pt)<0;)Kt++;for(;re(et[te],Pt)>0;)te--}0===re(et[lt],Pt)?wt(et,lt,te):wt(et,++te,j),te<=tt&&(lt=te+1),tt<=te&&(j=te-1)}}(qt,Qt,X||0,J||qt.length-1,Q||yt)}function wt(qt,Qt,X){var J=qt[Qt];qt[Qt]=qt[X],qt[X]=J}function yt(qt,Qt){return qt<Qt?-1:qt>Qt?1:0}var b=function(qt){void 0===qt&&(qt=9),this._maxEntries=Math.max(4,qt),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()};function v(qt,Qt,X){if(!X)return Qt.indexOf(qt);for(var J=0;J<Qt.length;J++)if(X(qt,Qt[J]))return J;return-1}function Bt(qt,Qt){ft(qt,0,qt.children.length,Qt,qt)}function ft(qt,Qt,X,J,Q){Q||(Q=de(null)),Q.minX=1/0,Q.minY=1/0,Q.maxX=-1/0,Q.maxY=-1/0;for(var bt=Qt;bt<X;bt++){var et=qt.children[bt];St(Q,qt.leaf?J(et):et)}return Q}function St(qt,Qt){return qt.minX=Math.min(qt.minX,Qt.minX),qt.minY=Math.min(qt.minY,Qt.minY),qt.maxX=Math.max(qt.maxX,Qt.maxX),qt.maxY=Math.max(qt.maxY,Qt.maxY),qt}function Ft(qt,Qt){return qt.minX-Qt.minX}function le(qt,Qt){return qt.minY-Qt.minY}function kt(qt){return(qt.maxX-qt.minX)*(qt.maxY-qt.minY)}function Ze(qt){return qt.maxX-qt.minX+(qt.maxY-qt.minY)}function ye(qt,Qt){return qt.minX<=Qt.minX&&qt.minY<=Qt.minY&&Qt.maxX<=qt.maxX&&Qt.maxY<=qt.maxY}function ue(qt,Qt){return Qt.minX<=qt.maxX&&Qt.minY<=qt.maxY&&Qt.maxX>=qt.minX&&Qt.maxY>=qt.minY}function de(qt){return{children:qt,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function Ye(qt,Qt,X,J,Q){for(var bt=[Qt,X];bt.length;)if(!((X=bt.pop())-(Qt=bt.pop())<=J)){var et=Qt+Math.ceil((X-Qt)/J/2)*J;pe(qt,et,Qt,X,Q),bt.push(Qt,et,et,X)}}return b.prototype.all=function(){return this._all(this.data,[])},b.prototype.search=function(qt){var Qt=this.data,X=[];if(!ue(qt,Qt))return X;for(var J=this.toBBox,Q=[];Qt;){for(var bt=0;bt<Qt.children.length;bt++){var et=Qt.children[bt],tt=Qt.leaf?J(et):et;ue(qt,tt)&&(Qt.leaf?X.push(et):ye(qt,tt)?this._all(et,X):Q.push(et))}Qt=Q.pop()}return X},b.prototype.collides=function(qt){var Qt=this.data;if(!ue(qt,Qt))return!1;for(var X=[];Qt;){for(var J=0;J<Qt.children.length;J++){var Q=Qt.children[J],bt=Qt.leaf?this.toBBox(Q):Q;if(ue(qt,bt)){if(Qt.leaf||ye(qt,bt))return!0;X.push(Q)}}Qt=X.pop()}return!1},b.prototype.load=function(qt){if(!qt||!qt.length)return this;if(qt.length<this._minEntries){for(var Qt=0;Qt<qt.length;Qt++)this.insert(qt[Qt]);return this}var X=this._build(qt.slice(),0,qt.length-1,0);if(this.data.children.length)if(this.data.height===X.height)this._splitRoot(this.data,X);else{if(this.data.height<X.height){var J=this.data;this.data=X,X=J}this._insert(X,this.data.height-X.height-1,!0)}else this.data=X;return this},b.prototype.insert=function(qt){return qt&&this._insert(qt,this.data.height-1),this},b.prototype.clear=function(){return this.data=de([]),this},b.prototype.remove=function(qt,Qt){if(!qt)return this;for(var X,J,Q,bt=this.data,et=this.toBBox(qt),tt=[],lt=[];bt||tt.length;){if(bt||(bt=tt.pop(),J=tt[tt.length-1],X=lt.pop(),Q=!0),bt.leaf){var j=v(qt,bt.children,Qt);if(-1!==j)return bt.children.splice(j,1),tt.push(bt),this._condense(tt),this}Q||bt.leaf||!ye(bt,et)?J?(X++,bt=J.children[X],Q=!1):bt=null:(tt.push(bt),lt.push(X),X=0,J=bt,bt=bt.children[0])}return this},b.prototype.toBBox=function(qt){return qt},b.prototype.compareMinX=function(qt,Qt){return qt.minX-Qt.minX},b.prototype.compareMinY=function(qt,Qt){return qt.minY-Qt.minY},b.prototype.toJSON=function(){return this.data},b.prototype.fromJSON=function(qt){return this.data=qt,this},b.prototype._all=function(qt,Qt){for(var X=[];qt;)qt.leaf?Qt.push.apply(Qt,qt.children):X.push.apply(X,qt.children),qt=X.pop();return Qt},b.prototype._build=function(qt,Qt,X,J){var Q,bt=X-Qt+1,et=this._maxEntries;if(bt<=et)return Bt(Q=de(qt.slice(Qt,X+1)),this.toBBox),Q;J||(J=Math.ceil(Math.log(bt)/Math.log(et)),et=Math.ceil(bt/Math.pow(et,J-1))),(Q=de([])).leaf=!1,Q.height=J;var tt=Math.ceil(bt/et),lt=tt*Math.ceil(Math.sqrt(et));Ye(qt,Qt,X,lt,this.compareMinX);for(var j=Qt;j<=X;j+=lt){var re=Math.min(j+lt-1,X);Ye(qt,j,re,tt,this.compareMinY);for(var xt=j;xt<=re;xt+=tt){var Ot=Math.min(xt+tt-1,re);Q.children.push(this._build(qt,xt,Ot,J-1))}}return Bt(Q,this.toBBox),Q},b.prototype._chooseSubtree=function(qt,Qt,X,J){for(;J.push(Qt),!Qt.leaf&&J.length-1!==X;){for(var Q=1/0,bt=1/0,et=void 0,tt=0;tt<Qt.children.length;tt++){var lt=Qt.children[tt],j=kt(lt),re=(xt=qt,Ot=lt,(Math.max(Ot.maxX,xt.maxX)-Math.min(Ot.minX,xt.minX))*(Math.max(Ot.maxY,xt.maxY)-Math.min(Ot.minY,xt.minY))-j);re<bt?(bt=re,Q=j<Q?j:Q,et=lt):re===bt&&j<Q&&(Q=j,et=lt)}Qt=et||Qt.children[0]}var xt,Ot;return Qt},b.prototype._insert=function(qt,Qt,X){var J=X?qt:this.toBBox(qt),Q=[],bt=this._chooseSubtree(J,this.data,Qt,Q);for(bt.children.push(qt),St(bt,J);Qt>=0&&Q[Qt].children.length>this._maxEntries;)this._split(Q,Qt),Qt--;this._adjustParentBBoxes(J,Q,Qt)},b.prototype._split=function(qt,Qt){var X=qt[Qt],J=X.children.length,Q=this._minEntries;this._chooseSplitAxis(X,Q,J);var bt=this._chooseSplitIndex(X,Q,J),et=de(X.children.splice(bt,X.children.length-bt));et.height=X.height,et.leaf=X.leaf,Bt(X,this.toBBox),Bt(et,this.toBBox),Qt?qt[Qt-1].children.push(et):this._splitRoot(X,et)},b.prototype._splitRoot=function(qt,Qt){this.data=de([qt,Qt]),this.data.height=qt.height+1,this.data.leaf=!1,Bt(this.data,this.toBBox)},b.prototype._chooseSplitIndex=function(qt,Qt,X){for(var J,Q,bt,et,tt,lt,j,re=1/0,xt=1/0,Ot=Qt;Ot<=X-Qt;Ot++){var at=ft(qt,0,Ot,this.toBBox),ke=ft(qt,Ot,X,this.toBBox),Te=(Q=at,bt=ke,void 0,void 0,void 0,void 0,et=Math.max(Q.minX,bt.minX),tt=Math.max(Q.minY,bt.minY),lt=Math.min(Q.maxX,bt.maxX),j=Math.min(Q.maxY,bt.maxY),Math.max(0,lt-et)*Math.max(0,j-tt)),Et=kt(at)+kt(ke);Te<re?(re=Te,J=Ot,xt=Et<xt?Et:xt):Te===re&&Et<xt&&(xt=Et,J=Ot)}return J||X-Qt},b.prototype._chooseSplitAxis=function(qt,Qt,X){var J=qt.leaf?this.compareMinX:Ft,Q=qt.leaf?this.compareMinY:le;this._allDistMargin(qt,Qt,X,J)<this._allDistMargin(qt,Qt,X,Q)&&qt.children.sort(J)},b.prototype._allDistMargin=function(qt,Qt,X,J){qt.children.sort(J);for(var Q=this.toBBox,bt=ft(qt,0,Qt,Q),et=ft(qt,X-Qt,X,Q),tt=Ze(bt)+Ze(et),lt=Qt;lt<X-Qt;lt++){var j=qt.children[lt];St(bt,qt.leaf?Q(j):j),tt+=Ze(bt)}for(var re=X-Qt-1;re>=Qt;re--){var xt=qt.children[re];St(et,qt.leaf?Q(xt):xt),tt+=Ze(et)}return tt},b.prototype._adjustParentBBoxes=function(qt,Qt,X){for(var J=X;J>=0;J--)St(Qt[J],qt)},b.prototype._condense=function(qt){for(var Qt=qt.length-1,X=void 0;Qt>=0;Qt--)0===qt[Qt].children.length?Qt>0?(X=qt[Qt-1].children).splice(X.indexOf(qt[Qt]),1):this.clear():Bt(qt[Qt],this.toBBox)},b}()},565:He=>{"use strict";var pe=Object,wt=TypeError;He.exports=function(){if(null!=this&&this!==pe(this))throw new wt("RegExp.prototype.flags getter called on non-object");var b="";return this.global&&(b+="g"),this.ignoreCase&&(b+="i"),this.multiline&&(b+="m"),this.dotAll&&(b+="s"),this.unicode&&(b+="u"),this.sticky&&(b+="y"),b}},437:(He,pe,wt)=>{"use strict";var yt=wt(6886),b=wt(44),v=wt(565),Bt=wt(3880),ft=wt(9129),St=b(v);yt(St,{getPolyfill:Bt,implementation:v,shim:ft}),He.exports=St},3880:(He,pe,wt)=>{"use strict";var yt=wt(565),b=wt(6886).supportsDescriptors,v=Object.getOwnPropertyDescriptor,Bt=TypeError;He.exports=function(){if(!b)throw new Bt("RegExp.prototype.flags requires a true ES5 environment that supports property descriptors");if("gim"===/a/gim.flags){var St=v(RegExp.prototype,"flags");if(St&&"function"==typeof St.get&&"boolean"==typeof/a/.dotAll)return St.get}return yt}},9129:(He,pe,wt)=>{"use strict";var yt=wt(6886).supportsDescriptors,b=wt(3880),v=Object.getOwnPropertyDescriptor,Bt=Object.defineProperty,ft=TypeError,St=Object.getPrototypeOf,Ft=/a/;He.exports=function(){if(!yt||!St)throw new ft("RegExp.prototype.flags requires a true ES5 environment that supports property descriptors");var kt=b(),Ze=St(Ft),ye=v(Ze,"flags");return(!ye||ye.get!==kt)&&Bt(Ze,"flags",{configurable:!0,enumerable:!1,get:kt}),kt}},5322:function(He,pe){!function(wt){"use strict";const yt=134217729;function v(de,Ye,qt,Qt,X){let J,Q,bt,et,tt=Ye[0],lt=Qt[0],j=0,re=0;lt>tt==lt>-tt?(J=tt,tt=Ye[++j]):(J=lt,lt=Qt[++re]);let xt=0;if(j<de&&re<qt)for(lt>tt==lt>-tt?(bt=J-((Q=tt+J)-tt),tt=Ye[++j]):(bt=J-((Q=lt+J)-lt),lt=Qt[++re]),J=Q,0!==bt&&(X[xt++]=bt);j<de&&re<qt;)lt>tt==lt>-tt?(bt=J-((Q=J+tt)-(et=Q-J))+(tt-et),tt=Ye[++j]):(bt=J-((Q=J+lt)-(et=Q-J))+(lt-et),lt=Qt[++re]),J=Q,0!==bt&&(X[xt++]=bt);for(;j<de;)bt=J-((Q=J+tt)-(et=Q-J))+(tt-et),tt=Ye[++j],J=Q,0!==bt&&(X[xt++]=bt);for(;re<qt;)bt=J-((Q=J+lt)-(et=Q-J))+(lt-et),lt=Qt[++re],J=Q,0!==bt&&(X[xt++]=bt);return 0===J&&0!==xt||(X[xt++]=J),xt}function Bt(de){return new Float64Array(de)}const le=Bt(4),kt=Bt(8),Ze=Bt(12),ye=Bt(16),ue=Bt(4);wt.orient2d=function(de,Ye,qt,Qt,X,J){const Q=(Ye-J)*(qt-X),bt=(de-X)*(Qt-J),et=Q-bt;if(0===Q||0===bt||Q>0!=bt>0)return et;const tt=Math.abs(Q+bt);return Math.abs(et)>=33306690738754716e-32*tt?et:-function(lt,j,re,xt,Ot,at,ke){let Te,Et,ne,Pt,Kt,te,vt,Se,Fe,wr,De,Xr,Er,Yr,Cr,Mr,Be,ti;const In=lt-Ot,$n=re-Ot,li=j-at,fi=xt-at;Kt=(Cr=(Se=In-(vt=(te=yt*In)-(te-In)))*(wr=fi-(Fe=(te=yt*fi)-(te-fi)))-((Yr=In*fi)-vt*Fe-Se*Fe-vt*wr))-(De=Cr-(Be=(Se=li-(vt=(te=yt*li)-(te-li)))*(wr=$n-(Fe=(te=yt*$n)-(te-$n)))-((Mr=li*$n)-vt*Fe-Se*Fe-vt*wr))),le[0]=Cr-(De+Kt)+(Kt-Be),Kt=(Er=Yr-((Xr=Yr+De)-(Kt=Xr-Yr))+(De-Kt))-(De=Er-Mr),le[1]=Er-(De+Kt)+(Kt-Mr),Kt=(ti=Xr+De)-Xr,le[2]=Xr-(ti-Kt)+(De-Kt),le[3]=ti;let ae=function(Jt,Ee){let Ge=Ee[0];for(let We=1;We<4;We++)Ge+=Ee[We];return Ge}(0,le),st=22204460492503146e-32*ke;if(ae>=st||-ae>=st||(Te=lt-(In+(Kt=lt-In))+(Kt-Ot),ne=re-($n+(Kt=re-$n))+(Kt-Ot),Et=j-(li+(Kt=j-li))+(Kt-at),Pt=xt-(fi+(Kt=xt-fi))+(Kt-at),0===Te&&0===Et&&0===ne&&0===Pt)||(st=11093356479670487e-47*ke+33306690738754706e-32*Math.abs(ae),(ae+=In*Pt+fi*Te-(li*ne+$n*Et))>=st||-ae>=st))return ae;Kt=(Cr=(Se=Te-(vt=(te=yt*Te)-(te-Te)))*(wr=fi-(Fe=(te=yt*fi)-(te-fi)))-((Yr=Te*fi)-vt*Fe-Se*Fe-vt*wr))-(De=Cr-(Be=(Se=Et-(vt=(te=yt*Et)-(te-Et)))*(wr=$n-(Fe=(te=yt*$n)-(te-$n)))-((Mr=Et*$n)-vt*Fe-Se*Fe-vt*wr))),ue[0]=Cr-(De+Kt)+(Kt-Be),Kt=(Er=Yr-((Xr=Yr+De)-(Kt=Xr-Yr))+(De-Kt))-(De=Er-Mr),ue[1]=Er-(De+Kt)+(Kt-Mr),Kt=(ti=Xr+De)-Xr,ue[2]=Xr-(ti-Kt)+(De-Kt),ue[3]=ti;const rt=v(4,le,4,ue,kt);Kt=(Cr=(Se=In-(vt=(te=yt*In)-(te-In)))*(wr=Pt-(Fe=(te=yt*Pt)-(te-Pt)))-((Yr=In*Pt)-vt*Fe-Se*Fe-vt*wr))-(De=Cr-(Be=(Se=li-(vt=(te=yt*li)-(te-li)))*(wr=ne-(Fe=(te=yt*ne)-(te-ne)))-((Mr=li*ne)-vt*Fe-Se*Fe-vt*wr))),ue[0]=Cr-(De+Kt)+(Kt-Be),Kt=(Er=Yr-((Xr=Yr+De)-(Kt=Xr-Yr))+(De-Kt))-(De=Er-Mr),ue[1]=Er-(De+Kt)+(Kt-Mr),Kt=(ti=Xr+De)-Xr,ue[2]=Xr-(ti-Kt)+(De-Kt),ue[3]=ti;const $=v(rt,kt,4,ue,Ze);Kt=(Cr=(Se=Te-(vt=(te=yt*Te)-(te-Te)))*(wr=Pt-(Fe=(te=yt*Pt)-(te-Pt)))-((Yr=Te*Pt)-vt*Fe-Se*Fe-vt*wr))-(De=Cr-(Be=(Se=Et-(vt=(te=yt*Et)-(te-Et)))*(wr=ne-(Fe=(te=yt*ne)-(te-ne)))-((Mr=Et*ne)-vt*Fe-Se*Fe-vt*wr))),ue[0]=Cr-(De+Kt)+(Kt-Be),Kt=(Er=Yr-((Xr=Yr+De)-(Kt=Xr-Yr))+(De-Kt))-(De=Er-Mr),ue[1]=Er-(De+Kt)+(Kt-Mr),Kt=(ti=Xr+De)-Xr,ue[2]=Xr-(ti-Kt)+(De-Kt),ue[3]=ti;const Tt=v($,Ze,4,ue,ye);return ye[Tt-1]}(de,Ye,qt,Qt,X,J,tt)},wt.orient2dfast=function(de,Ye,qt,Qt,X,J){return(Ye-J)*(qt-X)-(de-X)*(Qt-J)},Object.defineProperty(wt,"__esModule",{value:!0})}(pe)},6257:He=>{"use strict";He.exports={eudist:function(wt,yt,b){for(var v=wt.length,Bt=0,ft=0;ft<v;ft++){var St=(wt[ft]||0)-(yt[ft]||0);Bt+=St*St}return b?Math.sqrt(Bt):Bt},mandist:function(wt,yt,b){for(var v=wt.length,Bt=0,ft=0;ft<v;ft++)Bt+=Math.abs((wt[ft]||0)-(yt[ft]||0));return b?Math.sqrt(Bt):Bt},dist:function(wt,yt,b){var v=Math.abs(wt-yt);return b?v:v*v}}},6019:(He,pe,wt)=>{"use strict";var yt=wt(6257),b=yt.eudist,v=yt.dist;He.exports={kmrand:function(ft,St){for(var Ft={},le=[],kt=St<<2,Ze=ft.length,ye=ft[0].length>0;le.length<St&&kt-- >0;){var ue=ft[Math.floor(Math.random()*Ze)],de=ye?ue.join("_"):""+ue;Ft[de]||(Ft[de]=!0,le.push(ue))}if(le.length<St)throw new Error("Error initializating clusters");return le},kmpp:function(ft,St){var Ft=ft[0].length?b:v,le=[],kt=ft.length,Ze=ft[0].length>0,ue=ft[Math.floor(Math.random()*kt)];for(Ze&&ue.join("_"),le.push(ue);le.length<St;){for(var Ye=[],qt=le.length,Qt=0,X=[],J=0;J<kt;J++){for(var Q=1/0,bt=0;bt<qt;bt++){var et=Ft(ft[J],le[bt]);et<=Q&&(Q=et)}Ye[J]=Q}for(var tt=0;tt<kt;tt++)Qt+=Ye[tt];for(var lt=0;lt<kt;lt++)X[lt]={i:lt,v:ft[lt],pr:Ye[lt]/Qt,cs:0};X.sort(function(Ot,at){return Ot.pr-at.pr}),X[0].cs=X[0].pr;for(var j=1;j<kt;j++)X[j].cs=X[j-1].cs+X[j].pr;for(var re=Math.random(),xt=0;xt<kt-1&&X[xt++].cs<re;);le.push(X[xt-1].v)}return le}}},3212:(He,pe,wt)=>{"use strict";var yt=wt(6257),b=wt(6019),v=yt.eudist,St=b.kmrand,Ft=b.kmpp;function kt(ye,ue,de){de=de||[];for(var Ye=0;Ye<ye;Ye++)de[Ye]=ue;return de}He.exports=function(ye,ue,de,Ye){var qt=[],Qt=[],X=[],J=[],Q=!1,bt=Ye||1e4,et=ye.length,tt=ye[0].length,lt=tt>0,j=[];if(de)qt="kmrand"==de?St(ye,ue):"kmpp"==de?Ft(ye,ue):de;else for(var re={};qt.length<ue;){var xt=Math.floor(Math.random()*et);re[xt]||(re[xt]=!0,qt.push(ye[xt]))}do{kt(ue,0,j);for(var Ot=0;Ot<et;Ot++){for(var at=1/0,ke=0,Te=0;Te<ue;Te++)(J=lt?v(ye[Ot],qt[Te]):Math.abs(ye[Ot]-qt[Te]))<=at&&(at=J,ke=Te);X[Ot]=ke,j[ke]++}for(var Et=[],Pt=(Qt=[],0);Pt<ue;Pt++)Et[Pt]=lt?kt(tt,0,Et[Pt]):0,Qt[Pt]=qt[Pt];if(lt){for(var Kt=0;Kt<ue;Kt++)qt[Kt]=[];for(var te=0;te<et;te++)for(var Se=Et[X[te]],Fe=ye[te],wr=0;wr<tt;wr++)Se[wr]+=Fe[wr];Q=!0;for(var De=0;De<ue;De++){for(var Xr=qt[De],Er=Et[De],Yr=Qt[De],Cr=j[De],Mr=0;Mr<tt;Mr++)Xr[Mr]=Er[Mr]/Cr||0;if(Q)for(var Be=0;Be<tt;Be++)if(Yr[Be]!=Xr[Be]){Q=!1;break}}}else{for(var ti=0;ti<et;ti++)Et[X[ti]]+=ye[ti];for(var $n=0;$n<ue;$n++)qt[$n]=Et[$n]/j[$n]||0;Q=!0;for(var li=0;li<ue;li++)if(Qt[li]!=qt[li]){Q=!1;break}}Q=Q||--bt<=0}while(!Q);return{it:1e4-bt,k:ue,idxs:X,centroids:qt}}},54:(He,pe,wt)=>{"use strict";wt.r(pe),wt.d(pe,{default:()=>yt});class yt{constructor(Bt=[],ft=b){if(this.data=Bt,this.length=this.data.length,this.compare=ft,this.length>0)for(let St=(this.length>>1)-1;St>=0;St--)this._down(St)}push(Bt){this.data.push(Bt),this.length++,this._up(this.length-1)}pop(){if(0===this.length)return;const Bt=this.data[0],ft=this.data.pop();return this.length--,this.length>0&&(this.data[0]=ft,this._down(0)),Bt}peek(){return this.data[0]}_up(Bt){const{data:ft,compare:St}=this,Ft=ft[Bt];for(;Bt>0;){const le=Bt-1>>1,kt=ft[le];if(St(Ft,kt)>=0)break;ft[Bt]=kt,Bt=le}ft[Bt]=Ft}_down(Bt){const{data:ft,compare:St}=this,Ft=this.length>>1,le=ft[Bt];for(;Bt<Ft;){let kt=1+(Bt<<1),Ze=ft[kt];const ye=kt+1;if(ye<this.length&&St(ft[ye],Ze)<0&&(kt=ye,Ze=ft[ye]),St(Ze,le)>=0)break;ft[Bt]=Ze,Bt=kt}ft[Bt]=le}}function b(v,Bt){return v<Bt?-1:v>Bt?1:0}},7299:function(He,pe){!function(wt){"use strict";function yt(){}function b(n){this.message=n||""}function v(n){this.message=n||""}function Bt(n){this.message=n||""}function ft(){}function St(n){return null===n?Ut:n.color}function Ft(n){return null===n?null:n.parent}function le(n,a){null!==n&&(n.color=a)}function kt(n){return null===n?null:n.left}function Ze(n){return null===n?null:n.right}function ye(){this.root_=null,this.size_=0}function ue(){}function de(){this.array_=[],arguments[0]instanceof ei&&this.addAll(arguments[0])}function Ye(){}function qt(n){this.message=n||""}function Qt(){this.array_=[]}"fill"in Array.prototype||Object.defineProperty(Array.prototype,"fill",{configurable:!0,value:function(n){if(null==this)throw new TypeError(this+" is not an object");var a=Object(this),h=Math.max(Math.min(a.length,9007199254740991),0)||0,d=1 in arguments&&parseInt(Number(arguments[1]),10)||0;d=d<0?Math.max(h+d,0):Math.min(d,h);var w=2 in arguments&&void 0!==arguments[2]?parseInt(Number(arguments[2]),10)||0:h;for(w=w<0?Math.max(h+arguments[2],0):Math.min(w,h);d<w;)a[d]=n,++d;return a},writable:!0}),Number.isFinite=Number.isFinite||function(n){return"number"==typeof n&&isFinite(n)},Number.isInteger=Number.isInteger||function(n){return"number"==typeof n&&isFinite(n)&&Math.floor(n)===n},Number.parseFloat=Number.parseFloat||parseFloat,Number.isNaN=Number.isNaN||function(n){return n!=n},Math.trunc=Math.trunc||function(n){return n<0?Math.ceil(n):Math.floor(n)};var X=function(){};X.prototype.interfaces_=function(){return[]},X.prototype.getClass=function(){return X},X.prototype.equalsWithTolerance=function(n,a,h){return Math.abs(n-a)<=h};var J=function(n){function a(h){n.call(this,h),this.name="IllegalArgumentException",this.message=h,this.stack=(new n).stack}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a}(Error),Q=function(){},bt={MAX_VALUE:{configurable:!0}};Q.isNaN=function(n){return Number.isNaN(n)},Q.doubleToLongBits=function(n){return n},Q.longBitsToDouble=function(n){return n},Q.isInfinite=function(n){return!Number.isFinite(n)},bt.MAX_VALUE.get=function(){return Number.MAX_VALUE},Object.defineProperties(Q,bt);var et=function(){},tt=function(){},lt=function(){},j=function n(){if(this.x=null,this.y=null,this.z=null,0===arguments.length)this.x=0,this.y=0,this.z=n.NULL_ORDINATE;else if(1===arguments.length){var a=arguments[0];this.x=a.x,this.y=a.y,this.z=a.z}else 2===arguments.length?(this.x=arguments[0],this.y=arguments[1],this.z=n.NULL_ORDINATE):3===arguments.length&&(this.x=arguments[0],this.y=arguments[1],this.z=arguments[2])},re={DimensionalComparator:{configurable:!0},serialVersionUID:{configurable:!0},NULL_ORDINATE:{configurable:!0},X:{configurable:!0},Y:{configurable:!0},Z:{configurable:!0}};j.prototype.setOrdinate=function(n,a){switch(n){case j.X:this.x=a;break;case j.Y:this.y=a;break;case j.Z:this.z=a;break;default:throw new J("Invalid ordinate index: "+n)}},j.prototype.equals2D=function(){if(1===arguments.length){var n=arguments[0];return this.x===n.x&&this.y===n.y}if(2===arguments.length){var a=arguments[0],h=arguments[1];return!!X.equalsWithTolerance(this.x,a.x,h)&&!!X.equalsWithTolerance(this.y,a.y,h)}},j.prototype.getOrdinate=function(n){switch(n){case j.X:return this.x;case j.Y:return this.y;case j.Z:return this.z}throw new J("Invalid ordinate index: "+n)},j.prototype.equals3D=function(n){return this.x===n.x&&this.y===n.y&&(this.z===n.z||Q.isNaN(this.z))&&Q.isNaN(n.z)},j.prototype.equals=function(n){return n instanceof j&&this.equals2D(n)},j.prototype.equalInZ=function(n,a){return X.equalsWithTolerance(this.z,n.z,a)},j.prototype.compareTo=function(n){return this.x<n.x?-1:this.x>n.x?1:this.y<n.y?-1:this.y>n.y?1:0},j.prototype.clone=function(){},j.prototype.copy=function(){return new j(this)},j.prototype.toString=function(){return"("+this.x+", "+this.y+", "+this.z+")"},j.prototype.distance3D=function(n){var a=this.x-n.x,h=this.y-n.y,d=this.z-n.z;return Math.sqrt(a*a+h*h+d*d)},j.prototype.distance=function(n){var a=this.x-n.x,h=this.y-n.y;return Math.sqrt(a*a+h*h)},j.prototype.hashCode=function(){var n=17;return 37*(n=37*n+j.hashCode(this.x))+j.hashCode(this.y)},j.prototype.setCoordinate=function(n){this.x=n.x,this.y=n.y,this.z=n.z},j.prototype.interfaces_=function(){return[et,tt,yt]},j.prototype.getClass=function(){return j},j.hashCode=function(){if(1===arguments.length){var a=Q.doubleToLongBits(arguments[0]);return Math.trunc((a^a)>>>32)}},re.DimensionalComparator.get=function(){return xt},re.serialVersionUID.get=function(){return 0x5cbf2c235c7e5800},re.NULL_ORDINATE.get=function(){return Q.NaN},re.X.get=function(){return 0},re.Y.get=function(){return 1},re.Z.get=function(){return 2},Object.defineProperties(j,re);var xt=function(n){if(this._dimensionsToTest=2,0!==arguments.length&&1===arguments.length){var a=arguments[0];if(2!==a&&3!==a)throw new J("only 2 or 3 dimensions may be specified");this._dimensionsToTest=a}};xt.prototype.compare=function(n,a){var h=n,d=a,w=xt.compare(h.x,d.x);if(0!==w)return w;var O=xt.compare(h.y,d.y);return 0!==O?O:this._dimensionsToTest<=2?0:xt.compare(h.z,d.z)},xt.prototype.interfaces_=function(){return[lt]},xt.prototype.getClass=function(){return xt},xt.compare=function(n,a){return n<a?-1:n>a?1:Q.isNaN(n)?Q.isNaN(a)?0:-1:Q.isNaN(a)?1:0};var Ot=function(){};Ot.prototype.create=function(){},Ot.prototype.interfaces_=function(){return[]},Ot.prototype.getClass=function(){return Ot};var at=function(){},ke={INTERIOR:{configurable:!0},BOUNDARY:{configurable:!0},EXTERIOR:{configurable:!0},NONE:{configurable:!0}};at.prototype.interfaces_=function(){return[]},at.prototype.getClass=function(){return at},at.toLocationSymbol=function(n){switch(n){case at.EXTERIOR:return"e";case at.BOUNDARY:return"b";case at.INTERIOR:return"i";case at.NONE:return"-"}throw new J("Unknown location value: "+n)},ke.INTERIOR.get=function(){return 0},ke.BOUNDARY.get=function(){return 1},ke.EXTERIOR.get=function(){return 2},ke.NONE.get=function(){return-1},Object.defineProperties(at,ke);var Te=function(n,a){return n.interfaces_&&n.interfaces_().indexOf(a)>-1},Et=function(){},ne={LOG_10:{configurable:!0}};Et.prototype.interfaces_=function(){return[]},Et.prototype.getClass=function(){return Et},Et.log10=function(n){var a=Math.log(n);return Q.isInfinite(a)||Q.isNaN(a)?a:a/Et.LOG_10},Et.min=function(n,a,h,d){var w=n;return a<w&&(w=a),h<w&&(w=h),d<w&&(w=d),w},Et.clamp=function(){if("number"==typeof arguments[2]&&"number"==typeof arguments[0]&&"number"==typeof arguments[1]){var n=arguments[0],a=arguments[1],h=arguments[2];return n<a?a:n>h?h:n}if(Number.isInteger(arguments[2])&&Number.isInteger(arguments[0])&&Number.isInteger(arguments[1])){var d=arguments[0],w=arguments[1],O=arguments[2];return d<w?w:d>O?O:d}},Et.wrap=function(n,a){return n<0?a- -n%a:n%a},Et.max=function(){if(3===arguments.length){var a=arguments[1],h=arguments[2],d=arguments[0];return a>d&&(d=a),h>d&&(d=h),d}if(4===arguments.length){var O=arguments[1],k=arguments[2],W=arguments[3],mt=arguments[0];return O>mt&&(mt=O),k>mt&&(mt=k),W>mt&&(mt=W),mt}},Et.average=function(n,a){return(n+a)/2},ne.LOG_10.get=function(){return Math.log(10)},Object.defineProperties(Et,ne);var Pt=function(n){this.str=n};Pt.prototype.append=function(n){this.str+=n},Pt.prototype.setCharAt=function(n,a){this.str=this.str.substr(0,n)+a+this.str.substr(n+1)},Pt.prototype.toString=function(n){return this.str};var Kt=function(n){this.value=n};Kt.prototype.intValue=function(){return this.value},Kt.prototype.compareTo=function(n){return this.value<n?-1:this.value>n?1:0},Kt.isNaN=function(n){return Number.isNaN(n)};var te=function(){};te.isWhitespace=function(n){return n<=32&&n>=0||127===n},te.toUpperCase=function(n){return n.toUpperCase()};var vt=function n(){this._hi=0,this._lo=0,0===arguments.length?this.init(0):1===arguments.length?"number"==typeof arguments[0]||arguments[0]instanceof n?this.init(arguments[0]):"string"==typeof arguments[0]&&n.call(this,n.parse(arguments[0])):2===arguments.length&&this.init(arguments[0],arguments[1])},Se={PI:{configurable:!0},TWO_PI:{configurable:!0},PI_2:{configurable:!0},E:{configurable:!0},NaN:{configurable:!0},EPS:{configurable:!0},SPLIT:{configurable:!0},MAX_PRINT_DIGITS:{configurable:!0},TEN:{configurable:!0},ONE:{configurable:!0},SCI_NOT_EXPONENT_CHAR:{configurable:!0},SCI_NOT_ZERO:{configurable:!0}};vt.prototype.le=function(n){return(this._hi<n._hi||this._hi===n._hi)&&this._lo<=n._lo},vt.prototype.extractSignificantDigits=function(n,a){var h=this.abs(),d=vt.magnitude(h._hi),w=vt.TEN.pow(d);(h=h.divide(w)).gt(vt.TEN)?(h=h.divide(vt.TEN),d+=1):h.lt(vt.ONE)&&(h=h.multiply(vt.TEN),d-=1);for(var O=d+1,k=new Pt,W=vt.MAX_PRINT_DIGITS-1,mt=0;mt<=W;mt++){n&&mt===O&&k.append(".");var Gt=Math.trunc(h._hi);if(Gt<0)break;var Ie=!1,Me=0;Gt>9?(Ie=!0,Me="9"):Me="0"+Gt,k.append(Me),h=h.subtract(vt.valueOf(Gt)).multiply(vt.TEN),Ie&&h.selfAdd(vt.TEN);var Ke=!0,gr=vt.magnitude(h._hi);if(gr<0&&Math.abs(gr)>=W-mt&&(Ke=!1),!Ke)break}return a[0]=d,k.toString()},vt.prototype.sqr=function(){return this.multiply(this)},vt.prototype.doubleValue=function(){return this._hi+this._lo},vt.prototype.subtract=function(){return arguments[0]instanceof vt?this.add(arguments[0].negate()):"number"==typeof arguments[0]?this.add(-arguments[0]):void 0},vt.prototype.equals=function(){if(1===arguments.length){var n=arguments[0];return this._hi===n._hi&&this._lo===n._lo}},vt.prototype.isZero=function(){return 0===this._hi&&0===this._lo},vt.prototype.selfSubtract=function(){if(arguments[0]instanceof vt){var n=arguments[0];return this.isNaN()?this:this.selfAdd(-n._hi,-n._lo)}if("number"==typeof arguments[0]){var a=arguments[0];return this.isNaN()?this:this.selfAdd(-a,0)}},vt.prototype.getSpecialNumberString=function(){return this.isZero()?"0.0":this.isNaN()?"NaN ":null},vt.prototype.min=function(n){return this.le(n)?this:n},vt.prototype.selfDivide=function(){if(1===arguments.length){if(arguments[0]instanceof vt){var n=arguments[0];return this.selfDivide(n._hi,n._lo)}if("number"==typeof arguments[0])return this.selfDivide(arguments[0],0)}else if(2===arguments.length){var h=arguments[0],w=null,O=null,k=null,W=null,mt=null,Gt=null,Ie=null,Me=null;return this._hi=Me=(mt=this._hi/h)+(Gt=(this._hi-(Ie=mt*h)-(Me=(w=(Gt=vt.SPLIT*mt)-(w=Gt-mt))*(k=(Me=vt.SPLIT*h)-(k=Me-h))-Ie+w*(W=h-k)+(O=mt-w)*k+O*W)+this._lo-mt*arguments[1])/h),this._lo=mt-Me+Gt,this}},vt.prototype.dump=function(){return"DD<"+this._hi+", "+this._lo+">"},vt.prototype.divide=function(){if(arguments[0]instanceof vt){var n=arguments[0],a=null,h=null,d=null,w=null,O=null,k=null,W=null,mt=null;return h=(O=this._hi/n._hi)-(a=(k=vt.SPLIT*O)-(a=k-O)),mt=a*(d=(mt=vt.SPLIT*n._hi)-(d=mt-n._hi))-(W=O*n._hi)+a*(w=n._hi-d)+h*d+h*w,new vt(mt=O+(k=(this._hi-W-mt+this._lo-O*n._lo)/n._hi),O-mt+k)}if("number"==typeof arguments[0]){var Gt=arguments[0];return Q.isNaN(Gt)?vt.createNaN():vt.copy(this).selfDivide(Gt,0)}},vt.prototype.ge=function(n){return(this._hi>n._hi||this._hi===n._hi)&&this._lo>=n._lo},vt.prototype.pow=function(n){if(0===n)return vt.valueOf(1);var a=new vt(this),h=vt.valueOf(1),d=Math.abs(n);if(d>1)for(;d>0;)d%2==1&&h.selfMultiply(a),(d/=2)>0&&(a=a.sqr());else h=a;return n<0?h.reciprocal():h},vt.prototype.ceil=function(){if(this.isNaN())return vt.NaN;var n=Math.ceil(this._hi),a=0;return n===this._hi&&(a=Math.ceil(this._lo)),new vt(n,a)},vt.prototype.compareTo=function(n){return this._hi<n._hi?-1:this._hi>n._hi?1:this._lo<n._lo?-1:this._lo>n._lo?1:0},vt.prototype.rint=function(){return this.isNaN()?this:this.add(.5).floor()},vt.prototype.setValue=function(){return arguments[0]instanceof vt||"number"==typeof arguments[0]?(this.init(arguments[0]),this):void 0},vt.prototype.max=function(n){return this.ge(n)?this:n},vt.prototype.sqrt=function(){if(this.isZero())return vt.valueOf(0);if(this.isNegative())return vt.NaN;var n=1/Math.sqrt(this._hi),h=vt.valueOf(this._hi*n),d=this.subtract(h.sqr())._hi*(.5*n);return h.add(d)},vt.prototype.selfAdd=function(){if(1===arguments.length){if(arguments[0]instanceof vt){var n=arguments[0];return this.selfAdd(n._hi,n._lo)}if("number"==typeof arguments[0]){var a=arguments[0],h=null,d=null,w=null,k=null,W=null;return this._hi=(h=(w=this._hi+a)+(W=a-(k=w-this._hi)+(this._hi-(w-k))+this._lo))+(d=W+(w-h)),this._lo=d+(h-this._hi),this}}else if(2===arguments.length){var mt=arguments[0],Gt=arguments[1],Ie=null,Me=null,Ke=null,gr=null,Or=null,Zr=null,Kn=null;Or=(gr=this._hi+mt)-(Zr=gr-this._hi),Ke=(Me=this._lo+Gt)-(Kn=Me-this._lo);var l=(Ie=gr+(Zr=(Or=mt-Zr+(this._hi-Or))+Me))+(Zr=(Ke=Gt-Kn+(this._lo-Ke))+(Zr+(gr-Ie))),p=Zr+(Ie-l);return this._hi=l,this._lo=p,this}},vt.prototype.selfMultiply=function(){if(1===arguments.length){if(arguments[0]instanceof vt){var n=arguments[0];return this.selfMultiply(n._hi,n._lo)}if("number"==typeof arguments[0])return this.selfMultiply(arguments[0],0)}else if(2===arguments.length){var h=arguments[0],w=null,O=null,k=null,W=null,mt=null,Gt=null;w=(mt=vt.SPLIT*this._hi)-this._hi,w=mt-w;var Ie=(mt=this._hi*h)+(Gt=w*(k=(Gt=vt.SPLIT*h)-(k=Gt-h))-mt+w*(W=h-k)+(O=this._hi-w)*k+O*W+(this._hi*arguments[1]+this._lo*h)),Me=Gt+(w=mt-Ie);return this._hi=Ie,this._lo=Me,this}},vt.prototype.selfSqr=function(){return this.selfMultiply(this)},vt.prototype.floor=function(){if(this.isNaN())return vt.NaN;var n=Math.floor(this._hi),a=0;return n===this._hi&&(a=Math.floor(this._lo)),new vt(n,a)},vt.prototype.negate=function(){return this.isNaN()?this:new vt(-this._hi,-this._lo)},vt.prototype.clone=function(){},vt.prototype.multiply=function(){if(arguments[0]instanceof vt){var n=arguments[0];return n.isNaN()?vt.createNaN():vt.copy(this).selfMultiply(n)}if("number"==typeof arguments[0]){var a=arguments[0];return Q.isNaN(a)?vt.createNaN():vt.copy(this).selfMultiply(a,0)}},vt.prototype.isNaN=function(){return Q.isNaN(this._hi)},vt.prototype.intValue=function(){return Math.trunc(this._hi)},vt.prototype.toString=function(){var n=vt.magnitude(this._hi);return n>=-3&&n<=20?this.toStandardNotation():this.toSciNotation()},vt.prototype.toStandardNotation=function(){var n=this.getSpecialNumberString();if(null!==n)return n;var a=new Array(1).fill(null),h=this.extractSignificantDigits(!0,a),d=a[0]+1,w=h;return"."===h.charAt(0)?w="0"+h:d<0?w="0."+vt.stringOfChar("0",-d)+h:-1===h.indexOf(".")&&(w=h+vt.stringOfChar("0",d-h.length)+".0"),this.isNegative()?"-"+w:w},vt.prototype.reciprocal=function(){var a,d,w,k,n=null,h=null,O=null,W=null;a=(w=1/this._hi)-(n=(O=vt.SPLIT*w)-(n=O-w)),h=(W=vt.SPLIT*this._hi)-this._hi;var mt=w+(O=(1-(k=w*this._hi)-(W=n*(h=W-h)-k+n*(d=this._hi-h)+a*h+a*d)-w*this._lo)/this._hi);return new vt(mt,w-mt+O)},vt.prototype.toSciNotation=function(){if(this.isZero())return vt.SCI_NOT_ZERO;var n=this.getSpecialNumberString();if(null!==n)return n;var a=new Array(1).fill(null),h=this.extractSignificantDigits(!1,a),d=vt.SCI_NOT_EXPONENT_CHAR+a[0];if("0"===h.charAt(0))throw new Error("Found leading zero: "+h);var w="";h.length>1&&(w=h.substring(1));var O=h.charAt(0)+"."+w;return this.isNegative()?"-"+O+d:O+d},vt.prototype.abs=function(){return this.isNaN()?vt.NaN:this.isNegative()?this.negate():new vt(this)},vt.prototype.isPositive=function(){return(this._hi>0||0===this._hi)&&this._lo>0},vt.prototype.lt=function(n){return(this._hi<n._hi||this._hi===n._hi)&&this._lo<n._lo},vt.prototype.add=function(){if(arguments[0]instanceof vt){var n=arguments[0];return vt.copy(this).selfAdd(n)}if("number"==typeof arguments[0]){var a=arguments[0];return vt.copy(this).selfAdd(a)}},vt.prototype.init=function(){if(1===arguments.length){if("number"==typeof arguments[0])this._hi=arguments[0],this._lo=0;else if(arguments[0]instanceof vt){var a=arguments[0];this._hi=a._hi,this._lo=a._lo}}else if(2===arguments.length){var d=arguments[1];this._hi=arguments[0],this._lo=d}},vt.prototype.gt=function(n){return(this._hi>n._hi||this._hi===n._hi)&&this._lo>n._lo},vt.prototype.isNegative=function(){return(this._hi<0||0===this._hi)&&this._lo<0},vt.prototype.trunc=function(){return this.isNaN()?vt.NaN:this.isPositive()?this.floor():this.ceil()},vt.prototype.signum=function(){return this._hi>0?1:this._hi<0?-1:this._lo>0?1:this._lo<0?-1:0},vt.prototype.interfaces_=function(){return[yt,et,tt]},vt.prototype.getClass=function(){return vt},vt.sqr=function(n){return vt.valueOf(n).selfMultiply(n)},vt.valueOf=function(){return"string"==typeof arguments[0]?vt.parse(arguments[0]):"number"==typeof arguments[0]?new vt(arguments[0]):void 0},vt.sqrt=function(n){return vt.valueOf(n).sqrt()},vt.parse=function(n){for(var a=0,h=n.length;te.isWhitespace(n.charAt(a));)a++;var d=!1;if(a<h){var w=n.charAt(a);"-"!==w&&"+"!==w||(a++,"-"===w&&(d=!0))}for(var O=new vt,k=0,W=0,mt=0;!(a>=h);){var Gt=n.charAt(a);if(a++,te.isDigit(Gt)){var Ie=Gt-"0";O.selfMultiply(vt.TEN),O.selfAdd(Ie),k++}else{if("."!==Gt){if("e"===Gt||"E"===Gt){var Me=n.substring(a);try{mt=Kt.parseInt(Me)}catch(Kn){throw Kn instanceof Error?new Error("Invalid exponent "+Me+" in string "+n):Kn}break}throw new Error("Unexpected character '"+Gt+"' at position "+a+" in string "+n)}W=k}}var Ke=O,gr=k-W-mt;if(0===gr)Ke=O;else if(gr>0){var Or=vt.TEN.pow(gr);Ke=O.divide(Or)}else if(gr<0){var Zr=vt.TEN.pow(-gr);Ke=O.multiply(Zr)}return d?Ke.negate():Ke},vt.createNaN=function(){return new vt(Q.NaN,Q.NaN)},vt.copy=function(n){return new vt(n)},vt.magnitude=function(n){var a=Math.abs(n),h=Math.log(a)/Math.log(10),d=Math.trunc(Math.floor(h));return 10*Math.pow(10,d)<=a&&(d+=1),d},vt.stringOfChar=function(n,a){for(var h=new Pt,d=0;d<a;d++)h.append(n);return h.toString()},Se.PI.get=function(){return new vt(3.141592653589793,12246467991473532e-32)},Se.TWO_PI.get=function(){return new vt(6.283185307179586,24492935982947064e-32)},Se.PI_2.get=function(){return new vt(1.5707963267948966,6123233995736766e-32)},Se.E.get=function(){return new vt(2.718281828459045,14456468917292502e-32)},Se.NaN.get=function(){return new vt(Q.NaN,Q.NaN)},Se.EPS.get=function(){return 123259516440783e-46},Se.SPLIT.get=function(){return 134217729},Se.MAX_PRINT_DIGITS.get=function(){return 32},Se.TEN.get=function(){return vt.valueOf(10)},Se.ONE.get=function(){return vt.valueOf(1)},Se.SCI_NOT_EXPONENT_CHAR.get=function(){return"E"},Se.SCI_NOT_ZERO.get=function(){return"0.0E0"},Object.defineProperties(vt,Se);var Fe=function(){},wr={DP_SAFE_EPSILON:{configurable:!0}};Fe.prototype.interfaces_=function(){return[]},Fe.prototype.getClass=function(){return Fe},Fe.orientationIndex=function(n,a,h){var d=Fe.orientationIndexFilter(n,a,h);if(d<=1)return d;var w=vt.valueOf(a.x).selfAdd(-n.x),O=vt.valueOf(a.y).selfAdd(-n.y),k=vt.valueOf(h.x).selfAdd(-a.x),W=vt.valueOf(h.y).selfAdd(-a.y);return w.selfMultiply(W).selfSubtract(O.selfMultiply(k)).signum()},Fe.signOfDet2x2=function(n,a,h,d){return n.multiply(d).selfSubtract(a.multiply(h)).signum()},Fe.intersection=function(n,a,h,d){var w=vt.valueOf(d.y).selfSubtract(h.y).selfMultiply(vt.valueOf(a.x).selfSubtract(n.x)),O=vt.valueOf(d.x).selfSubtract(h.x).selfMultiply(vt.valueOf(a.y).selfSubtract(n.y)),k=w.subtract(O),W=vt.valueOf(d.x).selfSubtract(h.x).selfMultiply(vt.valueOf(n.y).selfSubtract(h.y)),mt=vt.valueOf(d.y).selfSubtract(h.y).selfMultiply(vt.valueOf(n.x).selfSubtract(h.x)),Gt=W.subtract(mt).selfDivide(k).doubleValue(),Ie=vt.valueOf(n.x).selfAdd(vt.valueOf(a.x).selfSubtract(n.x).selfMultiply(Gt)).doubleValue(),Me=vt.valueOf(a.x).selfSubtract(n.x).selfMultiply(vt.valueOf(n.y).selfSubtract(h.y)),Ke=vt.valueOf(a.y).selfSubtract(n.y).selfMultiply(vt.valueOf(n.x).selfSubtract(h.x)),gr=Me.subtract(Ke).selfDivide(k).doubleValue(),Or=vt.valueOf(h.y).selfAdd(vt.valueOf(d.y).selfSubtract(h.y).selfMultiply(gr)).doubleValue();return new j(Ie,Or)},Fe.orientationIndexFilter=function(n,a,h){var d=null,w=(n.x-h.x)*(a.y-h.y),O=(n.y-h.y)*(a.x-h.x),k=w-O;if(w>0){if(O<=0)return Fe.signum(k);d=w+O}else{if(!(w<0)||O>=0)return Fe.signum(k);d=-w-O}var W=Fe.DP_SAFE_EPSILON*d;return k>=W||-k>=W?Fe.signum(k):2},Fe.signum=function(n){return n>0?1:n<0?-1:0},wr.DP_SAFE_EPSILON.get=function(){return 1e-15},Object.defineProperties(Fe,wr);var De=function(){},Xr={X:{configurable:!0},Y:{configurable:!0},Z:{configurable:!0},M:{configurable:!0}};Xr.X.get=function(){return 0},Xr.Y.get=function(){return 1},Xr.Z.get=function(){return 2},Xr.M.get=function(){return 3},De.prototype.setOrdinate=function(n,a,h){},De.prototype.size=function(){},De.prototype.getOrdinate=function(n,a){},De.prototype.getCoordinate=function(){},De.prototype.getCoordinateCopy=function(n){},De.prototype.getDimension=function(){},De.prototype.getX=function(n){},De.prototype.clone=function(){},De.prototype.expandEnvelope=function(n){},De.prototype.copy=function(){},De.prototype.getY=function(n){},De.prototype.toCoordinateArray=function(){},De.prototype.interfaces_=function(){return[tt]},De.prototype.getClass=function(){return De},Object.defineProperties(De,Xr);var Er=function(){},Yr=function(n){function a(){n.call(this,"Projective point not representable on the Cartesian plane.")}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.interfaces_=function(){return[]},a.prototype.getClass=function(){return a},a}(Er),Cr=function(){};Cr.arraycopy=function(n,a,h,d,w){for(var O=0,k=a;k<a+w;k++)h[d+O]=n[k],O++},Cr.getProperty=function(n){return{"line.separator":"\n"}[n]};var Mr=function n(){if(this.x=null,this.y=null,this.w=null,0===arguments.length)this.x=0,this.y=0,this.w=1;else if(1===arguments.length){var a=arguments[0];this.x=a.x,this.y=a.y,this.w=1}else if(2===arguments.length){if("number"==typeof arguments[0]&&"number"==typeof arguments[1]){var d=arguments[1];this.x=arguments[0],this.y=d,this.w=1}else if(arguments[0]instanceof n&&arguments[1]instanceof n){var w=arguments[0],O=arguments[1];this.x=w.y*O.w-O.y*w.w,this.y=O.x*w.w-w.x*O.w,this.w=w.x*O.y-O.x*w.y}else if(arguments[0]instanceof j&&arguments[1]instanceof j){var k=arguments[0],W=arguments[1];this.x=k.y-W.y,this.y=W.x-k.x,this.w=k.x*W.y-W.x*k.y}}else if(3===arguments.length){var Gt=arguments[1],Ie=arguments[2];this.x=arguments[0],this.y=Gt,this.w=Ie}else if(4===arguments.length){var Me=arguments[0],Ke=arguments[1],gr=arguments[2],Or=arguments[3],Zr=Me.y-Ke.y,Kn=Ke.x-Me.x,l=Me.x*Ke.y-Ke.x*Me.y,p=gr.y-Or.y,c=Or.x-gr.x,y=gr.x*Or.y-Or.x*gr.y;this.x=Kn*y-c*l,this.y=p*l-Zr*y,this.w=Zr*c-p*Kn}};Mr.prototype.getY=function(){var n=this.y/this.w;if(Q.isNaN(n)||Q.isInfinite(n))throw new Yr;return n},Mr.prototype.getX=function(){var n=this.x/this.w;if(Q.isNaN(n)||Q.isInfinite(n))throw new Yr;return n},Mr.prototype.getCoordinate=function(){var n=new j;return n.x=this.getX(),n.y=this.getY(),n},Mr.prototype.interfaces_=function(){return[]},Mr.prototype.getClass=function(){return Mr},Mr.intersection=function(n,a,h,d){var w=n.y-a.y,O=a.x-n.x,k=n.x*a.y-a.x*n.y,W=h.y-d.y,mt=d.x-h.x,Gt=h.x*d.y-d.x*h.y,Ie=w*mt-W*O,Me=(O*Gt-mt*k)/Ie,Ke=(W*k-w*Gt)/Ie;if(Q.isNaN(Me)||Q.isInfinite(Me)||Q.isNaN(Ke)||Q.isInfinite(Ke))throw new Yr;return new j(Me,Ke)};var Be=function n(){if(this._minx=null,this._maxx=null,this._miny=null,this._maxy=null,0===arguments.length)this.init();else if(1===arguments.length)if(arguments[0]instanceof j){var a=arguments[0];this.init(a.x,a.x,a.y,a.y)}else arguments[0]instanceof n&&this.init(arguments[0]);else if(2===arguments.length){var d=arguments[0],w=arguments[1];this.init(d.x,w.x,d.y,w.y)}else 4===arguments.length&&this.init(arguments[0],arguments[1],arguments[2],arguments[3])},ti={serialVersionUID:{configurable:!0}};Be.prototype.getArea=function(){return this.getWidth()*this.getHeight()},Be.prototype.equals=function(n){if(!(n instanceof Be))return!1;var a=n;return this.isNull()?a.isNull():this._maxx===a.getMaxX()&&this._maxy===a.getMaxY()&&this._minx===a.getMinX()&&this._miny===a.getMinY()},Be.prototype.intersection=function(n){return this.isNull()||n.isNull()||!this.intersects(n)?new Be:new Be(this._minx>n._minx?this._minx:n._minx,this._maxx<n._maxx?this._maxx:n._maxx,this._miny>n._miny?this._miny:n._miny,this._maxy<n._maxy?this._maxy:n._maxy)},Be.prototype.isNull=function(){return this._maxx<this._minx},Be.prototype.getMaxX=function(){return this._maxx},Be.prototype.covers=function(){if(1===arguments.length){if(arguments[0]instanceof j){var n=arguments[0];return this.covers(n.x,n.y)}if(arguments[0]instanceof Be){var a=arguments[0];return!this.isNull()&&!a.isNull()&&a.getMinX()>=this._minx&&a.getMaxX()<=this._maxx&&a.getMinY()>=this._miny&&a.getMaxY()<=this._maxy}}else if(2===arguments.length){var h=arguments[0],d=arguments[1];return!this.isNull()&&h>=this._minx&&h<=this._maxx&&d>=this._miny&&d<=this._maxy}},Be.prototype.intersects=function(){if(1===arguments.length){if(arguments[0]instanceof Be){var n=arguments[0];return!this.isNull()&&!n.isNull()&&!(n._minx>this._maxx||n._maxx<this._minx||n._miny>this._maxy||n._maxy<this._miny)}if(arguments[0]instanceof j){var a=arguments[0];return this.intersects(a.x,a.y)}}else if(2===arguments.length){var h=arguments[0],d=arguments[1];return!this.isNull()&&!(h>this._maxx||h<this._minx||d>this._maxy||d<this._miny)}},Be.prototype.getMinY=function(){return this._miny},Be.prototype.getMinX=function(){return this._minx},Be.prototype.expandToInclude=function(){if(1===arguments.length){if(arguments[0]instanceof j){var n=arguments[0];this.expandToInclude(n.x,n.y)}else if(arguments[0]instanceof Be){var a=arguments[0];if(a.isNull())return null;this.isNull()?(this._minx=a.getMinX(),this._maxx=a.getMaxX(),this._miny=a.getMinY(),this._maxy=a.getMaxY()):(a._minx<this._minx&&(this._minx=a._minx),a._maxx>this._maxx&&(this._maxx=a._maxx),a._miny<this._miny&&(this._miny=a._miny),a._maxy>this._maxy&&(this._maxy=a._maxy))}}else if(2===arguments.length){var h=arguments[0],d=arguments[1];this.isNull()?(this._minx=h,this._maxx=h,this._miny=d,this._maxy=d):(h<this._minx&&(this._minx=h),h>this._maxx&&(this._maxx=h),d<this._miny&&(this._miny=d),d>this._maxy&&(this._maxy=d))}},Be.prototype.minExtent=function(){if(this.isNull())return 0;var n=this.getWidth(),a=this.getHeight();return n<a?n:a},Be.prototype.getWidth=function(){return this.isNull()?0:this._maxx-this._minx},Be.prototype.compareTo=function(n){var a=n;return this.isNull()?a.isNull()?0:-1:a.isNull()?1:this._minx<a._minx?-1:this._minx>a._minx?1:this._miny<a._miny?-1:this._miny>a._miny?1:this._maxx<a._maxx?-1:this._maxx>a._maxx?1:this._maxy<a._maxy?-1:this._maxy>a._maxy?1:0},Be.prototype.translate=function(n,a){if(this.isNull())return null;this.init(this.getMinX()+n,this.getMaxX()+n,this.getMinY()+a,this.getMaxY()+a)},Be.prototype.toString=function(){return"Env["+this._minx+" : "+this._maxx+", "+this._miny+" : "+this._maxy+"]"},Be.prototype.setToNull=function(){this._minx=0,this._maxx=-1,this._miny=0,this._maxy=-1},Be.prototype.getHeight=function(){return this.isNull()?0:this._maxy-this._miny},Be.prototype.maxExtent=function(){if(this.isNull())return 0;var n=this.getWidth(),a=this.getHeight();return n>a?n:a},Be.prototype.expandBy=function(){if(1===arguments.length){var n=arguments[0];this.expandBy(n,n)}else if(2===arguments.length){var a=arguments[0],h=arguments[1];if(this.isNull())return null;this._minx-=a,this._maxx+=a,this._miny-=h,this._maxy+=h,(this._minx>this._maxx||this._miny>this._maxy)&&this.setToNull()}},Be.prototype.contains=function(){if(1===arguments.length){if(arguments[0]instanceof Be)return this.covers(arguments[0]);if(arguments[0]instanceof j)return this.covers(arguments[0])}else if(2===arguments.length)return this.covers(arguments[0],arguments[1])},Be.prototype.centre=function(){return this.isNull()?null:new j((this.getMinX()+this.getMaxX())/2,(this.getMinY()+this.getMaxY())/2)},Be.prototype.init=function(){if(0===arguments.length)this.setToNull();else if(1===arguments.length){if(arguments[0]instanceof j){var n=arguments[0];this.init(n.x,n.x,n.y,n.y)}else if(arguments[0]instanceof Be){var a=arguments[0];this._minx=a._minx,this._maxx=a._maxx,this._miny=a._miny,this._maxy=a._maxy}}else if(2===arguments.length){var h=arguments[0],d=arguments[1];this.init(h.x,d.x,h.y,d.y)}else if(4===arguments.length){var w=arguments[0],O=arguments[1],k=arguments[2],W=arguments[3];w<O?(this._minx=w,this._maxx=O):(this._minx=O,this._maxx=w),k<W?(this._miny=k,this._maxy=W):(this._miny=W,this._maxy=k)}},Be.prototype.getMaxY=function(){return this._maxy},Be.prototype.distance=function(n){if(this.intersects(n))return 0;var a=0;this._maxx<n._minx?a=n._minx-this._maxx:this._minx>n._maxx&&(a=this._minx-n._maxx);var h=0;return this._maxy<n._miny?h=n._miny-this._maxy:this._miny>n._maxy&&(h=this._miny-n._maxy),0===a?h:0===h?a:Math.sqrt(a*a+h*h)},Be.prototype.hashCode=function(){var n=17;return 37*(n=37*(n=37*(n=37*n+j.hashCode(this._minx))+j.hashCode(this._maxx))+j.hashCode(this._miny))+j.hashCode(this._maxy)},Be.prototype.interfaces_=function(){return[et,yt]},Be.prototype.getClass=function(){return Be},Be.intersects=function(){if(3===arguments.length){var n=arguments[0],a=arguments[1],h=arguments[2];return h.x>=(n.x<a.x?n.x:a.x)&&h.x<=(n.x>a.x?n.x:a.x)&&h.y>=(n.y<a.y?n.y:a.y)&&h.y<=(n.y>a.y?n.y:a.y)}if(4===arguments.length){var d=arguments[0],w=arguments[1],O=arguments[2],k=arguments[3],W=Math.min(O.x,k.x),mt=Math.max(O.x,k.x),Gt=Math.min(d.x,w.x),Ie=Math.max(d.x,w.x);return!(Gt>mt||Ie<W||(W=Math.min(O.y,k.y),mt=Math.max(O.y,k.y),Gt=Math.min(d.y,w.y),Ie=Math.max(d.y,w.y),Gt>mt||Ie<W))}},ti.serialVersionUID.get=function(){return 0x51845cd552189800},Object.defineProperties(Be,ti);var In={typeStr:/^\s*(\w+)\s*\(\s*(.*)\s*\)\s*$/,emptyTypeStr:/^\s*(\w+)\s*EMPTY\s*$/,spaces:/\s+/,parenComma:/\)\s*,\s*\(/,doubleParenComma:/\)\s*\)\s*,\s*\(\s*\(/,trimParens:/^\s*\(?(.*?)\)?\s*$/},$n=function(n){this.geometryFactory=n||new en};$n.prototype.read=function(n){var a,h;n=n.replace(/[\n\r]/g," ");var w=In.typeStr.exec(n);if(-1!==n.search("EMPTY")&&((w=In.emptyTypeStr.exec(n))[2]=void 0),w&&(h=w[1].toLowerCase(),fi[h]&&(a=fi[h].apply(this,[w[2]]))),void 0===a)throw new Error("Could not parse WKT "+n);return a},$n.prototype.write=function(n){return this.extractGeometry(n)},$n.prototype.extractGeometry=function(n){var a=n.getGeometryType().toLowerCase();if(!li[a])return null;var h=a.toUpperCase();return n.isEmpty()?h+" EMPTY":h+"("+li[a].apply(this,[n])+")"};var li={coordinate:function(n){return n.x+" "+n.y},point:function(n){return li.coordinate.call(this,n._coordinates._coordinates[0])},multipoint:function(n){for(var a=[],h=0,d=n._geometries.length;h<d;++h)a.push("("+li.point.apply(this,[n._geometries[h]])+")");return a.join(",")},linestring:function(n){for(var a=[],h=0,d=n._points._coordinates.length;h<d;++h)a.push(li.coordinate.apply(this,[n._points._coordinates[h]]));return a.join(",")},linearring:function(n){for(var a=[],h=0,d=n._points._coordinates.length;h<d;++h)a.push(li.coordinate.apply(this,[n._points._coordinates[h]]));return a.join(",")},multilinestring:function(n){for(var a=[],h=0,d=n._geometries.length;h<d;++h)a.push("("+li.linestring.apply(this,[n._geometries[h]])+")");return a.join(",")},polygon:function(n){var a=[];a.push("("+li.linestring.apply(this,[n._shell])+")");for(var h=0,d=n._holes.length;h<d;++h)a.push("("+li.linestring.apply(this,[n._holes[h]])+")");return a.join(",")},multipolygon:function(n){for(var a=[],h=0,d=n._geometries.length;h<d;++h)a.push("("+li.polygon.apply(this,[n._geometries[h]])+")");return a.join(",")},geometrycollection:function(n){for(var a=[],h=0,d=n._geometries.length;h<d;++h)a.push(this.extractGeometry(n._geometries[h]));return a.join(",")}},fi={point:function(n){if(void 0===n)return this.geometryFactory.createPoint();var a=n.trim().split(In.spaces);return this.geometryFactory.createPoint(new j(Number.parseFloat(a[0]),Number.parseFloat(a[1])))},multipoint:function(n){if(void 0===n)return this.geometryFactory.createMultiPoint();for(var a,h=n.trim().split(","),d=[],w=0,O=h.length;w<O;++w)a=h[w].replace(In.trimParens,"$1"),d.push(fi.point.apply(this,[a]));return this.geometryFactory.createMultiPoint(d)},linestring:function(n){if(void 0===n)return this.geometryFactory.createLineString();for(var a,h=n.trim().split(","),d=[],w=0,O=h.length;w<O;++w)a=h[w].trim().split(In.spaces),d.push(new j(Number.parseFloat(a[0]),Number.parseFloat(a[1])));return this.geometryFactory.createLineString(d)},linearring:function(n){if(void 0===n)return this.geometryFactory.createLinearRing();for(var a,h=n.trim().split(","),d=[],w=0,O=h.length;w<O;++w)a=h[w].trim().split(In.spaces),d.push(new j(Number.parseFloat(a[0]),Number.parseFloat(a[1])));return this.geometryFactory.createLinearRing(d)},multilinestring:function(n){if(void 0===n)return this.geometryFactory.createMultiLineString();for(var a,h=n.trim().split(In.parenComma),d=[],w=0,O=h.length;w<O;++w)a=h[w].replace(In.trimParens,"$1"),d.push(fi.linestring.apply(this,[a]));return this.geometryFactory.createMultiLineString(d)},polygon:function(n){if(void 0===n)return this.geometryFactory.createPolygon();for(var a,h,d,w,O=n.trim().split(In.parenComma),k=[],W=0,mt=O.length;W<mt;++W)a=O[W].replace(In.trimParens,"$1"),h=fi.linestring.apply(this,[a]),d=this.geometryFactory.createLinearRing(h._points),0===W?w=d:k.push(d);return this.geometryFactory.createPolygon(w,k)},multipolygon:function(n){if(void 0===n)return this.geometryFactory.createMultiPolygon();for(var a,h=n.trim().split(In.doubleParenComma),d=[],w=0,O=h.length;w<O;++w)a=h[w].replace(In.trimParens,"$1"),d.push(fi.polygon.apply(this,[a]));return this.geometryFactory.createMultiPolygon(d)},geometrycollection:function(n){if(void 0===n)return this.geometryFactory.createGeometryCollection();for(var a=(n=n.replace(/,\s*([A-Za-z])/g,"|$1")).trim().split("|"),h=[],d=0,w=a.length;d<w;++d)h.push(this.read(a[d]));return this.geometryFactory.createGeometryCollection(h)}},ae=function(n){this.parser=new $n(n)};ae.prototype.write=function(n){return this.parser.write(n)},ae.toLineString=function(n,a){if(2!==arguments.length)throw new Error("Not implemented");return"LINESTRING ( "+n.x+" "+n.y+", "+a.x+" "+a.y+" )"};var st=function(n){function a(h){n.call(this,h),this.name="RuntimeException",this.message=h,this.stack=(new n).stack}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a}(Error),rt=function(n){function a(){n.call(this),0===arguments.length?n.call(this):1===arguments.length&&n.call(this,arguments[0])}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.interfaces_=function(){return[]},a.prototype.getClass=function(){return a},a}(st),$=function(){};$.prototype.interfaces_=function(){return[]},$.prototype.getClass=function(){return $},$.shouldNeverReachHere=function(){if(0===arguments.length)$.shouldNeverReachHere(null);else if(1===arguments.length){var n=arguments[0];throw new rt("Should never reach here"+(null!==n?": "+n:""))}},$.isTrue=function(){var a;if(1===arguments.length)$.isTrue(arguments[0],null);else if(2===arguments.length&&(a=arguments[1],!arguments[0]))throw null===a?new rt:new rt(a)},$.equals=function(){var n,a,h;if(2===arguments.length)$.equals(n=arguments[0],a=arguments[1],null);else if(3===arguments.length&&(h=arguments[2],!(a=arguments[1]).equals(n=arguments[0])))throw new rt("Expected "+n+" but encountered "+a+(null!==h?": "+h:""))};var Tt=function(){this._result=null,this._inputLines=Array(2).fill().map(function(){return Array(2)}),this._intPt=new Array(2).fill(null),this._intLineIndex=null,this._isProper=null,this._pa=null,this._pb=null,this._precisionModel=null,this._intPt[0]=new j,this._intPt[1]=new j,this._pa=this._intPt[0],this._pb=this._intPt[1],this._result=0},Jt={DONT_INTERSECT:{configurable:!0},DO_INTERSECT:{configurable:!0},COLLINEAR:{configurable:!0},NO_INTERSECTION:{configurable:!0},POINT_INTERSECTION:{configurable:!0},COLLINEAR_INTERSECTION:{configurable:!0}};Tt.prototype.getIndexAlongSegment=function(n,a){return this.computeIntLineIndex(),this._intLineIndex[n][a]},Tt.prototype.getTopologySummary=function(){var n=new Pt;return this.isEndPoint()&&n.append(" endpoint"),this._isProper&&n.append(" proper"),this.isCollinear()&&n.append(" collinear"),n.toString()},Tt.prototype.computeIntersection=function(n,a,h,d){this._inputLines[0][0]=n,this._inputLines[0][1]=a,this._inputLines[1][0]=h,this._inputLines[1][1]=d,this._result=this.computeIntersect(n,a,h,d)},Tt.prototype.getIntersectionNum=function(){return this._result},Tt.prototype.computeIntLineIndex=function(){if(0===arguments.length)null===this._intLineIndex&&(this._intLineIndex=Array(2).fill().map(function(){return Array(2)}),this.computeIntLineIndex(0),this.computeIntLineIndex(1));else if(1===arguments.length){var n=arguments[0];this.getEdgeDistance(n,0)>this.getEdgeDistance(n,1)?(this._intLineIndex[n][0]=0,this._intLineIndex[n][1]=1):(this._intLineIndex[n][0]=1,this._intLineIndex[n][1]=0)}},Tt.prototype.isProper=function(){return this.hasIntersection()&&this._isProper},Tt.prototype.setPrecisionModel=function(n){this._precisionModel=n},Tt.prototype.isInteriorIntersection=function(){if(0===arguments.length)return!!this.isInteriorIntersection(0)||!!this.isInteriorIntersection(1);if(1===arguments.length){for(var n=arguments[0],a=0;a<this._result;a++)if(!this._intPt[a].equals2D(this._inputLines[n][0])&&!this._intPt[a].equals2D(this._inputLines[n][1]))return!0;return!1}},Tt.prototype.getIntersection=function(n){return this._intPt[n]},Tt.prototype.isEndPoint=function(){return this.hasIntersection()&&!this._isProper},Tt.prototype.hasIntersection=function(){return this._result!==Tt.NO_INTERSECTION},Tt.prototype.getEdgeDistance=function(n,a){return Tt.computeEdgeDistance(this._intPt[a],this._inputLines[n][0],this._inputLines[n][1])},Tt.prototype.isCollinear=function(){return this._result===Tt.COLLINEAR_INTERSECTION},Tt.prototype.toString=function(){return ae.toLineString(this._inputLines[0][0],this._inputLines[0][1])+" - "+ae.toLineString(this._inputLines[1][0],this._inputLines[1][1])+this.getTopologySummary()},Tt.prototype.getEndpoint=function(n,a){return this._inputLines[n][a]},Tt.prototype.isIntersection=function(n){for(var a=0;a<this._result;a++)if(this._intPt[a].equals2D(n))return!0;return!1},Tt.prototype.getIntersectionAlongSegment=function(n,a){return this.computeIntLineIndex(),this._intPt[this._intLineIndex[n][a]]},Tt.prototype.interfaces_=function(){return[]},Tt.prototype.getClass=function(){return Tt},Tt.computeEdgeDistance=function(n,a,h){var d=Math.abs(h.x-a.x),w=Math.abs(h.y-a.y),O=-1;if(n.equals(a))O=0;else if(n.equals(h))O=d>w?d:w;else{var k=Math.abs(n.x-a.x),W=Math.abs(n.y-a.y);0!==(O=d>w?k:W)||n.equals(a)||(O=Math.max(k,W))}return $.isTrue(!(0===O&&!n.equals(a)),"Bad distance calculation"),O},Tt.nonRobustComputeEdgeDistance=function(n,a,h){var d=n.x-a.x,w=n.y-a.y,O=Math.sqrt(d*d+w*w);return $.isTrue(!(0===O&&!n.equals(a)),"Invalid distance calculation"),O},Jt.DONT_INTERSECT.get=function(){return 0},Jt.DO_INTERSECT.get=function(){return 1},Jt.COLLINEAR.get=function(){return 2},Jt.NO_INTERSECTION.get=function(){return 0},Jt.POINT_INTERSECTION.get=function(){return 1},Jt.COLLINEAR_INTERSECTION.get=function(){return 2},Object.defineProperties(Tt,Jt);var Ee=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.isInSegmentEnvelopes=function(h){var d=new Be(this._inputLines[0][0],this._inputLines[0][1]),w=new Be(this._inputLines[1][0],this._inputLines[1][1]);return d.contains(h)&&w.contains(h)},a.prototype.computeIntersection=function(){if(3!==arguments.length)return n.prototype.computeIntersection.apply(this,arguments);var h=arguments[0],d=arguments[1],w=arguments[2];if(this._isProper=!1,Be.intersects(d,w,h)&&0===Le.orientationIndex(d,w,h)&&0===Le.orientationIndex(w,d,h))return this._isProper=!0,(h.equals(d)||h.equals(w))&&(this._isProper=!1),this._result=n.POINT_INTERSECTION,null;this._result=n.NO_INTERSECTION},a.prototype.normalizeToMinimum=function(h,d,w,O,k){k.x=this.smallestInAbsValue(h.x,d.x,w.x,O.x),k.y=this.smallestInAbsValue(h.y,d.y,w.y,O.y),h.x-=k.x,h.y-=k.y,d.x-=k.x,d.y-=k.y,w.x-=k.x,w.y-=k.y,O.x-=k.x,O.y-=k.y},a.prototype.safeHCoordinateIntersection=function(h,d,w,O){var k=null;try{k=Mr.intersection(h,d,w,O)}catch(W){if(!(W instanceof Yr))throw W;k=a.nearestEndpoint(h,d,w,O)}return k},a.prototype.intersection=function(h,d,w,O){var k=this.intersectionWithNormalization(h,d,w,O);return this.isInSegmentEnvelopes(k)||(k=new j(a.nearestEndpoint(h,d,w,O))),null!==this._precisionModel&&this._precisionModel.makePrecise(k),k},a.prototype.smallestInAbsValue=function(h,d,w,O){var k=h,W=Math.abs(k);return Math.abs(d)<W&&(k=d,W=Math.abs(d)),Math.abs(w)<W&&(k=w,W=Math.abs(w)),Math.abs(O)<W&&(k=O),k},a.prototype.checkDD=function(h,d,w,O,k){var W=Fe.intersection(h,d,w,O),mt=this.isInSegmentEnvelopes(W);Cr.out.println("DD in env = "+mt+"  --------------------- "+W),k.distance(W)>1e-4&&Cr.out.println("Distance = "+k.distance(W))},a.prototype.intersectionWithNormalization=function(h,d,w,O){var k=new j(h),W=new j(d),mt=new j(w),Gt=new j(O),Ie=new j;this.normalizeToEnvCentre(k,W,mt,Gt,Ie);var Me=this.safeHCoordinateIntersection(k,W,mt,Gt);return Me.x+=Ie.x,Me.y+=Ie.y,Me},a.prototype.computeCollinearIntersection=function(h,d,w,O){var k=Be.intersects(h,d,w),W=Be.intersects(h,d,O),mt=Be.intersects(w,O,h),Gt=Be.intersects(w,O,d);return k&&W?(this._intPt[0]=w,this._intPt[1]=O,n.COLLINEAR_INTERSECTION):mt&&Gt?(this._intPt[0]=h,this._intPt[1]=d,n.COLLINEAR_INTERSECTION):k&&mt?(this._intPt[0]=w,this._intPt[1]=h,!w.equals(h)||W||Gt?n.COLLINEAR_INTERSECTION:n.POINT_INTERSECTION):k&&Gt?(this._intPt[0]=w,this._intPt[1]=d,!w.equals(d)||W||mt?n.COLLINEAR_INTERSECTION:n.POINT_INTERSECTION):W&&mt?(this._intPt[0]=O,this._intPt[1]=h,!O.equals(h)||k||Gt?n.COLLINEAR_INTERSECTION:n.POINT_INTERSECTION):W&&Gt?(this._intPt[0]=O,this._intPt[1]=d,!O.equals(d)||k||mt?n.COLLINEAR_INTERSECTION:n.POINT_INTERSECTION):n.NO_INTERSECTION},a.prototype.normalizeToEnvCentre=function(h,d,w,O,k){var W=h.x<d.x?h.x:d.x,mt=h.y<d.y?h.y:d.y,Gt=h.x>d.x?h.x:d.x,Ie=h.y>d.y?h.y:d.y,Me=w.x<O.x?w.x:O.x,Ke=w.y<O.y?w.y:O.y,gr=w.x>O.x?w.x:O.x,Or=w.y>O.y?w.y:O.y,Kn=((mt>Ke?mt:Ke)+(Ie<Or?Ie:Or))/2;k.x=((W>Me?W:Me)+(Gt<gr?Gt:gr))/2,k.y=Kn,h.x-=k.x,h.y-=k.y,d.x-=k.x,d.y-=k.y,w.x-=k.x,w.y-=k.y,O.x-=k.x,O.y-=k.y},a.prototype.computeIntersect=function(h,d,w,O){if(this._isProper=!1,!Be.intersects(h,d,w,O))return n.NO_INTERSECTION;var k=Le.orientationIndex(h,d,w),W=Le.orientationIndex(h,d,O);if(k>0&&W>0||k<0&&W<0)return n.NO_INTERSECTION;var mt=Le.orientationIndex(w,O,h),Gt=Le.orientationIndex(w,O,d);return mt>0&&Gt>0||mt<0&&Gt<0?n.NO_INTERSECTION:0===k&&0===W&&0===mt&&0===Gt?this.computeCollinearIntersection(h,d,w,O):(0===k||0===W||0===mt||0===Gt?(this._isProper=!1,h.equals2D(w)||h.equals2D(O)?this._intPt[0]=h:d.equals2D(w)||d.equals2D(O)?this._intPt[0]=d:0===k?this._intPt[0]=new j(w):0===W?this._intPt[0]=new j(O):0===mt?this._intPt[0]=new j(h):0===Gt&&(this._intPt[0]=new j(d))):(this._isProper=!0,this._intPt[0]=this.intersection(h,d,w,O)),n.POINT_INTERSECTION)},a.prototype.interfaces_=function(){return[]},a.prototype.getClass=function(){return a},a.nearestEndpoint=function(h,d,w,O){var k=h,W=Le.distancePointLine(h,w,O),mt=Le.distancePointLine(d,w,O);return mt<W&&(W=mt,k=d),(mt=Le.distancePointLine(w,h,d))<W&&(W=mt,k=w),(mt=Le.distancePointLine(O,h,d))<W&&(W=mt,k=O),k},a}(Tt),Ge=function(){};Ge.prototype.interfaces_=function(){return[]},Ge.prototype.getClass=function(){return Ge},Ge.orientationIndex=function(n,a,h){return Ge.signOfDet2x2(a.x-n.x,a.y-n.y,h.x-a.x,h.y-a.y)},Ge.signOfDet2x2=function(n,a,h,d){var w=null,O=null,k=null;if(w=1,0===n||0===d)return 0===a||0===h?0:a>0?h>0?-w:w:h>0?w:-w;if(0===a||0===h)return d>0?n>0?w:-w:n>0?-w:w;if(a>0?d>0?a<=d||(w=-w,O=n,n=h,h=O,O=a,a=d,d=O):a<=-d?(w=-w,h=-h,d=-d):(O=n,n=-h,h=O,O=a,a=-d,d=O):d>0?-a<=d?(w=-w,n=-n,a=-a):(O=-n,n=h,h=O,O=-a,a=d,d=O):a>=d?(n=-n,a=-a,h=-h,d=-d):(w=-w,O=-n,n=-h,h=O,O=-a,a=-d,d=O),n>0){if(!(h>0&&n<=h))return w}else{if(h>0||!(n>=h))return-w;w=-w,n=-n,h=-h}for(;;){if((d-=(k=Math.floor(h/n))*a)<0)return-w;if(d>a)return w;if(n>(h-=k*n)+h){if(a<d+d)return w}else{if(a>d+d)return-w;h=n-h,d=a-d,w=-w}if(0===d)return 0===h?0:-w;if(0===h||(n-=(k=Math.floor(n/h))*h,(a-=k*d)<0))return w;if(a>d)return-w;if(h>n+n){if(d<a+a)return-w}else{if(d>a+a)return w;n=h-n,a=d-a,w=-w}if(0===a)return 0===n?0:w;if(0===n)return-w}};var We=function(){this._p=null,this._crossingCount=0,this._isPointOnSegment=!1,this._p=arguments[0]};We.prototype.countSegment=function(n,a){if(n.x<this._p.x&&a.x<this._p.x)return null;if(this._p.x===a.x&&this._p.y===a.y)return this._isPointOnSegment=!0,null;if(n.y===this._p.y&&a.y===this._p.y){var h=n.x,d=a.x;return h>d&&(h=a.x,d=n.x),this._p.x>=h&&this._p.x<=d&&(this._isPointOnSegment=!0),null}if(n.y>this._p.y&&a.y<=this._p.y||a.y>this._p.y&&n.y<=this._p.y){var O=n.y-this._p.y,W=a.y-this._p.y,mt=Ge.signOfDet2x2(n.x-this._p.x,O,a.x-this._p.x,W);if(0===mt)return this._isPointOnSegment=!0,null;W<O&&(mt=-mt),mt>0&&this._crossingCount++}},We.prototype.isPointInPolygon=function(){return this.getLocation()!==at.EXTERIOR},We.prototype.getLocation=function(){return this._isPointOnSegment?at.BOUNDARY:this._crossingCount%2==1?at.INTERIOR:at.EXTERIOR},We.prototype.isOnSegment=function(){return this._isPointOnSegment},We.prototype.interfaces_=function(){return[]},We.prototype.getClass=function(){return We},We.locatePointInRing=function(){if(arguments[0]instanceof j&&Te(arguments[1],De)){for(var a=arguments[1],h=new We(arguments[0]),d=new j,w=new j,O=1;O<a.size();O++)if(a.getCoordinate(O,d),a.getCoordinate(O-1,w),h.countSegment(d,w),h.isOnSegment())return h.getLocation();return h.getLocation()}if(arguments[0]instanceof j&&arguments[1]instanceof Array){for(var W=arguments[1],mt=new We(arguments[0]),Gt=1;Gt<W.length;Gt++)if(mt.countSegment(W[Gt],W[Gt-1]),mt.isOnSegment())return mt.getLocation();return mt.getLocation()}};var Le=function(){},tn={CLOCKWISE:{configurable:!0},RIGHT:{configurable:!0},COUNTERCLOCKWISE:{configurable:!0},LEFT:{configurable:!0},COLLINEAR:{configurable:!0},STRAIGHT:{configurable:!0}};Le.prototype.interfaces_=function(){return[]},Le.prototype.getClass=function(){return Le},Le.orientationIndex=function(n,a,h){return Fe.orientationIndex(n,a,h)},Le.signedArea=function(){if(arguments[0]instanceof Array){var n=arguments[0];if(n.length<3)return 0;for(var a=0,h=n[0].x,d=1;d<n.length-1;d++)a+=(n[d].x-h)*(n[d-1].y-n[d+1].y);return a/2}if(Te(arguments[0],De)){var k=arguments[0],W=k.size();if(W<3)return 0;var mt=new j,Gt=new j,Ie=new j;k.getCoordinate(0,Gt),k.getCoordinate(1,Ie);var Me=Gt.x;Ie.x-=Me;for(var Ke=0,gr=1;gr<W-1;gr++)mt.y=Gt.y,Gt.x=Ie.x,Gt.y=Ie.y,k.getCoordinate(gr+1,Ie),Ie.x-=Me,Ke+=Gt.x*(mt.y-Ie.y);return Ke/2}},Le.distanceLineLine=function(n,a,h,d){if(n.equals(a))return Le.distancePointLine(n,h,d);if(h.equals(d))return Le.distancePointLine(d,n,a);var w=!1;if(Be.intersects(n,a,h,d)){var O=(a.x-n.x)*(d.y-h.y)-(a.y-n.y)*(d.x-h.x);if(0===O)w=!0;else{var W=((n.y-h.y)*(a.x-n.x)-(n.x-h.x)*(a.y-n.y))/O,mt=((n.y-h.y)*(d.x-h.x)-(n.x-h.x)*(d.y-h.y))/O;(mt<0||mt>1||W<0||W>1)&&(w=!0)}}else w=!0;return w?Et.min(Le.distancePointLine(n,h,d),Le.distancePointLine(a,h,d),Le.distancePointLine(h,n,a),Le.distancePointLine(d,n,a)):0},Le.isPointInRing=function(n,a){return Le.locatePointInRing(n,a)!==at.EXTERIOR},Le.computeLength=function(n){var a=n.size();if(a<=1)return 0;var h=0,d=new j;n.getCoordinate(0,d);for(var w=d.x,O=d.y,k=1;k<a;k++){n.getCoordinate(k,d);var W=d.x,mt=d.y,Gt=W-w,Ie=mt-O;h+=Math.sqrt(Gt*Gt+Ie*Ie),w=W,O=mt}return h},Le.isCCW=function(n){var a=n.length-1;if(a<3)throw new J("Ring has fewer than 4 points, so orientation cannot be determined");for(var h=n[0],d=0,w=1;w<=a;w++){var O=n[w];O.y>h.y&&(h=O,d=w)}var k=d;do{(k-=1)<0&&(k=a)}while(n[k].equals2D(h)&&k!==d);var W=d;do{W=(W+1)%a}while(n[W].equals2D(h)&&W!==d);var mt=n[k],Gt=n[W];if(mt.equals2D(h)||Gt.equals2D(h)||mt.equals2D(Gt))return!1;var Ie=Le.computeOrientation(mt,h,Gt);return 0===Ie?mt.x>Gt.x:Ie>0},Le.locatePointInRing=function(n,a){return We.locatePointInRing(n,a)},Le.distancePointLinePerpendicular=function(n,a,h){var d=(h.x-a.x)*(h.x-a.x)+(h.y-a.y)*(h.y-a.y);return Math.abs(((a.y-n.y)*(h.x-a.x)-(a.x-n.x)*(h.y-a.y))/d)*Math.sqrt(d)},Le.computeOrientation=function(n,a,h){return Le.orientationIndex(n,a,h)},Le.distancePointLine=function(){if(2===arguments.length){var n=arguments[0],a=arguments[1];if(0===a.length)throw new J("Line array must contain at least one vertex");for(var h=n.distance(a[0]),d=0;d<a.length-1;d++){var w=Le.distancePointLine(n,a[d],a[d+1]);w<h&&(h=w)}return h}if(3===arguments.length){var O=arguments[0],k=arguments[1],W=arguments[2];if(k.x===W.x&&k.y===W.y)return O.distance(k);var mt=(W.x-k.x)*(W.x-k.x)+(W.y-k.y)*(W.y-k.y),Gt=((O.x-k.x)*(W.x-k.x)+(O.y-k.y)*(W.y-k.y))/mt;return Gt<=0?O.distance(k):Gt>=1?O.distance(W):Math.abs(((k.y-O.y)*(W.x-k.x)-(k.x-O.x)*(W.y-k.y))/mt)*Math.sqrt(mt)}},Le.isOnLine=function(n,a){for(var h=new Ee,d=1;d<a.length;d++)if(h.computeIntersection(n,a[d-1],a[d]),h.hasIntersection())return!0;return!1},tn.CLOCKWISE.get=function(){return-1},tn.RIGHT.get=function(){return Le.CLOCKWISE},tn.COUNTERCLOCKWISE.get=function(){return 1},tn.LEFT.get=function(){return Le.COUNTERCLOCKWISE},tn.COLLINEAR.get=function(){return 0},tn.STRAIGHT.get=function(){return Le.COLLINEAR},Object.defineProperties(Le,tn);var gn=function(){};gn.prototype.filter=function(n){},gn.prototype.interfaces_=function(){return[]},gn.prototype.getClass=function(){return gn};var sr=function(){var n=arguments[0];this._envelope=null,this._factory=null,this._SRID=null,this._userData=null,this._factory=n,this._SRID=n.getSRID()},vn={serialVersionUID:{configurable:!0},SORTINDEX_POINT:{configurable:!0},SORTINDEX_MULTIPOINT:{configurable:!0},SORTINDEX_LINESTRING:{configurable:!0},SORTINDEX_LINEARRING:{configurable:!0},SORTINDEX_MULTILINESTRING:{configurable:!0},SORTINDEX_POLYGON:{configurable:!0},SORTINDEX_MULTIPOLYGON:{configurable:!0},SORTINDEX_GEOMETRYCOLLECTION:{configurable:!0},geometryChangedFilter:{configurable:!0}};sr.prototype.isGeometryCollection=function(){return this.getSortIndex()===sr.SORTINDEX_GEOMETRYCOLLECTION},sr.prototype.getFactory=function(){return this._factory},sr.prototype.getGeometryN=function(n){return this},sr.prototype.getArea=function(){return 0},sr.prototype.isRectangle=function(){return!1},sr.prototype.equals=function(){if(arguments[0]instanceof sr){var n=arguments[0];return null!==n&&this.equalsTopo(n)}if(arguments[0]instanceof Object){var a=arguments[0];return a instanceof sr&&this.equalsExact(a)}},sr.prototype.equalsExact=function(n){return this===n||this.equalsExact(n,0)},sr.prototype.geometryChanged=function(){this.apply(sr.geometryChangedFilter)},sr.prototype.geometryChangedAction=function(){this._envelope=null},sr.prototype.equalsNorm=function(n){return null!==n&&this.norm().equalsExact(n.norm())},sr.prototype.getLength=function(){return 0},sr.prototype.getNumGeometries=function(){return 1},sr.prototype.compareTo=function(){if(1===arguments.length){var n=arguments[0],a=n;return this.getSortIndex()!==a.getSortIndex()?this.getSortIndex()-a.getSortIndex():this.isEmpty()&&a.isEmpty()?0:this.isEmpty()?-1:a.isEmpty()?1:this.compareToSameClass(n)}if(2===arguments.length){var h=arguments[0],d=arguments[1];return this.getSortIndex()!==h.getSortIndex()?this.getSortIndex()-h.getSortIndex():this.isEmpty()&&h.isEmpty()?0:this.isEmpty()?-1:h.isEmpty()?1:this.compareToSameClass(h,d)}},sr.prototype.getUserData=function(){return this._userData},sr.prototype.getSRID=function(){return this._SRID},sr.prototype.getEnvelope=function(){return this.getFactory().toGeometry(this.getEnvelopeInternal())},sr.prototype.checkNotGeometryCollection=function(n){if(n.getSortIndex()===sr.SORTINDEX_GEOMETRYCOLLECTION)throw new J("This method does not support GeometryCollection arguments")},sr.prototype.equal=function(n,a,h){return 0===h?n.equals(a):n.distance(a)<=h},sr.prototype.norm=function(){var n=this.copy();return n.normalize(),n},sr.prototype.getPrecisionModel=function(){return this._factory.getPrecisionModel()},sr.prototype.getEnvelopeInternal=function(){return null===this._envelope&&(this._envelope=this.computeEnvelopeInternal()),new Be(this._envelope)},sr.prototype.setSRID=function(n){this._SRID=n},sr.prototype.setUserData=function(n){this._userData=n},sr.prototype.compare=function(n,a){for(var h=n.iterator(),d=a.iterator();h.hasNext()&&d.hasNext();){var w=h.next(),O=d.next(),k=w.compareTo(O);if(0!==k)return k}return h.hasNext()?1:d.hasNext()?-1:0},sr.prototype.hashCode=function(){return this.getEnvelopeInternal().hashCode()},sr.prototype.isGeometryCollectionOrDerived=function(){return this.getSortIndex()===sr.SORTINDEX_GEOMETRYCOLLECTION||this.getSortIndex()===sr.SORTINDEX_MULTIPOINT||this.getSortIndex()===sr.SORTINDEX_MULTILINESTRING||this.getSortIndex()===sr.SORTINDEX_MULTIPOLYGON},sr.prototype.interfaces_=function(){return[tt,et,yt]},sr.prototype.getClass=function(){return sr},sr.hasNonEmptyElements=function(n){for(var a=0;a<n.length;a++)if(!n[a].isEmpty())return!0;return!1},sr.hasNullElements=function(n){for(var a=0;a<n.length;a++)if(null===n[a])return!0;return!1},vn.serialVersionUID.get=function(){return 0x799ea46522854c00},vn.SORTINDEX_POINT.get=function(){return 0},vn.SORTINDEX_MULTIPOINT.get=function(){return 1},vn.SORTINDEX_LINESTRING.get=function(){return 2},vn.SORTINDEX_LINEARRING.get=function(){return 3},vn.SORTINDEX_MULTILINESTRING.get=function(){return 4},vn.SORTINDEX_POLYGON.get=function(){return 5},vn.SORTINDEX_MULTIPOLYGON.get=function(){return 6},vn.SORTINDEX_GEOMETRYCOLLECTION.get=function(){return 7},vn.geometryChangedFilter.get=function(){return Bn},Object.defineProperties(sr,vn);var Bn=function(){};Bn.interfaces_=function(){return[gn]},Bn.filter=function(n){n.geometryChangedAction()};var Dn=function(){};Dn.prototype.filter=function(n){},Dn.prototype.interfaces_=function(){return[]},Dn.prototype.getClass=function(){return Dn};var Rn=function(){},Ii={Mod2BoundaryNodeRule:{configurable:!0},EndPointBoundaryNodeRule:{configurable:!0},MultiValentEndPointBoundaryNodeRule:{configurable:!0},MonoValentEndPointBoundaryNodeRule:{configurable:!0},MOD2_BOUNDARY_RULE:{configurable:!0},ENDPOINT_BOUNDARY_RULE:{configurable:!0},MULTIVALENT_ENDPOINT_BOUNDARY_RULE:{configurable:!0},MONOVALENT_ENDPOINT_BOUNDARY_RULE:{configurable:!0},OGC_SFS_BOUNDARY_RULE:{configurable:!0}};Rn.prototype.isInBoundary=function(n){},Rn.prototype.interfaces_=function(){return[]},Rn.prototype.getClass=function(){return Rn},Ii.Mod2BoundaryNodeRule.get=function(){return Gi},Ii.EndPointBoundaryNodeRule.get=function(){return vo},Ii.MultiValentEndPointBoundaryNodeRule.get=function(){return Yi},Ii.MonoValentEndPointBoundaryNodeRule.get=function(){return lo},Ii.MOD2_BOUNDARY_RULE.get=function(){return new Gi},Ii.ENDPOINT_BOUNDARY_RULE.get=function(){return new vo},Ii.MULTIVALENT_ENDPOINT_BOUNDARY_RULE.get=function(){return new Yi},Ii.MONOVALENT_ENDPOINT_BOUNDARY_RULE.get=function(){return new lo},Ii.OGC_SFS_BOUNDARY_RULE.get=function(){return Rn.MOD2_BOUNDARY_RULE},Object.defineProperties(Rn,Ii);var Gi=function(){};Gi.prototype.isInBoundary=function(n){return n%2==1},Gi.prototype.interfaces_=function(){return[Rn]},Gi.prototype.getClass=function(){return Gi};var vo=function(){};vo.prototype.isInBoundary=function(n){return n>0},vo.prototype.interfaces_=function(){return[Rn]},vo.prototype.getClass=function(){return vo};var Yi=function(){};Yi.prototype.isInBoundary=function(n){return n>1},Yi.prototype.interfaces_=function(){return[Rn]},Yi.prototype.getClass=function(){return Yi};var lo=function(){};lo.prototype.isInBoundary=function(n){return 1===n},lo.prototype.interfaces_=function(){return[Rn]},lo.prototype.getClass=function(){return lo};var ei=function(){};ei.prototype.add=function(){},ei.prototype.addAll=function(){},ei.prototype.isEmpty=function(){},ei.prototype.iterator=function(){},ei.prototype.size=function(){},ei.prototype.toArray=function(){},ei.prototype.remove=function(){},(b.prototype=new Error).name="IndexOutOfBoundsException";var _o=function(){};_o.prototype.hasNext=function(){},_o.prototype.next=function(){},_o.prototype.remove=function(){};var ki=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.get=function(){},a.prototype.set=function(){},a.prototype.isEmpty=function(){},a}(ei);(v.prototype=new Error).name="NoSuchElementException";var Je=function(n){function a(){n.call(this),this.array_=[],arguments[0]instanceof ei&&this.addAll(arguments[0])}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.ensureCapacity=function(){},a.prototype.interfaces_=function(){return[n,ei]},a.prototype.add=function(h){return 1===arguments.length?this.array_.push(h):this.array_.splice(arguments[0],arguments[1]),!0},a.prototype.clear=function(){this.array_=[]},a.prototype.addAll=function(h){for(var d=h.iterator();d.hasNext();)this.add(d.next());return!0},a.prototype.set=function(h,d){var w=this.array_[h];return this.array_[h]=d,w},a.prototype.iterator=function(){return new di(this)},a.prototype.get=function(h){if(h<0||h>=this.size())throw new b;return this.array_[h]},a.prototype.isEmpty=function(){return 0===this.array_.length},a.prototype.size=function(){return this.array_.length},a.prototype.toArray=function(){for(var h=[],d=0,w=this.array_.length;d<w;d++)h.push(this.array_[d]);return h},a.prototype.remove=function(h){for(var d=!1,w=0,O=this.array_.length;w<O;w++)if(this.array_[w]===h){this.array_.splice(w,1),d=!0;break}return d},a}(ki),di=function(n){function a(h){n.call(this),this.arrayList_=h,this.position_=0}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.next=function(){if(this.position_===this.arrayList_.size())throw new v;return this.arrayList_.get(this.position_++)},a.prototype.hasNext=function(){return this.position_<this.arrayList_.size()},a.prototype.set=function(h){return this.arrayList_.set(this.position_-1,h)},a.prototype.remove=function(){this.arrayList_.remove(this.arrayList_.get(this.position_))},a}(_o),V=function(n){function a(){if(n.call(this),0!==arguments.length)if(1===arguments.length){var d=arguments[0];this.ensureCapacity(d.length),this.add(d,!0)}else if(2===arguments.length){var w=arguments[0],O=arguments[1];this.ensureCapacity(w.length),this.add(w,O)}}n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a;var h={coordArrayType:{configurable:!0}};return h.coordArrayType.get=function(){return new Array(0).fill(null)},a.prototype.getCoordinate=function(d){return this.get(d)},a.prototype.addAll=function(){if(2===arguments.length){for(var w=arguments[1],O=!1,k=arguments[0].iterator();k.hasNext();)this.add(k.next(),w),O=!0;return O}return n.prototype.addAll.apply(this,arguments)},a.prototype.clone=function(){for(var d=n.prototype.clone.call(this),w=0;w<this.size();w++)d.add(w,this.get(w).copy());return d},a.prototype.toCoordinateArray=function(){return this.toArray(a.coordArrayType)},a.prototype.add=function(){if(1===arguments.length)n.prototype.add.call(this,arguments[0]);else if(2===arguments.length){if(arguments[0]instanceof Array&&"boolean"==typeof arguments[1])return this.add(arguments[0],arguments[1],!0),!0;if(arguments[0]instanceof j&&"boolean"==typeof arguments[1]){var k=arguments[0];if(!arguments[1]&&this.size()>=1&&this.get(this.size()-1).equals2D(k))return null;n.prototype.add.call(this,k)}else if(arguments[0]instanceof Object&&"boolean"==typeof arguments[1])return this.add(arguments[0],arguments[1]),!0}else if(3===arguments.length){if("boolean"==typeof arguments[2]&&arguments[0]instanceof Array&&"boolean"==typeof arguments[1]){var Gt=arguments[0],Ie=arguments[1];if(arguments[2])for(var Me=0;Me<Gt.length;Me++)this.add(Gt[Me],Ie);else for(var Ke=Gt.length-1;Ke>=0;Ke--)this.add(Gt[Ke],Ie);return!0}if("boolean"==typeof arguments[2]&&Number.isInteger(arguments[0])&&arguments[1]instanceof j){var gr=arguments[0],Or=arguments[1];if(!arguments[2]){var Zr=this.size();if(Zr>0&&(gr>0&&this.get(gr-1).equals2D(Or)||gr<Zr&&this.get(gr).equals2D(Or)))return null}n.prototype.add.call(this,gr,Or)}}else if(4===arguments.length){var Kn=arguments[0],l=arguments[1],p=arguments[2],c=arguments[3],y=1;p>c&&(y=-1);for(var C=p;C!==c;C+=y)this.add(Kn[C],l);return!0}},a.prototype.closeRing=function(){this.size()>0&&this.add(new j(this.get(0)),!1)},a.prototype.interfaces_=function(){return[]},a.prototype.getClass=function(){return a},Object.defineProperties(a,h),a}(Je),Y=function(){},it={ForwardComparator:{configurable:!0},BidirectionalComparator:{configurable:!0},coordArrayType:{configurable:!0}};it.ForwardComparator.get=function(){return ht},it.BidirectionalComparator.get=function(){return Lt},it.coordArrayType.get=function(){return new Array(0).fill(null)},Y.prototype.interfaces_=function(){return[]},Y.prototype.getClass=function(){return Y},Y.isRing=function(n){return!(n.length<4||!n[0].equals2D(n[n.length-1]))},Y.ptNotInList=function(n,a){for(var h=0;h<n.length;h++){var d=n[h];if(Y.indexOf(d,a)<0)return d}return null},Y.scroll=function(n,a){var h=Y.indexOf(a,n);if(h<0)return null;var d=new Array(n.length).fill(null);Cr.arraycopy(n,h,d,0,n.length-h),Cr.arraycopy(n,0,d,n.length-h,h),Cr.arraycopy(d,0,n,0,n.length)},Y.equals=function(){if(2===arguments.length){var n=arguments[0],a=arguments[1];if(n===a)return!0;if(null===n||null===a||n.length!==a.length)return!1;for(var h=0;h<n.length;h++)if(!n[h].equals(a[h]))return!1;return!0}if(3===arguments.length){var d=arguments[0],w=arguments[1],O=arguments[2];if(d===w)return!0;if(null===d||null===w||d.length!==w.length)return!1;for(var k=0;k<d.length;k++)if(0!==O.compare(d[k],w[k]))return!1;return!0}},Y.intersection=function(n,a){for(var h=new V,d=0;d<n.length;d++)a.intersects(n[d])&&h.add(n[d],!0);return h.toCoordinateArray()},Y.hasRepeatedPoints=function(n){for(var a=1;a<n.length;a++)if(n[a-1].equals(n[a]))return!0;return!1},Y.removeRepeatedPoints=function(n){return Y.hasRepeatedPoints(n)?new V(n,!1).toCoordinateArray():n},Y.reverse=function(n){for(var a=n.length-1,h=Math.trunc(a/2),d=0;d<=h;d++){var w=n[d];n[d]=n[a-d],n[a-d]=w}},Y.removeNull=function(n){for(var a=0,h=0;h<n.length;h++)null!==n[h]&&a++;var d=new Array(a).fill(null);if(0===a)return d;for(var w=0,O=0;O<n.length;O++)null!==n[O]&&(d[w++]=n[O]);return d},Y.copyDeep=function(){if(1===arguments.length){for(var n=arguments[0],a=new Array(n.length).fill(null),h=0;h<n.length;h++)a[h]=new j(n[h]);return a}if(5===arguments.length)for(var d=arguments[0],w=arguments[1],O=arguments[2],k=arguments[3],W=arguments[4],mt=0;mt<W;mt++)O[k+mt]=new j(d[w+mt])},Y.isEqualReversed=function(n,a){for(var h=0;h<n.length;h++)if(0!==n[h].compareTo(a[n.length-h-1]))return!1;return!0},Y.envelope=function(n){for(var a=new Be,h=0;h<n.length;h++)a.expandToInclude(n[h]);return a},Y.toCoordinateArray=function(n){return n.toArray(Y.coordArrayType)},Y.atLeastNCoordinatesOrNothing=function(n,a){return a.length>=n?a:[]},Y.indexOf=function(n,a){for(var h=0;h<a.length;h++)if(n.equals(a[h]))return h;return-1},Y.increasingDirection=function(n){for(var a=0;a<Math.trunc(n.length/2);a++){var d=n[a].compareTo(n[n.length-1-a]);if(0!==d)return d}return 1},Y.compare=function(n,a){for(var h=0;h<n.length&&h<a.length;){var d=n[h].compareTo(a[h]);if(0!==d)return d;h++}return h<a.length?-1:h<n.length?1:0},Y.minCoordinate=function(n){for(var a=null,h=0;h<n.length;h++)(null===a||a.compareTo(n[h])>0)&&(a=n[h]);return a},Y.extract=function(n,a,h){a=Et.clamp(a,0,n.length);var d=(h=Et.clamp(h,-1,n.length))-a+1;h<0&&(d=0),a>=n.length&&(d=0),h<a&&(d=0);var w=new Array(d).fill(null);if(0===d)return w;for(var O=0,k=a;k<=h;k++)w[O++]=n[k];return w},Object.defineProperties(Y,it);var ht=function(){};ht.prototype.compare=function(n,a){return Y.compare(n,a)},ht.prototype.interfaces_=function(){return[lt]},ht.prototype.getClass=function(){return ht};var Lt=function(){};Lt.prototype.compare=function(n,a){var h=n,d=a;if(h.length<d.length)return-1;if(h.length>d.length)return 1;if(0===h.length)return 0;var w=Y.compare(h,d);return Y.isEqualReversed(h,d)?0:w},Lt.prototype.OLDcompare=function(n,a){var h=n,d=a;if(h.length<d.length)return-1;if(h.length>d.length)return 1;if(0===h.length)return 0;for(var w=Y.increasingDirection(h),O=Y.increasingDirection(d),k=w>0?0:h.length-1,W=O>0?0:h.length-1,mt=0;mt<h.length;mt++){var Gt=h[k].compareTo(d[W]);if(0!==Gt)return Gt;k+=w,W+=O}return 0},Lt.prototype.interfaces_=function(){return[lt]},Lt.prototype.getClass=function(){return Lt};var Wt=function(){};Wt.prototype.get=function(){},Wt.prototype.put=function(){},Wt.prototype.size=function(){},Wt.prototype.values=function(){},Wt.prototype.entrySet=function(){};var ie=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a}(Wt);(Bt.prototype=new Error).name="OperationNotSupported",(ft.prototype=new ei).contains=function(){};var Ht=function(n){function a(){n.call(this),this.array_=[],arguments[0]instanceof ei&&this.addAll(arguments[0])}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.contains=function(h){for(var d=0,w=this.array_.length;d<w;d++)if(this.array_[d]===h)return!0;return!1},a.prototype.add=function(h){return!this.contains(h)&&(this.array_.push(h),!0)},a.prototype.addAll=function(h){for(var d=h.iterator();d.hasNext();)this.add(d.next());return!0},a.prototype.remove=function(h){throw new Error},a.prototype.size=function(){return this.array_.length},a.prototype.isEmpty=function(){return 0===this.array_.length},a.prototype.toArray=function(){for(var h=[],d=0,w=this.array_.length;d<w;d++)h.push(this.array_[d]);return h},a.prototype.iterator=function(){return new _t(this)},a}(ft),_t=function(n){function a(h){n.call(this),this.hashSet_=h,this.position_=0}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.next=function(){if(this.position_===this.hashSet_.size())throw new v;return this.hashSet_.array_[this.position_++]},a.prototype.hasNext=function(){return this.position_<this.hashSet_.size()},a.prototype.remove=function(){throw new Bt},a}(_o),Ut=0;(ye.prototype=new ie).get=function(n){for(var a=this.root_;null!==a;){var h=n.compareTo(a.key);if(h<0)a=a.left;else{if(!(h>0))return a.value;a=a.right}}return null},ye.prototype.put=function(n,a){if(null===this.root_)return this.root_={key:n,value:a,left:null,right:null,parent:null,color:Ut,getValue:function(){return this.value},getKey:function(){return this.key}},this.size_=1,null;var h,d,w=this.root_;do{if(h=w,(d=n.compareTo(w.key))<0)w=w.left;else{if(!(d>0)){var O=w.value;return w.value=a,O}w=w.right}}while(null!==w);var k={key:n,left:null,right:null,value:a,parent:h,color:Ut,getValue:function(){return this.value},getKey:function(){return this.key}};return d<0?h.left=k:h.right=k,this.fixAfterInsertion(k),this.size_++,null},ye.prototype.fixAfterInsertion=function(n){for(n.color=1;null!=n&&n!==this.root_&&1===n.parent.color;)if(Ft(n)===kt(Ft(Ft(n)))){var a=Ze(Ft(Ft(n)));1===St(a)?(le(Ft(n),Ut),le(a,Ut),le(Ft(Ft(n)),1),n=Ft(Ft(n))):(n===Ze(Ft(n))&&(n=Ft(n),this.rotateLeft(n)),le(Ft(n),Ut),le(Ft(Ft(n)),1),this.rotateRight(Ft(Ft(n))))}else{var h=kt(Ft(Ft(n)));1===St(h)?(le(Ft(n),Ut),le(h,Ut),le(Ft(Ft(n)),1),n=Ft(Ft(n))):(n===kt(Ft(n))&&(n=Ft(n),this.rotateRight(n)),le(Ft(n),Ut),le(Ft(Ft(n)),1),this.rotateLeft(Ft(Ft(n))))}this.root_.color=Ut},ye.prototype.values=function(){var n=new Je,a=this.getFirstEntry();if(null!==a)for(n.add(a.value);null!==(a=ye.successor(a));)n.add(a.value);return n},ye.prototype.entrySet=function(){var n=new Ht,a=this.getFirstEntry();if(null!==a)for(n.add(a);null!==(a=ye.successor(a));)n.add(a);return n},ye.prototype.rotateLeft=function(n){if(null!=n){var a=n.right;n.right=a.left,null!=a.left&&(a.left.parent=n),a.parent=n.parent,null===n.parent?this.root_=a:n.parent.left===n?n.parent.left=a:n.parent.right=a,a.left=n,n.parent=a}},ye.prototype.rotateRight=function(n){if(null!=n){var a=n.left;n.left=a.right,null!=a.right&&(a.right.parent=n),a.parent=n.parent,null===n.parent?this.root_=a:n.parent.right===n?n.parent.right=a:n.parent.left=a,a.right=n,n.parent=a}},ye.prototype.getFirstEntry=function(){var n=this.root_;if(null!=n)for(;null!=n.left;)n=n.left;return n},ye.successor=function(n){if(null===n)return null;if(null!==n.right){for(var a=n.right;null!==a.left;)a=a.left;return a}for(var h=n.parent,d=n;null!==h&&d===h.right;)d=h,h=h.parent;return h},ye.prototype.size=function(){return this.size_};var je=function(){};je.prototype.interfaces_=function(){return[]},je.prototype.getClass=function(){return je},ue.prototype=new ft,(de.prototype=new ue).contains=function(n){for(var a=0,h=this.array_.length;a<h;a++)if(0===this.array_[a].compareTo(n))return!0;return!1},de.prototype.add=function(n){if(this.contains(n))return!1;for(var a=0,h=this.array_.length;a<h;a++)if(1===this.array_[a].compareTo(n))return this.array_.splice(a,0,n),!0;return this.array_.push(n),!0},de.prototype.addAll=function(n){for(var a=n.iterator();a.hasNext();)this.add(a.next());return!0},de.prototype.remove=function(n){throw new Bt},de.prototype.size=function(){return this.array_.length},de.prototype.isEmpty=function(){return 0===this.array_.length},de.prototype.toArray=function(){for(var n=[],a=0,h=this.array_.length;a<h;a++)n.push(this.array_[a]);return n},de.prototype.iterator=function(){return new ur(this)};var ur=function(n){this.treeSet_=n,this.position_=0};ur.prototype.next=function(){if(this.position_===this.treeSet_.size())throw new v;return this.treeSet_.array_[this.position_++]},ur.prototype.hasNext=function(){return this.position_<this.treeSet_.size()},ur.prototype.remove=function(){throw new Bt};var ge=function(){};ge.sort=function(){var n,a,h,w=arguments[0];if(1===arguments.length)w.sort(function(k,W){return k.compareTo(W)});else if(2===arguments.length)h=arguments[1],w.sort(function(k,W){return h.compare(k,W)});else if(3===arguments.length){(a=w.slice(arguments[1],arguments[2])).sort();var O=w.slice(0,arguments[1]).concat(a,w.slice(arguments[2],w.length));for(w.splice(0,w.length),n=0;n<O.length;n++)w.push(O[n])}else if(4===arguments.length)for(a=w.slice(arguments[1],arguments[2]),h=arguments[3],a.sort(function(k,W){return h.compare(k,W)}),O=w.slice(0,arguments[1]).concat(a,w.slice(arguments[2],w.length)),w.splice(0,w.length),n=0;n<O.length;n++)w.push(O[n])},ge.asList=function(n){for(var a=new Je,h=0,d=n.length;h<d;h++)a.add(n[h]);return a};var Oe=function(){},cr={P:{configurable:!0},L:{configurable:!0},A:{configurable:!0},FALSE:{configurable:!0},TRUE:{configurable:!0},DONTCARE:{configurable:!0},SYM_FALSE:{configurable:!0},SYM_TRUE:{configurable:!0},SYM_DONTCARE:{configurable:!0},SYM_P:{configurable:!0},SYM_L:{configurable:!0},SYM_A:{configurable:!0}};cr.P.get=function(){return 0},cr.L.get=function(){return 1},cr.A.get=function(){return 2},cr.FALSE.get=function(){return-1},cr.TRUE.get=function(){return-2},cr.DONTCARE.get=function(){return-3},cr.SYM_FALSE.get=function(){return"F"},cr.SYM_TRUE.get=function(){return"T"},cr.SYM_DONTCARE.get=function(){return"*"},cr.SYM_P.get=function(){return"0"},cr.SYM_L.get=function(){return"1"},cr.SYM_A.get=function(){return"2"},Oe.prototype.interfaces_=function(){return[]},Oe.prototype.getClass=function(){return Oe},Oe.toDimensionSymbol=function(n){switch(n){case Oe.FALSE:return Oe.SYM_FALSE;case Oe.TRUE:return Oe.SYM_TRUE;case Oe.DONTCARE:return Oe.SYM_DONTCARE;case Oe.P:return Oe.SYM_P;case Oe.L:return Oe.SYM_L;case Oe.A:return Oe.SYM_A}throw new J("Unknown dimension value: "+n)},Oe.toDimensionValue=function(n){switch(te.toUpperCase(n)){case Oe.SYM_FALSE:return Oe.FALSE;case Oe.SYM_TRUE:return Oe.TRUE;case Oe.SYM_DONTCARE:return Oe.DONTCARE;case Oe.SYM_P:return Oe.P;case Oe.SYM_L:return Oe.L;case Oe.SYM_A:return Oe.A}throw new J("Unknown dimension symbol: "+n)},Object.defineProperties(Oe,cr);var pr=function(){};pr.prototype.filter=function(n){},pr.prototype.interfaces_=function(){return[]},pr.prototype.getClass=function(){return pr};var Tr=function(){};Tr.prototype.filter=function(n,a){},Tr.prototype.isDone=function(){},Tr.prototype.isGeometryChanged=function(){},Tr.prototype.interfaces_=function(){return[]},Tr.prototype.getClass=function(){return Tr};var Re=function(n){function a(d,w){if(n.call(this,w),this._geometries=d||[],n.hasNullElements(this._geometries))throw new J("geometries must not contain null elements")}n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a;var h={serialVersionUID:{configurable:!0}};return a.prototype.computeEnvelopeInternal=function(){for(var d=new Be,w=0;w<this._geometries.length;w++)d.expandToInclude(this._geometries[w].getEnvelopeInternal());return d},a.prototype.getGeometryN=function(d){return this._geometries[d]},a.prototype.getSortIndex=function(){return n.SORTINDEX_GEOMETRYCOLLECTION},a.prototype.getCoordinates=function(){for(var d=new Array(this.getNumPoints()).fill(null),w=-1,O=0;O<this._geometries.length;O++)for(var k=this._geometries[O].getCoordinates(),W=0;W<k.length;W++)d[++w]=k[W];return d},a.prototype.getArea=function(){for(var d=0,w=0;w<this._geometries.length;w++)d+=this._geometries[w].getArea();return d},a.prototype.equalsExact=function(){if(2===arguments.length){var d=arguments[0],w=arguments[1];if(!this.isEquivalentClass(d))return!1;var O=d;if(this._geometries.length!==O._geometries.length)return!1;for(var k=0;k<this._geometries.length;k++)if(!this._geometries[k].equalsExact(O._geometries[k],w))return!1;return!0}return n.prototype.equalsExact.apply(this,arguments)},a.prototype.normalize=function(){for(var d=0;d<this._geometries.length;d++)this._geometries[d].normalize();ge.sort(this._geometries)},a.prototype.getCoordinate=function(){return this.isEmpty()?null:this._geometries[0].getCoordinate()},a.prototype.getBoundaryDimension=function(){for(var d=Oe.FALSE,w=0;w<this._geometries.length;w++)d=Math.max(d,this._geometries[w].getBoundaryDimension());return d},a.prototype.getDimension=function(){for(var d=Oe.FALSE,w=0;w<this._geometries.length;w++)d=Math.max(d,this._geometries[w].getDimension());return d},a.prototype.getLength=function(){for(var d=0,w=0;w<this._geometries.length;w++)d+=this._geometries[w].getLength();return d},a.prototype.getNumPoints=function(){for(var d=0,w=0;w<this._geometries.length;w++)d+=this._geometries[w].getNumPoints();return d},a.prototype.getNumGeometries=function(){return this._geometries.length},a.prototype.reverse=function(){for(var w=new Array(this._geometries.length).fill(null),O=0;O<this._geometries.length;O++)w[O]=this._geometries[O].reverse();return this.getFactory().createGeometryCollection(w)},a.prototype.compareToSameClass=function(){if(1===arguments.length){var d=arguments[0],w=new de(ge.asList(this._geometries)),O=new de(ge.asList(d._geometries));return this.compare(w,O)}if(2===arguments.length){for(var W=arguments[1],mt=arguments[0],Gt=this.getNumGeometries(),Ie=mt.getNumGeometries(),Me=0;Me<Gt&&Me<Ie;){var Ke=this.getGeometryN(Me),gr=mt.getGeometryN(Me),Or=Ke.compareToSameClass(gr,W);if(0!==Or)return Or;Me++}return Me<Gt?1:Me<Ie?-1:0}},a.prototype.apply=function(){if(Te(arguments[0],Dn))for(var d=arguments[0],w=0;w<this._geometries.length;w++)this._geometries[w].apply(d);else if(Te(arguments[0],Tr)){var O=arguments[0];if(0===this._geometries.length)return null;for(var k=0;k<this._geometries.length&&(this._geometries[k].apply(O),!O.isDone());k++);O.isGeometryChanged()&&this.geometryChanged()}else if(Te(arguments[0],pr)){var W=arguments[0];W.filter(this);for(var mt=0;mt<this._geometries.length;mt++)this._geometries[mt].apply(W)}else if(Te(arguments[0],gn)){var Gt=arguments[0];Gt.filter(this);for(var Ie=0;Ie<this._geometries.length;Ie++)this._geometries[Ie].apply(Gt)}},a.prototype.getBoundary=function(){return this.checkNotGeometryCollection(this),$.shouldNeverReachHere(),null},a.prototype.clone=function(){var d=n.prototype.clone.call(this);d._geometries=new Array(this._geometries.length).fill(null);for(var w=0;w<this._geometries.length;w++)d._geometries[w]=this._geometries[w].clone();return d},a.prototype.getGeometryType=function(){return"GeometryCollection"},a.prototype.copy=function(){for(var d=new Array(this._geometries.length).fill(null),w=0;w<d.length;w++)d[w]=this._geometries[w].copy();return new a(d,this._factory)},a.prototype.isEmpty=function(){for(var d=0;d<this._geometries.length;d++)if(!this._geometries[d].isEmpty())return!1;return!0},a.prototype.interfaces_=function(){return[]},a.prototype.getClass=function(){return a},h.serialVersionUID.get=function(){return-0x4f07bcb1f857d800},Object.defineProperties(a,h),a}(sr),nr=function(n){function a(){n.apply(this,arguments)}n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a;var h={serialVersionUID:{configurable:!0}};return a.prototype.getSortIndex=function(){return sr.SORTINDEX_MULTILINESTRING},a.prototype.equalsExact=function(){if(2===arguments.length){var d=arguments[0],w=arguments[1];return!!this.isEquivalentClass(d)&&n.prototype.equalsExact.call(this,d,w)}return n.prototype.equalsExact.apply(this,arguments)},a.prototype.getBoundaryDimension=function(){return this.isClosed()?Oe.FALSE:0},a.prototype.isClosed=function(){if(this.isEmpty())return!1;for(var d=0;d<this._geometries.length;d++)if(!this._geometries[d].isClosed())return!1;return!0},a.prototype.getDimension=function(){return 1},a.prototype.reverse=function(){for(var d=this._geometries.length,w=new Array(d).fill(null),O=0;O<this._geometries.length;O++)w[d-1-O]=this._geometries[O].reverse();return this.getFactory().createMultiLineString(w)},a.prototype.getBoundary=function(){return new Ue(this).getBoundary()},a.prototype.getGeometryType=function(){return"MultiLineString"},a.prototype.copy=function(){for(var d=new Array(this._geometries.length).fill(null),w=0;w<d.length;w++)d[w]=this._geometries[w].copy();return new a(d,this._factory)},a.prototype.interfaces_=function(){return[je]},a.prototype.getClass=function(){return a},h.serialVersionUID.get=function(){return 0x7155d2ab4afa8000},Object.defineProperties(a,h),a}(Re),Ue=function(){if(this._geom=null,this._geomFact=null,this._bnRule=null,this._endpointMap=null,1===arguments.length){var n=arguments[0],a=Rn.MOD2_BOUNDARY_RULE;this._geom=n,this._geomFact=n.getFactory(),this._bnRule=a}else if(2===arguments.length){var h=arguments[0],d=arguments[1];this._geom=h,this._geomFact=h.getFactory(),this._bnRule=d}};Ue.prototype.boundaryMultiLineString=function(n){if(this._geom.isEmpty())return this.getEmptyMultiPoint();var a=this.computeBoundaryCoordinates(n);return 1===a.length?this._geomFact.createPoint(a[0]):this._geomFact.createMultiPointFromCoords(a)},Ue.prototype.getBoundary=function(){return this._geom instanceof ir?this.boundaryLineString(this._geom):this._geom instanceof nr?this.boundaryMultiLineString(this._geom):this._geom.getBoundary()},Ue.prototype.boundaryLineString=function(n){return this._geom.isEmpty()?this.getEmptyMultiPoint():n.isClosed()?this._bnRule.isInBoundary(2)?n.getStartPoint():this._geomFact.createMultiPoint():this._geomFact.createMultiPoint([n.getStartPoint(),n.getEndPoint()])},Ue.prototype.getEmptyMultiPoint=function(){return this._geomFact.createMultiPoint()},Ue.prototype.computeBoundaryCoordinates=function(n){var a=new Je;this._endpointMap=new ye;for(var h=0;h<n.getNumGeometries();h++){var d=n.getGeometryN(h);0!==d.getNumPoints()&&(this.addEndpoint(d.getCoordinateN(0)),this.addEndpoint(d.getCoordinateN(d.getNumPoints()-1)))}for(var w=this._endpointMap.entrySet().iterator();w.hasNext();){var O=w.next(),k=O.getValue().count;this._bnRule.isInBoundary(k)&&a.add(O.getKey())}return Y.toCoordinateArray(a)},Ue.prototype.addEndpoint=function(n){var a=this._endpointMap.get(n);null===a&&(a=new ln,this._endpointMap.put(n,a)),a.count++},Ue.prototype.interfaces_=function(){return[]},Ue.prototype.getClass=function(){return Ue},Ue.getBoundary=function(){return 1===arguments.length?new Ue(arguments[0]).getBoundary():2===arguments.length?new Ue(arguments[0],arguments[1]).getBoundary():void 0};var ln=function(){this.count=null};ln.prototype.interfaces_=function(){return[]},ln.prototype.getClass=function(){return ln};var Gr=function(){},Sr={NEWLINE:{configurable:!0},SIMPLE_ORDINATE_FORMAT:{configurable:!0}};Gr.prototype.interfaces_=function(){return[]},Gr.prototype.getClass=function(){return Gr},Gr.chars=function(n,a){for(var h=new Array(a).fill(null),d=0;d<a;d++)h[d]=n;return String(h)},Gr.getStackTrace=function(){if(1===arguments.length){var n=arguments[0],a=new function(){},h=new function(){}(a);return n.printStackTrace(h),a.toString()}if(2===arguments.length){for(var w=arguments[1],O="",k=new function(){}(new function(){}(Gr.getStackTrace(arguments[0]))),W=0;W<w;W++)try{O+=k.readLine()+Gr.NEWLINE}catch(mt){if(!(mt instanceof Ye))throw mt;$.shouldNeverReachHere()}return O}},Gr.split=function(n,a){for(var h=a.length,d=new Je,w=""+n,O=w.indexOf(a);O>=0;){var k=w.substring(0,O);d.add(k),O=(w=w.substring(O+h)).indexOf(a)}w.length>0&&d.add(w);for(var W=new Array(d.size()).fill(null),mt=0;mt<W.length;mt++)W[mt]=d.get(mt);return W},Gr.toString=function(){if(1===arguments.length)return Gr.SIMPLE_ORDINATE_FORMAT.format(arguments[0])},Gr.spaces=function(n){return Gr.chars(" ",n)},Sr.NEWLINE.get=function(){return Cr.getProperty("line.separator")},Sr.SIMPLE_ORDINATE_FORMAT.get=function(){return new function(){}("0.#")},Object.defineProperties(Gr,Sr);var un=function(){};un.prototype.interfaces_=function(){return[]},un.prototype.getClass=function(){return un},un.copyCoord=function(n,a,h,d){for(var w=Math.min(n.getDimension(),h.getDimension()),O=0;O<w;O++)h.setOrdinate(d,O,n.getOrdinate(a,O))},un.isRing=function(n){var a=n.size();return 0===a||!(a<=3)&&n.getOrdinate(0,De.X)===n.getOrdinate(a-1,De.X)&&n.getOrdinate(0,De.Y)===n.getOrdinate(a-1,De.Y)},un.isEqual=function(n,a){var h=n.size();if(h!==a.size())return!1;for(var d=Math.min(n.getDimension(),a.getDimension()),w=0;w<h;w++)for(var O=0;O<d;O++){var k=n.getOrdinate(w,O),W=a.getOrdinate(w,O);if(!(n.getOrdinate(w,O)===a.getOrdinate(w,O)||Q.isNaN(k)&&Q.isNaN(W)))return!1}return!0},un.extend=function(n,a,h){var d=n.create(h,a.getDimension()),w=a.size();if(un.copy(a,0,d,0,w),w>0)for(var O=w;O<h;O++)un.copy(a,w-1,d,O,1);return d},un.reverse=function(n){for(var a=n.size()-1,h=Math.trunc(a/2),d=0;d<=h;d++)un.swap(n,d,a-d)},un.swap=function(n,a,h){if(a===h)return null;for(var d=0;d<n.getDimension();d++){var w=n.getOrdinate(a,d);n.setOrdinate(a,d,n.getOrdinate(h,d)),n.setOrdinate(h,d,w)}},un.copy=function(n,a,h,d,w){for(var O=0;O<w;O++)un.copyCoord(n,a+O,h,d+O)},un.toString=function(){if(1===arguments.length){var n=arguments[0],a=n.size();if(0===a)return"()";var h=n.getDimension(),d=new Pt;d.append("(");for(var w=0;w<a;w++){w>0&&d.append(" ");for(var O=0;O<h;O++)O>0&&d.append(","),d.append(Gr.toString(n.getOrdinate(w,O)))}return d.append(")"),d.toString()}},un.ensureValidRing=function(n,a){var h=a.size();return 0===h?a:h<=3?un.createClosedRing(n,a,4):a.getOrdinate(0,De.X)===a.getOrdinate(h-1,De.X)&&a.getOrdinate(0,De.Y)===a.getOrdinate(h-1,De.Y)?a:un.createClosedRing(n,a,h+1)},un.createClosedRing=function(n,a,h){var d=n.create(h,a.getDimension()),w=a.size();un.copy(a,0,d,0,w);for(var O=w;O<h;O++)un.copy(a,0,d,O,1);return d};var ir=function(n){function a(d,w){n.call(this,w),this._points=null,this.init(d)}n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a;var h={serialVersionUID:{configurable:!0}};return a.prototype.computeEnvelopeInternal=function(){return this.isEmpty()?new Be:this._points.expandEnvelope(new Be)},a.prototype.isRing=function(){return this.isClosed()&&this.isSimple()},a.prototype.getSortIndex=function(){return n.SORTINDEX_LINESTRING},a.prototype.getCoordinates=function(){return this._points.toCoordinateArray()},a.prototype.equalsExact=function(){if(2===arguments.length){var d=arguments[0],w=arguments[1];if(!this.isEquivalentClass(d))return!1;var O=d;if(this._points.size()!==O._points.size())return!1;for(var k=0;k<this._points.size();k++)if(!this.equal(this._points.getCoordinate(k),O._points.getCoordinate(k),w))return!1;return!0}return n.prototype.equalsExact.apply(this,arguments)},a.prototype.normalize=function(){for(var d=0;d<Math.trunc(this._points.size()/2);d++){var w=this._points.size()-1-d;if(!this._points.getCoordinate(d).equals(this._points.getCoordinate(w)))return this._points.getCoordinate(d).compareTo(this._points.getCoordinate(w))>0&&un.reverse(this._points),null}},a.prototype.getCoordinate=function(){return this.isEmpty()?null:this._points.getCoordinate(0)},a.prototype.getBoundaryDimension=function(){return this.isClosed()?Oe.FALSE:0},a.prototype.isClosed=function(){return!this.isEmpty()&&this.getCoordinateN(0).equals2D(this.getCoordinateN(this.getNumPoints()-1))},a.prototype.getEndPoint=function(){return this.isEmpty()?null:this.getPointN(this.getNumPoints()-1)},a.prototype.getDimension=function(){return 1},a.prototype.getLength=function(){return Le.computeLength(this._points)},a.prototype.getNumPoints=function(){return this._points.size()},a.prototype.reverse=function(){var d=this._points.copy();return un.reverse(d),this.getFactory().createLineString(d)},a.prototype.compareToSameClass=function(){if(1===arguments.length){for(var d=arguments[0],w=0,O=0;w<this._points.size()&&O<d._points.size();){var k=this._points.getCoordinate(w).compareTo(d._points.getCoordinate(O));if(0!==k)return k;w++,O++}return w<this._points.size()?1:O<d._points.size()?-1:0}if(2===arguments.length)return arguments[1].compare(this._points,arguments[0]._points)},a.prototype.apply=function(){if(Te(arguments[0],Dn))for(var d=arguments[0],w=0;w<this._points.size();w++)d.filter(this._points.getCoordinate(w));else if(Te(arguments[0],Tr)){var O=arguments[0];if(0===this._points.size())return null;for(var k=0;k<this._points.size()&&(O.filter(this._points,k),!O.isDone());k++);O.isGeometryChanged()&&this.geometryChanged()}else(Te(arguments[0],pr)||Te(arguments[0],gn))&&arguments[0].filter(this)},a.prototype.getBoundary=function(){return new Ue(this).getBoundary()},a.prototype.isEquivalentClass=function(d){return d instanceof a},a.prototype.clone=function(){var d=n.prototype.clone.call(this);return d._points=this._points.clone(),d},a.prototype.getCoordinateN=function(d){return this._points.getCoordinate(d)},a.prototype.getGeometryType=function(){return"LineString"},a.prototype.copy=function(){return new a(this._points.copy(),this._factory)},a.prototype.getCoordinateSequence=function(){return this._points},a.prototype.isEmpty=function(){return 0===this._points.size()},a.prototype.init=function(d){if(null===d&&(d=this.getFactory().getCoordinateSequenceFactory().create([])),1===d.size())throw new J("Invalid number of points in LineString (found "+d.size()+" - must be 0 or >= 2)");this._points=d},a.prototype.isCoordinate=function(d){for(var w=0;w<this._points.size();w++)if(this._points.getCoordinate(w).equals(d))return!0;return!1},a.prototype.getStartPoint=function(){return this.isEmpty()?null:this.getPointN(0)},a.prototype.getPointN=function(d){return this.getFactory().createPoint(this._points.getCoordinate(d))},a.prototype.interfaces_=function(){return[je]},a.prototype.getClass=function(){return a},h.serialVersionUID.get=function(){return 0x2b2b51ba435c8e00},Object.defineProperties(a,h),a}(sr),ci=function(){};ci.prototype.interfaces_=function(){return[]},ci.prototype.getClass=function(){return ci};var On=function(n){function a(d,w){n.call(this,w),this._coordinates=d||null,this.init(this._coordinates)}n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a;var h={serialVersionUID:{configurable:!0}};return a.prototype.computeEnvelopeInternal=function(){if(this.isEmpty())return new Be;var d=new Be;return d.expandToInclude(this._coordinates.getX(0),this._coordinates.getY(0)),d},a.prototype.getSortIndex=function(){return n.SORTINDEX_POINT},a.prototype.getCoordinates=function(){return this.isEmpty()?[]:[this.getCoordinate()]},a.prototype.equalsExact=function(){if(2===arguments.length){var d=arguments[0],w=arguments[1];return!!this.isEquivalentClass(d)&&(!(!this.isEmpty()||!d.isEmpty())||this.isEmpty()===d.isEmpty()&&this.equal(d.getCoordinate(),this.getCoordinate(),w))}return n.prototype.equalsExact.apply(this,arguments)},a.prototype.normalize=function(){},a.prototype.getCoordinate=function(){return 0!==this._coordinates.size()?this._coordinates.getCoordinate(0):null},a.prototype.getBoundaryDimension=function(){return Oe.FALSE},a.prototype.getDimension=function(){return 0},a.prototype.getNumPoints=function(){return this.isEmpty()?0:1},a.prototype.reverse=function(){return this.copy()},a.prototype.getX=function(){if(null===this.getCoordinate())throw new Error("getX called on empty Point");return this.getCoordinate().x},a.prototype.compareToSameClass=function(){if(1===arguments.length){var d=arguments[0];return this.getCoordinate().compareTo(d.getCoordinate())}if(2===arguments.length)return arguments[1].compare(this._coordinates,arguments[0]._coordinates)},a.prototype.apply=function(){if(Te(arguments[0],Dn)){var d=arguments[0];if(this.isEmpty())return null;d.filter(this.getCoordinate())}else if(Te(arguments[0],Tr)){var w=arguments[0];if(this.isEmpty())return null;w.filter(this._coordinates,0),w.isGeometryChanged()&&this.geometryChanged()}else(Te(arguments[0],pr)||Te(arguments[0],gn))&&arguments[0].filter(this)},a.prototype.getBoundary=function(){return this.getFactory().createGeometryCollection(null)},a.prototype.clone=function(){var d=n.prototype.clone.call(this);return d._coordinates=this._coordinates.clone(),d},a.prototype.getGeometryType=function(){return"Point"},a.prototype.copy=function(){return new a(this._coordinates.copy(),this._factory)},a.prototype.getCoordinateSequence=function(){return this._coordinates},a.prototype.getY=function(){if(null===this.getCoordinate())throw new Error("getY called on empty Point");return this.getCoordinate().y},a.prototype.isEmpty=function(){return 0===this._coordinates.size()},a.prototype.init=function(d){null===d&&(d=this.getFactory().getCoordinateSequenceFactory().create([])),$.isTrue(d.size()<=1),this._coordinates=d},a.prototype.isSimple=function(){return!0},a.prototype.interfaces_=function(){return[ci]},a.prototype.getClass=function(){return a},h.serialVersionUID.get=function(){return 0x44077bad161cbc00},Object.defineProperties(a,h),a}(sr),wn=function(){};wn.prototype.interfaces_=function(){return[]},wn.prototype.getClass=function(){return wn};var cn=function(n){function a(d,w,O){if(n.call(this,O),this._shell=null,this._holes=null,null===d&&(d=this.getFactory().createLinearRing()),null===w&&(w=[]),n.hasNullElements(w))throw new J("holes must not contain null elements");if(d.isEmpty()&&n.hasNonEmptyElements(w))throw new J("shell is empty but holes are not");this._shell=d,this._holes=w}n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a;var h={serialVersionUID:{configurable:!0}};return a.prototype.computeEnvelopeInternal=function(){return this._shell.getEnvelopeInternal()},a.prototype.getSortIndex=function(){return n.SORTINDEX_POLYGON},a.prototype.getCoordinates=function(){if(this.isEmpty())return[];for(var d=new Array(this.getNumPoints()).fill(null),w=-1,O=this._shell.getCoordinates(),k=0;k<O.length;k++)d[++w]=O[k];for(var W=0;W<this._holes.length;W++)for(var mt=this._holes[W].getCoordinates(),Gt=0;Gt<mt.length;Gt++)d[++w]=mt[Gt];return d},a.prototype.getArea=function(){var d=0;d+=Math.abs(Le.signedArea(this._shell.getCoordinateSequence()));for(var w=0;w<this._holes.length;w++)d-=Math.abs(Le.signedArea(this._holes[w].getCoordinateSequence()));return d},a.prototype.isRectangle=function(){if(0!==this.getNumInteriorRing()||null===this._shell||5!==this._shell.getNumPoints())return!1;for(var d=this._shell.getCoordinateSequence(),w=this.getEnvelopeInternal(),O=0;O<5;O++){var k=d.getX(O);if(k!==w.getMinX()&&k!==w.getMaxX())return!1;var W=d.getY(O);if(W!==w.getMinY()&&W!==w.getMaxY())return!1}for(var mt=d.getX(0),Gt=d.getY(0),Ie=1;Ie<=4;Ie++){var Me=d.getX(Ie),Ke=d.getY(Ie);if(Me!==mt==(Ke!==Gt))return!1;mt=Me,Gt=Ke}return!0},a.prototype.equalsExact=function(){if(2===arguments.length){var d=arguments[0],w=arguments[1];if(!this.isEquivalentClass(d))return!1;var O=d;if(!this._shell.equalsExact(O._shell,w)||this._holes.length!==O._holes.length)return!1;for(var mt=0;mt<this._holes.length;mt++)if(!this._holes[mt].equalsExact(O._holes[mt],w))return!1;return!0}return n.prototype.equalsExact.apply(this,arguments)},a.prototype.normalize=function(){if(0===arguments.length){this.normalize(this._shell,!0);for(var d=0;d<this._holes.length;d++)this.normalize(this._holes[d],!1);ge.sort(this._holes)}else if(2===arguments.length){var w=arguments[0],O=arguments[1];if(w.isEmpty())return null;var k=new Array(w.getCoordinates().length-1).fill(null);Cr.arraycopy(w.getCoordinates(),0,k,0,k.length);var W=Y.minCoordinate(w.getCoordinates());Y.scroll(k,W),Cr.arraycopy(k,0,w.getCoordinates(),0,k.length),w.getCoordinates()[k.length]=k[0],Le.isCCW(w.getCoordinates())===O&&Y.reverse(w.getCoordinates())}},a.prototype.getCoordinate=function(){return this._shell.getCoordinate()},a.prototype.getNumInteriorRing=function(){return this._holes.length},a.prototype.getBoundaryDimension=function(){return 1},a.prototype.getDimension=function(){return 2},a.prototype.getLength=function(){var d=0;d+=this._shell.getLength();for(var w=0;w<this._holes.length;w++)d+=this._holes[w].getLength();return d},a.prototype.getNumPoints=function(){for(var d=this._shell.getNumPoints(),w=0;w<this._holes.length;w++)d+=this._holes[w].getNumPoints();return d},a.prototype.reverse=function(){var d=this.copy();d._shell=this._shell.copy().reverse(),d._holes=new Array(this._holes.length).fill(null);for(var w=0;w<this._holes.length;w++)d._holes[w]=this._holes[w].copy().reverse();return d},a.prototype.convexHull=function(){return this.getExteriorRing().convexHull()},a.prototype.compareToSameClass=function(){if(1===arguments.length)return this._shell.compareToSameClass(arguments[0]._shell);if(2===arguments.length){var W=arguments[1],mt=arguments[0],Me=this._shell.compareToSameClass(mt._shell,W);if(0!==Me)return Me;for(var Ke=this.getNumInteriorRing(),gr=mt.getNumInteriorRing(),Or=0;Or<Ke&&Or<gr;){var Zr=this.getInteriorRingN(Or),Kn=mt.getInteriorRingN(Or),l=Zr.compareToSameClass(Kn,W);if(0!==l)return l;Or++}return Or<Ke?1:Or<gr?-1:0}},a.prototype.apply=function(d){if(Te(d,Dn)){this._shell.apply(d);for(var w=0;w<this._holes.length;w++)this._holes[w].apply(d)}else if(Te(d,Tr)){if(this._shell.apply(d),!d.isDone())for(var O=0;O<this._holes.length&&(this._holes[O].apply(d),!d.isDone());O++);d.isGeometryChanged()&&this.geometryChanged()}else if(Te(d,pr))d.filter(this);else if(Te(d,gn)){d.filter(this),this._shell.apply(d);for(var k=0;k<this._holes.length;k++)this._holes[k].apply(d)}},a.prototype.getBoundary=function(){if(this.isEmpty())return this.getFactory().createMultiLineString();var d=new Array(this._holes.length+1).fill(null);d[0]=this._shell;for(var w=0;w<this._holes.length;w++)d[w+1]=this._holes[w];return d.length<=1?this.getFactory().createLinearRing(d[0].getCoordinateSequence()):this.getFactory().createMultiLineString(d)},a.prototype.clone=function(){var d=n.prototype.clone.call(this);d._shell=this._shell.clone(),d._holes=new Array(this._holes.length).fill(null);for(var w=0;w<this._holes.length;w++)d._holes[w]=this._holes[w].clone();return d},a.prototype.getGeometryType=function(){return"Polygon"},a.prototype.copy=function(){for(var d=this._shell.copy(),w=new Array(this._holes.length).fill(null),O=0;O<w.length;O++)w[O]=this._holes[O].copy();return new a(d,w,this._factory)},a.prototype.getExteriorRing=function(){return this._shell},a.prototype.isEmpty=function(){return this._shell.isEmpty()},a.prototype.getInteriorRingN=function(d){return this._holes[d]},a.prototype.interfaces_=function(){return[wn]},a.prototype.getClass=function(){return a},h.serialVersionUID.get=function(){return-0x307ffefd8dc97200},Object.defineProperties(a,h),a}(sr),gi=function(n){function a(){n.apply(this,arguments)}n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a;var h={serialVersionUID:{configurable:!0}};return a.prototype.getSortIndex=function(){return sr.SORTINDEX_MULTIPOINT},a.prototype.isValid=function(){return!0},a.prototype.equalsExact=function(){if(2===arguments.length){var d=arguments[0],w=arguments[1];return!!this.isEquivalentClass(d)&&n.prototype.equalsExact.call(this,d,w)}return n.prototype.equalsExact.apply(this,arguments)},a.prototype.getCoordinate=function(){return 1===arguments.length?this._geometries[arguments[0]].getCoordinate():n.prototype.getCoordinate.apply(this,arguments)},a.prototype.getBoundaryDimension=function(){return Oe.FALSE},a.prototype.getDimension=function(){return 0},a.prototype.getBoundary=function(){return this.getFactory().createGeometryCollection(null)},a.prototype.getGeometryType=function(){return"MultiPoint"},a.prototype.copy=function(){for(var d=new Array(this._geometries.length).fill(null),w=0;w<d.length;w++)d[w]=this._geometries[w].copy();return new a(d,this._factory)},a.prototype.interfaces_=function(){return[ci]},a.prototype.getClass=function(){return a},h.serialVersionUID.get=function(){return-0x6fb1ed4162e0fc00},Object.defineProperties(a,h),a}(Re),Un=function(n){function a(d,w){d instanceof j&&w instanceof en&&(d=w.getCoordinateSequenceFactory().create(d)),n.call(this,d,w),this.validateConstruction()}n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a;var h={MINIMUM_VALID_SIZE:{configurable:!0},serialVersionUID:{configurable:!0}};return a.prototype.getSortIndex=function(){return sr.SORTINDEX_LINEARRING},a.prototype.getBoundaryDimension=function(){return Oe.FALSE},a.prototype.isClosed=function(){return!!this.isEmpty()||n.prototype.isClosed.call(this)},a.prototype.reverse=function(){var d=this._points.copy();return un.reverse(d),this.getFactory().createLinearRing(d)},a.prototype.validateConstruction=function(){if(!this.isEmpty()&&!n.prototype.isClosed.call(this))throw new J("Points of LinearRing do not form a closed linestring");if(this.getCoordinateSequence().size()>=1&&this.getCoordinateSequence().size()<a.MINIMUM_VALID_SIZE)throw new J("Invalid number of points in LinearRing (found "+this.getCoordinateSequence().size()+" - must be 0 or >= 4)")},a.prototype.getGeometryType=function(){return"LinearRing"},a.prototype.copy=function(){return new a(this._points.copy(),this._factory)},a.prototype.interfaces_=function(){return[]},a.prototype.getClass=function(){return a},h.MINIMUM_VALID_SIZE.get=function(){return 4},h.serialVersionUID.get=function(){return-0x3b229e262367a600},Object.defineProperties(a,h),a}(ir),on=function(n){function a(){n.apply(this,arguments)}n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a;var h={serialVersionUID:{configurable:!0}};return a.prototype.getSortIndex=function(){return sr.SORTINDEX_MULTIPOLYGON},a.prototype.equalsExact=function(){if(2===arguments.length){var d=arguments[0],w=arguments[1];return!!this.isEquivalentClass(d)&&n.prototype.equalsExact.call(this,d,w)}return n.prototype.equalsExact.apply(this,arguments)},a.prototype.getBoundaryDimension=function(){return 1},a.prototype.getDimension=function(){return 2},a.prototype.reverse=function(){for(var w=new Array(this._geometries.length).fill(null),O=0;O<this._geometries.length;O++)w[O]=this._geometries[O].reverse();return this.getFactory().createMultiPolygon(w)},a.prototype.getBoundary=function(){if(this.isEmpty())return this.getFactory().createMultiLineString();for(var d=new Je,w=0;w<this._geometries.length;w++)for(var O=this._geometries[w].getBoundary(),k=0;k<O.getNumGeometries();k++)d.add(O.getGeometryN(k));var W=new Array(d.size()).fill(null);return this.getFactory().createMultiLineString(d.toArray(W))},a.prototype.getGeometryType=function(){return"MultiPolygon"},a.prototype.copy=function(){for(var d=new Array(this._geometries.length).fill(null),w=0;w<d.length;w++)d[w]=this._geometries[w].copy();return new a(d,this._factory)},a.prototype.interfaces_=function(){return[wn]},a.prototype.getClass=function(){return a},h.serialVersionUID.get=function(){return-0x7a5aa1369171980},Object.defineProperties(a,h),a}(Re),Zo=function(n){this._factory=n||null,this._isUserDataCopied=!1},Pn={NoOpGeometryOperation:{configurable:!0},CoordinateOperation:{configurable:!0},CoordinateSequenceOperation:{configurable:!0}};Zo.prototype.setCopyUserData=function(n){this._isUserDataCopied=n},Zo.prototype.edit=function(n,a){if(null===n)return null;var h=this.editInternal(n,a);return this._isUserDataCopied&&h.setUserData(n.getUserData()),h},Zo.prototype.editInternal=function(n,a){return null===this._factory&&(this._factory=n.getFactory()),n instanceof Re?this.editGeometryCollection(n,a):n instanceof cn?this.editPolygon(n,a):n instanceof On||n instanceof ir?a.edit(n,this._factory):($.shouldNeverReachHere("Unsupported Geometry class: "+n.getClass().getName()),null)},Zo.prototype.editGeometryCollection=function(n,a){for(var h=a.edit(n,this._factory),d=new Je,w=0;w<h.getNumGeometries();w++){var O=this.edit(h.getGeometryN(w),a);null===O||O.isEmpty()||d.add(O)}return h.getClass()===gi?this._factory.createMultiPoint(d.toArray([])):h.getClass()===nr?this._factory.createMultiLineString(d.toArray([])):h.getClass()===on?this._factory.createMultiPolygon(d.toArray([])):this._factory.createGeometryCollection(d.toArray([]))},Zo.prototype.editPolygon=function(n,a){var h=a.edit(n,this._factory);if(null===h&&(h=this._factory.createPolygon(null)),h.isEmpty())return h;var d=this.edit(h.getExteriorRing(),a);if(null===d||d.isEmpty())return this._factory.createPolygon();for(var w=new Je,O=0;O<h.getNumInteriorRing();O++){var k=this.edit(h.getInteriorRingN(O),a);null===k||k.isEmpty()||w.add(k)}return this._factory.createPolygon(d,w.toArray([]))},Zo.prototype.interfaces_=function(){return[]},Zo.prototype.getClass=function(){return Zo},Zo.GeometryEditorOperation=function(){},Pn.NoOpGeometryOperation.get=function(){return Ds},Pn.CoordinateOperation.get=function(){return $s},Pn.CoordinateSequenceOperation.get=function(){return no},Object.defineProperties(Zo,Pn);var Ds=function(){};Ds.prototype.edit=function(n,a){return n},Ds.prototype.interfaces_=function(){return[Zo.GeometryEditorOperation]},Ds.prototype.getClass=function(){return Ds};var $s=function(){};$s.prototype.edit=function(n,a){var h=this.editCoordinates(n.getCoordinates(),n);return null===h?n:n instanceof Un?a.createLinearRing(h):n instanceof ir?a.createLineString(h):n instanceof On?h.length>0?a.createPoint(h[0]):a.createPoint():n},$s.prototype.interfaces_=function(){return[Zo.GeometryEditorOperation]},$s.prototype.getClass=function(){return $s};var no=function(){};no.prototype.edit=function(n,a){return n instanceof Un?a.createLinearRing(this.edit(n.getCoordinateSequence(),n)):n instanceof ir?a.createLineString(this.edit(n.getCoordinateSequence(),n)):n instanceof On?a.createPoint(this.edit(n.getCoordinateSequence(),n)):n},no.prototype.interfaces_=function(){return[Zo.GeometryEditorOperation]},no.prototype.getClass=function(){return no};var jn=function(){if(this._dimension=3,this._coordinates=null,1===arguments.length){if(arguments[0]instanceof Array)this._coordinates=arguments[0],this._dimension=3;else if(Number.isInteger(arguments[0])){var n=arguments[0];this._coordinates=new Array(n).fill(null);for(var a=0;a<n;a++)this._coordinates[a]=new j}else if(Te(arguments[0],De)){var h=arguments[0];if(null===h)return this._coordinates=new Array(0).fill(null),null;this._dimension=h.getDimension(),this._coordinates=new Array(h.size()).fill(null);for(var d=0;d<this._coordinates.length;d++)this._coordinates[d]=h.getCoordinateCopy(d)}}else if(2===arguments.length)if(arguments[0]instanceof Array&&Number.isInteger(arguments[1])){var w=arguments[0],O=arguments[1];this._coordinates=w,this._dimension=O,null===w&&(this._coordinates=new Array(0).fill(null))}else if(Number.isInteger(arguments[0])&&Number.isInteger(arguments[1])){var k=arguments[0],W=arguments[1];this._coordinates=new Array(k).fill(null),this._dimension=W;for(var mt=0;mt<k;mt++)this._coordinates[mt]=new j}},_l={serialVersionUID:{configurable:!0}};jn.prototype.setOrdinate=function(n,a,h){switch(a){case De.X:this._coordinates[n].x=h;break;case De.Y:this._coordinates[n].y=h;break;case De.Z:this._coordinates[n].z=h;break;default:throw new J("invalid ordinateIndex")}},jn.prototype.size=function(){return this._coordinates.length},jn.prototype.getOrdinate=function(n,a){switch(a){case De.X:return this._coordinates[n].x;case De.Y:return this._coordinates[n].y;case De.Z:return this._coordinates[n].z}return Q.NaN},jn.prototype.getCoordinate=function(){if(1===arguments.length)return this._coordinates[arguments[0]];if(2===arguments.length){var a=arguments[0],h=arguments[1];h.x=this._coordinates[a].x,h.y=this._coordinates[a].y,h.z=this._coordinates[a].z}},jn.prototype.getCoordinateCopy=function(n){return new j(this._coordinates[n])},jn.prototype.getDimension=function(){return this._dimension},jn.prototype.getX=function(n){return this._coordinates[n].x},jn.prototype.clone=function(){for(var n=new Array(this.size()).fill(null),a=0;a<this._coordinates.length;a++)n[a]=this._coordinates[a].clone();return new jn(n,this._dimension)},jn.prototype.expandEnvelope=function(n){for(var a=0;a<this._coordinates.length;a++)n.expandToInclude(this._coordinates[a]);return n},jn.prototype.copy=function(){for(var n=new Array(this.size()).fill(null),a=0;a<this._coordinates.length;a++)n[a]=this._coordinates[a].copy();return new jn(n,this._dimension)},jn.prototype.toString=function(){if(this._coordinates.length>0){var n=new Pt(17*this._coordinates.length);n.append("("),n.append(this._coordinates[0]);for(var a=1;a<this._coordinates.length;a++)n.append(", "),n.append(this._coordinates[a]);return n.append(")"),n.toString()}return"()"},jn.prototype.getY=function(n){return this._coordinates[n].y},jn.prototype.toCoordinateArray=function(){return this._coordinates},jn.prototype.interfaces_=function(){return[De,yt]},jn.prototype.getClass=function(){return jn},_l.serialVersionUID.get=function(){return-0xcb44a778db18e00},Object.defineProperties(jn,_l);var ma=function(){},xo={serialVersionUID:{configurable:!0},instanceObject:{configurable:!0}};ma.prototype.readResolve=function(){return ma.instance()},ma.prototype.create=function(){if(1===arguments.length){if(arguments[0]instanceof Array)return new jn(arguments[0]);if(Te(arguments[0],De))return new jn(arguments[0])}else if(2===arguments.length){var h=arguments[0],d=arguments[1];return d>3&&(d=3),d<2?new jn(h):new jn(h,d)}},ma.prototype.interfaces_=function(){return[Ot,yt]},ma.prototype.getClass=function(){return ma},ma.instance=function(){return ma.instanceObject},xo.serialVersionUID.get=function(){return-0x38e49fa6cf6f2e00},xo.instanceObject.get=function(){return new ma},Object.defineProperties(ma,xo);var Rs=function(n){function a(){n.call(this),this.map_=new Map}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.get=function(h){return this.map_.get(h)||null},a.prototype.put=function(h,d){return this.map_.set(h,d),d},a.prototype.values=function(){for(var h=new Je,d=this.map_.values(),w=d.next();!w.done;)h.add(w.value),w=d.next();return h},a.prototype.entrySet=function(){var h=new Ht;return this.map_.entries().forEach(function(d){return h.add(d)}),h},a.prototype.size=function(){return this.map_.size()},a}(Wt),En=function n(){if(this._modelType=null,this._scale=null,0===arguments.length)this._modelType=n.FLOATING;else if(1===arguments.length)if(arguments[0]instanceof Wi){var a=arguments[0];this._modelType=a,a===n.FIXED&&this.setScale(1)}else if("number"==typeof arguments[0]){var h=arguments[0];this._modelType=n.FIXED,this.setScale(h)}else if(arguments[0]instanceof n){var d=arguments[0];this._modelType=d._modelType,this._scale=d._scale}},Ai={serialVersionUID:{configurable:!0},maximumPreciseValue:{configurable:!0}};En.prototype.equals=function(n){return n instanceof En&&this._modelType===n._modelType&&this._scale===n._scale},En.prototype.compareTo=function(n){var a=n,h=this.getMaximumSignificantDigits(),d=a.getMaximumSignificantDigits();return new Kt(h).compareTo(new Kt(d))},En.prototype.getScale=function(){return this._scale},En.prototype.isFloating=function(){return this._modelType===En.FLOATING||this._modelType===En.FLOATING_SINGLE},En.prototype.getType=function(){return this._modelType},En.prototype.toString=function(){var n="UNKNOWN";return this._modelType===En.FLOATING?n="Floating":this._modelType===En.FLOATING_SINGLE?n="Floating-Single":this._modelType===En.FIXED&&(n="Fixed (Scale="+this.getScale()+")"),n},En.prototype.makePrecise=function(){if("number"==typeof arguments[0]){var n=arguments[0];return Q.isNaN(n)||this._modelType===En.FLOATING_SINGLE?n:this._modelType===En.FIXED?Math.round(n*this._scale)/this._scale:n}if(arguments[0]instanceof j){var a=arguments[0];if(this._modelType===En.FLOATING)return null;a.x=this.makePrecise(a.x),a.y=this.makePrecise(a.y)}},En.prototype.getMaximumSignificantDigits=function(){var n=16;return this._modelType===En.FLOATING?n=16:this._modelType===En.FLOATING_SINGLE?n=6:this._modelType===En.FIXED&&(n=1+Math.trunc(Math.ceil(Math.log(this.getScale())/Math.log(10)))),n},En.prototype.setScale=function(n){this._scale=Math.abs(n)},En.prototype.interfaces_=function(){return[yt,et]},En.prototype.getClass=function(){return En},En.mostPrecise=function(n,a){return n.compareTo(a)>=0?n:a},Ai.serialVersionUID.get=function(){return 0x6bee6404e9a25c00},Ai.maximumPreciseValue.get=function(){return 9007199254740992},Object.defineProperties(En,Ai);var Wi=function n(a){this._name=a||null,n.nameToTypeMap.put(a,this)},Ao={serialVersionUID:{configurable:!0},nameToTypeMap:{configurable:!0}};Wi.prototype.readResolve=function(){return Wi.nameToTypeMap.get(this._name)},Wi.prototype.toString=function(){return this._name},Wi.prototype.interfaces_=function(){return[yt]},Wi.prototype.getClass=function(){return Wi},Ao.serialVersionUID.get=function(){return-552860263173159e4},Ao.nameToTypeMap.get=function(){return new Rs},Object.defineProperties(Wi,Ao),En.Type=Wi,En.FIXED=new Wi("FIXED"),En.FLOATING=new Wi("FLOATING"),En.FLOATING_SINGLE=new Wi("FLOATING SINGLE");var en=function n(){this._precisionModel=new En,this._SRID=0,this._coordinateSequenceFactory=n.getDefaultCoordinateSequenceFactory(),0===arguments.length||(1===arguments.length?Te(arguments[0],Ot)?this._coordinateSequenceFactory=arguments[0]:arguments[0]instanceof En&&(this._precisionModel=arguments[0]):2===arguments.length?(this._precisionModel=arguments[0],this._SRID=arguments[1]):3===arguments.length&&(this._precisionModel=arguments[0],this._SRID=arguments[1],this._coordinateSequenceFactory=arguments[2]))},Ns={serialVersionUID:{configurable:!0}};en.prototype.toGeometry=function(n){return n.isNull()?this.createPoint(null):n.getMinX()===n.getMaxX()&&n.getMinY()===n.getMaxY()?this.createPoint(new j(n.getMinX(),n.getMinY())):n.getMinX()===n.getMaxX()||n.getMinY()===n.getMaxY()?this.createLineString([new j(n.getMinX(),n.getMinY()),new j(n.getMaxX(),n.getMaxY())]):this.createPolygon(this.createLinearRing([new j(n.getMinX(),n.getMinY()),new j(n.getMinX(),n.getMaxY()),new j(n.getMaxX(),n.getMaxY()),new j(n.getMaxX(),n.getMinY()),new j(n.getMinX(),n.getMinY())]),null)},en.prototype.createLineString=function(n){return n?n instanceof Array?new ir(this.getCoordinateSequenceFactory().create(n),this):Te(n,De)?new ir(n,this):void 0:new ir(this.getCoordinateSequenceFactory().create([]),this)},en.prototype.createMultiLineString=function(){return 0===arguments.length?new nr(null,this):1===arguments.length?new nr(arguments[0],this):void 0},en.prototype.buildGeometry=function(n){for(var a=null,h=!1,d=!1,w=n.iterator();w.hasNext();){var O=w.next(),k=O.getClass();null===a&&(a=k),k!==a&&(h=!0),O.isGeometryCollectionOrDerived()&&(d=!0)}if(null===a)return this.createGeometryCollection();if(h||d)return this.createGeometryCollection(en.toGeometryArray(n));var W=n.iterator().next();if(n.size()>1){if(W instanceof cn)return this.createMultiPolygon(en.toPolygonArray(n));if(W instanceof ir)return this.createMultiLineString(en.toLineStringArray(n));if(W instanceof On)return this.createMultiPoint(en.toPointArray(n));$.shouldNeverReachHere("Unhandled class: "+W.getClass().getName())}return W},en.prototype.createMultiPointFromCoords=function(n){return this.createMultiPoint(null!==n?this.getCoordinateSequenceFactory().create(n):null)},en.prototype.createPoint=function(){if(0===arguments.length)return this.createPoint(this.getCoordinateSequenceFactory().create([]));if(1===arguments.length){if(arguments[0]instanceof j){var n=arguments[0];return this.createPoint(null!==n?this.getCoordinateSequenceFactory().create([n]):null)}if(Te(arguments[0],De))return new On(arguments[0],this)}},en.prototype.getCoordinateSequenceFactory=function(){return this._coordinateSequenceFactory},en.prototype.createPolygon=function(){if(0===arguments.length)return new cn(null,null,this);if(1===arguments.length){if(Te(arguments[0],De))return this.createPolygon(this.createLinearRing(arguments[0]));if(arguments[0]instanceof Array)return this.createPolygon(this.createLinearRing(arguments[0]));if(arguments[0]instanceof Un)return this.createPolygon(arguments[0],null)}else if(2===arguments.length)return new cn(arguments[0],arguments[1],this)},en.prototype.getSRID=function(){return this._SRID},en.prototype.createGeometryCollection=function(){return 0===arguments.length?new Re(null,this):1===arguments.length?new Re(arguments[0],this):void 0},en.prototype.createGeometry=function(n){return new Zo(this).edit(n,{edit:function(){if(2===arguments.length)return this._coordinateSequenceFactory.create(arguments[0])}})},en.prototype.getPrecisionModel=function(){return this._precisionModel},en.prototype.createLinearRing=function(){if(0===arguments.length)return this.createLinearRing(this.getCoordinateSequenceFactory().create([]));if(1===arguments.length){if(arguments[0]instanceof Array){var n=arguments[0];return this.createLinearRing(null!==n?this.getCoordinateSequenceFactory().create(n):null)}if(Te(arguments[0],De))return new Un(arguments[0],this)}},en.prototype.createMultiPolygon=function(){return 0===arguments.length?new on(null,this):1===arguments.length?new on(arguments[0],this):void 0},en.prototype.createMultiPoint=function(){if(0===arguments.length)return new gi(null,this);if(1===arguments.length){if(arguments[0]instanceof Array)return new gi(arguments[0],this);if(arguments[0]instanceof Array){var a=arguments[0];return this.createMultiPoint(null!==a?this.getCoordinateSequenceFactory().create(a):null)}if(Te(arguments[0],De)){var h=arguments[0];if(null===h)return this.createMultiPoint(new Array(0).fill(null));for(var d=new Array(h.size()).fill(null),w=0;w<h.size();w++){var O=this.getCoordinateSequenceFactory().create(1,h.getDimension());un.copy(h,w,O,0,1),d[w]=this.createPoint(O)}return this.createMultiPoint(d)}}},en.prototype.interfaces_=function(){return[yt]},en.prototype.getClass=function(){return en},en.toMultiPolygonArray=function(n){var a=new Array(n.size()).fill(null);return n.toArray(a)},en.toGeometryArray=function(n){if(null===n)return null;var a=new Array(n.size()).fill(null);return n.toArray(a)},en.getDefaultCoordinateSequenceFactory=function(){return ma.instance()},en.toMultiLineStringArray=function(n){var a=new Array(n.size()).fill(null);return n.toArray(a)},en.toLineStringArray=function(n){var a=new Array(n.size()).fill(null);return n.toArray(a)},en.toMultiPointArray=function(n){var a=new Array(n.size()).fill(null);return n.toArray(a)},en.toLinearRingArray=function(n){var a=new Array(n.size()).fill(null);return n.toArray(a)},en.toPointArray=function(n){var a=new Array(n.size()).fill(null);return n.toArray(a)},en.toPolygonArray=function(n){var a=new Array(n.size()).fill(null);return n.toArray(a)},en.createPointFromInternalCoord=function(n,a){return a.getPrecisionModel().makePrecise(n),a.getFactory().createPoint(n)},Ns.serialVersionUID.get=function(){return-0x5ea75f2051eeb400},Object.defineProperties(en,Ns);var Ic=["Point","MultiPoint","LineString","MultiLineString","Polygon","MultiPolygon"],Ra=function(n){this.geometryFactory=n||new en};Ra.prototype.read=function(n){var a,h=(a="string"==typeof n?JSON.parse(n):n).type;if(!ya[h])throw new Error("Unknown GeoJSON type: "+a.type);return-1!==Ic.indexOf(h)?ya[h].apply(this,[a.coordinates]):ya[h].apply(this,"GeometryCollection"===h?[a.geometries]:[a])},Ra.prototype.write=function(n){var a=n.getGeometryType();if(!Wo[a])throw new Error("Geometry is not supported");return Wo[a].apply(this,[n])};var ya={Feature:function(n){var a={};for(var h in n)a[h]=n[h];if(n.geometry){if(!ya[n.geometry.type])throw new Error("Unknown GeoJSON type: "+n.type);a.geometry=this.read(n.geometry)}return n.bbox&&(a.bbox=ya.bbox.apply(this,[n.bbox])),a},FeatureCollection:function(n){var a={};if(n.features){a.features=[];for(var h=0;h<n.features.length;++h)a.features.push(this.read(n.features[h]))}return n.bbox&&(a.bbox=this.parse.bbox.apply(this,[n.bbox])),a},coordinates:function(n){for(var a=[],h=0;h<n.length;++h){var d=n[h];a.push(new j(d[0],d[1]))}return a},bbox:function(n){return this.geometryFactory.createLinearRing([new j(n[0],n[1]),new j(n[2],n[1]),new j(n[2],n[3]),new j(n[0],n[3]),new j(n[0],n[1])])},Point:function(n){var a=new j(n[0],n[1]);return this.geometryFactory.createPoint(a)},MultiPoint:function(n){for(var a=[],h=0;h<n.length;++h)a.push(ya.Point.apply(this,[n[h]]));return this.geometryFactory.createMultiPoint(a)},LineString:function(n){var a=ya.coordinates.apply(this,[n]);return this.geometryFactory.createLineString(a)},MultiLineString:function(n){for(var a=[],h=0;h<n.length;++h)a.push(ya.LineString.apply(this,[n[h]]));return this.geometryFactory.createMultiLineString(a)},Polygon:function(n){for(var a=ya.coordinates.apply(this,[n[0]]),h=this.geometryFactory.createLinearRing(a),d=[],w=1;w<n.length;++w){var k=ya.coordinates.apply(this,[n[w]]),W=this.geometryFactory.createLinearRing(k);d.push(W)}return this.geometryFactory.createPolygon(h,d)},MultiPolygon:function(n){for(var a=[],h=0;h<n.length;++h)a.push(ya.Polygon.apply(this,[n[h]]));return this.geometryFactory.createMultiPolygon(a)},GeometryCollection:function(n){for(var a=[],h=0;h<n.length;++h)a.push(this.read(n[h]));return this.geometryFactory.createGeometryCollection(a)}},Wo={coordinate:function(n){return[n.x,n.y]},Point:function(n){return{type:"Point",coordinates:Wo.coordinate.apply(this,[n.getCoordinate()])}},MultiPoint:function(n){for(var a=[],h=0;h<n._geometries.length;++h){var w=Wo.Point.apply(this,[n._geometries[h]]);a.push(w.coordinates)}return{type:"MultiPoint",coordinates:a}},LineString:function(n){for(var a=[],h=n.getCoordinates(),d=0;d<h.length;++d)a.push(Wo.coordinate.apply(this,[h[d]]));return{type:"LineString",coordinates:a}},MultiLineString:function(n){for(var a=[],h=0;h<n._geometries.length;++h){var w=Wo.LineString.apply(this,[n._geometries[h]]);a.push(w.coordinates)}return{type:"MultiLineString",coordinates:a}},Polygon:function(n){var a=[],h=Wo.LineString.apply(this,[n._shell]);a.push(h.coordinates);for(var d=0;d<n._holes.length;++d){var O=Wo.LineString.apply(this,[n._holes[d]]);a.push(O.coordinates)}return{type:"Polygon",coordinates:a}},MultiPolygon:function(n){for(var a=[],h=0;h<n._geometries.length;++h){var w=Wo.Polygon.apply(this,[n._geometries[h]]);a.push(w.coordinates)}return{type:"MultiPolygon",coordinates:a}},GeometryCollection:function(n){for(var a=[],h=0;h<n._geometries.length;++h){var d=n._geometries[h],w=d.getGeometryType();a.push(Wo[w].apply(this,[d]))}return{type:"GeometryCollection",geometries:a}}},Lo=function(n){this.geometryFactory=n||new en,this.precisionModel=this.geometryFactory.getPrecisionModel(),this.parser=new Ra(this.geometryFactory)};Lo.prototype.read=function(n){var a=this.parser.read(n);return this.precisionModel.getType()===En.FIXED&&this.reducePrecision(a),a},Lo.prototype.reducePrecision=function(n){var a,h;if(n.coordinate)this.precisionModel.makePrecise(n.coordinate);else if(n.points)for(a=0,h=n.points.length;a<h;a++)this.precisionModel.makePrecise(n.points[a]);else if(n.geometries)for(a=0,h=n.geometries.length;a<h;a++)this.reducePrecision(n.geometries[a])};var bo=function(){this.parser=new Ra(this.geometryFactory)};bo.prototype.write=function(n){return this.parser.write(n)};var Qe=function(){},tu={ON:{configurable:!0},LEFT:{configurable:!0},RIGHT:{configurable:!0}};Qe.prototype.interfaces_=function(){return[]},Qe.prototype.getClass=function(){return Qe},Qe.opposite=function(n){return n===Qe.LEFT?Qe.RIGHT:n===Qe.RIGHT?Qe.LEFT:n},tu.ON.get=function(){return 0},tu.LEFT.get=function(){return 1},tu.RIGHT.get=function(){return 2},Object.defineProperties(Qe,tu),(qt.prototype=new Error).name="EmptyStackException",(Qt.prototype=new ki).add=function(n){return this.array_.push(n),!0},Qt.prototype.get=function(n){if(n<0||n>=this.size())throw new Error;return this.array_[n]},Qt.prototype.push=function(n){return this.array_.push(n),n},Qt.prototype.pop=function(n){if(0===this.array_.length)throw new qt;return this.array_.pop()},Qt.prototype.peek=function(){if(0===this.array_.length)throw new qt;return this.array_[this.array_.length-1]},Qt.prototype.empty=function(){return 0===this.array_.length},Qt.prototype.isEmpty=function(){return this.empty()},Qt.prototype.search=function(n){return this.array_.indexOf(n)},Qt.prototype.size=function(){return this.array_.length},Qt.prototype.toArray=function(){for(var n=[],a=0,h=this.array_.length;a<h;a++)n.push(this.array_[a]);return n};var Ha=function(){this._minIndex=-1,this._minCoord=null,this._minDe=null,this._orientedDe=null};Ha.prototype.getCoordinate=function(){return this._minCoord},Ha.prototype.getRightmostSide=function(n,a){var h=this.getRightmostSideOfSegment(n,a);return h<0&&(h=this.getRightmostSideOfSegment(n,a-1)),h<0&&(this._minCoord=null,this.checkForRightmostCoordinate(n)),h},Ha.prototype.findRightmostEdgeAtVertex=function(){var n=this._minDe.getEdge().getCoordinates();$.isTrue(this._minIndex>0&&this._minIndex<n.length,"rightmost point expected to be interior vertex of edge");var a=n[this._minIndex-1],h=n[this._minIndex+1],d=Le.computeOrientation(this._minCoord,h,a),w=!1;(a.y<this._minCoord.y&&h.y<this._minCoord.y&&d===Le.COUNTERCLOCKWISE||a.y>this._minCoord.y&&h.y>this._minCoord.y&&d===Le.CLOCKWISE)&&(w=!0),w&&(this._minIndex=this._minIndex-1)},Ha.prototype.getRightmostSideOfSegment=function(n,a){var h=n.getEdge().getCoordinates();if(a<0||a+1>=h.length||h[a].y===h[a+1].y)return-1;var d=Qe.LEFT;return h[a].y<h[a+1].y&&(d=Qe.RIGHT),d},Ha.prototype.getEdge=function(){return this._orientedDe},Ha.prototype.checkForRightmostCoordinate=function(n){for(var a=n.getEdge().getCoordinates(),h=0;h<a.length-1;h++)(null===this._minCoord||a[h].x>this._minCoord.x)&&(this._minDe=n,this._minIndex=h,this._minCoord=a[h])},Ha.prototype.findRightmostEdgeAtNode=function(){var n=this._minDe.getNode().getEdges();this._minDe=n.getRightmostEdge(),this._minDe.isForward()||(this._minDe=this._minDe.getSym(),this._minIndex=this._minDe.getEdge().getCoordinates().length-1)},Ha.prototype.findEdge=function(n){for(var a=n.iterator();a.hasNext();){var h=a.next();h.isForward()&&this.checkForRightmostCoordinate(h)}$.isTrue(0!==this._minIndex||this._minCoord.equals(this._minDe.getCoordinate()),"inconsistency in rightmost processing"),0===this._minIndex?this.findRightmostEdgeAtNode():this.findRightmostEdgeAtVertex(),this._orientedDe=this._minDe,this.getRightmostSide(this._minDe,this._minIndex)===Qe.LEFT&&(this._orientedDe=this._minDe.getSym())},Ha.prototype.interfaces_=function(){return[]},Ha.prototype.getClass=function(){return Ha};var Ja=function(n){function a(h,d){n.call(this,a.msgWithCoord(h,d)),this.pt=d?new j(d):null,this.name="TopologyException"}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getCoordinate=function(){return this.pt},a.prototype.interfaces_=function(){return[]},a.prototype.getClass=function(){return a},a.msgWithCoord=function(h,d){return d?h:h+" [ "+d+" ]"},a}(st),ku=function(){this.array_=[]};ku.prototype.addLast=function(n){this.array_.push(n)},ku.prototype.removeFirst=function(){return this.array_.shift()},ku.prototype.isEmpty=function(){return 0===this.array_.length};var ia=function(){this._finder=null,this._dirEdgeList=new Je,this._nodes=new Je,this._rightMostCoord=null,this._env=null,this._finder=new Ha};ia.prototype.clearVisitedEdges=function(){for(var n=this._dirEdgeList.iterator();n.hasNext();)n.next().setVisited(!1)},ia.prototype.getRightmostCoordinate=function(){return this._rightMostCoord},ia.prototype.computeNodeDepth=function(n){for(var a=null,h=n.getEdges().iterator();h.hasNext();){var d=h.next();if(d.isVisited()||d.getSym().isVisited()){a=d;break}}if(null===a)throw new Ja("unable to find edge to compute depths at "+n.getCoordinate());n.getEdges().computeDepths(a);for(var w=n.getEdges().iterator();w.hasNext();){var O=w.next();O.setVisited(!0),this.copySymDepths(O)}},ia.prototype.computeDepth=function(n){this.clearVisitedEdges();var a=this._finder.getEdge();a.setEdgeDepths(Qe.RIGHT,n),this.copySymDepths(a),this.computeDepths(a)},ia.prototype.create=function(n){this.addReachable(n),this._finder.findEdge(this._dirEdgeList),this._rightMostCoord=this._finder.getCoordinate()},ia.prototype.findResultEdges=function(){for(var n=this._dirEdgeList.iterator();n.hasNext();){var a=n.next();a.getDepth(Qe.RIGHT)>=1&&a.getDepth(Qe.LEFT)<=0&&!a.isInteriorAreaEdge()&&a.setInResult(!0)}},ia.prototype.computeDepths=function(n){var a=new Ht,h=new ku,d=n.getNode();for(h.addLast(d),a.add(d),n.setVisited(!0);!h.isEmpty();){var w=h.removeFirst();a.add(w),this.computeNodeDepth(w);for(var O=w.getEdges().iterator();O.hasNext();){var k=O.next().getSym();if(!k.isVisited()){var W=k.getNode();a.contains(W)||(h.addLast(W),a.add(W))}}}},ia.prototype.compareTo=function(n){return this._rightMostCoord.x<n._rightMostCoord.x?-1:this._rightMostCoord.x>n._rightMostCoord.x?1:0},ia.prototype.getEnvelope=function(){if(null===this._env){for(var n=new Be,a=this._dirEdgeList.iterator();a.hasNext();)for(var h=a.next().getEdge().getCoordinates(),d=0;d<h.length-1;d++)n.expandToInclude(h[d]);this._env=n}return this._env},ia.prototype.addReachable=function(n){var a=new Qt;for(a.add(n);!a.empty();){var h=a.pop();this.add(h,a)}},ia.prototype.copySymDepths=function(n){var a=n.getSym();a.setDepth(Qe.LEFT,n.getDepth(Qe.RIGHT)),a.setDepth(Qe.RIGHT,n.getDepth(Qe.LEFT))},ia.prototype.add=function(n,a){n.setVisited(!0),this._nodes.add(n);for(var h=n.getEdges().iterator();h.hasNext();){var d=h.next();this._dirEdgeList.add(d);var w=d.getSym().getNode();w.isVisited()||a.push(w)}},ia.prototype.getNodes=function(){return this._nodes},ia.prototype.getDirectedEdges=function(){return this._dirEdgeList},ia.prototype.interfaces_=function(){return[et]},ia.prototype.getClass=function(){return ia};var yi=function n(){if(this.location=null,1===arguments.length){if(arguments[0]instanceof Array)this.init(arguments[0].length);else if(Number.isInteger(arguments[0])){var h=arguments[0];this.init(1),this.location[Qe.ON]=h}else if(arguments[0]instanceof n){var d=arguments[0];if(this.init(d.location.length),null!==d)for(var w=0;w<this.location.length;w++)this.location[w]=d.location[w]}}else if(3===arguments.length){var O=arguments[0],k=arguments[1],W=arguments[2];this.init(3),this.location[Qe.ON]=O,this.location[Qe.LEFT]=k,this.location[Qe.RIGHT]=W}};yi.prototype.setAllLocations=function(n){for(var a=0;a<this.location.length;a++)this.location[a]=n},yi.prototype.isNull=function(){for(var n=0;n<this.location.length;n++)if(this.location[n]!==at.NONE)return!1;return!0},yi.prototype.setAllLocationsIfNull=function(n){for(var a=0;a<this.location.length;a++)this.location[a]===at.NONE&&(this.location[a]=n)},yi.prototype.isLine=function(){return 1===this.location.length},yi.prototype.merge=function(n){if(n.location.length>this.location.length){var a=new Array(3).fill(null);a[Qe.ON]=this.location[Qe.ON],a[Qe.LEFT]=at.NONE,a[Qe.RIGHT]=at.NONE,this.location=a}for(var h=0;h<this.location.length;h++)this.location[h]===at.NONE&&h<n.location.length&&(this.location[h]=n.location[h])},yi.prototype.getLocations=function(){return this.location},yi.prototype.flip=function(){if(this.location.length<=1)return null;var n=this.location[Qe.LEFT];this.location[Qe.LEFT]=this.location[Qe.RIGHT],this.location[Qe.RIGHT]=n},yi.prototype.toString=function(){var n=new Pt;return this.location.length>1&&n.append(at.toLocationSymbol(this.location[Qe.LEFT])),n.append(at.toLocationSymbol(this.location[Qe.ON])),this.location.length>1&&n.append(at.toLocationSymbol(this.location[Qe.RIGHT])),n.toString()},yi.prototype.setLocations=function(n,a,h){this.location[Qe.ON]=n,this.location[Qe.LEFT]=a,this.location[Qe.RIGHT]=h},yi.prototype.get=function(n){return n<this.location.length?this.location[n]:at.NONE},yi.prototype.isArea=function(){return this.location.length>1},yi.prototype.isAnyNull=function(){for(var n=0;n<this.location.length;n++)if(this.location[n]===at.NONE)return!0;return!1},yi.prototype.setLocation=function(){1===arguments.length?this.setLocation(Qe.ON,arguments[0]):2===arguments.length&&(this.location[arguments[0]]=arguments[1])},yi.prototype.init=function(n){this.location=new Array(n).fill(null),this.setAllLocations(at.NONE)},yi.prototype.isEqualOnSide=function(n,a){return this.location[a]===n.location[a]},yi.prototype.allPositionsEqual=function(n){for(var a=0;a<this.location.length;a++)if(this.location[a]!==n)return!1;return!0},yi.prototype.interfaces_=function(){return[]},yi.prototype.getClass=function(){return yi};var ri=function n(){if(this.elt=new Array(2).fill(null),1===arguments.length){if(Number.isInteger(arguments[0])){var a=arguments[0];this.elt[0]=new yi(a),this.elt[1]=new yi(a)}else if(arguments[0]instanceof n){var h=arguments[0];this.elt[0]=new yi(h.elt[0]),this.elt[1]=new yi(h.elt[1])}}else if(2===arguments.length){var d=arguments[0],w=arguments[1];this.elt[0]=new yi(at.NONE),this.elt[1]=new yi(at.NONE),this.elt[d].setLocation(w)}else if(3===arguments.length){var O=arguments[0],k=arguments[1],W=arguments[2];this.elt[0]=new yi(O,k,W),this.elt[1]=new yi(O,k,W)}else if(4===arguments.length){var mt=arguments[0],Gt=arguments[1],Ie=arguments[2],Me=arguments[3];this.elt[0]=new yi(at.NONE,at.NONE,at.NONE),this.elt[1]=new yi(at.NONE,at.NONE,at.NONE),this.elt[mt].setLocations(Gt,Ie,Me)}};ri.prototype.getGeometryCount=function(){var n=0;return this.elt[0].isNull()||n++,this.elt[1].isNull()||n++,n},ri.prototype.setAllLocations=function(n,a){this.elt[n].setAllLocations(a)},ri.prototype.isNull=function(n){return this.elt[n].isNull()},ri.prototype.setAllLocationsIfNull=function(){if(1===arguments.length){var n=arguments[0];this.setAllLocationsIfNull(0,n),this.setAllLocationsIfNull(1,n)}else 2===arguments.length&&this.elt[arguments[0]].setAllLocationsIfNull(arguments[1])},ri.prototype.isLine=function(n){return this.elt[n].isLine()},ri.prototype.merge=function(n){for(var a=0;a<2;a++)null===this.elt[a]&&null!==n.elt[a]?this.elt[a]=new yi(n.elt[a]):this.elt[a].merge(n.elt[a])},ri.prototype.flip=function(){this.elt[0].flip(),this.elt[1].flip()},ri.prototype.getLocation=function(){return 1===arguments.length?this.elt[arguments[0]].get(Qe.ON):2===arguments.length?this.elt[arguments[0]].get(arguments[1]):void 0},ri.prototype.toString=function(){var n=new Pt;return null!==this.elt[0]&&(n.append("A:"),n.append(this.elt[0].toString())),null!==this.elt[1]&&(n.append(" B:"),n.append(this.elt[1].toString())),n.toString()},ri.prototype.isArea=function(){return 0===arguments.length?this.elt[0].isArea()||this.elt[1].isArea():1===arguments.length?this.elt[arguments[0]].isArea():void 0},ri.prototype.isAnyNull=function(n){return this.elt[n].isAnyNull()},ri.prototype.setLocation=function(){2===arguments.length?this.elt[arguments[0]].setLocation(Qe.ON,arguments[1]):3===arguments.length&&this.elt[arguments[0]].setLocation(arguments[1],arguments[2])},ri.prototype.isEqualOnSide=function(n,a){return this.elt[0].isEqualOnSide(n.elt[0],a)&&this.elt[1].isEqualOnSide(n.elt[1],a)},ri.prototype.allPositionsEqual=function(n,a){return this.elt[n].allPositionsEqual(a)},ri.prototype.toLine=function(n){this.elt[n].isArea()&&(this.elt[n]=new yi(this.elt[n].location[0]))},ri.prototype.interfaces_=function(){return[]},ri.prototype.getClass=function(){return ri},ri.toLineLabel=function(n){for(var a=new ri(at.NONE),h=0;h<2;h++)a.setLocation(h,n.getLocation(h));return a};var Li=function(){this._startDe=null,this._maxNodeDegree=-1,this._edges=new Je,this._pts=new Je,this._label=new ri(at.NONE),this._ring=null,this._isHole=null,this._shell=null,this._holes=new Je,this._geometryFactory=null;var n=arguments[0];this._geometryFactory=arguments[1],this.computePoints(n),this.computeRing()};Li.prototype.computeRing=function(){if(null!==this._ring)return null;for(var n=new Array(this._pts.size()).fill(null),a=0;a<this._pts.size();a++)n[a]=this._pts.get(a);this._ring=this._geometryFactory.createLinearRing(n),this._isHole=Le.isCCW(this._ring.getCoordinates())},Li.prototype.isIsolated=function(){return 1===this._label.getGeometryCount()},Li.prototype.computePoints=function(n){this._startDe=n;var a=n,h=!0;do{if(null===a)throw new Ja("Found null DirectedEdge");if(a.getEdgeRing()===this)throw new Ja("Directed Edge visited twice during ring-building at "+a.getCoordinate());this._edges.add(a);var d=a.getLabel();$.isTrue(d.isArea()),this.mergeLabel(d),this.addPoints(a.getEdge(),a.isForward(),h),h=!1,this.setEdgeRing(a,this),a=this.getNext(a)}while(a!==this._startDe)},Li.prototype.getLinearRing=function(){return this._ring},Li.prototype.getCoordinate=function(n){return this._pts.get(n)},Li.prototype.computeMaxNodeDegree=function(){this._maxNodeDegree=0;var n=this._startDe;do{var a=n.getNode().getEdges().getOutgoingDegree(this);a>this._maxNodeDegree&&(this._maxNodeDegree=a),n=this.getNext(n)}while(n!==this._startDe);this._maxNodeDegree*=2},Li.prototype.addPoints=function(n,a,h){var d=n.getCoordinates();if(a){var w=1;h&&(w=0);for(var O=w;O<d.length;O++)this._pts.add(d[O])}else{var k=d.length-2;h&&(k=d.length-1);for(var W=k;W>=0;W--)this._pts.add(d[W])}},Li.prototype.isHole=function(){return this._isHole},Li.prototype.setInResult=function(){var n=this._startDe;do{n.getEdge().setInResult(!0),n=n.getNext()}while(n!==this._startDe)},Li.prototype.containsPoint=function(n){var a=this.getLinearRing();if(!a.getEnvelopeInternal().contains(n)||!Le.isPointInRing(n,a.getCoordinates()))return!1;for(var h=this._holes.iterator();h.hasNext();)if(h.next().containsPoint(n))return!1;return!0},Li.prototype.addHole=function(n){this._holes.add(n)},Li.prototype.isShell=function(){return null===this._shell},Li.prototype.getLabel=function(){return this._label},Li.prototype.getEdges=function(){return this._edges},Li.prototype.getMaxNodeDegree=function(){return this._maxNodeDegree<0&&this.computeMaxNodeDegree(),this._maxNodeDegree},Li.prototype.getShell=function(){return this._shell},Li.prototype.mergeLabel=function(){if(1===arguments.length){var n=arguments[0];this.mergeLabel(n,0),this.mergeLabel(n,1)}else if(2===arguments.length){var h=arguments[1],d=arguments[0].getLocation(h,Qe.RIGHT);if(d===at.NONE)return null;if(this._label.getLocation(h)===at.NONE)return this._label.setLocation(h,d),null}},Li.prototype.setShell=function(n){this._shell=n,null!==n&&n.addHole(this)},Li.prototype.toPolygon=function(n){for(var a=new Array(this._holes.size()).fill(null),h=0;h<this._holes.size();h++)a[h]=this._holes.get(h).getLinearRing();return n.createPolygon(this.getLinearRing(),a)},Li.prototype.interfaces_=function(){return[]},Li.prototype.getClass=function(){return Li};var xl=function(n){function a(){n.call(this,arguments[0],arguments[1])}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.setEdgeRing=function(h,d){h.setMinEdgeRing(d)},a.prototype.getNext=function(h){return h.getNextMin()},a.prototype.interfaces_=function(){return[]},a.prototype.getClass=function(){return a},a}(Li),bl=function(n){function a(){n.call(this,arguments[0],arguments[1])}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.buildMinimalRings=function(){var h=new Je,d=this._startDe;do{if(null===d.getMinEdgeRing()){var w=new xl(d,this._geometryFactory);h.add(w)}d=d.getNext()}while(d!==this._startDe);return h},a.prototype.setEdgeRing=function(h,d){h.setEdgeRing(d)},a.prototype.linkDirectedEdgesForMinimalEdgeRings=function(){var h=this._startDe;do{h.getNode().getEdges().linkMinimalDirectedEdges(this),h=h.getNext()}while(h!==this._startDe)},a.prototype.getNext=function(h){return h.getNext()},a.prototype.interfaces_=function(){return[]},a.prototype.getClass=function(){return a},a}(Li),Ho=function(){this._label=null,this._isInResult=!1,this._isCovered=!1,this._isCoveredSet=!1,this._isVisited=!1,0!==arguments.length&&1===arguments.length&&(this._label=arguments[0])};Ho.prototype.setVisited=function(n){this._isVisited=n},Ho.prototype.setInResult=function(n){this._isInResult=n},Ho.prototype.isCovered=function(){return this._isCovered},Ho.prototype.isCoveredSet=function(){return this._isCoveredSet},Ho.prototype.setLabel=function(n){this._label=n},Ho.prototype.getLabel=function(){return this._label},Ho.prototype.setCovered=function(n){this._isCovered=n,this._isCoveredSet=!0},Ho.prototype.updateIM=function(n){$.isTrue(this._label.getGeometryCount()>=2,"found partial label"),this.computeIM(n)},Ho.prototype.isInResult=function(){return this._isInResult},Ho.prototype.isVisited=function(){return this._isVisited},Ho.prototype.interfaces_=function(){return[]},Ho.prototype.getClass=function(){return Ho};var Hu=function(n){function a(){n.call(this),this._coord=null,this._edges=null;var d=arguments[1];this._coord=arguments[0],this._edges=d,this._label=new ri(0,at.NONE)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.isIncidentEdgeInResult=function(){for(var h=this.getEdges().getEdges().iterator();h.hasNext();)if(h.next().getEdge().isInResult())return!0;return!1},a.prototype.isIsolated=function(){return 1===this._label.getGeometryCount()},a.prototype.getCoordinate=function(){return this._coord},a.prototype.print=function(h){h.println("node "+this._coord+" lbl: "+this._label)},a.prototype.computeIM=function(h){},a.prototype.computeMergedLocation=function(h,d){var w=at.NONE;if(w=this._label.getLocation(d),!h.isNull(d)){var O=h.getLocation(d);w!==at.BOUNDARY&&(w=O)}return w},a.prototype.setLabel=function(){if(2!==arguments.length)return n.prototype.setLabel.apply(this,arguments);var h=arguments[0],d=arguments[1];null===this._label?this._label=new ri(h,d):this._label.setLocation(h,d)},a.prototype.getEdges=function(){return this._edges},a.prototype.mergeLabel=function(){if(arguments[0]instanceof a)this.mergeLabel(arguments[0]._label);else if(arguments[0]instanceof ri)for(var d=arguments[0],w=0;w<2;w++){var O=this.computeMergedLocation(d,w);this._label.getLocation(w)===at.NONE&&this._label.setLocation(w,O)}},a.prototype.add=function(h){this._edges.insert(h),h.setNode(this)},a.prototype.setLabelBoundary=function(h){if(null===this._label)return null;var d=at.NONE;null!==this._label&&(d=this._label.getLocation(h));var w=null;switch(d){case at.BOUNDARY:w=at.INTERIOR;break;case at.INTERIOR:default:w=at.BOUNDARY}this._label.setLocation(h,w)},a.prototype.interfaces_=function(){return[]},a.prototype.getClass=function(){return a},a}(Ho),Sa=function(){this.nodeMap=new ye,this.nodeFact=null,this.nodeFact=arguments[0]};Sa.prototype.find=function(n){return this.nodeMap.get(n)},Sa.prototype.addNode=function(){if(arguments[0]instanceof j){var n=arguments[0],a=this.nodeMap.get(n);return null===a&&(a=this.nodeFact.createNode(n),this.nodeMap.put(n,a)),a}if(arguments[0]instanceof Hu){var h=arguments[0],d=this.nodeMap.get(h.getCoordinate());return null===d?(this.nodeMap.put(h.getCoordinate(),h),h):(d.mergeLabel(h),d)}},Sa.prototype.print=function(n){for(var a=this.iterator();a.hasNext();)a.next().print(n)},Sa.prototype.iterator=function(){return this.nodeMap.values().iterator()},Sa.prototype.values=function(){return this.nodeMap.values()},Sa.prototype.getBoundaryNodes=function(n){for(var a=new Je,h=this.iterator();h.hasNext();){var d=h.next();d.getLabel().getLocation(n)===at.BOUNDARY&&a.add(d)}return a},Sa.prototype.add=function(n){var a=n.getCoordinate();this.addNode(a).add(n)},Sa.prototype.interfaces_=function(){return[]},Sa.prototype.getClass=function(){return Sa};var ni=function(){},Jo={NE:{configurable:!0},NW:{configurable:!0},SW:{configurable:!0},SE:{configurable:!0}};ni.prototype.interfaces_=function(){return[]},ni.prototype.getClass=function(){return ni},ni.isNorthern=function(n){return n===ni.NE||n===ni.NW},ni.isOpposite=function(n,a){return n!==a&&(n-a+4)%4==2},ni.commonHalfPlane=function(n,a){if(n===a)return n;if((n-a+4)%4==2)return-1;var h=n<a?n:a;return 0===h&&3===(n>a?n:a)?3:h},ni.isInHalfPlane=function(n,a){return a===ni.SE?n===ni.SE||n===ni.SW:n===a||n===a+1},ni.quadrant=function(){if("number"==typeof arguments[0]&&"number"==typeof arguments[1]){var n=arguments[0],a=arguments[1];if(0===n&&0===a)throw new J("Cannot compute the quadrant for point ( "+n+", "+a+" )");return n>=0?a>=0?ni.NE:ni.SE:a>=0?ni.NW:ni.SW}if(arguments[0]instanceof j&&arguments[1]instanceof j){var h=arguments[0],d=arguments[1];if(d.x===h.x&&d.y===h.y)throw new J("Cannot compute the quadrant for two identical points "+h);return d.x>=h.x?d.y>=h.y?ni.NE:ni.SE:d.y>=h.y?ni.NW:ni.SW}},Jo.NE.get=function(){return 0},Jo.NW.get=function(){return 1},Jo.SW.get=function(){return 2},Jo.SE.get=function(){return 3},Object.defineProperties(ni,Jo);var $i=function(){if(this._edge=null,this._label=null,this._node=null,this._p0=null,this._p1=null,this._dx=null,this._dy=null,this._quadrant=null,1===arguments.length)this._edge=arguments[0];else if(3===arguments.length){var h=arguments[1],d=arguments[2];this._edge=arguments[0],this.init(h,d),this._label=null}else if(4===arguments.length){var O=arguments[1],k=arguments[2],W=arguments[3];this._edge=arguments[0],this.init(O,k),this._label=W}};$i.prototype.compareDirection=function(n){return this._dx===n._dx&&this._dy===n._dy?0:this._quadrant>n._quadrant?1:this._quadrant<n._quadrant?-1:Le.computeOrientation(n._p0,n._p1,this._p1)},$i.prototype.getDy=function(){return this._dy},$i.prototype.getCoordinate=function(){return this._p0},$i.prototype.setNode=function(n){this._node=n},$i.prototype.print=function(n){var a=Math.atan2(this._dy,this._dx),h=this.getClass().getName(),d=h.lastIndexOf("."),w=h.substring(d+1);n.print("  "+w+": "+this._p0+" - "+this._p1+" "+this._quadrant+":"+a+"   "+this._label)},$i.prototype.compareTo=function(n){return this.compareDirection(n)},$i.prototype.getDirectedCoordinate=function(){return this._p1},$i.prototype.getDx=function(){return this._dx},$i.prototype.getLabel=function(){return this._label},$i.prototype.getEdge=function(){return this._edge},$i.prototype.getQuadrant=function(){return this._quadrant},$i.prototype.getNode=function(){return this._node},$i.prototype.toString=function(){var n=Math.atan2(this._dy,this._dx),a=this.getClass().getName(),h=a.lastIndexOf(".");return"  "+a.substring(h+1)+": "+this._p0+" - "+this._p1+" "+this._quadrant+":"+n+"   "+this._label},$i.prototype.computeLabel=function(n){},$i.prototype.init=function(n,a){this._p0=n,this._p1=a,this._dx=a.x-n.x,this._dy=a.y-n.y,this._quadrant=ni.quadrant(this._dx,this._dy),$.isTrue(!(0===this._dx&&0===this._dy),"EdgeEnd with identical endpoints found")},$i.prototype.interfaces_=function(){return[et]},$i.prototype.getClass=function(){return $i};var zs=function(n){function a(){var h=arguments[0],d=arguments[1];if(n.call(this,h),this._isForward=null,this._isInResult=!1,this._isVisited=!1,this._sym=null,this._next=null,this._nextMin=null,this._edgeRing=null,this._minEdgeRing=null,this._depth=[0,-999,-999],this._isForward=d,d)this.init(h.getCoordinate(0),h.getCoordinate(1));else{var w=h.getNumPoints()-1;this.init(h.getCoordinate(w),h.getCoordinate(w-1))}this.computeDirectedLabel()}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getNextMin=function(){return this._nextMin},a.prototype.getDepth=function(h){return this._depth[h]},a.prototype.setVisited=function(h){this._isVisited=h},a.prototype.computeDirectedLabel=function(){this._label=new ri(this._edge.getLabel()),this._isForward||this._label.flip()},a.prototype.getNext=function(){return this._next},a.prototype.setDepth=function(h,d){if(-999!==this._depth[h]&&this._depth[h]!==d)throw new Ja("assigned depths do not match",this.getCoordinate());this._depth[h]=d},a.prototype.isInteriorAreaEdge=function(){for(var h=!0,d=0;d<2;d++)this._label.isArea(d)&&this._label.getLocation(d,Qe.LEFT)===at.INTERIOR&&this._label.getLocation(d,Qe.RIGHT)===at.INTERIOR||(h=!1);return h},a.prototype.setNextMin=function(h){this._nextMin=h},a.prototype.print=function(h){n.prototype.print.call(this,h),h.print(" "+this._depth[Qe.LEFT]+"/"+this._depth[Qe.RIGHT]),h.print(" ("+this.getDepthDelta()+")"),this._isInResult&&h.print(" inResult")},a.prototype.setMinEdgeRing=function(h){this._minEdgeRing=h},a.prototype.isLineEdge=function(){var h=this._label.isLine(0)||this._label.isLine(1),d=!this._label.isArea(0)||this._label.allPositionsEqual(0,at.EXTERIOR),w=!this._label.isArea(1)||this._label.allPositionsEqual(1,at.EXTERIOR);return h&&d&&w},a.prototype.setEdgeRing=function(h){this._edgeRing=h},a.prototype.getMinEdgeRing=function(){return this._minEdgeRing},a.prototype.getDepthDelta=function(){var h=this._edge.getDepthDelta();return this._isForward||(h=-h),h},a.prototype.setInResult=function(h){this._isInResult=h},a.prototype.getSym=function(){return this._sym},a.prototype.isForward=function(){return this._isForward},a.prototype.getEdge=function(){return this._edge},a.prototype.printEdge=function(h){this.print(h),h.print(" "),this._isForward?this._edge.print(h):this._edge.printReverse(h)},a.prototype.setSym=function(h){this._sym=h},a.prototype.setVisitedEdge=function(h){this.setVisited(h),this._sym.setVisited(h)},a.prototype.setEdgeDepths=function(h,d){var w=this.getEdge().getDepthDelta();this._isForward||(w=-w);var O=1;h===Qe.LEFT&&(O=-1);var k=Qe.opposite(h),W=d+w*O;this.setDepth(h,d),this.setDepth(k,W)},a.prototype.getEdgeRing=function(){return this._edgeRing},a.prototype.isInResult=function(){return this._isInResult},a.prototype.setNext=function(h){this._next=h},a.prototype.isVisited=function(){return this._isVisited},a.prototype.interfaces_=function(){return[]},a.prototype.getClass=function(){return a},a.depthFactor=function(h,d){return h===at.EXTERIOR&&d===at.INTERIOR?1:h===at.INTERIOR&&d===at.EXTERIOR?-1:0},a}($i),eu=function(){};eu.prototype.createNode=function(n){return new Hu(n,null)},eu.prototype.interfaces_=function(){return[]},eu.prototype.getClass=function(){return eu};var hi=function(){this._edges=new Je,this._nodes=null,this._edgeEndList=new Je,0===arguments.length?this._nodes=new Sa(new eu):1===arguments.length&&(this._nodes=new Sa(arguments[0]))};hi.prototype.printEdges=function(n){n.println("Edges:");for(var a=0;a<this._edges.size();a++){n.println("edge "+a+":");var h=this._edges.get(a);h.print(n),h.eiList.print(n)}},hi.prototype.find=function(n){return this._nodes.find(n)},hi.prototype.addNode=function(){return arguments[0]instanceof Hu||arguments[0]instanceof j?this._nodes.addNode(arguments[0]):void 0},hi.prototype.getNodeIterator=function(){return this._nodes.iterator()},hi.prototype.linkResultDirectedEdges=function(){for(var n=this._nodes.iterator();n.hasNext();)n.next().getEdges().linkResultDirectedEdges()},hi.prototype.debugPrintln=function(n){Cr.out.println(n)},hi.prototype.isBoundaryNode=function(n,a){var h=this._nodes.find(a);if(null===h)return!1;var d=h.getLabel();return null!==d&&d.getLocation(n)===at.BOUNDARY},hi.prototype.linkAllDirectedEdges=function(){for(var n=this._nodes.iterator();n.hasNext();)n.next().getEdges().linkAllDirectedEdges()},hi.prototype.matchInSameDirection=function(n,a,h,d){return!!n.equals(h)&&Le.computeOrientation(n,a,d)===Le.COLLINEAR&&ni.quadrant(n,a)===ni.quadrant(h,d)},hi.prototype.getEdgeEnds=function(){return this._edgeEndList},hi.prototype.debugPrint=function(n){Cr.out.print(n)},hi.prototype.getEdgeIterator=function(){return this._edges.iterator()},hi.prototype.findEdgeInSameDirection=function(n,a){for(var h=0;h<this._edges.size();h++){var d=this._edges.get(h),w=d.getCoordinates();if(this.matchInSameDirection(n,a,w[0],w[1])||this.matchInSameDirection(n,a,w[w.length-1],w[w.length-2]))return d}return null},hi.prototype.insertEdge=function(n){this._edges.add(n)},hi.prototype.findEdgeEnd=function(n){for(var a=this.getEdgeEnds().iterator();a.hasNext();){var h=a.next();if(h.getEdge()===n)return h}return null},hi.prototype.addEdges=function(n){for(var a=n.iterator();a.hasNext();){var h=a.next();this._edges.add(h);var d=new zs(h,!0),w=new zs(h,!1);d.setSym(w),w.setSym(d),this.add(d),this.add(w)}},hi.prototype.add=function(n){this._nodes.add(n),this._edgeEndList.add(n)},hi.prototype.getNodes=function(){return this._nodes.values()},hi.prototype.findEdge=function(n,a){for(var h=0;h<this._edges.size();h++){var d=this._edges.get(h),w=d.getCoordinates();if(n.equals(w[0])&&a.equals(w[1]))return d}return null},hi.prototype.interfaces_=function(){return[]},hi.prototype.getClass=function(){return hi},hi.linkResultDirectedEdges=function(n){for(var a=n.iterator();a.hasNext();)a.next().getEdges().linkResultDirectedEdges()};var io=function(){this._geometryFactory=null,this._shellList=new Je,this._geometryFactory=arguments[0]};io.prototype.sortShellsAndHoles=function(n,a,h){for(var d=n.iterator();d.hasNext();){var w=d.next();w.isHole()?h.add(w):a.add(w)}},io.prototype.computePolygons=function(n){for(var a=new Je,h=n.iterator();h.hasNext();){var d=h.next().toPolygon(this._geometryFactory);a.add(d)}return a},io.prototype.placeFreeHoles=function(n,a){for(var h=a.iterator();h.hasNext();){var d=h.next();if(null===d.getShell()){var w=this.findEdgeRingContaining(d,n);if(null===w)throw new Ja("unable to assign hole to a shell",d.getCoordinate(0));d.setShell(w)}}},io.prototype.buildMinimalEdgeRings=function(n,a,h){for(var d=new Je,w=n.iterator();w.hasNext();){var O=w.next();if(O.getMaxNodeDegree()>2){O.linkDirectedEdgesForMinimalEdgeRings();var k=O.buildMinimalRings(),W=this.findShell(k);null!==W?(this.placePolygonHoles(W,k),a.add(W)):h.addAll(k)}else d.add(O)}return d},io.prototype.containsPoint=function(n){for(var a=this._shellList.iterator();a.hasNext();)if(a.next().containsPoint(n))return!0;return!1},io.prototype.buildMaximalEdgeRings=function(n){for(var a=new Je,h=n.iterator();h.hasNext();){var d=h.next();if(d.isInResult()&&d.getLabel().isArea()&&null===d.getEdgeRing()){var w=new bl(d,this._geometryFactory);a.add(w),w.setInResult()}}return a},io.prototype.placePolygonHoles=function(n,a){for(var h=a.iterator();h.hasNext();){var d=h.next();d.isHole()&&d.setShell(n)}},io.prototype.getPolygons=function(){return this.computePolygons(this._shellList)},io.prototype.findEdgeRingContaining=function(n,a){for(var h=n.getLinearRing(),d=h.getEnvelopeInternal(),w=h.getCoordinateN(0),O=null,k=null,W=a.iterator();W.hasNext();){var mt=W.next(),Gt=mt.getLinearRing(),Ie=Gt.getEnvelopeInternal();null!==O&&(k=O.getLinearRing().getEnvelopeInternal());var Me=!1;Ie.contains(d)&&Le.isPointInRing(w,Gt.getCoordinates())&&(Me=!0),Me&&(null===O||k.contains(Ie))&&(O=mt)}return O},io.prototype.findShell=function(n){for(var a=0,h=null,d=n.iterator();d.hasNext();){var w=d.next();w.isHole()||(h=w,a++)}return $.isTrue(a<=1,"found two shells in MinimalEdgeRing list"),h},io.prototype.add=function(){if(1===arguments.length){var n=arguments[0];this.add(n.getEdgeEnds(),n.getNodes())}else if(2===arguments.length){var a=arguments[0];hi.linkResultDirectedEdges(arguments[1]);var d=this.buildMaximalEdgeRings(a),w=new Je,O=this.buildMinimalEdgeRings(d,this._shellList,w);this.sortShellsAndHoles(O,this._shellList,w),this.placeFreeHoles(this._shellList,w)}},io.prototype.interfaces_=function(){return[]},io.prototype.getClass=function(){return io};var Ka=function(){};Ka.prototype.getBounds=function(){},Ka.prototype.interfaces_=function(){return[]},Ka.prototype.getClass=function(){return Ka};var co=function(){this._bounds=null,this._item=null;var a=arguments[1];this._bounds=arguments[0],this._item=a};co.prototype.getItem=function(){return this._item},co.prototype.getBounds=function(){return this._bounds},co.prototype.interfaces_=function(){return[Ka,yt]},co.prototype.getClass=function(){return co};var Ei=function(){this._size=null,this._items=null,this._size=0,this._items=new Je,this._items.add(null)};Ei.prototype.poll=function(){if(this.isEmpty())return null;var n=this._items.get(1);return this._items.set(1,this._items.get(this._size)),this._size-=1,this.reorder(1),n},Ei.prototype.size=function(){return this._size},Ei.prototype.reorder=function(n){for(var a=null,h=this._items.get(n);2*n<=this._size&&((a=2*n)!==this._size&&this._items.get(a+1).compareTo(this._items.get(a))<0&&a++,this._items.get(a).compareTo(h)<0);n=a)this._items.set(n,this._items.get(a));this._items.set(n,h)},Ei.prototype.clear=function(){this._size=0,this._items.clear()},Ei.prototype.isEmpty=function(){return 0===this._size},Ei.prototype.add=function(n){this._items.add(null),this._size+=1;var a=this._size;for(this._items.set(0,n);n.compareTo(this._items.get(Math.trunc(a/2)))<0;a/=2)this._items.set(a,this._items.get(Math.trunc(a/2)));this._items.set(a,n)},Ei.prototype.interfaces_=function(){return[]},Ei.prototype.getClass=function(){return Ei};var xs=function(){};xs.prototype.visitItem=function(n){},xs.prototype.interfaces_=function(){return[]},xs.prototype.getClass=function(){return xs};var fu=function(){};fu.prototype.insert=function(n,a){},fu.prototype.remove=function(n,a){},fu.prototype.query=function(){},fu.prototype.interfaces_=function(){return[]},fu.prototype.getClass=function(){return fu};var ho=function(){this._childBoundables=new Je,this._bounds=null,this._level=null,0!==arguments.length&&1===arguments.length&&(this._level=arguments[0])},Pc={serialVersionUID:{configurable:!0}};ho.prototype.getLevel=function(){return this._level},ho.prototype.size=function(){return this._childBoundables.size()},ho.prototype.getChildBoundables=function(){return this._childBoundables},ho.prototype.addChildBoundable=function(n){$.isTrue(null===this._bounds),this._childBoundables.add(n)},ho.prototype.isEmpty=function(){return this._childBoundables.isEmpty()},ho.prototype.getBounds=function(){return null===this._bounds&&(this._bounds=this.computeBounds()),this._bounds},ho.prototype.interfaces_=function(){return[Ka,yt]},ho.prototype.getClass=function(){return ho},Pc.serialVersionUID.get=function(){return 0x5a1e55ec41369800},Object.defineProperties(ho,Pc);var oa=function(){};oa.reverseOrder=function(){return{compare:function(n,a){return a.compareTo(n)}}},oa.min=function(n){return oa.sort(n),n.get(0)},oa.sort=function(n,a){var h=n.toArray();a?ge.sort(h,a):ge.sort(h);for(var d=n.iterator(),w=0,O=h.length;w<O;w++)d.next(),d.set(h[w])},oa.singletonList=function(n){var a=new Je;return a.add(n),a};var Fi=function(){this._boundable1=null,this._boundable2=null,this._distance=null,this._itemDistance=null;var a=arguments[1],h=arguments[2];this._boundable1=arguments[0],this._boundable2=a,this._itemDistance=h,this._distance=this.distance()};Fi.prototype.expandToQueue=function(n,a){var h=Fi.isComposite(this._boundable1),d=Fi.isComposite(this._boundable2);if(h&&d)return Fi.area(this._boundable1)>Fi.area(this._boundable2)?(this.expand(this._boundable1,this._boundable2,n,a),null):(this.expand(this._boundable2,this._boundable1,n,a),null);if(h)return this.expand(this._boundable1,this._boundable2,n,a),null;if(d)return this.expand(this._boundable2,this._boundable1,n,a),null;throw new J("neither boundable is composite")},Fi.prototype.isLeaves=function(){return!(Fi.isComposite(this._boundable1)||Fi.isComposite(this._boundable2))},Fi.prototype.compareTo=function(n){return this._distance<n._distance?-1:this._distance>n._distance?1:0},Fi.prototype.expand=function(n,a,h,d){for(var w=n.getChildBoundables().iterator();w.hasNext();){var O=w.next(),k=new Fi(O,a,this._itemDistance);k.getDistance()<d&&h.add(k)}},Fi.prototype.getBoundable=function(n){return 0===n?this._boundable1:this._boundable2},Fi.prototype.getDistance=function(){return this._distance},Fi.prototype.distance=function(){return this.isLeaves()?this._itemDistance.distance(this._boundable1,this._boundable2):this._boundable1.getBounds().distance(this._boundable2.getBounds())},Fi.prototype.interfaces_=function(){return[et]},Fi.prototype.getClass=function(){return Fi},Fi.area=function(n){return n.getBounds().getArea()},Fi.isComposite=function(n){return n instanceof ho};var to=function n(){if(this._root=null,this._built=!1,this._itemBoundables=new Je,this._nodeCapacity=null,0===arguments.length)this._nodeCapacity=n.DEFAULT_NODE_CAPACITY;else if(1===arguments.length){var h=arguments[0];$.isTrue(h>1,"Node capacity must be greater than 1"),this._nodeCapacity=h}},Fu={IntersectsOp:{configurable:!0},serialVersionUID:{configurable:!0},DEFAULT_NODE_CAPACITY:{configurable:!0}};to.prototype.getNodeCapacity=function(){return this._nodeCapacity},to.prototype.lastNode=function(n){return n.get(n.size()-1)},to.prototype.size=function(){if(0===arguments.length)return this.isEmpty()?0:(this.build(),this.size(this._root));if(1===arguments.length){for(var n=0,a=arguments[0].getChildBoundables().iterator();a.hasNext();){var h=a.next();h instanceof ho?n+=this.size(h):h instanceof co&&(n+=1)}return n}},to.prototype.removeItem=function(n,a){for(var h=null,d=n.getChildBoundables().iterator();d.hasNext();){var w=d.next();w instanceof co&&w.getItem()===a&&(h=w)}return null!==h&&(n.getChildBoundables().remove(h),!0)},to.prototype.itemsTree=function(){if(0===arguments.length){this.build();var n=this.itemsTree(this._root);return null===n?new Je:n}if(1===arguments.length){for(var a=arguments[0],h=new Je,d=a.getChildBoundables().iterator();d.hasNext();){var w=d.next();if(w instanceof ho){var O=this.itemsTree(w);null!==O&&h.add(O)}else w instanceof co?h.add(w.getItem()):$.shouldNeverReachHere()}return h.size()<=0?null:h}},to.prototype.insert=function(n,a){$.isTrue(!this._built,"Cannot insert items into an STR packed R-tree after it has been built."),this._itemBoundables.add(new co(n,a))},to.prototype.boundablesAtLevel=function(){if(1===arguments.length){var n=arguments[0],a=new Je;return this.boundablesAtLevel(n,this._root,a),a}if(3===arguments.length){var h=arguments[0],d=arguments[1],w=arguments[2];if($.isTrue(h>-2),d.getLevel()===h)return w.add(d),null;for(var O=d.getChildBoundables().iterator();O.hasNext();){var k=O.next();k instanceof ho?this.boundablesAtLevel(h,k,w):($.isTrue(k instanceof co),-1===h&&w.add(k))}return null}},to.prototype.query=function(){if(1===arguments.length){var n=arguments[0];this.build();var a=new Je;return this.isEmpty()||this.getIntersectsOp().intersects(this._root.getBounds(),n)&&this.query(n,this._root,a),a}if(2===arguments.length){var h=arguments[0],d=arguments[1];if(this.build(),this.isEmpty())return null;this.getIntersectsOp().intersects(this._root.getBounds(),h)&&this.query(h,this._root,d)}else if(3===arguments.length)if(Te(arguments[2],xs)&&arguments[0]instanceof Object&&arguments[1]instanceof ho)for(var w=arguments[0],k=arguments[2],W=arguments[1].getChildBoundables(),mt=0;mt<W.size();mt++){var Gt=W.get(mt);this.getIntersectsOp().intersects(Gt.getBounds(),w)&&(Gt instanceof ho?this.query(w,Gt,k):Gt instanceof co?k.visitItem(Gt.getItem()):$.shouldNeverReachHere())}else if(Te(arguments[2],ki)&&arguments[0]instanceof Object&&arguments[1]instanceof ho)for(var Ie=arguments[0],Ke=arguments[2],gr=arguments[1].getChildBoundables(),Or=0;Or<gr.size();Or++){var Zr=gr.get(Or);this.getIntersectsOp().intersects(Zr.getBounds(),Ie)&&(Zr instanceof ho?this.query(Ie,Zr,Ke):Zr instanceof co?Ke.add(Zr.getItem()):$.shouldNeverReachHere())}},to.prototype.build=function(){if(this._built)return null;this._root=this._itemBoundables.isEmpty()?this.createNode(0):this.createHigherLevels(this._itemBoundables,-1),this._itemBoundables=null,this._built=!0},to.prototype.getRoot=function(){return this.build(),this._root},to.prototype.remove=function(){if(2===arguments.length){var n=arguments[0],a=arguments[1];return this.build(),!!this.getIntersectsOp().intersects(this._root.getBounds(),n)&&this.remove(n,this._root,a)}if(3===arguments.length){var h=arguments[0],d=arguments[1],w=arguments[2],O=this.removeItem(d,w);if(O)return!0;for(var k=null,W=d.getChildBoundables().iterator();W.hasNext();){var mt=W.next();if(this.getIntersectsOp().intersects(mt.getBounds(),h)&&mt instanceof ho&&(O=this.remove(h,mt,w))){k=mt;break}}return null!==k&&k.getChildBoundables().isEmpty()&&d.getChildBoundables().remove(k),O}},to.prototype.createHigherLevels=function(n,a){$.isTrue(!n.isEmpty());var h=this.createParentBoundables(n,a+1);return 1===h.size()?h.get(0):this.createHigherLevels(h,a+1)},to.prototype.depth=function(){if(0===arguments.length)return this.isEmpty()?0:(this.build(),this.depth(this._root));if(1===arguments.length){for(var n=0,a=arguments[0].getChildBoundables().iterator();a.hasNext();){var h=a.next();if(h instanceof ho){var d=this.depth(h);d>n&&(n=d)}}return n+1}},to.prototype.createParentBoundables=function(n,a){$.isTrue(!n.isEmpty());var h=new Je;h.add(this.createNode(a));var d=new Je(n);oa.sort(d,this.getComparator());for(var w=d.iterator();w.hasNext();){var O=w.next();this.lastNode(h).getChildBoundables().size()===this.getNodeCapacity()&&h.add(this.createNode(a)),this.lastNode(h).addChildBoundable(O)}return h},to.prototype.isEmpty=function(){return this._built?this._root.isEmpty():this._itemBoundables.isEmpty()},to.prototype.interfaces_=function(){return[yt]},to.prototype.getClass=function(){return to},to.compareDoubles=function(n,a){return n>a?1:n<a?-1:0},Fu.IntersectsOp.get=function(){return Hl},Fu.serialVersionUID.get=function(){return-0x35ef64c82d4c5400},Fu.DEFAULT_NODE_CAPACITY.get=function(){return 10},Object.defineProperties(to,Fu);var Hl=function(){},du=function(){};du.prototype.distance=function(n,a){},du.prototype.interfaces_=function(){return[]},du.prototype.getClass=function(){return du};var Jl=function(n){function a(d){n.call(this,d=d||a.DEFAULT_NODE_CAPACITY)}n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a;var h={STRtreeNode:{configurable:!0},serialVersionUID:{configurable:!0},xComparator:{configurable:!0},yComparator:{configurable:!0},intersectsOp:{configurable:!0},DEFAULT_NODE_CAPACITY:{configurable:!0}};return a.prototype.createParentBoundablesFromVerticalSlices=function(d,w){$.isTrue(d.length>0);for(var O=new Je,k=0;k<d.length;k++)O.addAll(this.createParentBoundablesFromVerticalSlice(d[k],w));return O},a.prototype.createNode=function(d){return new ru(d)},a.prototype.size=function(){return 0===arguments.length?n.prototype.size.call(this):n.prototype.size.apply(this,arguments)},a.prototype.insert=function(){if(2!==arguments.length)return n.prototype.insert.apply(this,arguments);var d=arguments[0],w=arguments[1];if(d.isNull())return null;n.prototype.insert.call(this,d,w)},a.prototype.getIntersectsOp=function(){return a.intersectsOp},a.prototype.verticalSlices=function(d,w){for(var O=Math.trunc(Math.ceil(d.size()/w)),k=new Array(w).fill(null),W=d.iterator(),mt=0;mt<w;mt++){k[mt]=new Je;for(var Gt=0;W.hasNext()&&Gt<O;){var Ie=W.next();k[mt].add(Ie),Gt++}}return k},a.prototype.query=function(){if(1===arguments.length)return n.prototype.query.call(this,arguments[0]);2===arguments.length?n.prototype.query.call(this,arguments[0],arguments[1]):3===arguments.length&&(Te(arguments[2],xs)&&arguments[0]instanceof Object&&arguments[1]instanceof ho||Te(arguments[2],ki)&&arguments[0]instanceof Object&&arguments[1]instanceof ho)&&n.prototype.query.call(this,arguments[0],arguments[1],arguments[2])},a.prototype.getComparator=function(){return a.yComparator},a.prototype.createParentBoundablesFromVerticalSlice=function(d,w){return n.prototype.createParentBoundables.call(this,d,w)},a.prototype.remove=function(){return 2===arguments.length?n.prototype.remove.call(this,arguments[0],arguments[1]):n.prototype.remove.apply(this,arguments)},a.prototype.depth=function(){return 0===arguments.length?n.prototype.depth.call(this):n.prototype.depth.apply(this,arguments)},a.prototype.createParentBoundables=function(d,w){$.isTrue(!d.isEmpty());var O=Math.trunc(Math.ceil(d.size()/this.getNodeCapacity())),k=new Je(d);oa.sort(k,a.xComparator);var W=this.verticalSlices(k,Math.trunc(Math.ceil(Math.sqrt(O))));return this.createParentBoundablesFromVerticalSlices(W,w)},a.prototype.nearestNeighbour=function(){if(1===arguments.length){if(Te(arguments[0],du)){var d=arguments[0],w=new Fi(this.getRoot(),this.getRoot(),d);return this.nearestNeighbour(w)}if(arguments[0]instanceof Fi)return this.nearestNeighbour(arguments[0],Q.POSITIVE_INFINITY)}else if(2===arguments.length){if(arguments[0]instanceof a&&Te(arguments[1],du)){var k=arguments[0],W=arguments[1],mt=new Fi(this.getRoot(),k.getRoot(),W);return this.nearestNeighbour(mt)}if(arguments[0]instanceof Fi&&"number"==typeof arguments[1]){var Gt=arguments[0],Ie=arguments[1],Me=null,Ke=new Ei;for(Ke.add(Gt);!Ke.isEmpty()&&Ie>0;){var gr=Ke.poll(),Or=gr.getDistance();if(Or>=Ie)break;gr.isLeaves()?(Ie=Or,Me=gr):gr.expandToQueue(Ke,Ie)}return[Me.getBoundable(0).getItem(),Me.getBoundable(1).getItem()]}}else if(3===arguments.length){var l=arguments[2],p=new co(arguments[0],arguments[1]),c=new Fi(this.getRoot(),p,l);return this.nearestNeighbour(c)[0]}},a.prototype.interfaces_=function(){return[fu,yt]},a.prototype.getClass=function(){return a},a.centreX=function(d){return a.avg(d.getMinX(),d.getMaxX())},a.avg=function(d,w){return(d+w)/2},a.centreY=function(d){return a.avg(d.getMinY(),d.getMaxY())},h.STRtreeNode.get=function(){return ru},h.serialVersionUID.get=function(){return 0x39920f7d5f261e0},h.xComparator.get=function(){return{interfaces_:function(){return[lt]},compare:function(d,w){return n.compareDoubles(a.centreX(d.getBounds()),a.centreX(w.getBounds()))}}},h.yComparator.get=function(){return{interfaces_:function(){return[lt]},compare:function(d,w){return n.compareDoubles(a.centreY(d.getBounds()),a.centreY(w.getBounds()))}}},h.intersectsOp.get=function(){return{interfaces_:function(){return[n.IntersectsOp]},intersects:function(d,w){return d.intersects(w)}}},h.DEFAULT_NODE_CAPACITY.get=function(){return 10},Object.defineProperties(a,h),a}(to),ru=function(n){function a(){n.call(this,arguments[0])}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.computeBounds=function(){for(var h=null,d=this.getChildBoundables().iterator();d.hasNext();){var w=d.next();null===h?h=new Be(w.getBounds()):h.expandToInclude(w.getBounds())}return h},a.prototype.interfaces_=function(){return[]},a.prototype.getClass=function(){return a},a}(ho),wo=function(){};wo.prototype.interfaces_=function(){return[]},wo.prototype.getClass=function(){return wo},wo.relativeSign=function(n,a){return n<a?-1:n>a?1:0},wo.compare=function(n,a,h){if(a.equals2D(h))return 0;var d=wo.relativeSign(a.x,h.x),w=wo.relativeSign(a.y,h.y);switch(n){case 0:return wo.compareValue(d,w);case 1:return wo.compareValue(w,d);case 2:return wo.compareValue(w,-d);case 3:return wo.compareValue(-d,w);case 4:return wo.compareValue(-d,-w);case 5:return wo.compareValue(-w,-d);case 6:return wo.compareValue(-w,d);case 7:return wo.compareValue(d,-w)}return $.shouldNeverReachHere("invalid octant value"),0},wo.compareValue=function(n,a){return n<0?-1:n>0?1:a<0?-1:a>0?1:0};var cs=function(){this._segString=null,this.coord=null,this.segmentIndex=null,this._segmentOctant=null,this._isInterior=null;var n=arguments[0],a=arguments[1],h=arguments[2],d=arguments[3];this._segString=n,this.coord=new j(a),this.segmentIndex=h,this._segmentOctant=d,this._isInterior=!a.equals2D(n.getCoordinate(h))};cs.prototype.getCoordinate=function(){return this.coord},cs.prototype.print=function(n){n.print(this.coord),n.print(" seg # = "+this.segmentIndex)},cs.prototype.compareTo=function(n){var a=n;return this.segmentIndex<a.segmentIndex?-1:this.segmentIndex>a.segmentIndex?1:this.coord.equals2D(a.coord)?0:wo.compare(this._segmentOctant,this.coord,a.coord)},cs.prototype.isEndPoint=function(n){return 0===this.segmentIndex&&!this._isInterior||this.segmentIndex===n},cs.prototype.isInterior=function(){return this._isInterior},cs.prototype.interfaces_=function(){return[et]},cs.prototype.getClass=function(){return cs};var si=function(){this._nodeMap=new ye,this._edge=null,this._edge=arguments[0]};si.prototype.getSplitCoordinates=function(){var n=new V;this.addEndpoints();for(var a=this.iterator(),h=a.next();a.hasNext();){var d=a.next();this.addEdgeCoordinates(h,d,n),h=d}return n.toCoordinateArray()},si.prototype.addCollapsedNodes=function(){var n=new Je;this.findCollapsesFromInsertedNodes(n),this.findCollapsesFromExistingVertices(n);for(var a=n.iterator();a.hasNext();){var h=a.next().intValue();this.add(this._edge.getCoordinate(h),h)}},si.prototype.print=function(n){n.println("Intersections:");for(var a=this.iterator();a.hasNext();)a.next().print(n)},si.prototype.findCollapsesFromExistingVertices=function(n){for(var a=0;a<this._edge.size()-2;a++){var h=this._edge.getCoordinate(a),d=this._edge.getCoordinate(a+2);h.equals2D(d)&&n.add(new Kt(a+1))}},si.prototype.addEdgeCoordinates=function(n,a,h){var d=this._edge.getCoordinate(a.segmentIndex),w=a.isInterior()||!a.coord.equals2D(d);h.add(new j(n.coord),!1);for(var O=n.segmentIndex+1;O<=a.segmentIndex;O++)h.add(this._edge.getCoordinate(O));w&&h.add(new j(a.coord))},si.prototype.iterator=function(){return this._nodeMap.values().iterator()},si.prototype.addSplitEdges=function(n){this.addEndpoints(),this.addCollapsedNodes();for(var a=this.iterator(),h=a.next();a.hasNext();){var d=a.next(),w=this.createSplitEdge(h,d);n.add(w),h=d}},si.prototype.findCollapseIndex=function(n,a,h){if(!n.coord.equals2D(a.coord))return!1;var d=a.segmentIndex-n.segmentIndex;return a.isInterior()||d--,1===d&&(h[0]=n.segmentIndex+1,!0)},si.prototype.findCollapsesFromInsertedNodes=function(n){for(var a=new Array(1).fill(null),h=this.iterator(),d=h.next();h.hasNext();){var w=h.next();this.findCollapseIndex(d,w,a)&&n.add(new Kt(a[0])),d=w}},si.prototype.getEdge=function(){return this._edge},si.prototype.addEndpoints=function(){var n=this._edge.size()-1;this.add(this._edge.getCoordinate(0),0),this.add(this._edge.getCoordinate(n),n)},si.prototype.createSplitEdge=function(n,a){var h=a.segmentIndex-n.segmentIndex+2,d=this._edge.getCoordinate(a.segmentIndex),w=a.isInterior()||!a.coord.equals2D(d);w||h--;var O=new Array(h).fill(null),k=0;O[k++]=new j(n.coord);for(var W=n.segmentIndex+1;W<=a.segmentIndex;W++)O[k++]=this._edge.getCoordinate(W);return w&&(O[k]=new j(a.coord)),new vi(O,this._edge.getData())},si.prototype.add=function(n,a){var h=new cs(this._edge,n,a,this._edge.getSegmentOctant(a)),d=this._nodeMap.get(h);return null!==d?($.isTrue(d.coord.equals2D(n),"Found equal nodes with different coordinates"),d):(this._nodeMap.put(h,h),h)},si.prototype.checkSplitEdgesCorrectness=function(n){var a=this._edge.getCoordinates(),h=n.get(0).getCoordinate(0);if(!h.equals2D(a[0]))throw new st("bad split edge start point at "+h);var d=n.get(n.size()-1).getCoordinates(),w=d[d.length-1];if(!w.equals2D(a[a.length-1]))throw new st("bad split edge end point at "+w)},si.prototype.interfaces_=function(){return[]},si.prototype.getClass=function(){return si};var Gs=function(){};Gs.prototype.interfaces_=function(){return[]},Gs.prototype.getClass=function(){return Gs},Gs.octant=function(){if("number"==typeof arguments[0]&&"number"==typeof arguments[1]){var n=arguments[0],a=arguments[1];if(0===n&&0===a)throw new J("Cannot compute the octant for point ( "+n+", "+a+" )");var h=Math.abs(n),d=Math.abs(a);return n>=0?a>=0?h>=d?0:1:h>=d?7:6:a>=0?h>=d?3:2:h>=d?4:5}if(arguments[0]instanceof j&&arguments[1]instanceof j){var w=arguments[0],O=arguments[1],k=O.x-w.x,W=O.y-w.y;if(0===k&&0===W)throw new J("Cannot compute the octant for two identical points "+w);return Gs.octant(k,W)}};var Go=function(){};Go.prototype.getCoordinates=function(){},Go.prototype.size=function(){},Go.prototype.getCoordinate=function(n){},Go.prototype.isClosed=function(){},Go.prototype.setData=function(n){},Go.prototype.getData=function(){},Go.prototype.interfaces_=function(){return[]},Go.prototype.getClass=function(){return Go};var Qa=function(){};Qa.prototype.addIntersection=function(n,a){},Qa.prototype.interfaces_=function(){return[Go]},Qa.prototype.getClass=function(){return Qa};var vi=function(){this._nodeList=new si(this),this._pts=null,this._data=null;var a=arguments[1];this._pts=arguments[0],this._data=a};vi.prototype.getCoordinates=function(){return this._pts},vi.prototype.size=function(){return this._pts.length},vi.prototype.getCoordinate=function(n){return this._pts[n]},vi.prototype.isClosed=function(){return this._pts[0].equals(this._pts[this._pts.length-1])},vi.prototype.getSegmentOctant=function(n){return n===this._pts.length-1?-1:this.safeOctant(this.getCoordinate(n),this.getCoordinate(n+1))},vi.prototype.setData=function(n){this._data=n},vi.prototype.safeOctant=function(n,a){return n.equals2D(a)?0:Gs.octant(n,a)},vi.prototype.getData=function(){return this._data},vi.prototype.addIntersection=function(){if(2===arguments.length)this.addIntersectionNode(arguments[0],arguments[1]);else if(4===arguments.length){var d=arguments[1],O=new j(arguments[0].getIntersection(arguments[3]));this.addIntersection(O,d)}},vi.prototype.toString=function(){return ae.toLineString(new jn(this._pts))},vi.prototype.getNodeList=function(){return this._nodeList},vi.prototype.addIntersectionNode=function(n,a){var h=a,d=h+1;return d<this._pts.length&&n.equals2D(this._pts[d])&&(h=d),this._nodeList.add(n,h)},vi.prototype.addIntersections=function(n,a,h){for(var d=0;d<n.getIntersectionNum();d++)this.addIntersection(n,a,h,d)},vi.prototype.interfaces_=function(){return[Qa]},vi.prototype.getClass=function(){return vi},vi.getNodedSubstrings=function(){if(1===arguments.length){var n=arguments[0],a=new Je;return vi.getNodedSubstrings(n,a),a}if(2===arguments.length)for(var d=arguments[1],w=arguments[0].iterator();w.hasNext();)w.next().getNodeList().addSplitEdges(d)};var Fr=function(){if(this.p0=null,this.p1=null,0===arguments.length)this.p0=new j,this.p1=new j;else if(1===arguments.length){var n=arguments[0];this.p0=new j(n.p0),this.p1=new j(n.p1)}else if(2===arguments.length)this.p0=arguments[0],this.p1=arguments[1];else if(4===arguments.length){var d=arguments[2],w=arguments[3];this.p0=new j(arguments[0],arguments[1]),this.p1=new j(d,w)}},nu={serialVersionUID:{configurable:!0}};Fr.prototype.minX=function(){return Math.min(this.p0.x,this.p1.x)},Fr.prototype.orientationIndex=function(){if(arguments[0]instanceof Fr){var n=arguments[0],a=Le.orientationIndex(this.p0,this.p1,n.p0),h=Le.orientationIndex(this.p0,this.p1,n.p1);return a>=0&&h>=0||a<=0&&h<=0?Math.max(a,h):0}if(arguments[0]instanceof j)return Le.orientationIndex(this.p0,this.p1,arguments[0])},Fr.prototype.toGeometry=function(n){return n.createLineString([this.p0,this.p1])},Fr.prototype.isVertical=function(){return this.p0.x===this.p1.x},Fr.prototype.equals=function(n){if(!(n instanceof Fr))return!1;var a=n;return this.p0.equals(a.p0)&&this.p1.equals(a.p1)},Fr.prototype.intersection=function(n){var a=new Ee;return a.computeIntersection(this.p0,this.p1,n.p0,n.p1),a.hasIntersection()?a.getIntersection(0):null},Fr.prototype.project=function(){if(arguments[0]instanceof j){var n=arguments[0];if(n.equals(this.p0)||n.equals(this.p1))return new j(n);var a=this.projectionFactor(n),h=new j;return h.x=this.p0.x+a*(this.p1.x-this.p0.x),h.y=this.p0.y+a*(this.p1.y-this.p0.y),h}if(arguments[0]instanceof Fr){var d=arguments[0],w=this.projectionFactor(d.p0),O=this.projectionFactor(d.p1);if(w>=1&&O>=1||w<=0&&O<=0)return null;var k=this.project(d.p0);w<0&&(k=this.p0),w>1&&(k=this.p1);var W=this.project(d.p1);return O<0&&(W=this.p0),O>1&&(W=this.p1),new Fr(k,W)}},Fr.prototype.normalize=function(){this.p1.compareTo(this.p0)<0&&this.reverse()},Fr.prototype.angle=function(){return Math.atan2(this.p1.y-this.p0.y,this.p1.x-this.p0.x)},Fr.prototype.getCoordinate=function(n){return 0===n?this.p0:this.p1},Fr.prototype.distancePerpendicular=function(n){return Le.distancePointLinePerpendicular(n,this.p0,this.p1)},Fr.prototype.minY=function(){return Math.min(this.p0.y,this.p1.y)},Fr.prototype.midPoint=function(){return Fr.midPoint(this.p0,this.p1)},Fr.prototype.projectionFactor=function(n){if(n.equals(this.p0))return 0;if(n.equals(this.p1))return 1;var a=this.p1.x-this.p0.x,h=this.p1.y-this.p0.y,d=a*a+h*h;return d<=0?Q.NaN:((n.x-this.p0.x)*a+(n.y-this.p0.y)*h)/d},Fr.prototype.closestPoints=function(n){var a=this.intersection(n);if(null!==a)return[a,a];var h=new Array(2).fill(null),d=Q.MAX_VALUE,w=null,O=this.closestPoint(n.p0);d=O.distance(n.p0),h[0]=O,h[1]=n.p0;var k=this.closestPoint(n.p1);(w=k.distance(n.p1))<d&&(d=w,h[0]=k,h[1]=n.p1);var W=n.closestPoint(this.p0);(w=W.distance(this.p0))<d&&(d=w,h[0]=this.p0,h[1]=W);var mt=n.closestPoint(this.p1);return(w=mt.distance(this.p1))<d&&(d=w,h[0]=this.p1,h[1]=mt),h},Fr.prototype.closestPoint=function(n){var a=this.projectionFactor(n);return a>0&&a<1?this.project(n):this.p0.distance(n)<this.p1.distance(n)?this.p0:this.p1},Fr.prototype.maxX=function(){return Math.max(this.p0.x,this.p1.x)},Fr.prototype.getLength=function(){return this.p0.distance(this.p1)},Fr.prototype.compareTo=function(n){var a=n,h=this.p0.compareTo(a.p0);return 0!==h?h:this.p1.compareTo(a.p1)},Fr.prototype.reverse=function(){var n=this.p0;this.p0=this.p1,this.p1=n},Fr.prototype.equalsTopo=function(n){return this.p0.equals(n.p0)&&(this.p1.equals(n.p1)||this.p0.equals(n.p1))&&this.p1.equals(n.p0)},Fr.prototype.lineIntersection=function(n){try{return Mr.intersection(this.p0,this.p1,n.p0,n.p1)}catch(a){if(!(a instanceof Yr))throw a}return null},Fr.prototype.maxY=function(){return Math.max(this.p0.y,this.p1.y)},Fr.prototype.pointAlongOffset=function(n,a){var h=this.p0.x+n*(this.p1.x-this.p0.x),d=this.p0.y+n*(this.p1.y-this.p0.y),w=this.p1.x-this.p0.x,O=this.p1.y-this.p0.y,k=Math.sqrt(w*w+O*O),W=0,mt=0;if(0!==a){if(k<=0)throw new Error("Cannot compute offset from zero-length line segment");W=a*w/k,mt=a*O/k}return new j(h-mt,d+W)},Fr.prototype.setCoordinates=function(){if(1===arguments.length){var n=arguments[0];this.setCoordinates(n.p0,n.p1)}else if(2===arguments.length){var a=arguments[0],h=arguments[1];this.p0.x=a.x,this.p0.y=a.y,this.p1.x=h.x,this.p1.y=h.y}},Fr.prototype.segmentFraction=function(n){var a=this.projectionFactor(n);return a<0?a=0:(a>1||Q.isNaN(a))&&(a=1),a},Fr.prototype.toString=function(){return"LINESTRING( "+this.p0.x+" "+this.p0.y+", "+this.p1.x+" "+this.p1.y+")"},Fr.prototype.isHorizontal=function(){return this.p0.y===this.p1.y},Fr.prototype.distance=function(){if(arguments[0]instanceof Fr){var n=arguments[0];return Le.distanceLineLine(this.p0,this.p1,n.p0,n.p1)}if(arguments[0]instanceof j)return Le.distancePointLine(arguments[0],this.p0,this.p1)},Fr.prototype.pointAlong=function(n){var a=new j;return a.x=this.p0.x+n*(this.p1.x-this.p0.x),a.y=this.p0.y+n*(this.p1.y-this.p0.y),a},Fr.prototype.hashCode=function(){var n=Q.doubleToLongBits(this.p0.x);n^=31*Q.doubleToLongBits(this.p0.y);var a=Math.trunc(n)^Math.trunc(n>>32),h=Q.doubleToLongBits(this.p1.x);return h^=31*Q.doubleToLongBits(this.p1.y),a^Math.trunc(h)^Math.trunc(h>>32)},Fr.prototype.interfaces_=function(){return[et,yt]},Fr.prototype.getClass=function(){return Fr},Fr.midPoint=function(n,a){return new j((n.x+a.x)/2,(n.y+a.y)/2)},nu.serialVersionUID.get=function(){return 0x2d2172135f411c00},Object.defineProperties(Fr,nu);var ks=function(){this.tempEnv1=new Be,this.tempEnv2=new Be,this._overlapSeg1=new Fr,this._overlapSeg2=new Fr};ks.prototype.overlap=function(){if(2!==arguments.length&&4===arguments.length){var h=arguments[2],d=arguments[3];arguments[0].getLineSegment(arguments[1],this._overlapSeg1),h.getLineSegment(d,this._overlapSeg2),this.overlap(this._overlapSeg1,this._overlapSeg2)}},ks.prototype.interfaces_=function(){return[]},ks.prototype.getClass=function(){return ks};var po=function(){this._pts=null,this._start=null,this._end=null,this._env=null,this._context=null,this._id=null;var a=arguments[1],h=arguments[2],d=arguments[3];this._pts=arguments[0],this._start=a,this._end=h,this._context=d};po.prototype.getLineSegment=function(n,a){a.p0=this._pts[n],a.p1=this._pts[n+1]},po.prototype.computeSelect=function(n,a,h,d){if(d.tempEnv1.init(this._pts[a],this._pts[h]),h-a==1)return d.select(this,a),null;if(!n.intersects(d.tempEnv1))return null;var k=Math.trunc((a+h)/2);a<k&&this.computeSelect(n,a,k,d),k<h&&this.computeSelect(n,k,h,d)},po.prototype.getCoordinates=function(){for(var n=new Array(this._end-this._start+1).fill(null),a=0,h=this._start;h<=this._end;h++)n[a++]=this._pts[h];return n},po.prototype.computeOverlaps=function(n,a){this.computeOverlapsInternal(this._start,this._end,n,n._start,n._end,a)},po.prototype.setId=function(n){this._id=n},po.prototype.select=function(n,a){this.computeSelect(n,this._start,this._end,a)},po.prototype.getEnvelope=function(){return null===this._env&&(this._env=new Be(this._pts[this._start],this._pts[this._end])),this._env},po.prototype.getEndIndex=function(){return this._end},po.prototype.getStartIndex=function(){return this._start},po.prototype.getContext=function(){return this._context},po.prototype.getId=function(){return this._id},po.prototype.computeOverlapsInternal=function(n,a,h,d,w,O){var k=this._pts[n],W=this._pts[a],mt=h._pts[d],Gt=h._pts[w];if(a-n==1&&w-d==1)return O.overlap(this,n,h,d),null;if(O.tempEnv1.init(k,W),O.tempEnv2.init(mt,Gt),!O.tempEnv1.intersects(O.tempEnv2))return null;var Ie=Math.trunc((n+a)/2),Me=Math.trunc((d+w)/2);n<Ie&&(d<Me&&this.computeOverlapsInternal(n,Ie,h,d,Me,O),Me<w&&this.computeOverlapsInternal(n,Ie,h,Me,w,O)),Ie<a&&(d<Me&&this.computeOverlapsInternal(Ie,a,h,d,Me,O),Me<w&&this.computeOverlapsInternal(Ie,a,h,Me,w,O))},po.prototype.interfaces_=function(){return[]},po.prototype.getClass=function(){return po};var Vo=function(){};Vo.prototype.interfaces_=function(){return[]},Vo.prototype.getClass=function(){return Vo},Vo.getChainStartIndices=function(n){var a=0,h=new Je;h.add(new Kt(a));do{var d=Vo.findChainEnd(n,a);h.add(new Kt(d)),a=d}while(a<n.length-1);return Vo.toIntArray(h)},Vo.findChainEnd=function(n,a){for(var h=a;h<n.length-1&&n[h].equals2D(n[h+1]);)h++;if(h>=n.length-1)return n.length-1;for(var d=ni.quadrant(n[h],n[h+1]),w=a+1;w<n.length&&(n[w-1].equals2D(n[w])||ni.quadrant(n[w-1],n[w])===d);)w++;return w-1},Vo.getChains=function(){if(1===arguments.length)return Vo.getChains(arguments[0],null);if(2===arguments.length){for(var a=arguments[0],h=arguments[1],d=new Je,w=Vo.getChainStartIndices(a),O=0;O<w.length-1;O++){var k=new po(a,w[O],w[O+1],h);d.add(k)}return d}},Vo.toIntArray=function(n){for(var a=new Array(n.size()).fill(null),h=0;h<a.length;h++)a[h]=n.get(h).intValue();return a};var iu=function(){};iu.prototype.computeNodes=function(n){},iu.prototype.getNodedSubstrings=function(){},iu.prototype.interfaces_=function(){return[]},iu.prototype.getClass=function(){return iu};var Ci=function(){this._segInt=null,0!==arguments.length&&1===arguments.length&&this.setSegmentIntersector(arguments[0])};Ci.prototype.setSegmentIntersector=function(n){this._segInt=n},Ci.prototype.interfaces_=function(){return[iu]},Ci.prototype.getClass=function(){return Ci};var gu=function(n){function a(d){d?n.call(this,d):n.call(this),this._monoChains=new Je,this._index=new Jl,this._idCounter=0,this._nodedSegStrings=null,this._nOverlaps=0}n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a;var h={SegmentOverlapAction:{configurable:!0}};return a.prototype.getMonotoneChains=function(){return this._monoChains},a.prototype.getNodedSubstrings=function(){return vi.getNodedSubstrings(this._nodedSegStrings)},a.prototype.getIndex=function(){return this._index},a.prototype.add=function(d){for(var w=Vo.getChains(d.getCoordinates(),d).iterator();w.hasNext();){var O=w.next();O.setId(this._idCounter++),this._index.insert(O.getEnvelope(),O),this._monoChains.add(O)}},a.prototype.computeNodes=function(d){this._nodedSegStrings=d;for(var w=d.iterator();w.hasNext();)this.add(w.next());this.intersectChains()},a.prototype.intersectChains=function(){for(var d=new Ju(this._segInt),w=this._monoChains.iterator();w.hasNext();)for(var O=w.next(),k=this._index.query(O.getEnvelope()).iterator();k.hasNext();){var W=k.next();if(W.getId()>O.getId()&&(O.computeOverlaps(W,d),this._nOverlaps++),this._segInt.isDone())return null}},a.prototype.interfaces_=function(){return[]},a.prototype.getClass=function(){return a},h.SegmentOverlapAction.get=function(){return Ju},Object.defineProperties(a,h),a}(Ci),Ju=function(n){function a(){n.call(this),this._si=null,this._si=arguments[0]}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.overlap=function(){if(4!==arguments.length)return n.prototype.overlap.apply(this,arguments);var d=arguments[1],w=arguments[2],O=arguments[3],k=arguments[0].getContext(),W=w.getContext();this._si.processIntersections(k,d,W,O)},a.prototype.interfaces_=function(){return[]},a.prototype.getClass=function(){return a},a}(ks),Hn=function n(){if(this._quadrantSegments=n.DEFAULT_QUADRANT_SEGMENTS,this._endCapStyle=n.CAP_ROUND,this._joinStyle=n.JOIN_ROUND,this._mitreLimit=n.DEFAULT_MITRE_LIMIT,this._isSingleSided=!1,this._simplifyFactor=n.DEFAULT_SIMPLIFY_FACTOR,0!==arguments.length)if(1===arguments.length)this.setQuadrantSegments(arguments[0]);else if(2===arguments.length){var d=arguments[1];this.setQuadrantSegments(arguments[0]),this.setEndCapStyle(d)}else if(4===arguments.length){var O=arguments[1],k=arguments[2],W=arguments[3];this.setQuadrantSegments(arguments[0]),this.setEndCapStyle(O),this.setJoinStyle(k),this.setMitreLimit(W)}},bs={CAP_ROUND:{configurable:!0},CAP_FLAT:{configurable:!0},CAP_SQUARE:{configurable:!0},JOIN_ROUND:{configurable:!0},JOIN_MITRE:{configurable:!0},JOIN_BEVEL:{configurable:!0},DEFAULT_QUADRANT_SEGMENTS:{configurable:!0},DEFAULT_MITRE_LIMIT:{configurable:!0},DEFAULT_SIMPLIFY_FACTOR:{configurable:!0}};Hn.prototype.getEndCapStyle=function(){return this._endCapStyle},Hn.prototype.isSingleSided=function(){return this._isSingleSided},Hn.prototype.setQuadrantSegments=function(n){this._quadrantSegments=n,0===this._quadrantSegments&&(this._joinStyle=Hn.JOIN_BEVEL),this._quadrantSegments<0&&(this._joinStyle=Hn.JOIN_MITRE,this._mitreLimit=Math.abs(this._quadrantSegments)),n<=0&&(this._quadrantSegments=1),this._joinStyle!==Hn.JOIN_ROUND&&(this._quadrantSegments=Hn.DEFAULT_QUADRANT_SEGMENTS)},Hn.prototype.getJoinStyle=function(){return this._joinStyle},Hn.prototype.setJoinStyle=function(n){this._joinStyle=n},Hn.prototype.setSimplifyFactor=function(n){this._simplifyFactor=n<0?0:n},Hn.prototype.getSimplifyFactor=function(){return this._simplifyFactor},Hn.prototype.getQuadrantSegments=function(){return this._quadrantSegments},Hn.prototype.setEndCapStyle=function(n){this._endCapStyle=n},Hn.prototype.getMitreLimit=function(){return this._mitreLimit},Hn.prototype.setMitreLimit=function(n){this._mitreLimit=n},Hn.prototype.setSingleSided=function(n){this._isSingleSided=n},Hn.prototype.interfaces_=function(){return[]},Hn.prototype.getClass=function(){return Hn},Hn.bufferDistanceError=function(n){var a=Math.PI/2/n;return 1-Math.cos(a/2)},bs.CAP_ROUND.get=function(){return 1},bs.CAP_FLAT.get=function(){return 2},bs.CAP_SQUARE.get=function(){return 3},bs.JOIN_ROUND.get=function(){return 1},bs.JOIN_MITRE.get=function(){return 2},bs.JOIN_BEVEL.get=function(){return 3},bs.DEFAULT_QUADRANT_SEGMENTS.get=function(){return 8},bs.DEFAULT_MITRE_LIMIT.get=function(){return 5},bs.DEFAULT_SIMPLIFY_FACTOR.get=function(){return.01},Object.defineProperties(Hn,bs);var Vi=function(n){this._distanceTol=null,this._isDeleted=null,this._angleOrientation=Le.COUNTERCLOCKWISE,this._inputLine=n||null},Pu={INIT:{configurable:!0},DELETE:{configurable:!0},KEEP:{configurable:!0},NUM_PTS_TO_CHECK:{configurable:!0}};Vi.prototype.isDeletable=function(n,a,h,d){var w=this._inputLine[n],O=this._inputLine[a],k=this._inputLine[h];return!!this.isConcave(w,O,k)&&!!this.isShallow(w,O,k,d)&&this.isShallowSampled(w,O,n,h,d)},Vi.prototype.deleteShallowConcavities=function(){for(var n=1,a=this.findNextNonDeletedIndex(n),h=this.findNextNonDeletedIndex(a),d=!1;h<this._inputLine.length;){var w=!1;this.isDeletable(n,a,h,this._distanceTol)&&(this._isDeleted[a]=Vi.DELETE,w=!0,d=!0),a=this.findNextNonDeletedIndex(n=w?h:a),h=this.findNextNonDeletedIndex(a)}return d},Vi.prototype.isShallowConcavity=function(n,a,h,d){return Le.computeOrientation(n,a,h)===this._angleOrientation&&Le.distancePointLine(a,n,h)<d},Vi.prototype.isShallowSampled=function(n,a,h,d,w){var O=Math.trunc((d-h)/Vi.NUM_PTS_TO_CHECK);O<=0&&(O=1);for(var k=h;k<d;k+=O)if(!this.isShallow(n,a,this._inputLine[k],w))return!1;return!0},Vi.prototype.isConcave=function(n,a,h){return Le.computeOrientation(n,a,h)===this._angleOrientation},Vi.prototype.simplify=function(n){this._distanceTol=Math.abs(n),n<0&&(this._angleOrientation=Le.CLOCKWISE),this._isDeleted=new Array(this._inputLine.length).fill(null);var a=!1;do{a=this.deleteShallowConcavities()}while(a);return this.collapseLine()},Vi.prototype.findNextNonDeletedIndex=function(n){for(var a=n+1;a<this._inputLine.length&&this._isDeleted[a]===Vi.DELETE;)a++;return a},Vi.prototype.isShallow=function(n,a,h,d){return Le.distancePointLine(a,n,h)<d},Vi.prototype.collapseLine=function(){for(var n=new V,a=0;a<this._inputLine.length;a++)this._isDeleted[a]!==Vi.DELETE&&n.add(this._inputLine[a]);return n.toCoordinateArray()},Vi.prototype.interfaces_=function(){return[]},Vi.prototype.getClass=function(){return Vi},Vi.simplify=function(n,a){return new Vi(n).simplify(a)},Pu.INIT.get=function(){return 0},Pu.DELETE.get=function(){return 1},Pu.KEEP.get=function(){return 1},Pu.NUM_PTS_TO_CHECK.get=function(){return 10},Object.defineProperties(Vi,Pu);var Ia=function(){this._ptList=null,this._precisionModel=null,this._minimimVertexDistance=0,this._ptList=new Je},Vs={COORDINATE_ARRAY_TYPE:{configurable:!0}};Ia.prototype.getCoordinates=function(){return this._ptList.toArray(Ia.COORDINATE_ARRAY_TYPE)},Ia.prototype.setPrecisionModel=function(n){this._precisionModel=n},Ia.prototype.addPt=function(n){var a=new j(n);if(this._precisionModel.makePrecise(a),this.isRedundant(a))return null;this._ptList.add(a)},Ia.prototype.revere=function(){},Ia.prototype.addPts=function(n,a){if(a)for(var h=0;h<n.length;h++)this.addPt(n[h]);else for(var d=n.length-1;d>=0;d--)this.addPt(n[d])},Ia.prototype.isRedundant=function(n){if(this._ptList.size()<1)return!1;var a=this._ptList.get(this._ptList.size()-1);return n.distance(a)<this._minimimVertexDistance},Ia.prototype.toString=function(){return(new en).createLineString(this.getCoordinates()).toString()},Ia.prototype.closeRing=function(){if(this._ptList.size()<1)return null;var n=new j(this._ptList.get(0)),a=this._ptList.get(this._ptList.size()-1);if(n.equals(a))return null;this._ptList.add(n)},Ia.prototype.setMinimumVertexDistance=function(n){this._minimimVertexDistance=n},Ia.prototype.interfaces_=function(){return[]},Ia.prototype.getClass=function(){return Ia},Vs.COORDINATE_ARRAY_TYPE.get=function(){return new Array(0).fill(null)},Object.defineProperties(Ia,Vs);var Cn=function(){},ws={PI_TIMES_2:{configurable:!0},PI_OVER_2:{configurable:!0},PI_OVER_4:{configurable:!0},COUNTERCLOCKWISE:{configurable:!0},CLOCKWISE:{configurable:!0},NONE:{configurable:!0}};Cn.prototype.interfaces_=function(){return[]},Cn.prototype.getClass=function(){return Cn},Cn.toDegrees=function(n){return 180*n/Math.PI},Cn.normalize=function(n){for(;n>Math.PI;)n-=Cn.PI_TIMES_2;for(;n<=-Math.PI;)n+=Cn.PI_TIMES_2;return n},Cn.angle=function(){if(1===arguments.length){var n=arguments[0];return Math.atan2(n.y,n.x)}if(2===arguments.length){var a=arguments[0],h=arguments[1];return Math.atan2(h.y-a.y,h.x-a.x)}},Cn.isAcute=function(n,a,h){return(n.x-a.x)*(h.x-a.x)+(n.y-a.y)*(h.y-a.y)>0},Cn.isObtuse=function(n,a,h){return(n.x-a.x)*(h.x-a.x)+(n.y-a.y)*(h.y-a.y)<0},Cn.interiorAngle=function(n,a,h){var d=Cn.angle(a,n),w=Cn.angle(a,h);return Math.abs(w-d)},Cn.normalizePositive=function(n){if(n<0){for(;n<0;)n+=Cn.PI_TIMES_2;n>=Cn.PI_TIMES_2&&(n=0)}else{for(;n>=Cn.PI_TIMES_2;)n-=Cn.PI_TIMES_2;n<0&&(n=0)}return n},Cn.angleBetween=function(n,a,h){var d=Cn.angle(a,n),w=Cn.angle(a,h);return Cn.diff(d,w)},Cn.diff=function(n,a){var h=null;return(h=n<a?a-n:n-a)>Math.PI&&(h=2*Math.PI-h),h},Cn.toRadians=function(n){return n*Math.PI/180},Cn.getTurn=function(n,a){var h=Math.sin(a-n);return h>0?Cn.COUNTERCLOCKWISE:h<0?Cn.CLOCKWISE:Cn.NONE},Cn.angleBetweenOriented=function(n,a,h){var d=Cn.angle(a,n),w=Cn.angle(a,h)-d;return w<=-Math.PI?w+Cn.PI_TIMES_2:w>Math.PI?w-Cn.PI_TIMES_2:w},ws.PI_TIMES_2.get=function(){return 2*Math.PI},ws.PI_OVER_2.get=function(){return Math.PI/2},ws.PI_OVER_4.get=function(){return Math.PI/4},ws.COUNTERCLOCKWISE.get=function(){return Le.COUNTERCLOCKWISE},ws.CLOCKWISE.get=function(){return Le.CLOCKWISE},ws.NONE.get=function(){return Le.COLLINEAR},Object.defineProperties(Cn,ws);var Pi=function n(){this._maxCurveSegmentError=0,this._filletAngleQuantum=null,this._closingSegLengthFactor=1,this._segList=null,this._distance=0,this._precisionModel=null,this._bufParams=null,this._li=null,this._s0=null,this._s1=null,this._s2=null,this._seg0=new Fr,this._seg1=new Fr,this._offset0=new Fr,this._offset1=new Fr,this._side=0,this._hasNarrowConcaveAngle=!1;var h=arguments[1],d=arguments[2];this._precisionModel=arguments[0],this._bufParams=h,this._li=new Ee,this._filletAngleQuantum=Math.PI/2/h.getQuadrantSegments(),h.getQuadrantSegments()>=8&&h.getJoinStyle()===Hn.JOIN_ROUND&&(this._closingSegLengthFactor=n.MAX_CLOSING_SEG_LEN_FACTOR),this.init(d)},Bu={OFFSET_SEGMENT_SEPARATION_FACTOR:{configurable:!0},INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR:{configurable:!0},CURVE_VERTEX_SNAP_DISTANCE_FACTOR:{configurable:!0},MAX_CLOSING_SEG_LEN_FACTOR:{configurable:!0}};Pi.prototype.addNextSegment=function(n,a){if(this._s0=this._s1,this._s1=this._s2,this._s2=n,this._seg0.setCoordinates(this._s0,this._s1),this.computeOffsetSegment(this._seg0,this._side,this._distance,this._offset0),this._seg1.setCoordinates(this._s1,this._s2),this.computeOffsetSegment(this._seg1,this._side,this._distance,this._offset1),this._s1.equals(this._s2))return null;var h=Le.computeOrientation(this._s0,this._s1,this._s2),d=h===Le.CLOCKWISE&&this._side===Qe.LEFT||h===Le.COUNTERCLOCKWISE&&this._side===Qe.RIGHT;0===h?this.addCollinear(a):d?this.addOutsideTurn(h,a):this.addInsideTurn(h,a)},Pi.prototype.addLineEndCap=function(n,a){var h=new Fr(n,a),d=new Fr;this.computeOffsetSegment(h,Qe.LEFT,this._distance,d);var w=new Fr;this.computeOffsetSegment(h,Qe.RIGHT,this._distance,w);var W=Math.atan2(a.y-n.y,a.x-n.x);switch(this._bufParams.getEndCapStyle()){case Hn.CAP_ROUND:this._segList.addPt(d.p1),this.addFilletArc(a,W+Math.PI/2,W-Math.PI/2,Le.CLOCKWISE,this._distance),this._segList.addPt(w.p1);break;case Hn.CAP_FLAT:this._segList.addPt(d.p1),this._segList.addPt(w.p1);break;case Hn.CAP_SQUARE:var mt=new j;mt.x=Math.abs(this._distance)*Math.cos(W),mt.y=Math.abs(this._distance)*Math.sin(W);var Gt=new j(d.p1.x+mt.x,d.p1.y+mt.y),Ie=new j(w.p1.x+mt.x,w.p1.y+mt.y);this._segList.addPt(Gt),this._segList.addPt(Ie)}},Pi.prototype.getCoordinates=function(){return this._segList.getCoordinates()},Pi.prototype.addMitreJoin=function(n,a,h,d){var w=!0,O=null;try{O=Mr.intersection(a.p0,a.p1,h.p0,h.p1),(d<=0?1:O.distance(n)/Math.abs(d))>this._bufParams.getMitreLimit()&&(w=!1)}catch(k){if(!(k instanceof Yr))throw k;O=new j(0,0),w=!1}w?this._segList.addPt(O):this.addLimitedMitreJoin(a,h,d,this._bufParams.getMitreLimit())},Pi.prototype.addFilletCorner=function(n,a,h,d,w){var W=Math.atan2(a.y-n.y,a.x-n.x),Ie=Math.atan2(h.y-n.y,h.x-n.x);d===Le.CLOCKWISE?W<=Ie&&(W+=2*Math.PI):W>=Ie&&(W-=2*Math.PI),this._segList.addPt(a),this.addFilletArc(n,W,Ie,d,w),this._segList.addPt(h)},Pi.prototype.addOutsideTurn=function(n,a){if(this._offset0.p1.distance(this._offset1.p0)<this._distance*Pi.OFFSET_SEGMENT_SEPARATION_FACTOR)return this._segList.addPt(this._offset0.p1),null;this._bufParams.getJoinStyle()===Hn.JOIN_MITRE?this.addMitreJoin(this._s1,this._offset0,this._offset1,this._distance):this._bufParams.getJoinStyle()===Hn.JOIN_BEVEL?this.addBevelJoin(this._offset0,this._offset1):(a&&this._segList.addPt(this._offset0.p1),this.addFilletCorner(this._s1,this._offset0.p1,this._offset1.p0,n,this._distance),this._segList.addPt(this._offset1.p0))},Pi.prototype.createSquare=function(n){this._segList.addPt(new j(n.x+this._distance,n.y+this._distance)),this._segList.addPt(new j(n.x+this._distance,n.y-this._distance)),this._segList.addPt(new j(n.x-this._distance,n.y-this._distance)),this._segList.addPt(new j(n.x-this._distance,n.y+this._distance)),this._segList.closeRing()},Pi.prototype.addSegments=function(n,a){this._segList.addPts(n,a)},Pi.prototype.addFirstSegment=function(){this._segList.addPt(this._offset1.p0)},Pi.prototype.addLastSegment=function(){this._segList.addPt(this._offset1.p1)},Pi.prototype.initSideSegments=function(n,a,h){this._s1=n,this._s2=a,this._side=h,this._seg1.setCoordinates(n,a),this.computeOffsetSegment(this._seg1,h,this._distance,this._offset1)},Pi.prototype.addLimitedMitreJoin=function(n,a,h,d){var w=this._seg0.p1,O=Cn.angle(w,this._seg0.p0),k=Cn.angleBetweenOriented(this._seg0.p0,w,this._seg1.p1)/2,W=Cn.normalize(O+k),mt=Cn.normalize(W+Math.PI),Gt=d*h,Ie=h-Gt*Math.abs(Math.sin(k)),Me=w.x+Gt*Math.cos(mt),Ke=w.y+Gt*Math.sin(mt),gr=new j(Me,Ke),Or=new Fr(w,gr),Zr=Or.pointAlongOffset(1,Ie),Kn=Or.pointAlongOffset(1,-Ie);this._side===Qe.LEFT?(this._segList.addPt(Zr),this._segList.addPt(Kn)):(this._segList.addPt(Kn),this._segList.addPt(Zr))},Pi.prototype.computeOffsetSegment=function(n,a,h,d){var w=a===Qe.LEFT?1:-1,O=n.p1.x-n.p0.x,k=n.p1.y-n.p0.y,W=Math.sqrt(O*O+k*k),mt=w*h*O/W,Gt=w*h*k/W;d.p0.x=n.p0.x-Gt,d.p0.y=n.p0.y+mt,d.p1.x=n.p1.x-Gt,d.p1.y=n.p1.y+mt},Pi.prototype.addFilletArc=function(n,a,h,d,w){var O=d===Le.CLOCKWISE?-1:1,k=Math.abs(a-h),W=Math.trunc(k/this._filletAngleQuantum+.5);if(W<1)return null;for(var mt=k/W,Gt=0,Ie=new j;Gt<k;){var Me=a+O*Gt;Ie.x=n.x+w*Math.cos(Me),Ie.y=n.y+w*Math.sin(Me),this._segList.addPt(Ie),Gt+=mt}},Pi.prototype.addInsideTurn=function(n,a){if(this._li.computeIntersection(this._offset0.p0,this._offset0.p1,this._offset1.p0,this._offset1.p1),this._li.hasIntersection())this._segList.addPt(this._li.getIntersection(0));else if(this._hasNarrowConcaveAngle=!0,this._offset0.p1.distance(this._offset1.p0)<this._distance*Pi.INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR)this._segList.addPt(this._offset0.p1);else{if(this._segList.addPt(this._offset0.p1),this._closingSegLengthFactor>0){var h=new j((this._closingSegLengthFactor*this._offset0.p1.x+this._s1.x)/(this._closingSegLengthFactor+1),(this._closingSegLengthFactor*this._offset0.p1.y+this._s1.y)/(this._closingSegLengthFactor+1));this._segList.addPt(h);var d=new j((this._closingSegLengthFactor*this._offset1.p0.x+this._s1.x)/(this._closingSegLengthFactor+1),(this._closingSegLengthFactor*this._offset1.p0.y+this._s1.y)/(this._closingSegLengthFactor+1));this._segList.addPt(d)}else this._segList.addPt(this._s1);this._segList.addPt(this._offset1.p0)}},Pi.prototype.createCircle=function(n){var a=new j(n.x+this._distance,n.y);this._segList.addPt(a),this.addFilletArc(n,0,2*Math.PI,-1,this._distance),this._segList.closeRing()},Pi.prototype.addBevelJoin=function(n,a){this._segList.addPt(n.p1),this._segList.addPt(a.p0)},Pi.prototype.init=function(n){this._distance=n,this._maxCurveSegmentError=n*(1-Math.cos(this._filletAngleQuantum/2)),this._segList=new Ia,this._segList.setPrecisionModel(this._precisionModel),this._segList.setMinimumVertexDistance(n*Pi.CURVE_VERTEX_SNAP_DISTANCE_FACTOR)},Pi.prototype.addCollinear=function(n){this._li.computeIntersection(this._s0,this._s1,this._s1,this._s2),this._li.getIntersectionNum()>=2&&(this._bufParams.getJoinStyle()===Hn.JOIN_BEVEL||this._bufParams.getJoinStyle()===Hn.JOIN_MITRE?(n&&this._segList.addPt(this._offset0.p1),this._segList.addPt(this._offset1.p0)):this.addFilletCorner(this._s1,this._offset0.p1,this._offset1.p0,Le.CLOCKWISE,this._distance))},Pi.prototype.closeRing=function(){this._segList.closeRing()},Pi.prototype.hasNarrowConcaveAngle=function(){return this._hasNarrowConcaveAngle},Pi.prototype.interfaces_=function(){return[]},Pi.prototype.getClass=function(){return Pi},Bu.OFFSET_SEGMENT_SEPARATION_FACTOR.get=function(){return.001},Bu.INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR.get=function(){return.001},Bu.CURVE_VERTEX_SNAP_DISTANCE_FACTOR.get=function(){return 1e-6},Bu.MAX_CLOSING_SEG_LEN_FACTOR.get=function(){return 80},Object.defineProperties(Pi,Bu);var Ko=function(){this._distance=0,this._precisionModel=null,this._bufParams=null;var a=arguments[1];this._precisionModel=arguments[0],this._bufParams=a};Ko.prototype.getOffsetCurve=function(n,a){if(this._distance=a,0===a)return null;var h=a<0,d=Math.abs(a),w=this.getSegGen(d);n.length<=1?this.computePointCurve(n[0],w):this.computeOffsetCurve(n,h,w);var O=w.getCoordinates();return h&&Y.reverse(O),O},Ko.prototype.computeSingleSidedBufferCurve=function(n,a,h){var d=this.simplifyTolerance(this._distance);if(a){h.addSegments(n,!0);var w=Vi.simplify(n,-d),O=w.length-1;h.initSideSegments(w[O],w[O-1],Qe.LEFT),h.addFirstSegment();for(var k=O-2;k>=0;k--)h.addNextSegment(w[k],!0)}else{h.addSegments(n,!1);var W=Vi.simplify(n,d),mt=W.length-1;h.initSideSegments(W[0],W[1],Qe.LEFT),h.addFirstSegment();for(var Gt=2;Gt<=mt;Gt++)h.addNextSegment(W[Gt],!0)}h.addLastSegment(),h.closeRing()},Ko.prototype.computeRingBufferCurve=function(n,a,h){var d=this.simplifyTolerance(this._distance);a===Qe.RIGHT&&(d=-d);var w=Vi.simplify(n,d),O=w.length-1;h.initSideSegments(w[O-1],w[0],a);for(var k=1;k<=O;k++)h.addNextSegment(w[k],1!==k);h.closeRing()},Ko.prototype.computeLineBufferCurve=function(n,a){var h=this.simplifyTolerance(this._distance),d=Vi.simplify(n,h),w=d.length-1;a.initSideSegments(d[0],d[1],Qe.LEFT);for(var O=2;O<=w;O++)a.addNextSegment(d[O],!0);a.addLastSegment(),a.addLineEndCap(d[w-1],d[w]);var k=Vi.simplify(n,-h),W=k.length-1;a.initSideSegments(k[W],k[W-1],Qe.LEFT);for(var mt=W-2;mt>=0;mt--)a.addNextSegment(k[mt],!0);a.addLastSegment(),a.addLineEndCap(k[1],k[0]),a.closeRing()},Ko.prototype.computePointCurve=function(n,a){switch(this._bufParams.getEndCapStyle()){case Hn.CAP_ROUND:a.createCircle(n);break;case Hn.CAP_SQUARE:a.createSquare(n)}},Ko.prototype.getLineCurve=function(n,a){if(this._distance=a,a<0&&!this._bufParams.isSingleSided()||0===a)return null;var h=Math.abs(a),d=this.getSegGen(h);return n.length<=1?this.computePointCurve(n[0],d):this._bufParams.isSingleSided()?this.computeSingleSidedBufferCurve(n,a<0,d):this.computeLineBufferCurve(n,d),d.getCoordinates()},Ko.prototype.getBufferParameters=function(){return this._bufParams},Ko.prototype.simplifyTolerance=function(n){return n*this._bufParams.getSimplifyFactor()},Ko.prototype.getRingCurve=function(n,a,h){if(this._distance=h,n.length<=2)return this.getLineCurve(n,h);if(0===h)return Ko.copyCoordinates(n);var d=this.getSegGen(h);return this.computeRingBufferCurve(n,a,d),d.getCoordinates()},Ko.prototype.computeOffsetCurve=function(n,a,h){var d=this.simplifyTolerance(this._distance);if(a){var w=Vi.simplify(n,-d),O=w.length-1;h.initSideSegments(w[O],w[O-1],Qe.LEFT),h.addFirstSegment();for(var k=O-2;k>=0;k--)h.addNextSegment(w[k],!0)}else{var W=Vi.simplify(n,d),mt=W.length-1;h.initSideSegments(W[0],W[1],Qe.LEFT),h.addFirstSegment();for(var Gt=2;Gt<=mt;Gt++)h.addNextSegment(W[Gt],!0)}h.addLastSegment()},Ko.prototype.getSegGen=function(n){return new Pi(this._precisionModel,this._bufParams,n)},Ko.prototype.interfaces_=function(){return[]},Ko.prototype.getClass=function(){return Ko},Ko.copyCoordinates=function(n){for(var a=new Array(n.length).fill(null),h=0;h<a.length;h++)a[h]=new j(n[h]);return a};var $a=function(){this._subgraphs=null,this._seg=new Fr,this._cga=new Le,this._subgraphs=arguments[0]},Ku={DepthSegment:{configurable:!0}};$a.prototype.findStabbedSegments=function(){if(1===arguments.length){for(var n=arguments[0],a=new Je,h=this._subgraphs.iterator();h.hasNext();){var d=h.next(),w=d.getEnvelope();n.y<w.getMinY()||n.y>w.getMaxY()||this.findStabbedSegments(n,d.getDirectedEdges(),a)}return a}if(3===arguments.length)if(Te(arguments[2],ki)&&arguments[0]instanceof j&&arguments[1]instanceof zs){for(var O=arguments[0],k=arguments[1],W=arguments[2],mt=k.getEdge().getCoordinates(),Gt=0;Gt<mt.length-1;Gt++)if(this._seg.p0=mt[Gt],this._seg.p1=mt[Gt+1],this._seg.p0.y>this._seg.p1.y&&this._seg.reverse(),!(Math.max(this._seg.p0.x,this._seg.p1.x)<O.x||this._seg.isHorizontal()||O.y<this._seg.p0.y||O.y>this._seg.p1.y||Le.computeOrientation(this._seg.p0,this._seg.p1,O)===Le.RIGHT)){var Ie=k.getDepth(Qe.LEFT);this._seg.p0.equals(mt[Gt])||(Ie=k.getDepth(Qe.RIGHT));var Me=new ts(this._seg,Ie);W.add(Me)}}else if(Te(arguments[2],ki)&&arguments[0]instanceof j&&Te(arguments[1],ki))for(var Ke=arguments[0],Or=arguments[2],Zr=arguments[1].iterator();Zr.hasNext();){var Kn=Zr.next();Kn.isForward()&&this.findStabbedSegments(Ke,Kn,Or)}},$a.prototype.getDepth=function(n){var a=this.findStabbedSegments(n);return 0===a.size()?0:oa.min(a)._leftDepth},$a.prototype.interfaces_=function(){return[]},$a.prototype.getClass=function(){return $a},Ku.DepthSegment.get=function(){return ts},Object.defineProperties($a,Ku);var ts=function(){this._upwardSeg=null,this._leftDepth=null;var a=arguments[1];this._upwardSeg=new Fr(arguments[0]),this._leftDepth=a};ts.prototype.compareTo=function(n){var a=n;if(this._upwardSeg.minX()>=a._upwardSeg.maxX())return 1;if(this._upwardSeg.maxX()<=a._upwardSeg.minX())return-1;var h=this._upwardSeg.orientationIndex(a._upwardSeg);return 0!==h||0!=(h=-1*a._upwardSeg.orientationIndex(this._upwardSeg))?h:this._upwardSeg.compareTo(a._upwardSeg)},ts.prototype.compareX=function(n,a){var h=n.p0.compareTo(a.p0);return 0!==h?h:n.p1.compareTo(a.p1)},ts.prototype.toString=function(){return this._upwardSeg.toString()},ts.prototype.interfaces_=function(){return[et]},ts.prototype.getClass=function(){return ts};var Nn=function(n,a,h){this.p0=n||null,this.p1=a||null,this.p2=h||null};Nn.prototype.area=function(){return Nn.area(this.p0,this.p1,this.p2)},Nn.prototype.signedArea=function(){return Nn.signedArea(this.p0,this.p1,this.p2)},Nn.prototype.interpolateZ=function(n){if(null===n)throw new J("Supplied point is null.");return Nn.interpolateZ(n,this.p0,this.p1,this.p2)},Nn.prototype.longestSideLength=function(){return Nn.longestSideLength(this.p0,this.p1,this.p2)},Nn.prototype.isAcute=function(){return Nn.isAcute(this.p0,this.p1,this.p2)},Nn.prototype.circumcentre=function(){return Nn.circumcentre(this.p0,this.p1,this.p2)},Nn.prototype.area3D=function(){return Nn.area3D(this.p0,this.p1,this.p2)},Nn.prototype.centroid=function(){return Nn.centroid(this.p0,this.p1,this.p2)},Nn.prototype.inCentre=function(){return Nn.inCentre(this.p0,this.p1,this.p2)},Nn.prototype.interfaces_=function(){return[]},Nn.prototype.getClass=function(){return Nn},Nn.area=function(n,a,h){return Math.abs(((h.x-n.x)*(a.y-n.y)-(a.x-n.x)*(h.y-n.y))/2)},Nn.signedArea=function(n,a,h){return((h.x-n.x)*(a.y-n.y)-(a.x-n.x)*(h.y-n.y))/2},Nn.det=function(n,a,h,d){return n*d-a*h},Nn.interpolateZ=function(n,a,h,d){var w=a.x,O=a.y,k=h.x-w,W=d.x-w,mt=h.y-O,Gt=d.y-O,Ie=k*Gt-W*mt,Me=n.x-w,Ke=n.y-O;return a.z+(Gt*Me-W*Ke)/Ie*(h.z-a.z)+(-mt*Me+k*Ke)/Ie*(d.z-a.z)},Nn.longestSideLength=function(n,a,h){var d=n.distance(a),w=a.distance(h),O=h.distance(n),k=d;return w>k&&(k=w),O>k&&(k=O),k},Nn.isAcute=function(n,a,h){return!!Cn.isAcute(n,a,h)&&!!Cn.isAcute(a,h,n)&&!!Cn.isAcute(h,n,a)},Nn.circumcentre=function(n,a,h){var d=h.x,w=h.y,O=n.x-d,k=n.y-w,W=a.x-d,mt=a.y-w,Gt=2*Nn.det(O,k,W,mt),Ie=Nn.det(k,O*O+k*k,mt,W*W+mt*mt),Me=Nn.det(O,O*O+k*k,W,W*W+mt*mt);return new j(d-Ie/Gt,w+Me/Gt)},Nn.perpendicularBisector=function(n,a){var h=a.x-n.x,d=a.y-n.y,w=new Mr(n.x+h/2,n.y+d/2,1),O=new Mr(n.x-d+h/2,n.y+h+d/2,1);return new Mr(w,O)},Nn.angleBisector=function(n,a,h){var d=a.distance(n),w=d/(d+a.distance(h));return new j(n.x+w*(h.x-n.x),n.y+w*(h.y-n.y))},Nn.area3D=function(n,a,h){var d=a.x-n.x,w=a.y-n.y,O=a.z-n.z,k=h.x-n.x,W=h.y-n.y,mt=h.z-n.z,Gt=w*mt-O*W,Ie=O*k-d*mt,Me=d*W-w*k;return Math.sqrt(Gt*Gt+Ie*Ie+Me*Me)/2},Nn.centroid=function(n,a,h){return new j((n.x+a.x+h.x)/3,(n.y+a.y+h.y)/3)},Nn.inCentre=function(n,a,h){var d=a.distance(h),w=n.distance(h),O=n.distance(a),k=d+w+O;return new j((d*n.x+w*a.x+O*h.x)/k,(d*n.y+w*a.y+O*h.y)/k)};var va=function(){this._inputGeom=null,this._distance=null,this._curveBuilder=null,this._curveList=new Je;var a=arguments[1],h=arguments[2];this._inputGeom=arguments[0],this._distance=a,this._curveBuilder=h};va.prototype.addPoint=function(n){if(this._distance<=0)return null;var a=n.getCoordinates(),h=this._curveBuilder.getLineCurve(a,this._distance);this.addCurve(h,at.EXTERIOR,at.INTERIOR)},va.prototype.addPolygon=function(n){var a=this._distance,h=Qe.LEFT;this._distance<0&&(a=-this._distance,h=Qe.RIGHT);var d=n.getExteriorRing(),w=Y.removeRepeatedPoints(d.getCoordinates());if(this._distance<0&&this.isErodedCompletely(d,this._distance)||this._distance<=0&&w.length<3)return null;this.addPolygonRing(w,a,h,at.EXTERIOR,at.INTERIOR);for(var O=0;O<n.getNumInteriorRing();O++){var k=n.getInteriorRingN(O),W=Y.removeRepeatedPoints(k.getCoordinates());this._distance>0&&this.isErodedCompletely(k,-this._distance)||this.addPolygonRing(W,a,Qe.opposite(h),at.INTERIOR,at.EXTERIOR)}},va.prototype.isTriangleErodedCompletely=function(n,a){var h=new Nn(n[0],n[1],n[2]),d=h.inCentre();return Le.distancePointLine(d,h.p0,h.p1)<Math.abs(a)},va.prototype.addLineString=function(n){if(this._distance<=0&&!this._curveBuilder.getBufferParameters().isSingleSided())return null;var a=Y.removeRepeatedPoints(n.getCoordinates()),h=this._curveBuilder.getLineCurve(a,this._distance);this.addCurve(h,at.EXTERIOR,at.INTERIOR)},va.prototype.addCurve=function(n,a,h){if(null===n||n.length<2)return null;var d=new vi(n,new ri(0,at.BOUNDARY,a,h));this._curveList.add(d)},va.prototype.getCurves=function(){return this.add(this._inputGeom),this._curveList},va.prototype.addPolygonRing=function(n,a,h,d,w){if(0===a&&n.length<Un.MINIMUM_VALID_SIZE)return null;var O=d,k=w;n.length>=Un.MINIMUM_VALID_SIZE&&Le.isCCW(n)&&(O=w,k=d,h=Qe.opposite(h));var W=this._curveBuilder.getRingCurve(n,h,a);this.addCurve(W,O,k)},va.prototype.add=function(n){if(n.isEmpty())return null;n instanceof cn?this.addPolygon(n):n instanceof ir?this.addLineString(n):n instanceof On?this.addPoint(n):(n instanceof gi||n instanceof nr||n instanceof on||n instanceof Re)&&this.addCollection(n)},va.prototype.isErodedCompletely=function(n,a){var h=n.getCoordinates();if(h.length<4)return a<0;if(4===h.length)return this.isTriangleErodedCompletely(h,a);var d=n.getEnvelopeInternal(),w=Math.min(d.getHeight(),d.getWidth());return a<0&&2*Math.abs(a)>w},va.prototype.addCollection=function(n){for(var a=0;a<n.getNumGeometries();a++){var h=n.getGeometryN(a);this.add(h)}},va.prototype.interfaces_=function(){return[]},va.prototype.getClass=function(){return va};var mu=function(){};mu.prototype.locate=function(n){},mu.prototype.interfaces_=function(){return[]},mu.prototype.getClass=function(){return mu};var Xn=function(){this._parent=null,this._atStart=null,this._max=null,this._index=null,this._subcollectionIterator=null;var n=arguments[0];this._parent=n,this._atStart=!0,this._index=0,this._max=n.getNumGeometries()};Xn.prototype.next=function(){if(this._atStart)return this._atStart=!1,Xn.isAtomic(this._parent)&&this._index++,this._parent;if(null!==this._subcollectionIterator){if(this._subcollectionIterator.hasNext())return this._subcollectionIterator.next();this._subcollectionIterator=null}if(this._index>=this._max)throw new v;var n=this._parent.getGeometryN(this._index++);return n instanceof Re?(this._subcollectionIterator=new Xn(n),this._subcollectionIterator.next()):n},Xn.prototype.remove=function(){throw new Error(this.getClass().getName())},Xn.prototype.hasNext=function(){if(this._atStart)return!0;if(null!==this._subcollectionIterator){if(this._subcollectionIterator.hasNext())return!0;this._subcollectionIterator=null}return!(this._index>=this._max)},Xn.prototype.interfaces_=function(){return[_o]},Xn.prototype.getClass=function(){return Xn},Xn.isAtomic=function(n){return!(n instanceof Re)};var aa=function(){this._geom=null,this._geom=arguments[0]};aa.prototype.locate=function(n){return aa.locate(n,this._geom)},aa.prototype.interfaces_=function(){return[mu]},aa.prototype.getClass=function(){return aa},aa.isPointInRing=function(n,a){return!!a.getEnvelopeInternal().intersects(n)&&Le.isPointInRing(n,a.getCoordinates())},aa.containsPointInPolygon=function(n,a){if(a.isEmpty())return!1;var h=a.getExteriorRing();if(!aa.isPointInRing(n,h))return!1;for(var d=0;d<a.getNumInteriorRing();d++){var w=a.getInteriorRingN(d);if(aa.isPointInRing(n,w))return!1}return!0},aa.containsPoint=function(n,a){if(a instanceof cn)return aa.containsPointInPolygon(n,a);if(a instanceof Re)for(var h=new Xn(a);h.hasNext();){var d=h.next();if(d!==a&&aa.containsPoint(n,d))return!0}return!1},aa.locate=function(n,a){return a.isEmpty()?at.EXTERIOR:aa.containsPoint(n,a)?at.INTERIOR:at.EXTERIOR};var Oo=function(){this._edgeMap=new ye,this._edgeList=null,this._ptInAreaLocation=[at.NONE,at.NONE]};Oo.prototype.getNextCW=function(n){this.getEdges();var a=this._edgeList.indexOf(n),h=a-1;return 0===a&&(h=this._edgeList.size()-1),this._edgeList.get(h)},Oo.prototype.propagateSideLabels=function(n){for(var a=at.NONE,h=this.iterator();h.hasNext();){var d=h.next().getLabel();d.isArea(n)&&d.getLocation(n,Qe.LEFT)!==at.NONE&&(a=d.getLocation(n,Qe.LEFT))}if(a===at.NONE)return null;for(var w=a,O=this.iterator();O.hasNext();){var k=O.next(),W=k.getLabel();if(W.getLocation(n,Qe.ON)===at.NONE&&W.setLocation(n,Qe.ON,w),W.isArea(n)){var mt=W.getLocation(n,Qe.LEFT),Gt=W.getLocation(n,Qe.RIGHT);if(Gt!==at.NONE){if(Gt!==w)throw new Ja("side location conflict",k.getCoordinate());mt===at.NONE&&$.shouldNeverReachHere("found single null side (at "+k.getCoordinate()+")"),w=mt}else $.isTrue(W.getLocation(n,Qe.LEFT)===at.NONE,"found single null side"),W.setLocation(n,Qe.RIGHT,w),W.setLocation(n,Qe.LEFT,w)}}},Oo.prototype.getCoordinate=function(){var n=this.iterator();return n.hasNext()?n.next().getCoordinate():null},Oo.prototype.print=function(n){Cr.out.println("EdgeEndStar:   "+this.getCoordinate());for(var a=this.iterator();a.hasNext();)a.next().print(n)},Oo.prototype.isAreaLabelsConsistent=function(n){return this.computeEdgeEndLabels(n.getBoundaryNodeRule()),this.checkAreaLabelsConsistent(0)},Oo.prototype.checkAreaLabelsConsistent=function(n){var a=this.getEdges();if(a.size()<=0)return!0;var h=a.size()-1,d=a.get(h).getLabel().getLocation(n,Qe.LEFT);$.isTrue(d!==at.NONE,"Found unlabelled area edge");for(var w=d,O=this.iterator();O.hasNext();){var k=O.next().getLabel();$.isTrue(k.isArea(n),"Found non-area edge");var W=k.getLocation(n,Qe.LEFT),mt=k.getLocation(n,Qe.RIGHT);if(W===mt||mt!==w)return!1;w=W}return!0},Oo.prototype.findIndex=function(n){this.iterator();for(var a=0;a<this._edgeList.size();a++)if(this._edgeList.get(a)===n)return a;return-1},Oo.prototype.iterator=function(){return this.getEdges().iterator()},Oo.prototype.getEdges=function(){return null===this._edgeList&&(this._edgeList=new Je(this._edgeMap.values())),this._edgeList},Oo.prototype.getLocation=function(n,a,h){return this._ptInAreaLocation[n]===at.NONE&&(this._ptInAreaLocation[n]=aa.locate(a,h[n].getGeometry())),this._ptInAreaLocation[n]},Oo.prototype.toString=function(){var n=new Pt;n.append("EdgeEndStar:   "+this.getCoordinate()),n.append("\n");for(var a=this.iterator();a.hasNext();){var h=a.next();n.append(h),n.append("\n")}return n.toString()},Oo.prototype.computeEdgeEndLabels=function(n){for(var a=this.iterator();a.hasNext();)a.next().computeLabel(n)},Oo.prototype.computeLabelling=function(n){this.computeEdgeEndLabels(n[0].getBoundaryNodeRule()),this.propagateSideLabels(0),this.propagateSideLabels(1);for(var a=[!1,!1],h=this.iterator();h.hasNext();)for(var d=h.next().getLabel(),w=0;w<2;w++)d.isLine(w)&&d.getLocation(w)===at.BOUNDARY&&(a[w]=!0);for(var O=this.iterator();O.hasNext();)for(var k=O.next(),W=k.getLabel(),mt=0;mt<2;mt++)if(W.isAnyNull(mt)){var Gt=at.NONE;if(a[mt])Gt=at.EXTERIOR;else{var Ie=k.getCoordinate();Gt=this.getLocation(mt,Ie,n)}W.setAllLocationsIfNull(mt,Gt)}},Oo.prototype.getDegree=function(){return this._edgeMap.size()},Oo.prototype.insertEdgeEnd=function(n,a){this._edgeMap.put(n,a),this._edgeList=null},Oo.prototype.interfaces_=function(){return[]},Oo.prototype.getClass=function(){return Oo};var Uu=function(n){function a(){n.call(this),this._resultAreaEdgeList=null,this._label=null,this._SCANNING_FOR_INCOMING=1,this._LINKING_TO_OUTGOING=2}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.linkResultDirectedEdges=function(){this.getResultAreaEdges();for(var h=null,d=null,w=this._SCANNING_FOR_INCOMING,O=0;O<this._resultAreaEdgeList.size();O++){var k=this._resultAreaEdgeList.get(O),W=k.getSym();if(k.getLabel().isArea())switch(null===h&&k.isInResult()&&(h=k),w){case this._SCANNING_FOR_INCOMING:if(!W.isInResult())continue;d=W,w=this._LINKING_TO_OUTGOING;break;case this._LINKING_TO_OUTGOING:if(!k.isInResult())continue;d.setNext(k),w=this._SCANNING_FOR_INCOMING}}if(w===this._LINKING_TO_OUTGOING){if(null===h)throw new Ja("no outgoing dirEdge found",this.getCoordinate());$.isTrue(h.isInResult(),"unable to link last incoming dirEdge"),d.setNext(h)}},a.prototype.insert=function(h){this.insertEdgeEnd(h,h)},a.prototype.getRightmostEdge=function(){var h=this.getEdges(),d=h.size();if(d<1)return null;var w=h.get(0);if(1===d)return w;var O=h.get(d-1),k=w.getQuadrant(),W=O.getQuadrant();return ni.isNorthern(k)&&ni.isNorthern(W)?w:ni.isNorthern(k)||ni.isNorthern(W)?0!==w.getDy()?w:0!==O.getDy()?O:($.shouldNeverReachHere("found two horizontal edges incident on node"),null):O},a.prototype.print=function(h){Cr.out.println("DirectedEdgeStar: "+this.getCoordinate());for(var d=this.iterator();d.hasNext();){var w=d.next();h.print("out "),w.print(h),h.println(),h.print("in "),w.getSym().print(h),h.println()}},a.prototype.getResultAreaEdges=function(){if(null!==this._resultAreaEdgeList)return this._resultAreaEdgeList;this._resultAreaEdgeList=new Je;for(var h=this.iterator();h.hasNext();){var d=h.next();(d.isInResult()||d.getSym().isInResult())&&this._resultAreaEdgeList.add(d)}return this._resultAreaEdgeList},a.prototype.updateLabelling=function(h){for(var d=this.iterator();d.hasNext();){var w=d.next().getLabel();w.setAllLocationsIfNull(0,h.getLocation(0)),w.setAllLocationsIfNull(1,h.getLocation(1))}},a.prototype.linkAllDirectedEdges=function(){this.getEdges();for(var h=null,d=null,w=this._edgeList.size()-1;w>=0;w--){var O=this._edgeList.get(w),k=O.getSym();null===d&&(d=k),null!==h&&k.setNext(h),h=O}d.setNext(h)},a.prototype.computeDepths=function(){if(1===arguments.length){var h=arguments[0],d=this.findIndex(h),w=h.getDepth(Qe.LEFT),O=h.getDepth(Qe.RIGHT),k=this.computeDepths(d+1,this._edgeList.size(),w);if(this.computeDepths(0,d,k)!==O)throw new Ja("depth mismatch at "+h.getCoordinate())}else if(3===arguments.length){for(var mt=arguments[1],Gt=arguments[2],Ie=arguments[0];Ie<mt;Ie++){var Me=this._edgeList.get(Ie);Me.setEdgeDepths(Qe.RIGHT,Gt),Gt=Me.getDepth(Qe.LEFT)}return Gt}},a.prototype.mergeSymLabels=function(){for(var h=this.iterator();h.hasNext();){var d=h.next();d.getLabel().merge(d.getSym().getLabel())}},a.prototype.linkMinimalDirectedEdges=function(h){for(var d=null,w=null,O=this._SCANNING_FOR_INCOMING,k=this._resultAreaEdgeList.size()-1;k>=0;k--){var W=this._resultAreaEdgeList.get(k),mt=W.getSym();switch(null===d&&W.getEdgeRing()===h&&(d=W),O){case this._SCANNING_FOR_INCOMING:if(mt.getEdgeRing()!==h)continue;w=mt,O=this._LINKING_TO_OUTGOING;break;case this._LINKING_TO_OUTGOING:if(W.getEdgeRing()!==h)continue;w.setNextMin(W),O=this._SCANNING_FOR_INCOMING}}O===this._LINKING_TO_OUTGOING&&($.isTrue(null!==d,"found null for first outgoing dirEdge"),$.isTrue(d.getEdgeRing()===h,"unable to link last incoming dirEdge"),w.setNextMin(d))},a.prototype.getOutgoingDegree=function(){if(0===arguments.length){for(var h=0,d=this.iterator();d.hasNext();)d.next().isInResult()&&h++;return h}if(1===arguments.length){for(var w=arguments[0],O=0,k=this.iterator();k.hasNext();)k.next().getEdgeRing()===w&&O++;return O}},a.prototype.getLabel=function(){return this._label},a.prototype.findCoveredLineEdges=function(){for(var h=at.NONE,d=this.iterator();d.hasNext();){var w=d.next(),O=w.getSym();if(!w.isLineEdge()){if(w.isInResult()){h=at.INTERIOR;break}if(O.isInResult()){h=at.EXTERIOR;break}}}if(h===at.NONE)return null;for(var k=h,W=this.iterator();W.hasNext();){var mt=W.next(),Gt=mt.getSym();mt.isLineEdge()?mt.getEdge().setCovered(k===at.INTERIOR):(mt.isInResult()&&(k=at.EXTERIOR),Gt.isInResult()&&(k=at.INTERIOR))}},a.prototype.computeLabelling=function(h){n.prototype.computeLabelling.call(this,h),this._label=new ri(at.NONE);for(var d=this.iterator();d.hasNext();)for(var w=d.next().getEdge().getLabel(),O=0;O<2;O++){var k=w.getLocation(O);k!==at.INTERIOR&&k!==at.BOUNDARY||this._label.setLocation(O,at.INTERIOR)}},a.prototype.interfaces_=function(){return[]},a.prototype.getClass=function(){return a},a}(Oo),Mc=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.createNode=function(h){return new Hu(h,new Uu)},a.prototype.interfaces_=function(){return[]},a.prototype.getClass=function(){return a},a}(eu),ou=function n(){this._pts=null,this._orientation=null;var a=arguments[0];this._pts=a,this._orientation=n.orientation(a)};ou.prototype.compareTo=function(n){return ou.compareOriented(this._pts,this._orientation,n._pts,n._orientation)},ou.prototype.interfaces_=function(){return[et]},ou.prototype.getClass=function(){return ou},ou.orientation=function(n){return 1===Y.increasingDirection(n)},ou.compareOriented=function(n,a,h,d){for(var w=a?1:-1,O=d?1:-1,k=a?n.length:-1,W=d?h.length:-1,mt=a?0:n.length-1,Gt=d?0:h.length-1;;){var Ie=n[mt].compareTo(h[Gt]);if(0!==Ie)return Ie;var Me=(mt+=w)===k,Ke=(Gt+=O)===W;if(Me&&!Ke)return-1;if(!Me&&Ke)return 1;if(Me&&Ke)return 0}};var _a=function(){this._edges=new Je,this._ocaMap=new ye};_a.prototype.print=function(n){n.print("MULTILINESTRING ( ");for(var a=0;a<this._edges.size();a++){var h=this._edges.get(a);a>0&&n.print(","),n.print("(");for(var d=h.getCoordinates(),w=0;w<d.length;w++)w>0&&n.print(","),n.print(d[w].x+" "+d[w].y);n.println(")")}n.print(")  ")},_a.prototype.addAll=function(n){for(var a=n.iterator();a.hasNext();)this.add(a.next())},_a.prototype.findEdgeIndex=function(n){for(var a=0;a<this._edges.size();a++)if(this._edges.get(a).equals(n))return a;return-1},_a.prototype.iterator=function(){return this._edges.iterator()},_a.prototype.getEdges=function(){return this._edges},_a.prototype.get=function(n){return this._edges.get(n)},_a.prototype.findEqualEdge=function(n){var a=new ou(n.getCoordinates());return this._ocaMap.get(a)},_a.prototype.add=function(n){this._edges.add(n);var a=new ou(n.getCoordinates());this._ocaMap.put(a,n)},_a.prototype.interfaces_=function(){return[]},_a.prototype.getClass=function(){return _a};var au=function(){};au.prototype.processIntersections=function(n,a,h,d){},au.prototype.isDone=function(){},au.prototype.interfaces_=function(){return[]},au.prototype.getClass=function(){return au};var jo=function(){this._hasIntersection=!1,this._hasProper=!1,this._hasProperInterior=!1,this._hasInterior=!1,this._properIntersectionPoint=null,this._li=null,this._isSelfIntersection=null,this.numIntersections=0,this.numInteriorIntersections=0,this.numProperIntersections=0,this.numTests=0,this._li=arguments[0]};jo.prototype.isTrivialIntersection=function(n,a,h,d){if(n===h&&1===this._li.getIntersectionNum()){if(jo.isAdjacentSegments(a,d))return!0;if(n.isClosed()){var w=n.size()-1;if(0===a&&d===w||0===d&&a===w)return!0}}return!1},jo.prototype.getProperIntersectionPoint=function(){return this._properIntersectionPoint},jo.prototype.hasProperInteriorIntersection=function(){return this._hasProperInterior},jo.prototype.getLineIntersector=function(){return this._li},jo.prototype.hasProperIntersection=function(){return this._hasProper},jo.prototype.processIntersections=function(n,a,h,d){if(n===h&&a===d)return null;this.numTests++;var w=n.getCoordinates()[a],O=n.getCoordinates()[a+1],k=h.getCoordinates()[d],W=h.getCoordinates()[d+1];this._li.computeIntersection(w,O,k,W),this._li.hasIntersection()&&(this.numIntersections++,this._li.isInteriorIntersection()&&(this.numInteriorIntersections++,this._hasInterior=!0),this.isTrivialIntersection(n,a,h,d)||(this._hasIntersection=!0,n.addIntersections(this._li,a,0),h.addIntersections(this._li,d,1),this._li.isProper()&&(this.numProperIntersections++,this._hasProper=!0,this._hasProperInterior=!0)))},jo.prototype.hasIntersection=function(){return this._hasIntersection},jo.prototype.isDone=function(){return!1},jo.prototype.hasInteriorIntersection=function(){return this._hasInterior},jo.prototype.interfaces_=function(){return[au]},jo.prototype.getClass=function(){return jo},jo.isAdjacentSegments=function(n,a){return 1===Math.abs(n-a)};var Na=function(){this.coord=null,this.segmentIndex=null,this.dist=null;var a=arguments[1],h=arguments[2];this.coord=new j(arguments[0]),this.segmentIndex=a,this.dist=h};Na.prototype.getSegmentIndex=function(){return this.segmentIndex},Na.prototype.getCoordinate=function(){return this.coord},Na.prototype.print=function(n){n.print(this.coord),n.print(" seg # = "+this.segmentIndex),n.println(" dist = "+this.dist)},Na.prototype.compareTo=function(n){return this.compare(n.segmentIndex,n.dist)},Na.prototype.isEndPoint=function(n){return 0===this.segmentIndex&&0===this.dist||this.segmentIndex===n},Na.prototype.toString=function(){return this.coord+" seg # = "+this.segmentIndex+" dist = "+this.dist},Na.prototype.getDistance=function(){return this.dist},Na.prototype.compare=function(n,a){return this.segmentIndex<n?-1:this.segmentIndex>n?1:this.dist<a?-1:this.dist>a?1:0},Na.prototype.interfaces_=function(){return[et]},Na.prototype.getClass=function(){return Na};var Pa=function(){this._nodeMap=new ye,this.edge=null,this.edge=arguments[0]};Pa.prototype.print=function(n){n.println("Intersections:");for(var a=this.iterator();a.hasNext();)a.next().print(n)},Pa.prototype.iterator=function(){return this._nodeMap.values().iterator()},Pa.prototype.addSplitEdges=function(n){this.addEndpoints();for(var a=this.iterator(),h=a.next();a.hasNext();){var d=a.next(),w=this.createSplitEdge(h,d);n.add(w),h=d}},Pa.prototype.addEndpoints=function(){var n=this.edge.pts.length-1;this.add(this.edge.pts[0],0,0),this.add(this.edge.pts[n],n,0)},Pa.prototype.createSplitEdge=function(n,a){var h=a.segmentIndex-n.segmentIndex+2,w=a.dist>0||!a.coord.equals2D(this.edge.pts[a.segmentIndex]);w||h--;var O=new Array(h).fill(null),k=0;O[k++]=new j(n.coord);for(var W=n.segmentIndex+1;W<=a.segmentIndex;W++)O[k++]=this.edge.pts[W];return w&&(O[k]=a.coord),new es(O,new ri(this.edge._label))},Pa.prototype.add=function(n,a,h){var d=new Na(n,a,h),w=this._nodeMap.get(d);return null!==w?w:(this._nodeMap.put(d,d),d)},Pa.prototype.isIntersection=function(n){for(var a=this.iterator();a.hasNext();)if(a.next().coord.equals(n))return!0;return!1},Pa.prototype.interfaces_=function(){return[]},Pa.prototype.getClass=function(){return Pa};var hs=function(){};hs.prototype.getChainStartIndices=function(n){var a=0,h=new Je;h.add(new Kt(a));do{var d=this.findChainEnd(n,a);h.add(new Kt(d)),a=d}while(a<n.length-1);return hs.toIntArray(h)},hs.prototype.findChainEnd=function(n,a){for(var h=ni.quadrant(n[a],n[a+1]),d=a+1;d<n.length&&ni.quadrant(n[d-1],n[d])===h;)d++;return d-1},hs.prototype.interfaces_=function(){return[]},hs.prototype.getClass=function(){return hs},hs.toIntArray=function(n){for(var a=new Array(n.size()).fill(null),h=0;h<a.length;h++)a[h]=n.get(h).intValue();return a};var za=function(){this.e=null,this.pts=null,this.startIndex=null,this.env1=new Be,this.env2=new Be;var n=arguments[0];this.e=n,this.pts=n.getCoordinates();var a=new hs;this.startIndex=a.getChainStartIndices(this.pts)};za.prototype.getCoordinates=function(){return this.pts},za.prototype.getMaxX=function(n){var a=this.pts[this.startIndex[n]].x,h=this.pts[this.startIndex[n+1]].x;return a>h?a:h},za.prototype.getMinX=function(n){var a=this.pts[this.startIndex[n]].x,h=this.pts[this.startIndex[n+1]].x;return a<h?a:h},za.prototype.computeIntersectsForChain=function(){if(4===arguments.length){var n=arguments[0],a=arguments[1],h=arguments[2];this.computeIntersectsForChain(this.startIndex[n],this.startIndex[n+1],a,a.startIndex[h],a.startIndex[h+1],arguments[3])}else if(6===arguments.length){var w=arguments[0],O=arguments[1],k=arguments[2],W=arguments[3],mt=arguments[4],Gt=arguments[5],Ie=this.pts[w],Me=this.pts[O],Ke=k.pts[W],gr=k.pts[mt];if(O-w==1&&mt-W==1)return Gt.addIntersections(this.e,w,k.e,W),null;if(this.env1.init(Ie,Me),this.env2.init(Ke,gr),!this.env1.intersects(this.env2))return null;var Or=Math.trunc((w+O)/2),Zr=Math.trunc((W+mt)/2);w<Or&&(W<Zr&&this.computeIntersectsForChain(w,Or,k,W,Zr,Gt),Zr<mt&&this.computeIntersectsForChain(w,Or,k,Zr,mt,Gt)),Or<O&&(W<Zr&&this.computeIntersectsForChain(Or,O,k,W,Zr,Gt),Zr<mt&&this.computeIntersectsForChain(Or,O,k,Zr,mt,Gt))}},za.prototype.getStartIndexes=function(){return this.startIndex},za.prototype.computeIntersects=function(n,a){for(var h=0;h<this.startIndex.length-1;h++)for(var d=0;d<n.startIndex.length-1;d++)this.computeIntersectsForChain(h,n,d,a)},za.prototype.interfaces_=function(){return[]},za.prototype.getClass=function(){return za};var Eo=function n(){this._depth=Array(2).fill().map(function(){return Array(3)});for(var a=0;a<2;a++)for(var h=0;h<3;h++)this._depth[a][h]=n.NULL_VALUE},qu={NULL_VALUE:{configurable:!0}};Eo.prototype.getDepth=function(n,a){return this._depth[n][a]},Eo.prototype.setDepth=function(n,a,h){this._depth[n][a]=h},Eo.prototype.isNull=function(){if(0===arguments.length){for(var n=0;n<2;n++)for(var a=0;a<3;a++)if(this._depth[n][a]!==Eo.NULL_VALUE)return!1;return!0}return 1===arguments.length?this._depth[arguments[0]][1]===Eo.NULL_VALUE:2===arguments.length?this._depth[arguments[0]][arguments[1]]===Eo.NULL_VALUE:void 0},Eo.prototype.normalize=function(){for(var n=0;n<2;n++)if(!this.isNull(n)){var a=this._depth[n][1];this._depth[n][2]<a&&(a=this._depth[n][2]),a<0&&(a=0);for(var h=1;h<3;h++){var d=0;this._depth[n][h]>a&&(d=1),this._depth[n][h]=d}}},Eo.prototype.getDelta=function(n){return this._depth[n][Qe.RIGHT]-this._depth[n][Qe.LEFT]},Eo.prototype.getLocation=function(n,a){return this._depth[n][a]<=0?at.EXTERIOR:at.INTERIOR},Eo.prototype.toString=function(){return"A: "+this._depth[0][1]+","+this._depth[0][2]+" B: "+this._depth[1][1]+","+this._depth[1][2]},Eo.prototype.add=function(){if(1===arguments.length)for(var n=arguments[0],a=0;a<2;a++)for(var h=1;h<3;h++){var d=n.getLocation(a,h);d!==at.EXTERIOR&&d!==at.INTERIOR||(this.isNull(a,h)?this._depth[a][h]=Eo.depthAtLocation(d):this._depth[a][h]+=Eo.depthAtLocation(d))}else 3===arguments.length&&arguments[2]===at.INTERIOR&&this._depth[arguments[0]][arguments[1]]++},Eo.prototype.interfaces_=function(){return[]},Eo.prototype.getClass=function(){return Eo},Eo.depthAtLocation=function(n){return n===at.EXTERIOR?0:n===at.INTERIOR?1:Eo.NULL_VALUE},qu.NULL_VALUE.get=function(){return-1},Object.defineProperties(Eo,qu);var es=function(n){function a(){if(n.call(this),this.pts=null,this._env=null,this.eiList=new Pa(this),this._name=null,this._mce=null,this._isIsolated=!0,this._depth=new Eo,this._depthDelta=0,1===arguments.length)a.call(this,arguments[0],null);else if(2===arguments.length){var w=arguments[1];this.pts=arguments[0],this._label=w}}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getDepth=function(){return this._depth},a.prototype.getCollapsedEdge=function(){var h=new Array(2).fill(null);return h[0]=this.pts[0],h[1]=this.pts[1],new a(h,ri.toLineLabel(this._label))},a.prototype.isIsolated=function(){return this._isIsolated},a.prototype.getCoordinates=function(){return this.pts},a.prototype.setIsolated=function(h){this._isIsolated=h},a.prototype.setName=function(h){this._name=h},a.prototype.equals=function(h){if(!(h instanceof a))return!1;var d=h;if(this.pts.length!==d.pts.length)return!1;for(var w=!0,O=!0,k=this.pts.length,W=0;W<this.pts.length;W++)if(this.pts[W].equals2D(d.pts[W])||(w=!1),this.pts[W].equals2D(d.pts[--k])||(O=!1),!w&&!O)return!1;return!0},a.prototype.getCoordinate=function(){return 0===arguments.length?this.pts.length>0?this.pts[0]:null:1===arguments.length?this.pts[arguments[0]]:void 0},a.prototype.print=function(h){h.print("edge "+this._name+": "),h.print("LINESTRING (");for(var d=0;d<this.pts.length;d++)d>0&&h.print(","),h.print(this.pts[d].x+" "+this.pts[d].y);h.print(")  "+this._label+" "+this._depthDelta)},a.prototype.computeIM=function(h){a.updateIM(this._label,h)},a.prototype.isCollapsed=function(){return!!this._label.isArea()&&3===this.pts.length&&!!this.pts[0].equals(this.pts[2])},a.prototype.isClosed=function(){return this.pts[0].equals(this.pts[this.pts.length-1])},a.prototype.getMaximumSegmentIndex=function(){return this.pts.length-1},a.prototype.getDepthDelta=function(){return this._depthDelta},a.prototype.getNumPoints=function(){return this.pts.length},a.prototype.printReverse=function(h){h.print("edge "+this._name+": ");for(var d=this.pts.length-1;d>=0;d--)h.print(this.pts[d]+" ");h.println("")},a.prototype.getMonotoneChainEdge=function(){return null===this._mce&&(this._mce=new za(this)),this._mce},a.prototype.getEnvelope=function(){if(null===this._env){this._env=new Be;for(var h=0;h<this.pts.length;h++)this._env.expandToInclude(this.pts[h])}return this._env},a.prototype.addIntersection=function(h,d,w,O){var k=new j(h.getIntersection(O)),W=d,mt=h.getEdgeDistance(w,O),Gt=W+1;Gt<this.pts.length&&k.equals2D(this.pts[Gt])&&(W=Gt,mt=0),this.eiList.add(k,W,mt)},a.prototype.toString=function(){var h=new Pt;h.append("edge "+this._name+": "),h.append("LINESTRING (");for(var d=0;d<this.pts.length;d++)d>0&&h.append(","),h.append(this.pts[d].x+" "+this.pts[d].y);return h.append(")  "+this._label+" "+this._depthDelta),h.toString()},a.prototype.isPointwiseEqual=function(h){if(this.pts.length!==h.pts.length)return!1;for(var d=0;d<this.pts.length;d++)if(!this.pts[d].equals2D(h.pts[d]))return!1;return!0},a.prototype.setDepthDelta=function(h){this._depthDelta=h},a.prototype.getEdgeIntersectionList=function(){return this.eiList},a.prototype.addIntersections=function(h,d,w){for(var O=0;O<h.getIntersectionNum();O++)this.addIntersection(h,d,w,O)},a.prototype.interfaces_=function(){return[]},a.prototype.getClass=function(){return a},a.updateIM=function(){if(2!==arguments.length)return n.prototype.updateIM.apply(this,arguments);var h=arguments[0],d=arguments[1];d.setAtLeastIfValid(h.getLocation(0,Qe.ON),h.getLocation(1,Qe.ON),1),h.isArea()&&(d.setAtLeastIfValid(h.getLocation(0,Qe.LEFT),h.getLocation(1,Qe.LEFT),2),d.setAtLeastIfValid(h.getLocation(0,Qe.RIGHT),h.getLocation(1,Qe.RIGHT),2))},a}(Ho),Qo=function(n){this._workingPrecisionModel=null,this._workingNoder=null,this._geomFact=null,this._graph=null,this._edgeList=new _a,this._bufParams=n||null};Qo.prototype.setWorkingPrecisionModel=function(n){this._workingPrecisionModel=n},Qo.prototype.insertUniqueEdge=function(n){var a=this._edgeList.findEqualEdge(n);if(null!==a){var h=a.getLabel(),d=n.getLabel();a.isPointwiseEqual(n)||(d=new ri(n.getLabel())).flip(),h.merge(d);var w=Qo.depthDelta(d),O=a.getDepthDelta()+w;a.setDepthDelta(O)}else this._edgeList.add(n),n.setDepthDelta(Qo.depthDelta(n.getLabel()))},Qo.prototype.buildSubgraphs=function(n,a){for(var h=new Je,d=n.iterator();d.hasNext();){var w=d.next(),O=w.getRightmostCoordinate(),k=new $a(h).getDepth(O);w.computeDepth(k),w.findResultEdges(),h.add(w),a.add(w.getDirectedEdges(),w.getNodes())}},Qo.prototype.createSubgraphs=function(n){for(var a=new Je,h=n.getNodes().iterator();h.hasNext();){var d=h.next();if(!d.isVisited()){var w=new ia;w.create(d),a.add(w)}}return oa.sort(a,oa.reverseOrder()),a},Qo.prototype.createEmptyResultGeometry=function(){return this._geomFact.createPolygon()},Qo.prototype.getNoder=function(n){if(null!==this._workingNoder)return this._workingNoder;var a=new gu,h=new Ee;return h.setPrecisionModel(n),a.setSegmentIntersector(new jo(h)),a},Qo.prototype.buffer=function(n,a){var h=this._workingPrecisionModel;null===h&&(h=n.getPrecisionModel()),this._geomFact=n.getFactory();var d=new Ko(h,this._bufParams),w=new va(n,a,d).getCurves();if(w.size()<=0)return this.createEmptyResultGeometry();this.computeNodedEdges(w,h),this._graph=new hi(new Mc),this._graph.addEdges(this._edgeList.getEdges());var O=this.createSubgraphs(this._graph),k=new io(this._geomFact);this.buildSubgraphs(O,k);var W=k.getPolygons();return W.size()<=0?this.createEmptyResultGeometry():this._geomFact.buildGeometry(W)},Qo.prototype.computeNodedEdges=function(n,a){var h=this.getNoder(a);h.computeNodes(n);for(var d=h.getNodedSubstrings().iterator();d.hasNext();){var w=d.next(),O=w.getCoordinates();if(2!==O.length||!O[0].equals2D(O[1])){var k=w.getData(),W=new es(w.getCoordinates(),new ri(k));this.insertUniqueEdge(W)}}},Qo.prototype.setNoder=function(n){this._workingNoder=n},Qo.prototype.interfaces_=function(){return[]},Qo.prototype.getClass=function(){return Qo},Qo.depthDelta=function(n){var a=n.getLocation(0,Qe.LEFT),h=n.getLocation(0,Qe.RIGHT);return a===at.INTERIOR&&h===at.EXTERIOR?1:a===at.EXTERIOR&&h===at.INTERIOR?-1:0},Qo.convertSegStrings=function(n){for(var a=new en,h=new Je;n.hasNext();){var d=n.next(),w=a.createLineString(d.getCoordinates());h.add(w)}return a.buildGeometry(h)};var js=function(){if(this._noder=null,this._scaleFactor=null,this._offsetX=null,this._offsetY=null,this._isScaled=!1,2===arguments.length){var a=arguments[1];this._noder=arguments[0],this._scaleFactor=a,this._offsetX=0,this._offsetY=0,this._isScaled=!this.isIntegerPrecision()}else if(4===arguments.length){var d=arguments[1],w=arguments[2],O=arguments[3];this._noder=arguments[0],this._scaleFactor=d,this._offsetX=w,this._offsetY=O,this._isScaled=!this.isIntegerPrecision()}};js.prototype.rescale=function(){if(Te(arguments[0],ei))for(var n=arguments[0].iterator();n.hasNext();){var a=n.next();this.rescale(a.getCoordinates())}else if(arguments[0]instanceof Array){for(var h=arguments[0],d=0;d<h.length;d++)h[d].x=h[d].x/this._scaleFactor+this._offsetX,h[d].y=h[d].y/this._scaleFactor+this._offsetY;2===h.length&&h[0].equals2D(h[1])&&Cr.out.println(h)}},js.prototype.scale=function(){if(Te(arguments[0],ei)){for(var n=arguments[0],a=new Je,h=n.iterator();h.hasNext();){var d=h.next();a.add(new vi(this.scale(d.getCoordinates()),d.getData()))}return a}if(arguments[0]instanceof Array){for(var w=arguments[0],O=new Array(w.length).fill(null),k=0;k<w.length;k++)O[k]=new j(Math.round((w[k].x-this._offsetX)*this._scaleFactor),Math.round((w[k].y-this._offsetY)*this._scaleFactor),w[k].z);return Y.removeRepeatedPoints(O)}},js.prototype.isIntegerPrecision=function(){return 1===this._scaleFactor},js.prototype.getNodedSubstrings=function(){var n=this._noder.getNodedSubstrings();return this._isScaled&&this.rescale(n),n},js.prototype.computeNodes=function(n){var a=n;this._isScaled&&(a=this.scale(n)),this._noder.computeNodes(a)},js.prototype.interfaces_=function(){return[iu]},js.prototype.getClass=function(){return js};var ka=function(){this._li=new Ee,this._segStrings=null,this._segStrings=arguments[0]},yu={fact:{configurable:!0}};ka.prototype.checkEndPtVertexIntersections=function(){if(0===arguments.length)for(var n=this._segStrings.iterator();n.hasNext();){var a=n.next().getCoordinates();this.checkEndPtVertexIntersections(a[0],this._segStrings),this.checkEndPtVertexIntersections(a[a.length-1],this._segStrings)}else if(2===arguments.length)for(var h=arguments[0],d=arguments[1].iterator();d.hasNext();)for(var w=d.next().getCoordinates(),O=1;O<w.length-1;O++)if(w[O].equals(h))throw new st("found endpt/interior pt intersection at index "+O+" :pt "+h)},ka.prototype.checkInteriorIntersections=function(){if(0===arguments.length)for(var n=this._segStrings.iterator();n.hasNext();)for(var a=n.next(),h=this._segStrings.iterator();h.hasNext();){var d=h.next();this.checkInteriorIntersections(a,d)}else if(2===arguments.length)for(var w=arguments[0],O=arguments[1],k=w.getCoordinates(),W=O.getCoordinates(),mt=0;mt<k.length-1;mt++)for(var Gt=0;Gt<W.length-1;Gt++)this.checkInteriorIntersections(w,mt,O,Gt);else if(4===arguments.length){var Ie=arguments[0],Me=arguments[1],Ke=arguments[2],gr=arguments[3];if(Ie===Ke&&Me===gr)return null;var Or=Ie.getCoordinates()[Me],Zr=Ie.getCoordinates()[Me+1],Kn=Ke.getCoordinates()[gr],l=Ke.getCoordinates()[gr+1];if(this._li.computeIntersection(Or,Zr,Kn,l),this._li.hasIntersection()&&(this._li.isProper()||this.hasInteriorIntersection(this._li,Or,Zr)||this.hasInteriorIntersection(this._li,Kn,l)))throw new st("found non-noded intersection at "+Or+"-"+Zr+" and "+Kn+"-"+l)}},ka.prototype.checkValid=function(){this.checkEndPtVertexIntersections(),this.checkInteriorIntersections(),this.checkCollapses()},ka.prototype.checkCollapses=function(){if(0===arguments.length)for(var n=this._segStrings.iterator();n.hasNext();){var a=n.next();this.checkCollapses(a)}else if(1===arguments.length)for(var h=arguments[0].getCoordinates(),d=0;d<h.length-2;d++)this.checkCollapse(h[d],h[d+1],h[d+2])},ka.prototype.hasInteriorIntersection=function(n,a,h){for(var d=0;d<n.getIntersectionNum();d++){var w=n.getIntersection(d);if(!w.equals(a)&&!w.equals(h))return!0}return!1},ka.prototype.checkCollapse=function(n,a,h){if(n.equals(h))throw new st("found non-noded collapse at "+ka.fact.createLineString([n,a,h]))},ka.prototype.interfaces_=function(){return[]},ka.prototype.getClass=function(){return ka},yu.fact.get=function(){return new en},Object.defineProperties(ka,yu);var Do=function(){this._li=null,this._pt=null,this._originalPt=null,this._ptScaled=null,this._p0Scaled=null,this._p1Scaled=null,this._scaleFactor=null,this._minx=null,this._maxx=null,this._miny=null,this._maxy=null,this._corner=new Array(4).fill(null),this._safeEnv=null;var n=arguments[0],a=arguments[1],h=arguments[2];if(this._originalPt=n,this._pt=n,this._scaleFactor=a,this._li=h,a<=0)throw new J("Scale factor must be non-zero");1!==a&&(this._pt=new j(this.scale(n.x),this.scale(n.y)),this._p0Scaled=new j,this._p1Scaled=new j),this.initCorners(this._pt)},Mu={SAFE_ENV_EXPANSION_FACTOR:{configurable:!0}};Do.prototype.intersectsScaled=function(n,a){var h=Math.min(n.x,a.x),d=Math.max(n.x,a.x),w=Math.min(n.y,a.y),O=Math.max(n.y,a.y),k=this._maxx<h||this._minx>d||this._maxy<w||this._miny>O;if(k)return!1;var W=this.intersectsToleranceSquare(n,a);return $.isTrue(!(k&&W),"Found bad envelope test"),W},Do.prototype.initCorners=function(n){this._minx=n.x-.5,this._maxx=n.x+.5,this._miny=n.y-.5,this._maxy=n.y+.5,this._corner[0]=new j(this._maxx,this._maxy),this._corner[1]=new j(this._minx,this._maxy),this._corner[2]=new j(this._minx,this._miny),this._corner[3]=new j(this._maxx,this._miny)},Do.prototype.intersects=function(n,a){return 1===this._scaleFactor?this.intersectsScaled(n,a):(this.copyScaled(n,this._p0Scaled),this.copyScaled(a,this._p1Scaled),this.intersectsScaled(this._p0Scaled,this._p1Scaled))},Do.prototype.scale=function(n){return Math.round(n*this._scaleFactor)},Do.prototype.getCoordinate=function(){return this._originalPt},Do.prototype.copyScaled=function(n,a){a.x=this.scale(n.x),a.y=this.scale(n.y)},Do.prototype.getSafeEnvelope=function(){if(null===this._safeEnv){var n=Do.SAFE_ENV_EXPANSION_FACTOR/this._scaleFactor;this._safeEnv=new Be(this._originalPt.x-n,this._originalPt.x+n,this._originalPt.y-n,this._originalPt.y+n)}return this._safeEnv},Do.prototype.intersectsPixelClosure=function(n,a){return this._li.computeIntersection(n,a,this._corner[0],this._corner[1]),!!(this._li.hasIntersection()||(this._li.computeIntersection(n,a,this._corner[1],this._corner[2]),this._li.hasIntersection()||(this._li.computeIntersection(n,a,this._corner[2],this._corner[3]),this._li.hasIntersection()||(this._li.computeIntersection(n,a,this._corner[3],this._corner[0]),this._li.hasIntersection()))))},Do.prototype.intersectsToleranceSquare=function(n,a){var h=!1,d=!1;return this._li.computeIntersection(n,a,this._corner[0],this._corner[1]),!!(this._li.isProper()||(this._li.computeIntersection(n,a,this._corner[1],this._corner[2]),this._li.isProper()||(this._li.hasIntersection()&&(h=!0),this._li.computeIntersection(n,a,this._corner[2],this._corner[3]),this._li.isProper()||(this._li.hasIntersection()&&(d=!0),this._li.computeIntersection(n,a,this._corner[3],this._corner[0]),this._li.isProper()||h&&d||n.equals(this._pt)||a.equals(this._pt)))))},Do.prototype.addSnappedNode=function(n,a){var h=n.getCoordinate(a),d=n.getCoordinate(a+1);return!!this.intersects(h,d)&&(n.addIntersection(this.getCoordinate(),a),!0)},Do.prototype.interfaces_=function(){return[]},Do.prototype.getClass=function(){return Do},Mu.SAFE_ENV_EXPANSION_FACTOR.get=function(){return.75},Object.defineProperties(Do,Mu);var Tu=function(){this.tempEnv1=new Be,this.selectedSegment=new Fr};Tu.prototype.select=function(){1!==arguments.length&&2===arguments.length&&(arguments[0].getLineSegment(arguments[1],this.selectedSegment),this.select(this.selectedSegment))},Tu.prototype.interfaces_=function(){return[]},Tu.prototype.getClass=function(){return Tu};var Es=function(){this._index=null,this._index=arguments[0]},Tc={HotPixelSnapAction:{configurable:!0}};Es.prototype.snap=function(){if(1===arguments.length)return this.snap(arguments[0],null,-1);if(3===arguments.length){var a=arguments[0],h=arguments[1],d=arguments[2],w=a.getSafeEnvelope(),O=new Qu(a,h,d);return this._index.query(w,{interfaces_:function(){return[xs]},visitItem:function(k){k.select(w,O)}}),O.isNodeAdded()}},Es.prototype.interfaces_=function(){return[]},Es.prototype.getClass=function(){return Es},Tc.HotPixelSnapAction.get=function(){return Qu},Object.defineProperties(Es,Tc);var Qu=function(n){function a(){n.call(this),this._hotPixel=null,this._parentEdge=null,this._hotPixelVertexIndex=null,this._isNodeAdded=!1;var d=arguments[1],w=arguments[2];this._hotPixel=arguments[0],this._parentEdge=d,this._hotPixelVertexIndex=w}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.isNodeAdded=function(){return this._isNodeAdded},a.prototype.select=function(){if(2!==arguments.length)return n.prototype.select.apply(this,arguments);var d=arguments[1],w=arguments[0].getContext();if(null!==this._parentEdge&&w===this._parentEdge&&d===this._hotPixelVertexIndex)return null;this._isNodeAdded=this._hotPixel.addSnappedNode(w,d)},a.prototype.interfaces_=function(){return[]},a.prototype.getClass=function(){return a},a}(Tu),Xs=function(){this._li=null,this._interiorIntersections=null,this._li=arguments[0],this._interiorIntersections=new Je};Xs.prototype.processIntersections=function(n,a,h,d){if(n===h&&a===d)return null;var w=n.getCoordinates()[a],O=n.getCoordinates()[a+1],k=h.getCoordinates()[d],W=h.getCoordinates()[d+1];if(this._li.computeIntersection(w,O,k,W),this._li.hasIntersection()&&this._li.isInteriorIntersection()){for(var mt=0;mt<this._li.getIntersectionNum();mt++)this._interiorIntersections.add(this._li.getIntersection(mt));n.addIntersections(this._li,a,0),h.addIntersections(this._li,d,1)}},Xs.prototype.isDone=function(){return!1},Xs.prototype.getInteriorIntersections=function(){return this._interiorIntersections},Xs.prototype.interfaces_=function(){return[au]},Xs.prototype.getClass=function(){return Xs};var Cs=function(){this._pm=null,this._li=null,this._scaleFactor=null,this._noder=null,this._pointSnapper=null,this._nodedSegStrings=null;var n=arguments[0];this._pm=n,this._li=new Ee,this._li.setPrecisionModel(n),this._scaleFactor=n.getScale()};Cs.prototype.checkCorrectness=function(n){var a=vi.getNodedSubstrings(n),h=new ka(a);try{h.checkValid()}catch(d){if(!(d instanceof Er))throw d;d.printStackTrace()}},Cs.prototype.getNodedSubstrings=function(){return vi.getNodedSubstrings(this._nodedSegStrings)},Cs.prototype.snapRound=function(n,a){var h=this.findInteriorIntersections(n,a);this.computeIntersectionSnaps(h),this.computeVertexSnaps(n)},Cs.prototype.findInteriorIntersections=function(n,a){var h=new Xs(a);return this._noder.setSegmentIntersector(h),this._noder.computeNodes(n),h.getInteriorIntersections()},Cs.prototype.computeVertexSnaps=function(){if(Te(arguments[0],ei))for(var n=arguments[0].iterator();n.hasNext();){var a=n.next();this.computeVertexSnaps(a)}else if(arguments[0]instanceof vi)for(var h=arguments[0],d=h.getCoordinates(),w=0;w<d.length;w++){var O=new Do(d[w],this._scaleFactor,this._li);this._pointSnapper.snap(O,h,w)&&h.addIntersection(d[w],w)}},Cs.prototype.computeNodes=function(n){this._nodedSegStrings=n,this._noder=new gu,this._pointSnapper=new Es(this._noder.getIndex()),this.snapRound(n,this._li)},Cs.prototype.computeIntersectionSnaps=function(n){for(var a=n.iterator();a.hasNext();){var h=a.next(),d=new Do(h,this._scaleFactor,this._li);this._pointSnapper.snap(d)}},Cs.prototype.interfaces_=function(){return[iu]},Cs.prototype.getClass=function(){return Cs};var Ro=function(){if(this._argGeom=null,this._distance=null,this._bufParams=new Hn,this._resultGeometry=null,this._saveException=null,1===arguments.length)this._argGeom=arguments[0];else if(2===arguments.length){var h=arguments[1];this._argGeom=arguments[0],this._bufParams=h}},su={CAP_ROUND:{configurable:!0},CAP_BUTT:{configurable:!0},CAP_FLAT:{configurable:!0},CAP_SQUARE:{configurable:!0},MAX_PRECISION_DIGITS:{configurable:!0}};Ro.prototype.bufferFixedPrecision=function(n){var a=new js(new Cs(new En(1)),n.getScale()),h=new Qo(this._bufParams);h.setWorkingPrecisionModel(n),h.setNoder(a),this._resultGeometry=h.buffer(this._argGeom,this._distance)},Ro.prototype.bufferReducedPrecision=function(){var n=this;if(0===arguments.length){for(var a=Ro.MAX_PRECISION_DIGITS;a>=0;a--){try{n.bufferReducedPrecision(a)}catch(O){if(!(O instanceof Ja))throw O;n._saveException=O}if(null!==n._resultGeometry)return null}throw this._saveException}if(1===arguments.length){var d=Ro.precisionScaleFactor(this._argGeom,this._distance,arguments[0]),w=new En(d);this.bufferFixedPrecision(w)}},Ro.prototype.computeGeometry=function(){if(this.bufferOriginalPrecision(),null!==this._resultGeometry)return null;var n=this._argGeom.getFactory().getPrecisionModel();n.getType()===En.FIXED?this.bufferFixedPrecision(n):this.bufferReducedPrecision()},Ro.prototype.setQuadrantSegments=function(n){this._bufParams.setQuadrantSegments(n)},Ro.prototype.bufferOriginalPrecision=function(){try{var n=new Qo(this._bufParams);this._resultGeometry=n.buffer(this._argGeom,this._distance)}catch(a){if(!(a instanceof st))throw a;this._saveException=a}},Ro.prototype.getResultGeometry=function(n){return this._distance=n,this.computeGeometry(),this._resultGeometry},Ro.prototype.setEndCapStyle=function(n){this._bufParams.setEndCapStyle(n)},Ro.prototype.interfaces_=function(){return[]},Ro.prototype.getClass=function(){return Ro},Ro.bufferOp=function(){if(2===arguments.length){var a=arguments[1];return new Ro(arguments[0]).getResultGeometry(a)}if(3===arguments.length){if(Number.isInteger(arguments[2])&&arguments[0]instanceof sr&&"number"==typeof arguments[1]){var d=arguments[1],w=arguments[2],O=new Ro(arguments[0]);return O.setQuadrantSegments(w),O.getResultGeometry(d)}if(arguments[2]instanceof Hn&&arguments[0]instanceof sr&&"number"==typeof arguments[1]){var W=arguments[1];return new Ro(arguments[0],arguments[2]).getResultGeometry(W)}}else if(4===arguments.length){var Ie=arguments[1],Me=arguments[2],Ke=arguments[3],gr=new Ro(arguments[0]);return gr.setQuadrantSegments(Me),gr.setEndCapStyle(Ke),gr.getResultGeometry(Ie)}},Ro.precisionScaleFactor=function(n,a,h){var d=n.getEnvelopeInternal(),w=Et.max(Math.abs(d.getMaxX()),Math.abs(d.getMaxY()),Math.abs(d.getMinX()),Math.abs(d.getMinY()))+2*(a>0?a:0),O=h-Math.trunc(Math.log(w)/Math.log(10)+1);return Math.pow(10,O)},su.CAP_ROUND.get=function(){return Hn.CAP_ROUND},su.CAP_BUTT.get=function(){return Hn.CAP_FLAT},su.CAP_FLAT.get=function(){return Hn.CAP_FLAT},su.CAP_SQUARE.get=function(){return Hn.CAP_SQUARE},su.MAX_PRECISION_DIGITS.get=function(){return 12},Object.defineProperties(Ro,su);var No=function(){this._pt=[new j,new j],this._distance=Q.NaN,this._isNull=!0};No.prototype.getCoordinates=function(){return this._pt},No.prototype.getCoordinate=function(n){return this._pt[n]},No.prototype.setMinimum=function(){if(1===arguments.length){var n=arguments[0];this.setMinimum(n._pt[0],n._pt[1])}else if(2===arguments.length){var a=arguments[0],h=arguments[1];if(this._isNull)return this.initialize(a,h),null;var d=a.distance(h);d<this._distance&&this.initialize(a,h,d)}},No.prototype.initialize=function(){if(0===arguments.length)this._isNull=!0;else if(2===arguments.length){var n=arguments[0],a=arguments[1];this._pt[0].setCoordinate(n),this._pt[1].setCoordinate(a),this._distance=n.distance(a),this._isNull=!1}else if(3===arguments.length){var d=arguments[1],w=arguments[2];this._pt[0].setCoordinate(arguments[0]),this._pt[1].setCoordinate(d),this._distance=w,this._isNull=!1}},No.prototype.getDistance=function(){return this._distance},No.prototype.setMaximum=function(){if(1===arguments.length){var n=arguments[0];this.setMaximum(n._pt[0],n._pt[1])}else if(2===arguments.length){var a=arguments[0],h=arguments[1];if(this._isNull)return this.initialize(a,h),null;var d=a.distance(h);d>this._distance&&this.initialize(a,h,d)}},No.prototype.interfaces_=function(){return[]},No.prototype.getClass=function(){return No};var rs=function(){};rs.prototype.interfaces_=function(){return[]},rs.prototype.getClass=function(){return rs},rs.computeDistance=function(){if(arguments[2]instanceof No&&arguments[0]instanceof ir&&arguments[1]instanceof j)for(var a=arguments[1],h=arguments[2],d=arguments[0].getCoordinates(),w=new Fr,O=0;O<d.length-1;O++){w.setCoordinates(d[O],d[O+1]);var k=w.closestPoint(a);h.setMinimum(k,a)}else if(arguments[2]instanceof No&&arguments[0]instanceof cn&&arguments[1]instanceof j){var W=arguments[0],mt=arguments[1],Gt=arguments[2];rs.computeDistance(W.getExteriorRing(),mt,Gt);for(var Ie=0;Ie<W.getNumInteriorRing();Ie++)rs.computeDistance(W.getInteriorRingN(Ie),mt,Gt)}else if(arguments[2]instanceof No&&arguments[0]instanceof sr&&arguments[1]instanceof j){var Me=arguments[0],Ke=arguments[1],gr=arguments[2];if(Me instanceof ir)rs.computeDistance(Me,Ke,gr);else if(Me instanceof cn)rs.computeDistance(Me,Ke,gr);else if(Me instanceof Re)for(var Or=Me,Zr=0;Zr<Or.getNumGeometries();Zr++){var Kn=Or.getGeometryN(Zr);rs.computeDistance(Kn,Ke,gr)}else gr.setMinimum(Me.getCoordinate(),Ke)}else if(arguments[2]instanceof No&&arguments[0]instanceof Fr&&arguments[1]instanceof j){var p=arguments[1],c=arguments[2],y=arguments[0].closestPoint(p);c.setMinimum(y,p)}};var Ss=function(n){this._maxPtDist=new No,this._inputGeom=n||null},$u={MaxPointDistanceFilter:{configurable:!0},MaxMidpointDistanceFilter:{configurable:!0}};Ss.prototype.computeMaxMidpointDistance=function(n){var a=new Yn(this._inputGeom);n.apply(a),this._maxPtDist.setMaximum(a.getMaxPointDistance())},Ss.prototype.computeMaxVertexDistance=function(n){var a=new Fs(this._inputGeom);n.apply(a),this._maxPtDist.setMaximum(a.getMaxPointDistance())},Ss.prototype.findDistance=function(n){return this.computeMaxVertexDistance(n),this.computeMaxMidpointDistance(n),this._maxPtDist.getDistance()},Ss.prototype.getDistancePoints=function(){return this._maxPtDist},Ss.prototype.interfaces_=function(){return[]},Ss.prototype.getClass=function(){return Ss},$u.MaxPointDistanceFilter.get=function(){return Fs},$u.MaxMidpointDistanceFilter.get=function(){return Yn},Object.defineProperties(Ss,$u);var Fs=function(n){this._maxPtDist=new No,this._minPtDist=new No,this._geom=n||null};Fs.prototype.filter=function(n){this._minPtDist.initialize(),rs.computeDistance(this._geom,n,this._minPtDist),this._maxPtDist.setMaximum(this._minPtDist)},Fs.prototype.getMaxPointDistance=function(){return this._maxPtDist},Fs.prototype.interfaces_=function(){return[Dn]},Fs.prototype.getClass=function(){return Fs};var Yn=function(n){this._maxPtDist=new No,this._minPtDist=new No,this._geom=n||null};Yn.prototype.filter=function(n,a){if(0===a)return null;var h=n.getCoordinate(a-1),d=n.getCoordinate(a),w=new j((h.x+d.x)/2,(h.y+d.y)/2);this._minPtDist.initialize(),rs.computeDistance(this._geom,w,this._minPtDist),this._maxPtDist.setMaximum(this._minPtDist)},Yn.prototype.isDone=function(){return!1},Yn.prototype.isGeometryChanged=function(){return!1},Yn.prototype.getMaxPointDistance=function(){return this._maxPtDist},Yn.prototype.interfaces_=function(){return[Tr]},Yn.prototype.getClass=function(){return Yn};var Fa=function(n){this._comps=n||null};Fa.prototype.filter=function(n){n instanceof cn&&this._comps.add(n)},Fa.prototype.interfaces_=function(){return[pr]},Fa.prototype.getClass=function(){return Fa},Fa.getPolygons=function(){if(1===arguments.length)return Fa.getPolygons(arguments[0],new Je);if(2===arguments.length){var a=arguments[0],h=arguments[1];return a instanceof cn?h.add(a):a instanceof Re&&a.apply(new Fa(h)),h}};var Hi=function(){if(this._lines=null,this._isForcedToLineString=!1,1===arguments.length)this._lines=arguments[0];else if(2===arguments.length){var h=arguments[1];this._lines=arguments[0],this._isForcedToLineString=h}};Hi.prototype.filter=function(n){if(this._isForcedToLineString&&n instanceof Un){var a=n.getFactory().createLineString(n.getCoordinateSequence());return this._lines.add(a),null}n instanceof ir&&this._lines.add(n)},Hi.prototype.setForceToLineString=function(n){this._isForcedToLineString=n},Hi.prototype.interfaces_=function(){return[gn]},Hi.prototype.getClass=function(){return Hi},Hi.getGeometry=function(){if(1===arguments.length){var n=arguments[0];return n.getFactory().buildGeometry(Hi.getLines(n))}if(2===arguments.length){var a=arguments[0],h=arguments[1];return a.getFactory().buildGeometry(Hi.getLines(a,h))}},Hi.getLines=function(){if(1===arguments.length)return Hi.getLines(arguments[0],!1);if(2===arguments.length){if(Te(arguments[0],ei)&&Te(arguments[1],ei)){for(var h=arguments[1],d=arguments[0].iterator();d.hasNext();){var w=d.next();Hi.getLines(w,h)}return h}if(arguments[0]instanceof sr&&"boolean"==typeof arguments[1]){var O=arguments[0],k=arguments[1],W=new Je;return O.apply(new Hi(W,k)),W}if(arguments[0]instanceof sr&&Te(arguments[1],ei)){var mt=arguments[0],Gt=arguments[1];return mt instanceof ir?Gt.add(mt):mt.apply(new Hi(Gt)),Gt}}else if(3===arguments.length){if("boolean"==typeof arguments[2]&&Te(arguments[0],ei)&&Te(arguments[1],ei)){for(var Me=arguments[1],Ke=arguments[2],gr=arguments[0].iterator();gr.hasNext();){var Or=gr.next();Hi.getLines(Or,Me,Ke)}return Me}if("boolean"==typeof arguments[2]&&arguments[0]instanceof sr&&Te(arguments[1],ei)){var Kn=arguments[1];return arguments[0].apply(new Hi(Kn,arguments[2])),Kn}}};var zo=function(){if(this._boundaryRule=Rn.OGC_SFS_BOUNDARY_RULE,this._isIn=null,this._numBoundaries=null,0!==arguments.length&&1===arguments.length){var n=arguments[0];if(null===n)throw new J("Rule must be non-null");this._boundaryRule=n}};zo.prototype.locateInternal=function(){if(arguments[0]instanceof j&&arguments[1]instanceof cn){var n=arguments[0],a=arguments[1];if(a.isEmpty())return at.EXTERIOR;var h=a.getExteriorRing(),d=this.locateInPolygonRing(n,h);if(d===at.EXTERIOR)return at.EXTERIOR;if(d===at.BOUNDARY)return at.BOUNDARY;for(var w=0;w<a.getNumInteriorRing();w++){var O=a.getInteriorRingN(w),k=this.locateInPolygonRing(n,O);if(k===at.INTERIOR)return at.EXTERIOR;if(k===at.BOUNDARY)return at.BOUNDARY}return at.INTERIOR}if(arguments[0]instanceof j&&arguments[1]instanceof ir){var W=arguments[0],mt=arguments[1];if(!mt.getEnvelopeInternal().intersects(W))return at.EXTERIOR;var Gt=mt.getCoordinates();return mt.isClosed()||!W.equals(Gt[0])&&!W.equals(Gt[Gt.length-1])?Le.isOnLine(W,Gt)?at.INTERIOR:at.EXTERIOR:at.BOUNDARY}if(arguments[0]instanceof j&&arguments[1]instanceof On){var Ie=arguments[0];return arguments[1].getCoordinate().equals2D(Ie)?at.INTERIOR:at.EXTERIOR}},zo.prototype.locateInPolygonRing=function(n,a){return a.getEnvelopeInternal().intersects(n)?Le.locatePointInRing(n,a.getCoordinates()):at.EXTERIOR},zo.prototype.intersects=function(n,a){return this.locate(n,a)!==at.EXTERIOR},zo.prototype.updateLocationInfo=function(n){n===at.INTERIOR&&(this._isIn=!0),n===at.BOUNDARY&&this._numBoundaries++},zo.prototype.computeLocation=function(n,a){if(a instanceof On&&this.updateLocationInfo(this.locateInternal(n,a)),a instanceof ir)this.updateLocationInfo(this.locateInternal(n,a));else if(a instanceof cn)this.updateLocationInfo(this.locateInternal(n,a));else if(a instanceof nr)for(var h=a,d=0;d<h.getNumGeometries();d++){var w=h.getGeometryN(d);this.updateLocationInfo(this.locateInternal(n,w))}else if(a instanceof on)for(var O=a,k=0;k<O.getNumGeometries();k++){var W=O.getGeometryN(k);this.updateLocationInfo(this.locateInternal(n,W))}else if(a instanceof Re)for(var mt=new Xn(a);mt.hasNext();){var Gt=mt.next();Gt!==a&&this.computeLocation(n,Gt)}},zo.prototype.locate=function(n,a){return a.isEmpty()?at.EXTERIOR:a instanceof ir||a instanceof cn?this.locateInternal(n,a):(this._isIn=!1,this._numBoundaries=0,this.computeLocation(n,a),this._boundaryRule.isInBoundary(this._numBoundaries)?at.BOUNDARY:this._numBoundaries>0||this._isIn?at.INTERIOR:at.EXTERIOR)},zo.prototype.interfaces_=function(){return[]},zo.prototype.getClass=function(){return zo};var _n=function n(){if(this._component=null,this._segIndex=null,this._pt=null,2===arguments.length)n.call(this,arguments[0],n.INSIDE_AREA,arguments[1]);else if(3===arguments.length){var w=arguments[1],O=arguments[2];this._component=arguments[0],this._segIndex=w,this._pt=O}},zn={INSIDE_AREA:{configurable:!0}};_n.prototype.isInsideArea=function(){return this._segIndex===_n.INSIDE_AREA},_n.prototype.getCoordinate=function(){return this._pt},_n.prototype.getGeometryComponent=function(){return this._component},_n.prototype.getSegmentIndex=function(){return this._segIndex},_n.prototype.interfaces_=function(){return[]},_n.prototype.getClass=function(){return _n},zn.INSIDE_AREA.get=function(){return-1},Object.defineProperties(_n,zn);var sa=function(n){this._pts=n||null};sa.prototype.filter=function(n){n instanceof On&&this._pts.add(n)},sa.prototype.interfaces_=function(){return[pr]},sa.prototype.getClass=function(){return sa},sa.getPoints=function(){if(1===arguments.length){var n=arguments[0];return n instanceof On?oa.singletonList(n):sa.getPoints(n,new Je)}if(2===arguments.length){var a=arguments[0],h=arguments[1];return a instanceof On?h.add(a):a instanceof Re&&a.apply(new sa(h)),h}};var Ma=function(){this._locations=null,this._locations=arguments[0]};Ma.prototype.filter=function(n){(n instanceof On||n instanceof ir||n instanceof cn)&&this._locations.add(new _n(n,0,n.getCoordinate()))},Ma.prototype.interfaces_=function(){return[pr]},Ma.prototype.getClass=function(){return Ma},Ma.getLocations=function(n){var a=new Je;return n.apply(new Ma(a)),a};var ko=function(){if(this._geom=null,this._terminateDistance=0,this._ptLocator=new zo,this._minDistanceLocation=null,this._minDistance=Q.MAX_VALUE,2===arguments.length)this._geom=[arguments[0],arguments[1]],this._terminateDistance=0;else if(3===arguments.length){var h=arguments[0],d=arguments[1],w=arguments[2];this._geom=new Array(2).fill(null),this._geom[0]=h,this._geom[1]=d,this._terminateDistance=w}};ko.prototype.computeContainmentDistance=function(){if(0===arguments.length){var n=new Array(2).fill(null);if(this.computeContainmentDistance(0,n),this._minDistance<=this._terminateDistance)return null;this.computeContainmentDistance(1,n)}else if(2===arguments.length){var a=arguments[0],h=arguments[1],d=1-a,w=Fa.getPolygons(this._geom[a]);if(w.size()>0){var O=Ma.getLocations(this._geom[d]);if(this.computeContainmentDistance(O,w,h),this._minDistance<=this._terminateDistance)return this._minDistanceLocation[d]=h[0],this._minDistanceLocation[a]=h[1],null}}else if(3===arguments.length)if(arguments[2]instanceof Array&&Te(arguments[0],ki)&&Te(arguments[1],ki)){for(var k=arguments[0],W=arguments[1],mt=arguments[2],Gt=0;Gt<k.size();Gt++)for(var Ie=k.get(Gt),Me=0;Me<W.size();Me++)if(this.computeContainmentDistance(Ie,W.get(Me),mt),this._minDistance<=this._terminateDistance)return null}else if(arguments[2]instanceof Array&&arguments[0]instanceof _n&&arguments[1]instanceof cn){var Ke=arguments[0],gr=arguments[1],Or=arguments[2],Zr=Ke.getCoordinate();if(at.EXTERIOR!==this._ptLocator.locate(Zr,gr))return this._minDistance=0,Or[0]=Ke,Or[1]=new _n(gr,Zr),null}},ko.prototype.computeMinDistanceLinesPoints=function(n,a,h){for(var d=0;d<n.size();d++)for(var w=n.get(d),O=0;O<a.size();O++){var k=a.get(O);if(this.computeMinDistance(w,k,h),this._minDistance<=this._terminateDistance)return null}},ko.prototype.computeFacetDistance=function(){var n=new Array(2).fill(null),a=Hi.getLines(this._geom[0]),h=Hi.getLines(this._geom[1]),d=sa.getPoints(this._geom[0]),w=sa.getPoints(this._geom[1]);return this.computeMinDistanceLines(a,h,n),this.updateMinDistance(n,!1),this._minDistance<=this._terminateDistance?null:(n[0]=null,n[1]=null,this.computeMinDistanceLinesPoints(a,w,n),this.updateMinDistance(n,!1),this._minDistance<=this._terminateDistance?null:(n[0]=null,n[1]=null,this.computeMinDistanceLinesPoints(h,d,n),this.updateMinDistance(n,!0),this._minDistance<=this._terminateDistance?null:(n[0]=null,n[1]=null,this.computeMinDistancePoints(d,w,n),void this.updateMinDistance(n,!1))))},ko.prototype.nearestLocations=function(){return this.computeMinDistance(),this._minDistanceLocation},ko.prototype.updateMinDistance=function(n,a){if(null===n[0])return null;a?(this._minDistanceLocation[0]=n[1],this._minDistanceLocation[1]=n[0]):(this._minDistanceLocation[0]=n[0],this._minDistanceLocation[1]=n[1])},ko.prototype.nearestPoints=function(){return this.computeMinDistance(),[this._minDistanceLocation[0].getCoordinate(),this._minDistanceLocation[1].getCoordinate()]},ko.prototype.computeMinDistance=function(){if(0===arguments.length){if(null!==this._minDistanceLocation||(this._minDistanceLocation=new Array(2).fill(null),this.computeContainmentDistance(),this._minDistance<=this._terminateDistance))return null;this.computeFacetDistance()}else if(3===arguments.length)if(arguments[2]instanceof Array&&arguments[0]instanceof ir&&arguments[1]instanceof On){var n=arguments[0],a=arguments[1],h=arguments[2];if(n.getEnvelopeInternal().distance(a.getEnvelopeInternal())>this._minDistance)return null;for(var d=n.getCoordinates(),w=a.getCoordinate(),O=0;O<d.length-1;O++){var k=Le.distancePointLine(w,d[O],d[O+1]);if(k<this._minDistance){this._minDistance=k;var W=new Fr(d[O],d[O+1]).closestPoint(w);h[0]=new _n(n,O,W),h[1]=new _n(a,0,w)}if(this._minDistance<=this._terminateDistance)return null}}else if(arguments[2]instanceof Array&&arguments[0]instanceof ir&&arguments[1]instanceof ir){var mt=arguments[0],Gt=arguments[1],Ie=arguments[2];if(mt.getEnvelopeInternal().distance(Gt.getEnvelopeInternal())>this._minDistance)return null;for(var Me=mt.getCoordinates(),Ke=Gt.getCoordinates(),gr=0;gr<Me.length-1;gr++)for(var Or=0;Or<Ke.length-1;Or++){var Zr=Le.distanceLineLine(Me[gr],Me[gr+1],Ke[Or],Ke[Or+1]);if(Zr<this._minDistance){this._minDistance=Zr;var Kn=new Fr(Me[gr],Me[gr+1]),l=new Fr(Ke[Or],Ke[Or+1]),p=Kn.closestPoints(l);Ie[0]=new _n(mt,gr,p[0]),Ie[1]=new _n(Gt,Or,p[1])}if(this._minDistance<=this._terminateDistance)return null}}},ko.prototype.computeMinDistancePoints=function(n,a,h){for(var d=0;d<n.size();d++)for(var w=n.get(d),O=0;O<a.size();O++){var k=a.get(O),W=w.getCoordinate().distance(k.getCoordinate());if(W<this._minDistance&&(this._minDistance=W,h[0]=new _n(w,0,w.getCoordinate()),h[1]=new _n(k,0,k.getCoordinate())),this._minDistance<=this._terminateDistance)return null}},ko.prototype.distance=function(){if(null===this._geom[0]||null===this._geom[1])throw new J("null geometries are not supported");return this._geom[0].isEmpty()||this._geom[1].isEmpty()?0:(this.computeMinDistance(),this._minDistance)},ko.prototype.computeMinDistanceLines=function(n,a,h){for(var d=0;d<n.size();d++)for(var w=n.get(d),O=0;O<a.size();O++){var k=a.get(O);if(this.computeMinDistance(w,k,h),this._minDistance<=this._terminateDistance)return null}},ko.prototype.interfaces_=function(){return[]},ko.prototype.getClass=function(){return ko},ko.distance=function(n,a){return new ko(n,a).distance()},ko.isWithinDistance=function(n,a,h){return new ko(n,a,h).distance()<=h},ko.nearestPoints=function(n,a){return new ko(n,a).nearestPoints()};var oo=function(){this._pt=[new j,new j],this._distance=Q.NaN,this._isNull=!0};oo.prototype.getCoordinates=function(){return this._pt},oo.prototype.getCoordinate=function(n){return this._pt[n]},oo.prototype.setMinimum=function(){if(1===arguments.length){var n=arguments[0];this.setMinimum(n._pt[0],n._pt[1])}else if(2===arguments.length){var a=arguments[0],h=arguments[1];if(this._isNull)return this.initialize(a,h),null;var d=a.distance(h);d<this._distance&&this.initialize(a,h,d)}},oo.prototype.initialize=function(){if(0===arguments.length)this._isNull=!0;else if(2===arguments.length){var n=arguments[0],a=arguments[1];this._pt[0].setCoordinate(n),this._pt[1].setCoordinate(a),this._distance=n.distance(a),this._isNull=!1}else if(3===arguments.length){var d=arguments[1],w=arguments[2];this._pt[0].setCoordinate(arguments[0]),this._pt[1].setCoordinate(d),this._distance=w,this._isNull=!1}},oo.prototype.toString=function(){return ae.toLineString(this._pt[0],this._pt[1])},oo.prototype.getDistance=function(){return this._distance},oo.prototype.setMaximum=function(){if(1===arguments.length){var n=arguments[0];this.setMaximum(n._pt[0],n._pt[1])}else if(2===arguments.length){var a=arguments[0],h=arguments[1];if(this._isNull)return this.initialize(a,h),null;var d=a.distance(h);d>this._distance&&this.initialize(a,h,d)}},oo.prototype.interfaces_=function(){return[]},oo.prototype.getClass=function(){return oo};var Ta=function(){};Ta.prototype.interfaces_=function(){return[]},Ta.prototype.getClass=function(){return Ta},Ta.computeDistance=function(){if(arguments[2]instanceof oo&&arguments[0]instanceof ir&&arguments[1]instanceof j)for(var n=arguments[0],a=arguments[1],h=arguments[2],d=new Fr,w=n.getCoordinates(),O=0;O<w.length-1;O++){d.setCoordinates(w[O],w[O+1]);var k=d.closestPoint(a);h.setMinimum(k,a)}else if(arguments[2]instanceof oo&&arguments[0]instanceof cn&&arguments[1]instanceof j){var W=arguments[0],mt=arguments[1],Gt=arguments[2];Ta.computeDistance(W.getExteriorRing(),mt,Gt);for(var Ie=0;Ie<W.getNumInteriorRing();Ie++)Ta.computeDistance(W.getInteriorRingN(Ie),mt,Gt)}else if(arguments[2]instanceof oo&&arguments[0]instanceof sr&&arguments[1]instanceof j){var Me=arguments[0],Ke=arguments[1],gr=arguments[2];if(Me instanceof ir)Ta.computeDistance(Me,Ke,gr);else if(Me instanceof cn)Ta.computeDistance(Me,Ke,gr);else if(Me instanceof Re)for(var Or=Me,Zr=0;Zr<Or.getNumGeometries();Zr++){var Kn=Or.getGeometryN(Zr);Ta.computeDistance(Kn,Ke,gr)}else gr.setMinimum(Me.getCoordinate(),Ke)}else if(arguments[2]instanceof oo&&arguments[0]instanceof Fr&&arguments[1]instanceof j){var p=arguments[1],c=arguments[2],y=arguments[0].closestPoint(p);c.setMinimum(y,p)}};var ns=function(){this._g0=null,this._g1=null,this._ptDist=new oo,this._densifyFrac=0;var a=arguments[1];this._g0=arguments[0],this._g1=a},Au={MaxPointDistanceFilter:{configurable:!0},MaxDensifiedByFractionDistanceFilter:{configurable:!0}};ns.prototype.getCoordinates=function(){return this._ptDist.getCoordinates()},ns.prototype.setDensifyFraction=function(n){if(n>1||n<=0)throw new J("Fraction is not in range (0.0 - 1.0]");this._densifyFrac=n},ns.prototype.compute=function(n,a){this.computeOrientedDistance(n,a,this._ptDist),this.computeOrientedDistance(a,n,this._ptDist)},ns.prototype.distance=function(){return this.compute(this._g0,this._g1),this._ptDist.getDistance()},ns.prototype.computeOrientedDistance=function(n,a,h){var d=new Ys(a);if(n.apply(d),h.setMaximum(d.getMaxPointDistance()),this._densifyFrac>0){var w=new is(a,this._densifyFrac);n.apply(w),h.setMaximum(w.getMaxPointDistance())}},ns.prototype.orientedDistance=function(){return this.computeOrientedDistance(this._g0,this._g1,this._ptDist),this._ptDist.getDistance()},ns.prototype.interfaces_=function(){return[]},ns.prototype.getClass=function(){return ns},ns.distance=function(){if(2===arguments.length)return new ns(arguments[0],arguments[1]).distance();if(3===arguments.length){var w=arguments[2],O=new ns(arguments[0],arguments[1]);return O.setDensifyFraction(w),O.distance()}},Au.MaxPointDistanceFilter.get=function(){return Ys},Au.MaxDensifiedByFractionDistanceFilter.get=function(){return is},Object.defineProperties(ns,Au);var Ys=function(){this._maxPtDist=new oo,this._minPtDist=new oo,this._euclideanDist=new Ta,this._geom=null,this._geom=arguments[0]};Ys.prototype.filter=function(n){this._minPtDist.initialize(),Ta.computeDistance(this._geom,n,this._minPtDist),this._maxPtDist.setMaximum(this._minPtDist)},Ys.prototype.getMaxPointDistance=function(){return this._maxPtDist},Ys.prototype.interfaces_=function(){return[Dn]},Ys.prototype.getClass=function(){return Ys};var is=function(){this._maxPtDist=new oo,this._minPtDist=new oo,this._geom=null,this._numSubSegs=0;var a=arguments[1];this._geom=arguments[0],this._numSubSegs=Math.trunc(Math.round(1/a))};is.prototype.filter=function(n,a){if(0===a)return null;for(var h=n.getCoordinate(a-1),d=n.getCoordinate(a),w=(d.x-h.x)/this._numSubSegs,O=(d.y-h.y)/this._numSubSegs,k=0;k<this._numSubSegs;k++){var Gt=new j(h.x+k*w,h.y+k*O);this._minPtDist.initialize(),Ta.computeDistance(this._geom,Gt,this._minPtDist),this._maxPtDist.setMaximum(this._minPtDist)}},is.prototype.isDone=function(){return!1},is.prototype.isGeometryChanged=function(){return!1},is.prototype.getMaxPointDistance=function(){return this._maxPtDist},is.prototype.interfaces_=function(){return[Tr]},is.prototype.getClass=function(){return is};var _i=function(n,a,h){this._minValidDistance=null,this._maxValidDistance=null,this._minDistanceFound=null,this._maxDistanceFound=null,this._isValid=!0,this._errMsg=null,this._errorLocation=null,this._errorIndicator=null,this._input=n||null,this._bufDistance=a||null,this._result=h||null},Ba={VERBOSE:{configurable:!0},MAX_DISTANCE_DIFF_FRAC:{configurable:!0}};_i.prototype.checkMaximumDistance=function(n,a,h){var d=new ns(a,n);if(d.setDensifyFraction(.25),this._maxDistanceFound=d.orientedDistance(),this._maxDistanceFound>h){this._isValid=!1;var w=d.getCoordinates();this._errorLocation=w[1],this._errorIndicator=n.getFactory().createLineString(w),this._errMsg="Distance between buffer curve and input is too large ("+this._maxDistanceFound+" at "+ae.toLineString(w[0],w[1])+")"}},_i.prototype.isValid=function(){var n=Math.abs(this._bufDistance),a=_i.MAX_DISTANCE_DIFF_FRAC*n;return this._minValidDistance=n-a,this._maxValidDistance=n+a,!(!this._input.isEmpty()&&!this._result.isEmpty())||(this._bufDistance>0?this.checkPositiveValid():this.checkNegativeValid(),_i.VERBOSE&&Cr.out.println("Min Dist= "+this._minDistanceFound+"  err= "+(1-this._minDistanceFound/this._bufDistance)+"  Max Dist= "+this._maxDistanceFound+"  err= "+(this._maxDistanceFound/this._bufDistance-1)),this._isValid)},_i.prototype.checkNegativeValid=function(){if(!(this._input instanceof cn||this._input instanceof on||this._input instanceof Re))return null;var n=this.getPolygonLines(this._input);if(this.checkMinimumDistance(n,this._result,this._minValidDistance),!this._isValid)return null;this.checkMaximumDistance(n,this._result,this._maxValidDistance)},_i.prototype.getErrorIndicator=function(){return this._errorIndicator},_i.prototype.checkMinimumDistance=function(n,a,h){var d=new ko(n,a,h);if(this._minDistanceFound=d.distance(),this._minDistanceFound<h){this._isValid=!1;var w=d.nearestPoints();this._errorLocation=d.nearestPoints()[1],this._errorIndicator=n.getFactory().createLineString(w),this._errMsg="Distance between buffer curve and input is too small ("+this._minDistanceFound+" at "+ae.toLineString(w[0],w[1])+" )"}},_i.prototype.checkPositiveValid=function(){var n=this._result.getBoundary();if(this.checkMinimumDistance(this._input,n,this._minValidDistance),!this._isValid)return null;this.checkMaximumDistance(this._input,n,this._maxValidDistance)},_i.prototype.getErrorLocation=function(){return this._errorLocation},_i.prototype.getPolygonLines=function(n){for(var a=new Je,h=new Hi(a),d=Fa.getPolygons(n).iterator();d.hasNext();)d.next().apply(h);return n.getFactory().buildGeometry(a)},_i.prototype.getErrorMessage=function(){return this._errMsg},_i.prototype.interfaces_=function(){return[]},_i.prototype.getClass=function(){return _i},Ba.VERBOSE.get=function(){return!1},Ba.MAX_DISTANCE_DIFF_FRAC.get=function(){return.012},Object.defineProperties(_i,Ba);var Co=function(n,a,h){this._isValid=!0,this._errorMsg=null,this._errorLocation=null,this._errorIndicator=null,this._input=n||null,this._distance=a||null,this._result=h||null},So={VERBOSE:{configurable:!0},MAX_ENV_DIFF_FRAC:{configurable:!0}};Co.prototype.isValid=function(){return this.checkPolygonal(),this._isValid?(this.checkExpectedEmpty(),this._isValid?(this.checkEnvelope(),this._isValid?(this.checkArea(),this._isValid?(this.checkDistance(),this._isValid):this._isValid):this._isValid):this._isValid):this._isValid},Co.prototype.checkEnvelope=function(){if(this._distance<0)return null;var n=this._distance*Co.MAX_ENV_DIFF_FRAC;0===n&&(n=.001);var a=new Be(this._input.getEnvelopeInternal());a.expandBy(this._distance);var h=new Be(this._result.getEnvelopeInternal());h.expandBy(n),h.contains(a)||(this._isValid=!1,this._errorMsg="Buffer envelope is incorrect",this._errorIndicator=this._input.getFactory().toGeometry(h)),this.report("Envelope")},Co.prototype.checkDistance=function(){var n=new _i(this._input,this._distance,this._result);n.isValid()||(this._isValid=!1,this._errorMsg=n.getErrorMessage(),this._errorLocation=n.getErrorLocation(),this._errorIndicator=n.getErrorIndicator()),this.report("Distance")},Co.prototype.checkArea=function(){var n=this._input.getArea(),a=this._result.getArea();this._distance>0&&n>a&&(this._isValid=!1,this._errorMsg="Area of positive buffer is smaller than input",this._errorIndicator=this._result),this._distance<0&&n<a&&(this._isValid=!1,this._errorMsg="Area of negative buffer is larger than input",this._errorIndicator=this._result),this.report("Area")},Co.prototype.checkPolygonal=function(){this._result instanceof cn||this._result instanceof on||(this._isValid=!1),this._errorMsg="Result is not polygonal",this._errorIndicator=this._result,this.report("Polygonal")},Co.prototype.getErrorIndicator=function(){return this._errorIndicator},Co.prototype.getErrorLocation=function(){return this._errorLocation},Co.prototype.checkExpectedEmpty=function(){return this._input.getDimension()>=2||this._distance>0?null:(this._result.isEmpty()||(this._isValid=!1,this._errorMsg="Result is non-empty",this._errorIndicator=this._result),void this.report("ExpectedEmpty"))},Co.prototype.report=function(n){if(!Co.VERBOSE)return null;Cr.out.println("Check "+n+": "+(this._isValid?"passed":"FAILED"))},Co.prototype.getErrorMessage=function(){return this._errorMsg},Co.prototype.interfaces_=function(){return[]},Co.prototype.getClass=function(){return Co},Co.isValidMsg=function(n,a,h){var d=new Co(n,a,h);return d.isValid()?null:d.getErrorMessage()},Co.isValid=function(n,a,h){return!!new Co(n,a,h).isValid()},So.VERBOSE.get=function(){return!1},So.MAX_ENV_DIFF_FRAC.get=function(){return.012},Object.defineProperties(Co,So);var Ji=function(){this._pts=null,this._data=null;var a=arguments[1];this._pts=arguments[0],this._data=a};Ji.prototype.getCoordinates=function(){return this._pts},Ji.prototype.size=function(){return this._pts.length},Ji.prototype.getCoordinate=function(n){return this._pts[n]},Ji.prototype.isClosed=function(){return this._pts[0].equals(this._pts[this._pts.length-1])},Ji.prototype.getSegmentOctant=function(n){return n===this._pts.length-1?-1:Gs.octant(this.getCoordinate(n),this.getCoordinate(n+1))},Ji.prototype.setData=function(n){this._data=n},Ji.prototype.getData=function(){return this._data},Ji.prototype.toString=function(){return ae.toLineString(new jn(this._pts))},Ji.prototype.interfaces_=function(){return[Go]},Ji.prototype.getClass=function(){return Ji};var er=function(){this._findAllIntersections=!1,this._isCheckEndSegmentsOnly=!1,this._li=null,this._interiorIntersection=null,this._intSegments=null,this._intersections=new Je,this._intersectionCount=0,this._keepIntersections=!0,this._li=arguments[0],this._interiorIntersection=null};er.prototype.getInteriorIntersection=function(){return this._interiorIntersection},er.prototype.setCheckEndSegmentsOnly=function(n){this._isCheckEndSegmentsOnly=n},er.prototype.getIntersectionSegments=function(){return this._intSegments},er.prototype.count=function(){return this._intersectionCount},er.prototype.getIntersections=function(){return this._intersections},er.prototype.setFindAllIntersections=function(n){this._findAllIntersections=n},er.prototype.setKeepIntersections=function(n){this._keepIntersections=n},er.prototype.processIntersections=function(n,a,h,d){if(!this._findAllIntersections&&this.hasIntersection()||n===h&&a===d||this._isCheckEndSegmentsOnly&&!this.isEndSegment(n,a)&&!this.isEndSegment(h,d))return null;var w=n.getCoordinates()[a],O=n.getCoordinates()[a+1],k=h.getCoordinates()[d],W=h.getCoordinates()[d+1];this._li.computeIntersection(w,O,k,W),this._li.hasIntersection()&&this._li.isInteriorIntersection()&&(this._intSegments=new Array(4).fill(null),this._intSegments[0]=w,this._intSegments[1]=O,this._intSegments[2]=k,this._intSegments[3]=W,this._interiorIntersection=this._li.getIntersection(0),this._keepIntersections&&this._intersections.add(this._interiorIntersection),this._intersectionCount++)},er.prototype.isEndSegment=function(n,a){return 0===a||a>=n.size()-2},er.prototype.hasIntersection=function(){return null!==this._interiorIntersection},er.prototype.isDone=function(){return!this._findAllIntersections&&null!==this._interiorIntersection},er.prototype.interfaces_=function(){return[au]},er.prototype.getClass=function(){return er},er.createAllIntersectionsFinder=function(n){var a=new er(n);return a.setFindAllIntersections(!0),a},er.createAnyIntersectionFinder=function(n){return new er(n)},er.createIntersectionCounter=function(n){var a=new er(n);return a.setFindAllIntersections(!0),a.setKeepIntersections(!1),a};var ua=function(){this._li=new Ee,this._segStrings=null,this._findAllIntersections=!1,this._segInt=null,this._isValid=!0,this._segStrings=arguments[0]};ua.prototype.execute=function(){if(null!==this._segInt)return null;this.checkInteriorIntersections()},ua.prototype.getIntersections=function(){return this._segInt.getIntersections()},ua.prototype.isValid=function(){return this.execute(),this._isValid},ua.prototype.setFindAllIntersections=function(n){this._findAllIntersections=n},ua.prototype.checkInteriorIntersections=function(){this._isValid=!0,this._segInt=new er(this._li),this._segInt.setFindAllIntersections(this._findAllIntersections);var n=new gu;if(n.setSegmentIntersector(this._segInt),n.computeNodes(this._segStrings),this._segInt.hasIntersection())return this._isValid=!1,null},ua.prototype.checkValid=function(){if(this.execute(),!this._isValid)throw new Ja(this.getErrorMessage(),this._segInt.getInteriorIntersection())},ua.prototype.getErrorMessage=function(){if(this._isValid)return"no intersections found";var n=this._segInt.getIntersectionSegments();return"found non-noded intersection between "+ae.toLineString(n[0],n[1])+" and "+ae.toLineString(n[2],n[3])},ua.prototype.interfaces_=function(){return[]},ua.prototype.getClass=function(){return ua},ua.computeIntersections=function(n){var a=new ua(n);return a.setFindAllIntersections(!0),a.isValid(),a.getIntersections()};var os=function n(){this._nv=null,this._nv=new ua(n.toSegmentStrings(arguments[0]))};os.prototype.checkValid=function(){this._nv.checkValid()},os.prototype.interfaces_=function(){return[]},os.prototype.getClass=function(){return os},os.toSegmentStrings=function(n){for(var a=new Je,h=n.iterator();h.hasNext();){var d=h.next();a.add(new Ji(d.getCoordinates(),d))}return a},os.checkValid=function(n){new os(n).checkValid()};var Ua=function(n){this._mapOp=n};Ua.prototype.map=function(n){for(var a=new Je,h=0;h<n.getNumGeometries();h++){var d=this._mapOp.map(n.getGeometryN(h));d.isEmpty()||a.add(d)}return n.getFactory().createGeometryCollection(en.toGeometryArray(a))},Ua.prototype.interfaces_=function(){return[]},Ua.prototype.getClass=function(){return Ua},Ua.map=function(n,a){return new Ua(a).map(n)};var ji=function(){this._op=null,this._geometryFactory=null,this._ptLocator=null,this._lineEdgesList=new Je,this._resultLineList=new Je;var a=arguments[1],h=arguments[2];this._op=arguments[0],this._geometryFactory=a,this._ptLocator=h};ji.prototype.collectLines=function(n){for(var a=this._op.getGraph().getEdgeEnds().iterator();a.hasNext();){var h=a.next();this.collectLineEdge(h,n,this._lineEdgesList),this.collectBoundaryTouchEdge(h,n,this._lineEdgesList)}},ji.prototype.labelIsolatedLine=function(n,a){var h=this._ptLocator.locate(n.getCoordinate(),this._op.getArgGeometry(a));n.getLabel().setLocation(a,h)},ji.prototype.build=function(n){return this.findCoveredLineEdges(),this.collectLines(n),this.buildLines(n),this._resultLineList},ji.prototype.collectLineEdge=function(n,a,h){var d=n.getLabel(),w=n.getEdge();n.isLineEdge()&&(n.isVisited()||!Wr.isResultOfOp(d,a)||w.isCovered()||(h.add(w),n.setVisitedEdge(!0)))},ji.prototype.findCoveredLineEdges=function(){for(var n=this._op.getGraph().getNodes().iterator();n.hasNext();)n.next().getEdges().findCoveredLineEdges();for(var a=this._op.getGraph().getEdgeEnds().iterator();a.hasNext();){var h=a.next(),d=h.getEdge();if(h.isLineEdge()&&!d.isCoveredSet()){var w=this._op.isCoveredByA(h.getCoordinate());d.setCovered(w)}}},ji.prototype.labelIsolatedLines=function(n){for(var a=n.iterator();a.hasNext();){var h=a.next(),d=h.getLabel();h.isIsolated()&&(d.isNull(0)?this.labelIsolatedLine(h,0):this.labelIsolatedLine(h,1))}},ji.prototype.buildLines=function(n){for(var a=this._lineEdgesList.iterator();a.hasNext();){var h=a.next(),d=this._geometryFactory.createLineString(h.getCoordinates());this._resultLineList.add(d),h.setInResult(!0)}},ji.prototype.collectBoundaryTouchEdge=function(n,a,h){var d=n.getLabel();return n.isLineEdge()||n.isVisited()||n.isInteriorAreaEdge()||n.getEdge().isInResult()?null:($.isTrue(!(n.isInResult()||n.getSym().isInResult())||!n.getEdge().isInResult()),void(Wr.isResultOfOp(d,a)&&a===Wr.INTERSECTION&&(h.add(n.getEdge()),n.setVisitedEdge(!0))))},ji.prototype.interfaces_=function(){return[]},ji.prototype.getClass=function(){return ji};var ps=function(){this._op=null,this._geometryFactory=null,this._resultPointList=new Je;var a=arguments[1];this._op=arguments[0],this._geometryFactory=a};ps.prototype.filterCoveredNodeToPoint=function(n){var a=n.getCoordinate();if(!this._op.isCoveredByLA(a)){var h=this._geometryFactory.createPoint(a);this._resultPointList.add(h)}},ps.prototype.extractNonCoveredResultNodes=function(n){for(var a=this._op.getGraph().getNodes().iterator();a.hasNext();){var h=a.next();if(!(h.isInResult()||h.isIncidentEdgeInResult()||0!==h.getEdges().getDegree()&&n!==Wr.INTERSECTION)){var d=h.getLabel();Wr.isResultOfOp(d,n)&&this.filterCoveredNodeToPoint(h)}}},ps.prototype.build=function(n){return this.extractNonCoveredResultNodes(n),this._resultPointList},ps.prototype.interfaces_=function(){return[]},ps.prototype.getClass=function(){return ps};var xi=function(){this._inputGeom=null,this._factory=null,this._pruneEmptyGeometry=!0,this._preserveGeometryCollectionType=!0,this._preserveCollections=!1,this._preserveType=!1};xi.prototype.transformPoint=function(n,a){return this._factory.createPoint(this.transformCoordinates(n.getCoordinateSequence(),n))},xi.prototype.transformPolygon=function(n,a){var h=!0,d=this.transformLinearRing(n.getExteriorRing(),n);null!==d&&d instanceof Un&&!d.isEmpty()||(h=!1);for(var w=new Je,O=0;O<n.getNumInteriorRing();O++){var k=this.transformLinearRing(n.getInteriorRingN(O),n);null===k||k.isEmpty()||(k instanceof Un||(h=!1),w.add(k))}if(h)return this._factory.createPolygon(d,w.toArray([]));var W=new Je;return null!==d&&W.add(d),W.addAll(w),this._factory.buildGeometry(W)},xi.prototype.createCoordinateSequence=function(n){return this._factory.getCoordinateSequenceFactory().create(n)},xi.prototype.getInputGeometry=function(){return this._inputGeom},xi.prototype.transformMultiLineString=function(n,a){for(var h=new Je,d=0;d<n.getNumGeometries();d++){var w=this.transformLineString(n.getGeometryN(d),n);null!==w&&(w.isEmpty()||h.add(w))}return this._factory.buildGeometry(h)},xi.prototype.transformCoordinates=function(n,a){return this.copy(n)},xi.prototype.transformLineString=function(n,a){return this._factory.createLineString(this.transformCoordinates(n.getCoordinateSequence(),n))},xi.prototype.transformMultiPoint=function(n,a){for(var h=new Je,d=0;d<n.getNumGeometries();d++){var w=this.transformPoint(n.getGeometryN(d),n);null!==w&&(w.isEmpty()||h.add(w))}return this._factory.buildGeometry(h)},xi.prototype.transformMultiPolygon=function(n,a){for(var h=new Je,d=0;d<n.getNumGeometries();d++){var w=this.transformPolygon(n.getGeometryN(d),n);null!==w&&(w.isEmpty()||h.add(w))}return this._factory.buildGeometry(h)},xi.prototype.copy=function(n){return n.copy()},xi.prototype.transformGeometryCollection=function(n,a){for(var h=new Je,d=0;d<n.getNumGeometries();d++){var w=this.transform(n.getGeometryN(d));null!==w&&(this._pruneEmptyGeometry&&w.isEmpty()||h.add(w))}return this._preserveGeometryCollectionType?this._factory.createGeometryCollection(en.toGeometryArray(h)):this._factory.buildGeometry(h)},xi.prototype.transform=function(n){if(this._inputGeom=n,this._factory=n.getFactory(),n instanceof On)return this.transformPoint(n,null);if(n instanceof gi)return this.transformMultiPoint(n,null);if(n instanceof Un)return this.transformLinearRing(n,null);if(n instanceof ir)return this.transformLineString(n,null);if(n instanceof nr)return this.transformMultiLineString(n,null);if(n instanceof cn)return this.transformPolygon(n,null);if(n instanceof on)return this.transformMultiPolygon(n,null);if(n instanceof Re)return this.transformGeometryCollection(n,null);throw new J("Unknown Geometry subtype: "+n.getClass().getName())},xi.prototype.transformLinearRing=function(n,a){var h=this.transformCoordinates(n.getCoordinateSequence(),n);if(null===h)return this._factory.createLinearRing(null);var d=h.size();return d>0&&d<4&&!this._preserveType?this._factory.createLineString(h):this._factory.createLinearRing(h)},xi.prototype.interfaces_=function(){return[]},xi.prototype.getClass=function(){return xi};var dr=function n(){if(this._snapTolerance=0,this._srcPts=null,this._seg=new Fr,this._allowSnappingToSourceVertices=!1,this._isClosed=!1,arguments[0]instanceof ir&&"number"==typeof arguments[1]){var h=arguments[1];n.call(this,arguments[0].getCoordinates(),h)}else if(arguments[0]instanceof Array&&"number"==typeof arguments[1]){var d=arguments[0],w=arguments[1];this._srcPts=d,this._isClosed=n.isClosed(d),this._snapTolerance=w}};dr.prototype.snapVertices=function(n,a){for(var h=this._isClosed?n.size()-1:n.size(),d=0;d<h;d++){var w=n.get(d),O=this.findSnapForVertex(w,a);null!==O&&(n.set(d,new j(O)),0===d&&this._isClosed&&n.set(n.size()-1,new j(O)))}},dr.prototype.findSnapForVertex=function(n,a){for(var h=0;h<a.length;h++){if(n.equals2D(a[h]))return null;if(n.distance(a[h])<this._snapTolerance)return a[h]}return null},dr.prototype.snapTo=function(n){var a=new V(this._srcPts);return this.snapVertices(a,n),this.snapSegments(a,n),a.toCoordinateArray()},dr.prototype.snapSegments=function(n,a){if(0===a.length)return null;var h=a.length;a[0].equals2D(a[a.length-1])&&(h=a.length-1);for(var d=0;d<h;d++){var w=a[d],O=this.findSegmentIndexToSnap(w,n);O>=0&&n.add(O+1,new j(w),!1)}},dr.prototype.findSegmentIndexToSnap=function(n,a){for(var h=Q.MAX_VALUE,d=-1,w=0;w<a.size()-1;w++){if(this._seg.p0=a.get(w),this._seg.p1=a.get(w+1),this._seg.p0.equals2D(n)||this._seg.p1.equals2D(n)){if(this._allowSnappingToSourceVertices)continue;return-1}var O=this._seg.distance(n);O<this._snapTolerance&&O<h&&(h=O,d=w)}return d},dr.prototype.setAllowSnappingToSourceVertices=function(n){this._allowSnappingToSourceVertices=n},dr.prototype.interfaces_=function(){return[]},dr.prototype.getClass=function(){return dr},dr.isClosed=function(n){return!(n.length<=1)&&n[0].equals2D(n[n.length-1])};var Bi=function(n){this._srcGeom=n||null},tl={SNAP_PRECISION_FACTOR:{configurable:!0}};Bi.prototype.snapTo=function(n,a){var h=this.extractTargetCoordinates(n);return new fs(a,h).transform(this._srcGeom)},Bi.prototype.snapToSelf=function(n,a){var h=this.extractTargetCoordinates(this._srcGeom),d=new fs(n,h,!0).transform(this._srcGeom),w=d;return a&&Te(w,wn)&&(w=d.buffer(0)),w},Bi.prototype.computeSnapTolerance=function(n){return this.computeMinimumSegmentLength(n)/10},Bi.prototype.extractTargetCoordinates=function(n){for(var a=new de,h=n.getCoordinates(),d=0;d<h.length;d++)a.add(h[d]);return a.toArray(new Array(0).fill(null))},Bi.prototype.computeMinimumSegmentLength=function(n){for(var a=Q.MAX_VALUE,h=0;h<n.length-1;h++){var d=n[h].distance(n[h+1]);d<a&&(a=d)}return a},Bi.prototype.interfaces_=function(){return[]},Bi.prototype.getClass=function(){return Bi},Bi.snap=function(n,a,h){var d=new Array(2).fill(null),w=new Bi(n);d[0]=w.snapTo(a,h);var O=new Bi(a);return d[1]=O.snapTo(d[0],h),d},Bi.computeOverlaySnapTolerance=function(){if(1===arguments.length){var n=arguments[0],a=Bi.computeSizeBasedSnapTolerance(n),h=n.getPrecisionModel();if(h.getType()===En.FIXED){var d=1/h.getScale()*2/1.415;d>a&&(a=d)}return a}if(2===arguments.length){var O=arguments[1];return Math.min(Bi.computeOverlaySnapTolerance(arguments[0]),Bi.computeOverlaySnapTolerance(O))}},Bi.computeSizeBasedSnapTolerance=function(n){var a=n.getEnvelopeInternal();return Math.min(a.getHeight(),a.getWidth())*Bi.SNAP_PRECISION_FACTOR},Bi.snapToSelf=function(n,a,h){return new Bi(n).snapToSelf(a,h)},tl.SNAP_PRECISION_FACTOR.get=function(){return 1e-9},Object.defineProperties(Bi,tl);var fs=function(n){function a(h,d,w){n.call(this),this._snapTolerance=h||null,this._snapPts=d||null,this._isSelfSnap=void 0!==w&&w}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.snapLine=function(h,d){var w=new dr(h,this._snapTolerance);return w.setAllowSnappingToSourceVertices(this._isSelfSnap),w.snapTo(d)},a.prototype.transformCoordinates=function(h,d){var w=h.toCoordinateArray(),O=this.snapLine(w,this._snapPts);return this._factory.getCoordinateSequenceFactory().create(O)},a.prototype.interfaces_=function(){return[]},a.prototype.getClass=function(){return a},a}(xi),mi=function(){this._isFirst=!0,this._commonMantissaBitsCount=53,this._commonBits=0,this._commonSignExp=null};mi.prototype.getCommon=function(){return Q.longBitsToDouble(this._commonBits)},mi.prototype.add=function(n){var a=Q.doubleToLongBits(n);return this._isFirst?(this._commonBits=a,this._commonSignExp=mi.signExpBits(this._commonBits),this._isFirst=!1,null):mi.signExpBits(a)!==this._commonSignExp?(this._commonBits=0,null):(this._commonMantissaBitsCount=mi.numCommonMostSigMantissaBits(this._commonBits,a),void(this._commonBits=mi.zeroLowerBits(this._commonBits,64-(12+this._commonMantissaBitsCount))))},mi.prototype.toString=function(){if(1===arguments.length){var n=arguments[0],a=Q.longBitsToDouble(n),h="0000000000000000000000000000000000000000000000000000000000000000"+Q.toBinaryString(n),d=h.substring(h.length-64);return d.substring(0,1)+"  "+d.substring(1,12)+"(exp) "+d.substring(12)+" [ "+a+" ]"}},mi.prototype.interfaces_=function(){return[]},mi.prototype.getClass=function(){return mi},mi.getBit=function(n,a){return 0!=(n&1<<a)?1:0},mi.signExpBits=function(n){return n>>52},mi.zeroLowerBits=function(n,a){return n&~((1<<a)-1)},mi.numCommonMostSigMantissaBits=function(n,a){for(var h=0,d=52;d>=0;d--){if(mi.getBit(n,d)!==mi.getBit(a,d))return h;h++}return 52};var Is=function(){this._commonCoord=null,this._ccFilter=new uu},wl={CommonCoordinateFilter:{configurable:!0},Translater:{configurable:!0}};Is.prototype.addCommonBits=function(n){var a=new fo(this._commonCoord);n.apply(a),n.geometryChanged()},Is.prototype.removeCommonBits=function(n){if(0===this._commonCoord.x&&0===this._commonCoord.y)return n;var a=new j(this._commonCoord);a.x=-a.x,a.y=-a.y;var h=new fo(a);return n.apply(h),n.geometryChanged(),n},Is.prototype.getCommonCoordinate=function(){return this._commonCoord},Is.prototype.add=function(n){n.apply(this._ccFilter),this._commonCoord=this._ccFilter.getCommonCoordinate()},Is.prototype.interfaces_=function(){return[]},Is.prototype.getClass=function(){return Is},wl.CommonCoordinateFilter.get=function(){return uu},wl.Translater.get=function(){return fo},Object.defineProperties(Is,wl);var uu=function(){this._commonBitsX=new mi,this._commonBitsY=new mi};uu.prototype.filter=function(n){this._commonBitsX.add(n.x),this._commonBitsY.add(n.y)},uu.prototype.getCommonCoordinate=function(){return new j(this._commonBitsX.getCommon(),this._commonBitsY.getCommon())},uu.prototype.interfaces_=function(){return[Dn]},uu.prototype.getClass=function(){return uu};var fo=function(){this.trans=null,this.trans=arguments[0]};fo.prototype.filter=function(n,a){var h=n.getOrdinate(a,0)+this.trans.x,d=n.getOrdinate(a,1)+this.trans.y;n.setOrdinate(a,0,h),n.setOrdinate(a,1,d)},fo.prototype.isDone=function(){return!1},fo.prototype.isGeometryChanged=function(){return!0},fo.prototype.interfaces_=function(){return[Tr]},fo.prototype.getClass=function(){return fo};var Oi=function(n,a){this._geom=new Array(2).fill(null),this._snapTolerance=null,this._cbr=null,this._geom[0]=n,this._geom[1]=a,this.computeSnapTolerance()};Oi.prototype.selfSnap=function(n){return new Bi(n).snapTo(n,this._snapTolerance)},Oi.prototype.removeCommonBits=function(n){this._cbr=new Is,this._cbr.add(n[0]),this._cbr.add(n[1]);var a=new Array(2).fill(null);return a[0]=this._cbr.removeCommonBits(n[0].copy()),a[1]=this._cbr.removeCommonBits(n[1].copy()),a},Oi.prototype.prepareResult=function(n){return this._cbr.addCommonBits(n),n},Oi.prototype.getResultGeometry=function(n){var a=this.snap(this._geom),h=Wr.overlayOp(a[0],a[1],n);return this.prepareResult(h)},Oi.prototype.checkValid=function(n){n.isValid()||Cr.out.println("Snapped geometry is invalid")},Oi.prototype.computeSnapTolerance=function(){this._snapTolerance=Bi.computeOverlaySnapTolerance(this._geom[0],this._geom[1])},Oi.prototype.snap=function(n){var a=this.removeCommonBits(n);return Bi.snap(a[0],a[1],this._snapTolerance)},Oi.prototype.interfaces_=function(){return[]},Oi.prototype.getClass=function(){return Oi},Oi.overlayOp=function(n,a,h){return new Oi(n,a).getResultGeometry(h)},Oi.union=function(n,a){return Oi.overlayOp(n,a,Wr.UNION)},Oi.intersection=function(n,a){return Oi.overlayOp(n,a,Wr.INTERSECTION)},Oi.symDifference=function(n,a){return Oi.overlayOp(n,a,Wr.SYMDIFFERENCE)},Oi.difference=function(n,a){return Oi.overlayOp(n,a,Wr.DIFFERENCE)};var Fo=function(n,a){this._geom=new Array(2).fill(null),this._geom[0]=n,this._geom[1]=a};Fo.prototype.getResultGeometry=function(n){var a=null,h=!1,d=null;try{a=Wr.overlayOp(this._geom[0],this._geom[1],n),h=!0}catch(w){if(!(w instanceof st))throw w;d=w}if(!h)try{a=Oi.overlayOp(this._geom[0],this._geom[1],n)}catch(w){throw w instanceof st?d:w}return a},Fo.prototype.interfaces_=function(){return[]},Fo.prototype.getClass=function(){return Fo},Fo.overlayOp=function(n,a,h){return new Fo(n,a).getResultGeometry(h)},Fo.union=function(n,a){return Fo.overlayOp(n,a,Wr.UNION)},Fo.intersection=function(n,a){return Fo.overlayOp(n,a,Wr.INTERSECTION)},Fo.symDifference=function(n,a){return Fo.overlayOp(n,a,Wr.SYMDIFFERENCE)},Fo.difference=function(n,a){return Fo.overlayOp(n,a,Wr.DIFFERENCE)};var Lu=function(){this.mce=null,this.chainIndex=null;var a=arguments[1];this.mce=arguments[0],this.chainIndex=a};Lu.prototype.computeIntersections=function(n,a){this.mce.computeIntersectsForChain(this.chainIndex,n.mce,n.chainIndex,a)},Lu.prototype.interfaces_=function(){return[]},Lu.prototype.getClass=function(){return Lu};var $o=function n(){if(this._label=null,this._xValue=null,this._eventType=null,this._insertEvent=null,this._deleteEventIndex=null,this._obj=null,2===arguments.length){var a=arguments[0],h=arguments[1];this._eventType=n.DELETE,this._xValue=a,this._insertEvent=h}else if(3===arguments.length){var d=arguments[0],w=arguments[1],O=arguments[2];this._eventType=n.INSERT,this._label=d,this._xValue=w,this._obj=O}},as={INSERT:{configurable:!0},DELETE:{configurable:!0}};$o.prototype.isDelete=function(){return this._eventType===$o.DELETE},$o.prototype.setDeleteEventIndex=function(n){this._deleteEventIndex=n},$o.prototype.getObject=function(){return this._obj},$o.prototype.compareTo=function(n){return this._xValue<n._xValue?-1:this._xValue>n._xValue?1:this._eventType<n._eventType?-1:this._eventType>n._eventType?1:0},$o.prototype.getInsertEvent=function(){return this._insertEvent},$o.prototype.isInsert=function(){return this._eventType===$o.INSERT},$o.prototype.isSameLabel=function(n){return null!==this._label&&this._label===n._label},$o.prototype.getDeleteEventIndex=function(){return this._deleteEventIndex},$o.prototype.interfaces_=function(){return[et]},$o.prototype.getClass=function(){return $o},as.INSERT.get=function(){return 1},as.DELETE.get=function(){return 2},Object.defineProperties($o,as);var Ws=function(){};Ws.prototype.interfaces_=function(){return[]},Ws.prototype.getClass=function(){return Ws};var Mn=function(){this._hasIntersection=!1,this._hasProper=!1,this._hasProperInterior=!1,this._properIntersectionPoint=null,this._li=null,this._includeProper=null,this._recordIsolated=null,this._isSelfIntersection=null,this._numIntersections=0,this.numTests=0,this._bdyNodes=null,this._isDone=!1,this._isDoneWhenProperInt=!1;var a=arguments[1],h=arguments[2];this._li=arguments[0],this._includeProper=a,this._recordIsolated=h};Mn.prototype.isTrivialIntersection=function(n,a,h,d){if(n===h&&1===this._li.getIntersectionNum()){if(Mn.isAdjacentSegments(a,d))return!0;if(n.isClosed()){var w=n.getNumPoints()-1;if(0===a&&d===w||0===d&&a===w)return!0}}return!1},Mn.prototype.getProperIntersectionPoint=function(){return this._properIntersectionPoint},Mn.prototype.setIsDoneIfProperInt=function(n){this._isDoneWhenProperInt=n},Mn.prototype.hasProperInteriorIntersection=function(){return this._hasProperInterior},Mn.prototype.isBoundaryPointInternal=function(n,a){for(var h=a.iterator();h.hasNext();){var d=h.next().getCoordinate();if(n.isIntersection(d))return!0}return!1},Mn.prototype.hasProperIntersection=function(){return this._hasProper},Mn.prototype.hasIntersection=function(){return this._hasIntersection},Mn.prototype.isDone=function(){return this._isDone},Mn.prototype.isBoundaryPoint=function(n,a){return!(null===a||!this.isBoundaryPointInternal(n,a[0])&&!this.isBoundaryPointInternal(n,a[1]))},Mn.prototype.setBoundaryNodes=function(n,a){this._bdyNodes=new Array(2).fill(null),this._bdyNodes[0]=n,this._bdyNodes[1]=a},Mn.prototype.addIntersections=function(n,a,h,d){if(n===h&&a===d)return null;this.numTests++;var w=n.getCoordinates()[a],O=n.getCoordinates()[a+1],k=h.getCoordinates()[d],W=h.getCoordinates()[d+1];this._li.computeIntersection(w,O,k,W),this._li.hasIntersection()&&(this._recordIsolated&&(n.setIsolated(!1),h.setIsolated(!1)),this._numIntersections++,this.isTrivialIntersection(n,a,h,d)||(this._hasIntersection=!0,!this._includeProper&&this._li.isProper()||(n.addIntersections(this._li,a,0),h.addIntersections(this._li,d,1)),this._li.isProper()&&(this._properIntersectionPoint=this._li.getIntersection(0).copy(),this._hasProper=!0,this._isDoneWhenProperInt&&(this._isDone=!0),this.isBoundaryPoint(this._li,this._bdyNodes)||(this._hasProperInterior=!0))))},Mn.prototype.interfaces_=function(){return[]},Mn.prototype.getClass=function(){return Mn},Mn.isAdjacentSegments=function(n,a){return 1===Math.abs(n-a)};var ii=function(n){function a(){n.call(this),this.events=new Je,this.nOverlaps=null}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.prepareEvents=function(){oa.sort(this.events);for(var h=0;h<this.events.size();h++){var d=this.events.get(h);d.isDelete()&&d.getInsertEvent().setDeleteEventIndex(h)}},a.prototype.computeIntersections=function(){if(1===arguments.length){var h=arguments[0];this.nOverlaps=0,this.prepareEvents();for(var d=0;d<this.events.size();d++){var w=this.events.get(d);if(w.isInsert()&&this.processOverlaps(d,w.getDeleteEventIndex(),w,h),h.isDone())break}}else if(3===arguments.length)if(arguments[2]instanceof Mn&&Te(arguments[0],ki)&&Te(arguments[1],ki)){var O=arguments[0],k=arguments[1],W=arguments[2];this.addEdges(O,O),this.addEdges(k,k),this.computeIntersections(W)}else if("boolean"==typeof arguments[2]&&Te(arguments[0],ki)&&arguments[1]instanceof Mn){var mt=arguments[0],Gt=arguments[1];arguments[2]?this.addEdges(mt,null):this.addEdges(mt),this.computeIntersections(Gt)}},a.prototype.addEdge=function(h,d){for(var w=h.getMonotoneChainEdge(),O=w.getStartIndexes(),k=0;k<O.length-1;k++){var W=new Lu(w,k),mt=new $o(d,w.getMinX(k),W);this.events.add(mt),this.events.add(new $o(w.getMaxX(k),mt))}},a.prototype.processOverlaps=function(h,d,w,O){for(var k=w.getObject(),W=h;W<d;W++){var mt=this.events.get(W);if(mt.isInsert()){var Gt=mt.getObject();w.isSameLabel(mt)||(k.computeIntersections(Gt,O),this.nOverlaps++)}}},a.prototype.addEdges=function(){if(1===arguments.length)for(var h=arguments[0].iterator();h.hasNext();){var d=h.next();this.addEdge(d,d)}else if(2===arguments.length)for(var O=arguments[1],k=arguments[0].iterator();k.hasNext();){var W=k.next();this.addEdge(W,O)}},a.prototype.interfaces_=function(){return[]},a.prototype.getClass=function(){return a},a}(Ws),ao=function(){this._min=Q.POSITIVE_INFINITY,this._max=Q.NEGATIVE_INFINITY},ta={NodeComparator:{configurable:!0}};ao.prototype.getMin=function(){return this._min},ao.prototype.intersects=function(n,a){return!(this._min>a||this._max<n)},ao.prototype.getMax=function(){return this._max},ao.prototype.toString=function(){return ae.toLineString(new j(this._min,0),new j(this._max,0))},ao.prototype.interfaces_=function(){return[]},ao.prototype.getClass=function(){return ao},ta.NodeComparator.get=function(){return la},Object.defineProperties(ao,ta);var la=function(){};la.prototype.compare=function(n,a){var w=(n._min+n._max)/2,O=(a._min+a._max)/2;return w<O?-1:w>O?1:0},la.prototype.interfaces_=function(){return[lt]},la.prototype.getClass=function(){return la};var Ps=function(n){function a(){n.call(this),this._item=null;var d=arguments[1],w=arguments[2];this._min=arguments[0],this._max=d,this._item=w}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.query=function(h,d,w){if(!this.intersects(h,d))return null;w.visitItem(this._item)},a.prototype.interfaces_=function(){return[]},a.prototype.getClass=function(){return a},a}(ao),Aa=function(n){function a(){n.call(this),this._node1=null,this._node2=null;var d=arguments[1];this._node1=arguments[0],this._node2=d,this.buildExtent(this._node1,this._node2)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.buildExtent=function(h,d){this._min=Math.min(h._min,d._min),this._max=Math.max(h._max,d._max)},a.prototype.query=function(h,d,w){if(!this.intersects(h,d))return null;null!==this._node1&&this._node1.query(h,d,w),null!==this._node2&&this._node2.query(h,d,w)},a.prototype.interfaces_=function(){return[]},a.prototype.getClass=function(){return a},a}(ao),ea=function(){this._leaves=new Je,this._root=null,this._level=0};ea.prototype.buildTree=function(){oa.sort(this._leaves,new ao.NodeComparator);for(var n=this._leaves,a=null,h=new Je;;){if(this.buildLevel(n,h),1===h.size())return h.get(0);a=n,n=h,h=a}},ea.prototype.insert=function(n,a,h){if(null!==this._root)throw new Error("Index cannot be added to once it has been queried");this._leaves.add(new Ps(n,a,h))},ea.prototype.query=function(n,a,h){this.init(),this._root.query(n,a,h)},ea.prototype.buildRoot=function(){if(null!==this._root)return null;this._root=this.buildTree()},ea.prototype.printNode=function(n){Cr.out.println(ae.toLineString(new j(n._min,this._level),new j(n._max,this._level)))},ea.prototype.init=function(){if(null!==this._root)return null;this.buildRoot()},ea.prototype.buildLevel=function(n,a){this._level++,a.clear();for(var h=0;h<n.size();h+=2){var d=n.get(h);if(null===(h+1<n.size()?n.get(h):null))a.add(d);else{var w=new Aa(n.get(h),n.get(h+1));a.add(w)}}},ea.prototype.interfaces_=function(){return[]},ea.prototype.getClass=function(){return ea};var ca=function(){this._items=new Je};ca.prototype.visitItem=function(n){this._items.add(n)},ca.prototype.getItems=function(){return this._items},ca.prototype.interfaces_=function(){return[xs]},ca.prototype.getClass=function(){return ca};var Ms=function(){this._index=null;var n=arguments[0];if(!Te(n,wn))throw new J("Argument must be Polygonal");this._index=new Ki(n)},yr={SegmentVisitor:{configurable:!0},IntervalIndexedGeometry:{configurable:!0}};Ms.prototype.locate=function(n){var a=new We(n),h=new jr(a);return this._index.query(n.y,n.y,h),a.getLocation()},Ms.prototype.interfaces_=function(){return[mu]},Ms.prototype.getClass=function(){return Ms},yr.SegmentVisitor.get=function(){return jr},yr.IntervalIndexedGeometry.get=function(){return Ki},Object.defineProperties(Ms,yr);var jr=function(){this._counter=null,this._counter=arguments[0]};jr.prototype.visitItem=function(n){var a=n;this._counter.countSegment(a.getCoordinate(0),a.getCoordinate(1))},jr.prototype.interfaces_=function(){return[xs]},jr.prototype.getClass=function(){return jr};var Ki=function(){this._index=new ea,this.init(arguments[0])};Ki.prototype.init=function(n){for(var a=Hi.getLines(n).iterator();a.hasNext();){var h=a.next().getCoordinates();this.addLine(h)}},Ki.prototype.addLine=function(n){for(var a=1;a<n.length;a++){var h=new Fr(n[a-1],n[a]),d=Math.min(h.p0.y,h.p1.y),w=Math.max(h.p0.y,h.p1.y);this._index.insert(d,w,h)}},Ki.prototype.query=function(){if(2===arguments.length){var n=arguments[0],a=arguments[1],h=new ca;return this._index.query(n,a,h),h.getItems()}3===arguments.length&&this._index.query(arguments[0],arguments[1],arguments[2])},Ki.prototype.interfaces_=function(){return[]},Ki.prototype.getClass=function(){return Ki};var ha=function(n){function a(){if(n.call(this),this._parentGeom=null,this._lineEdgeMap=new Rs,this._boundaryNodeRule=null,this._useBoundaryDeterminationRule=!0,this._argIndex=null,this._boundaryNodes=null,this._hasTooFewPoints=!1,this._invalidPoint=null,this._areaPtLocator=null,this._ptLocator=new zo,2===arguments.length){var d=arguments[1],w=Rn.OGC_SFS_BOUNDARY_RULE;this._argIndex=arguments[0],this._parentGeom=d,this._boundaryNodeRule=w,null!==d&&this.add(d)}else if(3===arguments.length){var k=arguments[1],W=arguments[2];this._argIndex=arguments[0],this._parentGeom=k,this._boundaryNodeRule=W,null!==k&&this.add(k)}}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.insertBoundaryPoint=function(h,d){var w=this._nodes.addNode(d).getLabel(),O=1;w.getLocation(h,Qe.ON)===at.BOUNDARY&&O++;var k=a.determineBoundary(this._boundaryNodeRule,O);w.setLocation(h,k)},a.prototype.computeSelfNodes=function(){if(2===arguments.length)return this.computeSelfNodes(arguments[0],arguments[1],!1);if(3===arguments.length){var O=arguments[1],k=arguments[2],W=new Mn(arguments[0],!0,!1);return W.setIsDoneIfProperInt(k),this.createEdgeSetIntersector().computeIntersections(this._edges,W,O||!(this._parentGeom instanceof Un||this._parentGeom instanceof cn||this._parentGeom instanceof on)),this.addSelfIntersectionNodes(this._argIndex),W}},a.prototype.computeSplitEdges=function(h){for(var d=this._edges.iterator();d.hasNext();)d.next().eiList.addSplitEdges(h)},a.prototype.computeEdgeIntersections=function(h,d,w){var O=new Mn(d,w,!0);return O.setBoundaryNodes(this.getBoundaryNodes(),h.getBoundaryNodes()),this.createEdgeSetIntersector().computeIntersections(this._edges,h._edges,O),O},a.prototype.getGeometry=function(){return this._parentGeom},a.prototype.getBoundaryNodeRule=function(){return this._boundaryNodeRule},a.prototype.hasTooFewPoints=function(){return this._hasTooFewPoints},a.prototype.addPoint=function(){if(arguments[0]instanceof On){var h=arguments[0].getCoordinate();this.insertPoint(this._argIndex,h,at.INTERIOR)}else arguments[0]instanceof j&&this.insertPoint(this._argIndex,arguments[0],at.INTERIOR)},a.prototype.addPolygon=function(h){this.addPolygonRing(h.getExteriorRing(),at.EXTERIOR,at.INTERIOR);for(var d=0;d<h.getNumInteriorRing();d++){var w=h.getInteriorRingN(d);this.addPolygonRing(w,at.INTERIOR,at.EXTERIOR)}},a.prototype.addEdge=function(h){this.insertEdge(h);var d=h.getCoordinates();this.insertPoint(this._argIndex,d[0],at.BOUNDARY),this.insertPoint(this._argIndex,d[d.length-1],at.BOUNDARY)},a.prototype.addLineString=function(h){var d=Y.removeRepeatedPoints(h.getCoordinates());if(d.length<2)return this._hasTooFewPoints=!0,this._invalidPoint=d[0],null;var w=new es(d,new ri(this._argIndex,at.INTERIOR));this._lineEdgeMap.put(h,w),this.insertEdge(w),$.isTrue(d.length>=2,"found LineString with single point"),this.insertBoundaryPoint(this._argIndex,d[0]),this.insertBoundaryPoint(this._argIndex,d[d.length-1])},a.prototype.getInvalidPoint=function(){return this._invalidPoint},a.prototype.getBoundaryPoints=function(){for(var h=this.getBoundaryNodes(),d=new Array(h.size()).fill(null),w=0,O=h.iterator();O.hasNext();){var k=O.next();d[w++]=k.getCoordinate().copy()}return d},a.prototype.getBoundaryNodes=function(){return null===this._boundaryNodes&&(this._boundaryNodes=this._nodes.getBoundaryNodes(this._argIndex)),this._boundaryNodes},a.prototype.addSelfIntersectionNode=function(h,d,w){if(this.isBoundaryNode(h,d))return null;w===at.BOUNDARY&&this._useBoundaryDeterminationRule?this.insertBoundaryPoint(h,d):this.insertPoint(h,d,w)},a.prototype.addPolygonRing=function(h,d,w){if(h.isEmpty())return null;var O=Y.removeRepeatedPoints(h.getCoordinates());if(O.length<4)return this._hasTooFewPoints=!0,this._invalidPoint=O[0],null;var k=d,W=w;Le.isCCW(O)&&(k=w,W=d);var mt=new es(O,new ri(this._argIndex,at.BOUNDARY,k,W));this._lineEdgeMap.put(h,mt),this.insertEdge(mt),this.insertPoint(this._argIndex,O[0],at.BOUNDARY)},a.prototype.insertPoint=function(h,d,w){var O=this._nodes.addNode(d),k=O.getLabel();null===k?O._label=new ri(h,w):k.setLocation(h,w)},a.prototype.createEdgeSetIntersector=function(){return new ii},a.prototype.addSelfIntersectionNodes=function(h){for(var d=this._edges.iterator();d.hasNext();)for(var w=d.next(),O=w.getLabel().getLocation(h),k=w.eiList.iterator();k.hasNext();){var W=k.next();this.addSelfIntersectionNode(h,W.coord,O)}},a.prototype.add=function(){if(1!==arguments.length)return n.prototype.add.apply(this,arguments);var h=arguments[0];if(h.isEmpty())return null;if(h instanceof on&&(this._useBoundaryDeterminationRule=!1),h instanceof cn)this.addPolygon(h);else if(h instanceof ir)this.addLineString(h);else if(h instanceof On)this.addPoint(h);else if(h instanceof gi)this.addCollection(h);else if(h instanceof nr)this.addCollection(h);else if(h instanceof on)this.addCollection(h);else{if(!(h instanceof Re))throw new Error(h.getClass().getName());this.addCollection(h)}},a.prototype.addCollection=function(h){for(var d=0;d<h.getNumGeometries();d++){var w=h.getGeometryN(d);this.add(w)}},a.prototype.locate=function(h){return Te(this._parentGeom,wn)&&this._parentGeom.getNumGeometries()>50?(null===this._areaPtLocator&&(this._areaPtLocator=new Ms(this._parentGeom)),this._areaPtLocator.locate(h)):this._ptLocator.locate(h,this._parentGeom)},a.prototype.findEdge=function(){return 1===arguments.length?this._lineEdgeMap.get(arguments[0]):n.prototype.findEdge.apply(this,arguments)},a.prototype.interfaces_=function(){return[]},a.prototype.getClass=function(){return a},a.determineBoundary=function(h,d){return h.isInBoundary(d)?at.BOUNDARY:at.INTERIOR},a}(hi),xa=function(){if(this._li=new Ee,this._resultPrecisionModel=null,this._arg=null,1===arguments.length){var n=arguments[0];this.setComputationPrecision(n.getPrecisionModel()),this._arg=new Array(1).fill(null),this._arg[0]=new ha(0,n)}else if(2===arguments.length){var a=arguments[0],h=arguments[1],d=Rn.OGC_SFS_BOUNDARY_RULE;a.getPrecisionModel().compareTo(h.getPrecisionModel())>=0?this.setComputationPrecision(a.getPrecisionModel()):this.setComputationPrecision(h.getPrecisionModel()),this._arg=new Array(2).fill(null),this._arg[0]=new ha(0,a,d),this._arg[1]=new ha(1,h,d)}else if(3===arguments.length){var w=arguments[0],O=arguments[1],k=arguments[2];w.getPrecisionModel().compareTo(O.getPrecisionModel())>=0?this.setComputationPrecision(w.getPrecisionModel()):this.setComputationPrecision(O.getPrecisionModel()),this._arg=new Array(2).fill(null),this._arg[0]=new ha(0,w,k),this._arg[1]=new ha(1,O,k)}};xa.prototype.getArgGeometry=function(n){return this._arg[n].getGeometry()},xa.prototype.setComputationPrecision=function(n){this._resultPrecisionModel=n,this._li.setPrecisionModel(this._resultPrecisionModel)},xa.prototype.interfaces_=function(){return[]},xa.prototype.getClass=function(){return xa};var so=function(){};so.prototype.interfaces_=function(){return[]},so.prototype.getClass=function(){return so},so.map=function(){if(arguments[0]instanceof sr&&Te(arguments[1],so.MapOp)){for(var n=arguments[0],a=arguments[1],h=new Je,d=0;d<n.getNumGeometries();d++){var w=a.map(n.getGeometryN(d));null!==w&&h.add(w)}return n.getFactory().buildGeometry(h)}if(Te(arguments[0],ei)&&Te(arguments[1],so.MapOp)){for(var O=arguments[0],k=arguments[1],W=new Je,mt=O.iterator();mt.hasNext();){var Gt=mt.next(),Ie=k.map(Gt);null!==Ie&&W.add(Ie)}return W}},so.MapOp=function(){};var Wr=function(n){function a(){var h=arguments[0];n.call(this,h,arguments[1]),this._ptLocator=new zo,this._geomFact=null,this._resultGeom=null,this._graph=null,this._edgeList=new _a,this._resultPolyList=new Je,this._resultLineList=new Je,this._resultPointList=new Je,this._graph=new hi(new Mc),this._geomFact=h.getFactory()}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.insertUniqueEdge=function(h){var d=this._edgeList.findEqualEdge(h);if(null!==d){var w=d.getLabel(),O=h.getLabel();d.isPointwiseEqual(h)||(O=new ri(h.getLabel())).flip();var k=d.getDepth();k.isNull()&&k.add(w),k.add(O),w.merge(O)}else this._edgeList.add(h)},a.prototype.getGraph=function(){return this._graph},a.prototype.cancelDuplicateResultEdges=function(){for(var h=this._graph.getEdgeEnds().iterator();h.hasNext();){var d=h.next(),w=d.getSym();d.isInResult()&&w.isInResult()&&(d.setInResult(!1),w.setInResult(!1))}},a.prototype.isCoveredByLA=function(h){return!!this.isCovered(h,this._resultLineList)||!!this.isCovered(h,this._resultPolyList)},a.prototype.computeGeometry=function(h,d,w,O){var k=new Je;return k.addAll(h),k.addAll(d),k.addAll(w),k.isEmpty()?a.createEmptyResult(O,this._arg[0].getGeometry(),this._arg[1].getGeometry(),this._geomFact):this._geomFact.buildGeometry(k)},a.prototype.mergeSymLabels=function(){for(var h=this._graph.getNodes().iterator();h.hasNext();)h.next().getEdges().mergeSymLabels()},a.prototype.isCovered=function(h,d){for(var w=d.iterator();w.hasNext();){var O=w.next();if(this._ptLocator.locate(h,O)!==at.EXTERIOR)return!0}return!1},a.prototype.replaceCollapsedEdges=function(){for(var h=new Je,d=this._edgeList.iterator();d.hasNext();){var w=d.next();w.isCollapsed()&&(d.remove(),h.add(w.getCollapsedEdge()))}this._edgeList.addAll(h)},a.prototype.updateNodeLabelling=function(){for(var h=this._graph.getNodes().iterator();h.hasNext();){var d=h.next(),w=d.getEdges().getLabel();d.getLabel().merge(w)}},a.prototype.getResultGeometry=function(h){return this.computeOverlay(h),this._resultGeom},a.prototype.insertUniqueEdges=function(h){for(var d=h.iterator();d.hasNext();){var w=d.next();this.insertUniqueEdge(w)}},a.prototype.computeOverlay=function(h){this.copyPoints(0),this.copyPoints(1),this._arg[0].computeSelfNodes(this._li,!1),this._arg[1].computeSelfNodes(this._li,!1),this._arg[0].computeEdgeIntersections(this._arg[1],this._li,!0);var d=new Je;this._arg[0].computeSplitEdges(d),this._arg[1].computeSplitEdges(d),this.insertUniqueEdges(d),this.computeLabelsFromDepths(),this.replaceCollapsedEdges(),os.checkValid(this._edgeList.getEdges()),this._graph.addEdges(this._edgeList.getEdges()),this.computeLabelling(),this.labelIncompleteNodes(),this.findResultAreaEdges(h),this.cancelDuplicateResultEdges();var w=new io(this._geomFact);w.add(this._graph),this._resultPolyList=w.getPolygons();var O=new ji(this,this._geomFact,this._ptLocator);this._resultLineList=O.build(h);var k=new ps(this,this._geomFact,this._ptLocator);this._resultPointList=k.build(h),this._resultGeom=this.computeGeometry(this._resultPointList,this._resultLineList,this._resultPolyList,h)},a.prototype.labelIncompleteNode=function(h,d){var w=this._ptLocator.locate(h.getCoordinate(),this._arg[d].getGeometry());h.getLabel().setLocation(d,w)},a.prototype.copyPoints=function(h){for(var d=this._arg[h].getNodeIterator();d.hasNext();){var w=d.next();this._graph.addNode(w.getCoordinate()).setLabel(h,w.getLabel().getLocation(h))}},a.prototype.findResultAreaEdges=function(h){for(var d=this._graph.getEdgeEnds().iterator();d.hasNext();){var w=d.next(),O=w.getLabel();O.isArea()&&!w.isInteriorAreaEdge()&&a.isResultOfOp(O.getLocation(0,Qe.RIGHT),O.getLocation(1,Qe.RIGHT),h)&&w.setInResult(!0)}},a.prototype.computeLabelsFromDepths=function(){for(var h=this._edgeList.iterator();h.hasNext();){var d=h.next(),w=d.getLabel(),O=d.getDepth();if(!O.isNull()){O.normalize();for(var k=0;k<2;k++)w.isNull(k)||!w.isArea()||O.isNull(k)||(0===O.getDelta(k)?w.toLine(k):($.isTrue(!O.isNull(k,Qe.LEFT),"depth of LEFT side has not been initialized"),w.setLocation(k,Qe.LEFT,O.getLocation(k,Qe.LEFT)),$.isTrue(!O.isNull(k,Qe.RIGHT),"depth of RIGHT side has not been initialized"),w.setLocation(k,Qe.RIGHT,O.getLocation(k,Qe.RIGHT))))}}},a.prototype.computeLabelling=function(){for(var h=this._graph.getNodes().iterator();h.hasNext();)h.next().getEdges().computeLabelling(this._arg);this.mergeSymLabels(),this.updateNodeLabelling()},a.prototype.labelIncompleteNodes=function(){for(var h=this._graph.getNodes().iterator();h.hasNext();){var d=h.next(),w=d.getLabel();d.isIsolated()&&(w.isNull(0)?this.labelIncompleteNode(d,0):this.labelIncompleteNode(d,1)),d.getEdges().updateLabelling(w)}},a.prototype.isCoveredByA=function(h){return!!this.isCovered(h,this._resultPolyList)},a.prototype.interfaces_=function(){return[]},a.prototype.getClass=function(){return a},a}(xa);Wr.overlayOp=function(n,a,h){return new Wr(n,a).getResultGeometry(h)},Wr.intersection=function(n,a){if(n.isEmpty()||a.isEmpty())return Wr.createEmptyResult(Wr.INTERSECTION,n,a,n.getFactory());if(n.isGeometryCollection()){var h=a;return Ua.map(n,{interfaces_:function(){return[so.MapOp]},map:function(d){return d.intersection(h)}})}return n.checkNotGeometryCollection(n),n.checkNotGeometryCollection(a),Fo.overlayOp(n,a,Wr.INTERSECTION)},Wr.symDifference=function(n,a){if(n.isEmpty()||a.isEmpty()){if(n.isEmpty()&&a.isEmpty())return Wr.createEmptyResult(Wr.SYMDIFFERENCE,n,a,n.getFactory());if(n.isEmpty())return a.copy();if(a.isEmpty())return n.copy()}return n.checkNotGeometryCollection(n),n.checkNotGeometryCollection(a),Fo.overlayOp(n,a,Wr.SYMDIFFERENCE)},Wr.resultDimension=function(n,a,h){var d=a.getDimension(),w=h.getDimension(),O=-1;switch(n){case Wr.INTERSECTION:O=Math.min(d,w);break;case Wr.UNION:O=Math.max(d,w);break;case Wr.DIFFERENCE:O=d;break;case Wr.SYMDIFFERENCE:O=Math.max(d,w)}return O},Wr.createEmptyResult=function(n,a,h,d){var w=null;switch(Wr.resultDimension(n,a,h)){case-1:w=d.createGeometryCollection(new Array(0).fill(null));break;case 0:w=d.createPoint();break;case 1:w=d.createLineString();break;case 2:w=d.createPolygon()}return w},Wr.difference=function(n,a){return n.isEmpty()?Wr.createEmptyResult(Wr.DIFFERENCE,n,a,n.getFactory()):a.isEmpty()?n.copy():(n.checkNotGeometryCollection(n),n.checkNotGeometryCollection(a),Fo.overlayOp(n,a,Wr.DIFFERENCE))},Wr.isResultOfOp=function(){if(2===arguments.length){var n=arguments[0],a=arguments[1],h=n.getLocation(0),d=n.getLocation(1);return Wr.isResultOfOp(h,d,a)}if(3===arguments.length){var w=arguments[0],O=arguments[1];switch(w===at.BOUNDARY&&(w=at.INTERIOR),O===at.BOUNDARY&&(O=at.INTERIOR),arguments[2]){case Wr.INTERSECTION:return w===at.INTERIOR&&O===at.INTERIOR;case Wr.UNION:return w===at.INTERIOR||O===at.INTERIOR;case Wr.DIFFERENCE:return w===at.INTERIOR&&O!==at.INTERIOR;case Wr.SYMDIFFERENCE:return w===at.INTERIOR&&O!==at.INTERIOR||w!==at.INTERIOR&&O===at.INTERIOR}return!1}},Wr.INTERSECTION=1,Wr.UNION=2,Wr.DIFFERENCE=3,Wr.SYMDIFFERENCE=4;var lu=function(){this._g=null,this._boundaryDistanceTolerance=null,this._linework=null,this._ptLocator=new zo,this._seg=new Fr;var n=arguments[0],a=arguments[1];this._g=n,this._boundaryDistanceTolerance=a,this._linework=this.extractLinework(n)};lu.prototype.isWithinToleranceOfBoundary=function(n){for(var a=0;a<this._linework.getNumGeometries();a++)for(var h=this._linework.getGeometryN(a).getCoordinateSequence(),d=0;d<h.size()-1;d++)if(h.getCoordinate(d,this._seg.p0),h.getCoordinate(d+1,this._seg.p1),this._seg.distance(n)<=this._boundaryDistanceTolerance)return!0;return!1},lu.prototype.getLocation=function(n){return this.isWithinToleranceOfBoundary(n)?at.BOUNDARY:this._ptLocator.locate(n,this._g)},lu.prototype.extractLinework=function(n){var a=new ss;n.apply(a);var h=a.getLinework(),d=en.toLineStringArray(h);return n.getFactory().createMultiLineString(d)},lu.prototype.interfaces_=function(){return[]},lu.prototype.getClass=function(){return lu};var ss=function(){this._linework=null,this._linework=new Je};ss.prototype.getLinework=function(){return this._linework},ss.prototype.filter=function(n){if(n instanceof cn){var a=n;this._linework.add(a.getExteriorRing());for(var h=0;h<a.getNumInteriorRing();h++)this._linework.add(a.getInteriorRingN(h))}},ss.prototype.interfaces_=function(){return[pr]},ss.prototype.getClass=function(){return ss};var Jn=function(){this._g=null,this._doLeft=!0,this._doRight=!0,this._g=arguments[0]};Jn.prototype.extractPoints=function(n,a,h){for(var d=n.getCoordinates(),w=0;w<d.length-1;w++)this.computeOffsetPoints(d[w],d[w+1],a,h)},Jn.prototype.setSidesToGenerate=function(n,a){this._doLeft=n,this._doRight=a},Jn.prototype.getPoints=function(n){for(var a=new Je,h=Hi.getLines(this._g).iterator();h.hasNext();){var d=h.next();this.extractPoints(d,n,a)}return a},Jn.prototype.computeOffsetPoints=function(n,a,h,d){var w=a.x-n.x,O=a.y-n.y,k=Math.sqrt(w*w+O*O),W=h*w/k,mt=h*O/k,Gt=(a.x+n.x)/2,Ie=(a.y+n.y)/2;if(this._doLeft){var Me=new j(Gt-mt,Ie+W);d.add(Me)}if(this._doRight){var Ke=new j(Gt+mt,Ie-W);d.add(Ke)}},Jn.prototype.interfaces_=function(){return[]},Jn.prototype.getClass=function(){return Jn};var oi=function n(){this._geom=null,this._locFinder=null,this._location=new Array(3).fill(null),this._invalidLocation=null,this._boundaryDistanceTolerance=n.TOLERANCE,this._testCoords=new Je;var a=arguments[0],h=arguments[1],d=arguments[2];this._boundaryDistanceTolerance=n.computeBoundaryDistanceTolerance(a,h),this._geom=[a,h,d],this._locFinder=[new lu(this._geom[0],this._boundaryDistanceTolerance),new lu(this._geom[1],this._boundaryDistanceTolerance),new lu(this._geom[2],this._boundaryDistanceTolerance)]},Zu={TOLERANCE:{configurable:!0}};oi.prototype.reportResult=function(n,a,h){Cr.out.println("Overlay result invalid - A:"+at.toLocationSymbol(a[0])+" B:"+at.toLocationSymbol(a[1])+" expected:"+(h?"i":"e")+" actual:"+at.toLocationSymbol(a[2]))},oi.prototype.isValid=function(n){return this.addTestPts(this._geom[0]),this.addTestPts(this._geom[1]),this.checkValid(n)},oi.prototype.checkValid=function(){if(1===arguments.length){for(var n=arguments[0],a=0;a<this._testCoords.size();a++){var h=this._testCoords.get(a);if(!this.checkValid(n,h))return this._invalidLocation=h,!1}return!0}if(2===arguments.length){var d=arguments[0],w=arguments[1];return this._location[0]=this._locFinder[0].getLocation(w),this._location[1]=this._locFinder[1].getLocation(w),this._location[2]=this._locFinder[2].getLocation(w),!!oi.hasLocation(this._location,at.BOUNDARY)||this.isValidResult(d,this._location)}},oi.prototype.addTestPts=function(n){var a=new Jn(n);this._testCoords.addAll(a.getPoints(5*this._boundaryDistanceTolerance))},oi.prototype.isValidResult=function(n,a){var h=Wr.isResultOfOp(a[0],a[1],n),d=!(h^a[2]===at.INTERIOR);return d||this.reportResult(n,a,h),d},oi.prototype.getInvalidLocation=function(){return this._invalidLocation},oi.prototype.interfaces_=function(){return[]},oi.prototype.getClass=function(){return oi},oi.hasLocation=function(n,a){for(var h=0;h<3;h++)if(n[h]===a)return!0;return!1},oi.computeBoundaryDistanceTolerance=function(n,a){return Math.min(Bi.computeSizeBasedSnapTolerance(n),Bi.computeSizeBasedSnapTolerance(a))},oi.isValid=function(n,a,h,d){return new oi(n,a,d).isValid(h)},Zu.TOLERANCE.get=function(){return 1e-6},Object.defineProperties(oi,Zu);var Io=function n(a){this._geomFactory=null,this._skipEmpty=!1,this._inputGeoms=null,this._geomFactory=n.extractFactory(a),this._inputGeoms=a};Io.prototype.extractElements=function(n,a){if(null===n)return null;for(var h=0;h<n.getNumGeometries();h++){var d=n.getGeometryN(h);this._skipEmpty&&d.isEmpty()||a.add(d)}},Io.prototype.combine=function(){for(var n=new Je,a=this._inputGeoms.iterator();a.hasNext();){var h=a.next();this.extractElements(h,n)}return 0===n.size()?null!==this._geomFactory?this._geomFactory.createGeometryCollection(null):null:this._geomFactory.buildGeometry(n)},Io.prototype.interfaces_=function(){return[]},Io.prototype.getClass=function(){return Io},Io.combine=function(){return 1===arguments.length?new Io(arguments[0]).combine():2===arguments.length?new Io(Io.createList(arguments[0],arguments[1])).combine():3===arguments.length?new Io(Io.createList(arguments[0],arguments[1],arguments[2])).combine():void 0},Io.extractFactory=function(n){return n.isEmpty()?null:n.iterator().next().getFactory()},Io.createList=function(){if(2===arguments.length){var n=arguments[0],a=arguments[1],h=new Je;return h.add(n),h.add(a),h}if(3===arguments.length){var d=arguments[0],w=arguments[1],O=arguments[2],k=new Je;return k.add(d),k.add(w),k.add(O),k}};var bi=function(){this._inputPolys=null,this._geomFactory=null,this._inputPolys=arguments[0],null===this._inputPolys&&(this._inputPolys=new Je)},qa={STRTREE_NODE_CAPACITY:{configurable:!0}};bi.prototype.reduceToGeometries=function(n){for(var a=new Je,h=n.iterator();h.hasNext();){var d=h.next(),w=null;Te(d,ki)?w=this.unionTree(d):d instanceof sr&&(w=d),a.add(w)}return a},bi.prototype.extractByEnvelope=function(n,a,h){for(var d=new Je,w=0;w<a.getNumGeometries();w++){var O=a.getGeometryN(w);O.getEnvelopeInternal().intersects(n)?d.add(O):h.add(O)}return this._geomFactory.buildGeometry(d)},bi.prototype.unionOptimized=function(n,a){var h=n.getEnvelopeInternal(),d=a.getEnvelopeInternal();if(!h.intersects(d))return Io.combine(n,a);if(n.getNumGeometries()<=1&&a.getNumGeometries()<=1)return this.unionActual(n,a);var w=h.intersection(d);return this.unionUsingEnvelopeIntersection(n,a,w)},bi.prototype.union=function(){if(null===this._inputPolys)throw new Error("union() method cannot be called twice");if(this._inputPolys.isEmpty())return null;this._geomFactory=this._inputPolys.iterator().next().getFactory();for(var n=new Jl(bi.STRTREE_NODE_CAPACITY),a=this._inputPolys.iterator();a.hasNext();){var h=a.next();n.insert(h.getEnvelopeInternal(),h)}this._inputPolys=null;var d=n.itemsTree();return this.unionTree(d)},bi.prototype.binaryUnion=function(){if(1===arguments.length){var n=arguments[0];return this.binaryUnion(n,0,n.size())}if(3===arguments.length){var a=arguments[0],h=arguments[1],d=arguments[2];if(d-h<=1){var w=bi.getGeometry(a,h);return this.unionSafe(w,null)}if(d-h==2)return this.unionSafe(bi.getGeometry(a,h),bi.getGeometry(a,h+1));var O=Math.trunc((d+h)/2),k=this.binaryUnion(a,h,O),W=this.binaryUnion(a,O,d);return this.unionSafe(k,W)}},bi.prototype.repeatedUnion=function(n){for(var a=null,h=n.iterator();h.hasNext();){var d=h.next();a=null===a?d.copy():a.union(d)}return a},bi.prototype.unionSafe=function(n,a){return null===n&&null===a?null:null===n?a.copy():null===a?n.copy():this.unionOptimized(n,a)},bi.prototype.unionActual=function(n,a){return bi.restrictToPolygons(n.union(a))},bi.prototype.unionTree=function(n){var a=this.reduceToGeometries(n);return this.binaryUnion(a)},bi.prototype.unionUsingEnvelopeIntersection=function(n,a,h){var d=new Je,w=this.extractByEnvelope(h,n,d),O=this.extractByEnvelope(h,a,d),k=this.unionActual(w,O);return d.add(k),Io.combine(d)},bi.prototype.bufferUnion=function(){if(1===arguments.length){var n=arguments[0];return n.get(0).getFactory().buildGeometry(n).buffer(0)}if(2===arguments.length){var a=arguments[0],h=arguments[1];return a.getFactory().createGeometryCollection([a,h]).buffer(0)}},bi.prototype.interfaces_=function(){return[]},bi.prototype.getClass=function(){return bi},bi.restrictToPolygons=function(n){if(Te(n,wn))return n;var a=Fa.getPolygons(n);return 1===a.size()?a.get(0):n.getFactory().createMultiPolygon(en.toPolygonArray(a))},bi.getGeometry=function(n,a){return a>=n.size()?null:n.get(a)},bi.union=function(n){return new bi(n).union()},qa.STRTREE_NODE_CAPACITY.get=function(){return 4},Object.defineProperties(bi,qa);var Hs=function(){};Hs.prototype.interfaces_=function(){return[]},Hs.prototype.getClass=function(){return Hs},Hs.union=function(n,a){if(n.isEmpty()||a.isEmpty()){if(n.isEmpty()&&a.isEmpty())return Wr.createEmptyResult(Wr.UNION,n,a,n.getFactory());if(n.isEmpty())return a.copy();if(a.isEmpty())return n.copy()}return n.checkNotGeometryCollection(n),n.checkNotGeometryCollection(a),Fo.overlayOp(n,a,Wr.UNION)},wt.GeoJSONReader=Lo,wt.GeoJSONWriter=bo,wt.OverlayOp=Wr,wt.UnionOp=Hs,wt.BufferOp=Ro,Object.defineProperty(wt,"__esModule",{value:!0})}(pe)},6562:(He,pe,wt)=>{"use strict";wt.r(pe),wt.d(pe,{ObservationModule:()=>J_});var yt=wt(8002),b=wt(7716),v=wt(5072),Bt=wt(5987),ft=wt(6215);let St=(()=>{class r{constructor(){this._initialState={geometry:{},inState:!0},this._observation=new ft.X(this._initialState)}getObservation(){return this._observation.asObservable()}updateObservation(e){return this._observation.next(Object.assign({},e)),this.getObservation()}resetObservation(){return this._observation.next(Object.assign({},this._initialState)),this.getObservation()}}return r.\u0275fac=function(e){return new(e||r)},r.\u0275prov=b.Yz7({token:r,factory:r.\u0275fac,providedIn:"root"}),r})();var Ft=wt(7832),le=wt(5257),kt=wt(1954);let Ze=(()=>{class r{}return r.LocationHelperText="Use the map below to draw a point at the location at which the observation you wish to report was made.",r.ContactHelperText="Please complete the following fields below for your observation report. Providing contact information will enable the Game Commission to contact you should they need to discuss your observation.",r.AnimalHelperText="Please complete all of the following fields below in order to proceed with your observation report. Fish, amphibian, or reptile observations should be directed to the Pennsylvania Fish and Boat Commission (provide URL link or phone number).",r.PhotosHelperText="Optionally, upload photos and/or videos of your observation.  Combined photos/videos cannot exceed 25MB.",r.RabiesPopup="Signs that an animal might have rabies: aggressive behavior, drooling, lack of fear of humans, walking in circles or otherwise appearing disoriented, biting or chewing on itself. These signs may also occur with other diseases.",r.CaptivePopup="Captive - animal is usually kept inside an enclosure and is there now or may have escaped, Free-Ranging Wild - the animal is not contained and does not appear to have escaped from captivity.",r.PoachingPopup='<p>The illegal shooting or taking of big game or protected, endangered or threatened species, or any crime against those species should be reported through Operation Game Thief</p> <p>(1-888-PGC-8001)</p> <p><a href="https://www.pgc.pa.gov/HuntTrap/Law/Pages/OperationGameThief.aspx" target="_blank">Operation Game Thief Website</a></p>',r.UploadTooLarge="Your files are too large.  Please make sure they do not exceed 25MB.",r.UploadWrongType="Some or all of your files did not upload due to an incorrect file type.",r})();var ye=wt(1769);let ue=(()=>{class r{constructor(){this.header="",this.content=""}}return r.\u0275fac=function(e){return new(e||r)},r.\u0275cmp=b.Xpm({type:r,selectors:[["app-intro-helper-text"]],inputs:{header:"header",content:"content"},decls:6,vars:2,consts:[[1,"appHelperContainer"],[1,"appHelperHeader","appHelperText"],[1,"appHelperContent","appHelperText"]],template:function(e,s){1&e&&(b.TgZ(0,"div",0),b.TgZ(1,"h2",1),b._uU(2),b.qZA(),b._UZ(3,"mat-divider"),b.TgZ(4,"div",2),b._uU(5),b.qZA(),b.qZA()),2&e&&(b.xp6(2),b.Oqu(s.header),b.xp6(3),b.hij(" ",s.content," "))},directives:[ye.d],styles:[".appHelperContainer[_ngcontent-%COMP%]{margin-top:1rem}.appHelperText[_ngcontent-%COMP%]{color:#434343;font-size:1.125rem}.appHelperHeader[_ngcontent-%COMP%]{font-weight:800;line-height:2.625rem;margin-bottom:0}.appHelperContent[_ngcontent-%COMP%]{font-weight:400;line-height:1.5rem;margin-bottom:.5rem}"]}),r})();var de=wt(4347),Ye=wt(2340);let qt=(()=>{class r{}return r.PointPaintStyle={"circle-radius":10,"circle-color":"#ff2218","circle-opacity":.75,"circle-stroke-width":2,"circle-stroke-color":"#3E0000"},r})();function bt(r,o,e){void 0===e&&(e={});var s={type:"Feature"};return(0===e.id||e.id)&&(s.id=e.id),e.bbox&&(s.bbox=e.bbox),s.properties=o||{},s.geometry=r,s}function tt(r,o,e){if(void 0===e&&(e={}),!r)throw new Error("coordinates is required");if(!Array.isArray(r))throw new Error("coordinates must be an Array");if(r.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!Er(r[0])||!Er(r[1]))throw new Error("coordinates must contain numbers");return bt({type:"Point",coordinates:r},o,e)}function j(r,o,e){void 0===e&&(e={});for(var s=0,f=r;s<f.length;s++){var m=f[s];if(m.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var x=0;x<m[m.length-1].length;x++)if(m[m.length-1][x]!==m[0][x])throw new Error("First and last Position are not equivalent.")}return bt({type:"Polygon",coordinates:r},o,e)}function xt(r,o,e){if(void 0===e&&(e={}),r.length<2)throw new Error("coordinates must be an array of two or more positions");return bt({type:"LineString",coordinates:r},o,e)}function at(r,o){void 0===o&&(o={});var e={type:"FeatureCollection"};return o.id&&(e.id=o.id),o.bbox&&(e.bbox=o.bbox),e.features=r,e}function Er(r){return!isNaN(r)&&null!==r&&!Array.isArray(r)}function ti(r){if(Array.isArray(r))return r;if("Feature"===r.type){if(null!==r.geometry)return r.geometry.coordinates}else if(r.coordinates)return r.coordinates;throw new Error("coords must be GeoJSON Feature, Geometry Object or an Array")}function ae(r){return"Feature"===r.type?r.geometry:r}function rt(r,o,e){if(void 0===e&&(e={}),!r)throw new Error("point is required");if(!o)throw new Error("polygon is required");var s=function(r){if(!r)throw new Error("coord is required");if(!Array.isArray(r)){if("Feature"===r.type&&null!==r.geometry&&"Point"===r.geometry.type)return r.geometry.coordinates;if("Point"===r.type)return r.coordinates}if(Array.isArray(r)&&r.length>=2&&!Array.isArray(r[0])&&!Array.isArray(r[1]))return r;throw new Error("coord must be GeoJSON Point or an Array of numbers")}(r),f=ae(o),m=f.type,x=o.bbox,I=f.coordinates;if(x&&!1===function(r,o){return o[0]<=r[0]&&o[1]<=r[1]&&o[2]>=r[0]&&o[3]>=r[1]}(s,x))return!1;"Polygon"===m&&(I=[I]);for(var M=!1,S=0;S<I.length&&!M;S++)if($(s,I[S][0],e.ignoreBoundary)){for(var D=!1,R=1;R<I[S].length&&!D;)$(s,I[S][R],!e.ignoreBoundary)&&(D=!0),R++;D||(M=!0)}return M}function $(r,o,e){var s=!1;o[0][0]===o[o.length-1][0]&&o[0][1]===o[o.length-1][1]&&(o=o.slice(0,o.length-1));for(var f=0,m=o.length-1;f<o.length;m=f++){var x=o[f][0],I=o[f][1],M=o[m][0],S=o[m][1];if(r[1]*(x-M)+I*(M-r[0])+S*(r[0]-x)==0&&(x-r[0])*(M-r[0])<=0&&(I-r[1])*(S-r[1])<=0)return!e;I>r[1]!=S>r[1]&&r[0]<(M-x)*(r[1]-I)/(S-I)+x&&(s=!s)}return s}function Jt(r,o,e){if(null!==r)for(var s,f,m,x,I,M,S,N,D=0,R=0,B=r.type,Ct="FeatureCollection"===B,pt="Feature"===B,$t=Ct?r.features.length:1,Nt=0;Nt<$t;Nt++){I=(N=!!(S=Ct?r.features[Nt].geometry:pt?r.geometry:r)&&"GeometryCollection"===S.type)?S.geometries.length:1;for(var dt=0;dt<I;dt++){var At=0,se=0;if(null!==(x=N?S.geometries[dt]:S)){M=x.coordinates;var oe=x.type;switch(D=!e||"Polygon"!==oe&&"MultiPolygon"!==oe?0:1,oe){case null:break;case"Point":if(!1===o(M,R,Nt,At,se))return!1;R++,At++;break;case"LineString":case"MultiPoint":for(s=0;s<M.length;s++){if(!1===o(M[s],R,Nt,At,se))return!1;R++,"MultiPoint"===oe&&At++}"LineString"===oe&&At++;break;case"Polygon":case"MultiLineString":for(s=0;s<M.length;s++){for(f=0;f<M[s].length-D;f++){if(!1===o(M[s][f],R,Nt,At,se))return!1;R++}"MultiLineString"===oe&&At++,"Polygon"===oe&&se++}"Polygon"===oe&&At++;break;case"MultiPolygon":for(s=0;s<M.length;s++){for(se=0,f=0;f<M[s].length;f++){for(m=0;m<M[s][f].length-D;m++){if(!1===o(M[s][f][m],R,Nt,At,se))return!1;R++}se++}At++}break;case"GeometryCollection":for(s=0;s<x.geometries.length;s++)if(!1===Jt(x.geometries[s],o,e))return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function Le(r,o){if("Feature"===r.type)o(r,0);else if("FeatureCollection"===r.type)for(var e=0;e<r.features.length&&!1!==o(r.features[e],e);e++);}function Bn(r,o){!function(r,o){var e,s,f,m,x,I,M,S,D,R,N=0,B="FeatureCollection"===r.type,Ct="Feature"===r.type,pt=B?r.features.length:1;for(e=0;e<pt;e++){for(S=B?r.features[e].properties:Ct?r.properties:{},D=B?r.features[e].bbox:Ct?r.bbox:void 0,R=B?r.features[e].id:Ct?r.id:void 0,x=(M=!!(I=B?r.features[e].geometry:Ct?r.geometry:r)&&"GeometryCollection"===I.type)?I.geometries.length:1,f=0;f<x;f++)if(null!==(m=M?I.geometries[f]:I))switch(m.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":if(!1===o(m,N,S,D,R))return!1;break;case"GeometryCollection":for(s=0;s<m.geometries.length;s++)if(!1===o(m.geometries[s],N,S,D,R))return!1;break;default:throw new Error("Unknown Geometry Type")}else if(!1===o(null,N,S,D,R))return!1;N++}}(r,function(e,s,f,m,x){var M,I=null===e?null:e.type;switch(I){case null:case"Point":case"LineString":case"Polygon":return!1!==o(bt(e,f,{bbox:m,id:x}),s,0)&&void 0}switch(I){case"MultiPoint":M="Point";break;case"MultiLineString":M="LineString";break;case"MultiPolygon":M="Polygon"}for(var S=0;S<e.coordinates.length;S++)if(!1===o(bt({type:M,coordinates:e.coordinates[S]},f),s,S))return!1})}const di=function(r){if(!r)throw new Error("geojson is required");var o=[];return Bn(r,function(e){!function(r,o){var e=[],s=r.geometry;if(null!==s){switch(s.type){case"Polygon":e=ti(s);break;case"LineString":e=[ti(s)]}e.forEach(function(f){(function(r,o){var e=[];return r.reduce(function(s,f){var m=xt([s,f],o);return m.bbox=function(r,o){var e=r[0],s=r[1],f=o[0],m=o[1];return[e<f?e:f,s<m?s:m,e>f?e:f,s>m?s:m]}(s,f),e.push(m),f}),e})(f,r.properties).forEach(function(x){x.id=o.length,o.push(x)})})}}(e,o)}),at(o)};var V=wt(2689);function it(r,o){var e=ti(r),s=ti(o);if(2!==e.length)throw new Error("<intersects> line1 must only contain 2 coordinates");if(2!==s.length)throw new Error("<intersects> line2 must only contain 2 coordinates");var f=e[0][0],m=e[0][1],x=e[1][0],I=e[1][1],M=s[0][0],S=s[0][1],D=s[1][0],R=s[1][1],N=(R-S)*(x-f)-(D-M)*(I-m);if(0===N)return null;var pt=((D-M)*(m-S)-(R-S)*(f-M))/N,$t=((x-f)*(m-S)-(I-m)*(f-M))/N;return pt>=0&&pt<=1&&$t>=0&&$t<=1?tt([f+pt*(x-f),m+pt*(I-m)]):null}const ht=function(r,o){var e={},s=[];if("LineString"===r.type&&(r=bt(r)),"LineString"===o.type&&(o=bt(o)),"Feature"===r.type&&"Feature"===o.type&&null!==r.geometry&&null!==o.geometry&&"LineString"===r.geometry.type&&"LineString"===o.geometry.type&&2===r.geometry.coordinates.length&&2===o.geometry.coordinates.length){var f=it(r,o);return f&&s.push(f),at(s)}var m=V();return m.load(di(o)),Le(di(r),function(x){Le(m.search(x),function(I){var M=it(x,I);if(M){var S=ti(M).join(",");e[S]||(e[S]=!0,s.push(M))}})}),at(s)};function Lt(r,o){void 0===o&&(o={});var e=ae(r);switch(!o.properties&&"Feature"===r.type&&(o.properties=r.properties),e.type){case"Polygon":return function(r,o){return void 0===o&&(o={}),Ht(ae(r).coordinates,o.properties?o.properties:"Feature"===r.type?r.properties:{})}(e,o);case"MultiPolygon":return function(r,o){void 0===o&&(o={});var e=ae(r),f=o.properties?o.properties:"Feature"===r.type?r.properties:{},m=[];return e.coordinates.forEach(function(x){m.push(Ht(x,f))}),at(m)}(e,o);default:throw new Error("invalid poly")}}function Ht(r,o){return r.length>1?function(r,o,e){return void 0===e&&(e={}),bt({type:"MultiLineString",coordinates:r},o,e)}(r,o):xt(r[0],o)}function je(r,o){for(var e=0;e<r.coordinates.length-1;e++)if(cr(r.coordinates[e],r.coordinates[e+1],o.coordinates))return!0;return!1}function ge(r,o){for(var e=0,s=o.coordinates;e<s.length;e++)if(rt(s[e],r))return!0;return ht(o,Lt(r)).features.length>0}function cr(r,o,e){var m=o[0]-r[0],x=o[1]-r[1];return 0==(e[0]-r[0])*x-(e[1]-r[1])*m&&(Math.abs(m)>=Math.abs(x)?m>0?r[0]<=e[0]&&e[0]<=o[0]:o[0]<=e[0]&&e[0]<=r[0]:x>0?r[1]<=e[1]&&e[1]<=o[1]:o[1]<=e[1]&&e[1]<=r[1])}function nr(r){var o=[1/0,1/0,-1/0,-1/0];return Jt(r,function(e){o[0]>e[0]&&(o[0]=e[0]),o[1]>e[1]&&(o[1]=e[1]),o[2]<e[0]&&(o[2]=e[0]),o[3]<e[1]&&(o[3]=e[1])}),o}nr.default=nr;const Ue=nr;wt(8228),wt(6896);var tu=new ArrayBuffer(16);new Float64Array(tu),new Uint32Array(tu),wt(5454),function(){function r(o){this.points=o.points||[],this.duration=o.duration||1e4,this.sharpness=o.sharpness||.85,this.centers=[],this.controls=[],this.stepLength=o.stepLength||60,this.length=this.points.length,this.delay=0;for(var e=0;e<this.length;e++)this.points[e].z=this.points[e].z||0;for(e=0;e<this.length-1;e++){var s=this.points[e],f=this.points[e+1];this.centers.push({x:(s.x+f.x)/2,y:(s.y+f.y)/2,z:(s.z+f.z)/2})}for(this.controls.push([this.points[0],this.points[0]]),e=0;e<this.centers.length-1;e++){var m=this.points[e+1].x-(this.centers[e].x+this.centers[e+1].x)/2,x=this.points[e+1].y-(this.centers[e].y+this.centers[e+1].y)/2,I=this.points[e+1].z-(this.centers[e].y+this.centers[e+1].z)/2;this.controls.push([{x:(1-this.sharpness)*this.points[e+1].x+this.sharpness*(this.centers[e].x+m),y:(1-this.sharpness)*this.points[e+1].y+this.sharpness*(this.centers[e].y+x),z:(1-this.sharpness)*this.points[e+1].z+this.sharpness*(this.centers[e].z+I)},{x:(1-this.sharpness)*this.points[e+1].x+this.sharpness*(this.centers[e+1].x+m),y:(1-this.sharpness)*this.points[e+1].y+this.sharpness*(this.centers[e+1].y+x),z:(1-this.sharpness)*this.points[e+1].z+this.sharpness*(this.centers[e+1].z+I)}])}return this.controls.push([this.points[this.length-1],this.points[this.length-1]]),this.steps=this.cacheSteps(this.stepLength),this}r.prototype.cacheSteps=function(o){var e=[],s=this.pos(0);e.push(0);for(var f=0;f<this.duration;f+=10){var m=this.pos(f);Math.sqrt((m.x-s.x)*(m.x-s.x)+(m.y-s.y)*(m.y-s.y)+(m.z-s.z)*(m.z-s.z))>o&&(e.push(f),s=m)}return e},r.prototype.vector=function(o){var e=this.pos(o+10),s=this.pos(o-10);return{angle:180*Math.atan2(e.y-s.y,e.x-s.x)/3.14,speed:Math.sqrt((s.x-e.x)*(s.x-e.x)+(s.y-e.y)*(s.y-e.y)+(s.z-e.z)*(s.z-e.z))}},r.prototype.pos=function(o){var e=o-this.delay;e<0&&(e=0),e>this.duration&&(e=this.duration-1);var s=e/this.duration;if(s>=1)return this.points[this.length-1];var f=Math.floor((this.points.length-1)*s);return function(r,o,e,s,f){var m=function(r){var o=r*r;return[o*r,3*o*(1-r),3*r*(1-r)*(1-r),(1-r)*(1-r)*(1-r)]}(r);return{x:f.x*m[0]+s.x*m[1]+e.x*m[2]+o.x*m[3],y:f.y*m[0]+s.y*m[1]+e.y*m[2]+o.y*m[3],z:f.z*m[0]+s.z*m[1]+e.z*m[2]+o.z*m[3]}}((this.length-1)*s-f,this.points[f],this.controls[f][1],this.controls[f+1][0],this.points[f+1])}}();wt(1604),wt(8309);var yr=Math.PI/180,jr=180/Math.PI,Ki=function(r,o){this.lon=r,this.lat=o,this.x=yr*r,this.y=yr*o};Ki.prototype.view=function(){return String(this.lon).slice(0,4)+","+String(this.lat).slice(0,4)},Ki.prototype.antipode=function(){return new Ki(this.lon<0?180+this.lon:-1*(180-this.lon),-1*this.lat)};var ha=function(){this.coords=[],this.length=0};ha.prototype.move_to=function(r){this.length++,this.coords.push(r)};var xa=function(r){this.properties=r||{},this.geometries=[]};xa.prototype.json=function(){if(this.geometries.length<=0)return{geometry:{type:"LineString",coordinates:null},type:"Feature",properties:this.properties};if(1===this.geometries.length)return{geometry:{type:"LineString",coordinates:this.geometries[0].coords},type:"Feature",properties:this.properties};for(var r=[],o=0;o<this.geometries.length;o++)r.push(this.geometries[o].coords);return{geometry:{type:"MultiLineString",coordinates:r},type:"Feature",properties:this.properties}},xa.prototype.wkt=function(){for(var r="",o="LINESTRING(",e=function(m){o+=m[0]+" "+m[1]+","},s=0;s<this.geometries.length;s++){if(0===this.geometries[s].coords.length)return"LINESTRING(empty)";this.geometries[s].coords.forEach(e),r+=o.substring(0,o.length-1)+")"}return r};var so=function(r,o,e){if(!r||void 0===r.x||void 0===r.y)throw new Error("GreatCircle constructor expects two args: start and end objects with x and y properties");if(!o||void 0===o.x||void 0===o.y)throw new Error("GreatCircle constructor expects two args: start and end objects with x and y properties");this.start=new Ki(r.x,r.y),this.end=new Ki(o.x,o.y),this.properties=e||{};var s=this.start.x-this.end.x,m=Math.pow(Math.sin((this.start.y-this.end.y)/2),2)+Math.cos(this.start.y)*Math.cos(this.end.y)*Math.pow(Math.sin(s/2),2);if(this.g=2*Math.asin(Math.sqrt(m)),this.g===Math.PI)throw new Error("it appears "+r.view()+" and "+o.view()+" are 'antipodal', e.g diametrically opposite, thus there is no single route but rather infinite");if(isNaN(this.g))throw new Error("could not calculate great circle between "+r+" and "+o)};so.prototype.interpolate=function(r){var o=Math.sin((1-r)*this.g)/Math.sin(this.g),e=Math.sin(r*this.g)/Math.sin(this.g),s=o*Math.cos(this.start.y)*Math.cos(this.start.x)+e*Math.cos(this.end.y)*Math.cos(this.end.x),f=o*Math.cos(this.start.y)*Math.sin(this.start.x)+e*Math.cos(this.end.y)*Math.sin(this.end.x),m=o*Math.sin(this.start.y)+e*Math.sin(this.end.y),x=jr*Math.atan2(m,Math.sqrt(Math.pow(s,2)+Math.pow(f,2)));return[jr*Math.atan2(f,s),x]},so.prototype.Arc=function(r,o){var e=[];if(!r||r<=2)e.push([this.start.lon,this.start.lat]),e.push([this.end.lon,this.end.lat]);else for(var s=1/(r-1),f=0;f<r;++f){var x=this.interpolate(s*f);e.push(x)}for(var I=!1,M=0,S=o&&o.offset?o.offset:10,D=180-S,R=-180+S,N=360-S,B=1;B<e.length;++B){var Ct=e[B-1][0],pt=e[B][0],$t=Math.abs(pt-Ct);$t>N&&(pt>D&&Ct<R||Ct>D&&pt<R)?I=!0:$t>M&&(M=$t)}var Nt=[];if(I&&M<S){var dt=[];Nt.push(dt);for(var At=0;At<e.length;++At){var se=parseFloat(e[At][0]);if(At>0&&Math.abs(se-e[At-1][0])>N){var oe=parseFloat(e[At-1][0]),xe=parseFloat(e[At-1][1]),me=parseFloat(e[At][0]),Ae=parseFloat(e[At][1]);if(oe>-180&&oe<R&&180===me&&At+1<e.length&&e[At-1][0]>-180&&e[At-1][0]<R){dt.push([-180,e[At][1]]),At++,dt.push([e[At][0],e[At][1]]);continue}if(oe>D&&oe<180&&-180===me&&At+1<e.length&&e[At-1][0]>D&&e[At-1][0]<180){dt.push([180,e[At][1]]),At++,dt.push([e[At][0],e[At][1]]);continue}if(oe<R&&me>D){var jt=oe;oe=me,me=jt;var yn=xe;xe=Ae,Ae=yn}if(oe>D&&me<R&&(me+=360),oe<=180&&me>=180&&oe<me){var Br=(180-oe)/(me-oe),Ln=Br*Ae+(1-Br)*xe;dt.push([e[At-1][0]>D?180:-180,Ln]),(dt=[]).push([e[At-1][0]>D?-180:180,Ln]),Nt.push(dt)}else Nt.push(dt=[]);dt.push([se,e[At][1]])}else dt.push([e[At][0],e[At][1]])}}else{var Zn=[];Nt.push(Zn);for(var br=0;br<e.length;++br)Zn.push([e[br][0],e[br][1]])}for(var dn=new xa(this.properties),Jr=0;Jr<Nt.length;++Jr){var zi=new ha;dn.geometries.push(zi);for(var Ti=Nt[Jr],Qn=0;Qn<Ti.length;++Qn)zi.move_to(Ti[Qn])}return dn},wt(2978);var qe=[],ze=[],Ve=[],$e=[],rr=[],tr=[],Dr=[],Xe=[],vr=[],Pr=[],_r=[],mr=[],fr=[],hr=[],or=[],qr=[],Kr=[],pn=[],rn=[],nn=[],Qr=[],hn=[],Sn=[],fn=[];Dr[85]=Pr[85]=-1,Xe[85]=_r[85]=0,vr[85]=mr[85]=1,rn[85]=hn[85]=1,nn[85]=Sn[85]=0,Qr[85]=fn[85]=1,qe[85]=$e[85]=0,ze[85]=rr[85]=-1,Ve[85]=or[85]=0,qr[85]=fr[85]=0,Kr[85]=hr[85]=1,tr[85]=pn[85]=1,hn[1]=hn[169]=0,Sn[1]=Sn[169]=-1,fn[1]=fn[169]=0,fr[1]=fr[169]=-1,hr[1]=hr[169]=0,or[1]=or[169]=0,Pr[4]=Pr[166]=0,_r[4]=_r[166]=-1,mr[4]=mr[166]=1,qr[4]=qr[166]=1,Kr[4]=Kr[166]=0,pn[4]=pn[166]=0,Dr[16]=Dr[154]=0,Xe[16]=Xe[154]=1,vr[16]=vr[154]=1,$e[16]=$e[154]=1,rr[16]=rr[154]=0,tr[16]=tr[154]=1,rn[64]=rn[106]=0,nn[64]=nn[106]=1,Qr[64]=Qr[106]=0,qe[64]=qe[106]=-1,ze[64]=ze[106]=0,Ve[64]=Ve[106]=1,rn[2]=rn[168]=0,nn[2]=nn[168]=-1,Qr[2]=Qr[168]=1,hn[2]=hn[168]=0,Sn[2]=Sn[168]=-1,fn[2]=fn[168]=0,fr[2]=fr[168]=-1,hr[2]=hr[168]=0,or[2]=or[168]=0,qr[2]=qr[168]=-1,Kr[2]=Kr[168]=0,pn[2]=pn[168]=1,Dr[8]=Dr[162]=0,Xe[8]=Xe[162]=-1,vr[8]=vr[162]=0,Pr[8]=Pr[162]=0,_r[8]=_r[162]=-1,mr[8]=mr[162]=1,fr[8]=fr[162]=1,hr[8]=hr[162]=0,or[8]=or[162]=1,qr[8]=qr[162]=1,Kr[8]=Kr[162]=0,pn[8]=pn[162]=0,Dr[32]=Dr[138]=0,Xe[32]=Xe[138]=1,vr[32]=vr[138]=1,Pr[32]=Pr[138]=0,_r[32]=_r[138]=1,mr[32]=mr[138]=0,qe[32]=qe[138]=1,ze[32]=ze[138]=0,Ve[32]=Ve[138]=0,$e[32]=$e[138]=1,rr[32]=rr[138]=0,tr[32]=tr[138]=1,hn[128]=hn[42]=0,Sn[128]=Sn[42]=1,fn[128]=fn[42]=1,rn[128]=rn[42]=0,nn[128]=nn[42]=1,Qr[128]=Qr[42]=0,qe[128]=qe[42]=-1,ze[128]=ze[42]=0,Ve[128]=Ve[42]=1,$e[128]=$e[42]=-1,rr[128]=rr[42]=0,tr[128]=tr[42]=0,Pr[5]=Pr[165]=-1,_r[5]=_r[165]=0,mr[5]=mr[165]=0,hn[5]=hn[165]=1,Sn[5]=Sn[165]=0,fn[5]=fn[165]=0,qr[20]=qr[150]=0,Kr[20]=Kr[150]=1,pn[20]=pn[150]=1,$e[20]=$e[150]=0,rr[20]=rr[150]=-1,tr[20]=tr[150]=1,Dr[80]=Dr[90]=-1,Xe[80]=Xe[90]=0,vr[80]=vr[90]=1,rn[80]=rn[90]=1,nn[80]=nn[90]=0,Qr[80]=Qr[90]=1,fr[65]=fr[105]=0,hr[65]=hr[105]=1,or[65]=or[105]=0,qe[65]=qe[105]=0,ze[65]=ze[105]=-1,Ve[65]=Ve[105]=0,Dr[160]=Dr[10]=-1,Xe[160]=Xe[10]=0,vr[160]=vr[10]=1,Pr[160]=Pr[10]=-1,_r[160]=_r[10]=0,mr[160]=mr[10]=0,hn[160]=hn[10]=1,Sn[160]=Sn[10]=0,fn[160]=fn[10]=0,rn[160]=rn[10]=1,nn[160]=nn[10]=0,Qr[160]=Qr[10]=1,qr[130]=qr[40]=0,Kr[130]=Kr[40]=1,pn[130]=pn[40]=1,fr[130]=fr[40]=0,hr[130]=hr[40]=1,or[130]=or[40]=0,qe[130]=qe[40]=0,ze[130]=ze[40]=-1,Ve[130]=Ve[40]=0,$e[130]=$e[40]=0,rr[130]=rr[40]=-1,tr[130]=tr[40]=1,Pr[37]=Pr[133]=0,_r[37]=_r[133]=1,mr[37]=mr[133]=1,hn[37]=hn[133]=0,Sn[37]=Sn[133]=1,fn[37]=fn[133]=0,qe[37]=qe[133]=-1,ze[37]=ze[133]=0,Ve[37]=Ve[133]=0,$e[37]=$e[133]=1,rr[37]=rr[133]=0,tr[37]=tr[133]=0,qr[148]=qr[22]=-1,Kr[148]=Kr[22]=0,pn[148]=pn[22]=0,hn[148]=hn[22]=0,Sn[148]=Sn[22]=-1,fn[148]=fn[22]=1,rn[148]=rn[22]=0,nn[148]=nn[22]=1,Qr[148]=Qr[22]=1,$e[148]=$e[22]=-1,rr[148]=rr[22]=0,tr[148]=tr[22]=1,Dr[82]=Dr[88]=0,Xe[82]=Xe[88]=-1,vr[82]=vr[88]=1,qr[82]=qr[88]=1,Kr[82]=Kr[88]=0,pn[82]=pn[88]=1,fr[82]=fr[88]=-1,hr[82]=hr[88]=0,or[82]=or[88]=1,rn[82]=rn[88]=0,nn[82]=nn[88]=-1,Qr[82]=Qr[88]=0,Dr[73]=Dr[97]=0,Xe[73]=Xe[97]=1,vr[73]=vr[97]=0,Pr[73]=Pr[97]=0,_r[73]=_r[97]=-1,mr[73]=mr[97]=0,fr[73]=fr[97]=1,hr[73]=hr[97]=0,or[73]=or[97]=0,qe[73]=qe[97]=1,ze[73]=ze[97]=0,Ve[73]=Ve[97]=1,Dr[145]=Dr[25]=0,Xe[145]=Xe[25]=-1,vr[145]=vr[25]=0,fr[145]=fr[25]=1,hr[145]=hr[25]=0,or[145]=or[25]=1,hn[145]=hn[25]=0,Sn[145]=Sn[25]=1,fn[145]=fn[25]=1,$e[145]=$e[25]=-1,rr[145]=rr[25]=0,tr[145]=tr[25]=0,Pr[70]=Pr[100]=0,_r[70]=_r[100]=1,mr[70]=mr[100]=0,qr[70]=qr[100]=-1,Kr[70]=Kr[100]=0,pn[70]=pn[100]=1,rn[70]=rn[100]=0,nn[70]=nn[100]=-1,Qr[70]=Qr[100]=1,qe[70]=qe[100]=1,ze[70]=ze[100]=0,Ve[70]=Ve[100]=0,Pr[101]=Pr[69]=0,_r[101]=_r[69]=1,mr[101]=mr[69]=0,qe[101]=qe[69]=1,ze[101]=ze[69]=0,Ve[101]=Ve[69]=0,hn[149]=hn[21]=0,Sn[149]=Sn[21]=1,fn[149]=fn[21]=1,$e[149]=$e[21]=-1,rr[149]=rr[21]=0,tr[149]=tr[21]=0,qr[86]=qr[84]=-1,Kr[86]=Kr[84]=0,pn[86]=pn[84]=1,rn[86]=rn[84]=0,nn[86]=nn[84]=-1,Qr[86]=Qr[84]=1,Dr[89]=Dr[81]=0,Xe[89]=Xe[81]=-1,vr[89]=vr[81]=0,fr[89]=fr[81]=1,hr[89]=hr[81]=0,or[89]=or[81]=1,Dr[96]=Dr[74]=0,Xe[96]=Xe[74]=1,vr[96]=vr[74]=0,Pr[96]=Pr[74]=-1,_r[96]=_r[74]=0,mr[96]=mr[74]=1,rn[96]=rn[74]=1,nn[96]=nn[74]=0,Qr[96]=Qr[74]=0,qe[96]=qe[74]=1,ze[96]=ze[74]=0,Ve[96]=Ve[74]=1,Dr[24]=Dr[146]=0,Xe[24]=Xe[146]=-1,vr[24]=vr[146]=1,qr[24]=qr[146]=1,Kr[24]=Kr[146]=0,pn[24]=pn[146]=1,fr[24]=fr[146]=0,hr[24]=hr[146]=1,or[24]=or[146]=1,$e[24]=$e[146]=0,rr[24]=rr[146]=-1,tr[24]=tr[146]=0,Pr[6]=Pr[164]=-1,_r[6]=_r[164]=0,mr[6]=mr[164]=1,qr[6]=qr[164]=-1,Kr[6]=Kr[164]=0,pn[6]=pn[164]=0,hn[6]=hn[164]=0,Sn[6]=Sn[164]=-1,fn[6]=fn[164]=1,rn[6]=rn[164]=1,nn[6]=nn[164]=0,Qr[6]=Qr[164]=0,fr[129]=fr[41]=0,hr[129]=hr[41]=1,or[129]=or[41]=1,hn[129]=hn[41]=0,Sn[129]=Sn[41]=1,fn[129]=fn[41]=0,qe[129]=qe[41]=-1,ze[129]=ze[41]=0,Ve[129]=Ve[41]=0,$e[129]=$e[41]=0,rr[129]=rr[41]=-1,tr[129]=tr[41]=0,qr[66]=qr[104]=0,Kr[66]=Kr[104]=1,pn[66]=pn[104]=0,fr[66]=fr[104]=-1,hr[66]=hr[104]=0,or[66]=or[104]=1,rn[66]=rn[104]=0,nn[66]=nn[104]=-1,Qr[66]=Qr[104]=0,qe[66]=qe[104]=0,ze[66]=ze[104]=-1,Ve[66]=Ve[104]=1,Dr[144]=Dr[26]=-1,Xe[144]=Xe[26]=0,vr[144]=vr[26]=0,hn[144]=hn[26]=1,Sn[144]=Sn[26]=0,fn[144]=fn[26]=1,rn[144]=rn[26]=0,nn[144]=nn[26]=1,Qr[144]=Qr[26]=1,$e[144]=$e[26]=-1,rr[144]=rr[26]=0,tr[144]=tr[26]=1,Pr[36]=Pr[134]=0,_r[36]=_r[134]=1,mr[36]=mr[134]=1,qr[36]=qr[134]=0,Kr[36]=Kr[134]=1,pn[36]=pn[134]=0,qe[36]=qe[134]=0,ze[36]=ze[134]=-1,Ve[36]=Ve[134]=1,$e[36]=$e[134]=1,rr[36]=rr[134]=0,tr[36]=tr[134]=0,Dr[9]=Dr[161]=-1,Xe[9]=Xe[161]=0,vr[9]=vr[161]=0,Pr[9]=Pr[161]=0,_r[9]=_r[161]=-1,mr[9]=mr[161]=0,fr[9]=fr[161]=1,hr[9]=hr[161]=0,or[9]=or[161]=0,hn[9]=hn[161]=1,Sn[9]=Sn[161]=0,fn[9]=fn[161]=1,Dr[136]=0,Xe[136]=1,vr[136]=1,Pr[136]=0,_r[136]=1,mr[136]=0,qr[136]=-1,Kr[136]=0,pn[136]=1,fr[136]=-1,hr[136]=0,or[136]=0,hn[136]=0,Sn[136]=-1,fn[136]=0,rn[136]=0,nn[136]=-1,Qr[136]=1,qe[136]=1,ze[136]=0,Ve[136]=0,$e[136]=1,rr[136]=0,tr[136]=1,Dr[34]=0,Xe[34]=-1,vr[34]=0,Pr[34]=0,_r[34]=-1,mr[34]=1,qr[34]=1,Kr[34]=0,pn[34]=0,fr[34]=1,hr[34]=0,or[34]=1,hn[34]=0,Sn[34]=1,fn[34]=1,rn[34]=0,nn[34]=1,Qr[34]=0,qe[34]=-1,ze[34]=0,Ve[34]=1,$e[34]=-1,rr[34]=0,tr[34]=0,Dr[35]=0,Xe[35]=1,vr[35]=1,Pr[35]=0,_r[35]=-1,mr[35]=1,qr[35]=1,Kr[35]=0,pn[35]=0,fr[35]=-1,hr[35]=0,or[35]=0,hn[35]=0,Sn[35]=-1,fn[35]=0,rn[35]=0,nn[35]=1,Qr[35]=0,qe[35]=-1,ze[35]=0,Ve[35]=1,$e[35]=1,rr[35]=0,tr[35]=1,Dr[153]=0,Xe[153]=1,vr[153]=1,fr[153]=-1,hr[153]=0,or[153]=0,hn[153]=0,Sn[153]=-1,fn[153]=0,$e[153]=1,rr[153]=0,tr[153]=1,Pr[102]=0,_r[102]=-1,mr[102]=1,qr[102]=1,Kr[102]=0,pn[102]=0,rn[102]=0,nn[102]=1,Qr[102]=0,qe[102]=-1,ze[102]=0,Ve[102]=1,Dr[155]=0,Xe[155]=-1,vr[155]=0,fr[155]=1,hr[155]=0,or[155]=1,hn[155]=0,Sn[155]=1,fn[155]=1,$e[155]=-1,rr[155]=0,tr[155]=0,Pr[103]=0,_r[103]=1,mr[103]=0,qr[103]=-1,Kr[103]=0,pn[103]=1,rn[103]=0,nn[103]=-1,Qr[103]=1,qe[103]=1,ze[103]=0,Ve[103]=0,Dr[152]=0,Xe[152]=1,vr[152]=1,qr[152]=-1,Kr[152]=0,pn[152]=1,fr[152]=-1,hr[152]=0,or[152]=0,hn[152]=0,Sn[152]=-1,fn[152]=0,rn[152]=0,nn[152]=-1,Qr[152]=1,$e[152]=1,rr[152]=0,tr[152]=1,Dr[156]=0,Xe[156]=-1,vr[156]=1,qr[156]=1,Kr[156]=0,pn[156]=1,fr[156]=-1,hr[156]=0,or[156]=0,hn[156]=0,Sn[156]=-1,fn[156]=0,rn[156]=0,nn[156]=1,Qr[156]=1,$e[156]=-1,rr[156]=0,tr[156]=1,Dr[137]=0,Xe[137]=1,vr[137]=1,Pr[137]=0,_r[137]=1,mr[137]=0,fr[137]=-1,hr[137]=0,or[137]=0,hn[137]=0,Sn[137]=-1,fn[137]=0,qe[137]=1,ze[137]=0,Ve[137]=0,$e[137]=1,rr[137]=0,tr[137]=1,Dr[139]=0,Xe[139]=1,vr[139]=1,Pr[139]=0,_r[139]=-1,mr[139]=0,fr[139]=1,hr[139]=0,or[139]=0,hn[139]=0,Sn[139]=1,fn[139]=0,qe[139]=-1,ze[139]=0,Ve[139]=0,$e[139]=1,rr[139]=0,tr[139]=1,Dr[98]=0,Xe[98]=-1,vr[98]=0,Pr[98]=0,_r[98]=-1,mr[98]=1,qr[98]=1,Kr[98]=0,pn[98]=0,fr[98]=1,hr[98]=0,or[98]=1,rn[98]=0,nn[98]=1,Qr[98]=0,qe[98]=-1,ze[98]=0,Ve[98]=1,Dr[99]=0,Xe[99]=1,vr[99]=0,Pr[99]=0,_r[99]=-1,mr[99]=1,qr[99]=1,Kr[99]=0,pn[99]=0,fr[99]=-1,hr[99]=0,or[99]=1,rn[99]=0,nn[99]=-1,Qr[99]=0,qe[99]=1,ze[99]=0,Ve[99]=1,Pr[38]=0,_r[38]=-1,mr[38]=1,qr[38]=1,Kr[38]=0,pn[38]=0,hn[38]=0,Sn[38]=1,fn[38]=1,rn[38]=0,nn[38]=1,Qr[38]=0,qe[38]=-1,ze[38]=0,Ve[38]=1,$e[38]=-1,rr[38]=0,tr[38]=0,Pr[39]=0,_r[39]=1,mr[39]=1,qr[39]=-1,Kr[39]=0,pn[39]=0,hn[39]=0,Sn[39]=-1,fn[39]=1,rn[39]=0,nn[39]=1,Qr[39]=0,qe[39]=-1,ze[39]=0,Ve[39]=1,$e[39]=1,rr[39]=0,tr[39]=0;var ba=function(r){return[[r.bottomleft,0],[0,0],[0,r.leftbottom]]},Bs=function(r){return[[1,r.rightbottom],[1,0],[r.bottomright,0]]},us=function(r){return[[r.topright,1],[1,1],[1,r.righttop]]},El=function(r){return[[0,r.lefttop],[0,1],[r.topleft,1]]},cu=function(r){return[[r.bottomright,0],[r.bottomleft,0],[0,r.leftbottom],[0,r.lefttop]]},Ou=function(r){return[[r.bottomright,0],[r.bottomleft,0],[1,r.righttop],[1,r.rightbottom]]},vu=function(r){return[[1,r.righttop],[1,r.rightbottom],[r.topleft,1],[r.topright,1]]},Gu=function(r){return[[0,r.leftbottom],[0,r.lefttop],[r.topleft,1],[r.topright,1]]},Rr=[],Nr=[],an=[],$r=[],bn=[],xn=[],ai=[],ui=[];$r[1]=bn[1]=18,$r[169]=bn[169]=18,an[4]=Nr[4]=12,an[166]=Nr[166]=12,Rr[16]=ui[16]=4,Rr[154]=ui[154]=4,xn[64]=ai[64]=22,xn[106]=ai[106]=22,an[2]=xn[2]=17,$r[2]=bn[2]=18,an[168]=xn[168]=17,$r[168]=bn[168]=18,Rr[8]=$r[8]=9,Nr[8]=an[8]=12,Rr[162]=$r[162]=9,Nr[162]=an[162]=12,Rr[32]=ui[32]=4,Nr[32]=ai[32]=1,Rr[138]=ui[138]=4,Nr[138]=ai[138]=1,bn[128]=ui[128]=21,xn[128]=ai[128]=22,bn[42]=ui[42]=21,xn[42]=ai[42]=22,Nr[5]=bn[5]=14,Nr[165]=bn[165]=14,an[20]=ui[20]=6,an[150]=ui[150]=6,Rr[80]=xn[80]=11,Rr[90]=xn[90]=11,$r[65]=ai[65]=3,$r[105]=ai[105]=3,Rr[160]=xn[160]=11,Nr[160]=bn[160]=14,Rr[10]=xn[10]=11,Nr[10]=bn[10]=14,an[130]=ui[130]=6,$r[130]=ai[130]=3,an[40]=ui[40]=6,$r[40]=ai[40]=3,Nr[101]=ai[101]=1,Nr[69]=ai[69]=1,bn[149]=ui[149]=21,bn[21]=ui[21]=21,an[86]=xn[86]=17,an[84]=xn[84]=17,Rr[89]=$r[89]=9,Rr[81]=$r[81]=9,Rr[96]=ai[96]=0,Nr[96]=xn[96]=15,Rr[74]=ai[74]=0,Nr[74]=xn[74]=15,Rr[24]=an[24]=8,$r[24]=ui[24]=7,Rr[146]=an[146]=8,$r[146]=ui[146]=7,Nr[6]=xn[6]=15,an[6]=bn[6]=16,Nr[164]=xn[164]=15,an[164]=bn[164]=16,$r[129]=ui[129]=7,bn[129]=ai[129]=20,$r[41]=ui[41]=7,bn[41]=ai[41]=20,an[66]=ai[66]=2,$r[66]=xn[66]=19,an[104]=ai[104]=2,$r[104]=xn[104]=19,Rr[144]=bn[144]=10,xn[144]=ui[144]=23,Rr[26]=bn[26]=10,xn[26]=ui[26]=23,Nr[36]=ui[36]=5,an[36]=ai[36]=2,Nr[134]=ui[134]=5,an[134]=ai[134]=2,Rr[9]=bn[9]=10,Nr[9]=$r[9]=13,Rr[161]=bn[161]=10,Nr[161]=$r[161]=13,Nr[37]=ui[37]=5,bn[37]=ai[37]=20,Nr[133]=ui[133]=5,bn[133]=ai[133]=20,an[148]=bn[148]=16,xn[148]=ui[148]=23,an[22]=bn[22]=16,xn[22]=ui[22]=23,Rr[82]=an[82]=8,$r[82]=xn[82]=19,Rr[88]=an[88]=8,$r[88]=xn[88]=19,Rr[73]=ai[73]=0,Nr[73]=$r[73]=13,Rr[97]=ai[97]=0,Nr[97]=$r[97]=13,Rr[145]=$r[145]=9,bn[145]=ui[145]=21,Rr[25]=$r[25]=9,bn[25]=ui[25]=21,Nr[70]=ai[70]=1,an[70]=xn[70]=17,Nr[100]=ai[100]=1,an[100]=xn[100]=17,Rr[34]=$r[34]=9,Nr[34]=an[34]=12,bn[34]=ui[34]=21,xn[34]=ai[34]=22,Rr[136]=ui[136]=4,Nr[136]=ai[136]=1,an[136]=xn[136]=17,$r[136]=bn[136]=18,Rr[35]=ui[35]=4,Nr[35]=an[35]=12,$r[35]=bn[35]=18,xn[35]=ai[35]=22,Rr[153]=ui[153]=4,$r[153]=bn[153]=18,Nr[102]=an[102]=12,xn[102]=ai[102]=22,Rr[155]=$r[155]=9,bn[155]=ui[155]=23,Nr[103]=ai[103]=1,an[103]=xn[103]=17,Rr[152]=ui[152]=4,an[152]=xn[152]=17,$r[152]=bn[152]=18,Rr[156]=an[156]=8,$r[156]=bn[156]=18,xn[156]=ui[156]=23,Rr[137]=ui[137]=4,Nr[137]=ai[137]=1,$r[137]=bn[137]=18,Rr[139]=ui[139]=4,Nr[139]=$r[139]=13,bn[139]=ai[139]=20,Rr[98]=$r[98]=9,Nr[98]=an[98]=12,xn[98]=ai[98]=22,Rr[99]=ai[99]=0,Nr[99]=an[99]=12,$r[99]=xn[99]=19,Nr[38]=an[38]=12,bn[38]=ui[38]=21,xn[38]=ai[38]=22,Nr[39]=ui[39]=5,an[39]=bn[39]=16,xn[39]=ai[39]=22;var Ar=[];function Ml(r,o,e){return function(r){return(r>0)-(r<0)||+r}((o[0]-r[0])*(e[1]-o[1])-(e[0]-o[0])*(o[1]-r[1]))}function Dp(r,o){return o.geometry.coordinates[0].every(function(e){return rt(tt(e),r)})}Ar[1]=Ar[169]=ba,Ar[4]=Ar[166]=Bs,Ar[16]=Ar[154]=us,Ar[64]=Ar[106]=El,Ar[168]=Ar[2]=cu,Ar[162]=Ar[8]=Ou,Ar[138]=Ar[32]=vu,Ar[42]=Ar[128]=Gu,Ar[5]=Ar[165]=function(r){return[[0,0],[0,r.leftbottom],[1,r.rightbottom],[1,0]]},Ar[20]=Ar[150]=function(r){return[[1,0],[r.bottomright,0],[r.topright,1],[1,1]]},Ar[80]=Ar[90]=function(r){return[[1,1],[1,r.righttop],[0,r.lefttop],[0,1]]},Ar[65]=Ar[105]=function(r){return[[r.bottomleft,0],[0,0],[0,1],[r.topleft,1]]},Ar[160]=Ar[10]=function(r){return[[1,r.righttop],[1,r.rightbottom],[0,r.leftbottom],[0,r.lefttop]]},Ar[130]=Ar[40]=function(r){return[[r.topleft,1],[r.topright,1],[r.bottomright,0],[r.bottomleft,0]]},Ar[85]=function(){return[[0,0],[0,1],[1,1],[1,0]]},Ar[101]=Ar[69]=function(r){return[[1,r.rightbottom],[1,0],[0,0],[0,1],[r.topleft,1]]},Ar[149]=Ar[21]=function(r){return[[r.topright,1],[1,1],[1,0],[0,0],[0,r.leftbottom]]},Ar[86]=Ar[84]=function(r){return[[1,0],[r.bottomright,0],[0,r.lefttop],[0,1],[1,1]]},Ar[89]=Ar[81]=function(r){return[[1,1],[1,r.righttop],[r.bottomleft,0],[0,0],[0,1]]},Ar[96]=Ar[74]=function(r){return[[1,r.righttop],[1,r.rightbottom],[0,r.lefttop],[0,1],[r.topleft,1]]},Ar[24]=Ar[146]=function(r){return[[1,1],[1,r.righttop],[r.bottomright,0],[r.bottomleft,0],[r.topright,1]]},Ar[6]=Ar[164]=function(r){return[[1,r.rightbottom],[1,0],[r.bottomright,0],[0,r.leftbottom],[0,r.lefttop]]},Ar[129]=Ar[41]=function(r){return[[r.topright,1],[r.bottomleft,0],[0,0],[0,r.leftbottom],[r.topleft,1]]},Ar[66]=Ar[104]=function(r){return[[r.bottomright,0],[r.bottomleft,0],[0,r.lefttop],[0,1],[r.topleft,1]]},Ar[144]=Ar[26]=function(r){return[[1,1],[1,r.righttop],[0,r.leftbottom],[0,r.lefttop],[r.topright,1]]},Ar[36]=Ar[134]=function(r){return[[1,r.rightbottom],[1,0],[r.bottomright,0],[r.topleft,1],[r.topright,1]]},Ar[9]=Ar[161]=function(r){return[[1,r.righttop],[1,r.rightbottom],[r.bottomleft,0],[0,0],[0,r.leftbottom]]},Ar[37]=Ar[133]=function(r){return[[1,r.rightbottom],[1,0],[0,0],[0,r.leftbottom],[r.topleft,1],[r.topright,1]]},Ar[148]=Ar[22]=function(r){return[[1,1],[1,0],[r.bottomright,0],[0,r.leftbottom],[0,r.lefttop],[r.topright,1]]},Ar[82]=Ar[88]=function(r){return[[1,1],[1,r.righttop],[r.bottomright,0],[r.bottomleft,0],[0,r.lefttop],[0,1]]},Ar[73]=Ar[97]=function(r){return[[1,r.righttop],[1,r.rightbottom],[r.bottomleft,0],[0,0],[0,1],[r.topleft,1]]},Ar[145]=Ar[25]=function(r){return[[1,1],[1,r.righttop],[r.bottomleft,0],[0,0],[0,r.leftbottom],[r.topright,1]]},Ar[70]=Ar[100]=function(r){return[[1,r.rightbottom],[1,0],[r.bottomright,0],[0,r.lefttop],[0,1],[r.topleft,1]]},Ar[34]=function(r){return[Gu(r),Ou(r)]},Ar[35]=function(r){return[[1,r.righttop],[1,r.rightbottom],[r.bottomright,0],[r.bottomleft,0],[0,r.leftbottom],[0,r.lefttop],[r.topleft,1],[r.topright,1]]},Ar[136]=function(r){return[vu(r),cu(r)]},Ar[153]=function(r){return[us(r),ba(r)]},Ar[102]=function(r){return[Bs(r),El(r)]},Ar[155]=function(r){return[[1,1],[1,r.righttop],[r.bottomleft,0],[0,0],[0,r.leftbottom],[r.topright,1]]},Ar[103]=function(r){return[[1,r.rightbottom],[1,0],[r.bottomright,0],[0,r.lefttop],[0,1],[r.topleft,1]]},Ar[152]=function(r){return[us(r),cu(r)]},Ar[156]=function(r){return[[1,1],[1,r.righttop],[r.bottomright,0],[r.bottomleft,0],[0,r.leftbottom],[0,r.lefttop],[r.topright,1]]},Ar[137]=function(r){return[vu(r),ba(r)]},Ar[139]=function(r){return[[1,r.righttop],[1,r.rightbottom],[r.bottomleft,0],[0,0],[0,r.leftbottom],[r.topleft,1],[r.topright,1]]},Ar[98]=function(r){return[Ou(r),El(r)]},Ar[99]=function(r){return[[1,r.righttop],[1,r.rightbottom],[r.bottomright,0],[r.bottomleft,0],[0,r.lefttop],[0,1],[r.topleft,1]]},Ar[38]=function(r){return[Bs(r),Gu(r)]},Ar[39]=function(r){return[[1,r.rightbottom],[1,0],[r.bottomright,0],[0,r.leftbottom],[0,r.lefttop],[r.topleft,1],[r.topright,1]]};const nc=function(){function r(o){this.id=r.buildId(o),this.coordinates=o,this.innerEdges=[],this.outerEdges=[],this.outerEdgesSorted=!1}return r.buildId=function(o){return o.join(",")},r.prototype.removeInnerEdge=function(o){this.innerEdges=this.innerEdges.filter(function(e){return e.from.id!==o.from.id})},r.prototype.removeOuterEdge=function(o){this.outerEdges=this.outerEdges.filter(function(e){return e.to.id!==o.to.id})},r.prototype.addOuterEdge=function(o){this.outerEdges.push(o),this.outerEdgesSorted=!1},r.prototype.sortOuterEdges=function(){var o=this;this.outerEdgesSorted||(this.outerEdges.sort(function(e,s){var f=e.to,m=s.to;if(f.coordinates[0]-o.coordinates[0]>=0&&m.coordinates[0]-o.coordinates[0]<0)return 1;if(f.coordinates[0]-o.coordinates[0]<0&&m.coordinates[0]-o.coordinates[0]>=0)return-1;if(f.coordinates[0]-o.coordinates[0]==0&&m.coordinates[0]-o.coordinates[0]==0)return f.coordinates[1]-o.coordinates[1]>=0||m.coordinates[1]-o.coordinates[1]>=0?f.coordinates[1]-m.coordinates[1]:m.coordinates[1]-f.coordinates[1];var x=Ml(o.coordinates,f.coordinates,m.coordinates);return x<0?1:x>0?-1:Math.pow(f.coordinates[0]-o.coordinates[0],2)+Math.pow(f.coordinates[1]-o.coordinates[1],2)-(Math.pow(m.coordinates[0]-o.coordinates[0],2)+Math.pow(m.coordinates[1]-o.coordinates[1],2))}),this.outerEdgesSorted=!0)},r.prototype.getOuterEdges=function(){return this.sortOuterEdges(),this.outerEdges},r.prototype.getOuterEdge=function(o){return this.sortOuterEdges(),this.outerEdges[o]},r.prototype.addInnerEdge=function(o){this.innerEdges.push(o)},r}(),ed=function(){function r(o,e){this.from=o,this.to=e,this.next=void 0,this.label=void 0,this.symetric=void 0,this.ring=void 0,this.from.addOuterEdge(this),this.to.addInnerEdge(this)}return r.prototype.getSymetric=function(){return this.symetric||(this.symetric=new r(this.to,this.from),this.symetric.symetric=this),this.symetric},r.prototype.deleteEdge=function(){this.from.removeOuterEdge(this),this.to.removeInnerEdge(this)},r.prototype.isEqual=function(o){return this.from.id===o.from.id&&this.to.id===o.to.id},r.prototype.toString=function(){return"Edge { "+this.from.id+" -> "+this.to.id+" }"},r.prototype.toLineString=function(){return xt([this.from.coordinates,this.to.coordinates])},r.prototype.compareTo=function(o){return Ml(o.from.coordinates,o.to.coordinates,this.to.coordinates)},r}(),nd=function(){function r(){this.edges=[],this.polygon=void 0,this.envelope=void 0}return r.prototype.push=function(o){this.edges.push(o),this.polygon=this.envelope=void 0},r.prototype.get=function(o){return this.edges[o]},Object.defineProperty(r.prototype,"length",{get:function(){return this.edges.length},enumerable:!0,configurable:!0}),r.prototype.forEach=function(o){this.edges.forEach(o)},r.prototype.map=function(o){return this.edges.map(o)},r.prototype.some=function(o){return this.edges.some(o)},r.prototype.isValid=function(){return!0},r.prototype.isHole=function(){var o=this,e=this.edges.reduce(function(x,I,M){return I.from.coordinates[1]>o.edges[x].from.coordinates[1]&&(x=M),x},0),s=(0===e?this.length:e)-1,f=(e+1)%this.length,m=Ml(this.edges[s].from.coordinates,this.edges[e].from.coordinates,this.edges[f].from.coordinates);return 0===m?this.edges[s].from.coordinates[0]>this.edges[f].from.coordinates[0]:m>0},r.prototype.toMultiPoint=function(){return function(r,o,e){return void 0===e&&(e={}),bt({type:"MultiPoint",coordinates:r},o,e)}(this.edges.map(function(o){return o.from.coordinates}))},r.prototype.toPolygon=function(){if(this.polygon)return this.polygon;var o=this.edges.map(function(e){return e.from.coordinates});return o.push(this.edges[0].from.coordinates),this.polygon=j([o])},r.prototype.getEnvelope=function(){return this.envelope?this.envelope:this.envelope=function(r){return function(r,o){void 0===o&&(o={});var e=Number(r[0]),s=Number(r[1]),f=Number(r[2]),m=Number(r[3]);if(6===r.length)throw new Error("@turf/bbox-polygon does not support BBox with 6 positions");var x=[e,s];return j([[x,[f,s],[f,m],[e,m],x]],o.properties,{bbox:r,id:o.id})}(Ue(r))}(this.toPolygon())},r.findEdgeRingContaining=function(o,e){var f,m,s=o.getEnvelope();return e.forEach(function(x){var I=x.getEnvelope();if(m&&(f=m.getEnvelope()),!function(r,o){var e=r.geometry.coordinates[0].map(function(x){return x[0]}),s=r.geometry.coordinates[0].map(function(x){return x[1]}),f=o.geometry.coordinates[0].map(function(x){return x[0]}),m=o.geometry.coordinates[0].map(function(x){return x[1]});return Math.max.apply(null,e)===Math.max.apply(null,f)&&Math.max.apply(null,s)===Math.max.apply(null,m)&&Math.min.apply(null,e)===Math.min.apply(null,f)&&Math.min.apply(null,s)===Math.min.apply(null,m)}(I,s)&&Dp(I,s)){for(var M=o.map(function(Ct){return Ct.from.coordinates}),S=void 0,D=function(Ct){x.some(function(pt){return function(r,o){return r[0]===o[0]&&r[1]===o[1]}(Ct,pt.from.coordinates)})||(S=Ct)},R=0,N=M;R<N.length;R++)D(N[R]);S&&x.inside(tt(S))&&(!m||Dp(f,I))&&(m=x)}}),m},r.prototype.inside=function(o){return rt(o,this.toPolygon())},r}();function Bp(r){for(var o=r,e=[];o.parent;)e.unshift(o),o=o.parent;return e}!function(){function r(){this.edges=[],this.nodes={}}r.fromGeoJson=function(o){!function(r){if(!r)throw new Error("No geojson passed");if("FeatureCollection"!==r.type&&"GeometryCollection"!==r.type&&"MultiLineString"!==r.type&&"LineString"!==r.type&&"Feature"!==r.type)throw new Error("Invalid input type '"+r.type+"'. Geojson must be FeatureCollection, GeometryCollection, LineString, MultiLineString or Feature")}(o);var e=new r;return Bn(o,function(s){(function(r,o,e){if(!r)throw new Error("No feature passed");if(!r||"Feature"!==r.type||!r.geometry)throw new Error("Invalid input to "+e+", Feature with geometry required");if(!r.geometry||r.geometry.type!==o)throw new Error("Invalid input to "+e+": must be a "+o+", given "+r.geometry.type)})(s,"LineString","Graph::fromGeoJson"),function(r,o,e,s){var f=e;Jt(r,function(m,x,I,M,S){f=0===x?m:o(f,m)},void 0)}(s,function(f,m){if(f){var x=e.getNode(f),I=e.getNode(m);e.addEdge(x,I)}return m})}),e},r.prototype.getNode=function(o){var e=nc.buildId(o),s=this.nodes[e];return s||(s=this.nodes[e]=new nc(o)),s},r.prototype.addEdge=function(o,e){var s=new ed(o,e),f=s.getSymetric();this.edges.push(s),this.edges.push(f)},r.prototype.deleteDangles=function(){var o=this;Object.keys(this.nodes).map(function(e){return o.nodes[e]}).forEach(function(e){return o._removeIfDangle(e)})},r.prototype._removeIfDangle=function(o){var e=this;if(o.innerEdges.length<=1){var s=o.getOuterEdges().map(function(f){return f.to});this.removeNode(o),s.forEach(function(f){return e._removeIfDangle(f)})}},r.prototype.deleteCutEdges=function(){var o=this;this._computeNextCWEdges(),this._findLabeledEdgeRings(),this.edges.forEach(function(e){e.label===e.symetric.label&&(o.removeEdge(e.symetric),o.removeEdge(e))})},r.prototype._computeNextCWEdges=function(o){var e=this;void 0===o?Object.keys(this.nodes).forEach(function(s){return e._computeNextCWEdges(e.nodes[s])}):o.getOuterEdges().forEach(function(s,f){o.getOuterEdge((0===f?o.getOuterEdges().length:f)-1).symetric.next=s})},r.prototype._computeNextCCWEdges=function(o,e){for(var f,m,s=o.getOuterEdges(),x=s.length-1;x>=0;--x){var I=s[x],M=I.symetric,S=void 0,D=void 0;I.label===e&&(S=I),M.label===e&&(D=M),S&&D&&(D&&(m=D),S&&(m&&(m.next=S,m=void 0),f||(f=S)))}m&&(m.next=f)},r.prototype._findLabeledEdgeRings=function(){var o=[],e=0;return this.edges.forEach(function(s){if(!(s.label>=0)){o.push(s);var f=s;do{f.label=e,f=f.next}while(!s.isEqual(f));e++}}),o},r.prototype.getEdgeRings=function(){var o=this;this._computeNextCWEdges(),this.edges.forEach(function(s){s.label=void 0}),this._findLabeledEdgeRings().forEach(function(s){o._findIntersectionNodes(s).forEach(function(f){o._computeNextCCWEdges(f,s.label)})});var e=[];return this.edges.forEach(function(s){s.ring||e.push(o._findEdgeRing(s))}),e},r.prototype._findIntersectionNodes=function(o){var e=[],s=o,f=function(){var m=0;s.from.getOuterEdges().forEach(function(x){x.label===o.label&&++m}),m>1&&e.push(s.from),s=s.next};do{f()}while(!o.isEqual(s));return e},r.prototype._findEdgeRing=function(o){var e=o,s=new nd;do{s.push(e),e.ring=s,e=e.next}while(!o.isEqual(e));return s},r.prototype.removeNode=function(o){var e=this;o.getOuterEdges().forEach(function(s){return e.removeEdge(s)}),o.innerEdges.forEach(function(s){return e.removeEdge(s)}),delete this.nodes[o.id]},r.prototype.removeEdge=function(o){this.edges=this.edges.filter(function(e){return!e.isEqual(o)}),o.deleteEdge()}}(),wt(9331),wt(6882),wt(3212);var Dc={search:function(r,o,e,s){r.cleanDirty();var f=(s=s||{}).heuristic||Dc.heuristics.manhattan,m=s.closest||!1,x=new oc(function(r){return r.f}),I=o;for(o.h=f(o,e),x.push(o);x.size()>0;){var M=x.pop();if(M===e)return Bp(M);M.closed=!0;for(var S=r.neighbors(M),D=0,R=S.length;D<R;++D){var N=S[D];if(!N.closed&&!N.isWall()){var B=M.g+N.getCost(M),Ct=N.visited;(!Ct||B<N.g)&&(N.visited=!0,N.parent=M,N.h=N.h||f(N,e),N.g=B,N.f=N.g+N.h,r.markDirty(N),m&&(N.h<I.h||N.h===I.h&&N.g<I.g)&&(I=N),Ct?x.rescoreElement(N):x.push(N))}}}return m?Bp(I):[]},heuristics:{manhattan:function(r,o){return Math.abs(o.x-r.x)+Math.abs(o.y-r.y)},diagonal:function(r,o){var s=Math.sqrt(2),f=Math.abs(o.x-r.x),m=Math.abs(o.y-r.y);return 1*(f+m)+(s-2)*Math.min(f,m)}},cleanNode:function(r){r.f=0,r.g=0,r.h=0,r.visited=!1,r.closed=!1,r.parent=null}};function ju(r,o){o=o||{},this.nodes=[],this.diagonal=!!o.diagonal,this.grid=[];for(var e=0;e<r.length;e++){this.grid[e]=[];for(var s=0,f=r[e];s<f.length;s++){var m=new nl(e,s,f[s]);this.grid[e][s]=m,this.nodes.push(m)}}this.init()}function nl(r,o,e){this.x=r,this.y=o,this.weight=e}function oc(r){this.content=[],this.scoreFunction=r}function sc(){this._=null}function Tl(r){r.U=r.C=r.L=r.R=r.P=r.N=null}function La(r,o){var e=o,s=o.R,f=e.U;f?f.L===e?f.L=s:f.R=s:r._=s,s.U=f,e.U=s,e.R=s.L,e.R&&(e.R.U=e),s.L=e}function uc(r,o){var e=o,s=o.L,f=e.U;f?f.L===e?f.L=s:f.R=s:r._=s,s.U=f,e.U=s,e.L=s.R,e.L&&(e.L.U=e),s.R=e}function Vh(r){for(;r.L;)r=r.L;return r}ju.prototype.init=function(){this.dirtyNodes=[];for(var r=0;r<this.nodes.length;r++)Dc.cleanNode(this.nodes[r])},ju.prototype.cleanDirty=function(){for(var r=0;r<this.dirtyNodes.length;r++)Dc.cleanNode(this.dirtyNodes[r]);this.dirtyNodes=[]},ju.prototype.markDirty=function(r){this.dirtyNodes.push(r)},ju.prototype.neighbors=function(r){var o=[],e=r.x,s=r.y,f=this.grid;return f[e-1]&&f[e-1][s]&&o.push(f[e-1][s]),f[e+1]&&f[e+1][s]&&o.push(f[e+1][s]),f[e]&&f[e][s-1]&&o.push(f[e][s-1]),f[e]&&f[e][s+1]&&o.push(f[e][s+1]),this.diagonal&&(f[e-1]&&f[e-1][s-1]&&o.push(f[e-1][s-1]),f[e+1]&&f[e+1][s-1]&&o.push(f[e+1][s-1]),f[e-1]&&f[e-1][s+1]&&o.push(f[e-1][s+1]),f[e+1]&&f[e+1][s+1]&&o.push(f[e+1][s+1])),o},ju.prototype.toString=function(){for(var e,s,f,m,r=[],o=this.grid,x=0,I=o.length;x<I;x++){for(e=[],f=0,m=(s=o[x]).length;f<m;f++)e.push(s[f].weight);r.push(e.join(" "))}return r.join("\n")},nl.prototype.toString=function(){return"["+this.x+" "+this.y+"]"},nl.prototype.getCost=function(r){return r&&r.x!==this.x&&r.y!==this.y?1.41421*this.weight:this.weight},nl.prototype.isWall=function(){return 0===this.weight},oc.prototype={push:function(r){this.content.push(r),this.sinkDown(this.content.length-1)},pop:function(){var r=this.content[0],o=this.content.pop();return this.content.length>0&&(this.content[0]=o,this.bubbleUp(0)),r},remove:function(r){var o=this.content.indexOf(r),e=this.content.pop();o!==this.content.length-1&&(this.content[o]=e,this.scoreFunction(e)<this.scoreFunction(r)?this.sinkDown(o):this.bubbleUp(o))},size:function(){return this.content.length},rescoreElement:function(r){this.sinkDown(this.content.indexOf(r))},sinkDown:function(r){for(var o=this.content[r];r>0;){var e=(r+1>>1)-1,s=this.content[e];if(!(this.scoreFunction(o)<this.scoreFunction(s)))break;this.content[e]=o,this.content[r]=s,r=e}},bubbleUp:function(r){for(var o=this.content.length,e=this.content[r],s=this.scoreFunction(e);;){var I,f=r+1<<1,m=f-1,x=null;if(m<o&&(I=this.scoreFunction(this.content[m]))<s&&(x=m),f<o&&this.scoreFunction(this.content[f])<(null===x?s:I)&&(x=f),null===x)break;this.content[r]=this.content[x],this.content[x]=e,r=x}}},sc.prototype={constructor:sc,insert:function(r,o){var e,s,f;if(r){if(o.P=r,o.N=r.N,r.N&&(r.N.P=o),r.N=o,r.R){for(r=r.R;r.L;)r=r.L;r.L=o}else r.R=o;e=r}else this._?(r=Vh(this._),o.P=null,o.N=r,r.P=r.L=o,e=r):(o.P=o.N=null,this._=o,e=null);for(o.L=o.R=null,o.U=e,o.C=!0,r=o;e&&e.C;)e===(s=e.U).L?(f=s.R)&&f.C?(e.C=f.C=!1,s.C=!0,r=s):(r===e.R&&(La(this,e),e=(r=e).U),e.C=!1,s.C=!0,uc(this,s)):(f=s.L)&&f.C?(e.C=f.C=!1,s.C=!0,r=s):(r===e.L&&(uc(this,e),e=(r=e).U),e.C=!1,s.C=!0,La(this,s)),e=r.U;this._.C=!1},remove:function(r){r.N&&(r.N.P=r.P),r.P&&(r.P.N=r.N),r.N=r.P=null;var e,m,x,o=r.U,s=r.L,f=r.R;if(m=s?f?Vh(f):s:f,o?o.L===r?o.L=m:o.R=m:this._=m,s&&f?(x=m.C,m.C=r.C,m.L=s,s.U=m,m!==f?(o=m.U,m.U=r.U,o.L=r=m.R,m.R=f,f.U=m):(m.U=o,o=m,r=m.R)):(x=r.C,r=m),r&&(r.U=o),!x){if(r&&r.C)return void(r.C=!1);do{if(r===this._)break;if(r===o.L){if((e=o.R).C&&(e.C=!1,o.C=!0,La(this,o),e=o.R),e.L&&e.L.C||e.R&&e.R.C){(!e.R||!e.R.C)&&(e.L.C=!1,e.C=!0,uc(this,e),e=o.R),e.C=o.C,o.C=e.R.C=!1,La(this,o),r=this._;break}}else if((e=o.L).C&&(e.C=!1,o.C=!0,uc(this,o),e=o.L),e.L&&e.L.C||e.R&&e.R.C){(!e.L||!e.L.C)&&(e.R.C=!1,e.C=!0,La(this,e),e=o.L),e.C=o.C,o.C=e.L.C=!1,uc(this,o),r=this._;break}e.C=!0,r=o,o=o.U}while(!r.C);r&&(r.C=!1)}}};const Up=sc;function lc(r,o,e,s){var f=[null,null],m=Ga.push(f)-1;return f.left=r,f.right=o,e&&cc(f,r,o,e),s&&cc(f,o,r,s),Ts[r.index].halfedges.push(m),Ts[o.index].halfedges.push(m),f}function Al(r,o,e){var s=[o,e];return s.left=r,s}function cc(r,o,e,s){r[0]||r[1]?r.left===e?r[1]=s:r[0]=s:(r[0]=s,r.left=o,r.right=e)}function dd(r,o,e,s,f){var pt,m=r[0],x=r[1],I=m[0],M=m[1],R=0,N=1,B=x[0]-I,Ct=x[1]-M;if(pt=o-I,B||!(pt>0)){if(pt/=B,B<0){if(pt<R)return;pt<N&&(N=pt)}else if(B>0){if(pt>N)return;pt>R&&(R=pt)}if(pt=s-I,B||!(pt<0)){if(pt/=B,B<0){if(pt>N)return;pt>R&&(R=pt)}else if(B>0){if(pt<R)return;pt<N&&(N=pt)}if(pt=e-M,Ct||!(pt>0)){if(pt/=Ct,Ct<0){if(pt<R)return;pt<N&&(N=pt)}else if(Ct>0){if(pt>N)return;pt>R&&(R=pt)}if(pt=f-M,Ct||!(pt<0)){if(pt/=Ct,Ct<0){if(pt>N)return;pt>R&&(R=pt)}else if(Ct>0){if(pt<R)return;pt<N&&(N=pt)}return!(R>0)&&!(N<1)||(R>0&&(r[0]=[I+R*B,M+R*Ct]),N<1&&(r[1]=[I+N*B,M+N*Ct])),!0}}}}}function qp(r,o,e,s,f){var m=r[1];if(m)return!0;var pt,$t,x=r[0],I=r.left,M=r.right,S=I[0],D=I[1],R=M[0],N=M[1],B=(S+R)/2;if(N===D){if(B<o||B>=s)return;if(S>R){if(x){if(x[1]>=f)return}else x=[B,e];m=[B,f]}else{if(x){if(x[1]<e)return}else x=[B,f];m=[B,e]}}else if($t=(D+N)/2-(pt=(S-R)/(N-D))*B,pt<-1||pt>1)if(S>R){if(x){if(x[1]>=f)return}else x=[(e-$t)/pt,e];m=[(f-$t)/pt,f]}else{if(x){if(x[1]<e)return}else x=[(f-$t)/pt,f];m=[(e-$t)/pt,e]}else if(D<N){if(x){if(x[0]>=s)return}else x=[o,pt*o+$t];m=[s,pt*s+$t]}else{if(x){if(x[0]<o)return}else x=[s,pt*s+$t];m=[o,pt*o+$t]}return r[0]=x,r[1]=m,!0}function Zp(r,o){var e=r.site,s=o.left,f=o.right;return e===f&&(f=s,s=e),f?Math.atan2(f[1]-s[1],f[0]-s[0]):(e===s?(s=o[1],f=o[0]):(s=o[0],f=o[1]),Math.atan2(s[0]-f[0],f[1]-s[1]))}function Xh(r,o){return o[+(o.left!==r.site)]}function gd(r,o){return o[+(o.left===r.site)]}var lh,Yh=[];function md(){Tl(this),this.x=this.y=this.arc=this.site=this.cy=null}function pc(r){var o=r.P,e=r.N;if(o&&e){var s=o.site,f=r.site,m=e.site;if(s!==m){var x=f[0],I=f[1],M=s[0]-x,S=s[1]-I,D=m[0]-x,R=m[1]-I,N=2*(M*R-S*D);if(!(N>=-vd)){var B=M*M+S*S,Ct=D*D+R*R,pt=(R*B-S*Ct)/N,$t=(M*Ct-D*B)/N,Nt=Yh.pop()||new md;Nt.arc=r,Nt.site=f,Nt.x=pt+x,Nt.y=(Nt.cy=$t+I)+Math.sqrt(pt*pt+$t*$t),r.circle=Nt;for(var dt=null,At=dc._;At;)if(Nt.y<At.y||Nt.y===At.y&&Nt.x<=At.x){if(!At.L){dt=At.P;break}At=At.L}else{if(!At.R){dt=At;break}At=At.R}dc.insert(dt,Nt),dt||(lh=Nt)}}}}function Ll(r){var o=r.circle;o&&(o.P||(lh=o.N),dc.remove(o),Yh.push(o),Tl(o),r.circle=null)}var Wh=[];function ch(){Tl(this),this.edge=this.site=this.circle=null}function Hh(r){var o=Wh.pop()||new ch;return o.site=r,o}function fc(r){Ll(r),bu.remove(r),Wh.push(r),Tl(r)}function hh(r){var o=r.circle,e=o.x,s=o.cy,f=[e,s],m=r.P,x=r.N,I=[r];fc(r);for(var M=m;M.circle&&Math.abs(e-M.circle.x)<Bo&&Math.abs(s-M.circle.cy)<Bo;)m=M.P,I.unshift(M),fc(M),M=m;I.unshift(M),Ll(M);for(var S=x;S.circle&&Math.abs(e-S.circle.x)<Bo&&Math.abs(s-S.circle.cy)<Bo;)x=S.N,I.push(S),fc(S),S=x;I.push(S),Ll(S);var R,D=I.length;for(R=1;R<D;++R)cc((S=I[R]).edge,(M=I[R-1]).site,S.site,f);(S=I[D-1]).edge=lc((M=I[0]).site,S.site,null,f),pc(M),pc(S)}function ph(r){for(var s,f,m,x,o=r[0],e=r[1],I=bu._;I;)if((m=Ol(I,e)-o)>Bo)I=I.L;else{if(!((x=o-yd(I,e))>Bo)){m>-Bo?(s=I.P,f=I):x>-Bo?(s=I,f=I.N):s=f=I;break}if(!I.R){s=I;break}I=I.R}!function(r){Ts[r.index]={site:r,halfedges:[]}}(r);var M=Hh(r);if(bu.insert(s,M),s||f){if(s===f)return Ll(s),f=Hh(s.site),bu.insert(M,f),M.edge=f.edge=lc(s.site,M.site),pc(s),void pc(f);if(!f)return void(M.edge=lc(s.site,M.site));Ll(s),Ll(f);var S=s.site,D=S[0],R=S[1],N=r[0]-D,B=r[1]-R,Ct=f.site,pt=Ct[0]-D,$t=Ct[1]-R,Nt=2*(N*$t-B*pt),dt=N*N+B*B,At=pt*pt+$t*$t,se=[($t*dt-B*At)/Nt+D,(N*At-pt*dt)/Nt+R];cc(f.edge,S,Ct,se),M.edge=lc(S,r,null,se),f.edge=lc(r,Ct,null,se),pc(s),pc(f)}}function Ol(r,o){var e=r.site,s=e[0],f=e[1],m=f-o;if(!m)return s;var x=r.P;if(!x)return-1/0;var I=(e=x.site)[0],M=e[1],S=M-o;if(!S)return I;var D=I-s,R=1/m-1/S,N=D/S;return R?(-N+Math.sqrt(N*N-2*R*(D*D/(-2*S)-M+S/2+f-m/2)))/R+s:(s+I)/2}function yd(r,o){var e=r.N;if(e)return Ol(e,o);var s=r.site;return s[1]===o?s[0]:1/0}var bu,Ts,dc,Ga,Bo=1e-6,vd=1e-12;function jp(r,o,e){return(r[0]-e[0])*(o[1]-r[1])-(r[0]-o[0])*(e[1]-r[1])}function Xp(r,o){return o[1]-r[1]||o[0]-r[0]}function Yp(r,o){var s,f,m,e=r.sort(Xp).pop();for(Ga=[],Ts=new Array(r.length),bu=new Up,dc=new Up;;)if(m=lh,e&&(!m||e[1]<m.y||e[1]===m.y&&e[0]<m.x))(e[0]!==s||e[1]!==f)&&(ph(e),s=e[0],f=e[1]),e=r.pop();else{if(!m)break;hh(m.arc)}if(function(){for(var e,s,f,m,r=0,o=Ts.length;r<o;++r)if((e=Ts[r])&&(m=(s=e.halfedges).length)){var x=new Array(m),I=new Array(m);for(f=0;f<m;++f)x[f]=f,I[f]=Zp(e,Ga[s[f]]);for(x.sort(function(M,S){return I[S]-I[M]}),f=0;f<m;++f)I[f]=s[x[f]];for(f=0;f<m;++f)s[f]=I[f]}}(),o){var x=+o[0][0],I=+o[0][1],M=+o[1][0],S=+o[1][1];(function(r,o,e,s){for(var m,f=Ga.length;f--;)qp(m=Ga[f],r,o,e,s)&&dd(m,r,o,e,s)&&(Math.abs(m[0][0]-m[1][0])>Bo||Math.abs(m[0][1]-m[1][1])>Bo)||delete Ga[f]})(x,I,M,S),function(r,o,e,s){var m,x,I,M,S,D,R,N,B,Ct,pt,$t,f=Ts.length,Nt=!0;for(m=0;m<f;++m)if(x=Ts[m]){for(I=x.site,M=(S=x.halfedges).length;M--;)Ga[S[M]]||S.splice(M,1);for(M=0,D=S.length;M<D;)pt=(Ct=gd(x,Ga[S[M]]))[0],$t=Ct[1],N=(R=Xh(x,Ga[S[++M%D]]))[0],B=R[1],(Math.abs(pt-N)>Bo||Math.abs($t-B)>Bo)&&(S.splice(M,0,Ga.push(Al(I,Ct,Math.abs(pt-r)<Bo&&s-$t>Bo?[r,Math.abs(N-r)<Bo?B:s]:Math.abs($t-s)<Bo&&e-pt>Bo?[Math.abs(B-s)<Bo?N:e,s]:Math.abs(pt-e)<Bo&&$t-o>Bo?[e,Math.abs(N-e)<Bo?B:o]:Math.abs($t-o)<Bo&&pt-r>Bo?[Math.abs(B-o)<Bo?N:r,o]:null))-1),++D);D&&(Nt=!1)}if(Nt){var dt,At,se,oe=1/0;for(m=0,Nt=null;m<f;++m)(x=Ts[m])&&(se=(dt=(I=x.site)[0]-r)*dt+(At=I[1]-o)*At)<oe&&(oe=se,Nt=x);if(Nt){var xe=[r,o],me=[r,s],Ae=[e,s],jt=[e,o];Nt.halfedges.push(Ga.push(Al(I=Nt.site,xe,me))-1,Ga.push(Al(I,me,Ae))-1,Ga.push(Al(I,Ae,jt))-1,Ga.push(Al(I,jt,xe))-1)}}for(m=0;m<f;++m)(x=Ts[m])&&(x.halfedges.length||delete Ts[m])}(x,I,M,S)}this.edges=Ga,this.cells=Ts,bu=dc=Ga=Ts=null}function i(){return new u}function u(){this.reset()}Yp.prototype={constructor:Yp,polygons:function(){var r=this.edges;return this.cells.map(function(o){var e=o.halfedges.map(function(s){return Xh(o,r[s])});return e.data=o.site.data,e})},triangles:function(){var r=[],o=this.edges;return this.cells.forEach(function(e,s){if(I=(m=e.halfedges).length)for(var m,I,M,f=e.site,x=-1,S=o[m[I-1]],D=S.left===f?S.right:S.left;++x<I;)M=D,D=(S=o[m[x]]).left===f?S.right:S.left,M&&D&&s<M.index&&s<D.index&&jp(f,M,D)<0&&r.push([f.data,M.data,D.data])}),r},links:function(){return this.edges.filter(function(r){return r.right}).map(function(r){return{source:r.left.data,target:r.right.data}})},find:function(r,o,e){for(var f,I,s=this,m=s._found||0,x=s.cells.length;!(I=s.cells[m]);)if(++m>=x)return null;var M=r-I.site[0],S=o-I.site[1],D=M*M+S*S;do{I=s.cells[f=m],m=null,I.halfedges.forEach(function(R){var N=s.edges[R],B=N.left;if(B!==I.site&&B||(B=N.right)){var Ct=r-B[0],pt=o-B[1],$t=Ct*Ct+pt*pt;$t<D&&(D=$t,m=B.index)}})}while(null!==m);return s._found=f,null==e||D<=e*e?I.site:null}},wt(171),wt(7299),u.prototype={constructor:u,reset:function(){this.s=this.t=0},add:function(r){_(g,r,this.t),_(this,g.s,this.s),this.s?this.t+=g.t:this.s=g.t},valueOf:function(){return this.s}};var g=new u;function _(r,o,e){var s=r.s=o+e,f=s-o;r.t=o-(s-f)+(e-f)}var r,A=Math.PI,F=A/2,q=2*A,K=A/180,It=(Math,Math.atan),Mt=Math.atan2,Zt=Math.cos,be=(Math,Math,Math,Math,Math,Math.sin),lr=(Math,Math.sqrt);Math;function kr(r){return r>1?F:r<-1?-F:Math.asin(r)}function Zc(r,o){return[r>A?r-q:r<-A?r+q:r,o]}function op(r,o){return r<o?-1:r>o?1:r>=o?0:NaN}i(),i(),i(),Zc.invert=Zc,1===(r=op).length&&(r=function(r){return function(o,e){return op(r(o),e)}}(r)),Math.sqrt(50),Math.sqrt(10),Math.sqrt(2);i();function qd(){}function Jg(r){return function(o,e){var s=Zt(o),f=Zt(e),m=r(s*f);return[m*f*be(o),m*be(e)]}}function yp(r){return function(o,e){var s=lr(o*o+e*e),f=r(s),m=be(f),x=Zt(f);return[Mt(o*m,s*x),kr(s&&e*m/s)]}}function Gd(r,o){return[r,o]}i(),i(),i(),i(),qd.prototype={constructor:qd,point:function(r,o){this.stream.point(r,o)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}},Zt(30*K),Jg(function(r){return lr(2/(1+r))}).invert=yp(function(r){return 2*kr(r/2)}),Jg(function(r){return(r=function(r){return r>1?0:r<-1?A:Math.acos(r)}(r))&&r/be(r)}).invert=yp(function(r){return r}),Gd.invert=Gd,yp(It),yp(kr),yp(function(r){return 2*It(r)});const gy=JSON.parse('{"type":"Polygon","coordinates":[[[-80.5189298163933,40.64111135513909],[-80.5189298163933,39.72088328710156],[-79.47752051463135,39.720883287101685],[-78.54990271677599,39.71982392023972],[-78.23291948109767,39.72140005142455],[-77.5232987128656,39.72566335708859],[-76.66818294951588,39.720883287101685],[-75.78764238147852,39.72354462336466],[-75.71090287952501,39.80237702082593],[-75.62096004912104,39.847361355135945],[-75.40557267932849,39.795504055331094],[-75.200804816372,39.88704885513607],[-75.12881954618945,39.949499823560814],[-74.89175391305048,40.08179149022811],[-74.76318294950823,40.19077708593164],[-75.07802161324645,40.44954682063326],[-75.09548824736112,40.555380153966894],[-75.20395707874178,40.58661855728735],[-75.19920284697093,40.74746145279573],[-75.08225908069448,40.8697020533823],[-75.1357183499004,40.999874986325494],[-74.97590898303775,41.087724921221536],[-74.80126848010735,41.31156138769393],[-74.67902787952096,41.35548635514192],[-74.84043921578461,41.42638642024633],[-75.01081641305097,41.49571035416608],[-75.07538611519954,41.6412311874999],[-75.04892778186621,41.751301988281625],[-75.1679902818666,41.84178742122464],[-75.38547054716696,41.99896129004043],[-76.74383724639114,42.00053742122532],[-78.20064754913136,42.00002065690239],[-79.76008724640326,42.00002065690239],[-79.76008724640326,42.50006765397467],[-79.77303961320486,42.54612229847678],[-80.24744767934794,42.36619985612248],[-80.5162684801303,42.324910386721456],[-80.5162684801303,42.32439362239842],[-80.5189298163933,40.64111135513909]]]}');var my=wt.t(gy,2),Ya=wt(8583);function Wl(r,o,e,s){return new(e||(e=Promise))(function(m,x){function I(D){try{S(s.next(D))}catch(R){x(R)}}function M(D){try{S(s.throw(D))}catch(R){x(R)}}function S(D){D.done?m(D.value):function(m){return m instanceof e?m:new e(function(x){x(m)})}(D.value).then(I,M)}S((s=s.apply(r,o||[])).next())})}var jd=wt(9765),Df=wt(5319);class hm extends jd.xQ{constructor(){super(...arguments),this.value=null,this.hasNext=!1,this.hasCompleted=!1}_subscribe(o){return this.hasError?(o.error(this.thrownError),Df.w.EMPTY):this.hasCompleted&&this.hasNext?(o.next(this.value),o.complete(),Df.w.EMPTY):super._subscribe(o)}next(o){this.hasCompleted||(this.value=o,this.hasNext=!0)}error(o){this.hasCompleted||super.error(o)}complete(){this.hasCompleted=!0,this.hasNext&&super.next(this.value),super.complete()}}var pm=wt(2759),Xd=wt(8049),fm=wt(5435),Yd=wt(4395),_y=wt(3190),xy=wt(6736),by=wt(9761);const wy=["content"],Ey=["*"],Cy=["container"];let Cc=(()=>{class r{constructor(e){this.zone=e,this.mapCreated=new hm,this.mapLoaded=new hm,this.markersToRemove=[],this.popupsToRemove=[],this.imageIdsToRemove=[],this.subscription=new Df.w,this.mapCreated$=this.mapCreated.asObservable(),this.mapLoaded$=this.mapLoaded.asObservable()}setup(e){this.zone.onStable.pipe((0,Xd.P)()).subscribe(()=>{e.customMapboxApiUrl&&this.assign(de,"config.API_URL",e.customMapboxApiUrl),this.createMap(e.mapOptions),this.hookEvents(e.mapEvents),this.mapEvents=e.mapEvents,this.mapCreated.next(void 0),this.mapCreated.complete()})}destroyMap(){this.mapInstance&&(this.subscription.unsubscribe(),this.mapInstance.remove())}updateMinZoom(e){return this.zone.runOutsideAngular(()=>{this.mapInstance.setMinZoom(e)})}updateMaxZoom(e){return this.zone.runOutsideAngular(()=>{this.mapInstance.setMaxZoom(e)})}updateMinPitch(e){return this.zone.runOutsideAngular(()=>{this.mapInstance.setMinPitch(e)})}updateMaxPitch(e){return this.zone.runOutsideAngular(()=>{this.mapInstance.setMaxPitch(e)})}updateRenderWorldCopies(e){return this.zone.runOutsideAngular(()=>{this.mapInstance.setRenderWorldCopies(e)})}updateScrollZoom(e){return this.zone.runOutsideAngular(()=>{e?this.mapInstance.scrollZoom.enable():this.mapInstance.scrollZoom.disable()})}updateDragRotate(e){return this.zone.runOutsideAngular(()=>{e?this.mapInstance.dragRotate.enable():this.mapInstance.dragRotate.disable()})}updateTouchPitch(e){return this.zone.runOutsideAngular(()=>{e?this.mapInstance.touchPitch.enable():this.mapInstance.touchPitch.disable()})}updateTouchZoomRotate(e){return this.zone.runOutsideAngular(()=>{e?this.mapInstance.touchZoomRotate.enable():this.mapInstance.touchZoomRotate.disable()})}updateDoubleClickZoom(e){return this.zone.runOutsideAngular(()=>{e?this.mapInstance.doubleClickZoom.enable():this.mapInstance.doubleClickZoom.disable()})}updateKeyboard(e){return this.zone.runOutsideAngular(()=>{e?this.mapInstance.keyboard.enable():this.mapInstance.keyboard.disable()})}updateDragPan(e){return this.zone.runOutsideAngular(()=>{e?this.mapInstance.dragPan.enable():this.mapInstance.dragPan.disable()})}updateBoxZoom(e){return this.zone.runOutsideAngular(()=>{e?this.mapInstance.boxZoom.enable():this.mapInstance.boxZoom.disable()})}updateStyle(e){return this.zone.runOutsideAngular(()=>{this.mapInstance.setStyle(e)})}updateMaxBounds(e){return this.zone.runOutsideAngular(()=>{this.mapInstance.setMaxBounds(e)})}changeCanvasCursor(e){this.mapInstance.getCanvasContainer().style.cursor=e}queryRenderedFeatures(e,s){return this.mapInstance.queryRenderedFeatures(e,s)}panTo(e,s){return this.zone.runOutsideAngular(()=>{this.mapInstance.panTo(e,s)})}move(e,s,f,m,x,I){return this.zone.runOutsideAngular(()=>{this.mapInstance[e](Object.assign(Object.assign({},s),{zoom:f||this.mapInstance.getZoom(),center:m||this.mapInstance.getCenter(),bearing:x||this.mapInstance.getBearing(),pitch:I||this.mapInstance.getPitch()}))})}addLayer(e,s,f){this.zone.runOutsideAngular(()=>{Object.keys(e.layerOptions).forEach(m=>{void 0===e.layerOptions[m]&&delete e.layerOptions[m]}),this.mapInstance.addLayer(e.layerOptions,f),s&&((e.layerEvents.layerClick.observers.length||e.layerEvents.click.observers.length)&&this.mapInstance.on("click",e.layerOptions.id,m=>{this.zone.run(()=>{e.layerEvents.layerClick.emit(m),e.layerEvents.click.emit(m)})}),(e.layerEvents.layerDblClick.observers.length||e.layerEvents.dblClick.observers.length)&&this.mapInstance.on("dblclick",e.layerOptions.id,m=>{this.zone.run(()=>{e.layerEvents.layerDblClick.emit(m),e.layerEvents.dblClick.emit(m)})}),(e.layerEvents.layerMouseDown.observers.length||e.layerEvents.mouseDown.observers.length)&&this.mapInstance.on("mousedown",e.layerOptions.id,m=>{this.zone.run(()=>{e.layerEvents.layerMouseDown.emit(m),e.layerEvents.mouseDown.emit(m)})}),(e.layerEvents.layerMouseUp.observers.length||e.layerEvents.mouseUp.observers.length)&&this.mapInstance.on("mouseup",e.layerOptions.id,m=>{this.zone.run(()=>{e.layerEvents.layerMouseUp.emit(m),e.layerEvents.mouseUp.emit(m)})}),(e.layerEvents.layerMouseEnter.observers.length||e.layerEvents.mouseEnter.observers.length)&&this.mapInstance.on("mouseenter",e.layerOptions.id,m=>{this.zone.run(()=>{e.layerEvents.layerMouseEnter.emit(m),e.layerEvents.mouseEnter.emit(m)})}),(e.layerEvents.layerMouseLeave.observers.length||e.layerEvents.mouseLeave.observers.length)&&this.mapInstance.on("mouseleave",e.layerOptions.id,m=>{this.zone.run(()=>{e.layerEvents.layerMouseLeave.emit(m),e.layerEvents.mouseLeave.emit(m)})}),(e.layerEvents.layerMouseMove.observers.length||e.layerEvents.mouseMove.observers.length)&&this.mapInstance.on("mousemove",e.layerOptions.id,m=>{this.zone.run(()=>{e.layerEvents.layerMouseMove.emit(m),e.layerEvents.mouseMove.emit(m)})}),(e.layerEvents.layerMouseOver.observers.length||e.layerEvents.mouseOver.observers.length)&&this.mapInstance.on("mouseover",e.layerOptions.id,m=>{this.zone.run(()=>{e.layerEvents.layerMouseOver.emit(m),e.layerEvents.mouseOver.emit(m)})}),(e.layerEvents.layerMouseOut.observers.length||e.layerEvents.mouseOut.observers.length)&&this.mapInstance.on("mouseout",e.layerOptions.id,m=>{this.zone.run(()=>{e.layerEvents.layerMouseOut.emit(m),e.layerEvents.mouseOut.emit(m)})}),(e.layerEvents.layerContextMenu.observers.length||e.layerEvents.contextMenu.observers.length)&&this.mapInstance.on("contextmenu",e.layerOptions.id,m=>{this.zone.run(()=>{e.layerEvents.layerContextMenu.emit(m),e.layerEvents.contextMenu.emit(m)})}),(e.layerEvents.layerTouchStart.observers.length||e.layerEvents.touchStart.observers.length)&&this.mapInstance.on("touchstart",e.layerOptions.id,m=>{this.zone.run(()=>{e.layerEvents.layerTouchStart.emit(m),e.layerEvents.touchStart.emit(m)})}),(e.layerEvents.layerTouchEnd.observers.length||e.layerEvents.touchEnd.observers.length)&&this.mapInstance.on("touchend",e.layerOptions.id,m=>{this.zone.run(()=>{e.layerEvents.layerTouchEnd.emit(m),e.layerEvents.touchEnd.emit(m)})}),(e.layerEvents.layerTouchCancel.observers.length||e.layerEvents.touchCancel.observers.length)&&this.mapInstance.on("touchcancel",e.layerOptions.id,m=>{this.zone.run(()=>{e.layerEvents.layerTouchCancel.emit(m),e.layerEvents.touchCancel.emit(m)})}))})}removeLayer(e){this.zone.runOutsideAngular(()=>{null!=this.mapInstance.getLayer(e)&&this.mapInstance.removeLayer(e)})}addMarker(e){const s={offset:e.markersOptions.offset,anchor:e.markersOptions.anchor,draggable:!!e.markersOptions.draggable,rotationAlignment:e.markersOptions.rotationAlignment,pitchAlignment:e.markersOptions.pitchAlignment,clickTolerance:e.markersOptions.clickTolerance};e.markersOptions.element.childNodes.length>0&&(s.element=e.markersOptions.element);const f=new de.Marker(s);return(e.markersEvents.markerDragStart.observers.length||e.markersEvents.dragStart.observers.length)&&f.on("dragstart",x=>{if(x){const{target:I}=x;this.zone.run(()=>{e.markersEvents.markerDragStart.emit(I),e.markersEvents.dragStart.emit(I)})}}),(e.markersEvents.markerDrag.observers.length||e.markersEvents.drag.observers.length)&&f.on("drag",x=>{if(x){const{target:I}=x;this.zone.run(()=>{e.markersEvents.markerDrag.emit(I),e.markersEvents.drag.emit(I)})}}),(e.markersEvents.markerDragEnd.observers.length||e.markersEvents.dragEnd.observers.length)&&f.on("dragend",x=>{if(x){const{target:I}=x;this.zone.run(()=>{e.markersEvents.markerDragEnd.emit(I),e.markersEvents.dragEnd.emit(I)})}}),f.setLngLat(e.markersOptions.feature?e.markersOptions.feature.geometry.coordinates:e.markersOptions.lngLat),this.zone.runOutsideAngular(()=>(f.addTo(this.mapInstance),f))}removeMarker(e){this.markersToRemove.push(e)}createPopup(e,s){return this.zone.runOutsideAngular(()=>{Object.keys(e.popupOptions).forEach(m=>void 0===e.popupOptions[m]&&delete e.popupOptions[m]);const f=new de.Popup(e.popupOptions);return f.setDOMContent(s),(e.popupEvents.popupClose.observers.length||e.popupEvents.close.observers.length)&&f.on("close",()=>{this.zone.run(()=>{e.popupEvents.popupClose.emit(),e.popupEvents.close.emit()})}),(e.popupEvents.popupOpen.observers.length||e.popupEvents.open.observers.length)&&f.on("open",()=>{this.zone.run(()=>{e.popupEvents.popupOpen.emit(),e.popupEvents.open.emit()})}),f})}addPopupToMap(e,s,f=!1){return this.zone.runOutsideAngular(()=>{f&&e._listeners&&delete e._listeners.open,e.setLngLat(s),e.addTo(this.mapInstance)})}addPopupToMarker(e,s){return this.zone.runOutsideAngular(()=>{e.setPopup(s)})}removePopupFromMap(e,s=!1){s&&e._listeners&&delete e._listeners.close,this.popupsToRemove.push(e)}removePopupFromMarker(e){return this.zone.runOutsideAngular(()=>{e.setPopup(void 0)})}addControl(e,s){return this.zone.runOutsideAngular(()=>{this.mapInstance.addControl(e,s)})}removeControl(e){return this.zone.runOutsideAngular(()=>{this.mapInstance.removeControl(e)})}loadAndAddImage(e,s,f){return Wl(this,void 0,void 0,function*(){return this.zone.runOutsideAngular(()=>new Promise((m,x)=>{this.mapInstance.loadImage(s,(I,M)=>{I?x(I):(this.addImage(e,M,f),m())})}))})}addImage(e,s,f){return this.zone.runOutsideAngular(()=>{this.mapInstance.addImage(e,s,f)})}removeImage(e){this.imageIdsToRemove.push(e)}addSource(e,s){return this.zone.runOutsideAngular(()=>{Object.keys(s).forEach(f=>void 0===s[f]&&delete s[f]),this.mapInstance.addSource(e,s)})}getSource(e){return this.mapInstance.getSource(e)}removeSource(e){this.zone.runOutsideAngular(()=>{this.findLayersBySourceId(e).forEach(s=>this.mapInstance.removeLayer(s.id)),this.mapInstance.removeSource(e)})}setAllLayerPaintProperty(e,s){return this.zone.runOutsideAngular(()=>{Object.keys(s).forEach(f=>{this.mapInstance.setPaintProperty(e,f,s[f])})})}setAllLayerLayoutProperty(e,s){return this.zone.runOutsideAngular(()=>{Object.keys(s).forEach(f=>{this.mapInstance.setLayoutProperty(e,f,s[f])})})}setLayerFilter(e,s){return this.zone.runOutsideAngular(()=>{this.mapInstance.setFilter(e,s)})}setLayerBefore(e,s){return this.zone.runOutsideAngular(()=>{this.mapInstance.moveLayer(e,s)})}setLayerZoomRange(e,s,f){return this.zone.runOutsideAngular(()=>{this.mapInstance.setLayerZoomRange(e,s||0,f||20)})}fitBounds(e,s){return this.zone.runOutsideAngular(()=>{this.mapInstance.fitBounds(e,s)})}fitScreenCoordinates(e,s,f){return this.zone.runOutsideAngular(()=>{this.mapInstance.fitScreenCoordinates(e[0],e[1],s,f)})}applyChanges(){this.zone.runOutsideAngular(()=>{this.removeMarkers(),this.removePopups(),this.removeImages()})}createMap(e){b.R0b.assertNotInAngularZone(),Object.keys(e).forEach(f=>{void 0===e[f]&&delete e[f]}),this.mapInstance=new de.Map(e),window&&/msie\s|trident\/|edge\//i.test(window.navigator.userAgent)&&this.mapInstance.setStyle(e.style),this.subscription.add(this.zone.onMicrotaskEmpty.subscribe(()=>this.applyChanges()))}removeMarkers(){for(const e of this.markersToRemove)e.remove();this.markersToRemove=[]}removePopups(){for(const e of this.popupsToRemove)e.remove();this.popupsToRemove=[]}removeImages(){for(const e of this.imageIdsToRemove)this.mapInstance.removeImage(e);this.imageIdsToRemove=[]}findLayersBySourceId(e){const s=this.mapInstance.getStyle().layers;return null==s?[]:s.filter(f=>"source"in f&&f.source===e)}hookEvents(e){this.mapInstance.on("load",s=>{this.mapLoaded.next(void 0),this.mapLoaded.complete(),this.zone.run(()=>{e.mapLoad.emit(s.target),e.load.emit(s.target)})}),(e.mapResize.observers.length||e.resize.observers.length)&&this.mapInstance.on("resize",s=>this.zone.run(()=>{e.mapResize.emit(s),e.resize.emit(s)})),(e.mapRemove.observers.length||e.remove.observers.length)&&this.mapInstance.on("remove",s=>this.zone.run(()=>{e.mapRemove.emit(s),e.remove.emit(s)})),(e.mapMouseDown.observers.length||e.mouseDown.observers.length)&&this.mapInstance.on("mousedown",s=>this.zone.run(()=>{e.mapMouseDown.emit(s),e.mouseDown.emit(s)})),(e.mapMouseUp.observers.length||e.mouseUp.observers.length)&&this.mapInstance.on("mouseup",s=>this.zone.run(()=>{e.mapMouseUp.emit(s),e.mouseUp.emit(s)})),(e.mapMouseMove.observers.length||e.mouseMove.observers.length)&&this.mapInstance.on("mousemove",s=>this.zone.run(()=>{e.mapMouseMove.emit(s),e.mouseMove.emit(s)})),(e.mapClick.observers.length||e.click.observers.length)&&this.mapInstance.on("click",s=>this.zone.run(()=>{e.mapClick.emit(s),e.click.emit(s)})),(e.mapDblClick.observers.length||e.dblClick.observers.length)&&this.mapInstance.on("dblclick",s=>this.zone.run(()=>{e.mapDblClick.emit(s),e.dblClick.emit(s)})),(e.mapMouseOver.observers.length||e.mouseOver.observers.length)&&this.mapInstance.on("mouseover",s=>this.zone.run(()=>{e.mapMouseOver.emit(s),e.mouseOver.emit(s)})),(e.mapMouseOut.observers.length||e.mouseOut.observers.length)&&this.mapInstance.on("mouseout",s=>this.zone.run(()=>{e.mapMouseOut.emit(s),e.mouseOut.emit(s)})),(e.mapContextMenu.observers.length||e.contextMenu.observers.length)&&this.mapInstance.on("contextmenu",s=>this.zone.run(()=>{e.mapContextMenu.emit(s),e.contextMenu.emit(s)})),(e.mapTouchStart.observers.length||e.touchStart.observers.length)&&this.mapInstance.on("touchstart",s=>this.zone.run(()=>{e.mapTouchStart.emit(s),e.touchStart.emit(s)})),(e.mapTouchEnd.observers.length||e.touchEnd.observers.length)&&this.mapInstance.on("touchend",s=>this.zone.run(()=>{e.mapTouchEnd.emit(s),e.touchEnd.emit(s)})),(e.mapTouchMove.observers.length||e.touchMove.observers.length)&&this.mapInstance.on("touchmove",s=>this.zone.run(()=>{e.mapTouchMove.emit(s),e.touchMove.emit(s)})),(e.mapTouchCancel.observers.length||e.touchCancel.observers.length)&&this.mapInstance.on("touchcancel",s=>this.zone.run(()=>{e.mapTouchCancel.emit(s),e.touchCancel.emit(s)})),(e.mapWheel.observers.length||e.wheel.observers.length)&&this.mapInstance.on("wheel",s=>this.zone.run(()=>{e.mapWheel.emit(s),e.wheel.emit(s)})),e.moveStart.observers.length&&this.mapInstance.on("movestart",s=>this.zone.run(()=>e.moveStart.emit(s))),e.move.observers.length&&this.mapInstance.on("move",s=>this.zone.run(()=>e.move.emit(s))),e.moveEnd.observers.length&&this.mapInstance.on("moveend",s=>this.zone.run(()=>e.moveEnd.emit(s))),(e.mapDragStart.observers.length||e.dragStart.observers.length)&&this.mapInstance.on("dragstart",s=>this.zone.run(()=>{e.mapDragStart.emit(s),e.dragStart.emit(s)})),(e.mapDrag.observers.length||e.drag.observers.length)&&this.mapInstance.on("drag",s=>this.zone.run(()=>{e.mapDrag.emit(s),e.drag.emit(s)})),(e.mapDragEnd.observers.length||e.dragEnd.observers.length)&&this.mapInstance.on("dragend",s=>this.zone.run(()=>{e.mapDragEnd.emit(s),e.dragEnd.emit(s)})),e.zoomStart.observers.length&&this.mapInstance.on("zoomstart",s=>this.zone.run(()=>e.zoomStart.emit(s))),e.zoomEvt.observers.length&&this.mapInstance.on("zoom",s=>this.zone.run(()=>e.zoomEvt.emit(s))),e.zoomEnd.observers.length&&this.mapInstance.on("zoomend",s=>this.zone.run(()=>e.zoomEnd.emit(s))),e.rotateStart.observers.length&&this.mapInstance.on("rotatestart",s=>this.zone.run(()=>e.rotateStart.emit(s))),e.rotate.observers.length&&this.mapInstance.on("rotate",s=>this.zone.run(()=>e.rotate.emit(s))),e.rotateEnd.observers.length&&this.mapInstance.on("rotateend",s=>this.zone.run(()=>e.rotateEnd.emit(s))),e.pitchStart.observers.length&&this.mapInstance.on("pitchstart",s=>this.zone.run(()=>e.pitchStart.emit(s))),e.pitchEvt.observers.length&&this.mapInstance.on("pitch",s=>this.zone.run(()=>e.pitchEvt.emit(s))),e.pitchEnd.observers.length&&this.mapInstance.on("pitchend",s=>this.zone.run(()=>e.pitchEnd.emit(s))),e.boxZoomStart.observers.length&&this.mapInstance.on("boxzoomstart",s=>this.zone.run(()=>e.boxZoomStart.emit(s))),e.boxZoomEnd.observers.length&&this.mapInstance.on("boxzoomend",s=>this.zone.run(()=>e.boxZoomEnd.emit(s))),e.boxZoomCancel.observers.length&&this.mapInstance.on("boxzoomcancel",s=>this.zone.run(()=>e.boxZoomCancel.emit(s))),e.webGlContextLost.observers.length&&this.mapInstance.on("webglcontextlost",s=>this.zone.run(()=>e.webGlContextLost.emit(s))),e.webGlContextRestored.observers.length&&this.mapInstance.on("webglcontextrestored",s=>this.zone.run(()=>e.webGlContextRestored.emit(s))),e.render.observers.length&&this.mapInstance.on("render",s=>this.zone.run(()=>e.render.emit(s))),(e.mapError.observers.length||e.error.observers.length)&&this.mapInstance.on("error",s=>this.zone.run(()=>{e.mapError.emit(s),e.error.emit(s)})),e.data.observers.length&&this.mapInstance.on("data",s=>this.zone.run(()=>e.data.emit(s))),e.styleData.observers.length&&this.mapInstance.on("styledata",s=>this.zone.run(()=>e.styleData.emit(s))),e.sourceData.observers.length&&this.mapInstance.on("sourcedata",s=>this.zone.run(()=>e.sourceData.emit(s))),e.dataLoading.observers.length&&this.mapInstance.on("dataloading",s=>this.zone.run(()=>e.dataLoading.emit(s))),e.styleDataLoading.observers.length&&this.mapInstance.on("styledataloading",s=>this.zone.run(()=>e.styleDataLoading.emit(s))),e.sourceDataLoading.observers.length&&this.mapInstance.on("sourcedataloading",s=>this.zone.run(()=>e.sourceDataLoading.emit(s))),e.styleImageMissing.observers.length&&this.mapInstance.on("styleimagemissing",s=>this.zone.run(()=>e.styleImageMissing.emit(s))),e.idle.observers.length&&this.mapInstance.on("idle",s=>this.zone.run(()=>e.idle.emit(s)))}assign(e,s,f){if("string"==typeof s&&(s=s.split(".")),s.length>1){const m=s.shift();this.assign(e[m]="[object Object]"===Object.prototype.toString.call(e[m])?e[m]:{},s,f)}else e[s[0]]=f}}return r.\u0275fac=function(e){return new(e||r)(b.LFG(b.R0b))},r.\u0275prov=b.Yz7({token:r,factory:r.\u0275fac}),r})();class Ty{constructor(o){this.container=o}onAdd(){return this.container}onRemove(){return this.container.parentNode.removeChild(this.container)}getDefaultPosition(){return"top-right"}}let Rf=(()=>{class r{constructor(e){this.MapService=e,this.controlAdded=!1}ngAfterContentInit(){this.content.nativeElement.childNodes.length&&(this.control=new Ty(this.content.nativeElement),this.MapService.mapCreated$.subscribe(()=>{this.MapService.addControl(this.control,this.position),this.controlAdded=!0}))}ngOnDestroy(){this.controlAdded&&this.MapService.removeControl(this.control)}}return r.\u0275fac=function(e){return new(e||r)(b.Y36(Cc))},r.\u0275cmp=b.Xpm({type:r,selectors:[["mgl-control"]],viewQuery:function(e,s){if(1&e&&b.Gf(wy,7),2&e){let f;b.iGM(f=b.CRH())&&(s.content=f.first)}},inputs:{position:"position"},ngContentSelectors:Ey,decls:3,vars:0,consts:[[1,"maplibregl-ctrl"],["content",""]],template:function(e,s){1&e&&(b.F$t(),b.TgZ(0,"div",0,1),b.Hsn(2),b.qZA())},encapsulation:2,changeDetection:0}),r})(),Ay=(()=>{class r{constructor(e,s){this.MapService=e,this.ControlComponent=s,this.geolocate=new b.vpe}ngAfterContentInit(){this.MapService.mapCreated$.subscribe(()=>{if(this.ControlComponent.control)throw new Error("Another control is already set for this control");const e={positionOptions:this.positionOptions,fitBoundsOptions:this.fitBoundsOptions,trackUserLocation:this.trackUserLocation,showUserLocation:this.showUserLocation};Object.keys(e).forEach(s=>{void 0===e[s]&&delete e[s]}),this.ControlComponent.control=new de.GeolocateControl(e),this.ControlComponent.control.on("geolocate",s=>{this.geolocate.emit(s)}),this.MapService.addControl(this.ControlComponent.control,this.ControlComponent.position)})}}return r.\u0275fac=function(e){return new(e||r)(b.Y36(Cc),b.Y36(Rf,1))},r.\u0275dir=b.lG2({type:r,selectors:[["","mglGeolocate",""]],inputs:{positionOptions:"positionOptions",fitBoundsOptions:"fitBoundsOptions",trackUserLocation:"trackUserLocation",showUserLocation:"showUserLocation"},outputs:{geolocate:"geolocate"}}),r})(),Ly=(()=>{class r{constructor(e,s){this.MapService=e,this.ControlComponent=s}ngAfterContentInit(){this.MapService.mapCreated$.subscribe(()=>{if(this.ControlComponent.control)throw new Error("Another control is already set for this control");const e={};void 0!==this.showCompass&&(e.showCompass=this.showCompass),void 0!==this.showZoom&&(e.showZoom=this.showZoom),this.ControlComponent.control=new de.NavigationControl(e),this.MapService.addControl(this.ControlComponent.control,this.ControlComponent.position)})}}return r.\u0275fac=function(e){return new(e||r)(b.Y36(Cc),b.Y36(Rf,1))},r.\u0275dir=b.lG2({type:r,selectors:[["","mglNavigation",""]],inputs:{showCompass:"showCompass",showZoom:"showZoom"}}),r})(),Oy=(()=>{class r{constructor(e,s){this.MapService=e,this.ControlComponent=s}ngOnChanges(e){e.unit&&!e.unit.isFirstChange()&&this.ControlComponent.control.setUnit(e.unit.currentValue)}ngAfterContentInit(){this.MapService.mapCreated$.subscribe(()=>{if(this.ControlComponent.control)throw new Error("Another control is already set for this control");const e={};void 0!==this.maxWidth&&(e.maxWidth=this.maxWidth),void 0!==this.unit&&(e.unit=this.unit),this.ControlComponent.control=new de.ScaleControl(e),this.MapService.addControl(this.ControlComponent.control,this.ControlComponent.position)})}}return r.\u0275fac=function(e){return new(e||r)(b.Y36(Cc),b.Y36(Rf,1))},r.\u0275dir=b.lG2({type:r,selectors:[["","mglScale",""]],inputs:{maxWidth:"maxWidth",unit:"unit"},features:[b.TTD]}),r})();function gm(r,o,e){console.warn(`[ngx-maplibre-gl]: ${r}: ${o} is deprecated, please use ${e} instead.`)}let mm=(()=>{class r{constructor(e,s){this.MapService=e,this.zone=s,this.updateFeatureData=new jd.xQ,this.sub=new Df.w,this.sourceAdded=!1,this.featureIdCounter=0}ngOnInit(){this.data||(this.data={type:"FeatureCollection",features:[]});const e=this.MapService.mapLoaded$.subscribe(()=>{this.init();const s=(0,pm.R)(this.MapService.mapInstance,"styledata").pipe((0,fm.h)(()=>!this.MapService.mapInstance.getSource(this.id))).subscribe(()=>{this.init()});this.sub.add(s)});this.sub.add(e)}ngOnChanges(e){!this.sourceAdded||((e.maxzoom&&!e.maxzoom.isFirstChange()||e.attribution&&!e.attribution.isFirstChange()||e.buffer&&!e.buffer.isFirstChange()||e.tolerance&&!e.tolerance.isFirstChange()||e.cluster&&!e.cluster.isFirstChange()||e.clusterRadius&&!e.clusterRadius.isFirstChange()||e.clusterMaxZoom&&!e.clusterMaxZoom.isFirstChange()||e.clusterMinPoints&&!e.clusterMinPoints.isFirstChange()||e.clusterProperties&&!e.clusterProperties.isFirstChange()||e.lineMetrics&&!e.lineMetrics.isFirstChange()||e.generateId&&!e.generateId.isFirstChange()||e.promoteId&&!e.promoteId.isFirstChange()||e.filter&&!e.filter.isFirstChange())&&(this.ngOnDestroy(),this.ngOnInit()),e.data&&!e.data.isFirstChange()&&setTimeout(()=>{this.MapService.getSource(this.id).setData(this.data)},0))}ngOnDestroy(){this.sub.unsubscribe(),this.sourceAdded&&(this.MapService.removeSource(this.id),this.sourceAdded=!1)}getClusterExpansionZoom(e){return Wl(this,void 0,void 0,function*(){const s=this.MapService.getSource(this.id);return this.zone.run(()=>Wl(this,void 0,void 0,function*(){return new Promise((f,m)=>{s.getClusterExpansionZoom(e,(x,I)=>{x?m(x):f(I)})})}))})}getClusterChildren(e){return Wl(this,void 0,void 0,function*(){const s=this.MapService.getSource(this.id);return this.zone.run(()=>Wl(this,void 0,void 0,function*(){return new Promise((f,m)=>{s.getClusterChildren(e,(x,I)=>{x?m(x):f(I)})})}))})}getClusterLeaves(e,s,f){return Wl(this,void 0,void 0,function*(){const m=this.MapService.getSource(this.id);return this.zone.run(()=>Wl(this,void 0,void 0,function*(){return new Promise((x,I)=>{m.getClusterLeaves(e,s,f,(M,S)=>{M?I(M):x(S)})})}))})}_addFeature(e){this.data.features.push(e),this.updateFeatureData.next()}_removeFeature(e){const s=this.data,f=s.features.indexOf(e);f>-1&&s.features.splice(f,1),this.updateFeatureData.next()}_getNewFeatureId(){return++this.featureIdCounter}init(){this.MapService.addSource(this.id,{type:"geojson",data:this.data,maxzoom:this.maxzoom,attribution:this.attribution,buffer:this.buffer,tolerance:this.tolerance,cluster:this.cluster,clusterRadius:this.clusterRadius,clusterMaxZoom:this.clusterMaxZoom,clusterMinPoints:this.clusterMinPoints,clusterProperties:this.clusterProperties,lineMetrics:this.lineMetrics,generateId:this.generateId,promoteId:this.promoteId,filter:this.filter});const s=this.updateFeatureData.pipe((0,Yd.b)(0)).subscribe(()=>{this.MapService.getSource(this.id).setData(this.data)});this.sub.add(s),this.sourceAdded=!0}}return r.\u0275fac=function(e){return new(e||r)(b.Y36(Cc),b.Y36(b.R0b))},r.\u0275cmp=b.Xpm({type:r,selectors:[["mgl-geojson-source"]],inputs:{id:"id",data:"data",maxzoom:"maxzoom",attribution:"attribution",buffer:"buffer",tolerance:"tolerance",cluster:"cluster",clusterRadius:"clusterRadius",clusterMaxZoom:"clusterMaxZoom",clusterMinPoints:"clusterMinPoints",clusterProperties:"clusterProperties",lineMetrics:"lineMetrics",generateId:"generateId",promoteId:"promoteId",filter:"filter"},features:[b.TTD],decls:0,vars:0,template:function(e,s){},encapsulation:2,changeDetection:0}),r})(),Dy=(()=>{class r{constructor(e){this.GeoJSONSourceComponent=e,this.type="Feature"}ngOnInit(){this.id||(this.id=this.GeoJSONSourceComponent._getNewFeatureId()),this.feature={type:this.type,geometry:this.geometry,properties:this.properties?this.properties:{}},this.feature.id=this.id,this.GeoJSONSourceComponent._addFeature(this.feature)}ngOnDestroy(){this.GeoJSONSourceComponent._removeFeature(this.feature)}updateCoordinates(e){this.feature.geometry.coordinates=e,this.GeoJSONSourceComponent.updateFeatureData.next()}}return r.\u0275fac=function(e){return new(e||r)(b.Y36((0,b.Gpc)(()=>mm)))},r.\u0275cmp=b.Xpm({type:r,selectors:[["mgl-feature"]],inputs:{id:"id",geometry:"geometry",properties:"properties"},decls:0,vars:0,template:function(e,s){},encapsulation:2,changeDetection:0}),r})(),Ry=(()=>{class r{constructor(e){this.MapService=e,this.layerClick=new b.vpe,this.layerDblClick=new b.vpe,this.layerMouseDown=new b.vpe,this.layerMouseUp=new b.vpe,this.layerMouseEnter=new b.vpe,this.layerMouseLeave=new b.vpe,this.layerMouseMove=new b.vpe,this.layerMouseOver=new b.vpe,this.layerMouseOut=new b.vpe,this.layerContextMenu=new b.vpe,this.layerTouchStart=new b.vpe,this.layerTouchEnd=new b.vpe,this.layerTouchCancel=new b.vpe,this.click=new b.vpe,this.dblClick=new b.vpe,this.mouseDown=new b.vpe,this.mouseUp=new b.vpe,this.mouseEnter=new b.vpe,this.mouseLeave=new b.vpe,this.mouseMove=new b.vpe,this.mouseOver=new b.vpe,this.mouseOut=new b.vpe,this.contextMenu=new b.vpe,this.touchStart=new b.vpe,this.touchEnd=new b.vpe,this.touchCancel=new b.vpe,this.layerAdded=!1}ngOnInit(){this.warnDeprecatedOutputs(),this.sub=this.MapService.mapLoaded$.pipe((0,_y.w)(()=>(0,pm.R)(this.MapService.mapInstance,"styledata").pipe((0,xy.h)(!1),(0,fm.h)(()=>!this.MapService.mapInstance.getLayer(this.id)),(0,by.O)(!0)))).subscribe(e=>this.init(e))}ngOnChanges(e){!this.layerAdded||(e.paint&&!e.paint.isFirstChange()&&this.MapService.setAllLayerPaintProperty(this.id,e.paint.currentValue),e.layout&&!e.layout.isFirstChange()&&this.MapService.setAllLayerLayoutProperty(this.id,e.layout.currentValue),e.filter&&!e.filter.isFirstChange()&&this.MapService.setLayerFilter(this.id,e.filter.currentValue),e.before&&!e.before.isFirstChange()&&this.MapService.setLayerBefore(this.id,e.before.currentValue),(e.minzoom&&!e.minzoom.isFirstChange()||e.maxzoom&&!e.maxzoom.isFirstChange())&&this.MapService.setLayerZoomRange(this.id,this.minzoom,this.maxzoom))}ngOnDestroy(){this.layerAdded&&this.MapService.removeLayer(this.id),this.sub&&this.sub.unsubscribe()}init(e){this.MapService.addLayer({layerOptions:{id:this.id,type:this.type,source:this.source,metadata:this.metadata,"source-layer":this.sourceLayer,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this.layout,paint:this.paint},layerEvents:{layerClick:this.layerClick,layerDblClick:this.layerDblClick,layerMouseDown:this.layerMouseDown,layerMouseUp:this.layerMouseUp,layerMouseEnter:this.layerMouseEnter,layerMouseLeave:this.layerMouseLeave,layerMouseMove:this.layerMouseMove,layerMouseOver:this.layerMouseOver,layerMouseOut:this.layerMouseOut,layerContextMenu:this.layerContextMenu,layerTouchStart:this.layerTouchStart,layerTouchEnd:this.layerTouchEnd,layerTouchCancel:this.layerTouchCancel,click:this.click,dblClick:this.dblClick,mouseDown:this.mouseDown,mouseUp:this.mouseUp,mouseEnter:this.mouseEnter,mouseLeave:this.mouseLeave,mouseMove:this.mouseMove,mouseOver:this.mouseOver,mouseOut:this.mouseOut,contextMenu:this.contextMenu,touchStart:this.touchStart,touchEnd:this.touchEnd,touchCancel:this.touchCancel}},e,this.before),this.layerAdded=!0}warnDeprecatedOutputs(){const e=gm.bind(void 0,r.name);this.click.observers.length&&e("click","layerClick"),this.dblClick.observers.length&&e("dblClick","layerDblClick"),this.mouseDown.observers.length&&e("mouseDown","layerMouseDown"),this.mouseUp.observers.length&&e("mouseUp","layerMouseUp"),this.mouseEnter.observers.length&&e("mouseEnter","layerMouseEnter"),this.mouseLeave.observers.length&&e("mouseLeave","layerMouseLeave"),this.mouseMove.observers.length&&e("mouseMove","layerMouseMove"),this.mouseOver.observers.length&&e("mouseOver","layerMouseOver"),this.mouseOut.observers.length&&e("mouseOut","layerMouseOut"),this.contextMenu.observers.length&&e("contextMenu","layerContextMenu"),this.touchStart.observers.length&&e("touchStart","layerTouchStart"),this.touchEnd.observers.length&&e("touchEnd","layerTouchEnd"),this.touchCancel.observers.length&&e("touchCancel","layerTouchCancel")}}return r.\u0275fac=function(e){return new(e||r)(b.Y36(Cc))},r.\u0275cmp=b.Xpm({type:r,selectors:[["mgl-layer"]],inputs:{id:"id",source:"source",type:"type",metadata:"metadata",sourceLayer:"sourceLayer",filter:"filter",layout:"layout",paint:"paint",before:"before",minzoom:"minzoom",maxzoom:"maxzoom"},outputs:{layerClick:"layerClick",layerDblClick:"layerDblClick",layerMouseDown:"layerMouseDown",layerMouseUp:"layerMouseUp",layerMouseEnter:"layerMouseEnter",layerMouseLeave:"layerMouseLeave",layerMouseMove:"layerMouseMove",layerMouseOver:"layerMouseOver",layerMouseOut:"layerMouseOut",layerContextMenu:"layerContextMenu",layerTouchStart:"layerTouchStart",layerTouchEnd:"layerTouchEnd",layerTouchCancel:"layerTouchCancel",click:"click",dblClick:"dblClick",mouseDown:"mouseDown",mouseUp:"mouseUp",mouseEnter:"mouseEnter",mouseLeave:"mouseLeave",mouseMove:"mouseMove",mouseOver:"mouseOver",mouseOut:"mouseOut",contextMenu:"contextMenu",touchStart:"touchStart",touchEnd:"touchEnd",touchCancel:"touchCancel"},features:[b.TTD],decls:0,vars:0,template:function(e,s){},encapsulation:2}),r})(),Ny=(()=>{class r{constructor(e){this.MapService=e,this.movingMethod="flyTo",this.mapResize=new b.vpe,this.mapRemove=new b.vpe,this.mapMouseDown=new b.vpe,this.mapMouseUp=new b.vpe,this.mapMouseMove=new b.vpe,this.mapClick=new b.vpe,this.mapDblClick=new b.vpe,this.mapMouseOver=new b.vpe,this.mapMouseOut=new b.vpe,this.mapContextMenu=new b.vpe,this.mapTouchStart=new b.vpe,this.mapTouchEnd=new b.vpe,this.mapTouchMove=new b.vpe,this.mapTouchCancel=new b.vpe,this.mapWheel=new b.vpe,this.moveStart=new b.vpe,this.move=new b.vpe,this.moveEnd=new b.vpe,this.mapDragStart=new b.vpe,this.mapDrag=new b.vpe,this.mapDragEnd=new b.vpe,this.zoomStart=new b.vpe,this.zoomEvt=new b.vpe,this.zoomEnd=new b.vpe,this.rotateStart=new b.vpe,this.rotate=new b.vpe,this.rotateEnd=new b.vpe,this.pitchStart=new b.vpe,this.pitchEvt=new b.vpe,this.pitchEnd=new b.vpe,this.boxZoomStart=new b.vpe,this.boxZoomEnd=new b.vpe,this.boxZoomCancel=new b.vpe,this.webGlContextLost=new b.vpe,this.webGlContextRestored=new b.vpe,this.mapLoad=new b.vpe,this.idle=new b.vpe,this.render=new b.vpe,this.mapError=new b.vpe,this.data=new b.vpe,this.styleData=new b.vpe,this.sourceData=new b.vpe,this.dataLoading=new b.vpe,this.styleDataLoading=new b.vpe,this.sourceDataLoading=new b.vpe,this.styleImageMissing=new b.vpe,this.resize=new b.vpe,this.remove=new b.vpe,this.mouseDown=new b.vpe,this.mouseUp=new b.vpe,this.mouseMove=new b.vpe,this.click=new b.vpe,this.dblClick=new b.vpe,this.mouseOver=new b.vpe,this.mouseOut=new b.vpe,this.contextMenu=new b.vpe,this.touchStart=new b.vpe,this.touchEnd=new b.vpe,this.touchMove=new b.vpe,this.touchCancel=new b.vpe,this.wheel=new b.vpe,this.dragStart=new b.vpe,this.drag=new b.vpe,this.dragEnd=new b.vpe,this.load=new b.vpe,this.error=new b.vpe}get mapInstance(){return this.MapService.mapInstance}ngAfterViewInit(){this.warnDeprecatedOutputs(),this.MapService.setup({customMapboxApiUrl:this.customMapboxApiUrl,mapOptions:{collectResourceTiming:this.collectResourceTiming,container:this.mapContainer.nativeElement,crossSourceCollisions:this.crossSourceCollisions,fadeDuration:this.fadeDuration,minZoom:this.minZoom,maxZoom:this.maxZoom,minPitch:this.minPitch,maxPitch:this.maxPitch,style:this.style,hash:this.hash,interactive:this.interactive,bearingSnap:this.bearingSnap,pitchWithRotate:this.pitchWithRotate,clickTolerance:this.clickTolerance,attributionControl:this.attributionControl,logoPosition:this.logoPosition,failIfMajorPerformanceCaveat:this.failIfMajorPerformanceCaveat,preserveDrawingBuffer:this.preserveDrawingBuffer,refreshExpiredTiles:this.refreshExpiredTiles,maxBounds:this.maxBounds,scrollZoom:this.scrollZoom,boxZoom:this.boxZoom,dragRotate:this.dragRotate,dragPan:this.dragPan,keyboard:this.keyboard,doubleClickZoom:this.doubleClickZoom,touchPitch:this.touchPitch,touchZoomRotate:this.touchZoomRotate,trackResize:this.trackResize,center:this.center,zoom:this.zoom,bearing:this.bearing,pitch:this.pitch,renderWorldCopies:this.renderWorldCopies,maxTileCacheSize:this.maxTileCacheSize,localIdeographFontFamily:this.localIdeographFontFamily,transformRequest:this.transformRequest,bounds:this.bounds?this.bounds:this.fitBounds,fitBoundsOptions:this.fitBoundsOptions,antialias:this.antialias,locale:this.locale},mapEvents:this}),this.cursorStyle&&this.MapService.changeCanvasCursor(this.cursorStyle)}ngOnDestroy(){this.MapService.destroyMap()}ngOnChanges(e){return Wl(this,void 0,void 0,function*(){yield this.MapService.mapCreated$.toPromise(),e.cursorStyle&&!e.cursorStyle.isFirstChange()&&this.MapService.changeCanvasCursor(e.cursorStyle.currentValue),e.minZoom&&!e.minZoom.isFirstChange()&&this.MapService.updateMinZoom(e.minZoom.currentValue),e.maxZoom&&!e.maxZoom.isFirstChange()&&this.MapService.updateMaxZoom(e.maxZoom.currentValue),e.minPitch&&!e.minPitch.isFirstChange()&&this.MapService.updateMinPitch(e.minPitch.currentValue),e.maxPitch&&!e.maxPitch.isFirstChange()&&this.MapService.updateMaxPitch(e.maxPitch.currentValue),e.renderWorldCopies&&!e.renderWorldCopies.isFirstChange()&&this.MapService.updateRenderWorldCopies(e.renderWorldCopies.currentValue),e.scrollZoom&&!e.scrollZoom.isFirstChange()&&this.MapService.updateScrollZoom(e.scrollZoom.currentValue),e.dragRotate&&!e.dragRotate.isFirstChange()&&this.MapService.updateDragRotate(e.dragRotate.currentValue),e.touchPitch&&!e.touchPitch.isFirstChange()&&this.MapService.updateTouchPitch(e.touchPitch.currentValue),e.touchZoomRotate&&!e.touchZoomRotate.isFirstChange()&&this.MapService.updateTouchZoomRotate(e.touchZoomRotate.currentValue),e.doubleClickZoom&&!e.doubleClickZoom.isFirstChange()&&this.MapService.updateDoubleClickZoom(e.doubleClickZoom.currentValue),e.keyboard&&!e.keyboard.isFirstChange()&&this.MapService.updateKeyboard(e.keyboard.currentValue),e.dragPan&&!e.dragPan.isFirstChange()&&this.MapService.updateDragPan(e.dragPan.currentValue),e.boxZoom&&!e.boxZoom.isFirstChange()&&this.MapService.updateBoxZoom(e.boxZoom.currentValue),e.style&&!e.style.isFirstChange()&&this.MapService.updateStyle(e.style.currentValue),e.maxBounds&&!e.maxBounds.isFirstChange()&&this.MapService.updateMaxBounds(e.maxBounds.currentValue),e.fitBounds&&e.fitBounds.currentValue&&!e.fitBounds.isFirstChange()&&this.MapService.fitBounds(e.fitBounds.currentValue,this.fitBoundsOptions),e.fitScreenCoordinates&&e.fitScreenCoordinates.currentValue&&((this.center||this.zoom||this.pitch||this.fitBounds)&&e.fitScreenCoordinates.isFirstChange()&&console.warn("[ngx-mapbox-gl] center / zoom / pitch / fitBounds inputs are being overridden by fitScreenCoordinates input"),this.MapService.fitScreenCoordinates(e.fitScreenCoordinates.currentValue,this.bearing?this.bearing[0]:0,this.movingOptions)),!this.centerWithPanTo||!e.center||e.center.isFirstChange()||e.zoom||e.bearing||e.pitch?(e.center&&!e.center.isFirstChange()||e.zoom&&!e.zoom.isFirstChange()||e.bearing&&!e.bearing.isFirstChange()&&!e.fitScreenCoordinates||e.pitch&&!e.pitch.isFirstChange())&&this.MapService.move(this.movingMethod,this.movingOptions,e.zoom&&this.zoom?this.zoom[0]:void 0,e.center?this.center:void 0,e.bearing&&this.bearing?this.bearing[0]:void 0,e.pitch&&this.pitch?this.pitch[0]:void 0):this.MapService.panTo(this.center,this.panToOptions)})}warnDeprecatedOutputs(){const e=gm.bind(void 0,r.name);this.resize.observers.length&&e("resize","mapResize"),this.remove.observers.length&&e("remove","mapRemove"),this.mouseDown.observers.length&&e("mouseDown","mapMouseDown"),this.mouseUp.observers.length&&e("mouseUp","mapMouseUp"),this.mouseMove.observers.length&&e("mouseMove","mapMouseMove"),this.click.observers.length&&e("click","mapClick"),this.dblClick.observers.length&&e("dblClick","mapDblClick"),this.mouseOver.observers.length&&e("mouseOver","mapMouseOver"),this.mouseOut.observers.length&&e("mouseOut","mapMouseOut"),this.contextMenu.observers.length&&e("contextMenu","mapContextMenu"),this.touchStart.observers.length&&e("touchStart","mapTouchStart"),this.touchEnd.observers.length&&e("touchEnd","mapTouchEnd"),this.touchMove.observers.length&&e("touchMove","mapTouchMove"),this.touchCancel.observers.length&&e("touchCancel","mapTouchCancel"),this.wheel.observers.length&&e("wheel","mapWheel"),this.dragStart.observers.length&&e("dragStart","mapDragStart"),this.drag.observers.length&&e("drag","mapDrag"),this.dragEnd.observers.length&&e("dragEnd","mapDragEnd"),this.load.observers.length&&e("load","mapLoad"),this.error.observers.length&&e("error","mapError")}}return r.\u0275fac=function(e){return new(e||r)(b.Y36(Cc))},r.\u0275cmp=b.Xpm({type:r,selectors:[["mgl-map"]],viewQuery:function(e,s){if(1&e&&b.Gf(Cy,7),2&e){let f;b.iGM(f=b.CRH())&&(s.mapContainer=f.first)}},inputs:{collectResourceTiming:"collectResourceTiming",crossSourceCollisions:"crossSourceCollisions",customMapboxApiUrl:"customMapboxApiUrl",fadeDuration:"fadeDuration",hash:"hash",refreshExpiredTiles:"refreshExpiredTiles",failIfMajorPerformanceCaveat:"failIfMajorPerformanceCaveat",bearingSnap:"bearingSnap",interactive:"interactive",pitchWithRotate:"pitchWithRotate",clickTolerance:"clickTolerance",attributionControl:"attributionControl",logoPosition:"logoPosition",maxTileCacheSize:"maxTileCacheSize",localIdeographFontFamily:"localIdeographFontFamily",preserveDrawingBuffer:"preserveDrawingBuffer",trackResize:"trackResize",transformRequest:"transformRequest",bounds:"bounds",antialias:"antialias",locale:"locale",minZoom:"minZoom",maxZoom:"maxZoom",minPitch:"minPitch",maxPitch:"maxPitch",scrollZoom:"scrollZoom",dragRotate:"dragRotate",touchPitch:"touchPitch",touchZoomRotate:"touchZoomRotate",doubleClickZoom:"doubleClickZoom",keyboard:"keyboard",dragPan:"dragPan",boxZoom:"boxZoom",style:"style",center:"center",maxBounds:"maxBounds",zoom:"zoom",bearing:"bearing",pitch:"pitch",fitBoundsOptions:"fitBoundsOptions",renderWorldCopies:"renderWorldCopies",movingMethod:"movingMethod",movingOptions:"movingOptions",fitBounds:"fitBounds",fitScreenCoordinates:"fitScreenCoordinates",centerWithPanTo:"centerWithPanTo",panToOptions:"panToOptions",cursorStyle:"cursorStyle"},outputs:{mapResize:"mapResize",mapRemove:"mapRemove",mapMouseDown:"mapMouseDown",mapMouseUp:"mapMouseUp",mapMouseMove:"mapMouseMove",mapClick:"mapClick",mapDblClick:"mapDblClick",mapMouseOver:"mapMouseOver",mapMouseOut:"mapMouseOut",mapContextMenu:"mapContextMenu",mapTouchStart:"mapTouchStart",mapTouchEnd:"mapTouchEnd",mapTouchMove:"mapTouchMove",mapTouchCancel:"mapTouchCancel",mapWheel:"mapWheel",moveStart:"moveStart",move:"move",moveEnd:"moveEnd",mapDragStart:"mapDragStart",mapDrag:"mapDrag",mapDragEnd:"mapDragEnd",zoomStart:"zoomStart",zoomEvt:"zoomEvt",zoomEnd:"zoomEnd",rotateStart:"rotateStart",rotate:"rotate",rotateEnd:"rotateEnd",pitchStart:"pitchStart",pitchEvt:"pitchEvt",pitchEnd:"pitchEnd",boxZoomStart:"boxZoomStart",boxZoomEnd:"boxZoomEnd",boxZoomCancel:"boxZoomCancel",webGlContextLost:"webGlContextLost",webGlContextRestored:"webGlContextRestored",mapLoad:"mapLoad",idle:"idle",render:"render",mapError:"mapError",data:"data",styleData:"styleData",sourceData:"sourceData",dataLoading:"dataLoading",styleDataLoading:"styleDataLoading",sourceDataLoading:"sourceDataLoading",styleImageMissing:"styleImageMissing",resize:"resize",remove:"remove",mouseDown:"mouseDown",mouseUp:"mouseUp",mouseMove:"mouseMove",click:"click",dblClick:"dblClick",mouseOver:"mouseOver",mouseOut:"mouseOut",contextMenu:"contextMenu",touchStart:"touchStart",touchEnd:"touchEnd",touchMove:"touchMove",touchCancel:"touchCancel",wheel:"wheel",dragStart:"dragStart",drag:"drag",dragEnd:"dragEnd",load:"load",error:"error"},features:[b._Bn([Cc]),b.TTD],decls:2,vars:0,consts:[["container",""]],template:function(e,s){1&e&&b._UZ(0,"div",null,0)},styles:["[_nghost-%COMP%] {\n        display: block;\n      }\n      div[_ngcontent-%COMP%] {\n        height: 100%;\n        width: 100%;\n      }"],changeDetection:0}),r})(),zy=(()=>{class r{}return r.\u0275fac=function(e){return new(e||r)},r.\u0275mod=b.oAB({type:r}),r.\u0275inj=b.cJS({imports:[[Ya.ez]]}),r})();var Tn=wt(3679);let ym=(()=>{class r{}return r.EsriGeocode="Esri Geocode",r.EsriSuggestion="Esri Suggestion",r.DDCoordinate="Coordinate",r})();var Nf=function(){return(Nf=Object.assign||function(o){for(var e,s=1,f=arguments.length;s<f;s++)for(var m in e=arguments[s])Object.prototype.hasOwnProperty.call(e,m)&&(o[m]=e[m]);return o}).apply(this,arguments)},Hd=function(r,o){return(Hd=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,s){e.__proto__=s}||function(e,s){for(var f in s)s.hasOwnProperty(f)&&(e[f]=s[f])})(r,o)},qs=function(){return(qs=Object.assign||function(o){for(var e,s=1,f=arguments.length;s<f;s++)for(var m in e=arguments[s])Object.prototype.hasOwnProperty.call(e,m)&&(o[m]=e[m]);return o}).apply(this,arguments)};function xm(r){return Object.keys(r).some(function(o){var e=r[o];if(!e)return!1;switch(e&&e.toParam&&(e=e.toParam()),e.constructor.name){case"Array":case"Object":case"Date":case"Function":case"Boolean":case"String":case"Number":return!1;default:return!0}})}function bm(r){var o={};return Object.keys(r).forEach(function(e){var s,f,m=r[e];if(m&&m.toParam&&(m=m.toParam()),m||0===m||"boolean"==typeof m||"string"==typeof m){var I;switch(m.constructor.name){case"Array":var M=null===(f=null===(s=m[0])||void 0===s?void 0:s.constructor)||void 0===f?void 0:f.name;I="Array"===M?m:"Object"===M?JSON.stringify(m):m.join(",");break;case"Object":I=JSON.stringify(m);break;case"Date":I=m.valueOf();break;case"Function":I=null;break;case"Boolean":I=m+"";break;default:I=m}(I||0===I||"string"==typeof I||Array.isArray(I))&&(o[e]=I)}}),o}function wm(r,o){return Array.isArray(o)&&o[0]&&Array.isArray(o[0])?o.map(function(e){return wm(r,e)}).join("&"):encodeURIComponent(r)+"="+encodeURIComponent(o)}function Jd(r){var o=bm(r);return Object.keys(o).map(function(e){return wm(e,o[e])}).join("&")}var Sc=function(o,e,s,f,m){o=o||"UNKNOWN_ERROR",e=e||"UNKNOWN_ERROR_CODE",this.name="ArcGISRequestError",this.message="UNKNOWN_ERROR_CODE"===e?o:e+": "+o,this.originalMessage=o,this.code=e,this.response=s,this.url=f,this.options=m};(Sc.prototype=Object.create(Error.prototype)).constructor=Sc;var Ff={httpMethod:"POST",params:{f:"json"}},Zy=function(r){function o(e,s,f,m,x){void 0===e&&(e="AUTHENTICATION_ERROR"),void 0===s&&(s="AUTHENTICATION_ERROR_CODE");var I=r.call(this,e,s,f,m,x)||this;return I.name="ArcGISAuthError",I.message="AUTHENTICATION_ERROR_CODE"===s?e:s+": "+e,I}return function(r,o){function e(){this.constructor=r}Hd(r,o),r.prototype=null===o?Object.create(o):(e.prototype=o.prototype,new e)}(o,r),o.prototype.retry=function(e,s){var f=this;void 0===s&&(s=3);var m=0,x=function(I,M){e(f.url,f.options).then(function(S){var D=qs(qs({},f.options),{authentication:S});return m+=1,Kd(f.url,D)}).then(function(S){I(S)}).catch(function(S){"ArcGISAuthError"===S.name&&m<s?x(I,M):M("ArcGISAuthError"===S.name&&m>=s?f:S)})};return new Promise(function(I,M){x(I,M)})},o}(Sc);function Kd(r,o){void 0===o&&(o={params:{f:"json"}});var e=qs(qs(qs({httpMethod:"POST"},Ff),o),{params:qs(qs({},Ff.params),o.params),headers:qs(qs({},Ff.headers),o.headers)}),s=[],f=[];if(e.fetch||"undefined"==typeof fetch?(s.push("`fetch`"),f.push("`node-fetch`")):e.fetch=fetch.bind(Function("return this")()),"undefined"==typeof Promise&&(s.push("`Promise`"),f.push("`es6-promise`")),"undefined"==typeof FormData&&(s.push("`FormData`"),f.push("`isomorphic-form-data`")),!e.fetch||"undefined"==typeof Promise||"undefined"==typeof FormData)throw new Error("`arcgis-rest-request` requires a `fetch` implementation and global variables for `Promise` and `FormData` to be present in the global scope. You are missing "+s.join(", ")+". We recommend installing the "+f.join(", ")+" modules at the root of your application to add these to the global scope. See https://bit.ly/2KNwWaJ for more info.");var m=e.httpMethod,x=e.authentication,I=e.rawResponse,M=qs({f:"json"},e.params),S=null,D={method:m,credentials:e.credentials||"same-origin"};return e.headers&&e.headers["X-Esri-Auth-Client-Id"]&&r.indexOf("/oauth2/platformSelf")>-1&&(D.credentials="include"),(x?x.getToken(r,{fetch:e.fetch}).catch(function(R){return R.url=r,R.options=e,S=R,Promise.resolve("")}):Promise.resolve("")).then(function(R){R.length&&(M.token=R),x&&x.getDomainCredentials&&(D.credentials=x.getDomainCredentials(r));var N={};if("GET"===D.method){M.token&&e.hideToken&&"undefined"==typeof window&&(N["X-Esri-Authorization"]="Bearer "+M.token,delete M.token);var Ct=""===Jd(M)?r:r+"?"+Jd(M);e.maxUrlLength&&Ct.length>e.maxUrlLength||M.token&&e.hideToken?(D.method="POST",R.length&&e.hideToken&&(M.token=R,delete N["X-Esri-Authorization"])):r=Ct}var pt=new RegExp("/items/.+/updateResources").test(r);return"POST"===D.method&&(D.body=function(r,o){var e=xm(r)||o,s=bm(r);if(e){var f=new FormData;return Object.keys(s).forEach(function(m){"undefined"!=typeof Blob&&s[m]instanceof Blob?f.append(m,s[m],s.fileName||s[m].name||m):f.append(m,s[m])}),f}return Jd(r)}(M,pt)),D.headers=qs(qs({},N),e.headers),"undefined"==typeof window&&!D.headers.referer&&(D.headers.referer="@esri/arcgis-rest-js"),!xm(M)&&!pt&&(D.headers["Content-Type"]="application/x-www-form-urlencoded"),e.fetch(r,D)}).then(function(R){if(!R.ok)throw new Sc(R.statusText,"HTTP "+R.status,R,r,e);if(I)return R;switch(M.f){case"json":case"geojson":return R.json();case"html":case"text":return R.text();default:return R.blob()}}).then(function(R){if("json"!==M.f&&"geojson"!==M.f||I)return R;var N=function(r,o,e,s,f){if(r.code>=400)throw new Sc(m=r.message,x=r.code,r,o,s);if(r.error){var I=r.error,m=I.message,x=I.code,M=I.messageCode,S=M||x||"UNKNOWN_ERROR_CODE";throw 498===x||499===x||"GWM_0003"===M||400===x&&"Unable to generate token."===m?f||new Zy(m,S,r,o,s):new Sc(m,S,r,o,s)}if("failed"===r.status||"failure"===r.status){m=void 0,x="UNKNOWN_ERROR_CODE";try{m=JSON.parse(r.statusMessage).message,x=JSON.parse(r.statusMessage).code}catch(N){m=r.statusMessage||r.message}throw new Sc(m,x,r,o,s)}return r}(R,r,0,e,S);if(S){var B=r.toLowerCase().split(/\/rest(\/admin)?\/services\//)[0];e.authentication.federatedServers[B]={token:[],expires:new Date(Date.now()+864e5)},S=null}return N})}function Em(r){return"string"!=typeof r||"/"===(r=r.trim())[r.length-1]&&(r=r.slice(0,-1)),r}var Bf="https://geocode-api.arcgis.com/arcgis/rest/services/World/GeocodeServer/";var jy=function(o,e,s,f){var I=(f[1]-s[1])*(e[0]-o[0])-(f[0]-s[0])*(e[1]-o[1]);if(0!==I){var M=((f[0]-s[0])*(o[1]-s[1])-(f[1]-s[1])*(o[0]-s[0]))/I,S=((e[0]-o[0])*(o[1]-s[1])-(e[1]-o[1])*(o[0]-s[0]))/I;if(M>=0&&M<=1&&S>=0&&S<=1)return!0}return!1},Sm=function(o,e){for(var s=0;s<o.length-1;s++)for(var f=0;f<e.length-1;f++)if(jy(o[s],o[s+1],e[f],e[f+1]))return!0;return!1},Qd=function(o){return function(o,e){for(var s=0;s<o.length;s++)if(o[s]!==e[s])return!1;return!0}(o[0],o[o.length-1])||o.push(o[0]),o},$d=function(o){for(var x,e=0,s=0,f=o.length,m=o[s];s<f-1;s++)e+=((x=o[s+1])[0]-m[0])*(x[1]+m[1]),m=x;return e>=0},Wy=function(o,e){var s=Sm(o,e),f=function(o,e){for(var s=!1,f=-1,m=o.length,x=m-1;++f<m;x=f)(o[f][1]<=e[1]&&e[1]<o[x][1]||o[x][1]<=e[1]&&e[1]<o[f][1])&&e[0]<(o[x][0]-o[f][0])*(e[1]-o[f][1])/(o[x][1]-o[f][1])+o[f][0]&&(s=!s);return s}(o,e[0]);return!(s||!f)},Ky=function r(o,e){var s={};if(o.features){s.type="FeatureCollection",s.features=[];for(var f=0;f<o.features.length;f++)s.features.push(r(o.features[f],e))}if("number"==typeof o.x&&"number"==typeof o.y&&(s.type="Point",s.coordinates=[o.x,o.y],"number"==typeof o.z&&s.coordinates.push(o.z)),o.points&&(s.type="MultiPoint",s.coordinates=o.points.slice(0)),o.paths&&(1===o.paths.length?(s.type="LineString",s.coordinates=o.paths[0].slice(0)):(s.type="MultiLineString",s.coordinates=o.paths.slice(0))),o.rings&&(s=function(o){for(var f,x,e=[],s=[],I=0;I<o.length;I++){var M=Qd(o[I].slice(0));if(!(M.length<4))if($d(M)){var S=[M.slice().reverse()];e.push(S)}else s.push(M.slice().reverse())}for(var D=[];s.length;){x=s.pop();var R=!1;for(f=e.length-1;f>=0;f--)if(Wy(e[f][0],x)){e[f].push(x),R=!0;break}R||D.push(x)}for(;D.length;){x=D.pop();var N=!1;for(f=e.length-1;f>=0;f--)if(Sm(e[f][0],x)){e[f].push(x),N=!0;break}N||e.push([x.reverse()])}return 1===e.length?{type:"Polygon",coordinates:e[0]}:{type:"MultiPolygon",coordinates:e}}(o.rings.slice(0))),"number"==typeof o.xmin&&"number"==typeof o.ymin&&"number"==typeof o.xmax&&"number"==typeof o.ymax&&(s.type="Polygon",s.coordinates=[[[o.xmax,o.ymax],[o.xmin,o.ymax],[o.xmin,o.ymin],[o.xmax,o.ymin],[o.xmax,o.ymax]]]),(o.geometry||o.attributes)&&(s.type="Feature",s.geometry=o.geometry?r(o.geometry):null,s.properties=o.attributes?function(o){var e={};for(var s in o)o.hasOwnProperty(s)&&(e[s]=o[s]);return e}(o.attributes):null,o.attributes))try{s.id=function(o,e){for(var s=e?[e,"OBJECTID","FID"]:["OBJECTID","FID"],f=0;f<s.length;f++){var m=s[f];if(m in o&&("string"==typeof o[m]||"number"==typeof o[m]))return o[m]}throw Error("No valid id attribute found")}(o.attributes,e)}catch(m){}return JSON.stringify(s.geometry)===JSON.stringify({})&&(s.geometry=null),o.spatialReference&&o.spatialReference.wkid&&4326!==o.spatialReference.wkid&&console.warn("Object converted in non-standard crs - "+JSON.stringify(o.spatialReference)),s};var tv=function(){function r(o){this.key=o.key}return r.prototype.getToken=function(o){return Promise.resolve(this.key)},r}();let ev=(()=>{class r{constructor(){this.defaultBias=[-77.1945,41.2033],this.defaultMaxCandidates=10,this.candidates$=new ft.X([]),this.subs=[],this.authentication=new tv({key:Ye.N.esriApiKey})}getCandidates(){return this.candidates$.asObservable()}setCandidates(e){this.candidates$.next(e)}searchCandidates(e,s,f){if(this.subs.length&&(this.subs.forEach(M=>{M.unsubscribe()}),this.subs=[]),e||this.clearCandidates(),s||(s=this.defaultBias),f||(f=this.defaultMaxCandidates),"[object String]"!==Object.prototype.toString.call(e))return;let m=new jd.xQ,x=[],I=m.subscribe(M=>{x=x.concat(M),this.setCandidates(x)});this.subs=[I],function(r,o){var e=Nf({endpoint:Bf,params:{}},o);return e.params.text=r,Kd(Em(e.endpoint)+"/suggest",e)}(e,{authentication:this.authentication,location:`${s[0]},${s[1]}`,countryCode:"USA"}).then(M=>{M.suggestions.length<1?this.clearCandidates():M.suggestions.forEach(S=>{S.isCollection||function(r){var e,o={};return"string"==typeof r?(o.params={singleLine:r},e=Bf):(e=r.endpoint||Bf,o=function(r,o,e){var f=qs(qs({params:{}},e),r);return f.params=["singleLine","address","address2","address3","neighborhood","city","subregion","region","postal","postalExt","countryCode","outFields","magicKey"].reduce(function(m,x){return(r[x]||"boolean"==typeof r[x])&&(m[x]=r[x]),m},f.params),["params","httpMethod","rawResponse","authentication","portal","fetch","maxUrlLength","headers"].reduce(function(m,x){return f[x]&&(m[x]=f[x]),m},{})}(r,0,{params:Nf({},r.params)})),Kd(Em(e)+"/findAddressCandidates",o).then(function(s){if("string"!=typeof r&&r.rawResponse)return s;var f=s.spatialReference;if(s.candidates.forEach(function(x){x.location.spatialReference=f,x.extent&&(x.extent.spatialReference=f)}),4326===f.wkid){var m=s.candidates.map(function(x){return{type:"Feature",geometry:Ky(x.location),properties:Object.assign({address:x.address,score:x.score},x.attributes)}});s.geoJson={type:"FeatureCollection",features:m}}return s})}({authentication:this.authentication,singleLine:S.text,magicKey:S.magicKey,countryCode:"USA"}).then(D=>{let R=D.candidates.map(N=>({name:N.address,location:Object.assign({},N.location),extent:Object.assign({},N.extent),source:ym.EsriGeocode}));m.next(R)})})})}clearCandidates(){this.setCandidates([])}}return r.\u0275fac=function(e){return new(e||r)},r.\u0275prov=b.Yz7({token:r,factory:r.\u0275fac,providedIn:"root"}),r})();var rv=wt(1436),ml=wt(8295),tg=wt(9983),Mm=wt(1554),eg=wt(2458);function nv(r,o){if(1&r&&(b.TgZ(0,"mat-option",7),b.TgZ(1,"span"),b._uU(2),b.qZA(),b.qZA()),2&r){const e=o.$implicit;b.Q6J("value",e),b.xp6(2),b.Oqu(e.name)}}let iv=(()=>{class r{constructor(e){this.geoSearchService=e,this.searchCtrl=new Tn.NI,this.candidates=[],this.tooltipMessage="",this.mapCenter={x:-77.1945,y:41.2033},this.zoomToCandidates=new b.vpe,this.clearPoints=new b.vpe}ngOnInit(){this.newCandidates$=this.geoSearchService.getCandidates().subscribe(e=>{this.candidates=e}),this.valuesChange$=this.searchCtrl.valueChanges.subscribe(e=>{let s=this.searchCtrl.value;(""===s||!s)&&this.geoSearchService.clearCandidates(),this.geoSearchService.searchCandidates(s,[this.mapCenter.x,this.mapCenter.y])})}ngOnDestroy(){this.valuesChange$.unsubscribe(),this.newCandidates$.unsubscribe()}goToLocation(e){const s=this.candidates.find(m=>m.name===e.name&&m.location.x===e.location.x&&m.location.y===e.location.y);this.zoomToCandidates.emit({candidates:[s],paddingLeft:0,paddingBottom:0})}clearValues(){this.searchCtrl.setValue(""),this.clearPoints.emit()}getOptionName(e){return e?e.name:null}}return r.\u0275fac=function(e){return new(e||r)(b.Y36(ev))},r.\u0275cmp=b.Xpm({type:r,selectors:[["app-geo-search"]],inputs:{mapCenter:"mapCenter"},outputs:{zoomToCandidates:"zoomToCandidates",clearPoints:"clearPoints"},decls:7,vars:7,consts:[[1,"appSearchContainer"],[1,"appSearchForm",3,"matTooltip"],[1,"appSearchFullWidth"],["matInput","","placeholder","Search","aria-label","Search",3,"matAutocomplete","formControl"],["autoActiveFirstOption","",3,"displayWith","optionSelected"],["auto","matAutocomplete"],["class","search-option",3,"value",4,"ngFor","ngForOf"],[1,"search-option",3,"value"]],template:function(e,s){if(1&e&&(b.TgZ(0,"div",0),b.TgZ(1,"form",1),b.TgZ(2,"mat-form-field",2),b._UZ(3,"input",3),b.TgZ(4,"mat-autocomplete",4,5),b.NdJ("optionSelected",function(m){return s.goToLocation(m.option.value)}),b.YNc(6,nv,3,2,"mat-option",6),b.qZA(),b.qZA(),b.qZA(),b.qZA()),2&e){const f=b.MAs(5);b.xp6(1),b.Q6J("matTooltip",!s.searchCtrl.value||s.searchCtrl.value.length<1?s.tooltipMessage:""),b.xp6(1),b.Akn("width: 100%;"),b.xp6(1),b.Q6J("matAutocomplete",f)("formControl",s.searchCtrl),b.xp6(1),b.Q6J("displayWith",s.getOptionName),b.xp6(2),b.Q6J("ngForOf",s.candidates)}},directives:[Tn._Y,Tn.JL,rv.gM,ml.KE,tg.Nt,Mm.ZL,Tn.Fj,Tn.JJ,Tn.oH,Mm.XC,Ya.sg,eg.ey],styles:[".appSearchForm[_ngcontent-%COMP%]{min-width:9.375rem;max-width:31.25rem;width:100%;padding-left:.3125rem;padding-right:.3125rem;height:3.25rem}.appSearchContainer[_ngcontent-%COMP%]{width:30rem;padding:.1rem 1rem;background-color:#f3f3f3b5;border-radius:1rem}@media only screen and (max-width: 480px){.appSearchContainer[_ngcontent-%COMP%]{width:15rem}}@media only screen and (min-width: 321px){.appSearchContainer[_ngcontent-%COMP%]{width:15rem}}@media only screen and (min-width: 1224px){.appSearchForm[_ngcontent-%COMP%]{min-width:9.375rem;max-width:31.25rem;width:100%;padding-left:.3125rem;padding-right:.3125rem;height:3.25rem}.appSearchContainer[_ngcontent-%COMP%]{width:30rem;padding:.1rem 1rem;background-color:#f3f3f3b5;border-radius:1rem}}@media only screen and (min-width: 1824px){.appSearchForm[_ngcontent-%COMP%]{min-width:9.375rem;max-width:31.25rem;width:100%;padding-left:.3125rem;padding-right:.3125rem;height:3.25rem}.appSearchContainer[_ngcontent-%COMP%]{width:30rem;padding:.1rem 1rem;background-color:#f3f3f3b5;border-radius:1rem}}"]}),r})();var Uf=wt(1095);const ov=["geolocater"],av=function(r){return{type:"Point",coordinates:r}};function sv(r,o){if(1&r&&b._UZ(0,"mgl-feature",15),2&r){const e=b.oxw();b.Q6J("geometry",b.VKq(1,av,e.coordinates))}}function uv(r,o){if(1&r){const e=b.EpF();b.TgZ(0,"button",16),b.NdJ("click",function(){return b.CHM(e),b.oxw().startSelect()}),b._uU(1,"Select Location"),b.qZA()}if(2&r){const e=b.oxw();b.Q6J("disabled",e.isActive)}}function lv(r,o){if(1&r){const e=b.EpF();b.TgZ(0,"button",16),b.NdJ("click",function(){return b.CHM(e),b.oxw().saveLocation()}),b._uU(1,"Save Location"),b.qZA()}if(2&r){const e=b.oxw();b.Q6J("disabled",!e.isActive)}}function cv(r,o){if(1&r&&(b.TgZ(0,"div"),b._uU(1),b.ALo(2,"number"),b.ALo(3,"number"),b.qZA()),2&r){const e=b.oxw();b.xp6(1),b.AsE(" ",b.lcZ(2,2,e.coordinates[0]),", ",b.lcZ(3,4,e.coordinates[1]),"\n")}}const hv=function(r){return[r]},pv=function(){return{maxZoom:12}},fv=function(){return{enableHighAccuracy:!0}};let dv=(()=>{class r{constructor(e){this.cd=e,this.zoom=6,this.center=[-77.1945,41.2033],this.styleEnum="ArcGIS:Streets",this.apiKey=Ye.N.esriApiKey,this.basemapStyle=`https://basemaps-api.arcgis.com/arcgis/rest/services/styles/${this.styleEnum}?type=style&token=${this.apiKey}`,this.isActive=!1,this.showPoint=!0,this.coordinates=[],this.layerPaint=qt.PointPaintStyle,this.inState=!0,this.newLocation=new b.vpe,this.newIntersectStatus=new b.vpe}ngOnInit(){}activate(){this.isActive=!0}startSelect(){const e=this.map.getCenter();this.setCoordinates([e.lng,e.lat]),this.activate()}endSelect(){this.isActive=!1}setCoordinates(e){this.coordinates=e,this.refreshPoint(),this.inState=this.checkIntersection(this.coordinates)}clearCoordinates(){this.coordinates=[]}mapClicked(e){!(null==e?void 0:e.lngLat)||!this.isActive||(console.log("Map Clicked",e),this.setCoordinates([e.lngLat.lng,e.lngLat.lat]),this.endSelect())}saveLocation(){this.endSelect(),this.newLocation.emit({lat:this.coordinates[0]||0,long:this.coordinates[1]||0}),this.newIntersectStatus.emit(this.inState)}mapMoved(e){if(!this.isActive)return;const s=this.map.getCenter();console.log("Map Moved",e,s),this.setCoordinates([s.lng,s.lat])}refreshPoint(){this.showPoint=!1,this.cd.detectChanges(),this.showPoint=!0}checkIntersection(e){return function(r,o){var e=!1;return Bn(r,function(s){Bn(o,function(f){if(!0===e)return!0;e=!function(r,o){var e=!0;return Bn(r,function(s){Bn(o,function(f){if(!1===e)return!1;e=function(r,o){switch(r.type){case"Point":switch(o.type){case"Point":return!function(r,o){return r[0]===o[0]&&r[1]===o[1]}(r.coordinates,o.coordinates);case"LineString":return!je(o,r);case"Polygon":return!rt(r,o)}break;case"LineString":switch(o.type){case"Point":return!je(r,o);case"LineString":return!function(r,o){return ht(r,o).features.length>0}(r,o);case"Polygon":return!ge(o,r)}break;case"Polygon":switch(o.type){case"Point":return!rt(o,r);case"LineString":return!ge(r,o);case"Polygon":return!function(r,o){for(var e=0,s=r.coordinates[0];e<s.length;e++)if(rt(s[e],o))return!0;for(var m=0,x=o.coordinates[0];m<x.length;m++)if(rt(x[m],r))return!0;return ht(Lt(r),Lt(o)).features.length>0}(o,r)}}return!1}(s.geometry,f.geometry)})}),e}(s.geometry,f.geometry)})}),e}(j(my.coordinates),tt(e))}newGPSLocation(e){var s,f;console.log("New Location",e),this.setCoordinates([(null===(s=e.coords)||void 0===s?void 0:s.longitude)||0,(null===(f=e.coords)||void 0===f?void 0:f.latitude)||0]),this.saveLocation(),this.geolocater.control.trigger()}noGPSLocation(e){console.log("Location Error",e)}zoomToCandidates(e){var s,f,m,x,I;console.log("New Search Location",e),(null===(s=null==e?void 0:e.candidates)||void 0===s?void 0:s.length)>0&&(this.setCoordinates([(null===(m=null===(f=e.candidates[0])||void 0===f?void 0:f.location)||void 0===m?void 0:m.x)||0,(null===(I=null===(x=e.candidates[0])||void 0===x?void 0:x.location)||void 0===I?void 0:I.y)||0]),this.bounds=this.coordinates.reduce((M,S)=>M.extend(S),new de.LngLatBounds([this.coordinates[0],this.coordinates[1]],[this.coordinates[0],this.coordinates[1]])),this.activate())}}return r.\u0275fac=function(e){return new(e||r)(b.Y36(b.sBO))},r.\u0275cmp=b.Xpm({type:r,selectors:[["app-map"]],viewQuery:function(e,s){if(1&e&&b.Gf(ov,5),2&e){let f;b.iGM(f=b.CRH())&&(s.geolocater=f.first)}},inputs:{zoom:"zoom",center:"center",styleEnum:"styleEnum"},outputs:{newLocation:"newLocation",newIntersectStatus:"newIntersectStatus"},decls:16,vars:19,consts:[["id","appMapContainer"],[3,"zoom","center","cursorStyle","fitBounds","fitBoundsOptions","mapLoad","moveEnd"],["mglNavigation","","position","top-right"],["mglScale","","position","bottom-left"],["mglGeolocate","",3,"positionOptions","trackUserLocation","geolocate","error"],["geolocater",""],["id","point"],[3,"properties","geometry",4,"ngIf"],["id","point","type","circle","source","point",3,"paint"],["targetLayer",""],[1,"appSelectLocationContainer"],["mat-flat-button","","color","basic",3,"disabled","click",4,"ngIf"],[1,"appSearchContainer"],[3,"mapCenter","zoomToCandidates"],[4,"ngIf"],[3,"properties","geometry"],["mat-flat-button","","color","basic",3,"disabled","click"]],template:function(e,s){1&e&&(b.TgZ(0,"div",0),b.TgZ(1,"mgl-map",1),b.NdJ("mapLoad",function(m){return s.map=m})("moveEnd",function(m){return s.mapMoved(m)}),b._UZ(2,"mgl-control",2),b._UZ(3,"mgl-control",3),b.TgZ(4,"mgl-control",4,5),b.NdJ("geolocate",function(m){return s.newGPSLocation(m)})("error",function(m){return s.noGPSLocation(m)}),b.qZA(),b.TgZ(6,"mgl-geojson-source",6),b.YNc(7,sv,1,3,"mgl-feature",7),b.qZA(),b._UZ(8,"mgl-layer",8,9),b.qZA(),b.TgZ(10,"div",10),b.YNc(11,uv,2,1,"button",11),b.YNc(12,lv,2,1,"button",11),b.qZA(),b.TgZ(13,"div",12),b.TgZ(14,"app-geo-search",13),b.NdJ("zoomToCandidates",function(m){return s.zoomToCandidates(m)}),b.qZA(),b.qZA(),b.qZA(),b.YNc(15,cv,4,6,"div",14)),2&e&&(b.xp6(1),b.Akn(s.basemapStyle),b.Q6J("zoom",b.VKq(15,hv,s.zoom))("center",s.center)("cursorStyle",s.cursorStyle)("fitBounds",s.bounds)("fitBoundsOptions",b.DdM(17,pv)),b.xp6(3),b.Q6J("positionOptions",b.DdM(18,fv))("trackUserLocation",!0),b.xp6(3),b.Q6J("ngIf",s.showPoint),b.xp6(1),b.Q6J("paint",s.layerPaint),b.xp6(3),b.Q6J("ngIf",!s.isActive),b.xp6(1),b.Q6J("ngIf",s.isActive),b.xp6(2),b.Q6J("mapCenter",s.center),b.xp6(1),b.Q6J("ngIf",(null==s.coordinates?null:s.coordinates.length)&&s.coordinates.length>0))},directives:[Ny,Rf,Ly,Oy,Ay,mm,Ya.O5,Ry,iv,Dy,Uf.lW],pipes:[Ya.JJ],styles:["mgl-map[_ngcontent-%COMP%]{height:100%;width:100%}#appMapContainer[_ngcontent-%COMP%]{width:100%;height:65vh;position:relative}.appSelectLocationContainer[_ngcontent-%COMP%]{position:absolute;top:.5rem;left:.5rem}.appSearchContainer[_ngcontent-%COMP%]{position:absolute;top:.5rem;right:5rem}.mapboxgl-user-location-dot[_ngcontent-%COMP%], .maplibregl-user-location-dot[_ngcontent-%COMP%]{background-color:#3e0000}@media only screen and (max-width: 480px){.appSearchContainer[_ngcontent-%COMP%]{position:absolute;top:3rem;left:.3rem;right:auto}}@media only screen and (min-width: 321px){.appSearchContainer[_ngcontent-%COMP%]{position:absolute;top:3rem;left:.3rem;right:auto}}@media only screen and (min-width: 1224px){#appMapContainer[_ngcontent-%COMP%]{height:50vh}.appSearchContainer[_ngcontent-%COMP%]{top:.5rem;right:5rem;left:auto}}@media only screen and (min-width: 1824px){#appMapContainer[_ngcontent-%COMP%]{height:65vh}.appSearchContainer[_ngcontent-%COMP%]{top:.5rem;right:5rem;left:auto}}"]}),r})(),gv=(()=>{class r{constructor(e){this.obsStore=e,this.header=kt.y.LocationHeader,this.content=Ze.LocationHelperText,this.isValid=new b.vpe(!1)}updateLocation(e){this.obsStore.getObservation().pipe((0,le.q)(1)).subscribe(s=>{const f=Object.assign({},s);f.geometry=e,this.obsStore.updateObservation(f),this.checkValid(f)})}updateIntersectStatus(e){this.obsStore.getObservation().pipe((0,le.q)(1)).subscribe(s=>{const f=Object.assign({},s);f.inState=e,this.obsStore.updateObservation(f),this.checkValid(f)})}checkValid(e){var s,f;e&&(null==e?void 0:e.geometry)&&(null===(s=null==e?void 0:e.geometry)||void 0===s?void 0:s.lat)&&(null===(f=null==e?void 0:e.geometry)||void 0===f?void 0:f.long)?this.isValid.emit(!0):this.isValid.emit(!1)}}return r.\u0275fac=function(e){return new(e||r)(b.Y36(St))},r.\u0275cmp=b.Xpm({type:r,selectors:[["app-location"]],outputs:{isValid:"isValid"},decls:2,vars:2,consts:[[3,"header","content"],[3,"newLocation","newIntersectStatus"]],template:function(e,s){1&e&&(b._UZ(0,"app-intro-helper-text",0),b.TgZ(1,"app-map",1),b.NdJ("newLocation",function(m){return s.updateLocation(m)})("newIntersectStatus",function(m){return s.updateIntersectStatus(m)}),b.qZA()),2&e&&b.Q6J("header",s.header)("content",s.content)},directives:[ue,dv],styles:[""]}),r})();var mv=wt(205),yv=wt(7393);class _v{constructor(o,e){this.count=o,this.source=e}call(o,e){return e.subscribe(new xv(o,this.count,this.source))}}class xv extends yv.L{constructor(o,e,s){super(o),this.count=e,this.source=s}error(o){if(!this.isStopped){const{source:e,count:s}=this;if(0===s)return super.error(o);s>-1&&(this.count=s-1),e.subscribe(this._unsubscribeAndRecycle())}}}var bv=wt(5304),wv=wt(1841);let Tm=(()=>{class r{constructor(e){this.http=e,this.apiEndpoint=Ye.N.apiEndpoint}getAnimalCount(){return this.get(kt.y.AnimalCount)}getAffiliation(){return this.get(kt.y.Affiliation)}getSpecies(){return this.get(kt.y.Species)}getYesNo(){return this.get(kt.y.YesNo)}getAge(){return this.get(kt.y.Age)}getCaptive(){return this.get(kt.y.Captive)}getClassification(){return this.get(kt.y.Classification)}get(e){return this.http.get(`${this.apiEndpoint}/${e}`).pipe(function(r=-1){return o=>o.lift(new _v(r,o))}(1),(0,bv.K)(this.handleError))}handleError(e){let s="";return s=e.error instanceof ErrorEvent?e.error.message:`Error Code: ${e.status}\nMessage: ${e.message}`,(0,mv._)(s)}}return r.\u0275fac=function(e){return new(e||r)(b.LFG(wv.eN))},r.\u0275prov=b.Yz7({token:r,factory:r.\u0275fac,providedIn:"root"}),r})();var zu=wt(5618),Am=wt(7441);function Ev(r,o){1&r&&(b.TgZ(0,"mat-error"),b._uU(1,"This field is required."),b.qZA())}function Cv(r,o){1&r&&(b.TgZ(0,"mat-error"),b._uU(1,"Please enter no more than 50 characters."),b.qZA())}function Sv(r,o){if(1&r&&(b.TgZ(0,"mat-option",16),b._uU(1),b.qZA()),2&r){const e=o.$implicit;b.Q6J("value",null==e?null:e.AffiliationId),b.xp6(1),b.hij(" ",null==e?null:e.Name," ")}}function Iv(r,o){1&r&&(b.TgZ(0,"mat-error"),b._uU(1,"This field is required."),b.qZA())}function Pv(r,o){1&r&&(b.TgZ(0,"mat-error"),b._uU(1,"Email must be in the following format: example@gmail.com"),b.qZA())}function Mv(r,o){1&r&&(b.TgZ(0,"mat-error"),b._uU(1,"This field is required."),b.qZA())}function Tv(r,o){1&r&&(b.TgZ(0,"mat-error"),b._uU(1,"Please enter no more than 50 characters."),b.qZA())}function Av(r,o){1&r&&(b.TgZ(0,"mat-error"),b._uU(1,"This field is required."),b.qZA())}function Lv(r,o){1&r&&(b.TgZ(0,"mat-error"),b._uU(1,"Please enter 10 digits, numbers only."),b.qZA())}function Ov(r,o){1&r&&(b.TgZ(0,"mat-error"),b._uU(1,"Please only enter 10 digits."),b.qZA())}let Dv=(()=>{class r{constructor(e,s){this.obsStore=e,this.api=s,this.header=kt.y.ContactHeader,this.content=Ze.ContactHelperText,this.contactForm=new Tn.cw({name:new Tn.NI("",[Tn.kI.maxLength(50)]),affiliation:new Tn.NI("",[]),email:new Tn.NI("",[Tn.kI.maxLength(50),Tn.kI.pattern("^[a-z0-9._%+-]+@[a-z0-9.-]+\\.[a-z]{2,4}$")]),phone:new Tn.NI("",[Tn.kI.maxLength(10),Tn.kI.minLength(10),Tn.kI.pattern("^((\\+91-?)|0)?[0-9]{10}$")])}),this.affiliations=[],this.isValid=new b.vpe(!1)}ngOnInit(){this.formChangeSub=this.contactForm.valueChanges.pipe((0,Yd.b)(200)).subscribe({next:e=>{this.obsStore.getObservation().pipe((0,Xd.P)()).subscribe(s=>{if(this.contactForm.valid){const f=Object.assign({},s);f.contact=Object.assign({},e),this.obsStore.updateObservation(f)}this.isValid.emit(this.contactForm.valid)})}}),this.initializeDropdowns()}ngOnDestroy(){this.formChangeSub.unsubscribe()}get name(){return this.contactForm.get("name")}get affiliation(){return this.contactForm.get("affiliation")}get email(){return this.contactForm.get("email")}get phone(){return this.contactForm.get("phone")}initializeDropdowns(){this.api.getAnimalCount().subscribe(e=>{this.affiliations=e},e=>{console.error(e)})}}return r.\u0275fac=function(e){return new(e||r)(b.Y36(St),b.Y36(Tm))},r.\u0275cmp=b.Xpm({type:r,selectors:[["app-contact"]],outputs:{isValid:"isValid"},decls:44,vars:13,consts:[[3,"header","content"],[1,"appContactContainer"],[3,"formGroup"],["fxLayout","row","fxLayout.xs","column","fxLayout.sm","column","fxLayoutAlign","start center","fxLayoutAlign.xs","start start","fxLayoutAlign.sm","start start","fxFlex",""],["fxFlex","50","fxFlex.xs","100","fxFlex.sm","100",1,"appFormRowContainer"],[1,"appFormContainer"],["for","contact-name"],["matInput","","id","contact-name","type","text","formControlName","name"],[4,"ngIf"],["for","contact-affiliation"],["id","contact-affiliation","formControlName","affiliation"],[3,"value",4,"ngFor","ngForOf"],["for","contact-email"],["matInput","","id","contact-email","type","email","formControlName","email"],["for","contact-phone"],["matInput","","id","contact-phone","type","number","formControlName","phone"],[3,"value"]],template:function(e,s){1&e&&(b._UZ(0,"app-intro-helper-text",0),b.TgZ(1,"div",1),b.TgZ(2,"form",2),b.TgZ(3,"div",3),b.TgZ(4,"div",4),b.TgZ(5,"div",5),b.TgZ(6,"mat-form-field"),b.TgZ(7,"mat-label",6),b._uU(8,"Name"),b.qZA(),b._UZ(9,"input",7),b.TgZ(10,"mat-hint"),b._uU(11,"First and last name"),b.qZA(),b.YNc(12,Ev,2,0,"mat-error",8),b.YNc(13,Cv,2,0,"mat-error",8),b.qZA(),b.qZA(),b.TgZ(14,"div",5),b.TgZ(15,"mat-form-field"),b.TgZ(16,"mat-label",9),b._uU(17,"Affiliation"),b.qZA(),b.TgZ(18,"mat-select",10),b.YNc(19,Sv,2,2,"mat-option",11),b.qZA(),b.TgZ(20,"mat-hint"),b._uU(21,"Affiliation"),b.qZA(),b.YNc(22,Iv,2,0,"mat-error",8),b.qZA(),b.qZA(),b.qZA(),b.TgZ(23,"div",4),b.TgZ(24,"div",5),b.TgZ(25,"mat-form-field"),b.TgZ(26,"mat-label",12),b._uU(27,"Email"),b.qZA(),b._UZ(28,"input",13),b.TgZ(29,"mat-hint"),b._uU(30,"example@gmail.com"),b.qZA(),b.YNc(31,Pv,2,0,"mat-error",8),b.YNc(32,Mv,2,0,"mat-error",8),b.YNc(33,Tv,2,0,"mat-error",8),b.qZA(),b.qZA(),b.TgZ(34,"div",5),b.TgZ(35,"mat-form-field"),b.TgZ(36,"mat-label",14),b._uU(37,"Phone"),b.qZA(),b._UZ(38,"input",15),b.TgZ(39,"mat-hint"),b._uU(40,"10 digit phone number, numbers only"),b.qZA(),b.YNc(41,Av,2,0,"mat-error",8),b.YNc(42,Lv,2,0,"mat-error",8),b.YNc(43,Ov,2,0,"mat-error",8),b.qZA(),b.qZA(),b.qZA(),b.qZA(),b.qZA(),b.qZA()),2&e&&(b.Q6J("header",s.header)("content",s.content),b.xp6(2),b.Q6J("formGroup",s.contactForm),b.xp6(10),b.Q6J("ngIf",(null==s.name?null:s.name.invalid)&&(null==s.name||null==s.name.errors?null:s.name.errors.required)),b.xp6(1),b.Q6J("ngIf",(null==s.name?null:s.name.invalid)&&(null==s.name||null==s.name.errors?null:s.name.errors.maxLength)),b.xp6(6),b.Q6J("ngForOf",s.affiliations),b.xp6(3),b.Q6J("ngIf",(null==s.affiliation?null:s.affiliation.invalid)&&(null==s.affiliation||null==s.affiliation.errors?null:s.affiliation.errors.required)),b.xp6(9),b.Q6J("ngIf",(null==s.email?null:s.email.invalid)&&(null==s.email||null==s.email.errors?null:s.email.errors.pattern)),b.xp6(1),b.Q6J("ngIf",(null==s.email?null:s.email.invalid)&&(null==s.email||null==s.email.errors?null:s.email.errors.required)),b.xp6(1),b.Q6J("ngIf",(null==s.name?null:s.name.invalid)&&(null==s.name||null==s.name.errors?null:s.name.errors.maxLength)),b.xp6(8),b.Q6J("ngIf",(null==s.phone?null:s.phone.invalid)&&(null==s.phone||null==s.phone.errors?null:s.phone.errors.required)),b.xp6(1),b.Q6J("ngIf",(null==s.phone?null:s.phone.invalid)&&(null==s.phone||null==s.phone.errors?null:s.phone.errors.pattern)),b.xp6(1),b.Q6J("ngIf",(null==s.phone?null:s.phone.invalid)&&(null==s.phone||null==s.phone.errors?null:s.phone.errors.maxLength)))},directives:[ue,Tn._Y,Tn.JL,Tn.sg,zu.xw,zu.Wh,zu.yH,ml.KE,ml.hX,tg.Nt,Tn.Fj,Tn.JJ,Tn.u,ml.bx,Ya.O5,Am.gD,Ya.sg,Tn.wV,ml.TO,eg.ey],styles:[".appContactContainer[_ngcontent-%COMP%]{min-height:20vh;margin-top:1rem;margin-left:5rem;margin-right:5rem}.mat-form-field[_ngcontent-%COMP%]{min-width:60%;font-size:1rem}.appFormContainer[_ngcontent-%COMP%]{margin-bottom:1.5rem}input[_ngcontent-%COMP%]::-webkit-outer-spin-button, input[_ngcontent-%COMP%]::-webkit-inner-spin-button{-webkit-appearance:none;margin:0}input[type=number][_ngcontent-%COMP%]{-moz-appearance:textfield}@media only screen and (max-width: 480px){.appContactContainer[_ngcontent-%COMP%]{margin-left:0;margin-right:0}.appFormRowContainer[_ngcontent-%COMP%]{width:100%}.mat-form-field[_ngcontent-%COMP%]{min-width:100%}}@media only screen and (min-width: 321px){.appContactContainer[_ngcontent-%COMP%]{margin-left:0;margin-right:0}.appFormRowContainer[_ngcontent-%COMP%]{width:100%}.mat-form-field[_ngcontent-%COMP%]{min-width:100%}}@media only screen and (min-width: 1224px){.appContactContainer[_ngcontent-%COMP%]{margin-left:5rem;margin-right:5rem}.mat-form-field[_ngcontent-%COMP%]{min-width:60%}}@media only screen and (min-width: 1824px){.appContactContainer[_ngcontent-%COMP%]{margin-left:5rem;margin-right:5rem}.mat-form-field[_ngcontent-%COMP%]{min-width:60%}}"]}),r})();var Vn=wt(7238),Rv=wt(7001),rg=wt(3220),Th=wt(2238);let Nv=(()=>{class r{constructor(e){this.data=e}ngOnInit(){}}return r.\u0275fac=function(e){return new(e||r)(b.Y36(Th.WI))},r.\u0275cmp=b.Xpm({type:r,selectors:[["app-info-dialog"]],decls:11,vars:4,consts:[["mat-dialog-title","","color"," primary",1,"themePrimaryTextInverse","appDialogTitle",2,"text-align","center","font-size","1.5rem"],[2,"text-align","center","border-bottom","1px solid rgba(118,118,118,1)","font-size","1.5rem"],["mat-dialog-content","",2,"align-items","center","text-align","center","width","100%","margin","auto"],["fxFlex","","fxLayout","column","fxLayoutGap","0.5rem","fxLayoutAlign","center center",2,"margin","1.5rem 0","width","100%"],[2,"width","100%"],[1,"appMainText",2,"text-overflow","ellipsis","overflow","hidden",3,"innerHtml"],["mat-dialog-actions","",2,"width","100%","margin-bottom","0.5rem"],["fxFlex","","fxLayout","column","fxLayoutAlign","center center"],["mat-flat-button","","color","accent",1,"appConfirmButton","appSquareButton","appSkinnyFontButton",2,"margin-right","1rem",3,"mat-dialog-close"]],template:function(e,s){1&e&&(b.TgZ(0,"p",0),b._uU(1),b.qZA(),b._UZ(2,"p",1),b.TgZ(3,"div",2),b.TgZ(4,"div",3),b.TgZ(5,"div",4),b._UZ(6,"h3",5),b.qZA(),b.qZA(),b.qZA(),b.TgZ(7,"div",6),b.TgZ(8,"div",7),b.TgZ(9,"button",8),b._uU(10),b.qZA(),b.qZA(),b.qZA()),2&e&&(b.xp6(1),b.hij(" ",s.data.title||"Confirm Action",""),b.xp6(5),b.Q6J("innerHtml",s.data.text,b.oJD),b.xp6(3),b.Q6J("mat-dialog-close",!0),b.xp6(1),b.Oqu(s.data.confirm))},directives:[Th.uh,Th.xY,zu.yH,zu.xw,zu.SQ,zu.Wh,Th.H8,Uf.lW,Th.ZT],styles:[".appDialogTitle[_ngcontent-%COMP%]{color:#2a381e}.appMainText[_ngcontent-%COMP%]{color:#434343}"]}),r})();var zv=wt(6627);let kv=(()=>{class r{constructor(e){this.dialog=e,this.title="",this.text="",this.confirm="Close",this.cancel="Cancel"}ngOnInit(){}onClick(){this.dialog.open(Nv,{width:"35rem",data:{title:this.title,text:this.text,confirm:this.confirm,cancel:this.cancel},disableClose:!1})}}return r.\u0275fac=function(e){return new(e||r)(b.Y36(Th.uw))},r.\u0275cmp=b.Xpm({type:r,selectors:[["app-info-popup"]],inputs:{title:"title",text:"text",confirm:"confirm",cancel:"cancel"},decls:2,vars:0,consts:[["aria-hidden","false","aria-label","Info icon",1,"appInfoIcon",3,"click"]],template:function(e,s){1&e&&(b.TgZ(0,"mat-icon",0),b.NdJ("click",function(){return s.onClick()}),b._uU(1," info\n"),b.qZA())},directives:[zv.Hw],styles:[".mat-icon.appInfoIcon{font-size:1.25rem;position:relative;top:.25rem;margin-left:.5rem}"]}),r})();function Lm(r,o,e,s,f,m,x){try{var I=r[m](x),M=I.value}catch(S){return void e(S)}I.done?o(M):Promise.resolve(M).then(s,f)}var ng=wt(9075);function Bv(r,o){if(1&r){const e=b.EpF();b.TgZ(0,"ngx-dropzone-remove-badge",1),b.NdJ("click",function(f){return b.CHM(e),b.oxw()._remove(f)}),b.qZA()}}const ig=[[["ngx-dropzone-label"]]],og=["ngx-dropzone-label"],Uv=["fileInput"];function qv(r,o){1&r&&b.Hsn(0,2,["*ngIf","!_hasPreviews"])}const Zv=[[["ngx-dropzone-preview"]],"*",[["ngx-dropzone-label"]]],Gv=["ngx-dropzone-preview","*","ngx-dropzone-label"];function Vv(r,o){if(1&r){const e=b.EpF();b.TgZ(0,"ngx-dropzone-remove-badge",2),b.NdJ("click",function(f){return b.CHM(e),b.oxw()._remove(f)}),b.qZA()}}function jv(r,o){if(1&r&&(b.TgZ(0,"video",2),b.NdJ("click",function(s){return s.stopPropagation()}),b._UZ(1,"source",3),b.qZA()),2&r){const e=b.oxw();b.xp6(1),b.Q6J("src",e.sanitizedVideoSrc,b.LSH)}}function Xv(r,o){if(1&r){const e=b.EpF();b.TgZ(0,"ngx-dropzone-remove-badge",4),b.NdJ("click",function(f){return b.CHM(e),b.oxw()._remove(f)}),b.qZA()}}let Yv=(()=>{class r{}return r.\u0275fac=function(e){return new(e||r)},r.\u0275dir=b.lG2({type:r,selectors:[["ngx-dropzone-label"]]}),r})();function vp(r){return null!=r&&"false"!=`${r}`}var _p=(()=>(function(r){r[r.BACKSPACE=8]="BACKSPACE",r[r.DELETE=46]="DELETE"}(_p||(_p={})),_p))();let xp=(()=>{class r{constructor(e){this.sanitizer=e,this._removable=!1,this.removed=new b.vpe,this.tabIndex=0}set file(e){this._file=e}get file(){return this._file}get removable(){return this._removable}set removable(e){this._removable=vp(e)}keyEvent(e){switch(e.keyCode){case _p.BACKSPACE:case _p.DELETE:this.remove()}}get hostStyle(){return this.sanitizer.bypassSecurityTrustStyle("\n\t\t\tdisplay: flex;\n\t\t\theight: 140px;\n\t\t\tmin-height: 140px;\n\t\t\tmin-width: 180px;\n\t\t\tmax-width: 180px;\n\t\t\tjustify-content: center;\n\t\t\talign-items: center;\n\t\t\tpadding: 0 20px;\n\t\t\tmargin: 10px;\n\t\t\tborder-radius: 5px;\n\t\t\tposition: relative;\n\t\t")}_remove(e){e.stopPropagation(),this.remove()}remove(){this._removable&&this.removed.next(this.file)}readFile(){return Wl(this,void 0,void 0,function*(){return new Promise((e,s)=>{const f=new FileReader;if(f.onload=m=>{e(m.target.result)},f.onerror=m=>{console.error(`FileReader failed on file ${this.file.name}.`),s(m)},!this.file)return s("No file to read. Please provide a file using the [file] Input property.");f.readAsDataURL(this.file)})})}}return r.\u0275fac=function(e){return new(e||r)(b.Y36(ng.H7))},r.\u0275cmp=b.Xpm({type:r,selectors:[["ngx-dropzone-preview"]],hostVars:3,hostBindings:function(e,s){1&e&&b.NdJ("keyup",function(m){return s.keyEvent(m)}),2&e&&(b.Ikx("tabindex",s.tabIndex),b.Akn(s.hostStyle))},inputs:{file:"file",removable:"removable"},outputs:{removed:"removed"},ngContentSelectors:og,decls:2,vars:1,consts:[[3,"click",4,"ngIf"],[3,"click"]],template:function(e,s){1&e&&(b.F$t(ig),b.Hsn(0),b.YNc(1,Bv,1,0,"ngx-dropzone-remove-badge",0)),2&e&&(b.xp6(1),b.Q6J("ngIf",s.removable))},directives:function(){return[Ya.O5,ag]},styles:["[_nghost-%COMP%]{background-image:linear-gradient(0deg,#ededed,#efefef,#f1f1f1,#f4f4f4,#f6f6f6)}[_nghost-%COMP%]:focus, [_nghost-%COMP%]:hover{background-image:linear-gradient(0deg,#e3e3e3,#ebeaea,#e8e7e7,#ebeaea,#f4f4f4);outline:0}[_nghost-%COMP%]:focus   ngx-dropzone-remove-badge[_ngcontent-%COMP%], [_nghost-%COMP%]:hover   ngx-dropzone-remove-badge[_ngcontent-%COMP%]{opacity:1}[_nghost-%COMP%]   ngx-dropzone-remove-badge[_ngcontent-%COMP%]{opacity:0}[_nghost-%COMP%]     ngx-dropzone-label{overflow-wrap:break-word}"]}),r})(),Om=(()=>{class r{parseFileList(e,s,f,m){const x=[],I=[];for(let S=0;S<e.length;S++){const D=e.item(S);this.isAccepted(D,s)?f&&D.size>f?this.rejectFile(I,D,"size"):!m&&x.length>=1?this.rejectFile(I,D,"no_multiple"):x.push(D):this.rejectFile(I,D,"type")}return{addedFiles:x,rejectedFiles:I}}isAccepted(e,s){if("*"===s)return!0;const f=s.split(",").map(M=>M.toLowerCase().trim()),m=e.type.toLowerCase(),x=e.name.toLowerCase();return!!f.find(M=>M.endsWith("/*")?m.split("/")[0]===M.split("/")[0]:M.startsWith(".")?x.endsWith(M):M==m)}rejectFile(e,s,f){const m=s;m.reason=f,e.push(m)}}return r.\u0275fac=function(e){return new(e||r)},r.\u0275prov=b.Yz7({token:r,factory:r.\u0275fac}),r})(),Hv=(()=>{class r{constructor(e){this.service=e,this.change=new b.vpe,this.accept="*",this._disabled=!1,this._multiple=!0,this._maxFileSize=void 0,this._expandable=!1,this._disableClick=!1,this._isHovered=!1}get _hasPreviews(){return!!this._previewChildren.length}get disabled(){return this._disabled}set disabled(e){this._disabled=vp(e),this._isHovered&&(this._isHovered=!1)}get multiple(){return this._multiple}set multiple(e){this._multiple=vp(e)}get maxFileSize(){return this._maxFileSize}set maxFileSize(e){this._maxFileSize=function(r){return isNaN(parseFloat(r))||isNaN(Number(r))?null:Number(r)}(e)}get expandable(){return this._expandable}set expandable(e){this._expandable=vp(e)}get disableClick(){return this._disableClick}set disableClick(e){this._disableClick=vp(e)}_onClick(){this.disableClick||this.showFileSelector()}_onDragOver(e){this.disabled||(this.preventDefault(e),this._isHovered=!0)}_onDragLeave(){this._isHovered=!1}_onDrop(e){this.disabled||(this.preventDefault(e),this._isHovered=!1,this.handleFileDrop(e.dataTransfer.files))}showFileSelector(){this.disabled||this._fileInput.nativeElement.click()}_onFilesSelected(e){this.handleFileDrop(e.target.files),this._fileInput.nativeElement.value="",this.preventDefault(e)}handleFileDrop(e){const s=this.service.parseFileList(e,this.accept,this.maxFileSize,this.multiple);this.change.next({addedFiles:s.addedFiles,rejectedFiles:s.rejectedFiles,source:this})}preventDefault(e){e.preventDefault(),e.stopPropagation()}}return r.\u0275fac=function(e){return new(e||r)(b.Y36(Om,2))},r.\u0275cmp=b.Xpm({type:r,selectors:[["ngx-dropzone"],["","ngx-dropzone",""]],contentQueries:function(e,s,f){if(1&e&&b.Suo(f,xp,5),2&e){let m;b.iGM(m=b.CRH())&&(s._previewChildren=m)}},viewQuery:function(e,s){if(1&e&&b.Gf(Uv,7),2&e){let f;b.iGM(f=b.CRH())&&(s._fileInput=f.first)}},hostVars:8,hostBindings:function(e,s){1&e&&b.NdJ("click",function(){return s._onClick()})("dragover",function(m){return s._onDragOver(m)})("dragleave",function(){return s._onDragLeave()})("drop",function(m){return s._onDrop(m)}),2&e&&b.ekj("ngx-dz-hovered",s._isHovered)("ngx-dz-disabled",s.disabled)("expandable",s.expandable)("unclickable",s.disableClick)},inputs:{accept:"accept",disabled:"disabled",multiple:"multiple",maxFileSize:"maxFileSize",expandable:"expandable",disableClick:"disableClick",id:"id",ariaLabel:["aria-label","ariaLabel"],ariaLabelledby:["aria-labelledby","ariaLabelledby"],ariaDescribedBy:["aria-describedby","ariaDescribedBy"]},outputs:{change:"change"},features:[b._Bn([Om])],ngContentSelectors:Gv,decls:5,vars:8,consts:[["type","file",3,"id","multiple","accept","disabled","change"],["fileInput",""],[4,"ngIf"]],template:function(e,s){1&e&&(b.F$t(Zv),b.TgZ(0,"input",0,1),b.NdJ("change",function(m){return s._onFilesSelected(m)}),b.qZA(),b.YNc(2,qv,1,0,"ng-content",2),b.Hsn(3),b.Hsn(4,1)),2&e&&(b.Q6J("id",s.id)("multiple",s.multiple)("accept",s.accept)("disabled",s.disabled),b.uIk("aria-label",s.ariaLabel)("aria-labelledby",s.ariaLabelledby)("aria-describedby",s.ariaDescribedBy),b.xp6(2),b.Q6J("ngIf",!s._hasPreviews))},directives:[Ya.O5],styles:["[_nghost-%COMP%]{align-items:center;background:#fff;border:2px dashed #717386;border-radius:5px;color:#717386;cursor:pointer;display:flex;font-size:16px;height:180px;overflow-x:auto}.ngx-dz-hovered[_nghost-%COMP%]{border-style:solid}.ngx-dz-disabled[_nghost-%COMP%]{cursor:no-drop;opacity:.5;pointer-events:none}.expandable[_nghost-%COMP%]{flex-wrap:wrap;height:unset;min-height:180px;overflow:hidden}.unclickable[_nghost-%COMP%]{cursor:default}[_nghost-%COMP%]     ngx-dropzone-label{margin:10px auto;text-align:center;z-index:10}[_nghost-%COMP%]   input[_ngcontent-%COMP%]{height:.1px;opacity:0;overflow:hidden;position:absolute;width:.1px;z-index:-1}[_nghost-%COMP%]   input[_ngcontent-%COMP%]:focus +   ngx-dropzone-label{outline:1px dotted #000;outline:5px auto -webkit-focus-ring-color}"]}),r})(),Jv=(()=>{class r extends xp{constructor(e){super(e),this.defaultImgLoading="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4KPHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiBzdHlsZT0ibWFyZ2luOiBhdXRvOyBiYWNrZ3JvdW5kOiByZ2IoMjQxLCAyNDIsIDI0Mykgbm9uZSByZXBlYXQgc2Nyb2xsIDAlIDAlOyBkaXNwbGF5OiBibG9jazsgc2hhcGUtcmVuZGVyaW5nOiBhdXRvOyIgd2lkdGg9IjIyNHB4IiBoZWlnaHQ9IjIyNHB4IiB2aWV3Qm94PSIwIDAgMTAwIDEwMCIgcHJlc2VydmVBc3BlY3RSYXRpbz0ieE1pZFlNaWQiPgo8Y2lyY2xlIGN4PSI1MCIgY3k9IjUwIiByPSIxNCIgc3Ryb2tlLXdpZHRoPSIzIiBzdHJva2U9IiM4NWEyYjYiIHN0cm9rZS1kYXNoYXJyYXk9IjIxLjk5MTE0ODU3NTEyODU1MiAyMS45OTExNDg1NzUxMjg1NTIiIGZpbGw9Im5vbmUiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCI+CiAgPGFuaW1hdGVUcmFuc2Zvcm0gYXR0cmlidXRlTmFtZT0idHJhbnNmb3JtIiB0eXBlPSJyb3RhdGUiIGR1cj0iMS4xNjI3OTA2OTc2NzQ0MTg0cyIgcmVwZWF0Q291bnQ9ImluZGVmaW5pdGUiIGtleVRpbWVzPSIwOzEiIHZhbHVlcz0iMCA1MCA1MDszNjAgNTAgNTAiPjwvYW5pbWF0ZVRyYW5zZm9ybT4KPC9jaXJjbGU+CjxjaXJjbGUgY3g9IjUwIiBjeT0iNTAiIHI9IjEwIiBzdHJva2Utd2lkdGg9IjMiIHN0cm9rZT0iI2JiY2VkZCIgc3Ryb2tlLWRhc2hhcnJheT0iMTUuNzA3OTYzMjY3OTQ4OTY2IDE1LjcwNzk2MzI2Nzk0ODk2NiIgc3Ryb2tlLWRhc2hvZmZzZXQ9IjE1LjcwNzk2MzI2Nzk0ODk2NiIgZmlsbD0ibm9uZSIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIj4KICA8YW5pbWF0ZVRyYW5zZm9ybSBhdHRyaWJ1dGVOYW1lPSJ0cmFuc2Zvcm0iIHR5cGU9InJvdGF0ZSIgZHVyPSIxLjE2Mjc5MDY5NzY3NDQxODRzIiByZXBlYXRDb3VudD0iaW5kZWZpbml0ZSIga2V5VGltZXM9IjA7MSIgdmFsdWVzPSIwIDUwIDUwOy0zNjAgNTAgNTAiPjwvYW5pbWF0ZVRyYW5zZm9ybT4KPC9jaXJjbGU+CjwhLS0gW2xkaW9dIGdlbmVyYXRlZCBieSBodHRwczovL2xvYWRpbmcuaW8vIC0tPjwvc3ZnPg==",this.imageSrc=this.sanitizer.bypassSecurityTrustUrl(this.defaultImgLoading)}set file(e){this._file=e,this.renderImage()}get file(){return this._file}ngOnInit(){this.renderImage()}renderImage(){this.readFile().then(e=>setTimeout(()=>this.imageSrc=e)).catch(e=>console.error(e))}}return r.\u0275fac=function(e){return new(e||r)(b.Y36(ng.H7))},r.\u0275cmp=b.Xpm({type:r,selectors:[["ngx-dropzone-image-preview"]],inputs:{file:"file"},features:[b._Bn([{provide:xp,useExisting:r}]),b.qOj],ngContentSelectors:og,decls:3,vars:2,consts:[[3,"src"],[3,"click",4,"ngIf"],[3,"click"]],template:function(e,s){1&e&&(b.F$t(ig),b._UZ(0,"img",0),b.Hsn(1),b.YNc(2,Vv,1,0,"ngx-dropzone-remove-badge",1)),2&e&&(b.Q6J("src",s.imageSrc,b.LSH),b.xp6(2),b.Q6J("ngIf",s.removable))},directives:function(){return[Ya.O5,ag]},styles:["[_nghost-%COMP%]{max-width:unset!important;min-width:unset!important;padding:0!important}[_nghost-%COMP%]:focus   img[_ngcontent-%COMP%], [_nghost-%COMP%]:hover   img[_ngcontent-%COMP%]{opacity:.7}[_nghost-%COMP%]:focus   ngx-dropzone-remove-badge[_ngcontent-%COMP%], [_nghost-%COMP%]:hover   ngx-dropzone-remove-badge[_ngcontent-%COMP%]{opacity:1}[_nghost-%COMP%]   ngx-dropzone-remove-badge[_ngcontent-%COMP%]{opacity:0}[_nghost-%COMP%]   img[_ngcontent-%COMP%]{border-radius:5px;max-height:100%;opacity:.8}[_nghost-%COMP%]     ngx-dropzone-label{overflow-wrap:break-word;position:absolute}"]}),r})(),ag=(()=>{class r{}return r.\u0275fac=function(e){return new(e||r)},r.\u0275cmp=b.Xpm({type:r,selectors:[["ngx-dropzone-remove-badge"]],decls:3,vars:0,consts:[["x1","0","y1","0","x2","10","y2","10"],["x1","0","y1","10","x2","10","y2","0"]],template:function(e,s){1&e&&(b.O4$(),b.TgZ(0,"svg"),b._UZ(1,"line",0),b._UZ(2,"line",1),b.qZA())},styles:["[_nghost-%COMP%]{align-items:center;background:#bbb;border-radius:50%;color:#333;cursor:pointer;display:flex;height:22px;justify-content:center;position:absolute;right:5px;top:5px;width:22px}[_nghost-%COMP%]:hover{background:#aeaeae}[_nghost-%COMP%] > svg[_ngcontent-%COMP%]{height:10px;width:10px}[_nghost-%COMP%] > svg[_ngcontent-%COMP%] > line[_ngcontent-%COMP%]{stroke:#fff;stroke-width:2px}"]}),r})(),Kv=(()=>{class r extends xp{constructor(e){super(e)}ngOnInit(){this.file?(this.videoSrc=URL.createObjectURL(this.file),this.sanitizedVideoSrc=this.sanitizer.bypassSecurityTrustUrl(this.videoSrc)):console.error("No file to read. Please provide a file using the [file] Input property.")}ngOnDestroy(){URL.revokeObjectURL(this.videoSrc)}}return r.\u0275fac=function(e){return new(e||r)(b.Y36(ng.H7))},r.\u0275cmp=b.Xpm({type:r,selectors:[["ngx-dropzone-video-preview"]],features:[b._Bn([{provide:xp,useExisting:r}]),b.qOj],ngContentSelectors:og,decls:3,vars:2,consts:[["controls","",3,"click",4,"ngIf"],[3,"click",4,"ngIf"],["controls","",3,"click"],[3,"src"],[3,"click"]],template:function(e,s){1&e&&(b.F$t(ig),b.YNc(0,jv,2,1,"video",0),b.Hsn(1),b.YNc(2,Xv,1,0,"ngx-dropzone-remove-badge",1)),2&e&&(b.Q6J("ngIf",s.sanitizedVideoSrc),b.xp6(2),b.Q6J("ngIf",s.removable))},directives:[Ya.O5,ag],styles:["[_nghost-%COMP%]{max-width:unset!important;min-width:unset!important;padding:0!important}[_nghost-%COMP%]:focus   video[_ngcontent-%COMP%], [_nghost-%COMP%]:hover   video[_ngcontent-%COMP%]{opacity:.7}[_nghost-%COMP%]:focus   ngx-dropzone-remove-badge[_ngcontent-%COMP%], [_nghost-%COMP%]:hover   ngx-dropzone-remove-badge[_ngcontent-%COMP%]{opacity:1}[_nghost-%COMP%]   ngx-dropzone-remove-badge[_ngcontent-%COMP%]{opacity:0}[_nghost-%COMP%]   video[_ngcontent-%COMP%]{border-radius:5px;max-height:100%}[_nghost-%COMP%]     ngx-dropzone-label{overflow-wrap:break-word;position:absolute}"]}),r})(),Qv=(()=>{class r{}return r.\u0275fac=function(e){return new(e||r)},r.\u0275mod=b.oAB({type:r}),r.\u0275inj=b.cJS({imports:[[Ya.ez]]}),r})();function $v(r,o){if(1&r){const e=b.EpF();b.TgZ(0,"ngx-dropzone-image-preview",3),b.NdJ("removed",function(){b.CHM(e);const f=b.oxw().$implicit;return b.oxw().onRemove(f)}),b.TgZ(1,"ngx-dropzone-label"),b._uU(2),b.qZA(),b.qZA()}if(2&r){const e=b.oxw().$implicit;b.Q6J("file",e)("removable",!0),b.xp6(2),b.AsE("",e.name," (",e.type,")")}}function t_(r,o){if(1&r){const e=b.EpF();b.TgZ(0,"ngx-dropzone-video-preview",3),b.NdJ("removed",function(){b.CHM(e);const f=b.oxw().$implicit;return b.oxw().onRemove(f)}),b.TgZ(1,"ngx-dropzone-label"),b._uU(2),b.qZA(),b.qZA()}if(2&r){const e=b.oxw().$implicit;b.Q6J("file",e)("removable",!0),b.xp6(2),b.AsE("",e.name," (",e.type,")")}}function e_(r,o){if(1&r&&(b.ynx(0),b.YNc(1,$v,3,4,"ngx-dropzone-image-preview",2),b.YNc(2,t_,3,4,"ngx-dropzone-video-preview",2),b.BQk()),2&r){const e=o.$implicit;b.xp6(1),b.Q6J("ngIf",e.type.includes("image")),b.xp6(1),b.Q6J("ngIf",e.type.includes("video"))}}let r_=(()=>{class r{constructor(){this.files=[],this.maxAllowableSize=25e6,this.currentSize=0,this.error=new b.vpe,this.fileToBase64=e=>new Promise((s,f)=>{const m=new FileReader;m.readAsDataURL(e),m.onload=()=>s(m.result.toString()),m.onerror=x=>f(x)})}onSelect(e){var s;console.log(e);let f=e.addedFiles.reduce((m,x)=>m+x.size,0);f+=this.currentSize,f<=this.maxAllowableSize?(this.files.push(...e.addedFiles),this.currentSize=f):(console.log(Ze.UploadTooLarge),this.errorOccured(Ze.UploadTooLarge)),(null===(s=e.rejectedFiles)||void 0===s?void 0:s.length)>0&&(console.log(Ze.UploadWrongType),this.errorOccured(Ze.UploadWrongType))}onRemove(e){console.log(e),this.files.splice(this.files.indexOf(e),1),this.currentSize-=null==e?void 0:e.size}onFilesAdded(){this.readFile(this.files[0]).then(e=>{console.log(e)})}readFile(e){return function(r){return function(){var o=this,e=arguments;return new Promise(function(s,f){var m=r.apply(o,e);function x(M){Lm(m,s,f,x,I,"next",M)}function I(M){Lm(m,s,f,x,I,"throw",M)}x(void 0)})}}(function*(){return new Promise((s,f)=>{const m=new FileReader;if(m.onload=x=>s(x.target.result),m.onerror=x=>(console.error(`FileReader failed on file ${e.name}.`),f(null)),!e)return console.error("No file to read."),f(null);m.readAsDataURL(e)})})()}errorOccured(e){this.error.emit(e)}}return r.\u0275fac=function(e){return new(e||r)},r.\u0275cmp=b.Xpm({type:r,selectors:[["app-file-upload"]],outputs:{error:"error"},decls:6,vars:3,consts:[["ngx-dropzone","",1,"appDropzone",3,"accept","expandable","change"],[4,"ngFor","ngForOf"],["ngProjectAs","ngx-dropzone-preview",5,["ngx-dropzone-preview"],3,"file","removable","removed",4,"ngIf"],["ngProjectAs","ngx-dropzone-preview",5,["ngx-dropzone-preview"],3,"file","removable","removed"]],template:function(e,s){1&e&&(b.TgZ(0,"div",0),b.NdJ("change",function(m){return s.onSelect(m)}),b.TgZ(1,"ngx-dropzone-label"),b.TgZ(2,"div"),b.TgZ(3,"h2"),b._uU(4,"Drag files here or click to add images/videos."),b.qZA(),b.qZA(),b.qZA(),b.YNc(5,e_,3,2,"ng-container",1),b.qZA()),2&e&&(b.Q6J("accept","image/*,video/*")("expandable",!0),b.xp6(5),b.Q6J("ngForOf",s.files))},directives:[Hv,Yv,Ya.sg,Ya.O5,Jv,Kv],styles:["ngx-dropzone-label[_ngcontent-%COMP%]{color:#000;text-shadow:-1px -1px 0 #fff,1px -1px 0 #fff,-1px 1px 0 #fff,1px 1px 0 #fff}"]}),r})();function n_(r,o){1&r&&(b.TgZ(0,"mat-error"),b._uU(1,"This field is required."),b.qZA())}function i_(r,o){if(1&r&&(b.TgZ(0,"mat-option",17),b._uU(1),b.qZA()),2&r){const e=o.$implicit;b.Q6J("value",null==e?null:e.AnimalCountId),b.xp6(1),b.hij(" ",null==e?null:e.Name," ")}}function o_(r,o){1&r&&(b.TgZ(0,"mat-error"),b._uU(1,"This field is required."),b.qZA())}function a_(r,o){if(1&r&&(b.TgZ(0,"mat-option",17),b._uU(1),b.qZA()),2&r){const e=o.$implicit;b.Q6J("value",null==e?null:e.SpeciestId),b.xp6(1),b.hij(" ",null==e?null:e.Name," ")}}function s_(r,o){1&r&&(b.TgZ(0,"mat-error"),b._uU(1,"This field is required."),b.qZA())}function u_(r,o){if(1&r&&(b.TgZ(0,"mat-option",17),b._uU(1),b.qZA()),2&r){const e=o.$implicit;b.Q6J("value",null==e?null:e.RefTableDataId),b.xp6(1),b.hij(" ",null==e?null:e.Name," ")}}function l_(r,o){1&r&&(b.TgZ(0,"mat-error"),b._uU(1,"This field is required."),b.qZA())}function c_(r,o){if(1&r&&(b.TgZ(0,"mat-option",17),b._uU(1),b.qZA()),2&r){const e=o.$implicit;b.Q6J("value",null==e?null:e.RefTableDataId),b.xp6(1),b.hij(" ",null==e?null:e.Name," ")}}function h_(r,o){1&r&&(b.TgZ(0,"mat-error"),b._uU(1,"This field is required."),b.qZA())}function p_(r,o){if(1&r&&(b.TgZ(0,"mat-option",17),b._uU(1),b.qZA()),2&r){const e=o.$implicit;b.Q6J("value",null==e?null:e.RefTableDataId),b.xp6(1),b.hij(" ",null==e?null:e.Name," ")}}function f_(r,o){1&r&&(b.TgZ(0,"mat-error"),b._uU(1,"This field is required."),b.qZA())}function d_(r,o){if(1&r&&(b.TgZ(0,"div",41),b.TgZ(1,"div",5),b.TgZ(2,"div",6),b.TgZ(3,"mat-form-field"),b.TgZ(4,"mat-label",42),b._uU(5,"Injured"),b.qZA(),b.TgZ(6,"mat-select",43),b.YNc(7,c_,2,2,"mat-option",14),b.qZA(),b.TgZ(8,"mat-hint"),b._uU(9,"Does animal appear to be sick or injured?"),b.qZA(),b.YNc(10,h_,2,0,"mat-error",11),b.qZA(),b.qZA(),b.qZA(),b.TgZ(11,"div",5),b.TgZ(12,"div",6),b.TgZ(13,"mat-form-field"),b.TgZ(14,"mat-label",44),b._uU(15,"Possession"),b.qZA(),b.TgZ(16,"mat-select",45),b.YNc(17,p_,2,2,"mat-option",14),b.qZA(),b.TgZ(18,"mat-hint"),b._uU(19,"Is the animal in your possession?"),b.qZA(),b.YNc(20,f_,2,0,"mat-error",11),b.qZA(),b.qZA(),b.qZA(),b.qZA()),2&r){const e=b.oxw(3);b.Q6J("@animalAlive",e.animalAlive),b.xp6(7),b.Q6J("ngForOf",e.yesNoList),b.xp6(3),b.Q6J("ngIf",(null==e.sickOrInjured?null:e.sickOrInjured.invalid)&&(null==e.sickOrInjured||null==e.sickOrInjured.errors?null:e.sickOrInjured.errors.required)),b.xp6(7),b.Q6J("ngForOf",e.yesNoList),b.xp6(3),b.Q6J("ngIf",(null==e.inYourPossession?null:e.inYourPossession.invalid)&&(null==e.inYourPossession||null==e.inYourPossession.errors?null:e.inYourPossession.errors.required))}}function g_(r,o){if(1&r&&(b.TgZ(0,"mat-option",17),b._uU(1),b.qZA()),2&r){const e=o.$implicit;b.Q6J("value",null==e?null:e.RefTableDataId),b.xp6(1),b.hij(" ",null==e?null:e.Name," ")}}function m_(r,o){1&r&&(b.TgZ(0,"mat-error"),b._uU(1,"This field is required."),b.qZA())}function y_(r,o){if(1&r&&(b.TgZ(0,"div",46),b.TgZ(1,"div",5),b.TgZ(2,"div",6),b.TgZ(3,"mat-form-field"),b.TgZ(4,"mat-label",47),b._uU(5,"Poaching"),b.qZA(),b.TgZ(6,"mat-select",48),b.YNc(7,g_,2,2,"mat-option",14),b.qZA(),b.TgZ(8,"mat-hint"),b._uU(9,"Is poaching suspected? "),b._UZ(10,"app-info-popup",31),b.qZA(),b.YNc(11,m_,2,0,"mat-error",11),b.qZA(),b.qZA(),b.qZA(),b.qZA()),2&r){const e=b.oxw(3);b.Q6J("@animalDead",e.animalDead),b.xp6(7),b.Q6J("ngForOf",e.yesNoList),b.xp6(3),b.Q6J("title","Poaching")("text",e.messagePoaching),b.xp6(1),b.Q6J("ngIf",(null==e.poaching?null:e.poaching.invalid)&&(null==e.poaching||null==e.poaching.errors?null:e.poaching.errors.required))}}function v_(r,o){if(1&r&&(b.TgZ(0,"mat-option",17),b._uU(1),b.qZA()),2&r){const e=o.$implicit;b.Q6J("value",null==e?null:e.WildlifeAgeId),b.xp6(1),b.hij(" ",null==e?null:e.Name," ")}}function __(r,o){1&r&&(b.TgZ(0,"mat-error"),b._uU(1,"This field is required."),b.qZA())}function x_(r,o){if(1&r&&(b.TgZ(0,"mat-option",17),b._uU(1),b.qZA()),2&r){const e=o.$implicit;b.Q6J("value",null==e?null:e.CaptiveId),b.xp6(1),b.hij(" ",null==e?null:e.Name," ")}}function b_(r,o){1&r&&(b.TgZ(0,"mat-error"),b._uU(1,"This field is required."),b.qZA())}function w_(r,o){if(1&r&&(b.TgZ(0,"mat-option",17),b._uU(1),b.qZA()),2&r){const e=o.$implicit;b.Q6J("value",null==e?null:e.RefTableDataId),b.xp6(1),b.hij(" ",null==e?null:e.Name," ")}}function E_(r,o){1&r&&(b.TgZ(0,"mat-error"),b._uU(1,"This field is required."),b.qZA())}function C_(r,o){if(1&r&&(b.TgZ(0,"mat-option",17),b._uU(1),b.qZA()),2&r){const e=o.$implicit;b.Q6J("value",null==e?null:e.RefTableDataId),b.xp6(1),b.hij(" ",null==e?null:e.Name," ")}}function S_(r,o){1&r&&(b.TgZ(0,"mat-error"),b._uU(1,"This field is required."),b.qZA())}function I_(r,o){if(1&r&&(b.TgZ(0,"div",49),b.TgZ(1,"div",6),b.TgZ(2,"mat-form-field"),b.TgZ(3,"mat-label",50),b._uU(4,"Rabies"),b.qZA(),b.TgZ(5,"mat-select",51),b.YNc(6,C_,2,2,"mat-option",14),b.qZA(),b.TgZ(7,"mat-hint"),b._uU(8,"Are rabies suspected? "),b._UZ(9,"app-info-popup",31),b.qZA(),b.YNc(10,S_,2,0,"mat-error",11),b.qZA(),b.qZA(),b.qZA()),2&r){const e=b.oxw(3);b.Q6J("@mammalSelected",e.mammalSelected),b.xp6(6),b.Q6J("ngForOf",e.yesNoList),b.xp6(3),b.Q6J("title","Rabies")("text",e.messageRabies),b.xp6(1),b.Q6J("ngIf",(null==e.rabies?null:e.rabies.invalid)&&(null==e.rabies||null==e.rabies.errors?null:e.rabies.errors.required))}}function P_(r,o){1&r&&(b.TgZ(0,"mat-error"),b._uU(1,"This field is limited to 1,500 characters."),b.qZA())}function M_(r,o){if(1&r){const e=b.EpF();b.TgZ(0,"div",22),b.TgZ(1,"div",4),b.TgZ(2,"div",5),b.TgZ(3,"div",6),b.TgZ(4,"mat-form-field"),b.TgZ(5,"mat-label",23),b._uU(6,"Alive"),b.qZA(),b.TgZ(7,"mat-select",24),b.YNc(8,u_,2,2,"mat-option",14),b.qZA(),b.TgZ(9,"mat-hint"),b._uU(10,"Was the animal alive at time of observation?"),b.qZA(),b.YNc(11,l_,2,0,"mat-error",11),b.qZA(),b.qZA(),b.qZA(),b.qZA(),b.YNc(12,d_,21,5,"div",25),b.YNc(13,y_,12,5,"div",26),b.TgZ(14,"div",4),b.TgZ(15,"div",5),b.TgZ(16,"div",6),b.TgZ(17,"mat-form-field"),b.TgZ(18,"mat-label",27),b._uU(19,"Age"),b.qZA(),b.TgZ(20,"mat-select",28),b.YNc(21,v_,2,2,"mat-option",14),b.qZA(),b.TgZ(22,"mat-hint"),b._uU(23,"What age is the majority of the wildlife?"),b.qZA(),b.YNc(24,__,2,0,"mat-error",11),b.qZA(),b.qZA(),b.qZA(),b.TgZ(25,"div",5),b.TgZ(26,"div",6),b.TgZ(27,"mat-form-field"),b.TgZ(28,"mat-label",29),b._uU(29,"Captive or Wild"),b.qZA(),b.TgZ(30,"mat-select",30),b.YNc(31,x_,2,2,"mat-option",14),b.qZA(),b.TgZ(32,"mat-hint"),b._uU(33,"Is this a captive animal or a free-ranging wild animal? "),b._UZ(34,"app-info-popup",31),b.qZA(),b.YNc(35,b_,2,0,"mat-error",11),b.qZA(),b.qZA(),b.qZA(),b.qZA(),b.TgZ(36,"div",4),b.TgZ(37,"div",5),b.TgZ(38,"div",6),b.TgZ(39,"mat-form-field"),b.TgZ(40,"mat-label",32),b._uU(41,"Zoonotic Exposure"),b.qZA(),b.TgZ(42,"mat-select",33),b.YNc(43,w_,2,2,"mat-option",14),b.qZA(),b._UZ(44,"mat-hint"),b.YNc(45,E_,2,0,"mat-error",11),b.qZA(),b.qZA(),b.qZA(),b.YNc(46,I_,11,5,"div",34),b.qZA(),b.TgZ(47,"div",4),b._UZ(48,"mat-divider",15),b.qZA(),b.TgZ(49,"div",35),b.TgZ(50,"div",36),b.TgZ(51,"div",6),b.TgZ(52,"mat-form-field"),b.TgZ(53,"mat-label",37),b._uU(54,"Additional Details"),b.qZA(),b._UZ(55,"textarea",38),b.TgZ(56,"mat-hint"),b._uU(57,"Please describe what you observed, including details about the physical appearance and behavior of the animal(s) and the environment. What did each animal look like and what was it doing? What signs of illness or injury did you observe, if any? What time of day or night was your observation made? What was the weather like? Describe the location where the observation was made."),b.qZA(),b.YNc(58,P_,2,0,"mat-error",11),b.qZA(),b.qZA(),b.qZA(),b.qZA(),b.TgZ(59,"div",35),b.TgZ(60,"div",36),b.TgZ(61,"div",39),b._UZ(62,"app-intro-helper-text",0),b.TgZ(63,"app-file-upload",40),b.NdJ("error",function(f){return b.CHM(e),b.oxw(2).openSnackBar(f)}),b.qZA(),b.qZA(),b.qZA(),b.qZA(),b.qZA()}if(2&r){const e=b.oxw(2);b.Q6J("@speciesSelected",e.speciesSelected),b.xp6(8),b.Q6J("ngForOf",e.yesNoList),b.xp6(3),b.Q6J("ngIf",(null==e.alive?null:e.alive.invalid)&&(null==e.alive||null==e.alive.errors?null:e.alive.errors.required)),b.xp6(1),b.Q6J("ngIf",(null==e.alive?null:e.alive.valid)&&(null==e.alive?null:e.alive.value)===e.refYes),b.xp6(1),b.Q6J("ngIf",(null==e.alive?null:e.alive.valid)&&(null==e.alive?null:e.alive.value)===e.refNo),b.xp6(8),b.Q6J("ngForOf",e.ageList),b.xp6(3),b.Q6J("ngIf",(null==e.age?null:e.age.invalid)&&(null==e.age||null==e.age.errors?null:e.age.errors.required)),b.xp6(7),b.Q6J("ngForOf",e.captiveList),b.xp6(3),b.Q6J("title","Captive or Wild")("text",e.messageCaptive),b.xp6(1),b.Q6J("ngIf",(null==e.captiveWild?null:e.captiveWild.invalid)&&(null==e.captiveWild||null==e.captiveWild.errors?null:e.captiveWild.errors.required)),b.xp6(8),b.Q6J("ngForOf",e.yesNoList),b.xp6(2),b.Q6J("ngIf",(null==e.zoonotic?null:e.zoonotic.invalid)&&(null==e.zoonotic||null==e.zoonotic.errors?null:e.zoonotic.errors.required)),b.xp6(1),b.Q6J("ngIf",(null==e.species?null:e.species.valid)&&e.speciesCodeIsMammal(null==e.species?null:e.species.value)),b.xp6(12),b.Q6J("ngIf",(null==e.details?null:e.details.invalid)&&(null==e.details||null==e.details.errors?null:e.details.errors.maxLength)),b.xp6(4),b.Q6J("header",e.photosHeader)("content",e.photosContent)}}function T_(r,o){if(1&r&&(b.TgZ(0,"div",18),b.TgZ(1,"div",4),b.TgZ(2,"div",5),b.TgZ(3,"div",6),b.TgZ(4,"mat-form-field"),b.TgZ(5,"mat-label",19),b._uU(6,"Species"),b.qZA(),b.TgZ(7,"mat-select",20),b.YNc(8,a_,2,2,"mat-option",14),b.qZA(),b.TgZ(9,"mat-hint"),b._uU(10,"What species is the majority of the animals that were observed?"),b.qZA(),b.YNc(11,s_,2,0,"mat-error",11),b.qZA(),b.qZA(),b.qZA(),b.qZA(),b.YNc(12,M_,64,17,"div",21),b.qZA()),2&r){const e=b.oxw();b.Q6J("@state",e.state),b.xp6(8),b.Q6J("ngForOf",e.speciesList),b.xp6(3),b.Q6J("ngIf",(null==e.species?null:e.species.invalid)&&(null==e.species||null==e.species.errors?null:e.species.errors.required)),b.xp6(1),b.Q6J("ngIf",null==e.species?null:e.species.valid)}}let A_=(()=>{class r{constructor(e,s,f){this.obsStore=e,this.api=s,this._snackBar=f,this.header=kt.y.AnimalHeader,this.content=Ze.AnimalHelperText,this.photosHeader=kt.y.PhotosHeader,this.photosContent=Ze.PhotosHelperText,this.state=kt.y.Hidden,this.animalAlive=kt.y.Hidden,this.animalDead=kt.y.Hidden,this.speciesSelected=kt.y.Hidden,this.mammalSelected=kt.y.Hidden,this.animalForm=new Tn.cw({date:new Tn.NI("",[Tn.kI.required]),numberOfAnimals:new Tn.NI("",[Tn.kI.required]),species:new Tn.NI("",[Tn.kI.required]),alive:new Tn.NI("",[Tn.kI.required]),sickOrInjured:new Tn.NI("",[]),inYourPossession:new Tn.NI("",[]),poaching:new Tn.NI("",[]),age:new Tn.NI("",[Tn.kI.required]),captiveWild:new Tn.NI("",[Tn.kI.required]),rabies:new Tn.NI("",[]),zoonotic:new Tn.NI("",[Tn.kI.required]),details:new Tn.NI("",[Tn.kI.maxLength(1500)])}),this.numberOfAnimalsList=[],this.speciesList=[],this.yesNoList=[],this.ageList=[],this.captiveList=[],this.classificationList=[],this.refYes=kt.y.RefLookupYes,this.refNo=kt.y.RefLookupNo,this.refMammal=kt.y.RefLookupMammal,this.messageRabies=Ze.RabiesPopup,this.messageCaptive=Ze.CaptivePopup,this.messagePoaching=Ze.PoachingPopup,this.maxDate=new Date,this.isValid=new b.vpe(!1)}ngOnInit(){this.formChangeSub=this.animalForm.valueChanges.pipe((0,Yd.b)(200)).subscribe({next:e=>{this.obsStore.getObservation().pipe((0,Xd.P)()).subscribe(s=>{if(this.animalForm.valid){const f=Object.assign({},s);f.information=Object.assign({},e),this.obsStore.updateObservation(f)}this.isValid.emit(this.animalForm.valid),this.checkHiddenFields()})}}),this.initializeDropdowns()}ngOnDestroy(){this.formChangeSub.unsubscribe()}get date(){return this.animalForm.get("date")}get species(){return this.animalForm.get("species")}get numberOfAnimals(){return this.animalForm.get("numberOfAnimals")}get alive(){return this.animalForm.get("alive")}get sickOrInjured(){return this.animalForm.get("sickOrInjured")}get inYourPossession(){return this.animalForm.get("inYourPossession")}get poaching(){return this.animalForm.get("poaching")}get age(){return this.animalForm.get("age")}get captiveWild(){return this.animalForm.get("captiveWild")}get rabies(){return this.animalForm.get("rabies")}get zoonotic(){return this.animalForm.get("zoonotic")}get details(){return this.animalForm.get("details")}initializeDropdowns(){this.api.getAnimalCount().subscribe(e=>{this.numberOfAnimalsList=e},e=>{console.error(e)}),this.api.getSpecies().subscribe(e=>{this.speciesList=e},e=>{console.error(e)}),this.api.getYesNo().subscribe(e=>{this.yesNoList=e},e=>{console.error(e)}),this.api.getAge().subscribe(e=>{this.ageList=e},e=>{console.error(e)}),this.api.getCaptive().subscribe(e=>{this.captiveList=e},e=>{console.error(e)}),this.api.getClassification().subscribe(e=>{this.classificationList=e},e=>{console.error(e)})}checkHiddenFields(){var e,s,f,m,x,I,M,S,D,R,N,B,Ct,pt,$t;this.state===kt.y.Hidden&&(null===(e=this.date)||void 0===e?void 0:e.valid)&&(null===(s=this.numberOfAnimals)||void 0===s?void 0:s.valid)&&(this.state=kt.y.Visible),(null===(f=this.alive)||void 0===f?void 0:f.valid)&&(null===(m=this.alive)||void 0===m?void 0:m.value)===this.refYes?(this.animalAlive=kt.y.Visible,this.animalDead=kt.y.Hidden,null===(x=this.poaching)||void 0===x||x.reset()):(null===(I=this.alive)||void 0===I?void 0:I.valid)&&(null===(M=this.alive)||void 0===M?void 0:M.value)===this.refNo?(this.animalAlive=kt.y.Hidden,this.animalDead=kt.y.Visible,null===(S=this.sickOrInjured)||void 0===S||S.reset(),null===(D=this.inYourPossession)||void 0===D||D.reset()):(this.animalAlive=kt.y.Hidden,this.animalDead=kt.y.Hidden,null===(R=this.poaching)||void 0===R||R.reset(),null===(N=this.sickOrInjured)||void 0===N||N.reset(),null===(B=this.inYourPossession)||void 0===B||B.reset()),(null===(Ct=this.species)||void 0===Ct?void 0:Ct.valid)&&(this.speciesSelected=kt.y.Visible,this.speciesCodeIsMammal(null===(pt=this.species)||void 0===pt?void 0:pt.value)?this.mammalSelected=kt.y.Visible:(this.mammalSelected=kt.y.Hidden,null===($t=this.rabies)||void 0===$t||$t.reset()))}speciesCodeIsMammal(e){const s=this.speciesList.find(f=>f.SpeciestId===e);return!(!s||s.ClassificationId!==this.refMammal)}openSnackBar(e,s="Close"){this._snackBar.open(e,s)}}return r.\u0275fac=function(e){return new(e||r)(b.Y36(St),b.Y36(Tm),b.Y36(Rv.ux))},r.\u0275cmp=b.Xpm({type:r,selectors:[["app-animal"]],outputs:{isValid:"isValid"},decls:30,vars:10,consts:[[3,"header","content"],[1,"appContactContainer"],[3,"formGroup"],["fxLayout","column","fxLayout.xs","column","fxLayout.sm","column","fxLayoutAlign","start center","fxLayoutAlign.xs","start start","fxLayoutAlign.sm","start start","fxFlex",""],["fxLayout","row","fxLayout.xs","column","fxLayout.sm","column","fxLayoutAlign","start center","fxLayoutAlign.xs","start start","fxLayoutAlign.sm","start start","fxFlex","",1,"appFieldRow"],["fxFlex","50","fxFlex.xs","100","fxFlex.sm","100",1,"appFormRowContainer"],[1,"appFormContainer"],["for","observation-date"],["matInput","","id","observation-date","formControlName","date",3,"max","matDatepicker"],["matSuffix","",3,"for"],["picker",""],[4,"ngIf"],["for","observation-numberOfAnimals"],["id","observation-numberOfAnimals","formControlName","numberOfAnimals"],[3,"value",4,"ngFor","ngForOf"],[1,"appFullWidth","appSpacer"],["fxLayout","column","class","appFieldRow appHide appSpaceAtBottom",4,"ngIf"],[3,"value"],["fxLayout","column",1,"appFieldRow","appHide","appSpaceAtBottom"],["for","observation-species"],["id","observation-species","formControlName","species"],["fxLayout","column","class","appFieldRow appHide",4,"ngIf"],["fxLayout","column",1,"appFieldRow","appHide"],["for","observation-alive"],["id","observation-alive","formControlName","alive"],["appHide","","class","appFieldRow appHide","fxLayout","row","fxLayout.xs","column","fxLayout.sm","column","fxLayoutAlign","start center","fxLayoutAlign.xs","start start","fxLayoutAlign.sm","start start","fxFlex","",4,"ngIf"],["class","appFieldRow appHide","fxLayout","row","fxLayout.xs","column","fxLayout.sm","column","fxLayoutAlign","start center","fxLayoutAlign.xs","start start","fxLayoutAlign.sm","start start","fxFlex","",4,"ngIf"],["for","observation-age"],["id","observation-age","formControlName","age"],["for","observation-captiveWild"],["id","observation-captiveWild","formControlName","captiveWild"],[3,"title","text"],["for","observation-zoonotic"],["id","observation-zoonotic","formControlName","zoonotic"],["fxFlex","50","fxFlex.xs","100","fxFlex.sm","100","class","appFormRowContainer appHide",4,"ngIf"],["fxLayout","row","fxLayout.xs","column","fxLayout.sm","column","fxLayoutAlign","center center","fxLayoutAlign.xs","center center","fxLayoutAlign.sm","center center","fxFlex","",1,"appFieldRow"],["fxFlex","100","fxFlex.xs","100","fxFlex.sm","100",1,"appFormRowContainer"],["for","observation-details"],["id","observation-details","formControlName","alive","matInput","","placeholder","Additional Details"],[1,"appFormContainer","appPhotoContainer"],[3,"error"],["appHide","","fxLayout","row","fxLayout.xs","column","fxLayout.sm","column","fxLayoutAlign","start center","fxLayoutAlign.xs","start start","fxLayoutAlign.sm","start start","fxFlex","",1,"appFieldRow","appHide"],["for","observation-sickOrInjured"],["id","observation-sickOrInjured","formControlName","sickOrInjured"],["for","observation-inYourPossession"],["id","observation-inYourPossession","formControlName","inYourPossession"],["fxLayout","row","fxLayout.xs","column","fxLayout.sm","column","fxLayoutAlign","start center","fxLayoutAlign.xs","start start","fxLayoutAlign.sm","start start","fxFlex","",1,"appFieldRow","appHide"],["for","observation-poaching"],["id","observation-poaching","formControlName","poaching"],["fxFlex","50","fxFlex.xs","100","fxFlex.sm","100",1,"appFormRowContainer","appHide"],["for","observation-rabies"],["id","observation-rabies","formControlName","rabies"]],template:function(e,s){if(1&e&&(b._UZ(0,"app-intro-helper-text",0),b.TgZ(1,"div",1),b.TgZ(2,"form",2),b.TgZ(3,"div",3),b.TgZ(4,"div",4),b.TgZ(5,"div",5),b.TgZ(6,"div",6),b.TgZ(7,"mat-form-field"),b.TgZ(8,"mat-label",7),b._uU(9,"Date"),b.qZA(),b._UZ(10,"input",8),b._UZ(11,"mat-datepicker-toggle",9),b._UZ(12,"mat-datepicker",null,10),b.TgZ(14,"mat-hint"),b._uU(15,"Enter the date of observation"),b.qZA(),b.YNc(16,n_,2,0,"mat-error",11),b.qZA(),b.qZA(),b.qZA(),b.TgZ(17,"div",5),b.TgZ(18,"div",6),b.TgZ(19,"mat-form-field"),b.TgZ(20,"mat-label",12),b._uU(21,"Number of Animals"),b.qZA(),b.TgZ(22,"mat-select",13),b.YNc(23,i_,2,2,"mat-option",14),b.qZA(),b.TgZ(24,"mat-hint"),b._uU(25,"How many animals did you see?"),b.qZA(),b.YNc(26,o_,2,0,"mat-error",11),b.qZA(),b.qZA(),b.qZA(),b.qZA(),b.TgZ(27,"div",4),b._UZ(28,"mat-divider",15),b.qZA(),b.YNc(29,T_,13,4,"div",16),b.qZA(),b.qZA(),b.qZA()),2&e){const f=b.MAs(13);b.Q6J("header",s.header)("content",s.content),b.xp6(2),b.Q6J("formGroup",s.animalForm),b.xp6(8),b.Q6J("max",s.maxDate)("matDatepicker",f),b.xp6(1),b.Q6J("for",f),b.xp6(5),b.Q6J("ngIf",(null==s.date?null:s.date.invalid)&&(null==s.date||null==s.date.errors?null:s.date.errors.required)),b.xp6(7),b.Q6J("ngForOf",s.numberOfAnimalsList),b.xp6(3),b.Q6J("ngIf",(null==s.numberOfAnimals?null:s.numberOfAnimals.invalid)&&(null==s.numberOfAnimals||null==s.numberOfAnimals.errors?null:s.numberOfAnimals.errors.required)),b.xp6(3),b.Q6J("ngIf",(null==s.date?null:s.date.valid)&&(null==s.numberOfAnimals?null:s.numberOfAnimals.valid))}},directives:[ue,Tn._Y,Tn.JL,Tn.sg,zu.xw,zu.Wh,zu.yH,ml.KE,ml.hX,tg.Nt,Tn.Fj,rg.hl,Tn.JJ,Tn.u,rg.nW,ml.R9,rg.Mq,ml.bx,Ya.O5,Am.gD,Ya.sg,ye.d,ml.TO,eg.ey,kv,r_],styles:[".appContactContainer[_ngcontent-%COMP%]{min-height:20vh;margin-top:1rem;margin-left:5rem;margin-right:5rem}.mat-form-field[_ngcontent-%COMP%]{min-width:60%;font-size:1rem}.appFormContainer[_ngcontent-%COMP%]{margin-bottom:1.5rem}.appFieldRow[_ngcontent-%COMP%]{width:100%}.appSpacer[_ngcontent-%COMP%]{margin-top:2rem;margin-bottom:2rem}.appHide[_ngcontent-%COMP%]{opacity:0}.appSpaceAtBottom[_ngcontent-%COMP%]{margin-bottom:10rem}#observation-details[_ngcontent-%COMP%]{max-height:8rem}.appPhotoContainer[_ngcontent-%COMP%]{margin-top:1.5rem}@media only screen and (max-width: 480px){.appContactContainer[_ngcontent-%COMP%]{margin-left:0;margin-right:0}.appFormRowContainer[_ngcontent-%COMP%]{width:100%}.mat-form-field[_ngcontent-%COMP%]{min-width:100%}.appPhotoContainer[_ngcontent-%COMP%]{margin-top:5rem}}@media only screen and (min-width: 321px){.appContactContainer[_ngcontent-%COMP%]{margin-left:0;margin-right:0}.appFormRowContainer[_ngcontent-%COMP%]{width:100%}.mat-form-field[_ngcontent-%COMP%]{min-width:100%}.appPhotoContainer[_ngcontent-%COMP%]{margin-top:5rem}}@media only screen and (min-width: 1224px){.appContactContainer[_ngcontent-%COMP%]{margin-left:5rem;margin-right:5rem}.mat-form-field[_ngcontent-%COMP%]{min-width:60%}.appInfoIcon[_ngcontent-%COMP%]{margin-left:1.5rem}.appPhotoContainer[_ngcontent-%COMP%]{margin-top:1.5rem}}@media only screen and (min-width: 1824px){.appContactContainer[_ngcontent-%COMP%]{margin-left:5rem;margin-right:5rem}.mat-form-field[_ngcontent-%COMP%]{min-width:60%}.appInfoIcon[_ngcontent-%COMP%]{margin-left:1.5rem}.appPhotoContainer[_ngcontent-%COMP%]{margin-top:1.5rem}}"],data:{animation:[(0,Vn.X$)("state",[(0,Vn.SB)(kt.y.Hidden,(0,Vn.oB)({opacity:"0"})),(0,Vn.SB)(kt.y.Visible,(0,Vn.oB)({opacity:"1"})),(0,Vn.eR)(`* => ${kt.y.Visible}`,[(0,Vn.jt)("500ms ease-out")]),(0,Vn.eR)(`${kt.y.Visible} => ${kt.y.Hidden}`,[(0,Vn.jt)("500ms ease-out")])]),(0,Vn.X$)("animalAlive",[(0,Vn.SB)(kt.y.Hidden,(0,Vn.oB)({opacity:"0"})),(0,Vn.SB)(kt.y.Visible,(0,Vn.oB)({opacity:"1"})),(0,Vn.eR)(`* => ${kt.y.Visible}`,[(0,Vn.jt)("500ms ease-out")]),(0,Vn.eR)(`${kt.y.Visible} => ${kt.y.Hidden}`,[(0,Vn.jt)("500ms ease-out")])]),(0,Vn.X$)("animalDead",[(0,Vn.SB)(kt.y.Hidden,(0,Vn.oB)({opacity:"0"})),(0,Vn.SB)(kt.y.Visible,(0,Vn.oB)({opacity:"1"})),(0,Vn.eR)(`* => ${kt.y.Visible}`,[(0,Vn.jt)("500ms ease-out")]),(0,Vn.eR)(`${kt.y.Visible} => ${kt.y.Hidden}`,[(0,Vn.jt)("500ms ease-out")])]),(0,Vn.X$)("speciesSelected",[(0,Vn.SB)(kt.y.Hidden,(0,Vn.oB)({opacity:"0"})),(0,Vn.SB)(kt.y.Visible,(0,Vn.oB)({opacity:"1"})),(0,Vn.eR)(`* => ${kt.y.Visible}`,[(0,Vn.jt)("500ms ease-out")]),(0,Vn.eR)(`${kt.y.Visible} => ${kt.y.Hidden}`,[(0,Vn.jt)("500ms ease-out")])]),(0,Vn.X$)("mammalSelected",[(0,Vn.SB)(kt.y.Hidden,(0,Vn.oB)({opacity:"0"})),(0,Vn.SB)(kt.y.Visible,(0,Vn.oB)({opacity:"1"})),(0,Vn.eR)(`* => ${kt.y.Visible}`,[(0,Vn.jt)("500ms ease-out")]),(0,Vn.eR)(`${kt.y.Visible} => ${kt.y.Hidden}`,[(0,Vn.jt)("500ms ease-out")])])]}}),r})();const L_=["stepper"],O_=["location"],D_=["contact"];function R_(r,o){1&r&&b._uU(0,"Location")}function N_(r,o){1&r&&b._uU(0,"Contact")}function z_(r,o){1&r&&b._uU(0,"Observation")}function k_(r,o){if(1&r){const e=b.EpF();b.TgZ(0,"button",15),b.NdJ("click",function(){return b.CHM(e),b.oxw(3),b.MAs(2).previous()}),b._uU(1," Back "),b.qZA()}}function F_(r,o){if(1&r){const e=b.EpF();b.TgZ(0,"button",16),b.NdJ("click",function(){return b.CHM(e),b.oxw(3),b.MAs(2).next()}),b._uU(1," Next "),b.qZA()}if(2&r){const e=b.oxw(3);b.Q6J("disabled",!e.isValid)}}function B_(r,o){if(1&r&&(b.ynx(0),b.YNc(1,k_,2,0,"button",13),b.YNc(2,F_,2,1,"button",14),b.BQk()),2&r){const e=b.oxw(2),s=b.MAs(2);b.xp6(1),b.Q6J("ngIf",s.selectedIndex>0),b.xp6(1),b.Q6J("ngIf",s.selectedIndex<e.totalSteps-1)}}function U_(r,o){if(1&r){const e=b.EpF();b.ynx(0),b.TgZ(1,"button",15),b.NdJ("click",function(){return b.CHM(e),b.oxw(2).routeOutOfState()}),b._uU(2," Next "),b.qZA(),b.BQk()}}function q_(r,o){if(1&r&&(b.ynx(0),b.YNc(1,B_,3,2,"ng-container",12),b.YNc(2,U_,3,0,"ng-container",12),b.BQk()),2&r){const e=o.ngIf;b.xp6(1),b.Q6J("ngIf",e.inState),b.xp6(1),b.Q6J("ngIf",!e.inState)}}function G_(r,o){if(1&r){const e=b.EpF();b.TgZ(0,"div"),b.TgZ(1,"p"),b._uU(2,"Observations occurring outside of Pennsylvania should be directed to the appropriate state agency."),b.qZA(),b.TgZ(3,"p"),b._uU(4,"A list of agencies can be found on the Association of Fish & Wildlife Agencies website "),b.TgZ(5,"a",5),b._uU(6,"here"),b.qZA(),b._uU(7,"."),b.qZA(),b.TgZ(8,"button",6),b.NdJ("click",function(){return b.CHM(e),b.oxw(2).home()}),b._uU(9," Return Home "),b.qZA(),b.qZA()}}function V_(r,o){if(1&r&&(b.TgZ(0,"div",3),b.YNc(1,G_,10,0,"div",4),b.qZA()),2&r){const e=o.ngIf;b.xp6(1),b.Q6J("ngIf",!e.inState)}}function j_(r,o){if(1&r){const e=b.EpF();b.TgZ(0,"div"),b.TgZ(1,"p"),b._uU(2,"You may have arrived on this page in error. Please return home and start over."),b.qZA(),b.TgZ(3,"button",6),b.NdJ("click",function(){return b.CHM(e),b.oxw(2).homeNoReset()}),b._uU(4," Return Home "),b.qZA(),b.qZA()}}function X_(r,o){if(1&r&&(b.TgZ(0,"div",3),b.YNc(1,j_,5,0,"div",4),b.qZA()),2&r){const e=o.ngIf;b.xp6(1),b.Q6J("ngIf",e.inState)}}const Y_=[{path:"",component:(()=>{class r{constructor(e,s,f){this.router=s,this.obsStore=f,this.isLinear=!0,this.totalSteps=3,this.locationIsValid=!1,this.contactIsValid=!0,this.observationIsValid=!1,this.isValid=!1,this.stepperOrientation=e.observe("(min-width: 800px)").pipe((0,yt.U)(({matches:m})=>m?"horizontal":"vertical"))}ngAfterViewInit(){this.stepper.selectionChange.subscribe(e=>{this.checkValid(e.selectedIndex)})}goBack(e){e.previous()}goForward(e){e.next()}routeOutOfState(){this.router.navigate(["/app/observation/outofstate"])}checkValid(e){let s;switch(s=void 0===e?this.stepper.selectedIndex:e,s){case 0:this.isValid=!!this.locationIsValid;break;case 1:this.isValid=!!this.contactIsValid}}}return r.\u0275fac=function(e){return new(e||r)(b.Y36(v.Yg),b.Y36(Bt.F0),b.Y36(St))},r.\u0275cmp=b.Xpm({type:r,selectors:[["app-observation"]],viewQuery:function(e,s){if(1&e&&(b.Gf(L_,5),b.Gf(O_,5),b.Gf(D_,5)),2&e){let f;b.iGM(f=b.CRH())&&(s.stepper=f.first),b.iGM(f=b.CRH())&&(s.location=f.first),b.iGM(f=b.CRH())&&(s.contact=f.first)}},decls:20,vars:10,consts:[[1,"appStepperContainer"],[3,"linear","orientation"],["stepper",""],[3,"completed"],["matStepLabel",""],[3,"isValid"],["location",""],["contact",""],[1,"appLastStep",3,"completed"],["animal",""],["id","appObservationFooter"],["fxFlex","","fxLayoutAlign","end center"],[4,"ngIf"],["mat-flat-button","","color","primary","class","appStepperButton","type","button",3,"click",4,"ngIf"],["mat-flat-button","","color","primary","class","appStepperButton","type","button",3,"disabled","click",4,"ngIf"],["mat-flat-button","","color","primary","type","button",1,"appStepperButton",3,"click"],["mat-flat-button","","color","primary","type","button",1,"appStepperButton",3,"disabled","click"]],template:function(e,s){1&e&&(b.TgZ(0,"div",0),b.TgZ(1,"mat-stepper",1,2),b.ALo(3,"async"),b.TgZ(4,"mat-step",3),b.YNc(5,R_,1,0,"ng-template",4),b.TgZ(6,"app-location",5,6),b.NdJ("isValid",function(m){return s.locationIsValid=m,s.checkValid()}),b.qZA(),b.qZA(),b.TgZ(8,"mat-step",3),b.YNc(9,N_,1,0,"ng-template",4),b.TgZ(10,"app-contact",5,7),b.NdJ("isValid",function(m){return s.contactIsValid=m,s.checkValid()}),b.qZA(),b.qZA(),b.TgZ(12,"mat-step",8),b.YNc(13,z_,1,0,"ng-template",4),b.TgZ(14,"app-animal",5,9),b.NdJ("isValid",function(m){return s.observationIsValid=m,s.checkValid()}),b.qZA(),b.qZA(),b.qZA(),b.qZA(),b.TgZ(16,"footer",10),b.TgZ(17,"div",11),b.YNc(18,q_,3,2,"ng-container",12),b.ALo(19,"async"),b.qZA(),b.qZA()),2&e&&(b.xp6(1),b.Q6J("linear",s.isLinear)("orientation",b.lcZ(3,6,s.stepperOrientation)),b.xp6(3),b.Q6J("completed",s.locationIsValid),b.xp6(4),b.Q6J("completed",s.contactIsValid),b.xp6(4),b.Q6J("completed",s.observationIsValid),b.xp6(6),b.Q6J("ngIf",b.lcZ(19,8,s.obsStore.getObservation())))},directives:[Ft.Vq,Ft.C0,Ft.VY,gv,Dv,A_,zu.yH,zu.Wh,Ya.O5,Uf.lW],pipes:[Ya.Ov],styles:[".appStepperContainer .mat-stepper-horizontal .mat-horizontal-stepper-header-container{background-color:#f2f2f2;padding-left:5rem;padding-right:5rem}.appStepperContainer[_ngcontent-%COMP%]{min-height:100vh;overflow-y:hidden}.appStepperButton[_ngcontent-%COMP%]{min-width:9rem}.appStepperButton[_ngcontent-%COMP%]:first-of-type{margin-right:2rem}  .mat-horizontal-content-container{margin-left:5rem;margin-right:5rem}@media only screen and (max-width: 480px){  .mat-horizontal-content-container{margin-left:.5rem;margin-right:.5rem}  .mat-vertical-content-container{margin-left:0!important}}"]}),r})()},{path:"outofstate",component:(()=>{class r{constructor(e,s){this.router=e,this.obsStore=s,this.header=kt.y.OutOfStateHeader}home(){this.obsStore.resetObservation(),this.router.navigate(["/"])}homeNoReset(){this.router.navigate(["/"])}}return r.\u0275fac=function(e){return new(e||r)(b.Y36(Bt.F0),b.Y36(St))},r.\u0275cmp=b.Xpm({type:r,selectors:[["app-out-of-state"]],decls:6,vars:7,consts:[[1,"appOutOfStateContainer"],[3,"header"],["class","appOutOfStateContent",4,"ngIf"],[1,"appOutOfStateContent"],[4,"ngIf"],["target","_blank","href","https://www.fishwildlife.org/landing/membership/member-list"],["mat-flat-button","","color","accent","type","button",1,"appBackToHomeButton",3,"click"]],template:function(e,s){1&e&&(b.TgZ(0,"div",0),b._UZ(1,"app-intro-helper-text",1),b.YNc(2,V_,2,1,"div",2),b.ALo(3,"async"),b.YNc(4,X_,2,1,"div",2),b.ALo(5,"async"),b.qZA()),2&e&&(b.xp6(1),b.Q6J("header",s.header),b.xp6(1),b.Q6J("ngIf",b.lcZ(3,3,s.obsStore.getObservation())),b.xp6(2),b.Q6J("ngIf",b.lcZ(5,5,s.obsStore.getObservation())))},directives:[ue,Ya.O5,Uf.lW],pipes:[Ya.Ov],styles:[".appOutOfStateContainer[_ngcontent-%COMP%]{padding-left:1rem;padding-right:1rem;min-height:calc(100vh - 4.5rem - 3.5rem)}.appOutOfStateContent[_ngcontent-%COMP%]{text-align:center;font-weight:500;color:#434343;line-height:2.625rem;font-size:1.125rem}.appOutOfStateContent[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#434343}.appBackToHomeButton[_ngcontent-%COMP%]{font-size:1.125rem}@media only screen and (min-width: 321px){.appBackToHomeButton[_ngcontent-%COMP%]{z-index:5000}}"]}),r})()}];let W_=(()=>{class r{}return r.\u0275fac=function(e){return new(e||r)},r.\u0275mod=b.oAB({type:r}),r.\u0275inj=b.cJS({imports:[[Bt.Bz.forChild(Y_)],Bt.Bz]}),r})();var H_=wt(9981);let J_=(()=>{class r{}return r.\u0275fac=function(e){return new(e||r)},r.\u0275mod=b.oAB({type:r}),r.\u0275inj=b.cJS({imports:[[Ya.ez,H_.m,W_,zy,Qv]]}),r})()}}]);